(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1009:function(D,F,b){function a(){this.p$d=!1;this.nJc=null;this.hXd=0;this.BCc=this.Cwe();this.xNb=this.Cwe();this.mBa=this.ETa=0;this.Rv=function(){return new Date}}b.d(F,"a",function(){return a});D=b(0);a.prototype.Cwe=function(){for(var d=Array(6),c=0;c<d.length;c++)d[c]=0;return d};a.prototype.vzh=function(){return this.BCc.toString()};a.prototype.rwh=function(){return this.xNb.toString()};a.prototype.Pkj=function(){this.nJc=
this.Rv()};a.prototype.JDb=function(d,c,m){if(!this.Fmj){if(void 0===m?0:m)this.p$d=!0;m=this.Rv();!d&&5<this.ETa||1===d&&5<this.mBa||(this.hXd<d?(1===this.ETa%2&&(this.BCc[this.ETa]=-1,this.ETa++),this.hXd=d,1===c&&(this.xNb[this.mBa]=-1,this.mBa++),this.xNb[this.mBa]=this.nMd(m),this.mBa++):d?(this.xNb[this.mBa]=this.nMd(m),this.mBa++):(this.BCc[this.ETa]=this.nMd(m),this.ETa++))}};a.prototype.nMd=function(d){var c=d.getTime()-this.nJc.getTime();this.nJc=d;return c};Jl.Object.defineProperties(a.prototype,
{Fmj:{configurable:!0,enumerable:!0,get:function(){return this.p$d}}});Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Pa||(a.Pa=new a);return a.Pa},set:function(d){a.Pa=d}}});a.Pa=null;Object(D.a)(a,"LatencyMetrics",null,[])},1059:function(D,F,b){function a(u){this.Tse=this.zKe=null;this.$ef=this.rMe=0;this.hp=null;this.q3d=this.eHc=0;this.Ug=u;this.XVh();this.lCc=this.xZd=this.BHc=!1;this.WGc=0}D=b(0);var d=b(15),c=b(37),m=b(113),r;(function(u){u[u.SendNotification=
0]="SendNotification";u[u.SendPersistentState=1]="SendPersistentState";u[u.FindSession=2]="FindSession";u[u.Last=3]="Last"})(r||(r={}));Object(D.b)("ApiType",r);var t;(function(u){u[u.AttemptCount=0]="AttemptCount";u[u.SuccessCount=1]="SuccessCount";u[u.DropCount=2]="DropCount";u[u.FailedCount=3]="FailedCount";u[u.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";u[u.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";u[u.ThrottledCount=6]="ThrottledCount";u[u.Last=7]="Last"})(t||(t=
{}));Object(D.b)("EventCountType",t);var k=b(1009);b.d(F,"a",function(){return a});a.prototype.Nkj=function(u){this.q3d=u;window.setInterval(Object(c.a)(this,this.ynd,"logMetricsBatchAndReset"),u);this.eHc=(new Date).getTime()};a.prototype.Bx=function(u,w){this.dcj(u)&&!this.xZd||this.wjh||!window.navigator.onLine||this.Ug.Q3a||(this.hp[u][w]++,this.BHc=!0)};a.prototype.XVh=function(){this.hp=Array(3);for(var u=0;3>u;u++){this.hp[u]=Array(7);for(var w=0;7>w;w++)this.hp[u][w]=0}};a.prototype.$Dg=function(){for(var u=
{},w=0;3>w;w++)for(var v=0;7>v;v++)this.E7h(w,v)&&(u[r[w]+t[v]]=this.hp[w][v]);u.FSDomain=this.zKe;u.ConnectionDomain=this.Tse;u.FSRetryInterval=this.rMe;u.MaxPayloadSize=this.$ef;u.LogNumber=this.WGc;1===this.WGc&&(u.FSLatencies=k.a.instance.vzh(),u.ConLatencies=k.a.instance.rwh());return u};a.prototype.E7h=function(u,w){return 2===u&&3!==w&&w?!1:!0};a.prototype.dcj=function(u){return 2===u?!1:!0};a.prototype.ynd=function(){if(this.BHc){this.WGc++;if((new Date).getTime()-this.eHc<5E3+this.q3d){var u=
m.a.toJSON(this.$Dg());d.ULS.sendTraceTag(50644352,500,15,u)}this.eHc=(new Date).getTime();for(u=0;3>u;u++)for(var w=0;7>w;w++)this.hp[u][w]=0;this.BHc=!1}};a.prototype.Ufi=function(){this.xZd=!0};a.create=function(u){a.instance||(a.Pa=new a(u));return a.instance};Jl.Object.defineProperties(a.prototype,{wjh:{configurable:!0,enumerable:!0,get:function(){return this.lCc}}});Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Pa}}});a.Pa=null;Object(D.a)(a,"FrequentLoggingMetrics",
null,[955])},1120:function(D,F,b){b.d(F,"a",function(){return a});D=b(0);var a;(function(d){d[d.disconnected=0]="disconnected";d[d.connecting=1]="connecting";d[d.connected=2]="connected"})(a||(a={}));Object(D.b)("ChannelConnectionState",a)},1121:function(D,F,b){function a(c,m,r,t){var k=d.call(this)||this;k.type=c;k.b7=m;k.g1g=r;k.IN=t;return k}b.d(F,"a",function(){return a});D=b(0);var d=Sys.EventArgs;Cm(a,d);Object(D.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1122:function(D,F,b){function a(){}
b.d(F,"a",function(){return a});D=b(0);a.LEd="rr";a.h0i="rd";a.f0i="rbp";a.cGd="sa";Object(D.a)(a,"RtcReconnectParams",null,[])},1123:function(D,F,b){function a(d,c,m,r){this.Khi=d;this.Eza=c;this.Ggi=m;this.JLh=r}b.d(F,"a",function(){return a});D=b(0);Object(D.a)(a,"ThrottlerManagerSettings",null,[])},1212:function(D,F,b){function a(){this.rb=new ha.a}function d(oa,Sa){var ma=ba.call(this)||this;ma.type=oa;ma.ozj=Sa;return ma}function c(oa){var Sa=R.call(this)||this;Sa.bWc=oa;return Sa}function m(oa,
Sa){var ma=ja.call(this)||this;ma.FEj=oa;ma.kFj=Sa;return ma}function r(oa,Sa,ma){var na=ea.call(this)||this;na.type=oa;na.presence=Sa;na.IN=ma;return na}function t(oa,Sa){var ma=P.call(this)||this;ma.NEj=oa;ma.errorMessage=Sa;return ma}function k(oa){var Sa=L.call(this)||this;Sa.hubConnection=oa;return Sa}function u(oa,Sa,ma,na,xa,Oa){var ib=Y.call(this)||this;ib.ycb=oa;ib.yXc=Sa;ib.jPg=ma;ib.GIe=xa;ib.GVc=na;ib.stopwatch=Oa;return ib}function w(oa){var Sa=fa.call(this)||this;Sa.BFj=oa;return Sa}
function v(oa,Sa){Sa=void 0===Sa?null:Sa;var ma=T.call(this)||this;ma.yB=oa;ma.Hlg=Sa;return ma}function A(oa,Sa){var ma=S.call(this)||this;ma.type=oa;ma.bI=Sa;return ma}function y(oa){var Sa=W.call(this)||this;Sa.bWc=oa;return Sa}function x(oa){var Sa=H.call(this)||this;Sa.presence=oa;return Sa}function z(oa,Sa){var ma=C.call(this)||this;ma.PLg=oa;ma.IN=Sa;return ma}function J(oa,Sa){var ma=B.call(this)||this;ma.newState=oa;ma.oldState=Sa;return ma}D=b(0);var B=Sys.EventArgs;Cm(J,B);Object(D.a)(J,
"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var C=Sys.EventArgs;Cm(z,C);Object(D.a)(z,"ClientInfoEventArgs",Sys.EventArgs,[]);var H=Sys.EventArgs;Cm(x,H);Object(D.a)(x,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var W=Sys.EventArgs;Cm(y,W);Object(D.a)(y,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var S=Sys.EventArgs;Cm(A,S);Object(D.a)(A,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var N=b(1276),T=Sys.EventArgs;Cm(v,T);Jl.Object.defineProperties(v.prototype,{type:{configurable:!0,
enumerable:!0,get:function(){return this.yB}},b7:{configurable:!0,enumerable:!0,get:function(){return this.Hlg}}});Object(D.a)(v,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var fa=Sys.EventArgs;Cm(w,fa);Object(D.a)(w,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var Y=Sys.EventArgs;Cm(u,Y);Object(D.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var L=Sys.EventArgs;Cm(k,L);Object(D.a)(k,"RefreshProxyEventArgs",Sys.EventArgs,[]);var P=Sys.EventArgs;Cm(t,P);Object(D.a)(t,
"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var ea=Sys.EventArgs;Cm(r,ea);Object(D.a)(r,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var X=b(1121),ja=Sys.EventArgs;Cm(m,ja);Object(D.a)(m,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var R=Sys.EventArgs;Cm(c,R);Object(D.a)(c,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var ba=Sys.EventArgs;Cm(d,ba);Object(D.a)(d,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var ha=b(94);b.d(F,"a",function(){return a});
a.prototype.gLi=function(oa,Sa){this.rb.raiseEvent("CSC",new J(oa,Sa))};a.prototype.QLi=function(oa){this.rb.raiseEvent("RP",new k(oa))};a.prototype.Jlc=function(oa){this.rb.raiseEvent("RC",oa)};a.prototype.SLi=function(){this.rb.raiseEvent("RMID")};a.prototype.PLi=function(oa,Sa,ma,na,xa,Oa){this.rb.raiseEvent("RPS",new u(oa,Sa,ma,na,xa,Oa))};a.prototype.XAf=function(oa,Sa){this.rb.raiseEvent("UPSR",new d(oa,Sa))};a.prototype.HAf=function(oa,Sa){this.rb.raiseEvent("PU",new N.a(oa,Sa))};a.prototype.ELi=
function(oa){this.rb.raiseEvent("MPU",new x(oa))};a.prototype.$yd=function(oa,Sa,ma,na){this.rb.raiseEvent("SUN",new X.a(oa,Sa,ma,na))};a.prototype.eMi=function(oa,Sa){this.rb.raiseEvent("UNR",new v(oa,Sa))};a.prototype.PAf=function(oa,Sa,ma){this.rb.raiseEvent("SP",new r(oa,Sa,ma))};a.prototype.MLi=function(oa,Sa){this.rb.raiseEvent("PSU",new A(oa,Sa))};a.prototype.LLi=function(oa){this.rb.raiseEvent("PSC",new y(oa))};a.prototype.ALi=function(oa){this.rb.raiseEvent("IPSC",new y(oa))};a.prototype.fMi=
function(oa){this.rb.raiseEvent("UPSC",new c(oa))};a.prototype.VLi=function(oa,Sa){this.rb.raiseEvent("SPC",new m(oa,Sa))};a.prototype.MAf=function(oa,Sa){this.rb.raiseEvent("RCF",new t(oa,Sa))};a.prototype.uLi=function(oa){this.rb.raiseEvent("CPSWM",new w(oa))};a.prototype.dMi=function(oa,Sa){this.rb.raiseEvent("UCI",new z(oa,Sa))};a.prototype.hWa=function(oa){this.rb.addHandler("CSC",oa)};a.prototype.Xmc=function(oa){this.rb.removeHandler("CSC",oa)};a.prototype.aug=function(oa){this.rb.addHandler("RP",
oa)};a.prototype.$tg=function(oa){this.rb.addHandler("RC",oa)};a.prototype.eug=function(oa){this.rb.addHandler("RMID",oa)};a.prototype.Ztg=function(oa){this.rb.addHandler("RPS",oa)};a.prototype.Qug=function(oa){this.rb.addHandler("UPSR",oa)};a.prototype.kEa=function(oa){this.rb.addHandler("PU",oa)};a.prototype.jya=function(oa){this.rb.removeHandler("PU",oa)};a.prototype.Ksg=function(oa){this.rb.addHandler("IPU",oa)};a.prototype.Oug=function(oa){this.rb.addHandler("UCI",oa)};a.prototype.qug=function(oa){this.rb.addHandler("SUN",
oa)};a.prototype.Lsg=function(oa){this.rb.addHandler("IUNR",oa)};a.prototype.nWa=function(oa){this.rb.addHandler("UNR",oa)};a.prototype.KEb=function(oa){this.rb.removeHandler("UNR",oa)};a.prototype.Jsg=function(oa){this.rb.addHandler("IPSU",oa)};a.prototype.Isg=function(oa){this.rb.addHandler("IPSC",oa)};a.prototype.Pug=function(oa){this.rb.addHandler("UPSC",oa)};a.prototype.pug=function(oa){this.rb.addHandler("SP",oa)};a.prototype.sug=function(oa){this.rb.addHandler("SPC",oa)};a.getInstance=function(){return a.Pa||
(a.Pa=new a)};a.Pa=null;Object(D.a)(a,"RtcEventHub",null,[715])},1216:function(D,F,b){function a(P,ea,X,ja,R,ba,ha,oa,Sa,ma,na,xa,Oa){var ib=this;Oa=void 0===Oa?null:Oa;this.o2d=(new Date(0)).getTime();this.v3d=0;this.pQb=!1;this.d9d=null;this.kAd=36E5;this.aTa=a.m1e;this.ffb=0;this.wOa=null;this.zca=0;this.Q9a=this.Use=null;this.uig=[u.swb,u.errorMessage,u.vUf,u.QB,u.S5,u.vWe,u.J5a,u.Eza,u.M5a];this.tig=[u.swb,u.errorMessage];this.QB=this.Ofc=null;this.tZd=new r(na?na:function(){return x.AFrameworkApplication.hj},
R,ba,ha,P,ea);this.Vdb=xa;this.rh=ja;this.Ug=ea;this.qcg=X;this.Ol=oa;this.ah=Sa;this.pfb=Oa;this.uZd=!1;this.v5b=9E4;ma&&ma.execute(function(sb){sb.AVb(function(){w.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",ib.Ol);ib.tZd.XCf()})});2>=100*Math.random()&&(this.kAd=3E5);N.a.instance&&(N.a.instance.rMe=this.kAd)}function d(){}function c(){}function m(){}function r(P,ea,X,ja,R,ba){this.aDa=null;var ha=b(1216).FindSessionStrategy;this.Qhg=P;P=String.format("{0}={1}",
t.clientId,W.a.rf(ja));P=String.format("{0}&{1}={2}",P,t.userSessionId,W.a.rf(R));P=String.format("{0}&{1}={2}",P,t.Lzj,W.a.rf(X.toString()));P=String.format("{0}&{1}={2}",P,t.userType,W.a.rf("1"));P=String.format("{0}&{1}={2}",P,t.fAj,W.a.rf(ea));P=String.format("{0}&{1}={2}",P,t.TLg,W.a.rf(ha.RLg));(ea=r.Uth(X,ba))&&(P=String.format("{0}&{1}",P,ea));this.wag=P}function t(){}function k(){this.wWe=this.Yef=this.Zef=this.cff=0;this.ddc=!1;this.correlationId=this.QB=this.S5=this.zXc=this.errorMessage=
null}function u(){}b.r(F);D=b(0);var w=b(15),v=b(37),A=b(210),y=b(1120);u.M5a="throttling_messageDelay";u.swb="enabled";u.Eza="throttling_timeToWaitForResponse";u.J5a="throttling_maxNumberOfOutstandingMessages";u.vWe="throttling_globalMaxNumberOfOutstandingMessages";u.errorMessage="errorMessage";u.vUf="url";u.S5="queryString";u.QB="connectionString";Object(D.a)(u,"RtcFindSessionOutputFieldNameConstants",null,[]);var x=b(5),z=b(75),J=b(49),B=b(413),C=b(789),H=b(113),W=b(30),S=b(194);Jl.Object.defineProperties(k.prototype,
{uOg:{configurable:!0,enumerable:!0,get:function(){return this.zXc+"?"+this.S5}}});Object(D.a)(k,"FindSessionResponse",null,[]);t.clientId="ClientId";t.Lzj="UserApp";t.userSessionId="usid";t.userType="UserType";t.fAj="UserVersion";t.Clc="qs";t.TLg="clientProtocol";t.Hki="NoAuth";Object(D.a)(t,"RtcFindSessionInputQueryParamConstants",null,[]);r.prototype.XCf=function(){this.aDa=this.Qhg()};r.prototype.v7c=function(){this.aDa&&""!==this.aDa||(this.XCf(),w.ULS.sendTraceTag(575784194,500,this.aDa&&""!==
this.aDa?50:15,"Query signature delegate called for refresh returned: {0} ",this.aDa));var P=String.format("{0}={1}",t.Clc,W.a.rf(this.aDa));return String.format("{0}&{1}",P,this.wag)};r.Uth=function(P,ea){return 4===P?String.format("{0}={1}",t.Hki,"1"):ea?ea.vKh():null};Object(D.a)(r,"FindSessionQueryStringGenerator",null,[]);var N=b(1059),T=b(1009),fa=b(821),Y=b(1123);m.Kmh="FSType";Object(D.a)(m,"RtcFindSessionRequestHeaders",null,[]);c.DNi="polling";Object(D.a)(c,"RtcFindSessionTypes",null,[]);
var L=b(1122);d.SAj="RTC-TokenProofkey";d.T7h="RTC-IsWacJsBootFsRequest";Object(D.a)(d,"RtcRequestHeaders",null,[]);b.d(F,"FindSessionStrategy",function(){return a});a.prototype.J9i=function(P){this.Q9a=P};a.prototype.init=function(){this.ah.eug(Object(v.a)(this,this.GYi,"resetGetMachineIdDelay"));this.ah.hWa(Object(v.a)(this,this.oV,"onConnectionStateChanged"))};a.prototype.oV=function(P,ea){this.zca=ea.newState;2===ea.newState&&(this.ffb=0)};a.prototype.pQe=function(){var P=this.wOa.correlationId;
return{returnValue:String.format("{0}&{1}={2}",this.wOa.S5,a.Xte,W.a.rf(P)),correlationId:P}};a.prototype.TGh=function(P,ea,X,ja,R){var ba=this;this.d4i(function(){ja(R,"GetMachineIdSuccess")&&(w.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",ba.QB,ba.Ol),P(ba.d9d),X(ba.nJh()))},function(ha){ja(R,"GetMachineIdFailure")&&(w.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",ba.Ol),ea(ha))},ja,R)};a.prototype.b4g=function(){this.lqe();
this.hTh()};a.prototype.d4i=function(P,ea,X,ja){var R=this;w.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.QB);if(this.QB)P();else{var ba=this.KGg();window.setTimeout(function(){R.sendFindSessionRequestToServerInternal(P,ea,X,ja)},ba)}};a.prototype.sendFindSessionRequestToServerInternal=function(P,ea,X,ja){var R=this;X(ja,"RequestMachineId")&&(this.o2d=(new Date).getTime(),X=J.a.hf(),this.qQe(function(ba){var ha=
J.a.hf();R.Dvf(ba);R.yHd();P();ba=J.a.hf()-ha;w.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ba)},function(ba){var ha=J.a.hf();R.lqe();N.a.instance&&N.a.instance.Bx(2,3);ea(ba);ba=J.a.hf()-ha;w.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ba)},!1),X=J.a.hf()-X,w.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",X))};a.prototype.hTh=function(){this.aTa+=a.HCh;this.aTa=Math.min(this.aTa,a.tgi)};a.prototype.KGg=function(){var P=(new Date).getTime();
P=this.o2d+this.aTa-P;0>P&&(P=0);return P};a.prototype.Dvf=function(P){try{this.wOa=P,this.Ofc=P.uOg,this.QB=P.QB,this.Use=P.S5,this.d9d=P.zXc}catch(ea){w.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",ea.toString())}};a.prototype.lqe=function(){this.QB=null;this.mqe()};a.prototype.yHd=function(){this.mqe();this.pQb=!0;this.v3d=window.setTimeout(Object(v.a)(this,this.mPi,"refreshMachineId"),this.kAd)};a.prototype.mqe=function(){this.pQb&&
(window.clearTimeout(this.v3d),this.pQb=!1)};a.prototype.mPi=function(){var P=this;this.pQb=!1;this.qQe(function(ea){var X=P.Use!==ea.S5,ja=P.QB!==ea.QB,R=P.QB;P.Dvf(ea);P.zca&&(ja?(w.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",R||"null",ea.QB),P.ah.Jlc()):(P.ah.VLi(X,ja),P.yHd()))},function(){N.a.instance&&N.a.instance.Bx(2,3);P.yHd()},!0)};a.prototype.GYi=function(){this.aTa=a.m1e};a.prototype.nJh=function(){return new Y.a(this.wOa.cff,
this.wOa.Zef,this.wOa.Yef,this.wOa.wWe)};a.prototype.xrj=function(P){if(Object.getType(P)!==Object)return null;for(var ea in P);return this.WTg(P)};a.prototype.WTg=function(P){if(!(u.swb in P))return null;for(var ea=P[u.swb],X=Ml(ea?this.uig:this.tig),ja=X.next();!ja.done;ja=X.next())if(!(ja.value in P))return null;X=Object.assign(new k,{ddc:P[u.swb],errorMessage:P[u.errorMessage],correlationId:S.a.create().toString()});ea&&(X.zXc=P[u.vUf],X.S5=P[u.S5],X.QB=P[u.QB],X.wWe=P[u.vWe],X.Yef=P[u.J5a],X.Zef=
P[u.Eza],X.cff=P[u.M5a]);return X};a.prototype.wzh=function(P,ea){var X=this;w.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.pfb.Imh.continueWith(function(){X.pfb.Imh.result?(w.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),P(X.pfb.Jmh)):(w.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),ea(X.pfb.Jmh))})};a.prototype.SHf=function(P,ea,X,ja,R){var ba=this;R=void 0===R?!1:R;return function(ha){T.a.instance.JDb(0,
1);P&&P.stop();ba.Q9a=null;ba.Vdb=null;ba.Ecf(ha.data,!0,ea);var oa=fa.RtcUtils.deserialize(ha.data.pe,"FindSession",null);if(oa)if(oa=ba.xrj(oa)){if(oa.ddc&&oa.S5&&oa.QB){w.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",ba.Ol);ba.bci(ha.data);X(oa);return}ea.FindSessionFailureReason="FindSessionInvalidResponse";ea.IsRtcEnabled=oa.ddc;ea.IsQueryStringEmpty=!oa.S5;ea.IsConnectionStringEmpty=!oa.QB;w.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
ba.Ol,oa.ddc,!oa.S5,!oa.QB)}else ea.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",w.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",ba.Ol);else ea.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",w.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",ba.Ol);ba.NAf(ea,R);ja(null)}};a.prototype.LHf=function(P,ea,X,ja){var R=this;ja=void 0===ja?!1:ja;return function(ba){T.a.instance.JDb(0,
1);P&&P.stop();R.Q9a=null;R.Vdb=null;R.Ecf(ba.data,!1,ea);var ha=null,oa="unknown",Sa="unknown";ba.data&&((oa=ba.data.responseHeaders)&&a.AFb in oa&&(ha=oa[a.AFb].toString()),oa=C.a[ba.data.status],Sa=ba.data.httpStatus.toString());ea.FindSessionFailureReason="FindSessionRequestFailed";ea.HttpErrorCode=Sa;ea.HttpErrorStatus=oa;ea[a.AFb]=ha;w.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",oa,Sa,R.Ol,
ha,ja);R.NAf(ea,ja);X(Sa)}};a.prototype.qQe=function(P,ea,X){var ja=this;X=void 0===X?!1:X;var R=null;w.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Ol);var ba={},ha=this.tZd.v7c();ba[B.a.mY]=S.a.create().toString();this.Q9a&&""!==this.Q9a?ha=String.format("{0}&{1}={2}",ha,L.a.LEd,this.Q9a):this.Vdb&&""!==this.Vdb&&(ha=String.format("{0}&{1}={2}",ha,L.a.LEd,this.Vdb),ba[d.SAj]="True",ba[d.T7h]="True");ha=this.qcg+"?"+ha;X&&(ba[m.Kmh]=c.DNi);var oa={};oa.IsNetworkOfflineBeforeSendRequest=
this.Ug.Q3a;oa.HasAvailableConnectionsBeforeSendRequest=this.Ug.AYe;oa.MaxConnectionsAllowed=this.Ug.Ufc;oa.IsRefreshMachineId=X;this.pfb&&!this.uZd?(this.wzh(this.SHf(null,oa,P,ea,X),this.LHf(null,oa,ea,X)),this.uZd=!0):(this.rh&&(R=this.rh.Ic("WebServiceCall","GetMachineIdFromTheServer")),N.a.instance&&N.a.instance.Bx(2,0),0>this.Ug.J8(ha,1,null,ba,[a.Y_b,a.AFb,a.Wzb,a.KEd,a.Dgf,a.Uif,a.Tif],!1,1,this.SHf(R,oa,P,ea,X),this.LHf(R,oa,ea,X),null,null,!1,null,this.v5b,"3",null,!0)&&(5<this.ffb&&200>
this.ffb&&w.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.ffb),window.setTimeout(function(){ja.ffb++;ea("-1")},1E3)))};a.prototype.Ecf=function(P,ea,X){X||(X={});X.IsNetworkOfflineAfterRequestComplete=this.Ug.Q3a;X.IsRequestSucceeded=ea;P&&(X.EnqueueTime=P.I3b,X.InvokedTime=P.qE,X.CompletedTime=P.u2,P.responseHeaders&&(a.Y_b in P.responseHeaders&&(X.CorrelationId=P.responseHeaders[a.Y_b]),a.Wzb in P.responseHeaders&&
(X[a.Wzb]=P.responseHeaders[a.Wzb])));w.ULS.sendTraceTag(38633565,500,ea?50:15,fa.RtcUtils.Hwa(X))};a.prototype.NAf=function(P,ea){P||(P={});P.ConnectionState=y.a[this.zca];ea||this.ah.MAf(1,P)};a.prototype.bci=function(P){try{var ea=!1,X=!1,ja=P.responseHeaders,R=z.a.dM(P.request.get_url());if(ja&&a.KEd in ja){var ba=ja[a.KEd].toString().toLocaleLowerCase();X="true"===ba;ea="false"===ba}ja=!1;var ha=0<=R.toLocaleLowerCase().indexOf("collab");X&&!ha?ja=!0:ea&&ha&&(ja=!0);if(ja){ea={HostName:R};ea.Status=
C.a[P.status];ea.HttpStatus=P.httpStatus.toString();var oa=P.request.get_headers(),Sa;for(Sa in oa){var ma=oa[Sa];(X=Sa)&&0<X.length&&(R=0,ma&&(R=ma.toString().length),ea["r_"+X]=R)}if(P.responseHeaders){var na=new A.a;na.add(a.Y_b);na.add(a.Wzb);na.add(a.AFb);na.add(a.Uif);na.add(a.Tif);na.add(a.Dgf);a.Vpg(ea,P.responseHeaders,na)}a.Lpg(P.request.get_url(),ea);var xa=H.a.toJSON(ea);w.ULS.sendTraceTag(559437006,500,15,xa)}}catch(Oa){w.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",
Oa.toString())}};a.createInstance=function(P,ea,X,ja,R,ba,ha,oa,Sa,ma,na,xa){return a.PUg(P,ea,X,ja,R,ba,ha,oa,Sa,ma,na,void 0===xa?null:xa)};a.PUg=function(P,ea,X,ja,R,ba,ha,oa,Sa,ma,na,xa){xa=void 0===xa?null:xa;P=P||S.a.create().toString();P=new a(P,ea,X,ja,R,ba,ha,oa,Sa,ma,null,na,xa);P.init();return P};a.Vpg=function(P,ea,X){X=Ml(X);for(var ja=X.next();!ja.done;ja=X.next())ja=ja.value,ja in ea&&(P[ja]=ea[ja])};a.Lpg=function(P,ea){if(P){var X=P.indexOf("?");if(-1!==X)for(P=P.substr(X+1).split("&"),
X=0;X<P.length;++X){var ja=P[X].split("=");if(2===ja.length){var R=ja[0];if(R&&0<R.length){var ba=0;if(ja=ja[1])ba=ja.length;ea["q_"+R]=ba}}}}};a.HCh=3E3;a.tgi=3E5;a.RLg="1.0";a.m1e=1E3;a.Y_b="X-CorrelationId";a.Xte="corrid";a.AFb="RtcErrorCode";a.Wzb="X-OfficeCluster";a.KEd="X-NewEnv";a.Dgf="X-MSEdge-Ref";a.Tif="X-OFFICEFD";a.Uif="X-OfficeFE";Object(D.a)(a,"FindSessionStrategy",null,[966])},1275:function(D,F,b){function a(){this.U4d=this.V4d=this.W4d=this.S4d=this.R4d=this.T4d=this.nhb=this.fIc=
0;this.POb=this.AGc=this.Agb=this.tGc=this.uGc=this.kGc=this.Ooa=this.xgb=this.fUa=this.jGc=this.NOb=this.wTa=null;this.oHc=this.Tgb=this.b9d=this.gWd=0;this.V3d=!1;this.kCf=this.Pzd;this.nCf=this.Szd;this.mCf=this.Rzd;this.rCf=this.Uzd;this.qCf=this.Tzd;this.$zd=this.aAd;this.Xzd=this.Yzd;this.WNa=this.Vzd;this.KDb=this.Wzd;this.lCf=this.Qzd;this.xzb=this.Iqd;this.Ugc=this.Kqd}b.r(F);b.d(F,"RealtimeChannelMetrics",function(){return a});D=b(0);var d=b(15),c=b(228),m=b(113),r=b(821);a.prototype.Pzd=
function(){this.fIc++;this.jGc=new Date;this.wTa||(this.wTa=new Date)};a.prototype.Szd=function(){this.nhb++;this.Ooa=new Date;this.NOb||(this.NOb=this.Ooa);this.Agb=this.Ooa;this.EOg()};a.prototype.Rzd=function(){this.T4d++;this.kGc=new Date};a.prototype.Uzd=function(){this.R4d++;this.fUa=new Date};a.prototype.Tzd=function(){this.S4d++;this.xgb=new Date};a.prototype.Yzd=function(){this.uGc=new Date;this.W4d++};a.prototype.Wzd=function(){this.POb||(this.POb=new Date);this.V4d++};a.prototype.Vzd=function(){this.tGc=
new Date;this.U4d++};a.prototype.aAd=function(){!this.V3d&&this.fIc&&(d.ULS.sendTraceTag(39321871,500,15,m.a.toJSON(this.SMg())),this.V3d=!0)};a.prototype.Qzd=function(t){var k=r.RtcUtils.Sjh(t);t=k.V_e;var u=k.W_e;k=k.Kg;if(t&&t!==c.a.bO){var w={};d.ULS.sendTraceTag(40157596,500,15,m.a.toJSON((w.HttpErrorCode=t,w.HttpErrorStatus=u,w.Exception=k,w)));c.a.A3e(t)&&this.gWd++;c.a.i8e(t)&&this.b9d++}};a.prototype.Iqd=function(){this.AGc=new Date};a.prototype.Kqd=function(){this.fUa=this.Agb=new Date};
a.prototype.SMg=function(){var t={};return t.numberOfConnectionAttempts=this.fIc,t.numberOfSuccessfulConnections=this.nhb,t.numberOfFailedConnections=this.T4d,t.numberOfDisconnectedConnections=this.R4d,t.numberOfExplicitDisconnectedConnections=this.S4d,t.numberOfSentMessages=this.W4d,t.numberOfReceivedMessages=this.V4d,t.numberOfLostMessages=this.U4d,t.firstConnectionAttempt=this.wTa?this.wTa:null,t.firstMessageReceived=this.POb?this.POb:null,t.firstConnectionSuccess=this.NOb?this.NOb:null,t.lastConnectionAttempt=
this.jGc?this.jGc:null,t.lastConnectionSuccess=this.Ooa?this.Ooa:null,t.lastConnectionFailure=this.kGc?this.kGc:null,t.lastMessageSent=this.uGc?this.uGc:null,t.lastMessageLost=this.tGc?this.tGc:null,t.lastDisconnect=this.fUa?this.fUa:null,t.lastExplicitDisconnect=this.xgb?this.xgb:null,t.lastTimeOnline=this.Agb?this.Agb:null,t.lastTimeOffline=this.AGc?this.AGc:null,t.maxDisconnectedTimeMs=this.Tgb,t.maxExplicitDisconnectedTimeMs=this.oHc,t.clientConnectionErrors=this.gWd,t.serverConnectionErrors=
this.b9d,t};a.prototype.EOg=function(){this.wTa&&1===this.nhb&&(this.Tgb=Math.max(this.Tgb,this.Ooa.getTime()-this.wTa.getTime()));this.fUa&&1<this.nhb&&(this.Tgb=Math.max(this.Tgb,this.Ooa.getTime()-this.fUa.getTime()));this.xgb&&1<this.nhb&&(this.oHc=Math.max(this.oHc,this.Ooa.getTime()-this.xgb.getTime()))};a.createInstance=function(t){a.Pa||(a.Pa=new a,d.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",t));return a.Pa};a.Pa=null;Object(D.a)(a,"RealtimeChannelMetrics",
null,[959,79])},1276:function(D,F,b){function a(c,m){var r=d.call(this)||this;r.bI=c;r.mha=m;return r}b.d(F,"a",function(){return a});D=b(0);var d=Sys.EventArgs;Cm(a,d);Object(D.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1363:function(D,F,b){function a(Fa){this.$=Fa}function d(Fa,lb,pc,qc,Md,Pd){var ee=lg.call(this)||this;ee.lh=null;ee.ord=!1;ee.Edd=null;ee.currentUserId=null;ee.u2d=null;ee.$=Fa;ee.sn=lb;ee.$.ra.ls(Object(Ga.a)(ee,ee.Zh,"onWebMethodSuccess"));ee.sn.qVb(Object(Ga.a)(ee,ee.sAb,
"onConnectionCompleted"));ee.sn.Jee(Object(Ga.a)(ee,ee.llf,"onConnectionLost"));ee.NMg=pc;ee.fFi=qc;ee.eyj=Md;ee.wzj=Pd;ee.EJa={};ee.lYa=new Set;ee.sn.hYa();hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(ee.currentUserId=ee.$.workbookContext.ClientId,ee.tCf(),ee.$.fa.Ufa(Object(Ga.a)(ee,ee.dK,"onUserListChanged")));return ee}function c(Fa,lb,pc,qc){this.eRd=new De.a(!0);this.eRd.add(pc,Object.assign(new m,{RtcUpdateType:Fa,XrevidSaved:lb,ClientId:pc}));
this.gr=qc}function m(){}function r(Fa,lb,pc){this.zAc={};this.AAc={};this.gr=pc;this.BWb(Fa,this.zAc);this.BWb(lb,this.AAc)}function t(Fa,lb,pc){this.SZg=Fa;this.Ihc=lb;this.gr=pc}function k(Fa,lb,pc,qc){this.Gwc=this.$kc=this.okc=this.L$b=0;this.f1d=this.V2e=!1;this.clientId=Fa;this.vZg=lb;this.$=qc;this.Xdi=ce.a.hf()+pc}function u(Fa,lb,pc,qc,Md){var Pd=tf.call(this)||this;Pd.qj=Fa;Pd.U4i=lb;Pd.T4i=pc;Pd.r6=qc;Pd.pNg=Md;return Pd}function w(Fa,lb,pc){this.Kga=new tg.a;this.Kga.add(Fa.ClientId,
Fa);this.gr=lb;this.p3=pc}function v(){}function A(Fa){var lb=Lg.call(this)||this;lb.xf=null;lb.mergeSuspensionManager=null;lb.uva=!1;lb.Xvd=null;lb.Ld=!1;lb.Ctc=!1;lb.Atc=!1;lb.Btc=!1;lb.$=Fa;lb.Ha=Rd.g(lb.$).Ha;lb.viewport=Rd.g(lb.$).view;lb.contentRefreshManager=lb.$.ea.Ea(292,void 0);lb.yf=lb.$.yf;lb.sya=new Da.a;lb.$ca=new qg.a;Fa=hc.EwaSettings.ka(293)?1E3:3E4;lb.Blb=pd.a.instance.UB(Object(Ga.a)(lb,lb.vzj,"uploadLatencyTelemetryPeriodically"),Fa,Yd.a.MPg,!1,!1);lb.$.Nk(Object(Ga.a)(lb,lb.sd,
"onWorkbookOpened"));lb.$.fa.ak(Object(Ga.a)(lb,lb.ed,"onSessionIdChanged"));lb.$.fa.NPc(Object(Ga.a)(lb,lb.Fv,"clearState"));lb.$.ea.ub(291,function(pc){lb.xf=pc});lb.$.ea.ub(343,function(pc){lb.Ld||(lb.mergeSuspensionManager=pc,lb.mergeSuspensionManager.IVb(Object(Ga.a)(lb,lb.GBb,"onTogglePendingMergeBlockedByClient")),lb.mergeSuspensionManager.qDb())});cb.ULS.sendTraceTag(571798802,13,50,"ContentLatencyTracker initialized");lb.sd(lb.$,null);return lb}function y(){}function x(){}function z(Fa){this.$=
Fa}function J(Fa){this.$=Fa}function B(Fa){this.$=Fa}function C(Fa,lb,pc,qc,Md,Pd){Pd=Fa.Ra(1,void 0===Pd?null:Pd);return Ue.i(Fa,"CheckWorkbookFileNameUpdate",Pd,lb,pc,qc,Md,0)}function H(Fa,lb,pc,qc,Md,Pd,ee){ee=Fa.Ra(1,void 0===ee?null:ee);ee.fullSaveId=lb;return Ue.i(Fa,"ProcessFullSaveStartedNotification",ee,pc,qc,Md,Pd,0)}function W(Fa,lb,pc,qc,Md,Pd,ee){ee=Fa.Ra(1,void 0===ee?null:ee);ee.updateInfo=lb;return Ue.i(Fa,"BatchCheckCollabServiceContent",ee,pc,qc,Md,Pd,516)}function S(Fa,lb,pc){var qc=
Ud.call(this)||this;qc.oxd=null;qc.xNa=null;qc.$=lb;qc.ariaLiveNotifier=Fa;qc.presenceView=pc;qc.jGa=[];pc.jEa(Object(Ga.a)(qc,qc.mBb,"onPresenceChanged"));qc.$.ea.La(231,qc);return qc}function N(Fa){var lb=Eg.call(this)||this;lb.manager=null;lb.$=Fa;lb.fc();return lb}function T(Fa,lb){var pc=hh.call(this)||this;pc.lh=null;pc.fieldManagerPane=null;pc.X4=null;pc.KYf=null;pc.JYf=null;pc.$=Fa;pc.ga=Rd.g(pc.$).ga;pc.kMa=lb;pc.j8e=hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1);pc.$.Nk(Object(Ga.a)(pc,pc.sd,"onWorkbookOpened"));pc.$.yn(Object(Ga.a)(pc,pc.Yd,"onWorkbookClosing"));pc.upa={};pc.EUa=new Hd.a(null,null,null,null);pc.Mya={};pc.Mya.b=0;pc.Mya.c=0;pc.Lif=new fa(pc.$);hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&pc.$.Ba.IsMeetingLiveSession&&pc.$.Ba.IsMeetingPresenter&&(pc.uc.MeetingInfo=pc.RRe());pc.FNd=hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AsyncPresenceUpdatesOnCellEdit",!1)&&hc.EwaSettings.YG();
pc.FNd&&(pc.KYf=Kf.a(function(qc){pc.uc.PresenceType=1;pc.raiseEvent(T.F_);pc.sendPresenceToService(qc)},40,pc.$.ma,"SelectionPresenceManager.SendPresenceToService",!0),pc.JYf=Kf.a(function(qc){pc.e$a(qc);pc.dGd()},40,pc.$.ma,"SelectionPresenceManager.SendCurrentPresence",!0));return pc}function fa(Fa){var lb=Of.call(this)||this;lb.statusBarManager=null;lb.$=Fa;lb.$.ea.ub(29,function(pc){lb.statusBarManager=pc;pc.VF(lb)});return lb}function Y(Fa,lb,pc,qc,Md){Md=void 0===Md?null:Md;var Pd=Bg.call(this)||
this;Pd.mu={};Pd.b0b=0;Pd.a0b=0;Pd.Iob=null;Pd.fmd=null;Pd.mcf=3E4;Pd.qcd=!1;Pd.fJd=!0;Pd.kxd=null;Pd.X0c={};Pd.yed={};Pd.D7a={};Pd.UIc={};Pd.$=Fa;Pd.kMa=qc;Pd.sn=lb;Pd.X8d=pc;ba.HHb=!0;ba.sma=!0;Pd.u2a();Pd.Tx=new R(Fa);Pd.$.Aa&&Pd.$.Aa.Vf(Object(Ga.a)(Pd,Pd.t5,"onSheetChanged"));Pd.sn.qVb(Object(Ga.a)(Pd,Pd.sAb,"onConnectionCompleted"));Fa.ra&&Pd.$.ra.qqa(Object(Ga.a)(Pd,Pd.yAa,"webServiceAdjustContextEventHandler"));Pd.Dx=[];Pd.sn.hYa();Fa.ea.La(25,Pd);Pd.Qqb=!1;Pd.$.yn(Object(Ga.a)(Pd,Pd.Yd,"onWorkbookClosing"));
Pd.tRc=pd.a.instance.UB(Object(Ga.a)(Pd,Pd.eei,"logUsageDataPeriodically"),Pd.mcf/2,Yd.a.hIi,!0,!1);Pd.lxd=Md;return Pd}function L(Fa,lb,pc){var qc=ca.call(this)||this;qc.tG=new De.a(!0);qc.pYc=0;qc.qYc=0;qc.countFloatingObjects=0;qc.qz=new Ra(Fa);qc.rQf(Fa);qc.Tx=pc;qc.kId([]);qc.$=lb;qc.$.Aa.Vf(Object(Ga.a)(qc,qc.t5,"onSheetChanged"));Rd.g(qc.$).LX(Object(Ga.a)(qc,qc.Ks,"onAfterAllBlocksUpdated"));return qc}function P(Fa,lb,pc){var qc=wf.call(this,lb,Rd.g(lb),!0,!1,Fa.User.UserID)||this;qc.$Td=
38;qc.fIb=!1;qc.scc=!1;P.KYa||(P.KYa={});qc.Xq=Fa;qc.cah=lb;qc.Su=new X(qc.gridView,qc.Xq.User.UserID,qc.Xq.User.UserName,qc.Xq.UserColor,qc,pc,qc.cah,qc.Xq.IsAnonymous);return qc}function ea(Fa,lb,pc){this.Qj=this.objectId=this.yTa=null;this.Xq=Fa;this.$=lb;this.Tx=pc;this.Su=new X(Rd.g(this.$),this.Xq.User.UserID,this.Xq.User.UserName,this.Xq.UserColor,null,pc,this.$,this.Xq.IsAnonymous)}function X(Fa,lb,pc,qc,Md,Pd,ee,xf){var Se=Xd.call(this)||this;Se.kd=null;Se.Uy={};Se.ece=0;Se.gqa=null;Se.Qj=
null;Se.opa=0;xf=pc===Gd.a.instance.Eb(86)||xf;Se.gJc=new Hd.a(lb,pc,qc,new Zd.a,null,null,null,null,xf);Se.gridView=Fa;Se.NMc=lb;Se.highlight=Md;Se.Tx=Pd;Se.$=ee;return Se}function ja(Fa,lb,pc,qc,Md){var Pd=vd.call(this)||this;Pd.Dx=[];Pd.IXa=null;Pd.visible=!1;Pd.Jxb=null;Pd.zlb=null;Pd.lta=!1;Pd.eae=null;Pd.domElement=Fa;Pd.gridView=lb;Pd.NMc=Fa.id;Pd.opa=qc;Pd.$=Md;Pd.gdc=!1;Pd.s_e();Pd.gJc=pc;Pd.Qj=null;Pd.qB={};Pd.qB.FirstColumn=0;Pd.qB.FirstRow=0;Pd.qB.LastColumn=0;Pd.qB.LastRow=0;return Pd}
function R(Fa){this.hdc=!1;this.ina=this.sxd=null;this.c0e=Uc.a.Ceh;this.Iua=20;this.gridView=Rd.g(Fa);this.$=Fa;this.SCb={};this.IRa={};this.Uy={};this.HRa={};this.$.Aa&&this.$.Aa.Vf(Object(Ga.a)(this,this.t5,"onSheetChanged"));this.kob()}function ba(){}function ha(Fa,lb,pc){var qc=hb.call(this)||this;qc.Cxa=null;qc.fxf=null;qc.vFd=!1;qc.gridView=Fa;qc.rtl=Fa.rtl;qc.qid=!1;qc.yo=new De.a(!0);for(var Md=0;4>Md;Md++)if(qc.gridView.$a.qjd(pc,ha.aJa()[Md])||1===ha.aJa()[Md]){var Pd=lb.RSg(),ee=Fa.Yf(ha.aJa()[Md]).domElement;
ee.insertBefore(Pd.element,ee.firstChild);qc.yo.add(Enum.toString(sa,ha.aJa()[Md]),Pd)}return qc}function oa(Fa,lb,pc){if(!lb)return null;Fa=Fa.tq;return new Sys.UI.Point(lb.x+Fa.x*(pc?1:-1),lb.y+Fa.y*(pc?1:-1))}function Sa(Fa){this.ze=Fa;this.ze.cWa(10,Ob.a.instance);this.ze.cWa(9,fc.a.instance);this.ze.cWa(6,20);this.ze.cWa(13,ac.a.instance);this.ze.cWa(17,!1)}function ma(Fa,lb,pc){Fa=Gb.call(this,Fa)||this;Fa.TBa=!1;Fa.qPb=!1;Fa.V7=!1;Fa.OUa=!1;Fa.Oz=[];Fa.Tfb={};Fa.ze=pc;Fa.fj=pc.get(8,!1);Fa.A_d=
pc.get(15,!1);Fa.fbg=pc.get(12,0);Fa.Xqa=pc.get(6,0);Fa.ZSb=lb;Fa.abe=pc.get(16);Fa.PCc=pc.get(17,!1);Fa.gQb=0;Fa.zhg=new xa(Fa.fj,Fa.PCc);Fa.tdb=Fa.zPe();Fa.RIc=!1;Fa.Qda=[];Fa.Vfb=[];Fa.element.id=ma.arh();Fa.element.className=Gb.oXg(Fa.fj);Fa.Zob&&(Fa.zIndex=Fa.Zob);Fa.rtl=Fa.fj;Fa.s6i(lb);Fa.sea=Fa.createElement("div");Fa.sea.className="prFlyoutContainer";Fa.element.appendChild(Fa.sea);Fa.cL=[];Fa.Aoa=new na(Fa.jJ,Fa.element,Fa.Xqa,4,6,32,Fa.fj);Fa.Kz=pc.get(9);Fa.Kz.qa($b.a.pointerDown,Fa.Aoa.element,
Object(Ga.a)(Fa,Fa.B6a,"onHitTarget"));Fa.Kz.qa($b.a.pointerOver,Fa.Aoa.element,Object(Ga.a)(Fa,Fa.B6a,"onHitTarget"));Fa.Kz.qa($b.a.pointerOut,Fa.Aoa.element,Object(Ga.a)(Fa,Fa.B6a,"onHitTarget"));return Fa}function na(Fa,lb,pc,qc,Md,Pd,ee){this.cL=Fa;this._parent=lb;this.uWd=pc;this.cag=qc;this.Pdg=Md;this.pVa=Pd;this.tI=ee;this._element=document.createElement("div");this.element.className="prTouchTarget"}function xa(Fa,lb){this.fj=void 0===Fa?!1:Fa;this.PCc=void 0===lb?!1:lb}function Oa(Fa,lb,
pc,qc){this.offsetTop=Fa;this.offsetLeft=lb;this.e5f=void 0===pc?2:pc;this.w_e=void 0===qc?4:qc}function ib(Fa,lb){var pc=Gb.call(this,Fa)||this;pc.Xg=null;pc.Kz=null;pc.cBc=null;pc.pEc=null;pc.tAc=null;pc.toa=null;pc.Fae=null;pc.tI=lb.get(8,!1);pc.Leb=lb.get(6,0);pc.Mlg=lb.get(15,!1);pc.ze=lb;pc.bZd=0;pc.element=Fa;pc.element.className=ib.$nh;pc.TF=document.createElement("span");pc.element.appendChild(pc.TF);pc.Cbg=sb.qxh(lb.get(6,0));pc.Vx(lb);pc._state=5;return pc}function sb(){}function nb(Fa,
lb){var pc=Bf.call(this)||this;pc.type=Fa;pc.lqb=lb;return pc}function Gb(Fa){var lb=ne.call(this)||this;lb._element=null;lb.element=Fa;return lb}function Ha(){this.jO={}}function ca(){var Fa=zf.call(this)||this;Fa.qz=null;Fa.E6d=null;Fa.G6d=null;return Fa}function Ra(Fa){var lb=mg.call(this)||this;lb.Kae=Fa;lb.upa=null;lb.mJc=null;return lb}function ua(Fa){var lb=id.call(this)||this;lb.$=Fa;lb.fc();return lb}function ta(Fa){this.Rxf=this.pxd=this.Txf=this.Pxf=this.$vf=this.IEd=this.GJf=this.LJf=
!1;this.qxd=this.$vd=this.zFb=this.BFb=this.MEd=0;this.W7e=!1;this.Cqd=this.tmb=0;this.ldc=!1;this.$=Fa;Qa.a.aT&&(this.Cqd=window.performance.timing.navigationStart);this.Cqd||cb.ULS.sendTraceTag(555038465,0,15,"Navigation start time is zero");this.$.fa.ak(Object(Ga.a)(this,this.ed,"onSessionIdChanged"))}function db(){var Fa=wb.call(this)||this;Fa.Ote=null;Fa.fc();return Fa}function Ta(){}function qb(){}function za(Fa){this.Qa=new $c.a;this.disposed=!1;this.$=Fa;this.$.fa.Ufa(Object(Ga.a)(this,this.MBb,
"onUserListUpdated"))}function Ia(Fa){var lb=Ma.call(this)||this;lb.manager=null;lb.$=Fa;lb.fc();return lb}function va(Fa){var lb=yb.call(this)||this;lb.Dra=null;lb.RYa=null;lb.lsa=!1;lb.txc=!1;lb.$=Fa;cb.ULS.shipAssertTag(40461393,0,!!lb.$.fa,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");lb.$.yn(Object(Ga.a)(lb,lb.Yd,"onWorkbookClosing"));lb.$.fa.NS(Object(Ga.a)(lb,lb.Onf,"onGridLoaded"));lb.$.fa.ktg(Object(Ga.a)(lb,lb.Whc,"onConversionOutdatedEvent"));
lb.$.fa.ot(Object(Ga.a)(lb,lb.hg,"onWorkbookMetadataChanged"));lb.$.fa.Gt&&lb.Whc(lb,Sys.EventArgs.Empty);return lb}function Ua(Fa,lb,pc){if(!lb||!lb.Ab)return null;for(var qc=0;qc<lb.Ab.count;qc++){var Md=lb.Ab.getItem(qc);if(Md&&Md.type===pc&&Md.usedRange&&Md.usedRange.contains(Pb.D(Fa))&&kb.a.equals(Md.sheetName,Fa.SheetName,!0))return Md}return null}function Kb(Fa,lb){return!!Fa&&!!lb&&Fa.SheetName===lb.SheetName&&(!!Fa.NamedObjectName&&Fa.NamedObjectName===lb.NamedObjectName||!Fa.NamedObjectName&&
!lb.NamedObjectName&&Pb.D(Fa).oe(Pb.D(lb)))}function ia(){}function E(Fa,lb,pc,qc,Md,Pd,ee,xf,Se){Se=void 0===Se?!1:Se;this.Fna=null;this.KCc=!0;this.fJc=this.lDa=this.xzc=null;this.rb=new $c.a;this.jgg=Fa;this.p8d=lb;this.F6d=pc;this.D6d=qc;this.UUd=Pd;E.re=Md;this.Ihg=ee;this.ipa=xf;this.fig=Se;wa.Task.WAA(lb,pc).continueWith(Object(Ga.a)(this,this.dUh,"initOnTaskReady"))}function fb(Fa){var lb=Qc.call(this)||this;lb.p_b=null;lb.MJf=null;lb.dDa=null;lb.E0d=!1;lb.$=Fa;lb.$.yn(Object(Ga.a)(lb,lb.Djc,
"onWorkbookClosed"));lb.$.fa.NPc(Object(Ga.a)(lb,lb.Djc,"onWorkbookClosed"));Fa.ea.ub(38,function(pc){pc.Dfe(Object(Ga.a)(lb,lb.Djc,"onWorkbookClosed"))});return lb}function Za(Fa){var lb=Pc.call(this)||this;lb.lh=Fa;return lb}function ec(){}function zc(Fa,lb,pc,qc,Md,Pd,ee,xf,Se,cf){xf=void 0===xf?null:xf;Se=void 0===Se?null:Se;cf=void 0===cf?null:cf;this.Q6d={};this.GAc={};this.T1d=new Da.a;this.Idb=this.Yfb=this.Hw=this.kSb=null;this.$9d=this.Z9d=0;this.KDa=new Va.a(function(){return xf.pU("PresenceBootLatencyThreshold",
1E4)});this.vBa=new Va.a(function(){return xf.pU("PresenceBootLatencyCutoffThreshold",6E4)});this.cmg=new Va.a(function(){return xf.pU("PresenceLightupLatencyThreshold",2E3)});this.Sag=new Va.a(function(){return xf.pU("PresenceLightupLatencyCutoffThreshold",1E4)});this.Mna=qc;this.yhg=Md;this.qWd=Fa;this.o8d=lb;this.spa=pc;this.ni=Pd;this.HQb=Se;this.ZAa=ee;this.Nd=cf;this.hVd=!1;this.init()}function Ab(Fa,lb,pc){this.OVd=this.oWd=this.iNb=this.sNb=this.wSa=0;this._id=Fa;this.KDa=lb;this.vBa=pc;this.zdb=
Object(Bb.a)(String,nc.AFrameworkApplication.Kb.Application)||""}function vb(Fa,lb,pc,qc,Md,Pd,ee,xf,Se){this.Bo=0;this.i9d=!1;this._id=Fa;this.a$d=lb;this.bL=pc;this.MHc=qc;this.rMc=Md;this.KDa=Pd;this.vBa=ee;this.jWd=xf;this.ZAa=Se;this.zdb=Object(Bb.a)(String,nc.AFrameworkApplication.Kb.Application)||""}function kc(){this.ct=this.vt=this.d=0}function td(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}function Oc(Fa){this.Hw=null;this.tNb={};this.oRb={};this.Xfb=
null;this.spa=Fa}function tc(Fa,lb,pc,qc,Md,Pd,ee,xf,Se){this.g6d=this.rWd=this.Hw=null;this.uMb=Fa;this.cTb=new Tb.a;this.yb=pc;this.HAc=lb;this.Mna=qc;this.ni=Md;this.WIc=Pd;this.spa=ee;this.F9f=xf;this.p_d=this.m_d=!1;this.xTb=0;this.pWd=1;this.ZAa=Se;this.Oae=this.yb.ta("PeoplesWellExtraButtonInfoIsEnabled");this.zdb=Object(Bb.a)(String,nc.AFrameworkApplication.Kb.Application)||""}function sc(Fa,lb){this.Thb=null;this.f6d=Fa;this.vhg=lb}b.r(F);var ic=b(0),Ga=b(37);sc.prototype.init=function(){var Fa=
this;this.f6d.continueWith(function(){Fa.Thb=Fa.f6d.result;Fa.Thb.Jkb(Object(Ga.a)(Fa,Fa.VM,"onUsersUpdated"))})};sc.prototype.VM=function(){sc.mje(this.Thb.jIa())&&(this.Thb.CCd(Object(Ga.a)(this,this.VM,"onUsersUpdated")),this.vhg.IsRealCoauthSession=!0)};sc.mje=function(Fa){var lb,pc=null;Fa=Ml(Fa);for(lb=Fa.next();!lb.done;lb=Fa.next())if(lb=lb.value)if(lb=lb.isAnonymous||!lb.email?lb.clientId:lb.email.toUpperCase(),!pc)pc=lb;else if(pc!==lb)return!0;return!1};Object(ic.a)(sc,"CoauthTelemetry",
null,[825]);var cb=b(15),Tb=b(139),Bb=b(82),nc=b(5),Gc;(function(Fa){Fa[Fa.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Fa[Fa.notImplemented=1]="notImplemented";Fa[Fa.renderHandled=2]="renderHandled";Fa[Fa.renderHandledWithVeto=3]="renderHandledWithVeto"})(Gc||(Gc={}));Object(ic.b)("CoauthorGalleryTelemetryEndResult",Gc);var La=b(93),Wa=b(113),wa=b(52);tc.prototype.init=function(){var Fa=this;wa.Task.WAA.call(null,this.spa,this.HAc,this.WIc).continueWith(function(){Fa.Hw=Fa.spa.result;
Fa.rWd=Fa.HAc.result;Fa.g6d=Fa.WIc.result;wa.Task.WAA.call(null,Fa.HAc.result.xWc,Fa.WIc.result.xuc).continueWith(function(){Fa.pWd=Fa.rWd.xWc.result;Fa.xTb=Fa.g6d.xuc.result;Fa.Hw.Jkb(Object(Ga.a)(Fa,Fa.Ajc,"onUsersUpdatedEventListener"));Fa.Hw.jIa().length&&Fa.VM()})})};tc.prototype.Ajc=function(){this.VM()};tc.prototype.VM=function(){this.F9f(this.Hw.jIa())?(this.Hw.CCd(Object(Ga.a)(this,this.Ajc,"onUsersUpdatedEventListener")),this.Jri(this.m_d)):this.cTb.hv(1);this.m_d=!0};tc.prototype.Jri=function(Fa){var lb=
this;this.p_d?this.QVf.continueWith(function(){cb.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Gc[lb.QVf.result])}):(this.p_d=!0,this.EJi(!this.pWd&&!Fa))};tc.prototype.EJi=function(Fa){Fa?this.Mna.en(4,Object(Ga.a)(this,this.Btd,"onInteractiveReady")):this.cTb.hv(1)};tc.prototype.Btd=function(){var Fa=this.ni.EG("AppInitStatus_interactivityReady");cb.ULS.shipAssertTag(42259235,325,!!this.xTb);var lb=this.xTb-Fa;Fa={InteractiveTime:Fa};Fa.ReactRenderComplete=
this.xTb;Fa.HadTabSwitch=this.ZAa();Fa.IsModernGallery=this.Oae;cb.ULS.sendTraceTag(594883104,325,50,Wa.a.toJSON(Fa));this.Oae?(cb.ULS.sendTraceTag(42062997,325,15,lb.toString()),this.cTb.hv(this.rBj(lb)?3:2)):cb.ULS.sendTraceTag(594883103,325,15,lb.toString())};tc.prototype.rBj=function(Fa){var lb=Fa>this.yb.qd("CoauthorGalleryTimeToRenderDurationMs",1E4),pc="Word"===this.zdb;if(this.ZAa())return cb.ULS.sendTraceTag(50455714,325,50,lb.toString()),!1;pc&&La.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",
0,"wordcollabrel",null);lb&&(pc?La.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null):La.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null),cb.ULS.sendTraceTag(42062998,325,15,Fa.toString()));return lb};Jl.Object.defineProperties(tc.prototype,{QVf:{configurable:!0,enumerable:!0,get:function(){return this.cTb.task}}});Object(ic.a)(tc,"CoauthorGalleryTelemetry",
null,[824]);Oc.prototype.C8b=function(Fa){var lb=this,pc=new Tb.a;this.init().continueWith(function(){Fa in lb.tNb?pc.hv(lb.tNb[Fa]):lb.oRb[Fa]=pc});return pc.task};Oc.prototype.init=function(){var Fa=this;if(this.Xfb)return this.Xfb.task;this.Xfb=new Tb.a;this.spa.continueWith(function(){Fa.Hw=Fa.spa.result;Fa.Hw.Jkb(Object(Ga.a)(Fa,Fa.VM,"onUsersUpdated"));Fa.g3f();Fa.Xfb.setResult(null)});return this.Xfb.task};Oc.prototype.g3f=function(){var Fa=this.Hw.jIa();Fa.sort(Object(Ga.a)(this,this.lOg,
"comparePresenceUsers"));this.tNb={};for(var lb=0;lb<Fa.length&&Fa[lb]&&Fa[lb].Rja;lb++)this.Hpg(this.tNb,Fa[lb].clientId,lb)};Oc.prototype.Hpg=function(Fa,lb,pc){Fa[lb]=pc;lb in this.oRb&&(this.oRb[lb].hv(pc),delete this.oRb[lb])};Oc.prototype.VM=function(){this.g3f()};Oc.prototype.lOg=function(Fa,lb){return Fa.Rja>lb.Rja?1:Fa.Rja<lb.Rja?-1:0};Object(ic.a)(Oc,"CoauthorPositionFinder",null,[821]);var Da=b(210),Va=b(675);Object(ic.a)(td,"PL",null,[]);var Jb=b(41);kc.FMf=function(Fa,lb,pc){var qc=new kc;
qc.d=Fa;qc.vt=lb;qc.ct=pc;return Jb.c(qc)};Object(ic.a)(kc,"VD",null,[]);var Hb=b(176);vb.prototype.veto=function(Fa){var lb=this;wa.Task.WAA(this.a$d,this.MHc,this.rMc).continueWith(function(){if(lb.MHc.result<=lb.rMc.result)Fa.hv(!1);else{lb.Bo=lb.a$d.result;var pc=lb.bL-lb.Bo,qc=new td;qc.id=lb._id;qc.et=lb.bL;qc.st=lb.Bo;qc.d=lb.bL-lb.Bo;qc.mp=lb.MHc.result;qc.tp=lb.rMc.result;qc.ct=lb.Jvh(lb.jWd);qc.vc=lb.ZAa();var Md=Jb.c(qc),Pd="Word"===lb.zdb;cb.ULS.sendTraceTag(42078597,302,15,Md);if(Pd){var ee=
new Map;ee.set("data",Md);La.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",ee)}pc>lb.KDa.value&&!lb.i9d&&!qc.vc&&(lb.i9d=!0,Fa.hv(!0),qc=Object.assign(new Hb.a,{extendedProperties:new Map}),qc.extendedProperties.set("data",Md),Pd?La.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,qc):La.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!1,!1,qc),pc<lb.vBa.value&&
cb.ULS.sendTraceTag(42078598,302,15,kc.FMf(pc,lb.KDa.value,lb.vBa.value)));Fa.task.isCompleted||Fa.hv(!1)}})};vb.prototype.Jvh=function(Fa){switch(Fa){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(ic.a)(vb,"PresenceLatencyActivityLogger",null,[]);Ab.prototype.fVc=function(){!this.nre&&this.wSa&&this.sNb&&(this.oWd=this.veto(this.sNb,"CoauthGalleryLightupDurationTooLong"));!this.koe&&this.wSa&&this.iNb&&(this.OVd=this.veto(this.iNb,"CanvasPresenceLightupDurationTooLong"))};
Ab.prototype.veto=function(Fa,lb){if(!nc.AFrameworkApplication.ha||!nc.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.PresenceLightupLoggerIsEnabled",!1))return 0;var pc=Fa-this.wSa,qc=new td;qc.id=this._id;qc.et=Fa;qc.st=this.wSa;qc.d=pc;var Md=Jb.c(qc);Fa="Word"===this.zdb;qc="CanvasPresenceLightupDurationTooLong"===lb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===lb?cb.ULS.sendTraceTag(572289499,302,15,Md):cb.ULS.sendTraceTag(571524118,
302,15,Md);if(Fa){var Pd=new Map;Pd.set("data",Md);La.Health.instance.recordKpiUsage(qc,0,"wordcollabrel",Pd)}return pc>this.KDa.value?(Pd=Object.assign(new Hb.a,{extendedProperties:new Map}),Pd.extendedProperties.set("data",Md),Md=pc<this.vBa.value,Pd.extendedProperties.set("cash",Md?"true":"false"),Fa?La.Health.instance.recordKpiFailure(qc,lb,!1,!0,Pd):La.Health.instance.recordQosError(lb,[qc],!1,!0,!1,!1,Pd),cb.ULS.sendTraceTag(572289500,302,15,kc.FMf(pc,this.KDa.value,this.vBa.value)),Md?2:1):
3};Jl.Object.defineProperties(Ab.prototype,{Ovg:{configurable:!0,enumerable:!0,get:function(){return this.wSa},set:function(Fa){this.wSa=Fa;this.fVc()}},JMg:{configurable:!0,enumerable:!0,get:function(){return this.sNb},set:function(Fa){this.sNb=Fa;this.fVc()}},lIg:{configurable:!0,enumerable:!0,get:function(){return this.iNb},set:function(Fa){this.iNb=Fa;this.fVc()}},nre:{configurable:!0,enumerable:!0,get:function(){return!!this.oWd}},koe:{configurable:!0,enumerable:!0,get:function(){return!!this.OVd}}});
Object(ic.a)(Ab,"PresenceLightupLatencyLogger",null,[]);zc.prototype.x8g=function(Fa,lb,pc){var qc=this;pc=void 0===pc?null:pc;var Md=void 0===Md?0:Md;pc&&(cb.ULS.shipAssertTag(42274970,302,!this.HQb||this.HQb===pc,"_myClientId is already set and you are trying to update it to something different"),this.HQb=pc);var Pd=new Tb.a;this.init().continueWith(function(){qc.fxi(Fa);qc.y8g(Pd,Fa,lb,Md)})};zc.prototype.init=function(){var Fa=this;if(this.Yfb)return this.Yfb.task;this.Yfb=new Tb.a;this.ZAa()&&
cb.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.qWd.continueWith(function(){var lb=Fa.qWd.result,pc=lb.xWc,qc=lb.Kii;qc.continueWith(function(){pc.continueWith(function(){Fa.Nd&&Fa.Nd.addQosPillar("RealTimeCoauth");Fa.glj(pc.result,qc.result);Fa.Yfb.setResult(null)})})});this.o8d.continueWith(function(){Fa.kSb=Fa.o8d.result;Fa.kSb.hWa(Object(Ga.a)(Fa,Fa.jyi,"onRtcConnection"));Fa.kSb.nWa(Object(Ga.a)(Fa,Fa.Cpi,"onCoauthorBootReceived"))});this.spa.continueWith(function(){Fa.Hw=Fa.spa.result;
Fa.Hw.Jkb(Object(Ga.a)(Fa,Fa.Ajc,"onUsersUpdatedEventListener"));0<Fa.Hw.jIa().length&&Fa.VM()});return this.Yfb.task};zc.prototype.rRe=function(){var Fa=this;if(this.Idb)return this.Idb.task;this.Idb=new Tb.a;this.Mna.en(4,function(){Fa.Idb.hv(Fa.ni.EG("AppInitStatus_interactivityReady"))});return this.Idb.task};zc.prototype.jyi=function(Fa,lb){var pc=this;if(!this.hVd&&2===lb.newState){var qc=this.rRe();qc.continueWith(function(){var Md=Date.now()-qc.result,Pd={};Pd.clientId=pc.Ngf;Pd.bootTime=
Md;pc.hVd=!0;pc.kSb.Hca(15,Pd)})}};zc.prototype.Cpi=function(Fa,lb){if(15===lb.type){Fa=Date.now();lb=lb.b7;var pc=lb.bootTime;this.f$c(lb.clientId).Ovg=Fa-pc}};zc.prototype.Ajc=function(){this.VM()};zc.prototype.VM=function(){var Fa=Date.now(),lb=this.Hw.jIa(),pc=new Da.a;lb=Ml(lb);for(var qc=lb.next();!qc.done;qc=lb.next())qc=qc.value,this.T1d.contains(qc.clientId)||(this.T1d.add(qc.clientId),pc.add(qc.clientId));if(0<pc.count)for(pc=Ml(pc),lb=pc.next();!lb.done;lb=pc.next())lb=this.f$c(lb.value),
lb.nre||(lb.JMg=Fa)};zc.prototype.fxi=function(Fa){Fa=this.f$c(Fa);Fa.koe||(Fa.lIg=Date.now())};zc.prototype.f$c=function(Fa){return Fa in this.GAc?this.GAc[Fa]:this.GAc[Fa]=new Ab(Fa,this.cmg,this.Sag)};zc.prototype.glj=function(Fa,lb){lb=void 0===lb?0:lb;this.Z9d=Fa;this.$9d=lb?lb:(new Date).getTime()};zc.prototype.y8g=function(Fa,lb,pc,qc){pc=pc?pc.getTime():(new Date).getTime();lb in this.Q6d?Fa.pz():(qc=new vb(lb,this.mIh(),pc,this.C8b(this.Ngf),this.C8b(lb),this.KDa,this.vBa,qc,this.ZAa),this.Q6d[lb]=
qc,qc.veto(Fa))};zc.prototype.mIh=function(){return 1===this.Z9d?wa.Task.Ua(this.$9d):this.rRe()};zc.prototype.C8b=function(Fa){return this.yhg.C8b(Fa)};Jl.Object.defineProperties(zc.prototype,{Ngf:{configurable:!0,enumerable:!0,get:function(){return this.HQb||"{"+nc.AFrameworkApplication.userSessionId+"}"}}});Object(ic.a)(zc,"PresenceBootTelemetry",null,[678]);var Mb=b(144),Ub=b(274),pb=b(54),gb=b(207),Qa=b(317),eb=b(88),xb=b(525);ec.prototype.$h=function(Fa){var lb=this;Fa.register(sc,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").Ac().Lc(function(){return new sc(xb.a.uq(Fa.yc("Common.IPeopleInfoProvider")),
nc.AFrameworkApplication.dg)});Fa.register(tc,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").Ac().Lc(function(){return new tc(nc.AFrameworkApplication.Hb,xb.a.uq(Fa.yc("Common.ICoauthoringTelemeryInfoProvider")),nc.AFrameworkApplication.ha,Mb.a.get_instance(),gb.a.instance,xb.a.uq(Fa.yc("Common.IPeoplesWell")),xb.a.uq(Fa.yc("Common.IPeopleInfoProvider")),sc.mje,function(){return lb.Sle()})});Fa.register(zc,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").Ac().Lc(function(){return new zc(xb.a.uq(Fa.yc("Common.ICoauthoringTelemeryInfoProvider")),
xb.a.uq(Fa.yc("Common.IRealtimeChannelBasic")),xb.a.uq(Fa.yc("Common.IPeopleInfoProvider")),Mb.a.get_instance(),Fa.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),gb.a.instance,function(){return lb.Sle()},nc.AFrameworkApplication.ha,null,La.Health.instance)});Fa.register(Oc,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").Ac().Lc(function(){return new Oc(xb.a.uq(Fa.yc("Common.IPeopleInfoProvider")))})};ec.prototype.init=function(){nc.AFrameworkApplication.ha.Xv(function(){eb.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();
nc.AFrameworkApplication.ha.ta("CoauthorGalleryTelemetryIsEnabled")&&eb.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();nc.AFrameworkApplication.ha.ta("CashTelemetryIsEnabled")&&(eb.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),eb.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};ec.prototype.dispose=function(){};ec.prototype.Sle=function(){return Qa.a.aT&&gb.a.instance.LFa(pb.a.QKb)?0<gb.a.instance.EG(pb.a.QKb)[pb.a.p5f]:!1};ec.main=
function(){Ub.a.instance.oj(new ec)};Jl.Object.defineProperties(ec.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(ic.a)(ec,"CoauthTelemetryPackage",null,[8,9]);var dc=b(918),Nc=b(36),Pc=Sys.EventArgs;Cm(Za,Pc);Object(ic.a)(Za,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var Fd=b(58),Ea=b(35),Xa=b(48),hc=b(1),Xb=b(50),Ic=b(1212),Qc=Nc.a;Cm(fb,Qc);fb.prototype.qVb=function(Fa){this.addHandler("connectionCompleted",Fa)};fb.prototype.TBd=
function(Fa){this.removeHandler("connectionCompleted",Fa)};fb.prototype.IPc=function(Fa){this.addHandler("rtcInitialized",Fa)};fb.prototype.GEb=function(Fa){this.removeHandler("rtcInitialized",Fa)};fb.prototype.Jee=function(Fa){this.addHandler("connectionLostEventKey",Fa)};fb.prototype.fFf=function(Fa){this.removeHandler("connectionLostEventKey",Fa)};fb.prototype.dispose=function(){this.lh&&this.lh.Xmc(Object(Ga.a)(this,this.oV,"onConnectionStateChanged"));this.$&&this.$.Xo(Object(Ga.a)(this,this.Djc,
"onWorkbookClosed"));this.dDa=this.$=null;Qc.prototype.dispose.call(this)};fb.prototype.bwe=function(Fa){Ea.TaskExtensions.Da(this.XTe().task,function(lb){Fa(lb.result)},this.ma)};fb.prototype.Sse=function(Fa,lb){this.E0d=lb;this.xvi(Fa)};fb.prototype.hYa=function(){this.lh&&(this.raiseEvent("rtcInitialized"),2===this.lh.connectionState&&this.p_b&&this.raiseEvent("connectionCompleted",new Za(this.lh),this.p_b))};fb.prototype.Xai=function(){cb.ULS.sendTraceTag(9245249,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");
var Fa=[];Fa.push(Xa.a.current.En(43));Fa.push(Xa.a.current.En(44));Fa=Xa.a.Tmd(Fa,this.$.ma);var lb=Xa.a.loadScript(10,0,1);return wa.Task.WAA.call(null,Fa,lb)};fb.prototype.xvi=function(Fa){var lb=this,pc=this.Xai();Ea.TaskExtensions.Da(pc,function(){cb.ULS.sendTraceTag(571770433,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===dc.RealtimeChannel||null===dc.RealtimeChannel);if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var qc=
(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(lb.$.ea,435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(ee){ee.result.Gdi(qc)},lb.$.ma,3)}lb.dDa=dc.RealtimeChannel.createInstance(Fa,lb.$.Ba.UserSessionId,nc.AFrameworkApplication.NJf,nc.AFrameworkApplication.Md,null,2,Xb.b().VVe(),lb.$.workbookContext.RtcEndpointUrl,void 0,new Ic.a,void 0,void 0,lb.$.workbookContext.RtcBootToken);cb.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");
hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(eb.a.instance.register(dc.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").Ac().Lc(function(){return lb.lh}),eb.a.instance.resolve("Common.IRealtimeChannelBasic"));lb.XTe().setResult(lb.lh);if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Md=(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(lb.$.ea,
435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(ee){ee.result.Fdi(lb.ygd,Md)},lb.$.ma,3)}lb.raiseEvent("rtcInitialized");cb.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var Pd=Object(Bb.a)(313,lb.lh);Pd&&(cb.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),Pd.hWa(Object(Ga.a)(lb,lb.oV,"onConnectionStateChanged")),Pd.connect())},
this.ma,3)};fb.prototype.oV=function(Fa,lb){if(2===lb.newState){if(this.lh){if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var pc=(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(this.$.ea,435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(qc){qc.result.Ddi(pc)},this.$.ma,3)}this.raiseEvent("connectionCompleted",new Za(this.lh),lb)}else cb.ULS.sendTraceTag(38396034,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");
this.p_b=lb}else 2!==lb.oldState&&lb.newState||(this.p_b=null,this.raiseEvent("connectionLostEventKey"))};fb.prototype.Djc=function(){if(this.lh){var Fa=Object(Bb.a)(313,this.lh);Fa&&(cb.ULS.sendTraceTag(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),Fa.disconnect(),Fa.Xmc(Object(Ga.a)(this,this.oV,"onConnectionStateChanged")))}this.dDa=null};fb.prototype.XTe=function(){return this.MJf||(this.MJf=new Tb.a)};fb.la=function(Fa){Fa.ea.La(26,new fb(Fa))};Jl.Object.defineProperties(fb.prototype,
{lh:{configurable:!0,enumerable:!0,get:function(){return this.dDa}},ygd:{configurable:!0,enumerable:!0,get:function(){return this.E0d}}});Object(ic.a)(fb,"RealTimeChannelController",Nc.a,[5,12]);var Cb=b(12),$c=b(94),ae=b(112),Mc=b(29);E.prototype.ZAf=function(){this.rb.raiseEvent("u",null,this)};E.prototype.dUh=function(){this.p8d.result&&this.F6d.result&&(this.lDa=this.p8d.result,this.fJc=this.F6d.result,this.lDa.kEa(Object(Ga.a)(this,this.Mka,"onPresenceUpdated")),this.xzc=new ae.a(2,2,this.UUd,
Object(Ga.a)(this,this.Dvj,"updateAwayClientsTask"),88),E.re.sh(this.xzc))};E.prototype.Mka=function(Fa,lb){(this.KCc||this.iOi(lb.bI))&&E.re.Cla(this.xzc,0)};E.prototype.iOi=function(Fa){for(var lb in Fa){var pc=this.D6d.sTe({key:lb,value:Fa[lb]});if(pc&&pc.clientId&&(pc=pc.clientId.toLowerCase(),(pc=this.Fna[pc]||this.Fna[pc.toUpperCase()])&&2===pc.status))return!0}return!1};E.prototype.Dvj=function(Fa){var lb=this.lDa.uth();if(lb){var pc=new Date,qc=!1;if(this.KCc){this.Fna=lb;this.KCc=!1;lb=this.Fna;
for(var Md in lb){var Pd=Md,ee=lb[Md];ee.f5a<pc&&(pc=ee.f5a);2===ee.status&&(qc=!0,this.fJc.MEf(Pd))}qc&&this.ZAf();E.re.Cla(Fa,this.sSe(pc))}else{ee=new Da.a;Md=!1;var xf=this.Fna;for(Pd in xf)if(xf=Pd,xf in this.Fna&&this.jgg.clientId!==xf){var Se=this.Fna[xf],cf=lb[xf];if(Se&&cf){Se=Se.status;var dh=cf.status;2===Se&&1===dh?(ee.add(xf),cb.ULS.sendTraceTag(38052609,392,50,xf+" returned from away")):1===Se&&2===dh&&(Md=qc=!0,this.fJc.MEf(xf),cb.ULS.sendTraceTag(38052610,392,50,xf+" went away"));
1===dh&&cf.f5a<pc&&(pc=cf.f5a)}}this.Fna=lb;E.re.Cla(Fa,this.sSe(pc));(0<ee.count||qc)&&this.ZAf();0<ee.count&&!this.fig?(Fa=this.Ovh(ee),this.dqj(Fa)):Fa=new Da.a;(Md||0<Fa.count)&&this.Ihg(Mc.a.wWc,2)}}};E.prototype.dqj=function(Fa){if(Fa.count){Fa=Ml(Fa);for(var lb=Fa.next();!lb.done;lb=Fa.next())lb=this.ipa.Pra(String.format(CommonUIStrings.l_EditorsToastArriving,lb.value),!1),lb.image=5,lb.Kua="CoAuth_AuthorStatus_16x16x32",this.ipa.CI(lb)}};E.prototype.Ovh=function(Fa){var lb=this.lDa.K6b(),
pc=new Da.a,qc;for(qc in lb){var Md={key:qc,value:lb[qc]};if(Fa.contains(Md.key)){var Pd=this.D6d.sTe(Md);Pd&&(pc.add(Pd.userName),Fa.remove(Md.key))}}pc.count||cb.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return pc};E.prototype.sSe=function(Fa){var lb=new Date;return Math.max(Fa.getTime()+this.UUd-lb.getTime(),0)};E.re=null;Object(ic.a)(E,"AwayManager",null,[]);var Hd=b(1277),Nd=b(98),ge=b(282),Ed=b(211);Object(ic.a)(ia,"NamedSheetViewConversionEntry",null,[]);var Zc=
b(10),he=b(127),Ke=b(27),Ue=b(81),Pb=b(46),kb=b(7),yb=Nc.a;Cm(va,yb);va.prototype.qfe=function(Fa){this.addHandler("SVCU",Fa)};va.prototype.IFf=function(Fa){this.removeHandler("SVCU",Fa)};va.prototype.dispose=function(){this.RYa=this.Dra=null;this.$&&this.$.Xo(Object(Ga.a)(this,this.Yd,"onWorkbookClosing"));this.$.fa&&(this.$.fa.aR(Object(Ga.a)(this,this.Onf,"onGridLoaded")),this.$.fa.AUi(Object(Ga.a)(this,this.Whc,"onConversionOutdatedEvent")),this.$.fa.ow(Object(Ga.a)(this,this.hg,"onWorkbookMetadataChanged")));
this.$=null;yb.prototype.dispose.call(this)};va.prototype.FQg=function(Fa){return this.lsa?null:this.Dte(Fa,this.RYa,"ConvertPresencePublicToPrivate")};va.prototype.EQg=function(Fa){return this.lsa?null:this.Dte(Fa,this.Dra,"ConvertPresencePrivateToPublic")};va.prototype.fJi=function(Fa){Fa?(this.M_g(Fa),this.Dra=Fa,this.RYa=this.RUg(this.Dra)):cb.ULS.sendTraceTag(40993282,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};va.prototype.hg=
function(){var Fa=this.$.fa.Gn;if(Fa&&Fa.SheetChanges){Fa=Ml(Fa.SheetChanges);for(var lb=Fa.next();!lb.done;lb=Fa.next())if(lb=lb.value,2===lb.Type){if(this.Dra)for(var pc=Ml(this.Dra),qc=pc.next();!qc.done;qc=pc.next())qc=qc.value,qc.Range.SheetName===lb.Name&&(qc.Range.SheetName=lb.NewName);if(this.RYa)for(pc=Ml(this.RYa),qc=pc.next();!qc.done;qc=pc.next())qc=qc.value,qc.Range.SheetName===lb.Name&&(qc.Range.SheetName=lb.NewName)}}};va.prototype.Onf=function(){cb.ULS.sendTraceTag(50657436,0,50,"NamedSheetViewConversionManager.OnGridLoaded");
this.txc=!1;this.Whc(this,Sys.EventArgs.Empty)};va.prototype.Yd=function(){cb.ULS.sendTraceTag(50657437,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");this.txc=!0};va.prototype.Whc=function(){cb.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",this.$.fa.ywa);if(!this.$.isEditMode||!this.$.fa.pc||this.$.fa.h2a||this.txc||this.$.fa.ywa===Zc.a.E1b)cb.ULS.sendTraceTag(50467170,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",
this.$.isEditMode,this.$.fa.pc,this.$.fa.h2a,this.txc);else{this.RYa=this.Dra=null;var Fa=this.$.ra.xa.dc(),lb=this.$.ra.xa,pc=Object(Ga.a)(this,this.$si,"onGetNamedSheetViewConversionSuccess"),qc=Object(Ga.a)(this,this.Zsi,"onGetNamedSheetViewConversionFailure"),Md=lb.Ra(1,null);Ue.i(lb,"GetNamedSheetViewConversion",Md,pc,qc,null,Fa,132)}};va.prototype.$si=function(Fa){if(Ke.a.Fq(Fa.Errors)){this.lsa=!0;var lb=[-1100324317,-1857233882];Ke.a.dh(Fa.Errors,lb)&&cb.ULS.sendTraceTag(40993283,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",
Ke.a.fd(Fa.Errors));Fa=Ke.a.$E(Fa.Errors,lb,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");this.$.fa.Wo(Fa)}else this.lsa=!1,Fa=Fa.Result,this.$.fa.ywa=Fa.ConversionVersion,this.fJi(Fa.NamedSheetViewConversionEntries),this.iLi()};va.prototype.Zsi=function(Fa){this.lsa=!0;Fa=he.a.Eg(Fa.data);cb.ULS.sendTraceTag(40993284,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",Ke.a.fd(Fa))};va.prototype.iLi=function(){cb.ULS.sendTraceTag(40461394,
0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");this.raiseEvent("SVCU")};va.prototype.Dte=function(Fa,lb,pc){if(!lb||!lb.length)return cb.ULS.sendTraceTag(40993285,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",pc,lb?"empty":"null"),Fa;pc=Ml(Fa);for(var qc=pc.next();!qc.done;qc=pc.next()){qc=qc.value;for(var Md=Ml(lb),Pd=Md.next();!Pd.done;Pd=Md.next())if(Pd=Pd.value,Pd.IsRow&&Kb(Pd.Range,
qc)&&!(qc.FirstRow<=Pd.Range.FirstRow&&qc.LastRow>=Pd.Range.LastRow)){var ee={};ee.SheetName=qc.SheetName;ee.FirstRow=ee.LastRow=qc.FirstRow;ee.FirstColumn=ee.LastColumn=qc.FirstColumn;Kb(Pd.Range,ee)?(ee=qc.FirstRow-Pd.Range.FirstRow,0>ee||ee>=Pd.ConversionMap.length?cb.ULS.sendTraceTag(40993286,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",ee,Pd.ConversionMap.length):(ee=Pd.ConversionMap[ee]-ee,qc.FirstRow+=ee,qc.LastRow=
qc.FirstRow,qc.LastColumn=Math.min(qc.LastColumn,Pd.Range.LastColumn))):qc.FirstRow<Pd.Range.FirstRow&&qc.LastRow>=Pd.Range.FirstRow?qc.LastRow=Pd.Range.FirstRow-1:qc.LastColumn>=Pd.Range.FirstColumn&&(qc.LastColumn=Pd.Range.FirstColumn-1)}if(0>qc.FirstRow||qc.FirstRow>Zc.a.Ty)qc.FirstRow=Math.max(Math.min(qc.FirstRow,Zc.a.Ty),0);if(0>qc.LastRow||qc.LastRow>Zc.a.Ty)qc.LastRow=Math.max(Math.min(qc.LastRow,Zc.a.Ty),0);if(0>qc.FirstColumn||qc.FirstColumn>Zc.a.dw)qc.FirstColumn=Math.max(Math.min(qc.FirstColumn,
Zc.a.dw),0);if(0>qc.LastColumn||qc.LastColumn>Zc.a.dw)qc.LastColumn=Math.max(Math.min(qc.LastColumn,Zc.a.dw),0)}return Fa};va.prototype.RUg=function(Fa){if(!Fa||!Fa.length)return cb.ULS.sendTraceTag(40993287,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.Dra?"empty":"null"),Fa;for(var lb=Array(Fa.length),pc=0;pc<Fa.length;++pc){var qc=new ia;qc.Range=Fa[pc].Range;qc.IsRow=Fa[pc].IsRow;qc.ConversionMap=Array(Fa[pc].ConversionMap.length);
qc.IsRow||(this.lsa=!0,cb.ULS.sendTraceTag(41185634,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));for(var Md=0;Md<Fa[pc].ConversionMap.length;++Md)qc.ConversionMap[Fa[pc].ConversionMap[Md]]=Md;lb[Fa.length-pc-1]=qc}return lb};va.prototype.M_g=function(Fa){if(Fa&&Fa.length){Fa=Ml(Fa);for(var lb=Fa.next();!lb.done;lb=Fa.next()){lb=lb.value;this.L_g(lb);var pc=lb.IsRow?lb.Range.LastRow-lb.Range.FirstRow+1:lb.Range.LastColumn-
lb.Range.FirstColumn+1;lb.ConversionMap.length!==pc&&(cb.ULS.shipAssertTag(41435473,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",pc,lb.ConversionMap.length),this.lsa=!0)}}};va.prototype.L_g=function(Fa){var lb=Fa.ConversionMap;if(lb&&lb.length)if(0>lb[0])cb.ULS.shipAssertTag(41435474,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.lsa=
!0;else{for(var pc=[],qc=0;qc<lb.length;++qc)if(0>lb[qc])for(var Md=lb[qc-1],Pd=-1*lb[qc],ee=1;ee<=Pd;++ee)Array.add(pc,Md+ee);else Array.add(pc,lb[qc]);Fa.ConversionMap=pc}};Object(ic.a)(va,"NamedSheetViewConversionManager",Nc.a,[855,7]);var Ma=Ed.a;Cm(Ia,Ma);Ia.prototype.create=function(){this.Jb(this.manager||(this.manager=new va(this.$)))};Object(ic.a)(Ia,"NamedSheetViewConversionManagerFactory",Ed.a,[]);var jd=b(86),Zd=b(1124);za.prototype.dispose=function(){this.disposed||(this.$&&this.$.fa&&
this.$.fa.wla(Object(Ga.a)(this,this.MBb,"onUserListUpdated")),jd.a.rc([this.Qa]),this.$=this.Qa=null,this.disposed=!0)};za.prototype.Jkb=function(Fa){this.Qa.addHandler("UU",Fa)};za.prototype.CCd=function(Fa){this.Qa.removeHandler("UU",Fa)};za.prototype.jIa=function(){for(var Fa=[],lb=Ml(this.$.fa.Lm),pc=lb.next();!pc.done;pc=lb.next())pc=pc.value,pc=new Hd.a(pc.User.UserID,pc.User.UserName,pc.UserColor,new Zd.a(1),null,pc.UserEmail,void 0,void 0,void 0,void 0,void 0,pc.JoinCoauthTime),Array.add(Fa,
pc);cb.ULS.sendTraceTag(42481440,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",Fa.length);return Fa};za.prototype.MBb=function(){cb.ULS.sendTraceTag(42481442,0,50,"PeopleInfoProvider.OnUserListUpdated fired");this.Qa.raiseEvent("UU",this)};Object(ic.a)(za,"PeopleInfoProvider",null,[711,7]);var Zb=b(673);qb.prototype.CI=function(){cb.ULS.sendTraceTag(38339419,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};qb.prototype.removeEntry=function(){};
qb.prototype.Pra=function(Fa,lb){return new Zb.a(Fa,lb)};qb.prototype.dispose=function(){};Jl.Object.defineProperties(qb.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});Jl.Object.defineProperties(qb,{instance:{configurable:!0,enumerable:!0,get:function(){qb.Pa||(qb.Pa=new qb);return qb.Pa}}});qb.Pa=null;Object(ic.a)(qb,"NoOpNotificationBar",null,[670,7]);Ta.prototype.sTe=function(Fa){var lb=Fa.key;Fa=Fa.value;if(!Fa)return null;var pc=Fa.SupportsChat?4:0;return Object.assign(new Hd.a,
{clientId:lb,eVc:Fa.ChatThreadId,dVc:Fa.ChatThreadDiscoveryUri,Eub:Fa.InChat,email:Fa.Cid,capabilities:new Zd.a(pc)})};Object(ic.a)(Ta,"PresenceConverter",null,[716]);var wb=Ed.a;Cm(db,wb);db.prototype.create=function(){this.Jb(this.Ote||(this.Ote=new Ta))};db.la=function(Fa){Fa.ea.La(159,new db)};Object(ic.a)(db,"PresenceConverterFactory",Ed.a,[]);var gc=b(110),uc=b(108);ta.prototype.Gdi=function(Fa){this.LJf||(this.MEd=Fa,this.LJf=!0)};ta.prototype.Fdi=function(Fa,lb){this.GJf||(this.BFb=lb,this.W7e=
Fa,this.GJf=!0)};ta.prototype.Ddi=function(Fa){this.IEd||(this.zFb=Fa,this.IEd=!0)};ta.prototype.ndi=function(Fa){!this.pxd&&this.IEd&&(this.qxd=Fa,this.pxd=!0)};ta.prototype.kdi=function(Fa){this.$vf||(this.$vd=Fa,this.$vf=!0)};ta.prototype.mdi=function(Fa){if(!this.Pxf&&this.Bqa&&!this.ldc){this.Pxf=!0;var lb=this.B8c();lb.RtcIntializeToPeopleWellServiceCreate=this.$vd-this.BFb;lb.PeopleWellServiceCreateToPresenceGalleryRender=Fa-this.$vd;lb.PresenceGalleryRenderTotalTime=Fa-this.Bqa;uc.b(this.$).Jd(gc.a.Qxf,
lb,void 0,!0)}};ta.prototype.pdi=function(Fa){if(!this.Txf&&this.Bqa&&!this.ldc){this.Txf=!0;var lb=this.B8c();lb.RtcIntializeToRtcConnect=this.zFb-this.BFb;lb.RtcConnectToPresenceSent=Fa-this.zFb;lb.PresenceSentTotalTime=Fa-this.Bqa;uc.b(this.$).Jd(gc.a.Uxf,lb,void 0,!0)}};ta.prototype.odi=function(Fa){if(!this.Rxf&&this.pxd&&this.Bqa&&!this.ldc){this.Rxf=!0;var lb=this.B8c();lb.RtcIntializeToRtcConnect=this.zFb-this.BFb;lb.RtcConnectToPresenceRenderInitiate=this.qxd-this.zFb;lb.PresenceRenderInitiateToPresenceRenderFinish=
Fa-this.qxd;lb.PresenceRenderTotalTime=Fa-this.Bqa;uc.b(this.$).Jd(gc.a.Sxf,lb,void 0,!0)}};ta.prototype.dispose=function(){this.$=null};ta.prototype.B8c=function(){var Fa={};Fa.CoAuthorCountsOnBoot=this.$.fa.Lm.length;Fa.RtcConnectedLaterInSession=this.W7e;Fa.BrowserVisibilityChanged=this.PCg();Fa.AppInteractiveAbsTime=this.Bqa;Fa.NavigationStartTime=this.Cqd;Fa.AppInteractiveToRtcSliceLoad=this.MEd-this.Bqa;Fa.RtcSliceLoadToRtcInitialize=this.BFb-this.MEd;return Fa};ta.prototype.ed=function(){this.ldc=
!0;this.$.fa.xk(Object(Ga.a)(this,this.ed,"onSessionIdChanged"))};ta.prototype.PCg=function(){return Qa.a.aT&&gb.a.instance.LFa(pb.a.QKb)?0<gb.a.instance.EG(pb.a.QKb)[pb.a.p5f]:!1};Jl.Object.defineProperties(ta.prototype,{Bqa:{configurable:!0,enumerable:!0,get:function(){if(this.tmb)return this.tmb;gb.a.instance.LFa("AppInitStatus_interactivityReady")&&(this.tmb=gb.a.instance.EG("AppInitStatus_interactivityReady"));this.tmb||cb.ULS.sendTraceTag(555038464,0,15,"App interactive time is zero");return this.tmb}}});
Object(ic.a)(ta,"PresenceTelemetry",null,[714,7]);var id=Ed.a;Cm(ua,id);ua.prototype.create=function(){this.Jb(this.$.ea.Ea(435,void 0)||this.$.ea.La(435,new ta(this.$)))};ua.la=function(Fa){Fa.ea.La(436,new ua(Fa))};Object(ic.a)(ua,"PresenceTelemetryFactory",Ed.a,[]);var Wc=b(1276),pd=b(44),Yd=b(42),be=b(26),me=b(117),Gd=b(16),Rd=b(20),Yf=b(74),mg=Nc.a;Cm(Ra,mg);Ra.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");this.raiseEvent("userLeft");this.mJc=this.upa=this.Kae=null;mg.prototype.dispose.call(this)};
Jl.Object.defineProperties(Ra.prototype,{VKb:{configurable:!0,enumerable:!0,get:function(){return this.Kae}},uc:{configurable:!0,enumerable:!0,get:function(){return this.upa||{}},set:function(Fa){this.mJc=this.upa;this.upa=Fa;this.raiseEvent("userPresenceChanged")}},Pxd:{configurable:!0,enumerable:!0,get:function(){return this.mJc}}});Object(ic.a)(Ra,"UserPresence",Nc.a,[]);var zf=Yf.a;Cm(ca,zf);ca.prototype.kId=function(Fa){this.E6d=Fa};ca.prototype.rQf=function(Fa){this.G6d=Fa};ca.prototype.iYa=
function(){};ca.prototype.p1a=function(){return null};ca.prototype.w9c=function(){return null};ca.prototype.kUf=function(){};ca.prototype.lUf=function(){};ca.prototype.d3f=function(){};ca.prototype.nsc=function(){};ca.prototype.p$b=function(){};ca.Xxj=function(Fa,lb){var pc=Fa.qz.uc;jd.a.rc(Fa.Sx);jd.a.rc([Fa.qz]);Fa.qz=null;Fa.qz=new Ra(lb);Fa.kId([]);Fa.rQf(lb);Fa.uc=pc};Jl.Object.defineProperties(ca.prototype,{Sx:{configurable:!0,enumerable:!0,get:function(){return this.E6d}},Xq:{configurable:!0,
enumerable:!0,get:function(){return this.G6d}},uc:{configurable:!0,enumerable:!0,get:function(){return this.qz.uc},set:function(Fa){this.qz.uc=Fa}}});Object(ic.a)(ca,"IUserGridPresence",Yf.a,[]);var Ce;(function(Fa){Fa[Fa.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Fa[Fa.peopleImageClassName=1]="peopleImageClassName";Fa[Fa.peopleImageClusterPath=4]="peopleImageClusterPath";Fa[Fa.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";Fa[Fa.imageDimension=6]="imageDimension";
Fa[Fa.rtl=8]="rtl";Fa[Fa.pointerInputManager=9]="pointerInputManager";Fa[Fa.clickInputManager=10]="clickInputManager";Fa[Fa.vertical=11]="vertical";Fa[Fa.zIndex=12]="zIndex";Fa[Fa.contextMenuInputManager=13]="contextMenuInputManager";Fa[Fa.imageDomElement=14]="imageDomElement";Fa[Fa.useIdleTooltip=15]="useIdleTooltip";Fa[Fa.viewportBoundsCallback=16]="viewportBoundsCallback";Fa[Fa.flipHorizontalDirection=17]="flipHorizontalDirection";Fa[Fa.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash"})(Ce||
(Ce={}));Object(ic.b)("PresenceTooltipSettingKeys",Ce);Ha.prototype.get=function(Fa,lb){Fa=Ce[Fa];return"number"===typeof(void 0===lb?null:lb)?(lb=this.jO[Fa])?Number.parseInvariant(lb.toString()):0:this.jO[Fa]};Ha.prototype.add=function(Fa,lb){this.jO[Ce[Fa]]=lb};Ha.prototype.cWa=function(Fa,lb){Ce[Fa]in this.jO||(this.jO[Ce[Fa]]=lb)};Ha.prototype.remove=function(Fa){delete this.jO[Ce[Fa]]};Object(ic.a)(Ha,"PresenceTooltipSettings",null,[]);var ne=$c.a;Cm(Gb,ne);Gb.prototype.dispose=function(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;ne.prototype.dispose.call(this)};Gb.prototype.createElement=function(Fa){return this.element.ownerDocument.createElement(Fa)};Gb.prototype.ptc=function(){return!0};Gb.oXg=function(Fa){return"prControl"+(Fa?"Rtl":"")};Jl.Object.defineProperties(Gb.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(Fa){this._element=Fa}},visible:{configurable:!0,enumerable:!0,
get:function(){return"visible"===this.element.style.visibility},set:function(Fa){this.element.style.visibility=Fa?"visible":"hidden"}},rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(Fa){this.element.dir=Fa?"rtl":"ltr"}},zIndex:{configurable:!0,enumerable:!0,get:function(){return this.element.style.zIndex},set:function(Fa){this.element.style.zIndex=String(Fa)}}});Object(ic.a)(Gb,"BasePresenceControl",$c.a,[7,753]);var Bf=Sys.EventArgs;Cm(nb,
Bf);nb.jja="InteractivityChanged";Object(ic.a)(nb,"InteractivityChangedEventArgs",Sys.EventArgs,[]);sb.qxh=function(Fa){return sb.rxh(Fa)};sb.rxh=function(Fa){var lb=document.createElementNS(sb.NSd,"svg");lb.setAttribute("viewBox",String.format(sb.GZg,sb.h5f,sb.g5f));lb.appendChild(sb.NIh(Fa));return lb};sb.NIh=function(Fa){var lb=sb.h5f/Fa,pc=2*lb,qc=sb.g5f/2;Fa=(Fa-12-8)*lb/2;var Md=document.createElementNS(sb.NSd,"g");Md.setAttribute("class",sb.FZg);for(var Pd=1;3>=Pd;Pd++)Md.appendChild(sb.Gvh(Pd,
pc,Fa+(6*Pd-2)*lb,qc));return Md};sb.Gvh=function(Fa,lb,pc,qc){var Md=document.createElementNS(sb.NSd,"circle");Md.setAttribute("class",String.format("{0}-{1}",sb.EKg,Fa));Md.setAttribute("cx",String.format("{0}",pc));Md.setAttribute("cy",String.format("{0}",qc));Md.setAttribute("r",String.format("{0}",lb));return Md};sb.NSd="http://www.w3.org/2000/svg";sb.FZg="prDancingDots";sb.EKg="prAnimateCircle";sb.GZg="0 0 {0} {1}";sb.g5f=40;sb.h5f=120;Object(ic.a)(sb,"ModernPresenceTooltipDancingDots",null,
[]);var Le=b(162),gd=b(366),$b=b(13),Fc=b(87),Vc=b(163),ud=b(85),Ge=b(30);Cm(ib,Gb);ib.prototype.oPc=function(Fa){this.addHandler(nb.jja,Fa)};ib.prototype.fnc=function(Fa){this.removeHandler(nb.jja,Fa)};ib.prototype.dispose=function(){this.element&&(this.Xg.Ca($b.a.click,this.element,Object(Ga.a)(this,this.Yc,"onClick")),this.Xg.Ca($b.a.Dj,this.element,Object(Ga.a)(this,this.ptc,"stopPropagationAndPreventDefaultBehavior")),this.Kz.Ca($b.a.pointerDown,this.element,Object(Ga.a)(this,this.onPointerDown,
"onPointerDown")),this.Kz.Ca($b.a.pointerOut,this.element,Object(Ga.a)(this,this.TM,"onPointerOut")),this.Kz.Ca($b.a.pointerOver,this.element,Object(Ga.a)(this,this.iw,"onPointerOver")),this.cBc.Ca(this.element,Object(Ga.a)(this,this.ptc,"stopPropagationAndPreventDefaultBehavior")));Gb.prototype.dispose.call(this)};ib.prototype.Vx=function(Fa){this.Xg=Fa.get(10);this.Xg.qa($b.a.click,this.element,Object(Ga.a)(this,this.Yc,"onClick"));this.Xg.qa($b.a.Dj,this.element,Object(Ga.a)(this,this.ptc,"stopPropagationAndPreventDefaultBehavior"));
this.Kz=Fa.get(9);this.Kz.qa($b.a.pointerOver,this.element,Object(Ga.a)(this,this.iw,"onPointerOver"));this.Kz.qa($b.a.pointerOut,this.element,Object(Ga.a)(this,this.TM,"onPointerOut"));this.Kz.qa($b.a.pointerDown,this.element,Object(Ga.a)(this,this.onPointerDown,"onPointerDown"));this.cBc=Fa.get(13);this.cBc.qa(this.element,Object(Ga.a)(this,this.ptc,"stopPropagationAndPreventDefaultBehavior"))};ib.prototype.hide=function(Fa,lb,pc){Fa=void 0===Fa?null:Fa;lb=void 0===lb?0:lb;pc=void 0===pc?0:pc;this.Mlg&&
Fa?this.ngj(Fa,lb,pc):(3===this.state&&this.nEf(),this.visible=!1,this._state=5)};ib.prototype.ngj=function(Fa,lb,pc){this.show(Fa,lb,15,4,void 0,void 0===pc?0:pc)};ib.prototype.TSf=function(Fa,lb,pc,qc,Md,Pd){this.show(Fa,lb,20,(void 0===pc?0:pc)?2:(void 0===qc?0:qc)?1:0,void 0===Md?!1:Md,void 0===Pd?0:Pd)};ib.prototype.Jfj=function(Fa,lb,pc,qc,Md){this.show(Fa,lb,pc+20,3,void 0===qc?!1:qc,void 0===Md?0:Md)};ib.prototype.show=function(Fa,lb,pc,qc,Md,Pd){qc=void 0===qc?3:qc;Pd=void 0===Pd?0:Pd;!Fa||
qc===this.state&&this.bQh(lb,pc)||(this.aog(qc,void 0===Md?!1:Md,Pd),this.eWa(Fa,qc,Pd),this._state=qc,4===Pd||!Pd&&!this.tI?this.element.style.left=lb+"px":this.element.style.right=lb+"px",this.element.style.top=pc+"px",this.visible=!0)};ib.prototype.eWa=function(Fa,lb,pc){this.Fae=Fa;ud.a.anb(this.TF);Vc.a.CLg(this.TF);this.TF.id="fly_"+Fa.clientId;this.TF.style.backgroundColor=Fa.color;4!==lb?(this.TF.style.height=this.Leb+"px",this.TF.style.lineHeight=this.Leb+"px",Vc.a.BPa(this.TF,"border-radius",
this.Leb+"px")):4===pc||!pc&&!this.tI?this.TF.style.left="0px":this.TF.style.right="0px";2!==lb&&(4===lb?ud.a.tqc(this.TF,""):1===lb?this.TF.appendChild(this.Cbg):(this.TF.setAttribute("dir","auto"),pc=Ge.a.oBh(Fa.userName),!Fa.isAnonymous&&pc||lb?(Fa=Fa.userName,lb||(Fa=pc,Vc.a.BPa(this.TF,"text-align","center")),ud.a.tqc(this.TF,Fa)):(this.pEc||(this.pEc=this.gSg()),this.TF.appendChild(this.pEc),Vc.a.BPa(this.TF,"text-align","start"))))};ib.prototype.Yc=function(Fa){if(!this.state)return this.raiseEvent(nb.jja,
new nb(1,Fa)),!0;3===this.state&&cb.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1};ib.prototype.TM=function(Fa){3===this.state&&this.raiseEvent(nb.jja,new nb(3,Fa));return!1};ib.prototype.iw=function(Fa){3!==Fa.Cb&&this.raiseEvent(nb.jja,new nb(2,Fa));return!1};ib.prototype.onPointerDown=function(Fa){if(3!==Fa.Cb)return!0;this.raiseEvent(nb.jja,new nb(4,Fa));return!1};ib.prototype.gSg=function(){var Fa=document.createElement("img");Fa.setAttribute("src",Le.a.yra("doughperson_white_glyph.svg"));
Fa.setAttribute("Unselectable","on");Fa.setAttribute(Fc.a.Wd,Fc.a.ns);return gd.createClusteredImageFromClusterWithImageClass(this.Leb,this.Leb,null,null,ib.coh,"",!1,"",this.element.ownerDocument,Fa)};ib.prototype.aog=function(Fa,lb,pc){lb=void 0===lb?!1:lb;pc=void 0===pc?0:pc;if(!this.uvb(this.state)||!this.uvb(Fa))switch(Sys.UI.DomElement.removeCssClass(this.element,this.tAc),this.state){case 4:3===Fa?this.Lfa(ib.s6c,ib.zLe):this.uvb(Fa)&&this.Lfa(ib.q6c,ib.zLe);break;case 3:4===Fa?this.Lfa(ib.v6c,
ib.yLe):this.uvb(Fa)&&(lb&&this.nEf(),this.Lfa(ib.q6c,ib.yLe,lb?ib.boh:""));break;case 0:case 1:case 2:4===Fa?this.Lfa(ib.v6c,ib.t6c):3===Fa&&(lb&&this.zog(),this.Lfa(ib.s6c,ib.t6c,lb?ib.ALe:"",3===pc?ib.foh:ib.doh));break;default:4===Fa?this.Lfa(ib.v6c):3===Fa?this.Lfa(ib.s6c):this.uvb(Fa)&&this.Lfa(ib.q6c)}};ib.prototype.Lfa=function(Fa){for(var lb=[],pc=0;pc<arguments.length;++pc)lb[pc-0]=arguments[pc];this.tAc=lb.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.tAc)};ib.prototype.zog=
function(){var Fa=this;this.bZd=window.setTimeout(function(){Fa.element&&(Fa.toa=Fa.element.cloneNode(!0),Fa.element.parentNode.appendChild(Fa.toa),Fa.element.style.zIndex="2",Fa.toa.style.zIndex="1")},300)};ib.prototype.nEf=function(){var Fa=this;window.clearTimeout(this.bZd);this.toa&&(Sys.UI.DomElement.removeCssClass(this.toa,ib.t6c+" "+ib.ALe),Sys.UI.DomElement.addCssClass(this.toa,ib.aoh),wa.Task.delay(300).continueWith(function(){Fa.element&&Fa.element.parentNode===Fa.toa.parentNode&&Fa.element.parentNode.removeChild(Fa.toa)}),
Vc.a.lEb(this.element,"z-index"))};ib.prototype.uvb=function(Fa){return!Fa||1===Fa||2===Fa};ib.prototype.bQh=function(Fa,lb){var pc=Vc.a.IC(this.element.style.top);return Vc.a.IC(this.element.style.left)===Fa&&pc===lb};ib.prototype.sDd=function(Fa){3===Fa&&Vc.a.i2(this.element,"left")?(Fa=Vc.a.IC(this.element.style.left),Vc.a.lEb(this.element,"left"),this.element.style.right=-1*Fa+"px"):4===Fa&&Vc.a.i2(this.element,"right")&&(Fa=Vc.a.IC(this.element.style.right),Vc.a.lEb(this.element,"right"),this.element.style.left=
-1*Fa+"px")};Jl.Object.defineProperties(ib.prototype,{user:{configurable:!0,enumerable:!0,get:function(){return this.Fae}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});ib.$nh="prModernFlyout UIFont";ib.v6c="flyoutIdle";ib.s6c="flyoutExpanded";ib.q6c="flyoutCollapsed";ib.zLe="flyoutFromIdle";ib.yLe="flyoutFromExpanded";ib.t6c="flyoutFromCollapsed";ib.ALe="flyoutStacked";ib.boh="flyoutFromStacked";ib.aoh="flyoutFadeOut";ib.coh="cui-img-cont-float cui-img-20by20";ib.doh=
"flyoutLtrDir";ib.foh="flyoutRtlDir";Object(ic.a)(ib,"ModernPresenceTooltipFlyoutControl",Gb,[]);Object(ic.a)(Oa,"FlyoutsPositioningInfo",null,[]);var ce=b(49);xa.prototype.$Bh=function(Fa,lb,pc,qc,Md){var Pd=Md.y,ee=Md.height,xf=this.Duh(qc),Se=xf+lb,cf=Fa*pc+2*(Fa-1);pc=null;1===Fa||this.yHg(xf,cf,Pd,ee)?Fa=new Oa(0,0,2):(Fa=this.f6c(Se,cf,Pd,ee),Fa.offsetTop-=xf);this.PCc?pc=new Oa(0,0,void 0,this.fj?4:3):(qc=this.Cuh(qc,Md),xf=Math.max(0,Md.x),Md=Md.width,lb=qc+lb,this.zHg(qc,xf,Md)?pc=new Oa(0,
0,void 0,this.fj?3:4):this.AHg(lb,xf)&&(pc=new Oa(0,0,void 0,this.fj?4:3)),pc||(pc=this.rnh(qc,lb,xf,Md)));return new Oa(Fa.offsetTop,pc.offsetLeft,Fa.e5f,pc.w_e)};xa.prototype.Duh=function(Fa){return ce.a.Buh(Fa)};xa.prototype.Cuh=function(Fa,lb){return this.fj?lb.width-ce.a.Auh(Fa):ce.a.zuh(Fa)};xa.prototype.yHg=function(Fa,lb,pc,qc){return Fa+lb<=pc+qc};xa.prototype.f6c=function(Fa,lb,pc,qc){var Md=1,Pd=Math.max(pc,Fa-lb);lb>Fa-pc&&(Md=2,Pd=lb<qc?qc-lb:pc);return new Oa(Pd,0,Md)};xa.prototype.zHg=
function(Fa,lb,pc){return Fa+150<=lb+pc};xa.prototype.AHg=function(Fa,lb){return 150<=Fa-lb};xa.prototype.rnh=function(Fa,lb,pc,qc){qc-lb>=Fa-pc?Fa=4:(lb=Fa,Fa=3);return new Oa(0,lb,void 0,Fa)};Object(ic.a)(xa,"ModernPresenceTooltipPositioner",null,[]);na.prototype.update=function(Fa,lb){if(3!==Fa)if(5!==Fa&&this.cL&&this.cL.length){if(4===Fa){var pc=this.Pdg;var qc=(this.pVa-pc)/2;this.element.style.height=this.pVa+"px";this.element.style.width=this.pVa+"px";Fa=Vc.a.IC(this.cL[0].element.style.top);
lb=Vc.a.IC(this.tI?this.cL[0].element.style.right:this.cL[0].element.style.left)}else pc=this.uWd,qc=(this.pVa-pc)/2,this.element.style.height=this.pVa+"px",this.element.style.width=this.Qvh()+2*qc+"px",Fa=Vc.a.IC(this.cL[this.cL.length-1].element.style.top),lb=this.WGg(this.cL[this.cL.length-1].element,pc,lb);Vc.a.BPa(this.element,"border-radius",this.pVa+"px");this.element.style.top=Fa-qc-pc+"px";this.tI?this.element.style.right=lb-qc+"px":this.element.style.left=lb-qc+"px";this.element.parentNode||
this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)};na.prototype.WGg=function(Fa,lb,pc){return this.tI&&!pc?Vc.a.IC(Fa.style.right):this.tI||pc?this.tI&&pc?-Vc.a.IC(Fa.style.left)-lb:-Vc.a.IC(Fa.style.right)-lb:Vc.a.IC(Fa.style.left)};na.prototype.Qvh=function(){return this.cL&&this.cL.length?this.uWd+Math.min(this.cL.length-1,2)*this.cag:0};Jl.Object.defineProperties(na.prototype,{element:{configurable:!0,
enumerable:!0,get:function(){return this._element}}});Object(ic.a)(na,"ModernPresenceTooltipTarget",null,[]);var Ae=b(371);Cm(ma,Gb);ma.prototype.oPc=function(Fa){this.addHandler(nb.jja,Fa)};ma.prototype.fnc=function(Fa){this.removeHandler(nb.jja,Fa)};ma.prototype.dispose=function(){if(this.D4e)this.RIc=!0;else{if(this.jJ)for(var Fa=Ml(this.jJ),lb=Fa.next();!lb.done;lb=Fa.next())lb=lb.value,lb.fnc(Object(Ga.a)(this,this.F6a,"onInteractivityChanged")),jd.a.Ia(lb);this.cL=null;this.Kz.Ca($b.a.pointerDown,
this.Aoa.element,Object(Ga.a)(this,this.B6a,"onHitTarget"));this.Kz.Ca($b.a.pointerOver,this.Aoa.element,Object(Ga.a)(this,this.B6a,"onHitTarget"));this.Kz.Ca($b.a.pointerOut,this.Aoa.element,Object(Ga.a)(this,this.B6a,"onHitTarget"));Gb.prototype.dispose.call(this)}};ma.prototype.vma=function(){this.rFa();this.visible=!0};ma.prototype.ZPa=function(){this.visible=!0;this.LIe();this.TBa=!0};ma.prototype.hide=function(){this.zEf();this.MZe();this.Aoa.update(this.Lza,this.OUa)};ma.prototype.eWa=function(Fa){var lb=
this.Lza,pc=this.TBa;Fa.clientId||(Fa.clientId=(ma.j0d++).toString());if(Fa.clientId in this.Tfb){var qc=this.Kqb(Fa.clientId);if(0<=qc){qc=this.Oz[qc];if(qc.color===Fa.color&&qc.userName===Fa.userName)return;this.W8a(Fa.clientId)}}this.hide();qc=new ib(this.createElement("div"),this.ze);qc.oPc(Object(Ga.a)(this,this.F6a,"onInteractivityChanged"));this.sea.insertBefore(qc.element,this.sea.firstChild);this.Tfb[Fa.clientId]=qc;Array.add(this.Oz,Fa);Array.add(this.jJ,qc);this.I3f(lb,pc);this.visible=
!0};ma.prototype.W8a=function(Fa){if(this.D4e)Array.add(this.Vfb,Fa);else{var lb=this.Lza,pc=this.TBa;this.hide();this.LEf(Fa);this.I3f(lb,pc)}};ma.prototype.I3f=function(Fa,lb){0>=this.Oz.length?this.hide():3===Fa&&lb?this.ZPa():this.vma()};ma.prototype.cHb=function(Fa,lb){lb?this.zng(Fa):this.SDf(Fa)};ma.prototype.ema=function(Fa){Fa!==this.qPb&&(this.qPb=Fa,this.MHd(Fa))};ma.prototype.position=function(Fa,lb){this.element.style.top=lb+"px";this.element.style.left=Fa+"px"};ma.prototype.rFa=function(Fa){if(void 0===
Fa||!Fa||this.V7){this.qPb&&this.MHd(!0);var lb=Math.min(3,this.Sha)-1;Fa=0;var pc=1,qc=0;this.OUa&&(Fa=this.tdb,pc=-1,qc=-this.Xqa);for(var Md=this.Sha-1;Md>lb;Md--)this.jJ[Md].TSf(this.Oz[Md],-4*lb*pc+qc,!0,!1,!0,Fa);for(;0<=lb;lb--)this.jJ[lb].TSf(this.Oz[lb],-4*lb*pc+qc,0<lb,Array.contains(this.Qda,this.Oz[lb].clientId),lb!==this.gQb,Fa);this.gQb=0;this.Aoa.update(0,this.OUa);this.zIndex=this.Zob;this.TBa=!1;this.zEf(0);this.RIc&&this.dispose()}};ma.prototype.LIe=function(){this.qPb&&this.MHd(!1);
this.zIndex=this.Zob+1;var Fa=this.n8i();var lb=Fa.offsetX;var pc=Fa.offsetY;Fa=Fa.v_e;for(var qc=0;qc<this.Sha;qc++)this.jJ[qc].Jfj(this.Oz[qc],lb,pc+(this.Xqa+2)*qc,qc!==this.gQb,Fa)};ma.prototype.MZe=function(){var Fa=0,lb=0;this.OUa&&(Fa=this.tdb,lb=-6);for(var pc=0;pc<this.Sha;pc++)this.jJ[pc].hide(this.Oz[pc],lb,Fa);this.zIndex=this.Zob;this.visible=this.TBa=!1;this.RIc&&this.dispose()};ma.prototype.CWc=function(Fa){var lb=this;(Fa=void 0===Fa?0:Fa)?(this.V7=!0,wa.Task.delay(Fa).continueWith(function(){lb.A_d?
lb.oRh():lb.rFa(!0);lb.V7=!1})):this.A_d?this.hide():this.rFa()};ma.prototype.oRh=function(){this.V7&&this.hide()};ma.prototype.KBg=function(){if(nc.AFrameworkApplication.za&&nc.AFrameworkApplication.za.Za.sC){var Fa=appChrome.selectors.getShyState();return Fa.isActive&&!!Fa.state}return!1};ma.prototype.F6a=function(Fa,lb){var pc=this;Fa=this.Lza;this.KBg()||2!==lb.type&&(4!==lb.type||3===Fa)?4===lb.type&&3===Fa?(this.V7&&(this.V7=!1),this.CWc()):3!==lb.type||3!==Fa||this.TBa||(1<this.Sha?(this.V7=
!0,wa.Task.delay(250).continueWith(function(){pc.rFa(!0);pc.V7=!1})):this.CWc()):(this.V7&&(this.V7=!1),3!==Fa&&(this.LIe(),3===lb.lqb.Cb&&this.CWc(2E3)));this.raiseEvent(nb.jja,lb)};ma.prototype.B6a=function(Fa){3===Fa.Cb?this.F6a(this,new nb(4,Fa)):Fa.eventName===$b.a.pointerOver?this.F6a(this,new nb(2,Fa)):Fa.eventName===$b.a.pointerOut&&this.F6a(this,new nb(3,Fa));return!1};ma.prototype.s6i=function(Fa){this.element.style.width=Fa+"px";this.element.style.height=this.Xqa+"px"};ma.prototype.LEf=
function(Fa){this.SDf(Fa);Fa=this.Kqb(Fa);if(!(0>Fa)){var lb=this.Oz[Fa];Array.removeAt(this.Oz,Fa);delete this.Tfb[lb.clientId];lb=this.jJ[Fa];this.sea.removeChild(lb.element);this.ze.get(18,!1)&&lb.fnc(Object(Ga.a)(this,this.F6a,"onInteractivityChanged"));Array.removeAt(this.jJ,Fa);lb.dispose()}};ma.prototype.zEf=function(Fa){Fa=void 0===Fa?5:Fa;if(this.Vfb.length){this.visible&&this.MZe();for(var lb=0;lb<this.Vfb.length;lb++)this.LEf(this.Vfb[lb]);Array.clear(this.Vfb);0>=this.Oz.length||5===Fa?
this.hide():Fa||this.vma()}};ma.prototype.Kqb=function(Fa){for(var lb=0;lb<this.Oz.length;lb++)if(this.Oz[lb].clientId===Fa)return lb;return-1};ma.prototype.xgf=function(Fa){if(Fa in this.Tfb){var lb=this.Kqb(Fa);if(lb){var pc=this.Oz[lb];Fa=this.Tfb[Fa];Array.removeAt(this.Oz,lb);Array.insert(this.Oz,0,pc);Array.removeAt(this.jJ,lb);Array.insert(this.jJ,0,Fa);this.sea.removeChild(Fa.element);this.sea.appendChild(Fa.element);this.rFa()}}};ma.prototype.zng=function(Fa){if(-1===this.Kqb(Fa))cb.ULS.sendTraceTag(41706451,
302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Qda,Fa)){if(this.Oz[0].clientId===Fa)return;Array.remove(this.Qda,Fa)}Array.add(this.Qda,Fa);this.xgf(Fa);1!==this.Lza&&this.rFa()}};ma.prototype.SDf=function(Fa){-1===this.Kqb(Fa)?cb.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Qda,Fa)&&(Array.remove(this.Qda,Fa),this.Oz[0].clientId===Fa&&0<this.Qda.length&&this.xgf(this.Qda[this.Qda.length-
1]),this.Oz[0].clientId===Fa&&1===this.Lza&&this.rFa())};ma.prototype.MHd=function(Fa){Fa?Sys.UI.DomElement.addCssClass(this.sea,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.sea,"prBackgroundSelection")};ma.prototype.n8i=function(){var Fa;var lb=Fa=0;var pc=this.tdb;if(this.abe){var qc=this.abe(this);if(!qc)return{offsetX:Fa,offsetY:lb,v_e:pc};var Md=4===this.Lza;pc=this.zhg.$Bh(this.Sha,Md?6:this.Xqa,this.Xqa,this.element,qc);lb=pc.offsetTop;this.gQb=this.lBh(pc.e5f,pc.offsetTop);
pc=pc.w_e;pc!==this.tdb&&(this.sDd(pc),this.element.dir=3===pc?"rtl":"ltr",this.tdb=pc);pc!==this.zPe()?(Fa=Md?-6:-this.Xqa,this.OUa=!0):this.OUa=!1}return{offsetX:Fa,offsetY:lb,v_e:pc}};ma.prototype.lBh=function(Fa,lb){if(1===Fa)return this.Sha-1;Fa=Math.abs(lb);return 0<Fa?Fa/(this.Xqa+2):0};ma.prototype.sDd=function(Fa){for(var lb=0;lb<this.Sha;lb++)this.jJ[lb].sDd(Fa)};ma.prototype.zPe=function(){return this.fj?3:4};ma.arh=function(){return String.format("{0}-{1}","presencetooltip",ma.j0d++)};
Jl.Object.defineProperties(ma.prototype,{blc:{configurable:!0,enumerable:!0,get:function(){return Ae.a.clone(this.Oz)}},jJ:{configurable:!0,enumerable:!0,get:function(){return this.cL}},Zob:{configurable:!0,enumerable:!0,get:function(){return this.fbg}},Sha:{configurable:!0,enumerable:!0,get:function(){return this.jJ?this.jJ.length:0}},Lza:{configurable:!0,enumerable:!0,get:function(){return 0<this.Sha?this.jJ[0].state:5}},D4e:{configurable:!0,enumerable:!0,get:function(){return 3===this.Lza&&!this.TBa}}});
ma.j0d=0;Object(ic.a)(ma,"ModernPresenceTooltipControl",Gb,[730,7]);var Ob=b(276),ac=b(344),fc=b(167);Sa.prototype.RSg=function(){var Fa=document.createElement("div");this.ze.cWa(15,!1);return new ma(Fa,20,this.ze)};Object(ic.a)(Sa,"ModernPresenceTooltipFactory",null,[754]);var Uc=b(18),Vd=b(59),ld=b(174),Od=b(11),De=b(32),Yb=b(457),sa;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.master=1]="master";Fa[Fa.fixed=2]="fixed";Fa[Fa.horizontal=3]="horizontal";Fa[Fa.vertical=4]="vertical";Fa[Fa.first=1]="first";
Fa[Fa.last=4]="last"})(sa||(sa={}));Object(ic.b)("PaneType",sa);var hb=Nc.a;Cm(ha,hb);ha.prototype.oPc=function(Fa){this.addHandler("interactivityChanged",Fa)};ha.prototype.fnc=function(Fa){this.removeHandler("interactivityChanged",Fa)};ha.prototype.dispose=function(){if(0<this.yo.count){this.hide();var Fa=this.yo.Lu,lb;for(lb in Fa)Fa[lb].dispose()}this.gridView=null;this.yo.clear();hb.prototype.dispose.call(this)};ha.prototype.e9i=function(Fa){this.fxf=Fa};ha.prototype.vma=function(){var Fa=this.yo.Lu,
lb;for(lb in Fa)Fa[lb].vma()};ha.prototype.ZPa=function(){this.tdd();var Fa=this.yo.Lu,lb;for(lb in Fa)Fa[lb].ZPa()};ha.prototype.hide=function(){this.nRa();var Fa=this.yo.Lu,lb;for(lb in Fa)Fa[lb].hide()};ha.prototype.eWa=function(Fa){var lb=this.yo.Lu,pc;for(pc in lb)lb[pc].eWa(Fa)};ha.prototype.W8a=function(Fa){var lb=this.yo.Lu,pc;for(pc in lb)lb[pc].W8a(Fa)};ha.prototype.cHb=function(Fa,lb){var pc=this.yo.Lu,qc;for(qc in pc)pc[qc].cHb(Fa,lb)};ha.prototype.ema=function(Fa){this.qid!==Fa&&(this.qid=
Fa,Fa=De.a.Ec(this.yo.Lu,Enum.toString(sa,ha.aJa()[0])),this.Cxa&&Fa&&(Fa=Od.DOMElementExtensions.getWidth(Fa.element)/2,this.position(this.qid?this.Cxa.x+14+Fa:this.Cxa.x-14-Fa,this.Cxa.y)))};ha.prototype.position=function(Fa,lb){var pc=this.yo.Lu,qc;for(qc in pc){var Md=pc[qc],Pd=Enum.parse(sa,qc);Pd=this.gridView.Yf(Pd);var ee=oa(Pd,new Sys.UI.Point(Fa,lb),!1);this.Cxa=new Sys.UI.Point(Fa,lb);0>ee.x&&(ee.x+=Pd.domElement.scrollLeft);Od.DOMElementExtensions.updatePosition(Md.element,ee.x,ee.y,!1,
this.rtl)}};ha.prototype.Vy=function(){this.tdd()};ha.prototype.PE=function(){this.tdd()};ha.prototype.tdd=function(){this.Cxa&&(this.position(this.Cxa.x,this.Cxa.y),this.vFd||(this.vFd=!0,this.gridView.Ha.XF(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.Ha.Dq(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.view.nt(Object(Ga.a)(this,this.PE,"onGridLayoutModifierChange"))))};ha.prototype.nRa=function(){this.vFd&&(this.gridView.Ha.zH(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),
this.gridView.Ha.Jp(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.view.Tr(Object(Ga.a)(this,this.PE,"onGridLayoutModifierChange")))};ha.aJa=function(){return ha.sEa||(ha.sEa=[1,3,2,4])};Jl.Object.defineProperties(ha.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},blc:{configurable:!0,enumerable:!0,get:function(){var Fa=De.a.Ec(this.yo.Lu,Enum.toString(sa,ha.aJa()[0]));return Fa?Fa.blc:null}},WGi:{configurable:!0,enumerable:!0,get:function(){return this.fxf}}});
ha.sEa=null;Object(ic.a)(ha,"PaneInvariantTooltip",Nc.a,[730,7]);ba.HHb=!1;ba.sma=!1;Object(ic.a)(ba,"PresenceViewSettings",null,[]);R.prototype.dispose=function(){this.nRa();this.clearCache();this.$&&this.$.Aa&&this.$.Aa.wg(Object(Ga.a)(this,this.t5,"onSheetChanged"));this.gridView=null};R.prototype.nRa=function(){this.hdc&&(this.gridView.Ha.zH(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.Ha.Jp(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.view.Tr(Object(Ga.a)(this,
this.PE,"onGridLayoutModifierChange")),this.hdc=!1)};R.prototype.euj=function(Fa){var lb=this.Uy[Fa],pc=this.Cia(Fa);lb&&this.lEf(lb);pc&&this.Qmc(pc,lb.Gxa.clientId,lb.fB);delete this.IRa[Fa];delete this.Uy[Fa];delete this.HRa[Fa]};R.prototype.aRd=function(Fa){var lb=Fa.fB;this.Uy[lb]||(this.u2a(Fa),this.Uy[lb]=Fa)};R.prototype.fzj=function(Fa){var lb=Fa.fB,pc=this.rTe(Fa.alc,Fa.paneType,Fa.range),qc=this.Cia(lb);pc&&pc!==qc&&(Fa.NIb(pc),this.IRa[lb]=pc,this.Uy[lb]=Fa,this.HRa[lb]&&pc.ema(this.HRa[lb]));
qc!==pc&&qc&&this.Qmc(qc,Fa.Gxa.clientId,Fa.fB);!this.hdc&&this.gridView&&(this.gridView.Ha.XF(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.Ha.Dq(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.view.nt(Object(Ga.a)(this,this.PE,"onGridLayoutModifierChange")),this.hdc=!0)};R.prototype.Qmc=function(Fa,lb,pc){Fa.W8a(lb);hc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.Cia(pc)===Fa&&delete this.IRa[pc];Fa.blc&&Fa.blc.length||((lb=Fa.WGi)&&
delete this.SCb[lb],hc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.Cia(pc)===Fa&&delete this.IRa[pc],Fa.dispose())};R.prototype.lEf=function(Fa){Fa&&(Fa.aCd(Object(Ga.a)(this,this.MAb,"onHideUser")),Fa.zCd(Object(Ga.a)(this,this.yBb,"onShowUserIconTooltip")),Fa.yCd(Object(Ga.a)(this,this.xBb,"onShowUserFullTooltip")),Fa.NIb(null))};R.prototype.u2a=function(Fa){Fa.nPc(Object(Ga.a)(this,this.MAb,"onHideUser"));Fa.RPc(Object(Ga.a)(this,this.yBb,"onShowUserIconTooltip"));
Fa.QPc(Object(Ga.a)(this,this.xBb,"onShowUserFullTooltip"))};R.prototype.MAb=function(Fa){var lb=this.Cia(Fa.fB);lb&&this.Qmc(lb,Fa.Gxa.clientId,Fa.fB)};R.prototype.yBb=function(Fa){this.pW(!1,Fa)};R.prototype.xBb=function(Fa){this.pW(!0,Fa)};R.prototype.pW=function(Fa,lb){if(ba.sma){lb.lta||this.aRd(lb);this.fzj(lb);var pc=this.Cia(lb.fB);pc&&(pc.eWa(lb.Gxa),lb.EKa()?Fa?pc.ZPa():pc.vma():pc.hide())}};R.prototype.Cia=function(Fa){return this.IRa[Fa]};R.prototype.rTe=function(Fa,lb,pc){if(!Fa)return null;
Fa=this.U9c(Fa,lb);var qc=this.gridView.Yf(lb).tq;lb=R.WEh(Fa,lb,qc).toString();qc=De.a.Ec(this.SCb,lb);qc||(qc=new ha(this.gridView,this.sxd,pc),qc.position(Fa.x,Fa.y),qc.e9i(lb),this.SCb[lb]=qc);return qc};R.prototype.U9c=function(Fa,lb){var pc=this.gridView.Yf(lb).pn,qc=this.gridView.Yf(lb).tq;lb=Yb.a.qU(lb,pc.topLeft);var Md=Math.max(qc.x,Fa.x-this.Iua/2-2);Md=Math.min(Math.max(lb.x+qc.x,Md),lb.x+qc.x+pc.width-this.Iua);Fa=Math.max(qc.y,Fa.y-this.Iua/2+1);hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&
lb.y+qc.y>Fa&&(Md=Math.min(Md+this.Iua/4,lb.x+qc.x+pc.width-this.Iua));Fa=Math.min(Math.max(lb.y+qc.y,Fa),lb.y+qc.y+pc.height-this.Iua);return new Sys.UI.Point(Md,Fa)};R.prototype.clearCache=function(){var Fa=this.Uy,lb;for(lb in Fa)this.lEf(Fa[lb]);Fa=this.SCb;for(var pc in Fa)Fa[pc].dispose();this.IRa={};this.Uy={};this.SCb={};this.HRa={};jd.a.Ia(this.ina);this.ina=null};R.prototype.Vy=function(){this.J3f()};R.prototype.PE=function(){this.J3f()};R.prototype.t5=function(){this.kob();this.clearCache()};
R.prototype.FKh=function(Fa){Fa=Od.DOMElementExtensions.getBounds(Fa.element);Fa=new Vd.a(Fa.x,Fa.y,Fa.width,Fa.height);for(var lb=Ml(ha.aJa()),pc=lb.next();!pc.done;pc=lb.next())if(pc=this.gridView.Yf(pc.value),pc=Od.DOMElementExtensions.getBoundingClientRect(pc.domElement),(new Vd.a(pc.x,pc.y,pc.width,pc.height)).oe(Fa))return pc;return null};R.prototype.kob=function(){var Fa=new Ha;Fa.add(0,Uc.a.T3c);Fa.add(1,this.c0e);Fa.add(12,49);Fa.add(6,this.Iua);this.gridView&&(Fa.add(4,Xa.a.Ee(3)),Fa.add(5,
Xa.a.Ee(3)),Fa.add(8,this.gridView.rtl));Fa.add(18,!0);this.sxd=new Sa(Fa);Fa.add(16,Object(Ga.a)(this,this.FKh,"getViewPortBounds"))};R.prototype.dyj=function(Fa){var lb=new Ha;lb.add(0,Uc.a.T3c);lb.add(1,this.c0e);lb.add(12,Number.parseInvariant(Fa.toString()));lb.add(6,this.Iua);this.gridView&&(lb.add(4,Xa.a.Ee(3)),lb.add(5,Xa.a.Ee(3)),lb.add(8,this.gridView.rtl));this.sxd=new Sa(lb)};R.prototype.jzj=function(Fa){this.dyj(Fa)};R.prototype.J3f=function(){ba.sma&&(this.ina=ld.AsyncMethodContext.kx(Object(Ga.a)(this,
this.czj,"updateTooltipsPositionHelper"),100,Yd.a.gIi,this.ina))};R.prototype.czj=function(){var Fa=this.Uy,lb;for(lb in Fa){var pc=Fa[lb];if(pc){var qc=pc.EKa(),Md=this.Cia(pc.fB),Pd=qc?this.rTe(pc.alc,pc.paneType,pc.range):null;if(Pd!==Md){Md&&this.Qmc(Md,pc.Gxa.clientId,pc.fB);if(!ba.sma)break;Pd&&qc&&(Pd.eWa(pc.Gxa),this.IRa[pc.fB]=Pd,pc.NIb(Pd),this.tYe(Pd,pc))}else this.tYe(Md,pc)}}};R.prototype.tYe=function(Fa,lb){ba.sma&&(this.HRa[lb.fB]&&Fa.ema(this.HRa[lb.fB]),lb.EKa()?lb.tma(!0,!0):lb.tma(!1,
!0))};R.prototype.ema=function(Fa,lb){this.HRa[Fa]=lb;(Fa=this.Cia(Fa))&&Fa.ema(lb)};R.prototype.cHb=function(Fa,lb){var pc=this.Cia(Fa);pc&&pc.cHb(Fa,lb)};R.WEh=function(Fa,lb,pc){return Fa.x.toString()+"-"+Fa.y.toString()+"-"+lb.toString()+"-"+pc.x.toString()+"-"+pc.y.toString()};Object(ic.a)(R,"PresenceTooltipManager",null,[7]);var cc=b(103),xc=b(121),vd=Nc.a;Cm(ja,vd);ja.prototype.nPc=function(Fa){this.addHandler("hidePresenceTooltip",Fa)};ja.prototype.aCd=function(Fa){this.removeHandler("hidePresenceTooltip",
Fa)};ja.prototype.RPc=function(Fa){this.addHandler("showPresenceTooltip",Fa)};ja.prototype.zCd=function(Fa){this.removeHandler("showPresenceTooltip",Fa)};ja.prototype.QPc=function(Fa){this.addHandler("showFullPresenceTooltip",Fa)};ja.prototype.yCd=function(Fa){this.removeHandler("showFullPresenceTooltip",Fa)};ja.prototype.jEa=function(Fa){this.addHandler("presenceChanged",Fa)};ja.prototype.iya=function(Fa){this.removeHandler("presenceChanged",Fa)};ja.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");
this.raiseEvent("presenceChanged");this.uqe();this.nRa();jd.a.Ia(this.zlb);this.eae=this.domElement=this.gridView=null;vd.prototype.dispose.call(this)};ja.prototype.UKd=function(Fa,lb){var pc=!!Fa&&!Pb.D(Fa).equals(Pb.D(this.qB)),qc=!!lb&&(!this.Qj||this.Qj.get_id()!==lb.get_id());if(pc||qc)this.raiseEvent("presenceChanged"),this.uqe(),this.lta=!1,this.qB=Fa,this.Qj=lb,this.Jxb=null};ja.prototype.Z3=function(Fa){this.visible=this.lta=!1;Fa&&this.raiseEvent("hidePresenceTooltip")};ja.prototype.Pfa=
function(Fa){Array.add(this.Dx,Fa);this.s_e();Fa.jEa(Object(Ga.a)(this,this.Dtd,"onIntersectingUserPresenceChanged"))};ja.prototype.tma=function(Fa,lb){Fa?(this.visible=!0,lb&&(Fa=this.$.Ba.ShowTooltipDelayInMs,this.zlb=ld.AsyncMethodContext.kx(Object(Ga.a)(this,this.Mhj,"showTooltipAsync"),Fa,Yd.a.Lqj,this.zlb))):this.Z3(lb)};ja.prototype.NIb=function(Fa){this.eae=Fa};ja.prototype.Tbb=function(){if(this.domElement&&this.visible){this.IXa=Od.DOMElementExtensions.getBoundingClientRect(this.domElement);
var Fa=Math.floor(this.IXa.x);this.IXa.x=Fa===this.IXa.x?Fa:Fa+1;this.IXa.y=Math.floor(this.IXa.y)}};ja.prototype.EKa=function(){if(!this.qB)return!1;if(hc.EwaSettings.ka(736)){var Fa=this.dFh();return Fa?this.gridView.K4h(Fa,this.paneType):!1}Fa=this.gridView.Yf(this.paneType).pn;var lb=this.gridView.Mg(this.range,this.paneType);return Fa.oe(lb)};ja.prototype.dFh=function(){if(this.range.isSingle){var Fa=this.gridView.Ha.BIa(this.range,this.$.activeItemName);return Fa?(Fa=Fa.zs(this.range,!0))?Fa.gE:
null:null}return this.range};ja.prototype.Mhj=function(){jd.a.Ia(this.zlb);this.zlb=null;this.visible&&(this.EKa()?this.raiseEvent("showPresenceTooltip"):this.Z3(!0))};ja.prototype.uqe=function(){for(var Fa=0,lb=this.Dx.length;Fa<lb;Fa++)this.Dx[Fa].iya(Object(Ga.a)(this,this.Dtd,"onIntersectingUserPresenceChanged"));Array.clear(this.Dx);this.nRa()};ja.prototype.s_e=function(){!this.gdc&&1<=this.Dx.length&&(this.gdc=!0,this.gridView.Ha.XF(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.Ha.Dq(Object(Ga.a)(this,
this.Vy,"onBlockCacheChanged")),this.gridView.view.nt(Object(Ga.a)(this,this.PE,"onGridLayoutModifierChange")))};ja.prototype.nRa=function(){this.gdc&&!this.Dx.length&&(this.gdc=!1,this.gridView&&(this.gridView.Ha.zH(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.Ha.Jp(Object(Ga.a)(this,this.Vy,"onBlockCacheChanged")),this.gridView.view.Tr(Object(Ga.a)(this,this.PE,"onGridLayoutModifierChange"))))};ja.prototype.W8a=function(Fa){Fa.iya(Object(Ga.a)(this,this.Dtd,"onIntersectingUserPresenceChanged"));
Array.remove(this.Dx,Fa);this.nRa()};ja.prototype.Dtd=function(Fa){this.W8a(Fa)};ja.prototype.Vy=function(){this.X1f()};ja.prototype.PE=function(){this.X1f()};ja.prototype.X1f=function(){this.Tbb();for(var Fa=0,lb=this.Dx.length;Fa<lb;Fa++)this.Dx[Fa].Tbb()};Jl.Object.defineProperties(ja.prototype,{fB:{configurable:!0,enumerable:!0,get:function(){return this.NMc}},Gxa:{configurable:!0,enumerable:!0,get:function(){return this.gJc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.opa}},
alc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var Fa=this.gridView.Yf(this.paneType).pn,lb=this.gridView.rtl,pc=this.domElement.offsetWidth;if(!this.Qj&&4>=pc){if(this.qB){pc=this.gridView.Ph;var qc=this.qB.FirstRow;lb=lb?this.qB.FirstColumn:this.qB.LastColumn;if(pc&&!(qc>=pc.top&&qc<=pc.bottom&&lb>=pc.left&&lb<=pc.right))return qc=qc<=pc.top?Fa.y:Fa.y+(qc>=pc.bottom?Fa.height:Fa.height/2),lb=lb<=pc.left?Fa.x:Fa.x+(lb>=pc.right?Fa.width:Fa.width/2),this.Jxb=new Sys.UI.Point(lb,
qc)}return this.Jxb}if(this.Qj){Fa=this.domElement.offsetTop-2;qc=parseInt(this.domElement.style.left);var Md=0;lb&&(Md=parseInt(this.domElement.parentNode.style.width)-pc-qc,Md-=this.gridView.oN.Lva&&this.gridView.oN.Qkd?xc.a.Lp:0);return this.Jxb=new Sys.UI.Point((lb?Md:qc)+pc+4,Fa)}return this.Jxb=new Sys.UI.Point(parseInt(lb?this.domElement.style.right:this.domElement.style.left)+pc,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return Pb.D(this.qB)}}});Object(ic.a)(ja,
"TooltipNotificationUnit",Nc.a,[747,7]);var Xd=Nc.a;Cm(X,Xd);X.prototype.nPc=function(Fa){this.addHandler("hidePresenceTooltip",Fa)};X.prototype.aCd=function(Fa){this.removeHandler("hidePresenceTooltip",Fa)};X.prototype.RPc=function(Fa){this.addHandler("showPresenceTooltip",Fa)};X.prototype.zCd=function(Fa){this.removeHandler("showPresenceTooltip",Fa)};X.prototype.QPc=function(Fa){this.addHandler("showFullPresenceTooltip",Fa)};X.prototype.yCd=function(Fa){this.removeHandler("showFullPresenceTooltip",
Fa)};X.prototype.jEa=function(Fa){this.addHandler("presenceChanged",Fa)};X.prototype.iya=function(Fa){this.removeHandler("presenceChanged",Fa)};X.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.Tx&&this.Tx.euj(this.fB);var Fa=this.Uy,lb;for(lb in Fa){var pc=Fa[lb];pc.aCd(Object(Ga.a)(this,this.MAb,"onHideUser"));pc.zCd(Object(Ga.a)(this,this.yBb,"onShowUserIconTooltip"));pc.yCd(Object(Ga.a)(this,this.xBb,"onShowUserFullTooltip"));pc.iya(Object(Ga.a)(this,
this.mBb,"onPresenceChanged"));pc.dispose()}this.Tx=this.kd=this.highlight=this.gridView=this.Uy=null;Xd.prototype.dispose.call(this)};X.prototype.sUf=function(Fa,lb,pc){pc=void 0===pc?null:pc;Fa?(this.kd=Pb.D(Fa),this.opa=this.gridView.$a.fk(this.kd.topRight)):pc?(this.Qj=pc,this.opa=pc.Ig.paneType):this.opa=1;this.ece=lb;this.Yta(this.paneType);this.UKd(Fa,pc)};X.prototype.UKd=function(Fa,lb){var pc=this.Uy,qc;for(qc in pc)pc[qc].UKd(Fa,lb)};X.prototype.Z3=function(Fa){this.Yta(this.paneType).Z3(Fa);
Fa=this.Uy;for(var lb in Fa)Fa[lb].Z3(!1)};X.prototype.Qde=function(Fa){var lb=this.Uy,pc;for(pc in lb){var qc=lb[pc];qc.Pfa(Fa.Yta(qc.paneType))}};X.prototype.Pfa=function(Fa){this.Yta(Fa.paneType).Pfa(Fa)};X.prototype.EKa=function(){var Fa=this.Yta(this.paneType).EKa(),lb=this.Uy,pc;for(pc in lb)Fa=lb[pc].EKa()||Fa;return Fa};X.prototype.tma=function(Fa,lb){this.Tx.aRd(this);this.Yta(this.paneType).tma(Fa,lb);lb=this.Uy;for(var pc in lb)lb[pc].tma(Fa,!1)};X.prototype.NIb=function(Fa){var lb=this.Uy,
pc;for(pc in lb)lb[pc].NIb(Fa)};X.prototype.Tbb=function(){var Fa=this.Uy,lb;for(lb in Fa)Fa[lb].Tbb();this.Tx.aRd(this)};X.prototype.Yta=function(Fa){return this.gEh(Fa,this.ece)};X.prototype.gEh=function(Fa,lb){var pc=this.highlight?this.highlight.sJ(lb,Fa).hn:this.Qj?this.Qj.get_element():null;lb=X.ZJh(lb,Fa);var qc=De.a.Ec(this.Uy,lb);qc||(qc=new ja(pc,this.gridView,this.Gxa,Fa,this.$),this.Uy[lb]=qc,qc.nPc(Object(Ga.a)(this,this.MAb,"onHideUser")),qc.RPc(Object(Ga.a)(this,this.yBb,"onShowUserIconTooltip")),
qc.QPc(Object(Ga.a)(this,this.xBb,"onShowUserFullTooltip")),qc.jEa(Object(Ga.a)(this,this.mBb,"onPresenceChanged")));return qc};X.prototype.MAb=function(Fa){this.gqa&&this.gqa!==Fa||(this.gqa=null,this.Z3(!1));this.raiseEvent("hidePresenceTooltip")};X.prototype.yBb=function(Fa){this.gqa&&this.gqa!==Fa||(this.gqa=null,this.tma(!0,!1));this.raiseEvent("showPresenceTooltip")};X.prototype.xBb=function(Fa){this.gqa||this.raiseEvent("showFullPresenceTooltip");this.gqa=Fa};X.prototype.mBb=function(){this.Z3(!1);
this.raiseEvent("presenceChanged")};X.ZJh=function(Fa,lb){return Fa.toString()+lb.toString()};Jl.Object.defineProperties(X.prototype,{fB:{configurable:!0,enumerable:!0,get:function(){return this.NMc}},Gxa:{configurable:!0,enumerable:!0,get:function(){return this.gJc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.opa}},range:{configurable:!0,enumerable:!0,get:function(){return this.kd}},alc:{configurable:!0,enumerable:!0,get:function(){return this.kd||this.Qj?oa(this.gridView.Yf(this.paneType),
this.Yta(this.paneType).alc,!0):null}},lta:{configurable:!0,enumerable:!0,get:function(){return this.Yta(this.paneType).lta},set:function(Fa){var lb=this.Uy,pc;for(pc in lb)lb[pc].lta=Fa}}});Object(ic.a)(X,"PaneInvariantTooltipNotificationUnit",Nc.a,[747,7]);ea.prototype.dispose=function(){this.jub();jd.a.Ia(this.Su);this.objectId=this.$=this.Xq=this.Qj=null};ea.prototype.Pfa=function(Fa){this.Su.Qde(Fa.Su)};ea.prototype.jub=function(){this.Qj&&this.Xq&&this.Xq.User&&(this.Qj.Kvc(!1,this.Xq.User.UserID,
null),this.Su.Z3(!0))};ea.prototype.cIb=function(){ba.HHb&&this.Qj&&this.Xq&&this.Xq.User&&(this.Qj.Kvc(!0,this.Xq.User.UserID,this.Xq.UserColor),this.Su.Tbb())};ea.prototype.pW=function(Fa){ba.sma&&(this.Su.lta=Fa,this.Su.tma(Fa,!0))};ea.prototype.kIb=function(Fa,lb){this.Su.sUf(null,lb?39:38,Fa)};Jl.Object.defineProperties(ea.prototype,{Qj:{configurable:!0,enumerable:!0,get:function(){return this.yTa},set:function(Fa){(this.yTa=Fa)&&this.Tx.jzj(this.yTa.wz)}}});Object(ic.a)(ea,"FloatingObjectPresenceHighlight",
null,[728,7]);var Je=b(659),ff=b(78),Ye=b(9),Pe=b(256),wf=Je.a;Cm(P,wf);P.prototype.dispose=function(){jd.a.Ia(this.Su);wf.prototype.dispose.call(this);var Fa=P.KYa,lb;for(lb in Fa){var pc=lb,qc=Fa[lb];qc&&!qc.children.length&&(Od.DOMElementExtensions.rg(qc),P.KYa[pc]=null)}};P.prototype.Pfa=function(Fa){this.Su.Qde(Fa.Su)};P.prototype.pW=function(Fa){ba.sma&&(this.scc||(this.Su.lta=Fa,this.Su.tma(Fa,!0)),this.fIb=Fa&&this.scc)};P.prototype.kIb=function(Fa,lb){this.Su.sUf(Fa,lb?39:38);this.fIb=!1};
P.prototype.cIb=function(Fa){ba.HHb&&(this.Su.tma(!0,!0),this.$Td=Fa,this.Wr([Fa]))};P.prototype.jub=function(Fa){this.Z3();this.ll(Fa)};P.prototype.nwe=function(Fa,lb,pc){pc.className=ff.a.ygh;pc.style.borderColor=this.Xq.UserColor;var qc=document.createElement("div");38!==Fa&&39!==Fa&&(qc.style.backgroundColor=this.Xq.UserColor);pc.appendChild(qc);qc.className=[ff.a.Agh,ff.a.zgh][Fa-38];Fa=De.a.Ec(P.KYa,lb.toString());Fa||(qc=this.gridView.Yf(lb).domElement,Fa=document.createElement("div"),qc.insertBefore(Fa,
qc.firstChild),P.KYa[lb.toString()]=Fa);Fa.appendChild(pc)};P.prototype.q$b=function(){};P.prototype.AOf=function(Fa,lb,pc,qc){var Md=this.yvg(qc,Fa,lb);Pe.b(pc,this.gridView.rtl,Ye.HelperMethods.Ub(Md.x));pc.width=Ye.HelperMethods.Ub(Md.width);pc.top=Ye.HelperMethods.Ub(Md.y);pc.height=Ye.HelperMethods.Ub(Md.height);lb=lb.hn;pc=lb.parentNode;39===Fa?P.Hzd(pc,lb,!1):38===Fa&&(Md=this.sJ(39),qc.equals(Md.gec)?P.Hzd(pc,lb,!1):P.Hzd(pc,lb,!0));this.dHi(Fa)};P.prototype.gSf=function(){return!1};P.prototype.yvg=
function(Fa,lb,pc){var qc=Fa.y+this.qsb(pc,!1);pc=Fa.x+this.qsb(pc,!0)+xc.a.H7c(pc.hn.parentNode.parentNode,this.gridView.rtl);var Md=Fa.width;Fa=Fa.height+1;1>pc&&-1<=pc&&38===lb&&(Md-=1-pc,pc=1);1>qc&&-1<=qc&&38===lb&&(Fa-=1-qc,qc=1);Md=Math.max(0,Md-1);Fa=Math.max(0,Fa-2);return new Vd.a(pc,qc,Md,Fa)};P.prototype.dHi=function(Fa){this.Su.Tbb();this.$Td=Fa;this.scc=!1;this.fIb&&this.pW(!0);this.fIb=!1};P.prototype.Z3=function(){this.scc||(this.Su.Z3(!0),this.fIb=!1)};P.Hzd=function(Fa,lb,pc){pc?
lb!==Fa.firstChild&&(Fa.removeChild(lb),Fa.insertBefore(lb,Fa.firstChild)):lb!==Fa.lastChild&&(Fa.removeChild(lb),Fa.appendChild(lb))};P.KYa=null;Object(ic.a)(P,"PresenceHighlight",Je.a,[]);Cm(L,ca);L.prototype.nsc=function(){for(var Fa=1===this.uc.PresenceType?39:38,lb=0;lb<this.Sx.length;lb++)this.Sx[lb].cIb(Fa);for(Fa=0;Fa<this.tG.count;Fa++)this.tG.Xf(Fa).cIb()};L.prototype.p$b=function(){for(var Fa=1===this.uc.PresenceType?39:38,lb=0;lb<this.Sx.length;lb++)this.Sx[lb].jub([Fa]);for(Fa=0;Fa<this.tG.count;Fa++)this.tG.Xf(Fa).jub()};
L.prototype.dispose=function(){this.$&&(this.$.Aa&&this.$.Aa.wg(Object(Ga.a)(this,this.t5,"onSheetChanged")),Rd.g(this.$).$Q(Object(Ga.a)(this,this.Ks,"onAfterAllBlocksUpdated")));this.$ze();jd.a.rc(this.Sx);jd.a.rc([this.qz]);this.qz=this.$=null;this.kId(null);this.tG=null;ca.prototype.dispose.call(this)};L.prototype.$ze=function(){if(this.tG){for(var Fa=0;Fa<this.tG.count;Fa++)this.tG.Xf(Fa).dispose();this.tG.clear()}};L.prototype.iYa=function(Fa){1===this.uc.Version?this.aKg(Fa):this.bKg(Fa)};
L.prototype.aKg=function(Fa){if(Fa.uc.SelectedRange&&this.uc.SelectedRange)for(var lb=this.uc.SelectedRange.length,pc=Fa.uc.SelectedRange.length,qc=0;qc<lb;qc++)for(var Md=0;Md<pc;Md++)if(Kb(this.uc.SelectedRange[qc],Fa.uc.SelectedRange[Md])){this.Sx[qc].Pfa(Fa.p1a(Md));return}};L.prototype.bKg=function(Fa){var lb=0,pc=0;if(this.uc&&this.uc.Object&&Fa.uc&&Fa.uc.Object)for(var qc=this.uc.Object.length,Md=Fa.uc.Object.length,Pd=0;Pd<qc;Pd++)if(this.uc.Object[Pd]&&this.vad(this.uc.Object[Pd])){lb++;
for(var ee=0;ee<Md;ee++)if(Fa.uc.Object[ee]&&this.vad(Fa.uc.Object[ee])&&(pc++,this.$Qc(this.uc.Object[Pd],Fa.uc.Object[ee]))){var xf=this.p1a(lb),Se=Fa.p1a(pc);if(xf&&Se){xf.Pfa(Se);return}}}else if(this.uc.Object[Pd]&&Fa.uc.Object[Pd]&&(!this.uc.Object[Pd].ObjectType||2===this.uc.Object[Pd].ObjectType))for(ee=0;ee<Md;ee++)if(Fa.uc.Object[ee]&&(!Fa.uc.Object[Pd].ObjectType||2===Fa.uc.Object[Pd].ObjectType)&&this.uc.Object[Pd].ObjectId===Fa.uc.Object[ee].ObjectId&&(xf=this.w9c(this.uc.Object[Pd].ObjectId),
Se=Fa.w9c(this.uc.Object[Pd].ObjectId),xf&&Se)){xf.Pfa(Se);return}if(Fa.uc.SelectedRange&&this.uc.SelectedRange)for(qc=this.uc.SelectedRange.length,Md=Fa.uc.SelectedRange.length,Pd=0;Pd<qc;Pd++)for(ee=0;ee<Md;ee++)if(Kb(this.uc.SelectedRange[Pd],Fa.uc.SelectedRange[ee])&&(xf=this.p1a(lb+Pd),Se=Fa.p1a(pc+ee),xf&&Se)){xf.Pfa(Se);return}};L.prototype.$Qc=function(Fa,lb){return!!Fa&&!!lb&&lb.ObjectType===Fa.ObjectType&&(1===Fa.ObjectType||3===Fa.ObjectType)&&!Fa.ObjectId.localeCompare(lb.ObjectId)};L.prototype.p1a=
function(Fa){return 0<=Fa&&this.Sx.length>Fa?this.Sx[Fa]:null};L.prototype.kUf=function(Fa){for(var lb=0,pc=this.Sx.length;lb<pc;lb++)this.Sx[lb].pW(Fa)};L.prototype.w9c=function(Fa){return Fa&&this.tG.tb(Fa)?this.tG.getItem(Fa):null};L.prototype.lUf=function(Fa,lb){lb=void 0===lb?null:lb;if(Fa)(Fa=this.tG.getItem(lb))&&Fa.pW(!0);else for(Fa=0;Fa<this.tG.count;Fa++)(lb=this.tG.Xf(Fa))&&lb.pW(!1)};L.prototype.d3f=function(Fa){ca.Xxj(this,Fa)};L.prototype.xZc=function(Fa,lb){if(Fa<lb)return this.Sx[Fa];
if(!this.Xq||!this.$||!this.Tx)return null;Fa=new P(this.Xq,this.$,this.Tx);Array.add(this.Sx,Fa);return Fa};L.prototype.N7i=function(){for(var Fa=this.Sx.length,lb=this.uc.SelectedRange?this.uc.SelectedRange.length:0,pc=this.$.Aa.sa,qc=0;qc<lb;qc++){var Md=this.xZc(qc,Fa);Md&&this.uc.SelectedRange[qc]&&(this.uc.SelectedRange[qc].NamedObjectName?Md.ll([39,38]):(Md.kIb(this.uc.SelectedRange[qc],this.uc.PresenceType),L.HQd(this.uc.PresenceType,Md,this.uc.SelectedRange[qc],pc,this.Xq,this.Tx)))}for(lb=
this.qz&&this.qz.Pxd&&this.qz.Pxd.PresenceType!==this.qz.uc.PresenceType?0:lb;lb<Fa;lb++)this.Sx[lb].ll([1===this.qz.Pxd.PresenceType?39:38])};L.prototype.vad=function(Fa){return Fa&&Fa.ObjectId&&(1===this.hSe(Fa.ObjectType)||2===this.hSe(Fa.ObjectType))&&(Fa=this.$.Ab.p$c(Fa.ObjectId))?Pb.w(Fa):null};L.prototype.O7i=function(){for(var Fa=this.Sx.length,lb=this.$.Aa.sa,pc=this.uc.SelectedRange?this.uc.SelectedRange.length:0,qc=this.uc.Object?this.uc.Object.length:0,Md=0;Md<Fa;Md++)this.Sx[Md].ll([39,
38]);this.jLg();for(var Pd=this.qYc=this.pYc=Md=0;Pd<qc;Pd++){var ee=this.uc.Object[Pd],xf=this.vad(ee);if(xf){var Se=this.xZc(Md,Fa);1===ee.ObjectType?this.pYc++:3===ee.ObjectType&&this.qYc++;Md++;Se.kIb(xf,ee.ObjectPresenceType);L.HQd(ee.ObjectPresenceType,Se,xf,lb,this.Xq,this.Tx)}}for(qc=0;qc<pc;qc++)this.uc&&this.uc.SelectedRange&&(Pd=this.uc.SelectedRange[qc],Pd.NamedObjectName||(ee=!!lb&&Pd.SheetName===lb.name,xf=!!Ua(Pd,this.$,1),ee&&xf||(ee=this.xZc(Md+qc,Fa),ee.kIb(Pd,this.uc.PresenceType),
L.HQd(this.uc.PresenceType,ee,Pd,lb,this.Xq,this.Tx))));0<(this.countFloatingObjects=this.aNf())&&cb.ULS.sendTraceTag(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};L.prototype.jLg=function(){this.aNf();this.$ze()};L.prototype.aNf=function(){var Fa=0;if(this.uc&&this.uc.Object)for(var lb=0;lb<this.uc.Object.length;lb++)this.Gwj(this.uc.Object[lb])&&Fa++;return Fa};L.prototype.$Vg=function(Fa,lb){if(this.tG.tb(lb))return lb=this.tG.getItem(lb),lb.Qj=Fa,lb;if(!this.Xq||!this.$||
!this.Tx)return null;var pc=new ea(this.Xq,this.$,this.Tx);pc.Qj=Fa;this.tG.add(lb,pc);return pc};L.prototype.Gwj=function(Fa){var lb=!1;if(Fa&&Fa.ObjectId&&(!Fa.ObjectType||2===Fa.ObjectType))try{var pc=this.Izh(Fa);if(pc){var qc=this.$Vg(pc,Fa.ObjectId);qc.kIb(pc,Fa.ObjectPresenceType);qc.cIb();lb=!0}}catch(Md){throw cb.ULS.sendTraceTag(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',Md.stack),Md;}return lb};L.prototype.Izh=function(Fa){if(!Fa)return null;var lb=null;
2===Fa.ObjectType?lb=cc.a(this.$).N7b(Fa.ObjectId):Fa.ObjectType||(Fa=this.$.Ab.p$c(Fa.ObjectId))&&Fa.Xia&&(lb=cc.a(this.$).qBh(Fa.Xia));return lb};L.prototype.nHd=function(){try{1===this.uc.Version?(this.N7i(),cb.ULS.sendTraceTag(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.O7i(),cb.ULS.sendTraceTag(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,this.pYc,this.qYc))}catch(Fa){throw cb.ULS.sendTraceTag(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',
Fa.stack),Fa;}};L.prototype.Ks=function(){this.nHd()};L.prototype.t5=function(){this.nHd()};L.prototype.hSe=function(Fa){switch(Fa){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};L.HQd=function(Fa,lb,pc,qc,Md,Pd){var ee=1===Fa?39:38;qc&&pc&&qc.name===pc.SheetName?(lb.qm(Pb.D(pc),[ee]),lb.cIb(ee),cb.ULS.shipAssertTag(41754975,0,lb.Su.fB===Md.User.UserID,"UserID and UnitID should match"),Pd.cHb(lb.Su.fB,1===Fa)):lb.jub([ee])};Jl.Object.defineProperties(L.prototype,
{uc:{configurable:!0,enumerable:!0,get:function(){return this.qz.uc},set:function(Fa){this.qz.uc=Fa;this.nHd()}}});Object(ic.a)(L,"UserGridPresence",ca,[]);var lf=b(47),kg=b(906),Bg=Nc.a;Cm(Y,Bg);Y.prototype.jEa=function(Fa){this.addHandler("pcek",Fa)};Y.prototype.iya=function(Fa){this.removeHandler("pcek",Fa)};Y.prototype.MEf=function(Fa){this.hAa[Fa]&&this.BEf(Fa,!1)};Y.prototype.LLd=function(Fa){this.Iob&&this.Iob!==Fa.clientId&&(this.fJd=!1);!hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||
this.$.fa.n2a&&lf.PageLoadTrackingInfo.instance.z5i||(this.fJd=!1);this.xK.hPg(Fa);this.Iob=Fa.clientId};Y.prototype.wBh=function(Fa,lb){var pc=[];var qc=[];var Md=this.hAa,Pd;for(Pd in Md){var ee=Md[Pd];if(lb){var xf=Pb.k(Fa,this.$);this.KVe(xf,pc,qc,ee)}else this.JVe(Fa,pc,qc,ee)}return{OXh:pc,C6g:qc}};Y.prototype.Sye=function(Fa,lb,pc,qc,Md){(Md=this.hAa[Md])&&(lb?this.KVe(Fa,pc,qc,Md):this.JVe(Fa,pc,qc,Md))};Y.prototype.OKh=function(){var Fa=[],lb=this.hAa,pc;for(pc in lb){var qc=lb[pc],Md=qc.uc.SelectedRange;
if(void 0!==Md&&null!==Md&&hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){Md=Ml(Md);for(var Pd=Md.next();!Pd.done;Pd=Md.next()){Pd=Pd.value;var ee=Pb.D(Pd),xf=Rd.g(this.$).ga.ya.z3;if(this.$.Aa.sa.sheetName===Pd.SheetName&&ee.right===xf.right&&ee.top===xf.top){qc=qc.Xq;qc=new Hd.a(qc.User.UserID,qc.User.UserName,qc.UserColor,new Zd.a(1),null,qc.UserEmail,void 0,void 0,void 0,void 0,void 0,qc.JoinCoauthTime);Array.add(Fa,qc);break}}}}return Fa};Y.prototype.nsc=
function(){ba.HHb=!0;ba.sma=!0;var Fa=this.mu,lb;for(lb in Fa)Fa[lb].nsc()};Y.prototype.p$b=function(){ba.HHb=!1;ba.sma=!1;var Fa=this.mu,lb;for(lb in Fa)Fa[lb].p$b()};Y.prototype.dispose=function(){this.gKb();this.$&&(this.$.Aa&&this.$.Aa.wg(Object(Ga.a)(this,this.t5,"onSheetChanged")),this.$.ra&&this.$.ra.lya(Object(Ga.a)(this,this.yAa,"webServiceAdjustContextEventHandler")),this.$.Xo(Object(Ga.a)(this,this.Yd,"onWorkbookClosing")));this.sn&&this.sn.TBd(Object(Ga.a)(this,this.sAb,"onConnectionCompleted"));
this.tRc&&(this.tRc.dispose(),this.tRc=null);if(this.mu){var Fa=this.mu,lb;for(lb in Fa)Fa[lb].dispose()}jd.a.rc([this.xK,this.Tx]);this.Ype();this.mu=this.$=this.X8d=null;Array.clear(this.Dx);Bg.prototype.dispose.call(this)};Y.prototype.gKb=function(){this.xK&&(this.xK.iya(Object(Ga.a)(this,this.zud,"onSelectionPresenceChanged")),this.xK.zTi(Object(Ga.a)(this,this.imf,"onEcsUserListChanged")),this.xK.$Ui(Object(Ga.a)(this,this.Bqf,"onPresenceDisabled")),this.xK.mca(Object(Ga.a)(this,this.nd,"onSelectionChanged")));
this.kMa.IFf(Object(Ga.a)(this,this.aBb,"onNamedSheetViewConversionUpdated"))};Y.prototype.imf=function(){var Fa=this.Vka,lb;for(lb in Fa)Fa=lb,this.Nde(Fa)?(this.efc(Fa,!0),delete this.D7a[Fa],delete this.Vka[Fa]):cb.ULS.sendTraceTag(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",Fa)};Y.prototype.zud=function(Fa,lb){Fa={};Fa.UpdatedCount=lb.bI?Object.keys(lb.bI).length:0;Fa.DisconnectedCount=lb.mha?lb.mha.length:0;hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")&&
(Fa.Location="canvas");uc.b(this.$).Jd(gc.a.txd,Fa);Fa=null;this.$.Zb&&(Fa=this.$.Zb.yi("ModelUpdate","PresenceRendering"),Fa.start());var pc={};if(lb.bI){if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var qc=(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(this.$.ea,435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(df){df.result.ndi(qc)},this.$.ma,3)}this.Qqb||(this.Gnd(!0),this.Qqb=!0);var Md=lb.bI;
for(cf in Md){var Pd=Md[cf],ee=cf;this.yed[ee]=be.a.Ta.Lb;this.Are(ee,new Date);this.Ivg(Pd);if(ee!==this.Iob){var xf=this.mu[ee];xf||(this.Nde(ee)?this.efc(ee,!0):(ee in this.Vka?cb.ULS.sendTraceTag(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",ee):(this.D7a[ee]=be.a.Ta.Lb,pc[ee]=1),this.Vka[ee]=!0,xf=this.AEh(ee),this.mu[ee]=this.ywe(xf)),xf=this.mu[ee]);xf&&(xf.uc=Pd,Pd.SelectedRange&&1<Pd.SelectedRange.length?this.b0b++:this.a0b++,this.KEf(ee),this.iYa(xf))}}if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&
this.$.fa&&this.$.fa.n2a){var Se=(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(this.$.ea,435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(df){df.result.odi(Se)},this.$.ma,3)}}if(lb.mha){var cf=0;for(Md=lb.mha.length;cf<Md;cf++)ee=lb.mha[cf],this.X0c[ee]=be.a.Ta.Lb,this.BEf(ee,!0)}if(lb.mha&&0<lb.mha.length||0<kg.a(pc).length||0<kg.a(this.Vka).length)cf=[],Array.addRange(cf,kg.a(pc)),Array.addRange(cf,kg.a(this.Vka)),(pc=this.$.ea.Ea(292,
void 0))&&pc.iwc(cf,lb.mha);Fa&&Fa.stop();this.qcd=!1;Fa=this.mu;for(var dh in Fa)if(!Object(Bb.a)(ca,Fa[dh]).uc.CollabMode){this.qcd=!0;break}this.raiseEvent("pcek",lb)};Y.prototype.yAa=function(Fa,lb){lb&&this.$.Ex&&(lb.Ukb.HasAnyNonOcsCoauthor=this.qcd)};Y.prototype.ywe=function(Fa){return new L(Fa,this.$,this.Tx)};Y.prototype.Nde=function(Fa){var lb=this.$.fa.fbd(Fa);if(lb)if(Fa in this.mu)this.mu[Fa].d3f(lb);else{var pc=this.ywe(lb);this.mu[Fa]=pc;this.iYa(pc)}return!!lb};Y.prototype.KVe=function(Fa,
lb,pc,qc){if(Fa){Fa=Ml(Fa);for(var Md=Fa.next();!Md.done;Md=Fa.next()){if(Md=Md.value){var Pd=Ua(Md,this.$,1);if(Pd&&Y.hbd(Pd.qj,lb,pc,qc))break;if((Pd=Ua(Md,this.$,2))&&Y.hbd(Pd.qj,lb,pc,qc))break}if(qc.uc.SelectedRange){Pd=Ml(qc.uc.SelectedRange);for(var ee=Pd.next();!ee.done;ee=Pd.next())if((ee=ee.value)&&Md&&Kb(Md,ee)){Array.add(1===qc.uc.PresenceType?pc:lb,qc.qz.VKb.User);return}}}}};Y.prototype.JVe=function(Fa,lb,pc,qc){Fa&&Y.hbd(this.Ozh(Fa),lb,pc,qc)};Y.prototype.aBb=function(){var Fa=new Wc.a({},
null),lb=this.hAa,pc;for(pc in lb){var qc=pc,Md=lb[pc].uc;Md.SelectedRange=Md.SelectedRangeRaw;Fa.bI[qc]=Md}this.zud(this,Fa)};Y.prototype.Ivg=function(Fa){Fa.SelectedRange&&(Fa.SelectedRangeRaw=this.Q_g(Fa.SelectedRange),Fa.SelectedRange=this.kMa.FQg(Fa.SelectedRange))};Y.prototype.Q_g=function(Fa){for(var lb=Array(Fa.length),pc=0;pc<Fa.length;pc++){var qc=pc,Md=Fa[pc],Pd={};Pd.SheetName=Md.SheetName;Pd.FirstColumn=Md.FirstColumn;Pd.FirstRow=Md.FirstRow;Pd.LastRow=Md.LastRow;Pd.LastColumn=Md.LastColumn;
Pd.NamedObjectName=Md.NamedObjectName;lb[qc]=Pd}return lb};Y.prototype.Ozh=function(Fa){if(Fa)switch(Fa.type){case 0:return(Fa=this.$.Ab.gSe(Fa.id))?Fa.qj:null;case 2:return Fa.qj}return null};Y.prototype.u2a=function(){this.xK.jEa(Object(Ga.a)(this,this.zud,"onSelectionPresenceChanged"));this.xK.Vtg(Object(Ga.a)(this,this.Bqf,"onPresenceDisabled"));this.xK.Xrg(Object(Ga.a)(this,this.imf,"onEcsUserListChanged"));this.xK.E1(Object(Ga.a)(this,this.nd,"onSelectionChanged"));this.kMa.qfe(Object(Ga.a)(this,
this.aBb,"onNamedSheetViewConversionUpdated"))};Y.prototype.Bcf=function(Fa,lb,pc,qc){var Md={};Md.a=this.$.Ba.UserSessionId;Md.b=Fa;Md.c=pc?"PendingUserRemoved":"Non-PendingUserRemoved";Md.d=qc?"Disconnected":"Inactivity";Md.e=lb;Xb.b().Se(22,Md,!0)};Y.prototype.BEf=function(Fa,lb){Fa in this.mu&&(this.KEf(Fa),this.mu[Fa].dispose(),delete this.mu[Fa],cb.ULS.sendTraceTag(38322520,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",Fa),this.Bcf(Fa,be.a.Ta.Lb,!1,lb));Fa in
this.Vka&&(this.efc(Fa,!1),delete this.D7a[Fa],delete this.Vka[Fa],cb.ULS.sendTraceTag(38322521,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",Fa),this.Bcf(Fa,be.a.Ta.Lb,!0,lb))};Y.prototype.KEf=function(Fa){for(var lb=this.Dx.length-1;0<=lb;lb--)if(this.Dx[lb].User.UserID===Fa){Array.removeAt(this.Dx,lb);for(var pc=Ml(this.mu[Fa].Sx),qc=pc.next();!qc.done;qc=pc.next())this.Tx.ema(qc.value.Su.fB,!1);this.qsc()}};Y.prototype.nd=function(){this.eYe()};Y.prototype.eei=
function(){this.fmd&&me.a(be.a.Ta,this.fmd)<this.mcf||(this.fmd=be.a.Ta.Lb,this.knd(),this.ybi(),this.aci(),this.Qqb||this.Gnd(!1))};Y.prototype.aci=function(){if(this.a0b||this.b0b)this.$.Re(-70383382,-1,0,null),cb.ULS.sendTraceTag(41477068,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.b0b,this.a0b);this.b0b=this.a0b=0};Y.prototype.t5=function(){this.eYe();var Fa=this.mu,lb;for(lb in Fa)this.iYa(Fa[lb])};
Y.prototype.Yd=function(){this.knd();this.Qqb||this.Gnd(!1);this.Qqb=!1};Y.prototype.Ype=function(){this.knd();this.UIc=this.D7a=null};Y.prototype.knd=function(){var Fa=this.Vka,lb;for(lb in Fa)this.efc(lb,!1)};Y.prototype.ybi=function(){var Fa=this.X0c,lb;for(lb in Fa)this.pcf(lb,!0,Fa[lb]);Fa=this.yed;for(var pc in Fa)this.pcf(pc,!1,Fa[pc]);this.X0c={};this.yed={}};Y.prototype.efc=function(Fa,lb){if(this.$.Ex&&this.$.fa.pc){var pc={};pc.a=this.$.Ba.UserSessionId;pc.b=Fa;pc.c=lb;pc.e=!1;pc.d=-1;
pc.f=be.a.Ta.Lb;this.$.fa&&(pc.e=this.$.fa.UL);if(Fa=this.D7a[Fa])pc.d=me.a(be.a.Ta,Fa);Xb.b().Se(20,pc,!0)}};Y.prototype.Gnd=function(Fa){if(this.$.Ex){var lb={e:-1,f:-1,c:!1,d:!1};lb.b=Fa;lb.a=this.$.Ba.UserSessionId;this.$.fa&&(lb.c=this.$.fa.n2a,lb.d=this.$.fa.UL,lb.e=this.$.fa.Lm.length,this.$.fa.CAa&&(lb.f=me.a(be.a.Ta,this.$.fa.SCj)));Xb.b().Se(21,lb,!0)}};Y.prototype.pcf=function(Fa,lb,pc){if(this.$.Ex){var qc={};qc.a=this.$.Ba.UserSessionId;qc.b=Fa;qc.c=lb;qc.d=pc;Xb.b().Se(19,qc,!0)}};Y.prototype.eYe=
function(){var Fa=[],lb=this.mu,pc;for(pc in lb){var qc=lb[pc];if(this.xK.$Lf(qc.uc)){this.vee(Fa,qc);Array.remove(this.Dx,qc.qz.VKb);if(1===this.xK.uc.PresenceType){var Md={};Md.a=1===qc.uc.PresenceType?"Editing":"Non-Editing";Md.b=this.$.Ba.UserSessionId;Md.c=be.a.Ta.Lb;Xb.b().Se(18,Md)}Md=Ml(qc.Sx);for(qc=Md.next();!qc.done;qc=Md.next())this.Tx.ema(qc.value.Su.fB,!0)}else for(Md=Ml(qc.Sx),qc=Md.next();!qc.done;qc=Md.next())this.Tx.ema(qc.value.Su.fB,!1)}Array.clear(this.Dx);this.Dx=Fa;this.qsc()};
Y.prototype.vee=function(Fa,lb){var pc=lb.qz.VKb;if(lb.uc.PresenceType)Array.add(Fa,pc);else{lb=Fa.length;var qc;for(qc=0;qc<lb&&!this.mu[Fa[qc].User.UserID].uc.PresenceType;qc++);Array.insert(Fa,qc,pc)}};Y.prototype.Bqf=function(){var Fa=this.mu,lb;for(lb in Fa)Fa[lb].dispose();this.mu={};this.Ype();this.D7a={};this.UIc={};Array.clear(this.Dx);this.qsc()};Y.prototype.sAb=function(Fa,lb){this.LLd(lb.lh)};Y.prototype.iYa=function(Fa){this.xK.$Lf(Fa.uc)&&(this.vee(this.Dx,Fa),this.qsc());var lb=Fa.qz.VKb.User.UserID,
pc=this.mu,qc;for(qc in pc){var Md=pc[qc];qc!==lb&&Fa.iYa(Md)}};Y.prototype.qsc=function(){0<this.Dx.length&&this.Nhj()};Y.prototype.Nhj=function(){for(var Fa=0,lb=this.Dx.length;Fa<lb;Fa++){var pc=this.mu[this.Dx[Fa].User.UserID];if(pc)if(this.xK.dBf(pc.uc)){pc.kUf(!0);pc=Ml(pc.Sx);for(var qc=pc.next();!qc.done;qc=pc.next())this.Tx.ema(qc.value.Su.fB,!0)}else(qc=this.xK.sRe(pc.uc))&&pc.lUf(!0,qc)}};Y.prototype.AEh=function(Fa){var lb={User:{}};lb.User.UserID=Fa;lb.User.UserName=Gd.a.instance.Eb(86);
lb.UserColor="#AAAAAA";return lb};Y.prototype.Are=function(Fa,lb){var pc=this;this.fJd&&this.lxd&&(Fa&&lb?this.kxd?this.kxd.x8g(Fa,lb,this.Iob):this.lxd.continueWith(function(){pc.kxd=pc.lxd.result;pc.Are(Fa,lb)}):cb.ULS.sendTraceTag(42481443,0,15,"userId: [{0}], endTime: [{1}]",Fa,lb))};Y.hbd=function(Fa,lb,pc,qc){if(!qc||!qc.uc||!qc.uc.Object)return!1;for(var Md=Ml(qc.uc.Object),Pd=Md.next();!Pd.done;Pd=Md.next())if(Pd=Pd.value,Fa&&Pd&&Pd.ObjectId&&!Pd.ObjectId.localeCompare(Fa))return Array.add(1===
Pd.ObjectPresenceType?pc:lb,qc.qz.VKb.User),!0;return!1};Jl.Object.defineProperties(Y.prototype,{xK:{configurable:!0,enumerable:!0,get:function(){return this.X8d}},hAa:{configurable:!0,enumerable:!0,get:function(){return this.mu}},Vka:{configurable:!0,enumerable:!0,get:function(){return this.UIc}}});Object(ic.a)(Y,"PresenceView",Nc.a,[668,669]);var Qf=b(192),Ug=b(214),Kf=b(461),Of=Nc.a;Cm(fa,Of);fa.prototype.np=function(Fa){this.addHandler("OSC",Fa)};fa.prototype.Kp=function(Fa){this.removeHandler("OSC",
Fa)};fa.prototype.fw=function(){this.raiseEvent("OSC")};fa.prototype.Mq=function(Fa,lb){if("QueryOcsConnectionStatus"===Fa)lb.Value=this.$.fa.I4a?Gd.a.instance.da(871):Gd.a.instance.da(872);else return!1;return!0};fa.prototype.Km=function(){return!0};fa.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.UC(this),this.statusBarManager=null);this.$=null;Of.prototype.dispose.call(this)};Object(ic.a)(fa,"OcsStatusBarManager",Nc.a,[7,155,156]);var hh=Nc.a;Cm(T,hh);T.prototype.RRe=
function(){this.X4||(this.X4={},this.X4.IsPresenter=this.$.Ba.IsMeetingPresenter,this.X4.MeetingId=this.$.Ba.MeetingId);return this.X4};T.prototype.jEa=function(Fa){this.addHandler(T.mxd,Fa)};T.prototype.iya=function(Fa){this.removeHandler(T.mxd,Fa)};T.prototype.Xrg=function(Fa){this.$.fa.Ufa(Fa)};T.prototype.zTi=function(Fa){this.$.fa.wla(Fa)};T.prototype.E1=function(Fa){this.addHandler(T.F_,Fa)};T.prototype.mca=function(Fa){this.removeHandler(T.F_,Fa)};T.prototype.Vtg=function(Fa){this.addHandler(T.nxd,
Fa)};T.prototype.$Ui=function(Fa){this.removeHandler(T.nxd,Fa)};T.prototype.dispose=function(){this.$&&(this.gKb(),this.$.nl(Object(Ga.a)(this,this.sd,"onWorkbookOpened")),this.$.Xo(Object(Ga.a)(this,this.Yd,"onWorkbookClosing")));this.lh&&this.lh.jya(Object(Ga.a)(this,this.Mka,"onPresenceUpdated"));jd.a.Ia(this.Lif);this.$=this.lh=this.X4=null;hh.prototype.dispose.call(this)};T.prototype.hPg=function(Fa){this.lh?this.lh.jya(Object(Ga.a)(this,this.Mka,"onPresenceUpdated")):this.u2a();(this.lh=Fa)?
(this.lh.kEa(Object(Ga.a)(this,this.Mka,"onPresenceUpdated")),this.e$a(!0)):this.gKb()};T.prototype.u2a=function(){var Fa=this;this.ga.$F(Object(Ga.a)(this,this.nd,"onSelectionChanged"));Rd.g(this.$).AD(Object(Ga.a)(this,this.Uo,"onCurrentSelectionModeChanged"));var lb=Rd.g(this.$).Hc;lb.mt(Object(Ga.a)(this,this.Zk,"onEditEnded"));lb.Cm(Object(Ga.a)(this,this.tk,"onEditStarted"));this.$.fa.ak(Object(Ga.a)(this,this.ed,"onSessionIdChanged"));this.$.fa.dfe(Object(Ga.a)(this,this.k9e,"isUsingOcsChangedEventHandler"));
this.kMa.qfe(Object(Ga.a)(this,this.aBb,"onNamedSheetViewConversionUpdated"));lb=this.$.ra.xa;lb.oWa(Object(Ga.a)(this,this.euf,"onWebServiceBeforeCall"));lb.ls(Object(Ga.a)(this,this.Zh,"onWebMethodSuccess"));lb.FB(Object(Ga.a)(this,this.Vo,"onWebMethodError"));this.j8e?this.$.ea.ub(16,function(pc){pc.Uee(Object(Ga.a)(Fa,Fa.fic,"onFieldPaneChanging"));pc.Tee(Object(Ga.a)(Fa,Fa.Zk,"onEditEnded"))}):(lb=Fd.GetServiceTaskFactory.Xa(this.$.ea,16,74,1,"Microsoft.Office.Excel.WebUI.Client.IFieldManagerPane"),
Ea.TaskExtensions.Da(lb,function(pc){Fa.fieldManagerPane=pc.result;Fa.fieldManagerPane.Uee(Object(Ga.a)(Fa,Fa.fic,"onFieldPaneChanging"));Fa.fieldManagerPane.Tee(Object(Ga.a)(Fa,Fa.Zk,"onEditEnded"))},Qf.a.none,3))};T.prototype.gKb=function(){var Fa=this;this.ga.bF(Object(Ga.a)(this,this.nd,"onSelectionChanged"));Rd.g(this.$).aF(Object(Ga.a)(this,this.Uo,"onCurrentSelectionModeChanged"));var lb=Rd.g(this.$).Hc;lb.Qs(Object(Ga.a)(this,this.Zk,"onEditEnded"));lb.mm(Object(Ga.a)(this,this.tk,"onEditStarted"));
this.$.fa.xk(Object(Ga.a)(this,this.ed,"onSessionIdChanged"));this.$.fa.yFf(Object(Ga.a)(this,this.k9e,"isUsingOcsChangedEventHandler"));this.kMa.IFf(Object(Ga.a)(this,this.aBb,"onNamedSheetViewConversionUpdated"));this.$.ra.xa.g9a(Object(Ga.a)(this,this.euf,"onWebServiceBeforeCall"));this.$.ra.xa.Tt(Object(Ga.a)(this,this.Zh,"onWebMethodSuccess"));this.$.ra.xa.YC(Object(Ga.a)(this,this.Vo,"onWebMethodError"));this.j8e?this.$.ea.ub(16,function(pc){pc.pFf(Object(Ga.a)(Fa,Fa.fic,"onFieldPaneChanging"));
pc.oFf(Object(Ga.a)(Fa,Fa.Zk,"onEditEnded"))}):this.fieldManagerPane&&(this.fieldManagerPane.pFf(Object(Ga.a)(this,this.fic,"onFieldPaneChanging")),this.fieldManagerPane.oFf(Object(Ga.a)(this,this.Zk,"onEditEnded")));this.raiseEvent(T.nxd)};T.prototype.$Lf=function(Fa){return this.dBf(Fa)||!!this.sRe(Fa)};T.prototype.dBf=function(Fa){if(2===this.uc.Version&&this.uc.Object&&2===Fa.Version&&Fa.Object&&0<this.uc.Object.length&&0<Fa.Object.length)for(var lb=this.uc.Object.length,pc=Fa.Object.length,qc=
0;qc<lb;qc++)for(var Md=0;Md<pc;Md++)if(this.$Qc(this.uc.Object[qc],Fa.Object[Md]))return!0;if(this.uc.SelectedRange&&Fa.SelectedRange)for(lb=this.uc.SelectedRange.length,pc=Fa.SelectedRange.length,qc=0;qc<lb;qc++)for(Md=0;Md<pc;Md++)if(T.vyg(this.uc.SelectedRange[qc],Fa.SelectedRange[Md]))return!0;return!1};T.prototype.sRe=function(Fa){if(2===this.uc.Version&&this.uc.Object&&2===Fa.Version&&Fa.Object&&0<this.uc.Object.length&&0<Fa.Object.length)for(var lb=this.uc.Object.length,pc=Fa.Object.length,
qc=0;qc<lb;qc++)for(var Md=0;Md<pc;Md++)if(T.Qmi(this.uc.Object[qc],Fa.Object[Md]))return this.uc.Object[qc].ObjectId;return null};T.prototype.$Qc=function(Fa,lb){return!!Fa&&!!lb&&Fa.ObjectType===lb.ObjectType&&(1===Fa.ObjectType||3===Fa.ObjectType)&&!!Fa.ObjectId&&!!lb.ObjectId&&!Fa.ObjectId.localeCompare(lb.ObjectId)};T.prototype.gMf=function(){this.e$a(!1)};T.prototype.e$a=function(Fa){this.ga.Sa.nc?this.gGd(0,Fa):this.pGd(Rd.g(this.$).Hc.isEditing?1:0,Fa)};T.prototype.gGd=function(Fa,lb){var pc=
{};this.$.gk(pc);if(this.ga.Sa.nc){var qc=this.ga.Sa.nc.floatingObject;pc.FirstColumn=-1;pc.FirstRow=-1;pc.LastColumn=-1;pc.LastRow=-1;pc.NamedObjectName=qc?qc.Lg():null;this.uc.SelectedRange=[pc];this.uc.PresenceType=0;pc=null;if(qc)switch(qc.type){case 0:if(qc=this.$.Ab.gSe(qc.id))pc={},pc.ObjectType=this.M$(0),pc.ObjectPresenceType=Fa,pc.ObjectId=qc.qj;break;case 2:qc.id&&(pc={},pc.ObjectType=this.M$(9),pc.ObjectPresenceType=Fa,pc.ObjectId=qc.qj)}this.uc.Object=[pc]}this.raiseEvent(T.F_);this.sendPresenceToService(lb)};
T.prototype.pGd=function(Fa,lb){if(!Rd.g(this.$).isEditing&&!Rd.g(this.$).wi){var pc=this.$.Zb.yi("ModelUpdate","SendRangePresence");pc.start();var qc=Pb.k(this.ga.ya.selectedRanges,this.$);this.uc.SelectedRange=this.kMa.EQg(qc);this.uc.Object=[];qc=Ml(qc);for(var Md=qc.next();!Md.done;Md=qc.next())if(Md=Ua(Md.value,this.$,1)){var Pd={};Pd.ObjectType=this.M$(Md.type);Pd.ObjectPresenceType=0;Pd.ObjectId=Md.qj;Array.add(this.uc.Object,Pd)}this.uc.PresenceType=Fa;this.raiseEvent(T.F_);this.uc.SelectedRange||
this.uc.Object?this.sendPresenceToService(lb):cb.ULS.sendTraceTag(41185635,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.lh.clientId);pc.stop()}};T.prototype.sendPresenceToService=function(Fa){if(this.$.fa.q3b||!this.$.fa.Knb||Fa)if(this.amIAlone||++this.Mya.b,this.lh){this.uc.Version=2;this.uc.ClientType=1;this.uc.ChatThreadId=this.EUa.eVc;this.uc.ChatThreadDiscoveryUri=this.EUa.dVc;this.uc.InChat=this.EUa.Eub;
this.uc.Cid=this.EUa.email;this.uc.SupportsChat=!!this.EUa.capabilities&&this.EUa.capabilities.sua(4);this.uc.CollabMode=this.$.fa.I4a?2:0;this.uc.OcsCapable=this.$.fa.ocsCapable;this.lh.yMf(this.uc);if(hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.$.fa&&this.$.fa.n2a){var lb=(new Date).getTime();Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(this.$.ea,435,436,1,"Microsoft.Office.Excel.WebUI.Client.Presence.IPresenceTelemetry"),function(pc){pc.result.pdi(lb)},
this.$.ma,3)}this.amIAlone||++this.Mya.c}};T.prototype.Uo=function(){this.$&&this.gGd(0,!1)};T.prototype.tk=function(){this.FNd?this.KYf(!1):(this.uc.PresenceType=1,this.raiseEvent(T.F_),this.sendPresenceToService(!1))};T.prototype.Zk=function(){this.FNd?this.JYf(!1):(this.e$a(!1),this.dGd())};T.prototype.fic=function(){this.ga.Sa.nc?this.gGd(1,!1):this.pGd(0,!1)};T.prototype.Mka=function(Fa,lb){this.raiseEvent(T.mxd,lb)};T.prototype.nd=function(){this.pGd(Rd.g(this.$).isEditing?1:0,!1)};T.prototype.ed=
function(Fa,lb){Ug.a(lb)&&(this.upa={})};T.prototype.aBb=function(){this.gMf()};T.prototype.euf=function(Fa,lb){if(lb&&lb.methodName in T.vkc){Fa=!1;switch(T.vkc[lb.methodName]){case 0:lb=lb.parameters.cell;break;case 1:lb=lb.parameters.parameters.Location;break;case 2:lb=Pb.v(this.ga.ya.activeRange,this.$);Fa=!0;break;default:return}lb.LastColumn=lb.FirstColumn;lb.LastRow=lb.FirstRow;lb.NamedObjectName=null;this.uc.SelectedRange=[lb];this.uc.PresenceType=0;if(Fa){lb=[];Fa=Ml(this.$.Ab.qDh());for(var pc=
Fa.next();!pc.done;pc=Fa.next()){pc=pc.value;var qc={};qc.ObjectType=this.M$(pc.type);qc.ObjectPresenceType=1;qc.ObjectId=pc.qj;Array.add(lb,qc)}this.uc.Object=lb}else lb=Ua(lb,this.$,1),Fa=null,lb&&(Fa={},Fa.ObjectType=this.M$(lb.type),Fa.ObjectPresenceType=0,Fa.ObjectId=lb.qj),this.uc.Object=[Fa];this.raiseEvent(T.F_);this.sendPresenceToService(!1)}};T.prototype.Vo=function(Fa,lb){lb.context.methodName in T.vkc&&(this.uc.Object=[null],this.e$a(!1))};T.prototype.Zh=function(Fa,lb){lb.context.methodName in
T.vkc&&(this.uc.Object=[null],this.e$a(!1))};T.prototype.sd=function(Fa,lb){lb.LJ||(this.upa={},hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&this.$.Ba.IsMeetingLiveSession&&this.$.Ba.IsMeetingPresenter&&(this.uc.MeetingInfo=this.RRe()),this.$.Ex?this.u2a():this.gKb())};T.prototype.Yd=function(){this.dGd()};T.prototype.dGd=function(){this.$.Ex&&(this.Mya.a=this.$.Ba.UserSessionId,Xb.b().Se(26,this.Mya,!0));this.Mya.b=0;this.Mya.c=0};T.prototype.M$=
function(Fa){switch(Fa){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};T.prototype.k9e=function(){this.gMf();this.Lif.fw()};T.Qmi=function(Fa,lb){return!!Fa&&!!Fa.ObjectId&&!!lb&&!!lb.ObjectId&&(!Fa.ObjectType||2===Fa.ObjectType)&&Fa.ObjectType===lb.ObjectType&&!Fa.ObjectId.localeCompare(lb.ObjectId)};T.vyg=function(Fa,lb){return!Fa.NamedObjectName&&Kb(Fa,lb)};Jl.Object.defineProperties(T.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.upa}},
amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.fa||this.$.fa.amIAlone}}});Jl.Object.defineProperties(T,{vkc:{configurable:!0,enumerable:!0,get:function(){var Fa={};return T.r6d||(T.r6d=(Fa.ApplyFilter=1,Fa.ApplyPivot=0,Fa.ApplyPivotSort=0,Fa.ApplyPivotSortByValue=1,Fa.ApplyWellKnownPivotFilter=0,Fa.RemovePivotFilter=0,Fa.SetCustomFilter=1,Fa.SetTop10Filter=1,Fa.TogglePivotDrill=0,Fa.RefreshAll=2,Fa))}}});T.mxd="presenceChanged";T.nxd="presenceDisabled";T.F_="selectionChanged";
T.r6d=null;Object(ic.a)(T,"SelectionPresenceManager",Nc.a,[712,7,713]);var Eg=Ed.a;Cm(N,Eg);N.prototype.create=function(){var Fa=this;this.manager?this.Jb(this.manager):Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.create(this.$.ea,28,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.INamedSheetViewConversionManager"),function(lb){Fa.Jb(Fa.manager||(Fa.manager=new T(Fa.$,lb.result)))},this.ma,3)};Object(ic.a)(N,"SelectionPresenceManagerFactory",Ed.a,[]);var ng=b(1233),eg=b(4),Yg=b(178),Ud=Yf.a;
Cm(S,Ud);S.prototype.tRe=function(Fa,lb){this.jGa=[];lb=this.presenceView.wBh(Fa,lb);Fa=lb.OXh;lb=lb.C6g;Array.addRange(this.jGa,Fa);Array.addRange(this.jGa,lb);return S.jme(Fa,lb)};S.prototype.dispose=function(){this.presenceView.iya(Object(Ga.a)(this,this.mBb,"onPresenceChanged"));this.xNa&&(jd.a.Ia(this.xNa),this.xNa=null);Ud.prototype.dispose.call(this)};S.prototype.mBb=function(Fa,lb){var pc=this;if(lb.bI){Fa=[];var qc=[],Md=Rd.g(this.$).ga,Pd=!(2===Md.Ze||128===Md.Ze);Md=Pd?Pb.k(Md.ya.selectedRanges,
this.$):Md.Sa.nc.floatingObject;lb=lb.bI;for(var ee in lb)this.presenceView.Sye(Md,Pd,Fa,qc,ee);ee=Ml(this.jGa);for(lb=ee.next();!lb.done;lb=ee.next())lb=lb.value,Array.contains(Fa,lb)||Array.contains(qc,lb)||this.presenceView.Sye(Md,Pd,Fa,qc,lb.UserID);this.jGa=[];Array.addRange(this.jGa,Fa);Array.addRange(this.jGa,qc);this.oxd&&(jd.a.Ia(this.xNa),this.oxd=this.xNa=null);var xf=S.jme(Fa,qc);this.xNa=new Yg.a;this.oxd=Ea.TaskExtensions.Da(wa.Task.delay(1),function(){pc.ariaLiveNotifier.BDb(xf,eg.a.UWa)},
this.xNa.token,3)}};S.jme=function(Fa,lb){if(!Fa.length&&!lb.length)return"";if(lb.length){if(1===lb.length)return Fa=Gd.a.instance.Eb(82),String.format(Fa,lb[0].UserName);Fa=Gd.a.instance.Eb(83);return String.format(Fa,lb.length)}if(1===Fa.length)return lb=Gd.a.instance.Eb(84),String.format(lb,Fa[0].UserName);lb=Gd.a.instance.Eb(85);return String.format(lb,Fa.length)};Object(ic.a)(S,"PresenceReadoutHandlerService",Yf.a,[662]);B.prototype.Grb=function(Fa){return Fa};B.prototype.xCb=function(Fa){for(var lb=
Array(Fa.Kga.count),pc=0,qc=Ml(Fa.Kga.values),Md=qc.next();!Md.done;Md=qc.next())lb[pc]=Md.value,pc++;return W(this.$.ra.xa,lb,Fa.gr,Fa.p3,null,null)};B.prototype.Qkb=function(Fa,lb){if(!lb)return Fa;if(!Fa)return cb.ULS.shipAssertTag(39913247,0,!!Fa,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),lb;cb.ULS.shipAssertTag(540299545,0,1===Fa.Kga.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");
for(var pc={},qc=Ml(Fa.Kga),Md=qc.next();!Md.done;pc={ZN:pc.ZN,Nda:pc.Nda},Md=qc.next())pc.ZN=Md.value,pc.Nda=void 0,function(Pd){return function(){var ee=lb.Kga.Ec(Pd.ZN.key);Pd.Nda=ee.value;return ee}}(pc)().returnValue?pc.Nda.OcsSessionId!==pc.ZN.value.OcsSessionId?(cb.ULS.sendTraceTag(39913248,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",pc.ZN.value.SeqNum,pc.Nda.SeqNum),lb.Kga.ja(pc.ZN.key,
pc.ZN.value.SeqNum<pc.Nda.SeqNum?pc.ZN.value:pc.Nda),lb.gr=pc.ZN.value.SeqNum<pc.Nda.SeqNum?Fa.gr:lb.gr):(pc.ZN.value.SeqNum>pc.Nda.SeqNum&&lb.Kga.ja(pc.ZN.key,pc.ZN.value),lb.gr=Fa.gr):(lb.Kga.add(pc.ZN.key,pc.ZN.value),lb.gr=Fa.gr);return lb};Object(ic.a)(B,"CheckCollabServiceActionAggregationPerformer",null,[560,540]);J.prototype.Grb=function(Fa){return Fa};J.prototype.xCb=function(Fa){var lb=this.$.ra.xa,pc=Fa.SZg,qc=Fa.Ihc;Fa=Fa.gr;var Md=lb.Ra(1,null);Md.Id=pc;Md.OnBehalfOfOcs=qc;return Ue.i(lb,
"CheckPersistedContentUpdate",Md,Fa,null,null,null,516)};J.prototype.Qkb=function(Fa,lb){if(!lb)return Fa;if(!Fa)return cb.ULS.shipAssertTag(40195267,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),lb;Fa.Ihc=lb.Ihc&&Fa.Ihc;return Fa};Object(ic.a)(J,"CheckPersistedActionAggregationPerformer",null,[560,540]);z.prototype.Grb=function(Fa){return Fa};z.prototype.xCb=function(Fa){var lb=this.$.ra.xa;Fa=Fa.dRd;var pc=lb.Ra(1,null);pc.UploadInfo=
Fa;return Ue.i(lb,"ProcessUploadRtcNotification",pc,null,null,null,null,0)};z.prototype.Qkb=function(Fa,lb){if(!lb)return Fa;if(!Fa)return cb.ULS.shipAssertTag(544215616,0,!!Fa,"UploadNotificationActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),lb;lb.pwj(Fa);return lb};Object(ic.a)(z,"CheckUploadNotificationActionAggregationPerformer",null,[560,540]);Object(ic.a)(x,"RevisionGeneratedNotification",null,[]);Object(ic.a)(y,"StateDownloadedNotification",null,[]);
var Tc=b(283),qg=b(125),Lg=Yf.a;Cm(A,Lg);A.prototype.dispose=function(){this.Ld=!0;this.Blb&&(this.Blb.dispose(),this.Blb=null);this.contentRefreshManager&&(this.w1f(),this.contentRefreshManager=null);this.Ha&&(this.WPd(),this.Ha=null);this.viewport&&(this.WPd(),this.viewport=null);this.yf&&(this.yf=null);this.$&&(this.$.nl(Object(Ga.a)(this,this.sd,"onWorkbookOpened")),this.$.fa.xk(Object(Ga.a)(this,this.ed,"onSessionIdChanged")),this.$.fa.ZFf(Object(Ga.a)(this,this.Fv,"clearState")),this.$=null);
this.mergeSuspensionManager&&(this.mergeSuspensionManager.qnc(Object(Ga.a)(this,this.GBb,"onTogglePendingMergeBlockedByClient")),this.mergeSuspensionManager=null);Lg.prototype.dispose.call(this)};A.prototype.GBb=function(Fa,lb){this.uva!==lb.uva&&(this.Xvd=(this.uva=lb.uva)?null:be.a.Ta.Lb)};A.prototype.sd=function(){this.$.isEditMode&&this.wmj()};A.prototype.ed=function(Fa,lb){lb.pc||this.Fv(Fa,lb)};A.prototype.Fv=function(){if(0<this.sya.count||0<this.$ca.count)cb.ULS.sendTraceTag(40154958,13,15,
"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",this.sya.count,this.$ca.count),this.sya.clear(),this.$ca=new qg.a;this.Blb.cancel();this.w1f();this.WPd();this.dvj()};A.prototype.frf=function(Fa,lb){this.umj();this.vmj();Fa=new x;Fa.Xluid=lb.qj;Fa.NotificationReceivedOn=be.a.Ta.Lb.toISOString();Fa.CurrentPresenceUserCount=this.$.fa.Lm.length;Fa.OurCollabModeIsUsingOcs=this.$.fa.I4a;Fa.SenderCollabMode=lb.U4i;Fa.SenderClientType=lb.T4i;Fa.SessionSiteIdentifier=lb.r6;
Fa.CommandTimeInMs=lb.pNg;cb.ULS.sendTraceTag(40154959,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(Fa));this.sya.add(Fa)};A.prototype.wmj=function(){this.Ctc||(this.contentRefreshManager.cug(Object(Ga.a)(this,this.frf,"onRemoteRevisionGenerated")),this.Ctc=!0,this.Blb.Zq())};A.prototype.w1f=function(){this.Ctc&&(this.contentRefreshManager.fVi(Object(Ga.a)(this,this.frf,"onRemoteRevisionGenerated")),this.Ctc=!1)};A.prototype.umj=function(){this.Atc||
(this.Ha.Xp(Object(Ga.a)(this,this.Zg,"onBlockCacheConsistent")),this.Atc=!0)};A.prototype.WPd=function(){this.Atc&&(this.Ha.Yq(Object(Ga.a)(this,this.Zg,"onBlockCacheConsistent")),this.Atc=!1)};A.prototype.vmj=function(){this.Btc||(this.viewport.dug(Object(Ga.a)(this,this.jrf,"onRenderedContent")),this.Btc=!0)};A.prototype.dvj=function(){this.Btc&&(this.viewport.iVi(Object(Ga.a)(this,this.jrf,"onRenderedContent")),this.Btc=!1)};A.prototype.Zg=function(){this.que(this.$.fa.zf,"OnBlockCacheConsistent")};
A.prototype.jrf=function(Fa,lb){(Fa=Object(Bb.a)(656,lb.Sg))&&this.que(Fa.Vw,"OnRenderedContent")};A.prototype.que=function(Fa,lb){if(Fa!==Zc.a.Ve&&!this.$ca.tb(Fa)){var pc=be.a.Ta.Lb.toISOString();pc=Object.assign(new y,{StateId:Fa,DownloadedOn:pc,IsHidden:this.xf?this.xf.mj:window.document.visibilityState!==Tc.a.visible,DocumentLastUnhidden:this.xf&&this.xf.jec?this.xf.jec.toISOString():null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.I$e?this.contentRefreshManager.I$e.toISOString():
null,LastOffline:this.yf&&this.yf.Tva?this.yf.Tva.toISOString():null});this.mergeSuspensionManager&&(pc.IsPendingMergeBlockedByClient=this.uva,this.Xvd&&(pc.PendingMergeBlockedByClientLastEnded=this.Xvd.toISOString()));cb.ULS.sendTraceTag(41685216,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",lb,JSON.stringify(pc));this.$ca.add(Fa,pc)}};A.prototype.vzj=function(){if(!this.$.fa.pc)cb.ULS.sendTraceTag(571245763,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");
else if(this.sya.count||this.$ca.count){var Fa=null;0<this.sya.count&&(Fa=this.sya.toArray(),this.sya.clear());var lb=null;if(0<this.$ca.count){lb=Array(this.$ca.count);for(var pc=0,qc=Ml(this.$ca.values),Md=qc.next();!Md.done;Md=qc.next())Md=Md.value,lb[pc++]=Md;this.$ca=new qg.a}cb.ULS.sendTraceTag(40154963,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",Fa?Fa.length:0,lb?lb.length:0);pc=this.$.ra.xa;
qc=Object(Ga.a)(this,this.fBi,"onUploadLatencyTelemetrySucceeded");Md=pc.Ra(1,null);Md.GenerateNotifications=Fa;Md.DownloadNotifications=lb;Ue.i(pc,"UploadLatencyTelemetry",Md,qc,null,null,null,128)}};A.prototype.fBi=function(Fa){Fa.Result&&0<Fa.Result&&this.Sod()};A.prototype.Sod=function(){nc.AFrameworkApplication.dg&&nc.AFrameworkApplication.dg.Sod()};Object(ic.a)(A,"ContentLatencyTracker",Yf.a,[]);var de=b(1010);Object(ic.a)(v,"UpdateInfo",null,[]);var tg=b(107);Object(ic.a)(w,"CollabServiceContentUpdateActionParameters",
null,[]);var ve=b(1011),tf=Sys.EventArgs;Cm(u,tf);Object(ic.a)(u,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);k.prototype.Lxj=function(){this.$kc||(this.$kc=ce.a.hf(),this.vyb())};k.prototype.Ixj=function(){this.L$b||(this.L$b=ce.a.hf(),this.vyb())};k.prototype.Kxj=function(){this.okc||(this.okc=ce.a.hf(),this.vyb())};k.prototype.Mxj=function(Fa){this.Gwc||(this.Gwc=ce.a.hf(),this.V2e=Fa,this.vyb())};k.prototype.vyb=function(Fa){Fa=void 0===Fa?0:Fa;this.b6e||(Fa&&Fa>this.Xdi?this.nfc(!0):this.$kc&&
this.okc&&this.L$b&&this.Gwc&&this.nfc(!1))};k.prototype.dispose=function(){this.$=null};k.prototype.nfc=function(Fa){var lb={};lb.CoAuthorsCount=this.$.fa.Lm.length;lb.HostNotificationTime=this.L$b;lb.PeerNotificationTime=this.okc;lb.PresenceNotificationTime=this.$kc;lb.UserFetchTime=this.Gwc;lb.IsAlreadyFetchedFromServer=this.V2e;lb.IsTimeout=Fa;lb.ClientId=this.clientId;lb.CurrentUserClientId=this.vZg;cb.ULS.sendTraceTag(541388879,0,50,"Host Notification Latency Entry: {0}",lb);this.f1d=!0};Jl.Object.defineProperties(k.prototype,
{b6e:{configurable:!0,enumerable:!0,get:function(){return this.f1d}}});Object(ic.a)(k,"HostNotificationLatencyEntry",null,[7]);Object(ic.a)(t,"PersistedContentUpdateActionParameters",null,[]);r.prototype.huj=function(Fa){this.BWb(Fa.ZVc,this.zAc);this.BWb(Fa.$Vc,this.AAc)};r.prototype.BWb=function(Fa,lb){if(Fa){Fa=Ml(Fa);for(var pc=Fa.next();!pc.done;pc=Fa.next())lb[pc.value]=!0}};Jl.Object.defineProperties(r.prototype,{ZVc:{configurable:!0,enumerable:!0,get:function(){return kg.a(this.zAc)}},$Vc:{configurable:!0,
enumerable:!0,get:function(){return kg.a(this.AAc)}},c5e:{configurable:!0,enumerable:!0,get:function(){return!this.ZVc.length&&!this.$Vc.length}}});Object(ic.a)(r,"UpdatePresenceUsersActionParameters",null,[]);Object(ic.a)(m,"UploadRevisionInfo",null,[]);c.prototype.pwj=function(Fa){for(var lb=0;lb<Fa.dRd.length;lb++){var pc=Fa.dRd[lb];this.eRd.add(pc.ClientId,pc)}};Jl.Object.defineProperties(c.prototype,{dRd:{configurable:!0,enumerable:!0,get:function(){return this.eRd.values}}});Object(ic.a)(c,
"UploadNotificationActionParameters",null,[]);var lg=Nc.a;Cm(d,lg);d.prototype.cug=function(Fa){this.addHandler("ekcrmrrg",Fa)};d.prototype.fVi=function(Fa){this.removeHandler("ekcrmrrg",Fa)};d.prototype.ykb=function(Fa){this.addHandler("ekcrmmcu",Fa)};d.prototype.CEb=function(Fa){this.removeHandler("ekcrmmcu",Fa)};d.prototype.Usg=function(Fa){this.addHandler("LabelUpdateEventKey",Fa)};d.prototype.kUi=function(Fa){this.removeHandler("LabelUpdateEventKey",Fa)};d.prototype.iwc=function(Fa,lb){this.$.fa.pc&&
(cb.ULS.sendTraceTag(39150978,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",Fa?Fa.join(","):"null",lb?lb.join(","):"null"),this.eyj.yCb(new r(Fa,lb,null)))};d.prototype.dispose=function(){this.lh&&(this.lh.KEb(Object(Ga.a)(this,this.xba,"onUpdateNotificationReceived")),this.lh.jya(Object(Ga.a)(this,this.fud,"onPresenceUpdateNotificationReceived")));this.$&&(this.$.ra.Tt(Object(Ga.a)(this,this.Zh,"onWebMethodSuccess")),this.$.fa.wla(Object(Ga.a)(this,
this.dK,"onUserListChanged")));this.sn&&(this.sn.TBd(Object(Ga.a)(this,this.sAb,"onConnectionCompleted")),this.sn.fFf(Object(Ga.a)(this,this.llf,"onConnectionLost")));this.$=this.lh=this.lYa=this.EJa=null;lg.prototype.dispose.call(this)};d.prototype.LLd=function(Fa){this.lh&&(this.lh.KEb(Object(Ga.a)(this,this.xba,"onUpdateNotificationReceived")),this.lh.jya(Object(Ga.a)(this,this.fud,"onPresenceUpdateNotificationReceived")));this.lh=Object(Bb.a)(313,Fa);this.lh.nWa(Object(Ga.a)(this,this.xba,"onUpdateNotificationReceived"));
hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.lh.kEa(Object(Ga.a)(this,this.fud,"onPresenceUpdateNotificationReceived"));this.currentUserId=this.lh.clientId};d.prototype.fud=function(Fa,lb){if(lb.bI){Fa=lb.bI;for(var pc in Fa)Fa=pc,kb.a.na(Fa)||Fa===this.currentUserId||this.lYa.has(Fa)||this.z8b(Fa).Lxj()}};d.prototype.dK=function(){this.tCf()};d.prototype.tCf=function(){for(var Fa=!this.lh,lb=Ml(this.$.fa.Lm),pc=lb.next();!pc.done;pc=lb.next())pc=
pc.value.User.UserID,kb.a.na(pc)||pc===this.currentUserId||this.lYa.has(pc)||this.z8b(pc).Mxj(Fa)};d.prototype.xba=function(Fa,lb){var pc=this;this.ord=!0;var qc=Object(Bb.a)(Object,lb.b7);if(1===lb.type)if(Fa=hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),qc&&qc[Zc.a.NRh]){if(!Fa||kb.a.na(Object(Bb.a)(String,qc[Zc.a.E_e])))return;Fa=this.ute(Object(Bb.a)(String,qc[Zc.a.E_e]));Object(Bb.a)(String,qc[Zc.a.F_e])===Zc.a.LRh?(Fa=[Fa],Fa[0]===this.currentUserId||
this.lYa.has(Fa[0])||this.z8b(Fa[0]).Ixj(),this.iSf(Fa)&&this.iwc(Fa,null)):Object(Bb.a)(String,qc[Zc.a.F_e])===Zc.a.MRh&&Fa!==this.currentUserId&&this.iwc(null,null)}else{lb=Array.isArray(lb.b7)?lb.b7:null;!lb&&qc&&(lb=Array.isArray(qc[Zc.a.zBe])?qc[Zc.a.zBe]:null);if(lb&&Fa)for(var Md=Ml(lb),Pd=Md.next();!Pd.done;Pd=Md.next())Pd=Pd.value,Pd===this.currentUserId||this.lYa.has(Pd)||this.z8b(Pd).Kxj();(!lb||!Fa&&this.iSf(lb))&&this.iwc(lb,null);return}if(qc)if(lb.type){if(3===lb.type){if(!(Zc.a.FJf in
qc)){cb.ULS.sendTraceTag(590751315,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}lb=qc[Zc.a.FJf];if(lb===Zc.a.o0i)this.DOh(qc);else if(lb===Zc.a.m0i){if(!hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSignalRForRtc",!0)&&hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleFullSaveStartedRTC",!1)){if(pc.DEa(qc).returnValue)return;lb=qc[Zc.a.i0i];kb.a.na(lb)||(cb.ULS.sendTraceTag(553654083,0,50,"RTC : FullSaveStarted received. Now invoking ProcessFullSaveStartedNotification web method"),
H(this.$.ra.xa,lb,null,null,null,null))}}else if(lb===Zc.a.p0i||lb===Zc.a.q0i||lb===Zc.a.OJf){if(!hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSignalRForRtc",!0)&&hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleUploadNotificationsRTC",!1)){if(pc.DEa(qc).returnValue)return;Fa=0;lb!==Zc.a.OJf&&(Fa=qc[Zc.a.JEd]);Md=qc[Zc.a.BJf];kb.a.na(Md)||this.wzj.yCb(new c(lb,Fa,Md,Object(Ga.a)(this,this.Phc,"onCheckForUpdateSuccess")))}}else lb!==Zc.a.n0i&&cb.ULS.sendTraceTag(590751313,
13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",lb);return}if(4===lb.type){Fa=!1;Zc.a.kwf in qc&&(Fa=qc[Zc.a.kwf]);if(pc.DEa(qc).returnValue)return;this.$.fa.P_h()&&this.lVc();if(this.$.fa.I4a&&Fa)return;Md=qc[Zc.a.gFi];this.$.fa.pc&&!kb.a.na(Md)&&this.fFi.yCb(new t(Md,Fa,Object(Ga.a)(this,this.Phc,"onCheckForUpdateSuccess")))}else if(8===lb.type){var ee=0,xf=qc[Zc.a.k0i],Se=qc[Zc.a.BJf],cf=qc[Zc.a.j0i];Zc.a.JEd in qc&&(ee=qc[Zc.a.JEd]);this.$.fa.pc&&!kb.a.na(xf)&&(Fa=Object.assign(new v,
{OcsSessionId:xf,ClientId:kb.a.na(Se)||!hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?"":Se,SeqNum:cf,XrevidSaved:ee}),Md=function(){cb.ULS.sendTraceTag(537968987,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",xf,Se,cf,ee)},hc.EwaSettings.ka(489)?(Pd=Array(1),Pd[0]=Fa,W(this.$.ra.xa,Pd,Object(Ga.a)(this,this.Phc,"onCheckForUpdateSuccess"),Md,null,null)):this.NMg.yCb(new w(Fa,Object(Ga.a)(this,this.Phc,
"onCheckForUpdateSuccess"),Md)))}}else{var dh;(function(){var df=pc.DEa(qc);dh=df.aCf;return df})().returnValue?(this.JMa(qc),Zc.a.zf in qc&&(this.$.fa.FW(qc[Zc.a.zf],"ContentRefreshManager.OnUpdateNotificationReceived"),this.T1f())):cb.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",dh,this.$.fa.r6)}2===lb.type?qc&&pc.DEa(qc).returnValue||(cb.ULS.sendTraceTag(42267869,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),
C(this.$.ra.xa,null,null,null,null)):12!==lb.type||qc&&pc.DEa(qc).returnValue||this.raiseEvent("LabelUpdateEventKey")};d.prototype.DOh=function(Fa){if(Zc.a.EJf in Fa&&Zc.a.DJf in Fa&&Zc.a.CJf in Fa){var lb=Fa[Zc.a.CJf];1!==lb||Zc.a.r6 in Fa&&Zc.a.Foc in Fa||cb.ULS.sendTraceTag(40182808,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",Zc.a.r6 in Fa,Zc.a.Foc in Fa);var pc=this.DEa(Fa);var qc=pc.aCf;pc.returnValue||
(Fa=new u(Fa[Zc.a.EJf],Fa[Zc.a.DJf],lb,qc,Zc.a.Foc in Fa?Fa[Zc.a.Foc]:0),this.raiseEvent("ekcrmrrg",Fa,this))}else cb.ULS.sendTraceTag(40154954,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};d.prototype.DEa=function(Fa){Fa=Zc.a.r6 in Fa?Fa[Zc.a.r6]:null;return{returnValue:this.$.fa.r6===Fa,aCf:Fa}};d.prototype.Phc=function(Fa){var lb=Fa.Errors;Ke.a.Fq(lb)?(lb=Ke.a.$E(lb,[1552731907],"ContentRefreshManager"),Ke.a.X8(lb)||this.$.fa.Wo(lb)):(lb=Fa.StateId+1,Fa.Result&&
this.$.fa.zf<lb&&this.$.fa.FW(Zc.a.Ve,"ContentRefreshManager.OnCheckForUpdateSuccess"))};d.prototype.Zh=function(){this.e0i&&this.ord&&this.$.fa.q3b&&this.T1f()};d.prototype.T1f=function(){this.$.fa.Yla=Math.max(d.QAg,this.$.fa.Yla)};d.prototype.llf=function(){this.ord=!1;this.$.fa.Yla=500;this.u2d=be.a.Ta.Lb};d.prototype.sAb=function(Fa,lb){this.LLd(lb.lh)};d.prototype.iSf=function(Fa){Fa=Ml(Fa);for(var lb=Fa.next();!lb.done;lb=Fa.next())if(!this.$.fa.fbd(lb.value))return!0;return!1};d.prototype.lVc=
function(){this.$.Re(1562177611,-1,0,null)};d.prototype.JMa=function(Fa){if(Zc.a.Lff in Fa&&Zc.a.Mff in Fa&&Zc.a.Nff in Fa){var lb=Object.assign(new de.a,{Pending:Fa[Zc.a.Mff],Current:Fa[Zc.a.Lff],SuspensionStartTimestamp:Fa[Zc.a.Nff]});Zc.a.Off in Fa?lb.SuspensionStartTimestampMs=Fa[Zc.a.Off]:cb.ULS.sendTraceTag(537985180,0,15,"ContentRefreshManager.OnMergeCounterReceivedFromServer: update hint missing MergeSuspensionStartTimestampMs");this.raiseEvent("ekcrmmcu",new ve.a(lb),this)}};d.prototype.z8b=
function(Fa){Fa=this.ute(Fa);if(!this.EJa[Fa]){var lb=new k(Fa,this.currentUserId,2E4,this.$);this.EJa[Fa]=lb}this.aLf();return Object(Bb.a)(k,this.EJa[Fa])};d.prototype.ute=function(Fa){if(kb.a.na(Fa))return Fa;var lb=Fa.toLocaleLowerCase();lb.startsWith("{")||(lb="{"+Fa+"}");return lb};d.prototype.aLf=function(){var Fa=this;this.Edd||Wa.a.isEmpty(this.EJa)||!hc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.Edd=wa.Task.delay(1E4).continueWith(function(){Fa.KRh()}))};
d.prototype.KRh=function(){var Fa=[],lb=ce.a.hf(),pc=this.EJa,qc;for(qc in pc){var Md=qc,Pd=Object(Bb.a)(k,pc[qc]);Pd.vyb(lb);Pd.b6e&&(Pd.dispose(),Fa.push(Md))}Fa=Ml(Fa);for(lb=Fa.next();!lb.done;lb=Fa.next())lb=lb.value,delete this.EJa[lb],this.lYa.add(lb);this.Edd=null;this.aLf()};Jl.Object.defineProperties(d.prototype,{I$e:{configurable:!0,enumerable:!0,get:function(){return this.u2d}},e0i:{configurable:!0,enumerable:!0,get:function(){return!!this.lh&&2===this.lh.connectionState}}});d.QAg=3E4;
Object(ic.a)(d,"ContentRefreshManager",Nc.a,[654]);var Og=b(60);a.prototype.Grb=function(Fa){return Fa+5E3};a.prototype.xCb=function(Fa){var lb=this;return this.$.fa.pc?Ea.TaskExtensions.ts(Ea.TaskExtensions.ts(wa.Task.delay(0),function(){var pc=lb.$.ra.xa,qc=Fa.ZVc,Md=Fa.$Vc,Pd=Fa.gr,ee=pc.Ra(1,null);ee.clientIdsToAdd=qc;ee.clientIdsToRemove=Md;return Ue.i(pc,"UpdatePresenceUsers",ee,Pd,null,null,null,0)},Qf.a.none,0,Og.a.current),function(){return wa.Task.delay(5E3)},Qf.a.none,0,Og.a.current):wa.Task.Ua(!0)};
a.prototype.Qkb=function(Fa,lb){if(!lb)return Fa;if(!Fa)return cb.ULS.shipAssertTag(578339170,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),lb;if(lb.c5e)return lb;if(Fa.c5e)return Fa;lb.huj(Fa);return lb};Object(ic.a)(a,"UpdatePresenceUsersActionAggregationPerformer",null,[560,540]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");ec.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");
Type.registerNamespace("RealtimePresenceUI");Cb.a.Ja(fb.la);(function(){Cb.a.Ja(function(Fa){hc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&ua.la(Fa);var lb=Fa.ea;lb.La(28,new Ia(Fa));lb.La(158,new N(Fa));Cb.a.Ja(db.la);var pc=Fd.GetServiceTaskFactory.create(Fa.ea,158,lb.ma,1,"Microsoft.Office.Excel.WebUI.Client.Presence.ISelectionPresenceManager"),qc=Fd.GetServiceTaskFactory.create(Fa.ea,28,lb.ma,1,"Microsoft.Office.Excel.WebUI.Client.INamedSheetViewConversionManager");
Ea.TaskExtensions.Da(Ea.TaskExtensions.Fe([pc,qc],lb.ma),function(){var Md=new Tb.a,Pd=lb.Ea(26,void 0);Pd.bwe(Object(Ga.a)(Md,Md.setResult,"setResult"));var ee=new Y(Fa,Pd,pc.result,qc.result,xb.a.uq(eb.a.instance.yc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));ge.a.getInstance(Fa.ea).add(ee);lb.La(159,new db);Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.create(lb,159,lb.ma,1,"Common.IPresenceConverter"),function(xf){var Se=new Tb.a;Se.setResult(ee);new E(Object.assign(new Hd.a,{clientId:Fa.workbookContext.ClientId}),
Md.task,Se.task,xf.result,Nd.a.instance,nc.AFrameworkApplication.ha.ta("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:nc.AFrameworkApplication.ha.qd("AwayCoauthorThresholdMs",9E5),Object(Ga.a)(nc.AFrameworkApplication.Hb,nc.AFrameworkApplication.Hb.processAction,"processAction"),qb.instance)},lb.ma)},lb.ma,3);eb.a.instance.register(149,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").Ac().Lc(function(){return Fa.fa});eb.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");
eb.a.instance.register(za,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").Ac().Lc(function(){return new za(Fa)});eb.a.instance.resolve("Common.IPeopleInfoProvider")})})();Cb.a.Ja(ng.a.la);Cb.a.Ja(function(Fa){var lb=Fa.ea,pc=Fd.GetServiceTaskFactory.Xa(Fa.ea,211,212,1,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier");lb.ub(25,function(qc){Ea.TaskExtensions.Da(pc,function(Md){lb.Ea(231,void 0)||new S(Md.result,Fa,qc)},lb.ma,3)})});
(function(){Cb.a.Ja(function(Fa){Ea.TaskExtensions.Da(Fd.GetServiceTaskFactory.Xa(Fa.ea,12,477,0,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),function(lb){var pc=new B(Fa),qc=Fa.ea.Ea(291,void 0);pc=lb.result.bob(pc,pc,qc,"collabService");var Md=new J(Fa);qc=lb.result.bob(Md,Md,qc,"persisted");Md=new a(Fa);Md=lb.result.bob(Md,Md,null,"updatePresence");var Pd=new z(Fa);lb=lb.result.bob(Pd,Pd,null,"uploadNotification");Fa.ea.La(292,new d(Fa,Fa.ea.Ea(26,void 0),
pc,qc,Md,lb));ge.a.getInstance(Fa.ea).add(new A(Fa));ge.a.getInstance(Fa.ea).add(pc);ge.a.getInstance(Fa.ea).add(qc);ge.a.getInstance(Fa.ea).add(lb)},Fa.ma)})})()},821:function(D,F,b){function a(){}b.r(F);b.d(F,"RtcUtils",function(){return a});D=b(0);var d=b(15),c=b(918),m=b(41);a.hVc=function(r,t){t=void 0===t?c.RealtimeChannel.$od:t;try{var k=m.c(r)}catch(u){throw r=String.format("Failed to JSON-serialize payload : {0}",u),d.ULS.sendTraceTag(18637072,500,10,r),Error.argument("payload",r);}if(k.length>
t)throw r=String.format("Payload exceeds maximum length: {0} > {1}.",k.length,t),d.ULS.sendTraceTag(18637074,500,10,r),Error.argument("payload",r);return k};a.deserialize=function(r,t,k){if(!r)return null;if(Object.getType(r)!==String){var u=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",t,Object.getType(r).getName(),k);d.ULS.sendTraceTag(18637075,500,10,u);return null}u=null;try{u=m.a(r)}catch(w){r=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
t,w,k),d.ULS.sendTraceTag(18637077,500,10,r)}return u};a.Hwa=function(r){if(!r)return"";if("string"===typeof r)return r.toString();try{return m.c(r)}catch(t){return r.toString()}};a.Sjh=function(r){var t;var k=0;var u=t=null;if(!r)return{V_e:k,W_e:t,Kg:u};try{var w=r.source;w&&Object.getType(w)===String&&(u=w);var v=r.context;v&&(r=v,k=r.status?r.status:0,t=r.statusText?r.statusText:null)}catch(A){}return{V_e:k,W_e:t,Kg:u}};Object(D.a)(a,"RtcUtils",null,[])},918:function(D,F,b){function a(Ta,qb,za,
Ia,va,Ua,Kb,ia,E,fb,Za,ec){this.HLc=!1;this.z7=null;this.RF=new ha.a;this.oeb=1;this.hO=null;this.Zs=!1;this.lGc=(new Date(0)).getTime();this.L9d=0;this._clientId=Ta;this.FTb=qb;this.YK=0;this.rh=Ia;this.VAc=ia;this.Sig=Kb;this.T8f=E;this.uag=va;this.Ona=Ua;this.Ol=za;this.hp=fb;this.ze=Za;this.Ug=ec;this.Vjg=1>100*Math.random()}function d(Ta){return Ta?Ta.charAt(0).toLocaleUpperCase()+Ta.substring(1,Ta.length):Ta}function c(Ta,qb,za){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",
Ta,d(db[za]),d("browser"),qb)}function m(Ta,qb,za,Ia,va,Ua,Kb,ia,E,fb,Za,ec){E=void 0===E?null:E;fb=void 0===fb?null:fb;Za=void 0===Za?null:Za;ec=void 0===ec?null:ec;var zc=H.createInstance(oa.AFrameworkApplication.ha),Ab=oa.AFrameworkApplication.buildVersion?oa.AFrameworkApplication.buildVersion:"1.0",vb=c(Ta,qb,Kb,Ab),kc=zc.QLg?b(1275).RealtimeChannelMetrics.createInstance(vb):new T,td=xa.a.create(va);zc.rtcJsClientFrequentlyLogsMetrics&&td.Nkj(zc.l0i);var Oc="";Oc=E&&""!==E?E:"/rtc2/";td.zKe=Sa.a.dM(Oc);
var tc=Oc+"signalr";E=Oc+"findsession";var sc=S.$Rh;Oc=new t;Za=Za||ib.a.getInstance();X.ULS.shipAssertTag(556867617,500,zc.JJf<=b(918).RealtimeChannel.aff,"Client attempting to override max payload size beyond absolute limit");var ic=Math.min(zc.JJf,b(918).RealtimeChannel.aff);td.$ef=ic;td=new v(zc,new r(Oc),Ta,vb,function(Ga){return new W(Ga.createHubProxy(sc))},ia,Za,kc,td,ic);fb||(fb=b(1216).FindSessionStrategy.createInstance(qb,va,E,ia,Ab,Kb,Ta,vb,Za,Ua,Ia,ec));fb.v5b=zc.v5b;qb=new fa(vb);za=
za?za.split(","):null;Ta=new (b(918).RealtimeChannel)(Ta,za,vb,ia,function(){return $.hubConnection(tc)},fb,td,qb,Za,kc,zc,va);Ta.init();return Ta}function r(Ta){var qb=this;this.ze=null;this.Fw=!1;this.rb=new ua.a;this.tHc=new ha.a;this.sHc=new ha.a;this.tMc=Ta;this.HTa=this.tMc.uve(function(za){return za.send()},"GlobalMaxOustandingThrottler");this.HTa.JVb(function(){qb.rb.raiseEvent("TMUDM")})}function t(){}function k(Ta,qb){Ta=w.call(this,Ta,void 0===qb?"":qb)||this;Ta.M5a=0;Ta.ygb=(new Date(0)).getTime();
Ta.currentTime=function(){return(new Date).getTime()};return Ta}function u(Ta,qb){Ta=w.call(this,Ta,void 0===qb?"":qb)||this;Ta.Eza=0;Ta.J5a=0;Ta.rb=new ua.a;Ta.bUa=!1;Ta.sMc=0;Ta.yNb=0;Ta.KNb=0;Ta.PQb=0;Ta.zTb=[];Ta.clearTimeout=u.d0c;return Ta}function w(Ta,qb){this.Ueb=this.fjb=0;this.qFc=!1;this.sVa=this.wTb=null;this.cUa=!1;this.Z8d=Ta;this.QYf=void 0===qb?"":qb;this.setTimeout=w.p0c;this.BDa=this.fjb=this.Ueb=0}function v(Ta,qb,za,Ia,va,Ua,Kb,ia,E,fb){Kb=C.call(this,Kb)||this;Kb.pr=null;Kb.k3d=
!1;Kb.nO=0;Kb.SIc=new sb.a;Kb.ze=Ta;Kb.N4d=0;Kb.O4d=0;Kb.gjb=qb;Kb.gjb.JVb(Object(ja.a)(Kb,Kb.HAi,"onTooManyUndeliveredMessages"));Kb._clientId=za;Kb.Lhg=va;Kb.ah.aug(Object(ja.a)(Kb,Kb.Gxi,"onRefreshProxyRequired"));Kb.ah.Ztg(Object(ja.a)(Kb,Kb.Dxi,"onRefreshAllPersistentStateRequest"));Kb.ah.qug(Object(ja.a)(Kb,Kb.Hca,"sendUpdateNotification"));Kb.ah.Ksg(Object(ja.a)(Kb,Kb.Lui,"onInternalPresenceUpdated"));Kb.ah.Lsg(Object(ja.a)(Kb,Kb.Mui,"onInternalUpdateNotificationReceived"));Kb.ah.Jsg(Object(ja.a)(Kb,
Kb.Kui,"onInternalPersistentStateUpdated"));Kb.ah.Isg(Object(ja.a)(Kb,Kb.Jui,"onInternalPersistentStateCleared"));Kb.ah.pug(Object(ja.a)(Kb,Kb.nGd,"sendPersistentState"));Kb.ah.Oug(Object(ja.a)(Kb,Kb.Vbb,"updateClientInfo"));Kb.rh=Ua;Kb.Ol=Ia;Kb.hp=ia;Kb.mB=E;Kb.Ugb=fb;return Kb}function A(){this.ILc=this.Bo=null}function y(Ta,qb,za,Ia){var va=Gb.call(this)||this;va.SCd=Ta;va.reconnectDelay=qb;va.reason=za;va.cGd=Ia;return va}function x(){this.T3d=new z;this.R3d=new z}function z(){this.FVd=this.UAc=
!1;this.callback=null}function J(Ta,qb){this.bjg=Ta;this.nO=void 0===qb?"":qb}function B(){this.Presence=null;this.TimeStamp=0}function C(Ta){this.gjb=null;this.zca=0;this.BHa=!1;this.ah=Ta;this.ah.hWa(Object(ja.a)(this,this.oV,"onConnectionStateChanged"))}function H(){this.yzc=this.TUd=!1;this.wzc=0;this.BAc=this.fLc=this.eLc=this.Syc=!1;this.CCc=0;this.n8d=!1;this.m8d=this.l8d=0;this.nKc=!1;this.rKc=this.qKc=this.sKc=this.oKc=0}function W(Ta){this.pr=Ta}function S(){}function N(){}function T(){this.kCf=
this.Pzd;this.nCf=this.Szd;this.mCf=this.Rzd;this.rCf=this.Uzd;this.qCf=this.Tzd;this.$zd=this.aAd;this.Xzd=this.Yzd;this.WNa=this.Vzd;this.KDb=this.Wzd;this.lCf=this.Qzd;this.xzb=this.Iqd;this.Ugc=this.Kqd}function fa(Ta){this.v8=!1;this.tVa=0;this.WAc=!1;this.setTimeout=fa.p0c;this.clearTimeout=fa.d0c;this.fei=Object(ja.a)(this,this.Edi,"logRtcConnectingUsageStatement");this.Ol=Ta}function Y(Ta,qb){this.data=Ta;this.timeStamp=qb}function L(Ta,qb,za){this.c8=null;this.fHc=this.NKc=0;this.ze=qb;this.U3d=
za;this.Aib=!1;this.ah=Ta;this.ah.nWa(Object(ja.a)(this,this.fOi,"receiveMessage"))}function P(Ta){this.messageId=Ta;this.J4i=(new Date).getTime();this.gmd=new na.a}function ea(Ta,qb){this.status=Ta;this.f5a=qb}b.r(F);D=b(0);var X=b(15),ja=b(37),R=b(139),ba=b(1120),ha=b(107),oa=b(5);Object(D.a)(ea,"UserStatusInfo",null,[]);var Sa=b(75),ma=b(586),na=b(210);Object(D.a)(P,"MessageLatencyDetails",null,[]);L.prototype.start=function(){if(this.U3d&&!this.Aib){var Ta=this.ze.KJf;this.fHc=this.ze.IJf;Ta<=
this.fHc?(X.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.ze.KJf,this.ze.IJf),this.U3d=!1):(this.Aib=!0,this.NKc=window.setInterval(Object(ja.a)(this,this.Yj,"sendMessage"),Ta))}};L.prototype.Yj=function(){var Ta=this;if(this.Aib){var qb=ma.a.create().toString();this.c8=new P(qb);this.ah.$yd(16,qb,!1,new R.a);window.setTimeout(function(){Ta.Yci(qb)},
this.fHc)}};L.prototype.Yci=function(Ta){this.c8&&this.c8.messageId===Ta&&(0<this.c8.gmd.count?(Ta=this.c8.gmd.toArray().join(","),X.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",Ta)):X.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.c8=null)};L.prototype.stop=function(){this.NKc&&(window.clearInterval(this.NKc),this.Aib=!1)};L.prototype.fOi=function(Ta,qb){16===qb.type?this.ah.$yd(17,qb.b7,!1,new R.a):17===qb.type&&this.Aib&&qb.b7&&this.oJi(qb.b7)};
L.prototype.oJi=function(Ta){Ta&&this.c8&&Ta.toString()===this.c8.messageId&&(Ta=(new Date).getTime()-this.c8.J4i,this.c8.gmd.add(Ta))};L.C$c=function(Ta,qb,za){return L.instance||(L.Pa=new L(Ta,qb,za))};Jl.Object.defineProperties(L,{instance:{configurable:!0,enumerable:!0,get:function(){return L.Pa}}});L.Pa=null;Object(D.a)(L,"ClientToClientMessageTelemetry",null,[]);var xa=b(1059),Oa=b(1009);Object(D.a)(Y,"PresenceData",null,[]);fa.prototype.Opi=function(){var Ta=this;this.v8||(this.tVa=this.setTimeout(function(){Ta.v8=
!1;Ta.Gcf()},8E3),this.v8=!0,this.WAc=!1)};fa.prototype.Mqi=function(){this.FL()};fa.prototype.Pzi=function(){this.Gcf()};fa.prototype.Gcf=function(){this.FL();this.WAc||(this.WAc=!0,this.fei())};fa.prototype.Edi=function(){X.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Ol)};fa.prototype.FL=function(){this.v8&&this.clearTimeout(this.tVa);this.tVa=0;this.v8=!1};fa.p0c=function(Ta,qb){return window.setTimeout(Ta,qb)};fa.d0c=function(Ta){window.clearTimeout(Ta)};
Object(D.a)(fa,"ConnectedUsageKpiLogger",null,[963]);T.prototype.Pzd=function(){};T.prototype.Szd=function(){};T.prototype.Rzd=function(){};T.prototype.Uzd=function(){};T.prototype.Tzd=function(){};T.prototype.Yzd=function(){};T.prototype.Wzd=function(){};T.prototype.Vzd=function(){};T.prototype.aAd=function(){};T.prototype.Qzd=function(){};T.prototype.Iqd=function(){};T.prototype.Kqd=function(){};Object(D.a)(T,"NoopRealtimeChannelMetrics",null,[959,79]);N.vKb="presenceUpdated";N.updateNotification=
"updateNotification";N.nwf="persistentStateCleared";N.updatePersistentState="persistentStateUpdated";Object(D.a)(N,"RtcClientMethodNames",null,[]);S.$Rh="realtimeChannelHub";S.vKb="UpdatePresence";S.Hca="SendUpdateNotification";S.C8c="GetCompletePersistentStateWithMetadata";S.updatePersistentState="UpdatePersistentState";S.Vbb="UpdateClientInfo";Object(D.a)(S,"RtcHubMethodNames",null,[]);W.prototype.DQi=function(Ta){this.pr.on(N.vKb,Ta)};W.prototype.bRi=function(Ta){this.pr.on(N.updateNotification,
Ta)};W.prototype.BQi=function(Ta){this.pr.on(N.updatePersistentState,Ta)};W.prototype.AQi=function(Ta){this.pr.on(N.nwf,Ta)};W.prototype.Muj=function(Ta){this.pr.off(N.vKb,Ta)};W.prototype.Uuj=function(Ta){this.pr.off(N.updateNotification,Ta)};W.prototype.Luj=function(Ta){this.pr.off(N.updatePersistentState,Ta)};W.prototype.Kuj=function(Ta){this.pr.off(N.nwf,Ta)};W.prototype.vKb=function(Ta){return this.pr.invoke(S.vKb,Ta)};W.prototype.Vbb=function(Ta){return this.pr.invoke(S.Vbb,Ta)};W.prototype.Hca=
function(Ta,qb){return this.pr.invoke(S.Hca,Ta,qb)};W.prototype.C8c=function(Ta){return this.pr.invoke(S.C8c,Ta)};W.prototype.updatePersistentState=function(Ta,qb){return this.pr.invoke(S.updatePersistentState,Ta,qb)};Object(D.a)(W,"RealtimeChannelProxy",null,[960,961,962]);H.createInstance=function(Ta){var qb=b(918).RealtimeChannel;return Ta?Object.assign(new H,{TUd:Ta.ta("AwayStatusManagerIsEnabled"),yzc:Ta.ta("AwayStatusOneMinuteTimeoutIsEnabled"),wzc:Ta.qd("AwayCoauthorThresholdMs",9E5),Syc:Ta.ta("RtcAllowCrossDomainAccessEnabled"),
eLc:Ta.ta("ShouldLogOnContentNotification"),fLc:Ta.ta("ShouldLogOnHostSubscriptionNotification"),BAc:Ta.ta("RtcClientMetricsEnabled"),CCc:Ta.qd("RtcFindSessionRequestTimeoutInMS",6E4),n8d:Ta.ta("RtcJsClientFrequentlyLogsMetrics"),l8d:Ta.qd("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),m8d:Ta.qd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),nKc:Ta.ta("RtcClientMessageTelemetryEnabled"),oKc:Ta.qd("RtcClientMessageTelemetrySampleSize",5),sKc:Ta.qd("RtcSendTelemetryMessageIntervalInMS",3E5),
qKc:Ta.qd("RtcLogClientMessageMetricsTimeOutInMs",2E4),rKc:Ta.qd("RtcMaxPayloadSizeInCharactersOverride",qb.$od)}):Object.assign(new H,{TUd:!1,yzc:!1,wzc:9E5,Syc:!1,eLc:!1,fLc:!0,BAc:!1,CCc:9E4,nKc:!1,oKc:5,sKc:3E5,qKc:2E4,rKc:qb.$od})};Jl.Object.defineProperties(H.prototype,{LAg:{configurable:!0,enumerable:!0,get:function(){return this.yzc}},KAg:{configurable:!0,enumerable:!0,get:function(){return this.wzc}},pwg:{configurable:!0,enumerable:!0,get:function(){return this.Syc}},cdj:{configurable:!0,
enumerable:!0,get:function(){return this.eLc}},ddj:{configurable:!0,enumerable:!0,get:function(){return this.fLc}},QLg:{configurable:!0,enumerable:!0,get:function(){return this.BAc}},v5b:{configurable:!0,enumerable:!0,get:function(){return this.CCc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,enumerable:!0,get:function(){return this.n8d}},HJf:{configurable:!0,enumerable:!0,get:function(){return this.l8d}},l0i:{configurable:!0,enumerable:!0,get:function(){return this.m8d}},rtcClientMessageTelemetryEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.nKc}},g0i:{configurable:!0,enumerable:!0,get:function(){return this.oKc}},KJf:{configurable:!0,enumerable:!0,get:function(){return this.sKc}},IJf:{configurable:!0,enumerable:!0,get:function(){return this.qKc}},JJf:{configurable:!0,enumerable:!0,get:function(){return this.rKc}}});Object(D.a)(H,"RealtimeChannelSettings",null,[967]);var ib=b(1212),sb=b(339);C.prototype.oV=function(Ta,qb){this.zca=qb.newState};C.prototype.HAi=function(){X.ULS.sendTraceTag(18637070,
500,15,"Too many undelivered messages. Restarting RTC connection.");this.ah.Jlc()};C.prototype.DUh=function(Ta){this.gjb.init(Ta)};Object(D.a)(C,"ARtcMessageHandler",null,[]);Object(D.a)(B,"PresenceDataEntryForClients",null,[]);var nb=b(113);J.prototype.send=function(){return this.bjg()};Jl.Object.defineProperties(J.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.nO}}});Object(D.a)(J,"MessageHandler",null,[974]);z.prototype.LM=function(Ta){this.callback=Ta;this.k_f()};
z.prototype.Fef=function(Ta){this.UAc||(this.UAc=!0,this.qag=Ta,this.k_f())};z.prototype.k_f=function(){this.UAc&&this.callback&&!this.FVd&&(this.FVd=!0,this.callback(this.qag))};Object(D.a)(z,"CompletionTask",null,[]);x.prototype.Fic=function(Ta){this.T3d.LM(Ta)};x.prototype.Eic=function(Ta){this.R3d.LM(Ta)};x.prototype.Pyb=function(Ta){this.T3d.Fef(Ta)};x.prototype.mwa=function(Ta){this.R3d.Fef(Ta)};x.prototype.Tod=function(){this.Pyb(2);this.mwa(2)};Object(D.a)(x,"MessageStatus",null,[973]);var Gb=
Sys.EventArgs;Cm(y,Gb);Object(D.a)(y,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var Ha=b(1121);A.prototype.start=function(){this.Bo=new Date};A.prototype.stop=function(){this.ILc=new Date};Jl.Object.defineProperties(A.prototype,{Gc:{configurable:!0,enumerable:!0,get:function(){return this.Bo?this.ILc?this.ILc.getTime()-this.Bo.getTime():(new Date).getTime()-this.Bo.getTime():0}}});Object(D.a)(A,"SimpleStopwatch",null,[]);var ca=b(1122),Ra;(function(Ta){Ta[Ta.contentUpdate=0]="contentUpdate";
Ta[Ta.editorsTableUpdate=1]="editorsTableUpdate";Ta[Ta.fileNameUpdate=2]="fileNameUpdate";Ta[Ta.wetContentUpdate=3]="wetContentUpdate";Ta[Ta.persistedContentUpdate=4]="persistedContentUpdate";Ta[Ta.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Ta[Ta.replicationTelemetry=6]="replicationTelemetry";Ta[Ta.lockUpdate=7]="lockUpdate";Ta[Ta.collabServiceContentUpdate=8]="collabServiceContentUpdate";Ta[Ta.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Ta[Ta.saveTargetUpdate=10]="saveTargetUpdate";
Ta[Ta.uploadToOcsUpdate=11]="uploadToOcsUpdate";Ta[Ta.labelUpdate=12]="labelUpdate";Ta[Ta.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Ta[Ta.subscribeOrExtend=14]="subscribeOrExtend";Ta[Ta.elapsedBootTelemetry=15]="elapsedBootTelemetry";Ta[Ta.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Ta[Ta.clientToClientResponseMessage=17]="clientToClientResponseMessage";Ta[Ta.verifyNotificationPipeline=18]="verifyNotificationPipeline";Ta[Ta.hostNotificationHeartbeat=
19]="hostNotificationHeartbeat";Ta[Ta.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Ta[Ta.last=21]="last"})(Ra||(Ra={}));Object(D.b)("UpdateNotificationType",Ra);Cm(v,C);v.prototype.Gxi=function(Ta,qb){this.pr=this.Lhg(qb.hubConnection);this.gjb.reset();this.pr.DQi(Object(ja.a)(this,this.Mka,"onPresenceUpdated"));this.pr.BQi(Object(ja.a)(this,this.Vic,"onPersistentStateUpdated"));this.pr.AQi(Object(ja.a)(this,this.cud,"onPersistentStateCleared"));this.pr.bRi(Object(ja.a)(this,this.xba,"onUpdateNotificationReceived"))};
v.prototype.oV=function(Ta,qb){this.zca=qb.newState;2===qb.newState&&this.w4i()};v.prototype.w4i=function(){for(var Ta=Ml(this.SIc),qb=Ta.next();!qb.done;qb=Ta.next())qb=qb.value,this.Hca(null,new Ha.a(qb.key,qb.value,!1,new R.a));this.SIc=new sb.a};v.prototype.Dxi=function(Ta,qb){qb.GVc();for(Ta=0;2>Ta;++Ta)this.f4i(Ta,qb)};v.prototype.f4i=function(Ta,qb){var za=this;try{this.pr.C8c(Ta).done(function(Ia){qb.ycb(qb.yXc,"GetCompletePresenceSuccess")&&(qb.jPg.Pzi(),X.ULS.sendTraceTag(3249540,500,50,
"Successfully retrieved complete session state for [{0}]",za.Ol),za.ah.SLi(),za.Xwi(Ta,Ia),za.ah.uLi(Ia),qb.GIe.tb(Ta)&&za.ah.PAf(Ta,qb.GIe.oa(Ta),new R.a))}).fail(function(Ia){var va=b(821).RtcUtils;qb.ycb(qb.yXc,"GetCompletePresenceFail")&&(X.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",va.Hwa(Ia),za.Ol),za.ah.Jlc())}).always(function(){qb.stopwatch&&qb.stopwatch.stop()})}catch(Ia){X.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",
qb.yXc,Ia.message)}};v.prototype.nGd=function(Ta,qb){var za=this,Ia=b(821).RtcUtils;Ta=qb.presence;var va=qb.IN;this.mB.Bx(1,0);try{var Ua=Ia.hVc(Ta,this.Ugb)}catch(ia){this.mB.Bx(1,3);X.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",ia.message);va.setException(ia);return}Ia=new ha.a;Ia.ja(this._clientId,Object.assign(new B,{Presence:Ta,TimeStamp:(new Date).getTime()}));this.ah.XAf(qb.type,Ia);if(2!==this.zca)this.hp.WNa(),this.mB.Bx(1,
2),va.setResult(null);else{var Kb=this.nO.toString();++this.nO;Ta=new J(function(){return za.y4i(qb.type,Ua,Kb)},Kb);Ta=this.PYf(0,qb.type).add(Ta);Ta.Fic(function(ia){2===ia&&za.mB.Bx(1,6);va.setResult(null)});Ta.Eic(function(){})}};v.prototype.y4i=function(Ta,qb,za){var Ia=this,va=null,Ua=new A,Kb=new x;X.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Ol);if(2!==this.zca)return this.hp.WNa(),this.mB.Bx(1,2),X.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Ol),Kb.Tod(),Kb;this.rh&&20>this.N4d&&(va=this.rh.Ic("WebServiceCall","Send Presence Message"),this.N4d++);Ua.start();Kb.Pyb(1);try{this.pr.updatePersistentState(Ta,qb).done(function(){Ia.hp.Xzd();Ia.mB.Bx(1,1);X.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",za,Ia.Ol);Kb.mwa(1);Ua&&(Ua.stop(),Ua.Gc>Ia.ze.HJf?Ia.mB.Bx(1,4):Ia.mB.Bx(1,5))}).fail(function(ia){var E=b(821).RtcUtils;Ia.BHa||(Ia.hp.WNa(),Ia.mB.Bx(1,3),X.ULS.sendTraceTag(3249503,500,
15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",za,E.Hwa(ia),Ia.Ol));Kb.mwa(2)}).always(function(){va&&va.stop()})}catch(ia){X.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",ia.message),this.mB.Bx(1,3),Kb.mwa(2)}return Kb};v.prototype.Vbb=function(Ta,qb){var za=this;Ta=b(821).RtcUtils;var Ia=qb.PLg,va=qb.IN;try{var Ua=Ta.hVc(Ia,this.Ugb)}catch(Kb){X.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",
Kb.message);va.setException(Kb);return}try{this.pr.Vbb(Ua).done(function(){X.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(Kb){var ia=b(821).RtcUtils;za.BHa||X.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",ia.Hwa(Kb));va.setResult(null)})}catch(Kb){X.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Kb.message),va.setResult(null)}};v.prototype.Hca=function(Ta,qb){var za=
this;Ta=b(821).RtcUtils;var Ia=qb.type,va=qb.b7,Ua=qb.g1g,Kb=qb.IN;this.mB.Bx(0,0);try{var ia=Ta.hVc(va,this.Ugb)}catch(fb){this.mB.Bx(0,3);X.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",fb.message);Kb.setException(fb);return}if(2!==this.zca)Ua?this.SIc.ja(Ia,va):(this.hp.WNa(),this.mB.Bx(0,2)),Kb.setResult(null);else{var E=this.nO.toString();++this.nO;qb=new J(function(){return za.S4i(Ia,ia,E)},E);qb=this.PYf(1,Ia).add(qb);qb.Fic(function(fb){2===
fb&&za.mB.Bx(0,6);Kb.setResult(null)});qb.Eic(function(){})}};v.prototype.S4i=function(Ta,qb,za){var Ia=this,va=null,Ua=new A,Kb=new x;X.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Ol);if(2!==this.zca)return this.hp.WNa(),this.mB.Bx(0,2),X.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Ol),Kb.Tod(),Kb;this.rh&&3===Ta&&20>this.O4d&&(va=this.rh.Ic("WebServiceCall","Send WetContent Update"),this.O4d++);Ua.start();Kb.Pyb(1);
this.pr.Hca(Ta,qb).done(function(){Ia.hp.Xzd();Ia.mB.Bx(0,1);X.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",za,Ia.Ol);Kb.mwa(1);Ua&&(Ua.stop(),Ua.Gc>Ia.ze.HJf?Ia.mB.Bx(0,4):Ia.mB.Bx(0,5))}).fail(function(ia){var E=b(821).RtcUtils;Ia.BHa||(Ia.hp.WNa(),Ia.mB.Bx(0,3),X.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",za,E.Hwa(ia),Ia.Ol));Kb.mwa(2)}).always(function(){va&&va.stop()});
return Kb};v.prototype.lv=function(){this.pr.Muj(Object(ja.a)(this,this.Mka,"onPresenceUpdated"));this.pr.Luj(Object(ja.a)(this,this.Vic,"onPersistentStateUpdated"));this.pr.Kuj(Object(ja.a)(this,this.cud,"onPersistentStateCleared"));this.pr.Uuj(Object(ja.a)(this,this.xba,"onUpdateNotificationReceived"))};v.prototype.Lui=function(Ta,qb){this.Mka(qb.bI,qb.mha)};v.prototype.Mka=function(Ta){this.hp.KDb();this.Vic(0,Ta)};v.prototype.Kui=function(Ta,qb){this.Vic(qb.type,qb.bI)};v.prototype.Xwi=function(Ta,
qb){var za={},Ia;for(Ia in qb)za[Ia]=qb[Ia].Presence;this.jqf(Ta,za,qb)};v.prototype.Vic=function(Ta,qb){this.hp.KDb();this.jqf(Ta,qb)};v.prototype.jqf=function(Ta,qb,za){za=void 0===za?null:za;var Ia=b(821).RtcUtils;if(X.ULS.Pca(500,100))for(var va in qb);delete qb[this._clientId];if(!nb.a.isEmpty(qb)){for(var Ua in qb)va=Ua,qb[va]=Ia.deserialize(qb[Ua],"Presence",va,!1,this.Ugb);Ia=new ha.a;Ua=(new Date).getTime();for(var Kb in qb){va=qb[Kb];var ia=Kb;if(za){var E=za[ia];E.Presence=va}else E=Object.assign(new B,
{Presence:va,TimeStamp:Ua});Ia.ja(ia,E)}this.ah.XAf(Ta,Ia);Ta?this.ah.MLi(Ta,qb):(this.k3d||(X.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Ol),this.k3d=!0,oa.AFrameworkApplication.dg&&oa.AFrameworkApplication.dg.Rfi()),this.ah.HAf(qb,[]))}};v.prototype.Jui=function(Ta,qb){this.cud(qb.bWc)};v.prototype.cud=function(Ta){this.hp.KDb();if(X.ULS.Pca(500,100))for(var qb=0;qb<Ta.length;++qb);Ta.length&&(this.ah.fMi(Ta),this.ah.LLi(Ta),this.ah.HAf({},Ta))};
v.prototype.Mui=function(Ta,qb){this.xba(qb.type,qb.b7)};v.prototype.xba=function(Ta,qb){qb=void 0===qb?null:qb;this.ze.cdj&&!Ta&&X.ULS.sendTraceTag(40128990,500,100,"Received ContentUpdate notification from the server");this.ze.ddj&&13===Ta&&X.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",qb||"<none>"));this.hp.KDb();5===Ta?(qb=(Ta=this.kEi(qb))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",
Ta.reason,Ta.reconnectDelay):"Received client reconnection request from the server without params.",X.ULS.sendTraceTag(18637071,500,50,qb),this.ah.Jlc(Ta)):(qb=b(821).RtcUtils.deserialize(qb,String.format("UpdateNotification-{0}",Ra[Ta]),null,!1,this.Ugb),this.ah.eMi(Ta,qb))};v.prototype.kEi=function(Ta){try{if(!Ta||""===Ta)return null;var qb=JSON.parse(Ta);return new y(qb[ca.a.LEd],qb[ca.a.f0i],qb[ca.a.h0i],qb[ca.a.cGd])}catch(za){return X.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",
za.message),null}};v.prototype.PYf=function(Ta,qb){return this.gjb.lJh(this.mJh(Ta,qb))};v.prototype.mJh=function(Ta,qb){return Ta+","+qb};Object(D.a)(v,"RtcMessageHandler",C,[]);var ua=b(94);w.prototype.Zzd=function(){0<this.BDa&&0<this.Ueb&&X.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.QYf,this.Ueb,this.BDa);0<this.BDa&&0<this.fjb&&X.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.QYf,this.fjb,this.BDa)};
w.prototype.Xqc=function(Ta,qb){this.fjb++;this.hnb(!0);this.qFc=!0;this.wTb=Ta;this.sVa=qb};w.prototype.hnb=function(Ta){this.qFc=!1;this.sVa&&Ta&&(this.Ueb++,this.sVa.Tod());this.sVa=this.wTb=null};w.p0c=function(Ta,qb){return window.setTimeout(Ta,qb)};Jl.Object.defineProperties(w.prototype,{N3a:{configurable:!0,enumerable:!0,get:function(){return this.qFc}}});Object(D.a)(w,"ThrottlerBase",null,[]);Cm(u,w);u.prototype.add=function(Ta){this.cUa||this.init(u.aye,u.Txe);this.BDa++;var qb=new x;this.N3a?
this.Xqc(Ta,qb):this.PQb<this.J5a?this.mGb(Ta,qb):(this.Xqc(Ta,qb),this.bUa=!1);return qb};u.prototype.mGb=function(Ta,qb){var za=this;Ta=this.Z8d(Ta);var Ia=this.setTimeout(Object(ja.a)(this,this.Svi,"onMessageWaitTimeExpired"),this.Eza);++this.PQb;Array.add(this.zTb,Ia);var va=this.yNb;Ta.Fic(function(Ua){qb.Pyb(Ua)});Ta.Eic(function(Ua){za.yNb===va&&(za.Rvi(va,Ia),qb.mwa(Ua))})};u.prototype.Rvi=function(Ta,qb){this.yNb===Ta&&(--this.PQb,this.clearTimeout(qb),Array.remove(this.zTb,qb),this.N3a&&
this.H4i())};u.prototype.H4i=function(){this.N3a&&!this.bUa&&(this.sMc=this.setTimeout(Object(ja.a)(this,this.I4i,"sendThrottledMessageFromTimer"),0),this.bUa=!0)};u.prototype.I4i=function(){this.bUa=!1;if(this.N3a){var Ta=this.wTb,qb=this.sVa;this.hnb(!1);this.mGb(Ta,qb)}};u.prototype.Svi=function(){++this.KNb;this.KNb>Math.floor(this.J5a/2)&&(this.KNb=-1E9,this.rb.raiseEvent("TMUDM"))};u.prototype.JVb=function(Ta){this.rb.addHandler("TMUDM",Ta)};u.prototype.reset=function(){this.BDa=this.fjb=this.Ueb=
this.KNb=0;++this.yNb;for(var Ta=Ml(this.zTb),qb=Ta.next();!qb.done;qb=Ta.next())this.clearTimeout(qb.value);this.PQb=0;this.zTb=[];this.hnb(!0);this.bUa&&(this.clearTimeout(this.sMc),this.sMc=0,this.bUa=!1)};u.prototype.init=function(Ta,qb){this.cUa||(this.Eza=Ta,this.J5a=qb,this.cUa=!0)};u.createInstance=function(Ta,qb){return new u(Ta,void 0===qb?"":qb)};u.d0c=function(Ta){window.clearTimeout(Ta)};u.aye=15E3;u.Txe=5;Object(D.a)(u,"MaxOutstandingThrottler",w,[968,969]);Cm(k,w);k.prototype.init=
function(Ta){this.cUa||(this.M5a=Ta,this.cUa=!0)};k.prototype.add=function(Ta){this.cUa||this.init(k.Jxe);this.BDa++;var qb=this.currentTime(),za=new x;this.ygb>qb&&(this.ygb=qb);this.N3a?(this.hnb(!0),this.Xqc(Ta,za)):this.ygb+this.M5a<=qb?this.mGb(Ta,za):(this.Xqc(Ta,za),this.setTimeout(Object(ja.a)(this,this.G4i,"sendThrottledMessage"),this.ygb+this.M5a-qb));return za};k.prototype.G4i=function(){if(this.N3a){var Ta=this.wTb,qb=this.sVa;this.hnb(!1);this.mGb(Ta,qb)}};k.prototype.mGb=function(Ta,
qb){this.ygb=this.currentTime();Ta=this.Z8d(Ta);Ta.Fic(function(za){qb.Pyb(za)});Ta.Eic(function(za){qb.mwa(za)})};k.createInstance=function(Ta,qb){return new k(Ta,void 0===qb?"":qb)};k.Jxe=200;Object(D.a)(k,"MaxRateThrottler",w,[972,969]);t.prototype.uve=function(Ta,qb){return u.createInstance(Ta,void 0===qb?"":qb)};t.prototype.lVg=function(Ta,qb){return k.createInstance(Ta,void 0===qb?"":qb)};Object(D.a)(t,"ThrottlerFactory",null,[964]);var ta=b(1123);r.prototype.init=function(Ta){this.Fw||(this.ze=
Ta,this.HTa.init(this.ze.Eza,this.ze.JLh),this.Fw=!0)};r.prototype.lJh=function(Ta){var qb=this;this.Fw||this.init(new ta.a(k.Jxe,u.aye,u.Txe,r.Hgi));if(!function(){var Ua=qb.tHc.Ec(Ta);va=Ua.value;return Ua}().returnValue){if(!function(){var Ua=qb.sHc.Ec(Ta);Ia=Ua.value;return Ua}().returnValue){var za="MaxOutstandingThrottler-"+Ta;var Ia=this.tMc.uve(Object(ja.a)(this.HTa,this.HTa.add,"add"),za);Ia.init(this.ze.Eza,this.ze.Ggi);Ia.JVb(function(){qb.rb.raiseEvent("TMUDM")});this.sHc.add(Ta,Ia)}za=
"MaxRateThrottler-"+Ta;var va=this.tMc.lVg(Object(ja.a)(Ia,Ia.add,"add"),za);va.init(this.ze.Khi);this.tHc.add(Ta,va)}return va};r.prototype.reset=function(){for(var Ta=Ml(this.tHc),qb=Ta.next();!qb.done;qb=Ta.next())qb.value.value.Zzd();Ta=Ml(this.sHc);for(qb=Ta.next();!qb.done;qb=Ta.next())qb=qb.value,qb.value.Zzd(),qb.value.reset();this.HTa.Zzd();this.HTa.reset()};r.prototype.JVb=function(Ta){this.rb.addHandler("TMUDM",Ta)};r.Hgi=1E3;Object(D.a)(r,"ThrottlerManager",null,[965]);var db;(function(Ta){Ta[Ta.unspecified=
0]="unspecified";Ta[Ta.word=1]="word";Ta[Ta.excel=2]="excel";Ta[Ta.powerPoint=3]="powerPoint";Ta[Ta.test=4]="test";Ta[Ta.wacFrontEnd=5]="wacFrontEnd";Ta[Ta.oneNote=6]="oneNote";Ta[Ta.visio=7]="visio";Ta[Ta.officeMobile=8]="officeMobile";Ta[Ta.last=9]="last"})(db||(db={}));Object(D.b)("RtcClientAppName",db);b.d(F,"RealtimeChannel",function(){return a});a.prototype.init=function(){var Ta=this;this.ah.$tg(Object(ja.a)(this,this.o2b,"disconnectAndCreateNewConnection"));this.ah.Qug(Object(ja.a)(this,this.VAi,
"onUpdatePersistentStateRequestReceivedInternal"));this.ah.Pug(Object(ja.a)(this,this.UAi,"onUpdatePersistentStateClearedRequestReceived"));this.Ug.BOc(this.hp);oa.AFrameworkApplication.OIb(function(){Ta.hp.$zd();xa.a.instance&&xa.a.instance.ynd()});this.Bve();this.c3g();this.ah.sug(Object(ja.a)(this,this.bwj,"updateConnectionQueryString"))};a.prototype.c3g=function(){try{var Ta=$.signalR;if(!Ta)throw Error.invalidOperation("Failed to retrieve Signalr object");var qb=Ta.version;if(!qb)throw Error.invalidOperation("Signalr object is missing version information");
if("2.1.1"===qb){var za=Ta.transports;if(!za)throw Error.invalidOperation("Failed to retrieve transports object");var Ia=za.longPolling;if(!Ia)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Ia.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Ia.supportsKeepAlive=this.KXg()}}catch(va){X.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",va.message)}};a.prototype.KXg=function(){return function(){return!1}};
a.prototype.Bve=function(){var Ta=this,qb=++this.oeb;this.lGc=(new Date(0)).getTime();this.hO=this.uag();this.ah.QLi(this.hO);this.hO.stateChanged(function(za){Ta.Qpi(za,qb)});this.hO.connectionSlow(Object(ja.a)(this,this.Dzi,"onSlowConnection"));this.hO.error(Object(ja.a)(this,this.uzi,"onSignalRError"));this.hO.log=Object(ja.a)(this,this.vzi,"onSignalRLog")};a.prototype.ycb=function(Ta,qb){return Ta!==this.oeb?(X.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",qb),
!1):!0};a.prototype.connect=function(){2!==this.YK&&1!==this.YK&&(X.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Ol),this.VAc.Opi(),Oa.a.instance.Pkj(),this.oV(1,this.YK),this.rVf())};a.prototype.rVf=function(){var Ta=this.oeb;this.HLc=!1;this.hp.kCf();this.Ona.TGh(Object(ja.a)(this,this.ePg,"connectSignalrConnection"),Object(ja.a)(this,this.Dmf,"onFailureToConnect"),Object(ja.a)(this.wya,this.wya.DUh,"initThrottlerManager"),Object(ja.a)(this,this.ycb,"verifyConnectionToken"),
Ta)};a.prototype.Dmf=function(Ta){Ta=void 0===Ta?null:Ta;this.hp.mCf();var qb=null;!Ta||"documentsessiondeleted"!==(qb=Ta.toLowerCase())&&"documentsessionexpired"!==qb?this.o2b():(X.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Ol,Ta),this.disconnect())};a.prototype.o2b=function(Ta,qb){qb=void 0===qb?null:qb;X.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.z7);
Ta=(Ta=2===this.YK||1===this.YK)&&!this.wya.BHa;var za=!0,Ia=0;qb&&Object.getType(qb)!==Object.getType(Sys.EventArgs.Empty)&&qb.SCd&&""!==qb.SCd&&(Ta=!0,this.Ona.J9i(qb.SCd),za=qb.cGd,Ia=qb.reconnectDelay);Ta&&this.oV(1,this.YK);++this.oeb;this.wya.lv();this.Nlj(za);this.Ona.b4g();this.Bve();Ta&&window.setTimeout(Object(ja.a)(this,this.rVf,"startConnecting"),Math.min(Ia,3E4))};a.prototype.bwj=function(){var Ta=this.Ona.pQe();var qb=Ta.correlationId;this.hO.qs=Ta.returnValue;X.ULS.sendTraceTag(40768457,
500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Ol,qb)};a.prototype.ePg=function(Ta){var qb=this;this.lGc=(new Date).getTime();var za=null;this.hO.qs=function(){var va=qb.Ona.pQe();za=va.correlationId;return va}().returnValue;this.ze.pwg&&(this.hO.url=Ta,xa.a.instance&&(xa.a.instance.Tse=Sa.a.dM(Ta)));var Ia=null;this.rh&&(Ia=this.rh.Ic("WebServiceCall","ConnectToServer"));X.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Ol);Ta=
{};this.FTb&&(Ta.transport=1===this.FTb.length?this.FTb[0]:this.FTb);Ta.pingInterval=null;Oa.a.instance.JDb(1,0);Ta.waitForPageLoad=!1;this.hO.start(Ta,null).done(function(va){qb.hp.nCf();Oa.a.instance.JDb(1,1,!0);X.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",va.id,za)}).fail(function(va){var Ua=b(821).RtcUtils;X.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",
qb.Ona.QB,za,Ua.Hwa(va),qb.Ol);qb.Dmf();qb.hp.lCf(va);Oa.a.instance.JDb(1,1,!1);Ua={};qb.ah.MAf(0,(Ua.CorrelationId=za,Ua.ErrorDetails=va,Ua.ConnectionState=ba.a[qb.YK],Ua))}).always(function(){Ia&&Ia.stop();xa.a.instance&&(xa.a.instance.lCc=!1)})};a.prototype.disconnect=function(){this.YK?(this.hp.qCf(),xa.a.instance&&(xa.a.instance.lCc=!0),X.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Ol),this.wya.BHa=!0,this.VAc.Mqi(),this.oV(0,this.YK),this.o2b(),this.wya.BHa=
!1):X.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Ol)};a.prototype.Nlj=function(Ta){function qb(){if(za.HLc)X.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{za.HLc=!0,va.stop(!0,Ta)}catch(Kb){X.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Kb.message)}}var za=this,Ia=this.ZGg(),va=this.hO,Ua=this.z7;0<Ia?(X.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",
Ua,Ia),window.setTimeout(qb,Ia)):(X.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Ua),qb())};a.prototype.ZGg=function(){var Ta=0;this.hO.state||(Ta=this.lGc+a.aCj-(new Date).getTime(),0>Ta&&(Ta=0));return Ta};a.prototype.hWa=function(Ta){this.ah.hWa(Ta)};a.prototype.Xmc=function(Ta){this.ah.Xmc(Ta)};a.prototype.yMf=function(Ta){this.nGd(0,Ta)};a.prototype.nGd=function(Ta,qb){var za=new R.a;this.ah.PAf(Ta,qb,za);return za.task};a.prototype.kEa=function(Ta){this.ah.kEa(Ta)};a.prototype.jya=
function(Ta){this.ah.jya(Ta)};a.prototype.etb=function(Ta){return this.RF.tb(Ta)&&this.RF.oa(Ta).tb(0)?this.RF.oa(Ta).oa(0).data:null};a.prototype.K6b=function(){return this.pth()};a.prototype.pth=function(){for(var Ta={},qb=Ml(this.RF),za=qb.next();!za.done;za=qb.next())za=za.value,za.value.tb(0)&&(Ta[za.key]=za.value.oa(0).data);return Ta};a.prototype.VAi=function(Ta,qb){Ta=Ml(qb.ozj);for(var za=Ta.next();!za.done;za=Ta.next()){za=za.value;this.RF.tb(za.key)||this.RF.ja(za.key,new sb.a);var Ia=
za.value;this.RF.oa(za.key).ja(qb.type,new Y(Ia.Presence,new Date(Ia.TimeStamp)));za.key!==this._clientId||qb.type||this.ah.ELi(Ia.Presence)}};a.prototype.UAi=function(Ta,qb){Ta=Ml(qb.bWc);for(qb=Ta.next();!qb.done;qb=Ta.next())this.RF.remove(qb.value)};a.prototype.nth=function(){var Ta=new sb.a;if(!this.RF.tb(this._clientId))return Ta;for(var qb=Ml(this.RF.oa(this._clientId)),za=qb.next();!za.done;za=qb.next())za=za.value,Ta.ja(za.key,za.value.data);return Ta};a.prototype.Hca=function(Ta,qb,za){qb=
void 0===qb?null:qb;za=void 0===za?!1:za;var Ia=new R.a;this.ah.$yd(Ta,qb,za,Ia);return Ia.task};a.prototype.nWa=function(Ta){this.ah.nWa(Ta)};a.prototype.KEb=function(Ta){this.ah.KEb(Ta)};a.prototype.hua=function(Ta){var qb=this,za,Ia;return function(){var va=qb.RF.Ec(Ta);za=va.value;return va}().returnValue&&function(){var va=za.Ec(0);Ia=va.value;return va}().returnValue?new ea(this.rKh(Ia),Ia.timeStamp):null};a.prototype.uth=function(){for(var Ta={},qb={},za=Ml(this.RF),Ia=za.next();!Ia.done;qb=
{Zcb:qb.Zcb,Zxc:qb.Zxc},Ia=za.next())qb.Zcb=Ia.value,qb.Zxc=void 0,function(va){return function(){var Ua=va.Zcb.value.Ec(0);va.Zxc=Ua.value;return Ua}}(qb)().returnValue&&(Ta[qb.Zcb.key]=this.hua(qb.Zcb.key));return Ta};a.prototype.Vbb=function(Ta){var qb=new R.a;this.ah.dMi(Ta,qb);return qb.task};a.prototype.dispose=function(){this.Zs||(this.wya.lv(),this.Ug.nSi(this.hp),this.hp.$zd(),xa.a.instance&&xa.a.instance.ynd(),this.Zs=!0)};a.prototype.Qpi=function(Ta,qb){this.ycb(qb,"StateChangedSignalR")&&
this.oV(this.Fte(Ta.newState),this.Fte(Ta.oldState))};a.prototype.oV=function(Ta,qb){if((1!==this.YK||qb||1!==Ta)&&this.YK!==qb){var za=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.YK,qb,Ta]));X.ULS.sendTraceTag(3290053,500,10,za)}if(this.YK!==Ta){switch(Ta){case 2:xa.a.instance&&xa.a.instance.Ufi();this.z7=this.hO.id;X.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",
this.z7,this.Ol);this.Zdi(this.hO);X.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");za=null;this.rh&&(za=this.rh.Ic("WebServiceCall","Receive First Presence"));var Ia=this.oeb;this.ah.PLi(Object(ja.a)(this,this.ycb,"verifyConnectionToken"),Ia,this.VAc,Object(ja.a)(this,this.GVc,"clearExistingPersistentState"),this.nth(),za);this.ze.rtcClientMessageTelemetryEnabled&&L.C$c(this.ah,this.ze,100*Math.random()<=this.ze.g0i).start();break;case 1:2===qb&&X.ULS.sendTraceTag(4298644,500,
50,"Lost connection [{0}] to the server ...trying to re-establish it",this.z7);break;case 0:if(L.instance&&L.instance.stop(),this.wya.BHa)X.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.z7);else{1===qb&&(X.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.z7),this.hp.rCf());2===qb&&X.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.z7);this.o2b();return}}this.YK=Ta;this.ah.gLi(Ta,qb)}};a.prototype.Zdi=function(Ta){if(Ta&&Ta.transport&&Ta.transport.name){Ta=Ta.transport.name;var qb=Ta.toLowerCase();"websockets"===qb?X.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Ta,this.Ol):"serversentevents"===qb?X.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",Ta,this.Ol):"foreverframe"===qb?X.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Ta,this.Ol):"longpolling"===qb?X.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",Ta,this.Ol):"mocktransport"!==qb&&X.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Ta)}else X.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.Dzi=function(){X.ULS.sendTraceTag(3249544,500,50,"Detected that the connection [{0}] is slow",this.z7)};a.prototype.uzi=function(Ta){var qb=b(821).RtcUtils;X.ULS.sendTraceTag(3249545,600,10,"SignalR ERROR for connection [{0}]: {1}",this.z7,qb.Hwa(Ta)||
"<empty>")};a.prototype.vzi=function(Ta){Ta=b(821).RtcUtils.Hwa(Ta);this.$hj&&2E3>this.L9d&&!Ta.startsWith("Invok")&&!Ta.startsWith("Trigger")&&(X.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Ta),this.L9d++)};a.prototype.GVc=function(){var Ta=[],qb=this.RF.Ec(this._clientId);var za=qb.value;qb.returnValue&&this.RF.remove(this._clientId);var Ia=Ml(this.RF.keys);for(qb=Ia.next();!qb.done;qb=Ia.next())Array.add(Ta,qb.value);Ia=Ml(Ta);for(qb=Ia.next();!qb.done;qb=Ia.next())this.RF.remove(qb.value);
za&&this.RF.ja(this._clientId,za);this.ah.ALi(Ta)};a.prototype.Fte=function(Ta){switch(Ta){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Ta,"Unknown SignalR state");}};a.prototype.rKh=function(Ta){return Ta&&Ta.timeStamp?(new Date).getTime()-Ta.timeStamp.getTime()>(this.ze.LAg?6E4:this.ze.KAg)?2:1:1};a.createInstance=function(Ta,qb,za,Ia,va,Ua,Kb,ia,E,fb,Za,ec,zc){return m(Ta,qb,za,void 0===zc?null:zc,Ia,va,Ua,Kb,void 0===ia?null:ia,
void 0===E?null:E,void 0===fb?null:fb,void 0===ec?null:ec,void 0===Za?null:Za)};Jl.Object.defineProperties(a.prototype,{Ofc:{configurable:!0,enumerable:!0,get:function(){return this.Ona.Ofc},set:function(Ta){this.Ona.Ofc=Ta}},wya:{configurable:!0,enumerable:!0,get:function(){return this.Sig}},ah:{configurable:!0,enumerable:!0,get:function(){return this.T8f}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.YK}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},
$hj:{configurable:!0,enumerable:!0,get:function(){return this.Vjg}}});a.aff=31E3;a.$od=8E3;a.aCj=15E3;Object(D.a)(a,"RealtimeChannel",null,[313,952])}}]);

//# sourceMappingURL=EwaDS.cl.js.map