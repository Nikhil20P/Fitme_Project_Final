(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1371:function(D,F,b){function a(vb){var kc=Ab.call(this)||this;kc.sn=null;kc.H_a=null;kc.$=vb;kc.fc();return kc}function d(vb){vb=void 0===vb?null:vb;this.Wma=null;this.MOd=this.VKe=!0;this.container=null;this.Lvf=0;this.Zxf=this.W7a=null;vb&&this.initialize(vb)}function c(vb,kc,td){this.cU=0;this.UCb=this.UYd=this.hJc=this.TCc=null;this.$=vb;this.o7d=kc;this.dDa=Object(sb.a)(313,this.sn.lh);this.QTh(td)}function m(vb,kc){this.X4=
null;this.$=kc;this.gridView=Ua.g(this.$);this.excelLiveManager=vb;this.excelLiveManager.cU=0;this.Zkj();this.A6i()}function r(vb,kc,td){this.$xf=this.W7a=this.viewBlockContainerHelpers=this.jLb=this.Nba=null;this.shd=this.$3a=!1;this.excelLiveManager=vb;this.H_a=td;this.$=kc;this.gridView=Ua.g(kc);this.initialize()}function t(vb,kc){this.Mxb=null;this.rhd=this.bhd=this.A5e=this.xU=this.p3a=this.fva=!1;this.excelLiveManager=vb;this.excelLiveManager.cU=1;this.$=kc;this.gridView=Ua.g(kc);this.Ntc()}
function k(vb){return db.call(this,vb)||this}function u(vb,kc){this.$=vb;this.excelLiveManager=kc}function w(){this.pb=null}function v(vb){this.njg=vb}function A(vb){this.beg=vb}function y(){}function x(){}function z(){}function J(){}function B(vb,kc,td,Oc){Oc=void 0===Oc?null:Oc;this.Ul=new ib.a;this.Xgg=vb;this.Mfg=kc;this.yb=td;this.Bfb=Oc}function C(){}function H(){}function W(){}function S(vb,kc){this.Oa=vb;this.nUa=kc}function N(){this.Fw=this.ym=!1}function T(vb,kc,td,Oc,tc,sc,ic,Ga,cb){var Tb=
this;this.ym=!1;this.BSb=this.MUa=this.vO=this.cfa=null;this.Tib=T.oyc;this.rb=new ha.a;this.Rpa=new fa(0);this.Rpa.TPc(Object(ea.a)(this,this.Kzi,"onStateMachineChanged"));this.Rig=vb;this.jSb=kc;this.Qig=td;this.pKc=Oc;this.re=tc;this.Npa=sc;ic.execute(function(Bb){Tb.ym||(Tb.MUa=Bb,Tb.MUa.nWa(Object(ea.a)(Tb,Tb.xba,"onUpdateNotificationReceived")),Tb.start())});Ga.execute(function(Bb){Tb.ym||(Tb.BSb=Bb,Bb.AVb(Object(ea.a)(Tb,Tb.Ftf,"onTokenRefreshed")))});this.Z$d=cb}function fa(vb){this.rb=new ha.a;
this.c$d=new Date;this.Beb=vb;this.iCc=0}function Y(vb,kc,td,Oc,tc){var sc=ba.call(this)||this;sc.Txd=vb;sc.newState=kc;sc.zIi=td;sc.AIi=Oc;sc.UFj=tc;return sc}function L(vb,kc){var td=X.call(this)||this;td.uFj=vb;td.qFj=kc;return td}b.r(F);D=b(514);F=b(0);var P=b(15),ea=b(37),X=Sys.EventArgs;Cm(L,X);Object(F.a)(L,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var ja;(function(vb){vb[vb.notYetStarted=0]="notYetStarted";vb[vb.polling=1]="polling";vb[vb.subscribed=2]="subscribed";vb[vb.blocked=3]=
"blocked";vb[vb.permanentlyStopped=4]="permanentlyStopped"})(ja||(ja={}));Object(F.b)("RtcHostNotificationSubscriptionState",ja);var R=b(112),ba=Sys.EventArgs;Cm(Y,ba);Object(F.a)(Y,"StateChangedEventArgs",Sys.EventArgs,[]);var ha=b(94);fa.prototype.event=function(vb,kc){this.currentState!==vb&&(this.$mh(this.currentState,vb,this.PDe,void 0===kc?null:kc),this.iCc=0,this.c$d=new Date);this.Beb=vb;this.iCc=this.PDe+1};fa.prototype.$mh=function(vb,kc,td,Oc){vb=new Y(vb,kc,td,this.c$d,Oc);this.rb.raiseEvent("c",
vb)};fa.prototype.TPc=function(vb){this.rb.addHandler("c",vb)};fa.prototype.hGf=function(vb){this.rb.removeHandler("c",vb)};Jl.Object.defineProperties(fa.prototype,{currentState:{configurable:!0,enumerable:!0,get:function(){return this.Beb}},PDe:{configurable:!0,enumerable:!0,get:function(){return this.iCc}}});Object(F.a)(fa,"StateMachine",null,[514]);T.prototype.start=function(){this.Nab?P.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",ja[this.Nab]):
(this.Rpa.event(1),this.rGd(null))};T.prototype.rGd=function(){this.cfa=null;if(this.l8e){P.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",ja[this.Nab]);var vb=null;this.pKc&&this.pKc.length&&(vb={},vb.etts=this.pKc);this.MUa.Hca(14,vb,!0);this.eLf(this.Rig)}else this.Rpa.event(3)};T.prototype.eLf=function(vb){this.cfa=R.a.Hve(1E3*vb,Object(ea.a)(this,this.rGd,"sendSubscribeEvent"),this.jSb,192,"RtcHostNotificationSubscribe");this.re.sh(this.cfa)};
T.prototype.X1i=function(vb){vb=1E3*(vb+this.Qig);var kc=this.Z$d().getTime()+vb;this.Tib=new Date(kc);vb-=this.jSb;this.vO?this.re.Cla(this.vO,vb):(this.vO=R.a.Hve(vb,Object(ea.a)(this,this.orj,"transitionToPollingEvent"),this.jSb/2,194,"RtcHostNotificationTransitionToPolling"),this.re.sh(this.vO))};T.prototype.orj=function(){this.vO=null;2===this.Nab&&(this.Rpa.event(1),P.ULS.shipAssertTag(573100185,502,!!this.cfa,"Missing task to ensure that we re-subscribe."))};T.prototype.Ftf=function(){this.KMh()};
T.prototype.KMh=function(){3===this.Nab&&this.l8e&&(this.Rpa.event(this.w4?2:1),this.rGd(null))};T.prototype.xba=function(vb,kc){if(13===kc.type&&(vb=kc.b7,kc={},P.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",(kc.SerializableHostNotificationSubscription=vb,kc.DurationBeforeExpirationToResubscribeInSec=this.jSb,kc)),kc=vb.cts,!this.atj(kc))){if(vb.sb){var td=2;this.X1i(vb.cts)}else td=1,this.Tib=T.oyc,this.vO&&(this.re.xp(this.vO),this.vO=null);this.Rpa.event(td);
this.cfa?this.re.Cla(this.cfa,1E3*kc):this.eLf(kc)}};T.prototype.atj=function(vb){if(!isNaN(vb)&&isFinite(vb)&&0<vb)return!1;this.hWf(!1);return!0};T.prototype.hWf=function(vb){this.cfa&&(this.re.xp(this.cfa),this.cfa=null);this.vO&&(this.re.xp(this.vO),this.vO=null);this.MUa&&(this.MUa.KEb(Object(ea.a)(this,this.xba,"onUpdateNotificationReceived")),this.MUa=null);this.BSb&&(this.BSb.lCd(Object(ea.a)(this,this.Ftf,"onTokenRefreshed")),this.BSb=null);vb||this.Rpa.event(4)};T.prototype.Kzi=function(vb,
kc){vb=kc.newState;var td=kc.Txd,Oc={};Oc.NewState=ja[vb];Oc.PreviousState=ja[td];Oc.PreviousStateHits=kc.zIi;Oc.PreviousStateTransitionTime=kc.AIi.toISOString();Oc.IsSubscribed=this.w4;this.Tib!==T.oyc&&(Oc.SubscriptionExpiringTime=this.Tib.toISOString());P.ULS.sendTraceTag(572346515,502,4===vb?15:50,"HostNotificationChanged: {0}",Oc);this.rb.raiseEvent("HN",new L(td,vb))};T.prototype.dispose=function(){this.ym||(this.ym=!0,this.hWf(!0),this.vO&&(this.re.xp(this.vO),this.vO=null))};Jl.Object.defineProperties(T.prototype,
{Nab:{configurable:!0,enumerable:!0,get:function(){return this.Rpa.currentState}},l8e:{configurable:!0,enumerable:!0,get:function(){return!this.Npa||this.Npa.s9e}},w4:{configurable:!0,enumerable:!0,get:function(){return 2===this.Nab&&this.Z$d()<this.Tib}}});T.oyc=new Date(0);Object(F.a)(T,"RtcHostNotificationSubscriptionManager",null,[485,7]);var oa=b(5),Sa=b(274),ma=b(677),na=b(88);N.prototype.$h=function(vb){var kc=this;vb.register(T,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").Ac().Lc(function(){var td=
oa.AFrameworkApplication.ha;return new T(td.qd("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),td.qd("RtcHostNotificationRetryIntervalBufferInSeconds",120),td.qd("RtcHostNotificationSubscriptionLostBufferInSeconds",60),kc.aHh(td),oa.AFrameworkApplication.$j,ma.SessionStatusManager.instance,vb.yc("Common.IRealtimeChannelBasic"),vb.yc("Common.ISessionExpirationManager"),function(){return new Date})})};N.prototype.init=function(){var vb=this;oa.AFrameworkApplication.ha.Xv(function(){!vb.ym&&
oa.AFrameworkApplication.ha.ta("RtcHostNotificationEnabled")&&(vb.Fw=!0,na.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};N.prototype.dispose=function(){this.ym||(this.ym=!0,this.Fw&&na.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};N.prototype.aHh=function(vb){return vb.xy("RtcEventTypesToSubscribe")?vb.zx("RtcEventTypesToSubscribe"):null};N.main=function(){Sa.a.instance.oj(new N)};
Jl.Object.defineProperties(N.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(F.a)(N,"RtcHostNotificationSubscriptionPackage",null,[8,9]);var xa=b(111),Oa=b(29);S.prototype.Rg=function(){this.Oa.$b(Oa.a.abf,xa.a.frame,Object(ea.a)(this,this.bbf,"livePersonaCardActionHandler"))};S.prototype.hKb=function(){this.Oa.TC(Oa.a.abf,xa.a.frame,Object(ea.a)(this,this.bbf,"livePersonaCardActionHandler"))};S.prototype.bbf=function(vb,kc,td,Oc,tc){if(!tc||
3===td)return 2;if(1===td)return this.JVa(this.nUa.Jne(tc.upn||tc.aadObjectId));if(!this.n9g(tc))return 8;switch(tc.action){case 0:return this.JVa(this.nUa.Wng(tc));case 1:return this.JVa(this.nUa.Vng(tc));case 2:return this.JVa(this.nUa.Xng(tc));case 3:return this.JVa(this.nUa.openCard(tc));case 4:return this.JVa(this.nUa.HRi(tc));default:return 2}};S.prototype.n9g=function(vb){var kc=vb.upn||vb.aadObjectId;return vb.targetElement&&(4===vb.action||kc&&""!==kc)?!0:!1};S.prototype.JVa=function(vb){return vb?
32:8};Object(F.a)(S,"LivePersonaCardActor",null,[]);var ib=b(139),sb=b(82);Object(F.a)(W,"BootstrapperConfig",null,[]);Object(F.a)(H,"LivePersonaCardInitializerResult",null,[]);C.xle=null;Object(F.a)(C,"LivePersonaCardModule",null,[]);var nb=b(576);B.prototype.init=function(){this.a6e()?this.Xgg.Rai().continueWith(Object(ea.a)(this,this.Mwi,"onPackageLoaded")):this.Ul.setResult(Object.assign(new H,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));return this.Ul.task};
B.prototype.Mwi=function(){var vb=this,kc=C.xle;if(kc){var td=this.vuh();try{kc.initializeLivePersonaCardAsync(td).then(function(){vb.Ul.setResult(Object.assign(new H,{isInitialized:!0,isEnabled:!0}))}).catch(function(Oc){var tc=Object(sb.a)(String,Oc);tc?vb.Ul.setException(Error.create(tc)):vb.Ul.setException(Error.create(JSON.stringify(Oc)))})}catch(Oc){this.Ul.setException(Oc)}}else this.Ul.setResult(Object.assign(new H,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};
B.prototype.vuh=function(){var vb=nb.a.pJ(oa.AFrameworkApplication.lcid);return Object.assign(new W,{culture:vb?vb.name.toLocaleLowerCase():"en-us",clientType:this.yb.Wa("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:oa.AFrameworkApplication.userSessionId,complianceEnvironment:this.owh(),logMessage:Object(ea.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(ea.a)(this,this.getAuthToken,"getAuthToken")})};B.prototype.a6e=function(){if(!this.yb.ta("LivePersonaCardIsEnabled")||
!this.Rwg())return!1;var vb=this.yb.Wa("SovereignEnvironmentName");return vb&&""!==vb?vb.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||vb.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};B.prototype.Rwg=function(){return this.yb.ta("CoauthorGalleryLivePersonaCardIsEnabled")||!!oa.AFrameworkApplication.za&&oa.AFrameworkApplication.za.Za.OPa};B.prototype.owh=function(){return this.yb.Wa("LivePersonaCardComplianceEnvironment")};B.prototype.logMessage=function(vb,kc,td){var Oc={};
vb=JSON.stringify((Oc["Log Type"]=vb,Oc["Log Result Type"]=kc,Oc.Message=td,Oc));P.ULS.sendTraceTag(50431106,3006,50,vb)};B.prototype.getAuthToken=function(vb,kc){var td=this;oa.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.Bfb.continueWith(function(Oc){Oc.Dh||Oc.ng?kc("LokiTokenManagerTask is either canceled or faulted.",oa.AFrameworkApplication.userSessionId):td.Bfb.result.j$c().then(function(tc){tc.isSuccess&&tc.token&&tc.token.length?
vb(tc.token,oa.AFrameworkApplication.userSessionId):kc(tc.errorMessage,oa.AFrameworkApplication.userSessionId)}).catch(function(tc){return P.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(tc))})}):this.Mfg.j$c().then(function(Oc){Oc.isSuccess&&Oc.token&&Oc.token.length?vb(Oc.token,oa.AFrameworkApplication.userSessionId):kc(Oc.errorMessage,oa.AFrameworkApplication.userSessionId)}).catch(function(Oc){return P.ULS.sendTraceTag(50431107,3006,10,
"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Oc))})};Object(F.a)(B,"LivePersonaCardInitializer",null,[]);Object(F.a)(J,"Behavior",null,[]);Object(F.a)(z,"Identifiers",null,[]);Object(F.a)(x,"LivePersonaCardParameters",null,[]);Object(F.a)(y,"PersonaInfo",null,[]);A.prototype.Jne=function(vb){return this.beg.a6e()&&vb&&""!==vb?!!window.self.LPC:!1};A.prototype.Wng=function(vb){return this.$Jb("addedPersonaToPageV2",vb,0)};A.prototype.Vng=function(vb){return this.$Jb("addedPersonaToPageV2",
vb,1)};A.prototype.Xng=function(vb){return this.$Jb("addedPersonaToPageV2",vb,2)};A.prototype.openCard=function(vb){return this.$Jb("openCard",vb)};A.prototype.HRi=function(vb){return this.$Jb("removedPersonaFromPage",vb)};A.prototype.xHg=function(vb){return!!vb.targetElement&&(this.Jne(vb.upn||vb.aadObjectId)||4===vb.action)};A.prototype.$Jb=function(vb,kc,td){td=void 0===td?3:td;if(!this.xHg(kc))return!1;td=4!==kc.action?this.bVg(kc,td):null;var Oc=window.self.LPC;if(Oc&&Oc[vb]){if(td)Oc[vb](kc.targetElement,
td);else Oc[vb](kc.targetElement);return!0}return!1};A.prototype.bVg=function(vb,kc){kc=void 0===kc?3:kc;var td=Object.assign(new z,{PersonaType:"User",Upn:vb.upn,AadObjectId:vb.aadObjectId});return Object.assign(new x,{personaInfo:Object.assign(new y,{identifiers:td,displayName:vb.name,personaCoinColor:vb.color}),behavior:Object.assign(new J,{onCardOpen:function(){P.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(vb.onCardOpen)vb.onCardOpen()},onCardClose:vb.onCardClose,disableClick:2===
kc||3===kc,disableHover:!kc||3===kc})})};Object(F.a)(A,"LivePersonaCardManager",null,[]);v.prototype.Rai=function(){var vb=oa.AFrameworkApplication.l6("midgardbootstrapper.js",5);return this.njg.cnd(vb).continueWith(function(){C.xle=window.self.MidgardBootstrapper})};Object(F.a)(v,"LivePersonaCardPackageLoader",null,[484]);var Gb=b(525);w.prototype.init=function(){oa.AFrameworkApplication.ha&&oa.AFrameworkApplication.ha.Xv(Object(ea.a)(this,this.HA,"onFullAppSettingsReady"))};w.prototype.dispose=
function(){};w.prototype.$h=function(vb){this.pb=vb};w.prototype.HA=function(){var vb=oa.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new B(new v(this.pb.resolve("Common.ISharedDependencyLoader")),null,oa.AFrameworkApplication.ha,Gb.a.uq(this.pb.yc("Common.ILokiTokenManager"))):new B(new v(this.pb.resolve("Common.ISharedDependencyLoader")),this.pb.resolve("Common.ILokiTokenManager"),oa.AFrameworkApplication.ha);vb.init().continueWith(function(kc){kc.ng&&
kc.Kg?P.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",kc.Kg.message):((kc=kc.result)||P.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),kc.isInitialized?P.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):P.ULS.sendTraceTag(595067867,3006,kc.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",kc.failureMessage))});(new S(oa.AFrameworkApplication.Hb,new A(vb))).Rg()};
w.main=function(){Sa.a.instance.oj(new w)};Jl.Object.defineProperties(w.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(F.a)(w,"LivePersonaCardPackage",null,[8,9]);var Ha=b(12),ca=b(800),Ra=b(35),ua=b(410),ta=b(172);u.prototype.$c=function(){return!1};u.prototype.Jc=function(vb,kc){switch(kc.command){case 1491932557:return ua.a(this.$)&&2===this.excelLiveManager.cU;case -440259636:return ua.f(this.$)&&2===this.excelLiveManager.cU;default:return!1}};
u.prototype.executeCommand=function(vb,kc){vb=Ra.TaskExtensions.um();var td=kc.command;switch(kc.command){case -440259636:this.excelLiveManager.Bbd();break;case 1491932557:this.excelLiveManager.Ntc();break;default:vb=ta.a(td)}return vb};u.prototype.gd=function(){return!1};Object(F.a)(u,"ExcelLiveCommandHandler",null,[159]);var db=ca.a;Cm(k,db);k.prototype.Rd=function(){var vb=this;this.$.ea.ub(473,function(kc){vb.Hd([new u(vb.$,kc)])})};k.la=function(vb){ca.a.ie(469,new k(vb))};Object(F.a)(k,"ExcelLiveCommandHandlerFactory",
ca.a,[]);var Ta=b(211),qb=b(10),za=b(45),Ia=b(25),va=b(46),Ua=b(20),Kb=b(223),ia=b(34);t.prototype.dispose=function(){this.Jye();this.epb();this.gridView=this.$=this.excelLiveManager=null};t.prototype.Ntc=function(){this.pzg();this.l5c();this.zRc()};t.prototype.l5c=function(){if(this.excelLiveManager.lh.K6b()){var vb=this.excelLiveManager.lh.K6b();this.Hvf(vb)}};t.prototype.Hvf=function(vb){for(var kc in vb){var td=vb[kc];if(td.NavigationState&&td.MeetingInfo&&(td.MeetingInfo.IsPresenter||ua.d())&&
(td.MeetingInfo.MeetingId===this.$.Ba.MeetingId||ua.c())){this.lnj(td.NavigationState);break}}};t.prototype.lnj=function(vb){vb!==this.Mxb&&(this.p3a=!0,this.Wsj(vb.SheetID)&&(this.j7i(vb.ZoomLevel),this.onj(vb),(this.A5e=this.FOg(va.D(vb.VisibleAreaRange)))||this.pnj(vb),this.Mxb=vb,this.p3a=!1))};t.prototype.Wsj=function(vb){vb=this.$.Aa.getItemByName(vb);if(!vb)return this.rhd=!0,!1;if(vb!==this.$.sa){if(!vb.visible)return!1;vb.activate()}return!0};t.prototype.j7i=function(vb){if(this.Mxb){vb=
(vb-this.Mxb.ZoomLevel)/this.Mxb.ZoomLevel*100;var kc=ia.a(this.$).zoom;vb=kc+kc*vb/100;ia.a(this.$).A6f(vb)}};t.prototype.onj=function(vb){var kc=va.D(vb.VisibleAreaRange);kc=Ia.Range.xd(kc.top,kc.left);vb=new za.a(vb.TopLeftCellOffsets.X,vb.TopLeftCellOffsets.Y);vb=Kb.a(kc,vb,this.gridView.hs,this.gridView.$a,0,0,this.$,this.gridView.G3());this.gridView.aWb(vb,kc,60,kc,"ExcelLiveFollowerOrExplorerApp.SyncViewportToMatchOrigin")};t.prototype.pnj=function(vb){this.gridView.Dt(va.D(vb.SelectedRanges[vb.IndexOfActiveRange]),
64,"ExcelLiveFollowerOrExplorerApp.SyncFollowerViewportWithPresenter",!0)};t.prototype.FOg=function(vb){return this.gridView.Bja(vb)};t.prototype.pzg=function(){this.excelLiveManager.lh.kEa(Object(ea.a)(this,this.UAb,"onMeetingPresenceUpdated"));this.$.fa.BD(Object(ea.a)(this,this.MA,"onStateIdChanged"));this.$.fa.jWa(Object(ea.a)(this,this.tH,"onGridConsistent"))};t.prototype.Jye=function(){this.excelLiveManager.lh&&this.excelLiveManager.lh.jya(Object(ea.a)(this,this.UAb,"onMeetingPresenceUpdated"));
this.$&&(this.$.fa.VC(Object(ea.a)(this,this.MA,"onStateIdChanged")),this.$.fa.a9a(Object(ea.a)(this,this.tH,"onGridConsistent")))};t.prototype.UAb=function(vb,kc){kc.bI&&this.Hvf(kc.bI)};t.prototype.MA=function(){this.$.fa.zf!==qb.a.Ve&&this.$.fa.pc&&(this.rhd&&this.$.fa.ot(Object(ea.a)(this,this.hg,"onWorkbookMetadataChanged")),this.xU=!0)};t.prototype.hg=function(){this.xU&&this.p3a&&(this.$.fa.ow(Object(ea.a)(this,this.hg,"onWorkbookMetadataChanged")),this.l5c(),this.rhd=this.xU=!1)};t.prototype.tH=
function(){this.xU&&!this.p3a&&(this.l5c(),this.xU=!1)};t.prototype.zRc=function(){this.gridView.Kkb(Object(ea.a)(this,this.xtb,"handleViewportChanged"));this.gridView.Hc.Cm(Object(ea.a)(this,this.tk,"onEditStarted"));this.gridView.mkb(Object(ea.a)(this,this.j5,"onBeforeActiveItemCleanup"));this.$.Aa.Vf(Object(ea.a)(this,this.ktb,"handleActiveItemChanged"));this.$.$Oc(Object(ea.a)(this,this.Yjf,"onBeforeContentAreaResized"));this.$.fa.mfe(Object(ea.a)(this,this.Yof,"onLocalUserEditHappened"));this.excelCommentManager&&
this.excelCommentManager.rtg(Object(ea.a)(this,this.ptf,"onTextInput"))};t.prototype.epb=function(){this.gridView&&(this.gridView.LEb(Object(ea.a)(this,this.xtb,"handleViewportChanged")),this.gridView.Hc.mm(Object(ea.a)(this,this.tk,"onEditStarted")),this.gridView.qEb(Object(ea.a)(this,this.j5,"onBeforeActiveItemCleanup")));this.$&&(this.$.Aa.wg(Object(ea.a)(this,this.ktb,"handleActiveItemChanged")),this.$.PBd(Object(ea.a)(this,this.Yjf,"onBeforeContentAreaResized")),this.$.fa.rUi(Object(ea.a)(this,
this.Yof,"onLocalUserEditHappened")));this.excelCommentManager&&this.excelCommentManager.GUi(Object(ea.a)(this,this.ptf,"onTextInput"))};t.prototype.xtb=function(){this.fva||this.p3a||this.bhd||(this.Uwa(),this.bhd=!1)};t.prototype.tk=function(){this.Uwa()};t.prototype.ktb=function(){this.fva=!1;this.p3a||this.Uwa()};t.prototype.j5=function(){this.fva=!0};t.prototype.Yjf=function(){this.bhd=!0};t.prototype.Yof=function(){this.Uwa()};t.prototype.ptf=function(){this.Uwa()};t.prototype.Uwa=function(){this.excelLiveManager.cU=
2;this.Jye();this.epb()};Jl.Object.defineProperties(t.prototype,{excelCommentManager:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.Ea(65,void 0)}}});Object(F.a)(t,"ExcelLiveFollowerOrExplorer",null,[]);var E=b(30),fb=b(58),Za=b(44),ec=b(103);r.prototype.dispose=function(){this.epb();this.D1g();this.gridView=this.$=this.viewBlockContainerHelpers=this.jLb=this.excelLiveManager=null};r.prototype.Bbd=function(){P.ULS.sendTraceTag(537490975,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");
this.shd?P.ULS.sendTraceTag(537490974,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection."):(this.$3a||this.NLh(),this.xVf())};r.prototype.initialize=function(){ua.e(this.$)?this.RTh():(this.Ezg(),this.$0e())};r.prototype.RTh=function(){this.excelLiveManager.cU=0};r.prototype.$0e=function(vb){if(vb=this.Ckh(void 0===vb?null:vb))P.ULS.sendTraceTag(537490973,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: {0}",
this.excelLiveManager.UCb),this.Nba=vb,this.ODe(),this.$3a&&2!==this.excelLiveManager.cU?this.xVf():this.vVf()};r.prototype.xVf=function(){1!==this.excelLiveManager.cU&&(P.ULS.sendTraceTag(537490972,0,50,"ExcelLiveParticipantV0::RoleTransition: Transition participant role from [{0}] to [{1}]",2,1),this.excelLiveManager.cU=1,this.zRc(),this.H_a.NEb(this.excelLiveManager.cU,this.W7a,this.$xf))};r.prototype.vVf=function(){2!==this.excelLiveManager.cU&&(P.ULS.sendTraceTag(537490971,0,50,"ExcelLiveParticipantV0::RoleTransition: Transition participant role from [{0}] to [{1}]",
1,2),this.excelLiveManager.cU=2,this.epb(),this.H_a.NEb(this.excelLiveManager.cU,this.W7a))};r.prototype.Ezg=function(){this.excelLiveManager.lh.kEa(Object(ea.a)(this,this.UAb,"onMeetingPresenceUpdated"))};r.prototype.D1g=function(){this.excelLiveManager.lh.jya(Object(ea.a)(this,this.UAb,"onMeetingPresenceUpdated"))};r.prototype.zRc=function(){this.gridView.Kkb(Object(ea.a)(this,this.xtb,"handleViewportChanged"));this.$.Aa.Vf(Object(ea.a)(this,this.ktb,"handleActiveItemChanged"))};r.prototype.epb=
function(){this.gridView.LEb(Object(ea.a)(this,this.xtb,"handleViewportChanged"));this.$.Aa.wg(Object(ea.a)(this,this.ktb,"handleActiveItemChanged"))};r.prototype.UAb=function(vb,kc){kc.bI&&this.$0e(kc.bI)};r.prototype.xtb=function(){var vb=this;if(!this.jLb||this.jLb&&!this.jLb.Po)this.jLb=Za.a.instance.create(function(){vb.Uwa()},500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};r.prototype.ktb=function(){this.Uwa()};r.prototype.Uwa=function(){this.ODe();this.$3a||this.vVf()};r.prototype.Ckh=
function(vb){vb=(void 0===vb?null:vb)||this.excelLiveManager.lh.K6b();if(!vb)return null;this.excelLiveManager.UCb||this.ySh(vb);return this.excelLiveManager.UCb&&(vb=vb[this.excelLiveManager.UCb])?vb.SelectedRange:null};r.prototype.ySh=function(vb){for(var kc in vb){var td=kc,Oc=vb[kc];if(Oc&&Oc.MeetingInfo&&Oc.MeetingInfo.IsPresenter&&Oc.MeetingInfo.MeetingId===this.$.Ba.MeetingId){this.c1i(td);break}}};r.prototype.c1i=function(vb){if(vb){var kc=this.$.fa.fbd(vb);kc&&(P.ULS.sendTraceTag(537490970,
0,50,"ExcelLiveParticipantV0::SavePresenterDetails: Setting presenter information to CID: {0}",vb),this.excelLiveManager.UCb=vb,this.W7a=kc.User.UserName,this.$xf=kc.UserColor)}};r.prototype.ODe=function(){if(this.Nba){var vb=this.Nba.length;P.ULS.sendTraceTag(537490969,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Called with {0} presenter ranges to evaluate.",vb);for(var kc=0;kc<vb;kc++){var td=this.Nba[kc].NamedObjectName;if(E.a.Dpe(td)){if(P.ULS.sendTraceTag(537490966,
0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),this.shd=!1,this.Nba[kc].SheetName===this.$.Aa.sa.sheetName&&this.gridView.vZ(va.D(this.Nba[kc]))){P.ULS.sendTraceTag(537490965,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.$3a=!0;return}}else if(P.ULS.sendTraceTag(537490968,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),
this.shd=!0,this.Nba[kc].SheetName===this.$.Aa.sa.sheetName&&this.B1h(td)){P.ULS.sendTraceTag(537490967,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.$3a=!0;return}}P.ULS.sendTraceTag(537490964,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.$3a=!1};r.prototype.B1h=function(vb){var kc=this;vb=ec.a(this.$).Cp(vb);
if(!vb||!vb.floatingObject||!vb.domElement)return!1;this.viewBlockContainerHelpers||Ra.TaskExtensions.Da(fb.GetServiceTaskFactory.Xa(this.$.ea,103,104,0,"Microsoft.Office.Excel.WebUI.Client.IViewBlockContainerHelpers"),function(Oc){kc.viewBlockContainerHelpers=Oc.result},this.$.ma,8);var td=this.viewBlockContainerHelpers.TY(vb.Ig,vb.domElement);return vb.Ig.pn.oe(td)?!0:!1};r.prototype.NLh=function(){P.ULS.sendTraceTag(537490963,0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");
var vb=this.Nba&&0<this.Nba.length?this.Nba[0]:null;if(vb){var kc=vb.SheetName;kc&&(this.$.Aa.getItemByName(kc).activate(),vb=va.D(vb),Ua.g(this.$).Dt(vb,3,"ExcelLiveParticipantV0.GoToPresenterLocation"))}};Object(F.a)(r,"ExcelLiveParticipantV0",null,[]);m.prototype.dispose=function(){this.F1g();this.gridView=this.$=this.excelLiveManager=null};m.prototype.Zkj=function(){this.pxf();this.Qzg()};m.prototype.Qzg=function(){this.gridView.Kkb(Object(ea.a)(this,this.N9b,"handleViewportOrSelectionChanged"));
this.gridView.ga.ZF(Object(ea.a)(this,this.N9b,"handleViewportOrSelectionChanged"))};m.prototype.F1g=function(){this.gridView.LEb(Object(ea.a)(this,this.N9b,"handleViewportOrSelectionChanged"));this.gridView.ga.pK(Object(ea.a)(this,this.N9b,"handleViewportOrSelectionChanged"))};m.prototype.N9b=function(){this.$.Aa&&this.$.Aa.Q2e||this.pxf()};m.prototype.gxh=function(){var vb=this.gridView.Dia().GA;var kc={};kc.SheetID=this.$.sa?this.$.sa.sheetName:null;kc.ZoomLevel=ia.a(this.$).zoom;kc.SelectedRanges=
va.k(this.gridView.ga.ya.selectedRanges,this.$);kc.IndexOfActiveRange=this.gridView.ga.ya.pA;kc.VisibleAreaRange=va.v(this.gridView.mwh(),this.$);kc.TopLeftCellOffsets={};kc.TopLeftCellOffsets.X=vb.x;kc.TopLeftCellOffsets.Y=vb.y;return kc};m.prototype.A6i=function(){this.X4={};this.X4.MeetingId=this.$.Ba.MeetingId;this.X4.IsPresenter=!0};m.prototype.pxf=function(){var vb={};vb.MeetingInfo=this.X4;vb.NavigationState=this.gxh();this.excelLiveManager.lh.yMf(vb)};Object(F.a)(m,"ExcelLivePresenter",null,
[]);var zc=b(1);c.prototype.dispose=function(){this.$=null;this.presenter&&(this.presenter.dispose(),this.hJc=null);this.Z5b&&(this.Z5b.dispose(),this.TCc=null);this.dDa=this.o7d=null};c.prototype.Ntc=function(){this.Z5b?this.Z5b.Ntc():P.ULS.sendTraceTag(537519812,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};c.prototype.Bbd=function(){this.hIe?this.hIe.Bbd():P.ULS.sendTraceTag(537499283,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};
c.prototype.QTh=function(vb){zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveFollowMeV1",!1)?ua.e(this.$)?this.hJc=new m(this,this.$):this.TCc=new t(this,this.$):ua.f(this.$)&&(this.UYd=new r(this,this.$,vb))};Jl.Object.defineProperties(c.prototype,{sn:{configurable:!0,enumerable:!0,get:function(){return this.o7d}},lh:{configurable:!0,enumerable:!0,get:function(){return this.dDa}},Z5b:{configurable:!0,enumerable:!0,get:function(){return this.TCc}},presenter:{configurable:!0,
enumerable:!0,get:function(){return this.hJc}},hIe:{configurable:!0,enumerable:!0,get:function(){return this.UYd}}});Object(F.a)(c,"ExcelLiveManager",null,[491,7]);d.prototype.NEb=function(vb,kc,td){this.Lvf=vb;this.W7a=void 0===kc?null:kc;this.Zxf=void 0===td?null:td;this.VKe?(this.VKe=!1,this.tGf()):(this.MOd=!1,Sys.UI.DomElement.addCssClass(this.container,"ewa-excelLive-meetingPill-container-hidden"))};d.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.Wma);$removeHandler(this.container,
"transitioncancel",this.Wma);this.container=null};d.prototype.initialize=function(vb){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";Sys.UI.DomElement.addCssClass(this.container,"ewa-excelLive-meetingPill-container");vb.insertBefore(this.container,vb.lastChild);this.Wma=Object(ea.a)(this,this.ePh,"handleTransitionEnded");$addHandler(this.container,"transitionend",this.Wma);$addHandler(this.container,"transitioncancel",this.Wma)};d.prototype.ePh=function(){this.MOd||
(this.tGf(),this.MOd=!0,Sys.UI.DomElement.removeCssClass(this.container,"ewa-excelLive-meetingPill-container-hidden"))};d.prototype.tGf=function(){var vb={};vb.participantRole=this.Lvf;vb.presenterName=this.W7a;vb.presenterColor=this.Zxf;appChrome.renderLiveMeetingPill(this.container,vb)};Object(F.a)(d,"ExcelLiveMeetingPillUtility",null,[]);var Ab=Ta.a;Cm(a,Ab);a.prototype.create=function(){this.PTh()};a.prototype.dispose=function(){this.sn&&this.sn.GEb(Object(ea.a)(this,this.KMa,"onRealTimeChannelInitialized"));
this.sn=null;Ab.prototype.dispose.call(this)};a.prototype.PTh=function(){var vb=this;ua.f(this.$)&&this.NEb();this.$.ea.ub(26,function(kc){vb.sn=kc;vb.iPg()})};a.prototype.iPg=function(){P.ULS.sendTraceTag(537519811,0,50,"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.sn.IPc(Object(ea.a)(this,this.KMa,"onRealTimeChannelInitialized"));this.sn.hYa()};a.prototype.KMa=function(){this.sn.GEb(Object(ea.a)(this,this.KMa,"onRealTimeChannelInitialized"));
P.ULS.sendTraceTag(537519810,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");this.Jb(this.$.ea.Ea(473,void 0)||new c(this.$,this.sn,this.H_a))};a.prototype.NEb=function(){this.H_a=new d(this.$.Xz);var vb=ua.e(this.$)?0:1;this.H_a.NEb(vb)};a.la=function(vb){P.ULS.sendTraceTag(537490977,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");vb.ea.La(474,new a(vb));P.ULS.sendTraceTag(537490976,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};Object(F.a)(a,"ExcelLiveManagerFactory",
Ta.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");Type.registerNamespace("_Ewa");D.a.Xi(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}");Type.registerNamespace("Common.App.RtcHostNotificationSubscription");N.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");
Type.registerNamespace("Common.App.LivePersonaCard");w.main();Type.registerNamespace("AppRealtimeChannel");(function(){Ha.a.Ja(function(vb){a.la(vb);k.la(vb)})})()}}]);

//# sourceMappingURL=EwaDS.rt.js.map