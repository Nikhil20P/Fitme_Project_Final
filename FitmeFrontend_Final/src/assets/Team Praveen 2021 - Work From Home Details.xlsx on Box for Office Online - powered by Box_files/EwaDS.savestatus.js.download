(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1381:function(D,F,b){function a(Y){var L=fa.call(this)||this;L.Qc=Y;L.fc();return L}function d(Y,L){this.x8d=this.NEc=!1;this.DKf=L;this.$=Y;this.$.userOperationManager.CB(Object(k.a)(this,this.Hqf,"onQueueItemChange"));this.$.Nk(Object(k.a)(this,this.sd,"onWorkbookOpened"));this.$.fa.jug(Object(k.a)(this,this.Grf,"onSaveStatusChange"));this.$.fa.ak(Object(k.a)(this,this.ed,"onSessionIdChanged"));this.$.DPc(Object(k.a)(this,
this.KBb,"onUserAlertActivityBeforeShow"));this.$.fa.DO(Object(k.a)(this,this.rq,"onLoadOnDemandOccurred"));this.wda()}function c(){this.AKc=this.EJc=this.tib=this.pb=null}function m(Y,L,P,ea){this.dfa=this.Wea=this.hfa=this.gfa=null;this.BCa=0;this.uD=this.zKc=this.RAa=this.jzc=this.zDa=null;this.Zd=Y;this.T7=L;this.N0=P;this.fj=ea;this.T0d=!0;this.fL=!1;this.yz=3;this.Hpa=!0}function r(Y,L){this.Ir=null;this.gfa=CommonUIStrings.l_SavedStatus;this.hfa=CommonUIStrings.l_SavingStatus;this.Wea=CommonUIStrings.l_ReadOnlyStatus;
this.dfa=CommonUIStrings.l_ReviewModeStatus;this.gPb=L;this.N0=Y;this.yz=3;this.Hpa=!0}function t(Y){this.dfa=this.Wea=this.hfa=this.gfa=null;this.p2d=this.Fw=this.fL=!1;this.NJc=this.F2d=null;this.w2d=0;this.yb=this.C2d=null;this.N0=Y;this.yz=3;this.bgb=!0}b.r(F);D=b(0);var k=b(37),u=b(15),w=b(242),v=b(49);t.prototype.initialize=function(Y,L,P){var ea=this;this.gfa=this.jad(Y,L);this.hfa=CommonUIStrings.l_SavingStatus;this.Wea=CommonUIStrings.l_ReadOnlyStatus;this.dfa=CommonUIStrings.l_ReviewModeStatus;
this.N0&&this.N0.execute(function(X){X.yPc(Object(k.a)(ea,ea.JKb,"updateToSavingStatus"))});this.Fw=!0;this.yb=P;return!0};t.prototype.wda=function(Y,L){this.fL=Y;this.yz=L;this.xR(this.bgb)};t.prototype.xR=function(Y){!this.bgb&&Y&&(this.C2d=new Date);this.bgb=Y;Y=null;3===this.yz&&(Y=this.bgb?this.gfa:this.hfa);this.z3g(Y)};t.prototype.jad=function(Y,L){return Y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):L&&L.length?String.format(CommonUIStrings.l_SavedToStatus,
L):CommonUIStrings.l_SavedStatus};t.prototype.JKb=function(){this.xR(!1)};t.prototype.WCh=function(){switch(this.yz){case 1:return this.Wea;case 2:return this.dfa;default:return null}};t.prototype.A0h=function(Y){return this.p2d===this.fL&&this.w2d===this.yz&&this.F2d===Y};t.prototype.Lze=function(Y){var L=this;appChrome.getHeaderApi().then(function(P){P.updateDocumentTitleStatus(L.fL,Y,L.WCh(),L.C2d,L.bgb);return null});this.NJc=null};t.prototype.z3g=function(Y){var L=this;this.Fw&&w.appChromeAlreadyLoaded()&&
!this.A0h(Y)&&(v.a.NHf()?(this.NJc&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.NJc=window.requestIdleCallback(function(){L.Lze(Y)})):window.requestAnimationFrame(function(){L.Lze(Y)}),this.p2d=this.fL,this.F2d=Y,this.w2d=this.yz)};Object(D.a)(t,"ReactSaveStatusUIHandler",null,[257]);var A=b(177);r.prototype.Vx=function(){var Y=this;this.N0&&this.N0.execute(function(L){L.yPc(Object(k.a)(Y,Y.JKb,"updateToSavingStatus"))});this.gPb.execute(function(L){Y.Ir=
L})};r.prototype.wda=function(Y,L){this.yz=L;3===L?this.xR(this.Hpa):2===L?this.uPd(this.dfa):this.uPd(this.Wea)};r.prototype.JKb=function(){this.xR(!1)};r.prototype.xR=function(Y){this.Hpa=Y;this.uPd(this.Hpa?this.gfa:this.hfa)};r.prototype.uPd=function(Y){this.Ir&&this.Ir.Yj(A.a.Atj,this.yPg(Y))};r.prototype.yPg=function(Y){var L={};L.StatusText=Y;return L};Object(D.a)(r,"SaveStatusPostMessageHandler",null,[257]);var y=b(814),x=b(163),z=b(85);m.prototype.initialize=function(Y,L){if(!this.Zd)return!1;
this.gfa=this.jad(Y,L);this.hfa=CommonUIStrings.l_SavingStatus;this.Wea=CommonUIStrings.l_ReadOnlyStatus;this.dfa=CommonUIStrings.l_ReviewModeStatus;this.Vx();return!0};m.prototype.jad=function(Y,L){return Y?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):L&&L.length?String.format(CommonUIStrings.l_SavedToStatus,L):CommonUIStrings.l_SavedStatus};m.prototype.Vx=function(){var Y=this;this.T7&&this.T7.execute(function(L){L.Ktg(Object(k.a)(Y,Y.lwe,"createStatusAndModeElements"));
L.Btg(Object(k.a)(Y,Y.hgj,"showHideSaveStatusElement"));L.Vqj&&Y.lwe(null,null)});this.N0&&this.N0.execute(function(L){L.yPc(Object(k.a)(Y,Y.JKb,"updateToSavingStatus"))})};m.prototype.lv=function(){this.uD&&this.Zd&&this.Zd.vF(this.uD)};m.prototype.hgj=function(Y,L){this.wda("true"===L,this.yz)};m.prototype.wda=function(Y,L){this.fL=Y;this.yz=L;this.jzc&&(this.jzc.style.display=this.fL||3===this.yz||!this.zDa?"none":"");this.RAa&&(this.RAa.style.display=this.fL||3===this.yz?"none":"",this.RAa.innerText=
1===this.yz?this.Wea:this.dfa,this.RAa.title=1===this.yz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.zKc&&(this.zKc.style.display=this.fL||1===this.yz||!this.zDa&&!this.RAa?"none":"");this.uD&&(this.uD.style.display=this.fL||1===this.yz?"none":"",this.xR(this.Hpa),this.uD.title=CommonUIStrings.l_SaveStatusTooltip)};m.prototype.lwe=function(Y,L){Y=document.getElementById(y.CuiHelper.AZe);L&&L.ACj||!Y||""===this.gfa||""===this.hfa||""===this.Wea||""===this.dfa||
(this.zDa=document.getElementById(y.CuiHelper.NXb),this.jzc=y.CuiHelper.Lra(Y,"BreadcrumbAppModeDash","-",null,!1),this.RAa=y.CuiHelper.Lra(Y,"BreadcrumbAppModeStatus",1===this.yz?this.Wea:this.dfa,null,!1),this.t2f(this.RAa),this.zKc=y.CuiHelper.Lra(Y,"BreadcrumbSaveStatusDash","-",null,!1),this.uD=y.CuiHelper.Lra(Y,"BreadcrumbSaveStatus",this.gfa,null,!1),this.t2f(this.uD),this.wda(this.fL,this.yz))};m.prototype.JKb=function(){this.xR(!1)};m.prototype.xR=function(Y){this.Hpa=Y;this.oyj(this.Hpa?
this.gfa:this.hfa)};m.prototype.oyj=function(Y){!this.uD||3!==this.yz&&2!==this.yz||(this.T0d&&!this.Hpa?(this.BCa=this.uD.offsetWidth<this.BCa?this.BCa:this.uD.offsetWidth,this.wvj(this.hfa),this.T0d=!1):this.uD.innerText=Y)};m.prototype.t2f=function(Y){Y.style.direction=this.fj?"rtl":"ltr";Y.style.width="auto";Y.style.textAlign=this.fj?"right":"left";Y.style.display=this.fL?"none":"";Y.setAttribute("Unselectable","on")};m.prototype.wvj=function(Y){this.uD&&(this.uD.style.width="",this.uD.innerText=
Y,this.BCa=this.uD.offsetWidth<this.BCa?this.BCa:this.uD.offsetWidth,Y=x.a.kA(this.uD),this.uD.style.width=this.BCa-z.a.HC(Y.paddingLeft)-z.a.HC(Y.paddingRight)+1+"px")};Object(D.a)(m,"SaveStatusUIHandler",null,[257]);var J=b(5),B=b(97);c.prototype.$h=function(Y){var L=this;this.pb=Y;J.AFrameworkApplication.ha.ta("PostMessageEmbedded")&&J.AFrameworkApplication.hideHeaderEmbedded?this.pb.register(r,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ac().Lc(function(){return new r(L.pb.yc("Common.App.HostNotification.EditNotificationEventSource"),
L.pb.yc("Postmessage.IHostPostmessenger"))}):J.AFrameworkApplication.za.Za.H8e||(J.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled?this.pb.register(t,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ac().Lc(function(){return new t(L.pb.yc("Common.App.HostNotification.EditNotificationEventSource"))}):this.pb.register(m,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ac().Lc(function(){return new m(B.EventHandlerManager.instance,
L.pb.yc("Common.App.Header.HeaderEventSource"),L.pb.yc("Common.App.HostNotification.EditNotificationEventSource"),J.AFrameworkApplication.isRtl)}))};c.prototype.init=function(){J.AFrameworkApplication.ha.Xv(Object(k.a)(this,this.HA,"onFullAppSettingsReady"))};c.prototype.HA=function(){var Y=J.AFrameworkApplication.ha,L=!!J.AFrameworkApplication.za.Za&&4===J.AFrameworkApplication.za.Za.Xk;if(Y.ta("WordEditorAutoSaveImprovementIsEnabled")||Y.ta("PptEditorSaveStatusInHeaderEnabled")||L&&Y.ta("SimplifiedReactRibbonUxIsEnabled")||
Y.ta("ExcelSaveStatusInHeaderEnabled")||Y.ta("VisioSaveStatusInHeaderEnabled"))J.AFrameworkApplication.ha.ta("PostMessageEmbedded")&&J.AFrameworkApplication.hideHeaderEmbedded?(this.AKc=this.pb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.AKc.Vx():J.AFrameworkApplication.za.Za.H8e||(J.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled?(this.EJc=this.pb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.EJc.initialize(Y.ta("IsSkyDrive"),Y.Wa("HostNameToIncludeInSavedStatus"),
J.AFrameworkApplication.ha):(this.tib=this.pb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.tib.initialize(Y.ta("IsSkyDrive"),Y.Wa("HostNameToIncludeInSavedStatus")))};c.prototype.dispose=function(){this.tib&&this.tib.lv()};Jl.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(D.a)(c,"PackageManager",null,[8,9]);F=b(274);var C=b(12),H=b(88),W=b(211),S=b(214),N=b(27),T=b(20);d.prototype.KBb=function(Y,L){L&&
L.pG&&N.a.yyg([L.pG])&&(this.Voc=!0)};d.prototype.rq=function(){this.Voc=!1};d.prototype.ed=function(Y,L){S.b(L)&&this.wda(!0);this.Voc=!1};d.prototype.dispose=function(){this.$&&(this.$.nl(Object(k.a)(this,this.sd,"onWorkbookOpened")),this.$.mCd(Object(k.a)(this,this.KBb,"onUserAlertActivityBeforeShow")),this.$.userOperationManager&&this.$.userOperationManager.WC(Object(k.a)(this,this.Hqf,"onQueueItemChange")),this.$.fa&&(this.$.fa.oVi(Object(k.a)(this,this.Grf,"onSaveStatusChange")),this.$.fa.xk(Object(k.a)(this,
this.ed,"onSessionIdChanged")),this.$.fa.WV(Object(k.a)(this,this.rq,"onLoadOnDemandOccurred"))),T.g(this.$)&&T.g(this.$).Ha&&T.g(this.$).Ha.Yq(Object(k.a)(this,this.xsd,"onCacheConsistent")))};d.prototype.wda=function(Y){Y=!this.$.isEditMode||(void 0===Y?!1:Y);this.DKf.wda(Y,this.$.isEditMode?3:1);this.xR()};d.prototype.xR=function(){this.$.isEditMode&&this.DKf.xR(!this.dQ&&!this.J9h&&!this.Voc)};d.prototype.sd=function(){this.dQ=this.$.dQ;this.wda()};d.prototype.Grf=function(){this.xR()};d.prototype.Hqf=
function(){this.dQ=this.$.dQ};d.prototype.xsd=function(){T.g(this.$).Ha.Yq(Object(k.a)(this,this.xsd,"onCacheConsistent"));this.dQ=this.$.dQ};Jl.Object.defineProperties(d.prototype,{J9h:{configurable:!0,enumerable:!0,get:function(){return this.$.fa?this.$.fa.aaf:!1}},dQ:{configurable:!0,enumerable:!0,get:function(){return this.NEc},set:function(Y){Y?this.NEc=!0:T.g(this.$)&&T.g(this.$).Ha&&(T.g(this.$).Ha.VG()?this.NEc=!1:T.g(this.$).Ha.Xp(Object(k.a)(this,this.xsd,"onCacheConsistent")));this.xR()}},
Voc:{configurable:!0,enumerable:!0,get:function(){return this.x8d},set:function(Y){this.x8d=Y;this.xR()}}});Object(D.a)(d,"SaveStatusManager",null,[7]);var fa=W.a;Cm(a,fa);a.prototype.create=function(){var Y=this,L=H.a.instance;L.yc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(P){var ea=new d(Y.Qc,P);L.register(d,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Ac().Lc(function(){return ea});Y.Jb(L.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};
a.la=function(Y){Y.ea.La(299,new a(Y))};Object(D.a)(a,"SaveStatusFactory",W.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");F.a.instance.oj(new c);C.a.Ja(a.la)}}]);

//# sourceMappingURL=EwaDS.savestatus.js.map