(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1229:function(D,F,b){function a(Oa,ib,sb,nb){var Gb=xa.call(this)||this;Gb.isMac=t.a.isMac;Gb.NVa=-1;Gb.T0b=null;Gb.Wra=-1;Gb.nXb=!1;Gb.CZ=!1;Gb.PKd=!1;Gb.aec=!1;Gb.zM=!1;Gb.WS=null;var Ha=b(1306).AutoDetectActionButton;Gb.$=Oa;Gb.Klb=fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ib||r.ULS.sendTraceTag(574681089,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");
Gb.convertToLinkedEntityManager=nb;nb.vNa();Gb.Gg=new Ha(Oa,ib,Object(w.a)(Gb,Gb.Yc,"onClick"),sb,"");Gb.fAg=new d(Gb.$,nb);Gb.gridView=P.g(Gb.$);Gb.gridView.ga.I1(Object(w.a)(Gb,Gb.Ih,"onSelectionEnded"));Gb.gridView.Hc.pVb(Object(w.a)(Gb,Gb.Ih,"onSelectionEnded"));Gb.gridView.Eq(Object(w.a)(Gb,Gb.KQ,"onGridContentReady"));Oa.yn(Object(w.a)(Gb,Gb.Yd,"onWorkbookClosing"));Oa.zD(Object(w.a)(Gb,Gb.kk,"onContentAreaResized"));Gb.gridBlockManager=Object(v.a)(453,Gb.gridView.Ha);Gb.Jt=Oa.frame.oz;Gb.nW();
return Gb}function d(Oa,ib){var sb=X.call(this)||this;sb.$=Oa;sb.gridView=P.g(Oa);sb.convertToLinkedEntityManager=ib;sb.NWc=new ea.a;return sb}function c(Oa,ib){var sb=T.call(this)||this;sb.tke=Oa;sb.convertToLinkedEntityManager=ib;sb.VGa=document.createElement("div");sb.VGa.className="clip16x16";sb.Oua=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',H.a.gg("autodetectid"+sb.tke.left),S.a.Z3c,N.a.Ee(11));sb.VGa.innerHTML=sb.Oua;
Oa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");W.a.instance.qa(u.a.click,Oa,Object(w.a)(sb,sb.Yc,"onClick"));return sb}function m(Oa,ib){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ib;this.parentElement=Oa}D=b(0);var r=b(15),t=b(24),k=b(86),u=b(13),w=b(37),v=b(82),A=b(404),y=b(74),x=b(10),z=b(67),J=b(456);m.prototype.sSg=function(){var Oa=this,ib=this.tSg();J.a(this.$,243,242,0,function(sb){Oa.cardViewManager=
sb;sb.$Sf(Oa.parentElement,2,ib)},"Microsoft.Office.Excel.WebUI.Client.CardView.ICardViewManager")};m.prototype.OZe=function(){this.cardViewManager&&this.cardViewManager.yJa(-1,-1,this.parentElement)};m.prototype.tSg=function(){var Oa={layoutId:"AutoDetectTooltip"};Oa.description=this.longDescription;Oa.convertToDomainName=this.convertToDomainName;Oa.longDescription=this.longDescription;Oa.urlValue=this.urlValue;Oa.imageAltText=this.imageAltText;Oa.helpText=this.helpText;Oa.helpId=this.helpId;return Oa};
Object(D.a)(m,"AutoDetectCardManager",null,[]);var B=b(28),C=b(198),H=b(30),W=b(276),S=b(18),N=b(48),T=y.a;Cm(c,T);c.prototype.dispose=function(){if(this.VGa){var Oa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");W.a.instance.Ca(u.a.click,Oa,Object(w.a)(this,this.Yc,"onClick"))}T.prototype.dispose.call(this)};c.prototype.Yc=function(Oa){if(Oa.Wb.id===this.VGa.firstChild.id){Oa=this.tke;var ib={};ib.Id=Oa.Jlb;this.convertToLinkedEntityManager.ZXc(ib,!0,Oa);this.VGa.removeChild(this.VGa.firstChild);
return!0}return!1};Jl.Object.defineProperties(c.prototype,{domElement:{configurable:!0,enumerable:!0,get:function(){return this.VGa}}});Jl.Object.defineProperties(c,{zFg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(D.a)(c,"AutoDetectColumnHeaderButton",y.a,[]);var fa=b(1),Y=b(1169),L=b(9),P=b(20),ea=b(125),X=y.a;Cm(d,X);d.prototype.dispose=function(){X.prototype.dispose.call(this)};d.prototype.B3g=function(Oa){for(var ib=Ml(this.gridView.o2),sb=ib.next();!sb.done;sb=
ib.next()){sb=Ml(sb.value);for(var nb=sb.next();!nb.done;nb=sb.next()){nb=nb.value;var Gb=nb.ho,Ha=Y.a(nb.X3);this.dog(Oa,Ha,Gb);nb.pHd(Ha)}}};d.prototype.dog=function(Oa,ib,sb){if(ib.length){var nb=sb.length;sb[nb-1]<Oa.left||(sb=L.HelperMethods.Uw(new C.a(sb),0,nb,Oa.left,L.HelperMethods.xC),0>sb||!(ib=ib[sb]))||(this.gridView.rtl?Sys.UI.DomElement.addCssClass(ib,B.a.vgh):Sys.UI.DomElement.addCssClass(ib,B.a.ugh),this.NWc.tb(Oa.left)||this.NWc.add(Oa.left,new c(Oa,this.convertToLinkedEntityManager)),
Oa=this.NWc.oa(Oa.left).domElement,!ib.getElementsByClassName(c.zFg).length&&this.Hjj(ib)&&ib.appendChild(Oa))}};d.prototype.Hjj=function(Oa){if(fa.EwaSettings.isChangeGateEnabled("OfficeVSO:5781488_ReplaceOldNumberFormatterTextMeasurement"))return this.Ijj(Oa);var ib=parseInt(Oa.style.width),sb=this.$.ea.Ea(268,void 0);if(!sb)return r.ULS.sendTraceTag(593266065,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton IInstantaneousSupportInformationManager not initialized in time for rendering Auto Detect Column Header Button"),
!0;sb=sb?sb.calculator:null;if(!sb)return r.ULS.sendTraceTag(593266064,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton NumberFormattingCalculator not initialized in time for rendering Auto Detect Column Header Button"),!0;var nb={fontVariant:"normal",fontStyle:"normal",fontFamily:'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif',fontSize:"10pt"};nb.fontWeight=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";nb.lineHeight="normal";nb.letterSpacing="0px";Oa=sb.calculateTextWidth(Oa.firstChild.innerHTML,
nb);return 18.4<ib-(ib/2+Oa/2)?!0:!1};d.prototype.Ijj=function(Oa){var ib=parseInt(Oa.style.width),sb=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";sb=d.dUg(sb);Oa=gridRenderer.CanvasRendererGlobals.measureTextWidth(Oa.firstChild.innerHTML,sb,!0,fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ib-(ib/2+Oa/2)?!0:!1};d.dUg=function(Oa){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",Oa,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(D.a)(d,"AutoDetectColumnHeaderManager",y.a,[]);var ja=b(422),R=b(25),ba=b(63),ha=b(141),oa=b(11),Sa=b(16),ma=b(173),na=b(76);b.d(F,"a",function(){return a});var xa=y.a;Cm(a,xa);a.prototype.dispose=function(){this.gridView&&this.gridView.ga.nca(Object(w.a)(this,this.Ih,"onSelectionEnded"));if(this.$){var Oa=this.$;Oa.Xo(Object(w.a)(this,this.Yd,"onWorkbookClosing"));Oa.AH(Object(w.a)(this,this.kk,"onContentAreaResized"));P.g(Oa).Ps(Object(w.a)(this,this.KQ,"onGridContentReady"))}k.a.Ia(this.Gg);
this.Jt=this.$=this.gridView=this.Gg=null;xa.prototype.dispose.call(this)};a.prototype.Tv=function(){this.Fka(null,!1);this.NVa=-1;this.Gg.hide();this.Ztj();this.zM=!1};a.prototype.vca=function(){this.Gg.getButton(a.yda).u9a();this.zM=!1};a.prototype.UGb=function(){this.Gg.getButton(a.yda).FCb();this.R1f(this.T0b);this.zM=!0;this.$.ea.ub(211,function(Oa){Oa.PNa(Sa.a.instance.da(1673))})};a.prototype.onAutoDetectUIShown=function(){if(this.Yua&&-1!==this.NVa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};
a.prototype.gAg=function(Oa){var ib=new R.Range(1===Oa.top?1:Oa.top-1,Oa.left,Oa.bottom,Oa.right,!0,!1);ib=this.gridView.getRangeInformation(ib);ib=Ml(ib);for(var sb=ib.next();!sb.done;sb=ib.next())if(sb=sb.value,Object(A.a)(ja.AutoDetectRange,sb)&&this.qvb(Oa,!1,sb))return!0;return!1};a.prototype.Q_b=function(){if(this.Yua&&-1!==this.NVa){this.Gg.getButton(a.yda).FCb();var Oa={};Oa.Id=this.Wra;Oa.StringId=null;this.convertToLinkedEntityManager.ZXc(Oa,!0,this.T0b);r.ULS.sendTraceTag(594612633,0,50,
"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Oa=[Object.assign(new na.a,{name:"Domain",int64:this.Wra})];ma.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,Oa);this.Wra=-1}};a.prototype.Juh=function(){var Oa=new Sys.StringBuilder(Sa.a.instance.da(1669));if(-1!==this.Wra){Oa.append(" ");try{Oa.append(this.convertToLinkedEntityManager.mxb(this.Wra.toString()))}catch(ib){r.ULS.sendTraceTag(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",
this.Wra)}}Oa.append(" ");this.Klb?Oa.append(Sa.a.instance.da(1672)):Oa.append(Sa.a.instance.da(this.isMac?1671:1670));return Oa.toString()};a.prototype.Ih=function(){this.Yua&&this.gridView&&this.nW()};a.prototype.Yd=function(){this.Tv()};a.prototype.Yc=function(){this.Q_b();P.g(this.$).Ye(!0,!1)};a.prototype.Fka=function(Oa,ib){ib?(this.R1f(this.T0b),this.nab()):(Oa=[29],this.gridView.Sb.ll(Oa),this.gridView.Sb.qm(null,Oa),this.WS&&this.WS.OZe())};a.prototype.nab=function(){this.Klb&&(this.WS||
(this.WS=new m(this.Nb,this.$),this.WS.convertToDomainName=Sa.a.instance.da(1674),this.WS.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.WS.imageAltText=Sa.a.instance.da(1676),this.WS.helpId="HID_DataTypes_Wolfram",this.WS.helpText=Sa.a.instance.da(1675)),this.WS.longDescription=this.convertToLinkedEntityManager.tOd(this.NVa.toString()),this.WS.sSg())};a.prototype.kk=function(){this.P3a()&&this.Gg.hide();1===this.gridView.ga.Ze&&this.nW()};
a.prototype.KQ=function(){var Oa=this.gridView.ga.Ze;this.gridView.ga.ya.activeCell&&1===Oa&&this.nW()};a.prototype.qvb=function(Oa,ib,sb){if((new R.Range(sb.top,sb.left,sb.bottom===x.a.Gh?sb.bottom:sb.bottom+1,sb.right,!0,!1)).oe(Oa)){if(ib){if(sb&&sb.Jlb!==this.NVa){this.NVa=sb.Jlb;Oa=sb.Jlb.toString();ib=this.Klb?"":this.convertToLinkedEntityManager.tOd(Oa);var nb=this.convertToLinkedEntityManager.jSh(Oa);this.Gg.jcb(this.convertToLinkedEntityManager.mxb(Oa),ib,nb,a.yda)}this.Wra=sb.Jlb;this.T0b=
sb}return!0}return!1};a.prototype.nW=function(){if(this.convertToLinkedEntityManager){var Oa=!!this.gridBlockManager&&this.gridBlockManager.scd,ib=this.gridView.ga.ya.TU,sb=this.gridView.ga.Ze,nb=fa.EwaSettings.ka(499);if(Oa&&(ib||nb)){Oa=this.gridView.ga.ya.activeCell;ib=!this.gridBlockManager.Hr(Oa);var Gb=this.gridView.getRangeInformation(this.gridView.Ph);Gb=Ml(Gb);for(var Ha=Gb.next();!Ha.done;Ha=Gb.next())if(Ha=Ha.value,Object(A.a)(ja.AutoDetectRange,Ha))if(nb)switch(Ha.IKg){case 3:if(this.qvb(Oa,
!0,Ha)){if(1!==sb||ib){this.Tv();return}r.ULS.sendTraceTag(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.JAd();this.Gg.x6(Oa,Object(w.a)(this,this.Fka,"onHover"));this.nXb||(this.nXb=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(fa.EwaSettings.ka(501)||fa.EwaSettings.ka(502))&&this.fAg.B3g(Ha);break;default:r.ULS.sendTraceTag(593266063,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else{if(1!==
sb||ib){this.Tv();return}if(this.qvb(Oa,!0,Ha)){r.ULS.sendTraceTag(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.Gg.x6(Oa,Object(w.a)(this,this.Fka,"onHover"));this.nXb||(this.nXb=!0,this.onAutoDetectUIShown());return}}}this.Tv()}};a.prototype.R1f=function(Oa){var ib=[29];this.gridView.Sb.qm(Oa,ib);this.gridView.Sb.Wr(ib)};a.prototype.P3a=function(){return this.$.fa.isNamedObjectViewMode&&ba.f(this.$.sa)};a.prototype.onKeyUp=function(Oa){return this.Rxb?
this.CZ?!1:17===Oa.Ga.keyCode&&this.PKd?(this.zM?(this.nab(),this.vca()):this.UGb(),!0):!1:this.CZ=!1};a.prototype.onKeyDown=function(Oa){if(!this.Rxb)return this.CZ=!1;this.PKd=!1;this.CZ=Oa.ctrlKey;switch(Oa.Ga.keyCode){case 27:return this.zM?(this.Fka(null,!1),this.vca()):this.WS&&(this.WS.OZe(),this.UGb()),!0;case 13:if(this.zM)return this.zM=!1,this.Q_b(),!0;break;case 17:return this.PKd=!0}return!1};a.prototype.JAd=function(){this.Klb&&!this.aec&&this.Jt&&(this.Jt.St(u.a.Rb,this.$.domElement,
Object(w.a)(this,this.onKeyDown,"onKeyDown"),!0),this.Jt.St(u.a.fe,this.$.domElement,Object(w.a)(this,this.onKeyUp,"onKeyUp"),!0),this.aec=!0)};a.prototype.Ztj=function(){this.Klb&&this.aec&&this.Jt&&(this.Jt.kv(u.a.Rb,this.$.domElement,Object(w.a)(this,this.onKeyDown,"onKeyDown"),!0),this.Jt.kv(u.a.fe,this.$.domElement,Object(w.a)(this,this.onKeyUp,"onKeyUp"),!0),this.aec=!1)};a.Lwh=function(Oa){return Sa.a.instance.da(1730)+z.a.space+Oa};Jl.Object.defineProperties(a.prototype,{Nb:{configurable:!0,
enumerable:!0,get:function(){return this.Gg.domElement(1)}},Rxb:{configurable:!0,enumerable:!0,get:function(){var Oa=this.Gg.domElement(a.yda);return Oa?oa.DOMElementExtensions.isVisible(Oa):!1}},Yua:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&fa.EwaSettings.ka(138)&&fa.EwaSettings.ka(141)&&(new ha.a(this.$.Aa)).vj?!1:-1!==this.Wra}}});Jl.Object.defineProperties(a,{yda:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(D.a)(a,"AutoDetectManager",y.a,[])},
1306:function(D,F,b){function a(k,u,w,v,A){var y=t.call(this)||this;y.$=k;y.ck=v.qob(k,u,w,"",c.a.Ee(11),A,"AutoDetectPointerDown",m.a.instance.da(1730)+"...");return y}b.r(F);b.d(F,"AutoDetectActionButton",function(){return a});D=b(0);F=b(74);var d=b(1229),c=b(48),m=b(16),r=b(20),t=F.a;Cm(a,t);a.prototype.dispose=function(){this.ck.dispose();this.$=null;t.prototype.dispose.call(this)};a.prototype.domElement=function(k){return this.ck.domElement(k)};a.prototype.getButton=function(k){return this.ck.getButton(k,
!1)};a.prototype.jcb=function(k,u,w,v){this.ck.yRa(d.a.Lwh(k),u,v);this.ck.uQd(w,u,v)};a.prototype.x6=function(k,u){var w=r.g(this.$),v=w.$a.fk(k);k=w.Mg(k,v);var A=w.Yf(v).pn;if(k&&0<=k.x&&0<=k.y&&A.width>k.width+160){var y=k.bottomRight.x+this.Gs,x=k.topLeft.y+this.Gs,z=!1;y+160>A.bottomRight.x&&(y=k.topLeft.x-this.Gs,z=!0);if(x<A.topLeft.y+this.Gs){if(w.$a.Mza){this.hide();return}x=A.topLeft.y+this.Gs}this.ck.Wpb(u,v);this.Ln(y,x,w.rtl,v,z)}else this.hide()};a.prototype.Ln=function(k,u,w,v,A){this.ck.Ln(k,
u,w,v,!1,A)};a.prototype.hide=function(){this.ck.hide()};Jl.Object.defineProperties(a.prototype,{Gs:{configurable:!0,enumerable:!0,get:function(){return this.ck.Gs}}});Object(D.a)(a,"AutoDetectActionButton",F.a,[])},1383:function(D,F,b){function a(ha){var oa=R.call(this)||this;oa.oi=null;oa.Wg=null;oa.$=ha;oa.fc();return oa}function d(ha,oa,Sa){ha=ja.call(this,ha)||this;ha.jr=0;ha.cp=!1;ha.$=oa;ha.taskPaneManager=Sa;fa.a(oa).$g(ha);ha.$.yn(Object(N.a)(ha,ha.Yd,"onWorkbookClosing"));Y.a.Sd(ha.$)&&
(ha.isVisible=!1);return ha}function c(ha){var oa=S.call(this)||this;oa.$=ha;oa.fc();return oa}function m(ha){return B.call(this,ha)||this}function r(ha,oa){this.$=oa;this.convertToLinkedEntityManager=ha}b.r(F);D=b(0);var t=b(800),k=b(15),u=b(4),w=b(79),v=b(35),A=b(1),y=b(172),x=b(20),z=b(173);r.prototype.$c=function(ha,oa){switch(oa){case -1203788282:case 48568533:case -1662108744:return ha=x.g(this.$),oa=this.convertToLinkedEntityManager.$gi||7E3,ha&&ha.ga&&ha.ga.ya.Xd.XO>oa?!0:!1;default:return!1}};
r.prototype.executeCommand=function(ha,oa,Sa){ha=v.TaskExtensions.um();oa=oa.command;switch(oa){case -1203788282:this.convertToLinkedEntityManager.RQg(Sa[w.a.Vd].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(Sa[w.a.Vd].toString());
break;case 1266950951:this.convertToLinkedEntityManager.a$h();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:A.EwaSettings.ka(706)&&this.convertToLinkedEntityManager.tCe();break;case 1702917262:A.EwaSettings.ka(706)&&this.convertToLinkedEntityManager.showHelpArticle(u.a.ovj);break;case -90814711:A.EwaSettings.ka(706)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===
oa||Sa[w.a.Aaf]&&"ConvertToLinkedEntityGallery"===Sa[w.a.Aaf].toString())k.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),z.a("ExpandDataTypeGallery");break;default:ha=y.a(oa)}return ha};r.prototype.Jc=function(ha,oa){switch(oa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return A.EwaSettings.ka(132);case -1081442996:case 1702917262:case -90814711:return A.EwaSettings.ka(706);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;
default:return!1}};r.prototype.gd=function(ha,oa,Sa){return"PopulateConvertToLinkedEntityMenu"===oa&&A.EwaSettings.ka(132)?this.convertToLinkedEntityManager.gd(ha,oa,Sa):!1};Object(D.a)(r,"ConvertToLinkedEntityCommandHandler",null,[159]);var J=b(456),B=t.a;Cm(m,B);m.prototype.Rd=function(){var ha=this;J.a(this.$,271,272,this.vb,function(oa){ha.Hd([new r(oa,ha.$)])},"Microsoft.Office.Excel.WebUI.Client.ConvertToLinkedEntity.IConvertToLinkedEntityManager")};m.la=function(ha){t.a.ie(273,new m(ha))};
Object(D.a)(m,"ConvertToLinkedEntityCommandHandlerFactory",t.a,[]);F=b(211);var C=b(870),H=b(58),W=b(405),S=F.a;Cm(c,S);c.prototype.create=function(){var ha=this,oa=H.GetServiceTaskFactory.create(this.$.ea,102,this.$.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),Sa=H.GetServiceTaskFactory.Xa(this.$.ea,5,4,this.vb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager"),ma=H.GetServiceTaskFactory.Xa(this.$.ea,388,387,this.vb,"Microsoft.Office.Excel.WebUI.Client.SvgIconProvider.ISvgIconProvider"),
na=H.GetServiceTaskFactory.Xa(this.$.ea,35,106,this.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");if(this.$.Tj)v.TaskExtensions.Da(v.TaskExtensions.Fe([oa,Sa,ma,na],this.ma),function(){ha.Jb(ha.$.ea.Ea(271,void 0)||new C.ConvertToLinkedEntityManager(ha.$,oa.result,ma.result,null,null,Sa.result,na.result))},this.$.ma,3);else{var xa=H.GetServiceTaskFactory.Xa(this.$.ea,257,258,this.vb,"Microsoft.Office.Excel.WebUI.Client.IEnrichmentTaskPane"),Oa=W.a(this.$);v.TaskExtensions.Da(v.TaskExtensions.Fe([oa,
xa,Oa,Sa,ma,na],this.ma),function(){ha.Jb(ha.$.ea.Ea(271,void 0)||new C.ConvertToLinkedEntityManager(ha.$,oa.result,ma.result,xa.result,Oa.result,Sa.result,na.result))},this.$.ma,3)}};c.la=function(ha){ha.ea.La(272,new c(ha))};Object(D.a)(c,"ConvertToLinkedEntityManagerFactory",F.a,[]);var N=b(37),T=b(227),fa=b(254),Y=b(43),L=b(241),P=b(11),ea=b(808),X=b(65),ja=T.a;Cm(d,ja);d.prototype.YF=function(ha){this.get_events().addHandler("EnrichmentTaskPaneRemoved",ha)};d.prototype.BH=function(ha){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",
ha)};d.prototype.EB=function(ha){this.addHandler("EnrichmentTaskPaneVilibilityChanged",ha)};d.prototype.XC=function(ha){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",ha)};d.prototype.utg=function(ha){this.addHandler("EnrichmentTaskPaneOnFocus",ha)};d.prototype.HUi=function(ha){this.removeHandler("EnrichmentTaskPaneOnFocus",ha)};d.prototype.Uv=function(){};d.prototype.YB=function(){};d.prototype.ln=function(){return this.cp};d.prototype.Ep=function(){return this.cp};d.prototype.UE=function(){};
d.prototype.dispose=function(){this.$&&this.$.Xo(Object(N.a)(this,this.Yd,"onWorkbookClosing"));this.taskPaneManager=this.$=null;ja.prototype.dispose.call(this)};d.prototype.Ye=function(ha,oa){oa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!oa};d.prototype.Lh=function(ha){return P.DOMElementExtensions.jf(this.Nb,ha)};d.prototype.vi=function(){};d.prototype.ei=function(){};d.prototype.Rf=function(ha){this.cp=ha;var oa=this.taskPaneManager;this.isVisible=ha;Y.a.Sd(this.$)?ha?this.taskPaneManager.QQ("EnrichmentTaskPane",
this.GK):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(ha&&0<oa.mz.length&&(!oa.Dg||10!==oa.Dg.taskPane.xg||oa.isCollapsed)&&oa.$C(this,!0),oa.$o());ha||(x.g(this.$).Ye(!0,!1),this.$.If())};d.prototype.LG=function(){return!1};d.prototype.Yd=function(){this.Rf(!1)};d.la=function(ha,oa){var Sa=ha.Mb,ma=document.getElementById(Sa+u.a.TCe);ma||(ma=ea.a("div",ha.Mb+u.a.TCe,"cui-taskpane"),Y.a.Sd(ha)||(Sa=document.getElementById(Sa+u.a.HQ),void 0!==Sa&&null!==Sa?Sa.appendChild(ma):k.ULS.sendTraceTag(554239310,
0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",ha.rE)));Sa=ha.ea;return Sa.Ea(257,void 0)||Sa.La(257,new d(ma,ha,oa))};Jl.Object.defineProperties(d.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(X.a)(d.prototype,this,"isVisible")},set:function(ha){Object(X.b)(d.prototype,this,"isVisible",ha);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},
he:{configurable:!0,enumerable:!0,get:function(){return L.a.J8g}},xg:{configurable:!0,enumerable:!0,get:function(){return 10}},Rj:{configurable:!0,enumerable:!0,get:function(){return"ewanov_linkedrecordPane"}},oC:{configurable:!0,enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},Il:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Nb:{configurable:!0,
enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.FK.offsetHeight}},GK:{configurable:!0,enumerable:!0,get:function(){var ha=this;return this.taskPaneManager.Ata(this.Nb,this.titleText,this.Il,this.isResizable,function(){ha.isVisible=!0},function(){ha.isVisible=!1},function(){ha.isVisible=!0},function(){ha.isVisible=!1},this.Il)}}});Object(D.a)(d,"EnrichmentTaskPane",T.a,[452,7,224,135]);var R=F.a;Cm(a,R);a.prototype.create=
function(){var ha=this,oa=H.GetServiceTaskFactory.create(this.$.ea,203,this.ma,this.vb,"System.IDisposable"),Sa=H.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary");v.TaskExtensions.Da(v.TaskExtensions.ts(v.TaskExtensions.Fe([oa,Sa],this.ma),function(){return ha.FC},this.ma),function(){ha.Jb(ha.Wg)},this.ma,3)};a.prototype.dispose=function(){this.Wg=this.oi=this.$=null;R.prototype.dispose.call(this)};a.la=function(ha){ha.ea.La(258,new a(ha))};Jl.Object.defineProperties(a.prototype,
{FC:{configurable:!0,enumerable:!0,get:function(){var ha=this;this.oi||(this.oi=v.TaskExtensions.Da(W.a(this.$),function(oa){ha.Wg=d.la(ha.$,oa.result)},this.ma,3));return this.oi}}});Object(D.a)(a,"EnrichmentTaskPaneFactory",F.a,[]);var ba=b(12);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(function(){ba.a.Ja(function(ha){a.la(ha);c.la(ha);m.la(ha)})})()},870:function(D,F,b){function a(pb,gb,Qa,eb,xb,dc,Nc){var Pc=Ub.call(this)||this;Pc.Drb=!1;Pc.HIb=!1;Pc.bgd=null;
Pc.OKa=null;Pc.fjd=null;Pc.gjd=null;Pc.Laa=null;Pc.icc=null;Pc.tdc=null;Pc.kkd=null;Pc.X1a=0;Pc.Lzb=0;Pc.ztb=0;Pc.Xaa=null;Pc.jgd=!1;Pc.CEd=null;Pc.cn=null;Pc.j7c=null;Pc.Uq=0;Pc.wL=null;Pc.CEj=null;Pc.lJa=8;Pc.bNa=!1;Pc.N4e=!1;Pc.Uaf=!1;Pc.WTc=!1;Pc.U_a=null;Pc.B0a=null;Pc.Axa=null;Pc.RRc=0;Pc.uAg=5;Pc.qXb=3E4;Pc.g_f=!1;Pc.d9=null;Pc.mYb=null;Pc.b$=Array(12);Pc.bQd=!1;Pc.G1f=!1;Pc.Nmd=0;Pc.jJf=0;Pc.H3d=null;Pc.hfg=!1;Pc.$=pb;Pc.businessBar=dc;Pc.svgIconProvider=Qa;Pc.zg=Nc;Pc.Zva=[];Pc.OJ=[];Pc.gridView=
kc.g(Pc.$);Pc.P9b=-1;Pc.Bvb=zc.EwaSettings.ka(134);Pc.Cva=zc.EwaSettings.ka(467);Pc.e3h=zc.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");Pc.s3a=Pc.$.ka(464)&&Pc.$.ka(300);Pc.k4a=Pc.$.ka(729);Pc.ewb=zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);Pc.Fva=Pc.$.ka(728)&&Pc.Cva;Pc.sjd=Pc.Fva&&zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);
Pc.Z5e=zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);Pc.uKa=zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CheckExtraPowerBILicenses",!1);Pc.RL=new Mb.a;Pc.YLa=new c(pb,gb,Pc);eb&&(Pc.cn=new m(pb,eb,xb,Pc,Pc));zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityReduceGallerySize",!1)&&(Pc.b$=Array(5));Pc.Bvb?(Pc.$.Nk(Object(L.a)(Pc,Pc.sd,"onWorkbookOpened")),R.a(Pc.$)&&R.a(Pc.$).v6i(Pc),Pc.tpe()):pb.ea.La(271,
Pc);(Pc.ewb||Pc.s3a||Pc.k4a)&&Pc.$.fa.ot(Object(L.a)(Pc,Pc.hg,"onWorkbookMetadataChanged"));zc.EwaSettings.ka(132)&&zc.EwaSettings.ka(141)&&(Pc.u0f()||Pc.gridView.Eq(Object(L.a)(Pc,Pc.onContentReady,"onContentReady")));Pc.Cva&&Pc.$.zD(Object(L.a)(Pc,Pc.kk,"onContentAreaResized"));zc.EwaSettings.ka(706)&&(Pc.$.fa.ak(Object(L.a)(Pc,Pc.ed,"onSessionIdChanged")),Pc.showUntrustedImageBusinessBarIfNecessary());Pc.sjd&&(Pc.CEd=new d(Pc.$,Pc));return Pc}function d(pb,gb){this.Gcd=this.Icd=!1;this.$=pb;this.vya=
gb}function c(pb,gb,Qa){this.Pmd=2;this.Omd="Size64by48";this.$=pb;this.Va=gb;this.convertToLinkedEntityManager=Qa;this.Fva=zc.EwaSettings.ka(728)&&zc.EwaSettings.ka(467)}function m(pb,gb,Qa,eb,xb){var dc=this;this.osa=this.zze=!1;this.d$a=this.iva=!0;this.UBb=this.EHb=!1;this.vab=null;this.akc=0;this.$=pb;this.gridView=kc.g(this.$);this.gridView.ga.I1(Object(L.a)(this,this.Ih,"onSelectionEnded"));this.gridView.Eq(Object(L.a)(this,this.KQ,"onGridContentReady"));this.uDe=eb;this.convertToLinkedEntityManager=
xb;fb.a.Sd(this.$)||Qa.aQ(gb);pb=new w(gb);this.J3b=new k(pb);fa.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Nc){Nc.isFeatureEnabled("mso_sendASmile",!0).then(function(Pc){dc.iva=Pc;return null})})}function r(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}function t(pb){this.campaignId=this.commentQuestion=
null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=pb;this.commentQuestion=za.a.instance.Eb(188);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=za.a.instance.Eb(184);this.ratingValuesAscending=[za.a.instance.Eb(185),za.a.instance.Eb(186),za.a.instance.Eb(187)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=
4;this.title=za.a.instance.Eb(183)}function k(pb){return u.call(this,pb)||this}function u(pb){this.iy=null;this.oea=pb}function w(pb){var gb=v.call(this,H.AFrameworkApplication.za.nz,H.AFrameworkApplication.za.oz,H.AFrameworkApplication.za.jda,H.AFrameworkApplication.za.Te,H.AFrameworkApplication.Hb)||this;gb.taskPane=pb;gb.taskPane.utg(Object(L.a)(gb,gb.nOf,"setFocusOnIFrame"));return gb}function v(pb,gb,Qa,eb,xb){this.wq=this.Ai=this.$_d=this.Z_d=this.uv=this.ju=null;this.Fw=!1;this.Xg=pb;this.qe=
gb;this.KF=Qa;this.hc=eb;this.Oa=xb;this.poa=ca.KeyInputManager.El(Ha.a.kAa,0)}function A(pb,gb,Qa){pb=y.call(this,pb,gb)||this;pb.telemetryJson=null;pb.telemetryJson=Qa;return pb}function y(pb,gb){pb=x.call(this,pb)||this;pb.messageContent=null;pb.messageContent=gb;return pb}function x(pb){this.messageType=0;this.messageType=pb}function z(){}function J(pb,gb,Qa,eb,xb,dc,Nc,Pc,Fd,Ea,Xa){Xa=pb.Ra(1,void 0===Xa?null:Xa);Xa.selectedRanges=gb;Xa.isChangeObject=Qa;Xa.isFloodgateEnabled=eb;Xa.isStarterData=
xb;Xa.starterDataDomainId=dc;return na.i(pb,"GetDataSelectorPaneData",Xa,Nc,Pc,Fd,Ea,4)}b.r(F);D=b(0);var B=b(15),C=b(86),H=b(5),W=b(30),S=b(931),N=b(144),T=b(371),fa=b(88),Y=b(935),L=b(37),P=b(82),ea=b(36),X=b(18),ja=b(4),R=b(161),ba=b(1229),ha=b(1243),oa=b(194),Sa=b(576),ma=b(337),na=b(81),xa=b(808),Oa=b(904);z.fSh="EnrichmentContentFrame";z.width=320;Object(D.a)(z,"EnrichmentConstants",null,[]);Object(D.a)(x,"EnrichmentResponseMessage",null,[]);Cm(y,x);Object(D.a)(y,"EnrichmentResponseMessageWithContent",
x,[]);Cm(A,y);Object(D.a)(A,"EnrichmentResponseMessageWithContentAndTelemetryData",y,[]);var ib=b(275),sb=b(13),nb=b(100),Gb=b(40),Ha=b(90),ca=b(120),Ra=b(41),ua=b(75),ta=b(24),db=b(111),Ta=b(801),qb=b(29);v.prototype.dispose=function(){this.wHb&&this.wq&&(this.Xg.Ca(sb.a.click,this.wq,Object(L.a)(this,this.Uj,"onClosePaneClick")),this.qe.Ca(sb.a.fe,this.wq,Object(L.a)(this,this.yof,"onKeyHide")));this.wq=null;this.uv&&(this.Fuj(),this.uv.parentNode.removeChild(this.uv),this.uv=null);this.hc.Wh("EnrichmentPaneId").Kk(this.poa)};
v.prototype.show=function(pb,gb,Qa){this.ju=pb;this.Fw||(this.Ai=this.UYa(),this.GOa.appendChild(this.Ai),this.gQi(),this.Oa.$b(qb.a.Tqe,db.a.frame,Object(L.a)(this,this.dNh,"handleEscapeKeyAction")),this.kma(),this.Fw=!0);this.uv.src=this.k_a&&this.k_a.length?this.k_a+"?culture="+gb.market+"&appName="+gb.applicationName+"&themeId="+gb.themeId+"&featuresBitMask="+gb.featuresBitMask:v.pif;this.Z_d=gb;this.$_d=Qa;this.iab()};v.prototype.Uvc=function(pb,gb){pb=new A(2,pb,gb);this.Pkc(pb)};v.prototype.kma=
function(){var pb=this.hc.Wh("EnrichmentPaneId");pb.parent=ib.AFrame.kwa;this.Xg.VVa("EnrichmentPaneId",this.Ai);pb.bindAction(this.poa,qb.a.Tqe)};v.prototype.nOf=function(){if(this.uv){nb.FocusManager.Xma(this.uv.contentWindow);var pb=new A(4,null,null);this.Pkc(pb)}};v.prototype.Uj=function(){this.KZb();return!0};v.prototype.yof=function(pb){pb=pb.Ga.keyCode;return pb===Sys.UI.Key.enter||pb===Sys.UI.Key.space?(this.KZb(),!0):!1};v.prototype.KZb=function(){this.hide();if(this.ju)this.ju.onPaneClosed()};
v.prototype.UYa=function(){var pb=xa.a("div","EnrichmentPaneId","EnrichmentPane");this.wHb&&pb.appendChild(this.dZc());this.KVh(pb);return pb};v.prototype.dZc=function(){var pb=xa.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),gb=xa.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");gb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;gb.title=CommonUIStrings.l_EnrichmentPaneTitle;var Qa=Oa.a.zb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Xg.qa(sb.a.click,Qa,Object(L.a)(this,this.Uj,"onClosePaneClick"));this.qe.qa(sb.a.fe,Qa,Object(L.a)(this,this.yof,"onKeyHide"));pb.appendChild(gb);pb.appendChild(Qa);this.wq=Qa;return pb};v.prototype.KVh=function(pb){this.uv=xa.b("iframe","","EnrichmentFrame");pb.appendChild(this.uv);this.uv.id=z.fSh;this.uv.setAttribute("role","presentation")};v.prototype.gQi=function(){Gb.a.addHandler(this.uv,"load",Object(L.a)(this,this.cof,"onIFrameLoad"));Gb.a.addHandler(this.uv,
"error",Object(L.a)(this,this.pic,"onIFrameError"));$addHandler(window,"message",Object(L.a)(this,this.dof,"onIFrameMessage"))};v.prototype.Fuj=function(){Gb.a.removeHandler(this.uv,"load",Object(L.a)(this,this.cof,"onIFrameLoad"));Gb.a.removeHandler(this.uv,"error",Object(L.a)(this,this.pic,"onIFrameError"));$removeHandler(window,"message",Object(L.a)(this,this.dof,"onIFrameMessage"))};v.prototype.F_g=function(){this.uv.src=v.pif};v.prototype.hide=function(){this.t$b();this.F_g()};v.prototype.dNh=
function(pb,gb,Qa){if(1!==Qa&&(this.hide(),this.ju))this.ju.onPaneClosed();return 32};v.prototype.cof=function(){};v.prototype.pic=function(){};v.prototype.dof=function(pb){pb=pb.rawEvent;if(!this.uv||-1!==this.uv.src.indexOf(pb.origin)){try{var gb=Ra.a(pb.data)}catch(Qa){return}if(!Ta.c(gb.messageType)){pb=window.g_badCastCallback;window.g_badCastCallback=null;switch(gb.messageType){case 2:this.Pkc(new A(1,Ra.c(this.Z_d),this.$_d));break;case 1:this.Pkc(new y(0,this.qth()));break;case 3:this.ju&&
this.ju.selectEntity(gb.messageContent);break;case 5:this.ju&&this.ju.kzb(gb.messageContent);break;case 8:this.ju&&(gb=Ra.a(gb.messageContent),0<gb.DomainId?this.ju.DFd(gb.Query,gb.TelemetryJson,gb.DomainId,gb.DomainIdString):this.ju.searchEntity(gb.Query,gb.TelemetryJson));break;case 6:this.ju&&this.ju.cancelSearch();break;case 11:gb=Ra.a(gb.messageContent);gb=v.w0b("keydown","f6",Ha.a.qMb,!0,!1,gb,!0,!1);this.uv&&this.uv.dispatchEvent(gb);break;case 12:if(Ra.a(gb.messageContent).keyCode===Ha.a.LK&&
(gb=v.w0b("keydown","esc",Ha.a.LK,!0,!1,!1,!1,!1),this.uv&&(this.uv.dispatchEvent(gb),this.hide(),this.ju)))this.ju.onPaneClosed();break;case 13:this.ju&&this.ju.selectDataType(gb.messageContent);break;case 14:this.ju&&this.ju.showHelpArticle(gb.messageContent);break;case 15:this.ju&&this.ju.showSurveyDialog(gb.messageContent);break;case 16:this.ju&&(gb=Ra.a(gb.messageContent),this.ju.insertTable(gb.DomainId,gb.DomainIdString))}window.g_badCastCallback=pb}}};v.prototype.qth=function(){return Ra.c([2,
1,3,5,8,6])};v.prototype.Pkc=function(pb){pb=Ra.c(pb);this.uv.contentWindow.postMessage(pb,ua.a.K$(this.k_a))};v.w0b=function(pb,gb,Qa,eb,xb,dc,Nc,Pc){ta.a.Iu?(dc=String.format("{0} {1} {2}",dc?"Shift":"",Nc?"Control":"",Pc?"Alt":""),dc.trim(),Qa=document.createEvent("KeyboardEvent"),Qa.initKeyboardEvent(pb,eb,xb,window.self,gb,0,dc,!1,"en-US")):(gb={},gb.keyCode=Qa,gb.ctrlKey=Nc,gb.shiftKey=dc,gb.altKey=Pc,gb.bubbles=eb,gb.cancelable=xb,Qa=new KeyboardEvent(pb,gb));return Qa};Jl.Object.defineProperties(v.prototype,
{wHb:{configurable:!0,enumerable:!0,get:function(){return!0}},k_a:{configurable:!0,enumerable:!0,get:function(){return H.AFrameworkApplication.ha.Wa("EnrichmentPaneUrl")}}});v.pif="about:blank";Object(D.a)(v,"EnrichmentPane",null,[614,7]);Cm(w,v);w.prototype.iab=function(){this.taskPane.isVisible||this.taskPane.Rf(!0)};w.prototype.t$b=function(){this.taskPane.Rf(!1)};w.prototype.dispose=function(){this.taskPane&&(this.taskPane.HUi(Object(L.a)(this,this.nOf,"setFocusOnIFrame")),this.taskPane=null);
v.prototype.dispose.call(this)};Jl.Object.defineProperties(w.prototype,{GOa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.Nb},set:function(pb){this.taskPane.Nb.innerHTML=pb.innerHTML}}});Object(D.a)(w,"EnrichmentTaskPaneWrapper",v,[]);u.prototype.d$h=function(pb,gb){this.iy=pb;this.oea&&this.oea.show(this,gb,null)};u.prototype.Uvc=function(pb,gb){this.oea&&this.oea.Uvc(pb,gb)};u.prototype.iub=function(){this.oea&&this.oea.hide()};u.prototype.dispose=function(){this.oea&&(this.oea.dispose(),
this.oea=null)};u.prototype.selectEntity=function(pb){return this.iy?this.iy.selectEntity(pb):!1};u.prototype.searchEntity=function(pb,gb){this.iy&&this.iy.searchEntity(pb,gb)};u.prototype.DFd=function(pb,gb,Qa,eb){this.iy&&this.iy.DFd(pb,gb,Qa,eb)};u.prototype.kzb=function(pb){return this.iy?this.iy.kzb(pb):!1};u.prototype.onPaneClosed=function(){if(this.iy)this.iy.onPaneClosed()};u.prototype.cancelSearch=function(){this.iy&&this.iy.cancelSearch()};u.prototype.selectDataType=function(pb){this.iy&&
this.iy.selectDataType(pb)};u.prototype.showHelpArticle=function(pb){this.iy&&this.iy.showHelpArticle(pb)};u.prototype.showSurveyDialog=function(pb){this.iy&&this.iy.showSurveyDialog(pb)};u.prototype.insertTable=function(pb,gb){this.iy&&this.iy.insertTable(pb,gb)};Object(D.a)(u,"EnrichmentManager",null,[613,7]);Cm(k,u);k.prototype.dispose=function(){u.prototype.dispose.call(this)};Object(D.a)(k,"ExcelEnrichmentManager",u,[]);var za=b(16);Object(D.a)(t,"FloodgateSurvey",null,[]);var Ia=b(25),va=b(79),
Ua=b(407),Kb=b(46),ia=b(365),E=b(160),fb=b(43),Za=b(92),ec=b(27),zc=b(1),Ab=b(7),vb=b(273),kc=b(20);Object(D.a)(r,"EnrichmentMessageContentAppProperties",null,[]);m.prototype.dispose=function(){this.$&&(this.gridView.ga.nca(Object(L.a)(this,this.Ih,"onSelectionEnded")),this.gridView.Ps(Object(L.a)(this,this.KQ,"onGridContentReady")))};m.prototype.selectEntity=function(pb){function gb(){return new Ua.a}var Qa=this,eb=Kb.o(this.gridView.ga.ya.activeCell,this.$);ia.a(this.$.userOperationManager,function(xb,
dc,Nc){var Pc=Qa.$.ra.xa;xb=vb.b(xb,Object(L.a)(Qa,Qa.Lyi,"onSelectLinkedEntitySucceeded"));var Fd=Pc.Ra(9,null);Fd.activeCell=eb;Fd.selectionIndex=pb;return na.i(Pc,"SelectLinkedEntityForDisambiguation",Fd,xb,dc,Nc,null,4)},function(xb){return new E.a(109,0,xb,void 0,gb)},null);return!0};m.prototype.searchEntity=function(pb,gb,Qa,eb,xb){var dc=this;Qa=void 0===Qa?!1:Qa;eb=void 0===eb?0:eb;xb=void 0===xb?null:xb;B.ULS.sendTraceTag(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",
gb);var Nc=Kb.o(this.gridView.ga.ya.activeCell,this.$);ia.a(this.$.userOperationManager,function(Pc,Fd,Ea){var Xa=dc.$.ra.xa,hc=dc.iva,Xb=Qa,Ic=eb,Qc=xb;Pc=vb.b(Pc,Object(L.a)(dc,dc.Wrf,"onSearchLinkedEntitySucceeded"));var Cb=Xa.Ra(1,null);Cb.searchCell=Nc;Cb.searchQuery=pb;Cb.isFloodgateEnabled=hc;Cb.isStarterData=Xb;Cb.starterDataDomainId=Ic;Cb.starterDataDomainIdString=Qc;return na.i(Xa,"LinkedEntitySearch",Cb,Pc,Fd,Ea,null,4)},function(Pc){return new E.a(110,0,Pc,16)},null)};m.prototype.kzb=
function(pb){var gb=this,Qa=Kb.o(this.gridView.ga.ya.activeCell,this.$);this.d$a=!1;ia.a(this.$.userOperationManager,function(eb,xb,dc){var Nc=gb.$.ra.xa;eb=vb.b(eb,Object(L.a)(gb,gb.Wvi,"onMoveToAmbiguousItemSucceeded"));var Pc=Nc.Ra(1,null);Pc.activeCell=Qa;Pc.isBackward=pb;return na.i(Nc,"MoveToNextAmbiguousLinkedEntity",Pc,eb,xb,dc,null,4)},function(eb){return new E.a(111,0,eb,16)},null);return!0};m.prototype.onPaneClosed=function(){this.osa=!1;this.zze=!0;this.akc=0;this.UBb=!1};m.prototype.cancelSearch=
function(){var pb=this,gb=this.VFd();gb&&ia.a(this.$.userOperationManager,function(Qa,eb,xb){var dc=pb.$.ra.xa;Qa=vb.b(Qa,Object(L.a)(pb,pb.Wrf,"onSearchLinkedEntitySucceeded"));var Nc=dc.Ra(9,null);Nc.activeCell=gb;return na.i(dc,"CancelSearchLinkedEntity",Nc,Qa,eb,xb,null,4)},function(Qa){return new E.a(112,0,Qa,16)},null)};m.prototype.selectDataType=function(pb){B.ULS.sendTraceTag(591005634,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.sra();
if(pb&&pb.length)if(pb=JSON.parse(pb))if(null==pb.domainId)B.ULS.sendTraceTag(593282249,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var gb={};gb.Id=pb.domainId;gb.StringId=pb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(gb)}else B.ULS.sendTraceTag(593282250,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else B.ULS.sendTraceTag(593282251,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};
m.prototype.showHelpArticle=function(pb){var gb=new Za.a(-859308420,va.a.Yb,this.$.jd,9,null),Qa={};pb=(Qa.CommandValueId="HelpID="+pb,Qa.InputMethod=va.a.Yb,Qa.ShouldCanvasTakeFocus=!0,Qa.MenuItemId=ja.a.bZ,Qa);this.$.Na.Xb(gb,pb)};m.prototype.showSurveyDialog=function(pb){ha.a.hIb(new t(pb))};m.prototype.insertTable=function(pb,gb){var Qa=this,eb=this.VFd();eb&&ia.a(this.$.userOperationManager,function(xb,dc,Nc){var Pc=Qa.$.ra.xa;xb=vb.b(xb,Object(L.a)(Qa,Qa.Cui,"onInsertStarterDataTableSucceeded"));
var Fd=Pc.Ra(1,null);Fd.cell=eb;Fd.starterDataDomainId=pb;Fd.starterDataDomainIdString=gb;return na.i(Pc,"InsertStarterDataTable",Fd,xb,dc,Nc,null,4)},function(xb){return new E.a(259,0,xb,1)},null)};m.prototype.KQ=function(){(this.d$a||this.osa)&&2!==this.akc&&(this.UBb||this.mmd(!1))};m.prototype.ed=function(){B.ULS.sendTraceTag(39081763,0,15,"Session ID changed while ambiguous linked entities are present")};m.prototype.mmd=function(pb){this.launchOrCloseDisambiguationPane(pb)};m.prototype.launchDisambiguationPaneForSearch=
function(){var pb=this;B.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");var gb=this.o3i();gb&&ia.a(this.$.userOperationManager,function(Qa,eb,xb){return J(pb.$.ra.xa,gb,!0,pb.iva,!1,null,vb.b(Qa,Object(L.a)(pb,pb.zsi,"onGetDisambiguationDataForSearchSucceeded")),eb,xb,1)},function(Qa){return new E.a(114,0,Qa,16)},null)};m.prototype.launchLinkedEntityDataTypeSelectorPane=function(pb,gb){var Qa=this;
ia.a(this.$.userOperationManager,function(eb,xb,dc){var Nc=Qa.$.ra.xa;eb=vb.b(eb,Object(L.a)(Qa,Qa.kic,"onGetDisambiguationDataSucceeded"));var Pc=Nc.Ra(1,null);Pc.selectedRanges=pb;Pc.letyDomainId=gb;return na.i(Nc,"GetDataTypeSelectorData",Pc,eb,xb,dc,2,4)},function(eb){return new E.a(233,0,eb,16)},null)};m.prototype.Y9h=function(pb,gb){var Qa=this;pb&&ia.a(this.$.userOperationManager,function(eb,xb,dc){return J(Qa.$.ra.xa,pb,!1,!1,!0,gb,vb.b(eb,Object(L.a)(Qa,Qa.kic,"onGetDisambiguationDataSucceeded")),
xb,dc,2)},function(eb){return new E.a(257,0,eb,16)},null)};m.prototype.iqi=function(pb){ec.a.eh(pb.Errors)?(pb=ec.a.fd(pb.Errors),Ab.a.contains(pb,"OperationSucceededWithAlert",!1)?B.ULS.sendTraceTag(38541457,0,50,"Convert to Linked Entity failed with an alert"):B.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",pb)):pb.Result&&(this.$.fa.xk(Object(L.a)(this,this.ed,"onSessionIdChanged")),this.$.fa.ak(Object(L.a)(this,this.ed,"onSessionIdChanged")),pb=pb.Result,this.vab=
pb.SkydanceFeatureBitmask,this.Ypd(pb),this.EHb=!0)};m.prototype.Ih=function(){(this.d$a||this.osa)&&this.mmd(!1)};m.prototype.kic=function(pb,gb){ec.a.eh(pb.Errors)?B.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",ec.a.fd(pb.Errors)):pb.Result&&(pb=pb.Result,pb.DisambiguationJson?(this.EHb=!1,this.kPf(gb),this.vab=pb.SkydanceFeatureBitmask,gb=pb.DisambiguationJson,B.ULS.sendTraceTag(591005633,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.UBb=!1,this.yaf(gb)):B.ULS.sendTraceTag(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};m.prototype.zsi=function(pb,gb){ec.a.eh(pb.Errors)?B.ULS.sendTraceTag(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",ec.a.fd(pb.Errors)):pb.Result&&(pb=pb.Result,pb.DisambiguationJson?(this.kPf(gb),this.vab=pb.SkydanceFeatureBitmask,gb=pb.DisambiguationJson,B.ULS.sendTraceTag(591005632,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.UBb=!0,this.yaf(gb)):B.ULS.sendTraceTag(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};m.prototype.kPf=function(pb){pb&&(this.akc=pb)};m.prototype.yaf=function(pb){if(zc.EwaSettings.ka(706)){var gb=new Za.a(-90814711,va.a.Yb,0,10,null);this.$.Na.Xb(gb,null)}this.osa?this.J3b.Uvc(pb,null):(gb=3,null!=this.vab?gb=this.vab:B.ULS.shipAssertTag(40511299,0,!1,"SkydanceFeatureBitmask was not set"),(pb=this.Myh(pb,gb))||B.ULS.sendTraceTag(577528395,
0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.uDe||B.ULS.sendTraceTag(577528394,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.J3b.d$h(this.uDe,pb),this.osa=!0)};m.prototype.sra=function(){this.osa&&(B.ULS.sendTraceTag(591005602,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.J3b.iub(),this.osa=!1,this.akc=0,this.UBb=!1)};m.prototype.Wvi=function(pb){ec.a.eh(pb.Errors)?(B.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",
ec.a.fd(pb.Errors)),this.d$a=!0):pb.Result&&(pb=pb.Result,this.vab=pb.SkydanceFeatureBitmask,this.Ypd(pb),this.EHb=!0)};m.prototype.Ypd=function(pb){var gb=pb.Row+1;pb=pb.Column+1;0>gb||0>pb?(B.ULS.sendTraceTag(591005601,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.sra(),this.$.fa.xk(Object(L.a)(this,this.ed,"onSessionIdChanged"))):(gb=new Ia.Range(gb,pb,gb,pb,!0,!1),this.gridView.ga.updateSelection(gb,gb,60),this.d$a=!0)};m.prototype.Myh=
function(pb,gb){var Qa=new r;Qa.applicationVersion=H.AFrameworkApplication.buildVersion;Qa.applicationName="ExcelWac";Qa.anid="00000000-0000-0000-0000-000000000000";Qa.sessionId=H.AFrameworkApplication.userSessionId;Qa.appCorrelationId=oa.a.create().toString();var eb=Sa.a.pJ(H.AFrameworkApplication.lcid);eb=eb?eb.name:null;Qa.uiLanguage=eb;Qa.market=this.s7b(eb);Qa.themeId=0;Qa.disambiguationJson=pb;gb<=ma.a.PW?Qa.featuresBitMask=gb:B.ULS.sendTraceTag(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");
return Qa};m.prototype.s7b=function(pb){pb=pb.split("-");return pb[pb.length-1]};m.prototype.launchOrCloseDisambiguationPane=function(pb){var gb=this,Qa=this.gridView.ga.ya.activeCell;if(this.VFd()&&Qa)if(this.gridView.kc.Vac(Qa)){if((!this.zze||pb||this.EHb)&&!this.gridView.isEditing){pb&&(this.d$a=!0);var eb=Kb.q(Qa,this.$);ia.a(this.$.userOperationManager,function(xb,dc,Nc){return J(gb.$.ra.xa,eb,!1,gb.iva,!1,null,vb.b(xb,Object(L.a)(gb,gb.kic,"onGetDisambiguationDataSucceeded")),dc,Nc,1)},function(xb){return new E.a(114,
0,xb,16)},null)}}else this.sra();else this.sra()};m.prototype.fPi=function(){var pb=this;if(this.osa){var gb=this.gridView.ga.ya.activeCell;if(gb){var Qa=Kb.q(gb,this.$);ia.a(this.$.userOperationManager,function(eb,xb,dc){return J(pb.$.ra.xa,Qa,!1,pb.iva,!1,null,vb.b(eb,Object(L.a)(pb,pb.kic,"onGetDisambiguationDataSucceeded")),xb,dc,1)},function(eb){return new E.a(114,0,eb,16)},null)}else this.sra()}};m.prototype.Lyi=function(pb){ec.a.eh(pb.Errors)&&B.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",
ec.a.fd(pb.Errors));pb.Result?(this.Ypd(pb.Result),this.EHb=!0):this.sra()};m.prototype.Wrf=function(pb){ec.a.eh(pb.Errors)?B.ULS.sendTraceTag(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",ec.a.fd(pb.Errors)):pb.Result?this.J3b.Uvc(pb.Result,null):(B.ULS.sendTraceTag(591005598,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.sra())};m.prototype.Cui=function(pb){ec.a.eh(pb.Errors)?
B.ULS.sendTraceTag(539358111,0,15,"Failed to insert starter data table. Error id names: {0}",ec.a.fd(pb.Errors)):this.sra()};m.prototype.VFd=function(){var pb=this.gridView.ga.ya;return pb.Gva()?Kb.o(pb.activeCell,this.$):null};m.prototype.o3i=function(){var pb=this.gridView.ga.ya;return pb.Gva()?Kb.q(pb.activeCell,this.$):null};Object(D.a)(m,"ConvertToLinkedEntityDisambiguationPane",null,[7]);var td=b(828),Oc=b(1345),tc=b(48),sc=b(818);c.prototype.qrh=function(pb,gb){return this.prh(pb,gb).JB()};
c.prototype.prh=function(pb,gb){gb=this.Va.sp(gb);if(pb&&0<pb.length){var Qa=this.Va.Vc();gb.Fc.push(Qa);var eb=this.Va.cA("ConvertToLinkedEntitySeeMore",this.Pmd,this.Omd);pb=Ml(pb);for(var xb=pb.next();!xb.done;xb=pb.next())if(xb=xb.value,!xb.DomainId.StringId&&!xb.DomainBlocked&&xb.ShowInRibbon){var dc=xb.DomainId.Id.toString();eb.vfd(0,"Data.ConvertToLinkedEntityMenuItem_"+dc,-1203788282,"QueryLinkedEntityGalleryIcon",xb.Description,dc,this.lSh(xb.Name))}Array.add(Qa.buttons,eb)}gb.Fc.length||
B.ULS.sendTraceTag(34415008,0,15,"No domain data available");return gb};c.prototype.rrh=function(pb,gb){var Qa=b(870).ConvertToLinkedEntityManager;this.Vwj();gb=this.Va.sp(gb).JB();for(var eb=0,xb=0,dc=!1,Nc=Ml(pb.Categories),Pc=Nc.next();!Pc.done;Pc=Nc.next()){if(Pc=this.Wrh(Pc.value,eb))this.Fva&&xb===Qa.l5a&&(dc=!0),Array.add(gb.MenuSectionList,Pc),++eb;++xb}this.Fva&&dc&&eb<=Qa.Waf&&Array.removeAt(gb.MenuSectionList,Qa.l5a);Qa=this.Va.Vc().XXb();eb=tc.a.Ee(11);pb=Ml(pb.LongButtons);for(xb=pb.next();!xb.done;xb=
pb.next())xb=xb.value,this.convertToLinkedEntityManager.hej(xb)&&this.Xpg(Qa,xb,eb);0<Qa.ControlList.length&&Array.add(gb.MenuSectionList,Qa);return gb};c.prototype.Xpg=function(pb,gb,Qa){if(gb){var eb="Data.ConvertToLinkedEntityMenuItem_"+gb.Name,xb=this.convertToLinkedEntityManager.tP(gb.DomainId);xb&&(gb=Object.assign(new td.a,{Id:eb,ExternalId:eb,Command:"-1662108744",LabelText:gb.Name,Alt:gb.SuperTip,Visible:!0,MenuItemId:b(870).ConvertToLinkedEntityManager.VZa(gb.DomainId),Image16by16:Qa,Image16by16Class:this.NSh(xb.FontLocator)}),
Array.add(pb.ControlList,gb))}};c.prototype.Qrh=function(pb,gb){var Qa={};Qa=(Qa.width=24,Qa["min-width"]=24,Qa.height=24,Qa);var eb={};return Object.assign(new Oc.a,{Id:b(870).ConvertToLinkedEntityManager.pBe+pb.toString(),ExternalId:b(870).ConvertToLinkedEntityManager.pBe+pb.toString(),MenuItemId:b(870).ConvertToLinkedEntityManager.P1c+pb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.d0e(gb.FontLocator),LabelText:gb.Name,PreviewIconStyle:(eb.root=Qa,eb),
Alt:this.U8c(gb)})};c.prototype.hAg=function(pb){switch(pb){case "Animal":return sc.a.Fwg;case "Apple":return sc.a.Bxg;case "Atom":return sc.a.azg;case "Beaker":return sc.a.cBg;case "Bridge":return sc.a.xCg;case "Cat":return sc.a.yIg;case "City":return sc.a.FKg;case "Constellation":return sc.a.pPg;case "Dog":return sc.a.d5g;case "Finance":return sc.a.TAg;case "GradCap":return sc.a.TLh;case "HumanAnatomy":return sc.a.aSh;case "LocationPointer":return sc.a.ubi;case "Map":return sc.a.mCi;case "MedicineNeedle":return sc.a.dhi;
case "Mountain":return sc.a.Lii;case "Movie":return sc.a.aji;case "Music":return sc.a.nji;case "OuterSpace":return sc.a.VCi;case "Planet":return sc.a.OFi;case "Satellite":return sc.a.M0i;case "WolframGeneric":return sc.a.N_i;default:return sc.a.QQg}};c.prototype.NSh=function(pb){if("PowerBIRibbon"!==pb)return X.a.Z3c;switch(pb){case "AnimalRibbon":return X.a.jfh;case "AppleRibbon":return X.a.kfh;case "AtomRibbon":return X.a.lfh;case "BeakerRibbon":return X.a.mfh;case "BridgeRibbon":return X.a.nfh;
case "CenterMapRibbon":return X.a.ofh;case "CityRibbon":return X.a.pfh;case "CurrencyRibbon":return X.a.qfh;case "ExerciseRibbon":return X.a.rfh;case "FinanceRibbon":return X.a.nHe;case "FirstAidRibbon":return X.a.sfh;case "GlobeLightningRibbon":return X.a.tfh;case "GradCapRibbon":return X.a.ufh;case "HumanAnatomyRibbon":return X.a.vfh;case "LeafRibbon":return X.a.wfh;case "LocationPointerRibbon":return X.a.yfh;case "MapRibbon":return X.a.lHe;case "MountainRibbon":return X.a.zfh;case "MovieRibbon":return X.a.Afh;
case "MusicRibbon":return X.a.Bfh;case "NotablePeopleRibbon":return X.a.Cfh;case "OuterSpaceRibbon":return X.a.Dfh;case "PartlySunnyWeatherRibbon":return X.a.Efh;case "PowerBIRibbon":return X.a.mHe;case "SatelliteRibbon":return X.a.Ffh;case "WolframGenericRibbon":return X.a.xfh;case "YogaRibbon":return X.a.Hfh;default:return X.a.kHe}};c.prototype.d0e=function(pb){switch(pb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";
case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";
case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};c.prototype.Wrh=function(pb,gb){gb=this.Va.cA("ConvertToLinkedEntitySection_"+gb,this.Pmd,this.Omd);for(var Qa=!1,eb=Ml(pb.DomainIds),xb=eb.next();!xb.done;xb=eb.next()){var dc=xb.value;(xb=this.convertToLinkedEntityManager.tP(dc))&&!xb.DomainBlocked&&
xb.ShowInRibbon&&(Qa=xb.Name,dc=b(870).ConvertToLinkedEntityManager.VZa(dc),gb.jt("Data.ConvertToLinkedEntityMenuItem_"+dc,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,dc,this.d0e(xb.FontLocator),void 0,void 0,this.U8c(xb),Qa),Qa=!0)}if(!Qa)return null;gb=gb.UXb(!0);eb=this.Va.Vc();eb.title=pb.Name;pb=eb.XXb();Array.add(pb.ControlList,gb);return pb};c.prototype.lSh=function(pb){return"Stocks"===pb?"Bank_32":"Geography"===pb?"OpenMap_32":"ConvertToEntity_32"};c.prototype.Vwj=function(){this.Pmd=
5;this.Omd="Size112by64"};c.prototype.U8c=function(pb){return Ab.a.na(pb.RibbonTooltipHeader)?pb.RibbonTooltip:pb.RibbonTooltipHeader+"\n\n"+pb.RibbonTooltip};Object(D.a)(c,"ConvertToLinkedEntityMenuRenderer",null,[479]);var ic=b(55),Ga=b(127),cb=b(173),Tb=b(76);d.prototype.cGh=function(){this.Icd||(B.ULS.sendTraceTag(571274630,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),na.S(this.$.ra.xa,0,Object(L.a)(this,this.wxi,"onReadRoamingStringSuccess"),
Object(L.a)(this,this.Drf,"onRoamingOperationFailure"),null,null))};d.prototype.p6f=function(pb){pb&&pb.length?this.Icd?(pb=this.d5i(pb),Ab.a.na(pb)?B.ULS.sendTraceTag(571274628,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):(B.ULS.sendTraceTag(571274627,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),na.nb(this.$.ra.xa,0,pb,Object(L.a)(this,this.OBi,"onWriteRoamingStringSuccess"),Object(L.a)(this,
this.Drf,"onRoamingOperationFailure"),null,null))):this.Gcd=!0:B.ULS.sendTraceTag(571274629,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};d.prototype.d5i=function(pb){if(!pb||!pb.length)return B.ULS.sendTraceTag(571274626,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var gb=[];pb=Ml(pb);for(var Qa=pb.next();!Qa.done;Qa=pb.next()){Qa=Qa.value;var eb={};eb.Id=Qa.Id;Qa.StringId&&(eb.StringId=Qa.StringId);
gb.push(eb)}pb=new Sys.StringBuilder;pb.append("<DataTypes>");pb.append(ic.a.Oc(gb));pb.append("</DataTypes>");gb=pb.toString();return 1906<gb.length?(B.ULS.sendTraceTag(571274625,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):gb};d.prototype.jEi=function(pb){if(Ab.a.na(pb))return B.ULS.sendTraceTag(571274624,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!pb.startsWith("<DataTypes>")||!pb.endsWith("</DataTypes>"))return B.ULS.sendTraceTag(571274595,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;pb=pb.substring(11,pb.length-12);if(Ab.a.na(pb))return B.ULS.sendTraceTag(571274594,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;var gb=[];try{gb=ic.a.gi(pb)}catch(Qa){return B.ULS.sendTraceTag(571274593,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",Qa.message),null}B.ULS.sendTraceTag(571274592,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",
gb.length);return gb};d.prototype.Ehi=function(pb){var gb=this.vya.HDb,Qa=this.vya.jOi;if(gb.length!==Qa){for(var eb=0;eb<pb.length&&gb.length<Qa;++eb){var xb=pb[eb];this.vya.tP(xb)&&!Array.contains(gb,xb)&&gb.push(xb)}this.vya.HDb=gb}};d.prototype.wxi=function(pb){B.ULS.sendTraceTag(571274591,0,50,"OnReadRoamingStringSuccess called.");this.Icd=!0;if(ec.a.eh(pb.Errors))B.ULS.sendTraceTag(571274590,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",ec.a.fd(pb.Errors));else{var gb=
0,Qa=[],eb=!1;try{if(!pb.Result)return;var xb=pb.Result;if(Ab.a.na(xb)){B.ULS.sendTraceTag(571274589,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Qa=this.jEi(xb);if(!Qa||!Qa.length)return;gb=Qa.length;this.Ehi(Qa);this.vya.cIf();B.ULS.sendTraceTag(557672200,0,50,"OnReadRoamingStringSuccess MruCount:{0}",this.vya.HDb.length);if(zc.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var dc=Ml(this.vya.HDb),Nc=dc.next();!Nc.done;Nc=dc.next())if(1===
(Nc.value.Id&1048320)>>8){eb=!0;break}B.ULS.sendTraceTag(556351650,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",eb)}}finally{B.ULS.sendTraceTag(541181405,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",gb),pb=[],pb.push(Object.assign(new Tb.a,{name:"MruCount",int64:gb})),pb.push(Object.assign(new Tb.a,{name:"MruWolframAvailable",bool:eb})),cb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,pb)}this.Gcd&&(this.p6f(this.vya.HDb),this.Gcd=!1)}};d.prototype.OBi=function(pb){B.ULS.sendTraceTag(571274588,
0,50,"OnWriteRoamingStringSuccess called.");ec.a.eh(pb.Errors)?B.ULS.sendTraceTag(571274587,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",ec.a.fd(pb.Errors)):pb.Result&&(pb.Result||B.ULS.sendTraceTag(571274586,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};d.prototype.Drf=function(pb,gb,Qa){pb=Ga.a.Eg(pb.data);B.ULS.sendTraceTag(571274585,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",Qa,ec.a.fd(pb))};Object(D.a)(d,
"LinkedDataTypeRoamingHandler",null,[]);var Bb=b(519),nc=b(57),Gc=b(58),La=b(248),Wa=b(35),wa=b(44),Da=b(26),Va=b(303),Jb=b(9),Hb=b(1069),Mb=b(107);b.d(F,"ConvertToLinkedEntityManager",function(){return a});var Ub=ea.a;Cm(a,Ub);a.prototype.ed=function(pb,gb){gb.pc&&!gb.mdc&&this.showUntrustedImageBusinessBarIfNecessary()};a.prototype.dispose=function(){(this.ewb||this.s3a||this.k4a)&&this.$.fa.ow(Object(L.a)(this,this.hg,"onWorkbookMetadataChanged"));zc.EwaSettings.ka(706)&&this.$.fa.xk(Object(L.a)(this,
this.ed,"onSessionIdChanged"));!this.d9&&zc.EwaSettings.ka(132)&&zc.EwaSettings.ka(141)&&this.gridView.Ps(Object(L.a)(this,this.onContentReady,"onContentReady"));this.cn&&this.cn.dispose();this.Cva&&this.$.AH(Object(L.a)(this,this.kk,"onContentAreaResized"));this.Bvb&&(this.$.nl(Object(L.a)(this,this.sd,"onWorkbookOpened")),this.s3a&&(this.bgd=null));this.zg=null;C.a.Ia(this.Axa)};a.prototype.Ysg=function(pb){this.addHandler("LinkedEntityConverted",pb)};a.prototype.oUi=function(pb){this.removeHandler("LinkedEntityConverted",
pb)};a.prototype.selectEntity=function(pb){return this.cn?this.cn.selectEntity(pb):!1};a.prototype.searchEntity=function(pb,gb){this.cn&&this.cn.searchEntity(pb,gb)};a.prototype.DFd=function(pb,gb,Qa,eb){this.cn&&this.cn.searchEntity(pb,gb,!0,Qa,eb)};a.prototype.kzb=function(pb){return this.cn?this.cn.kzb(pb):!1};a.prototype.onPaneClosed=function(){if(this.cn)this.cn.onPaneClosed()};a.prototype.cancelSearch=function(){this.cn&&this.cn.cancelSearch()};a.prototype.selectDataType=function(pb){this.cn&&
this.cn.selectDataType(pb)};a.prototype.showHelpArticle=function(pb){this.cn&&this.cn.showHelpArticle(pb)};a.prototype.showSurveyDialog=function(pb){this.cn&&this.cn.showSurveyDialog(pb)};a.prototype.insertTable=function(pb,gb){this.cn&&this.cn.insertTable(pb,gb)};a.prototype.IOh=function(pb){if(this.$.isEditMode&&this.jJf!==pb&&H.AFrameworkApplication.ha.ta("SupportsPolicies")){this.jJf=pb;B.ULS.sendTraceTag(561628898,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
pb=this.$.ra.xa;var gb=Object(L.a)(this,this.sti,"onGetRichDataClassificationLabelsSuccess"),Qa=pb.Ra(1,null);na.i(pb,"GetRichDataClassificationLabels",Qa,gb,null,null,null,4)}};a.prototype.sti=function(pb){if(pb.Result){var gb=pb.Result;if(gb&&gb.length){B.ULS.sendTraceTag(561628895,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",gb.length);var Qa=Gc.GetServiceTaskFactory.Xa(this.$.ea,274,275,0,"Microsoft.Office.Excel.WebUI.Client.Policy.IPolicyManagerWrapper");Wa.TaskExtensions.Da(Qa,
function(){Qa.result.JRc(gb,2)||B.ULS.sendTraceTag(559941251,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ma,3)}}else B.ULS.sendTraceTag(561628896,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};a.prototype.hg=function(){this.ewb&&(this.tsj(),this.NNh(this.$.fa.Gn.LinkedEntityAsyncRefreshStateId));this.k4a?this.IOh(this.$.fa.Gn.RichDataClassificationLabelStateId):this.s3a&&this.mPd(!0)};a.prototype.tCe=function(){function pb(Qa,
eb,xb){var dc=gb.$.ra.xa;Qa=vb.b(Qa,Object(L.a)(gb,gb.gri,"onEnableUntrustedImageUrlsFromServerSuccess"));var Nc=dc.Ra(1,null);return na.i(dc,"LinkedEntitiesEnableUntrustedImages",Nc,Qa,eb,xb,null,0)}var gb=this;zc.EwaSettings.wc()?this.$.userOperationManager.oc(new E.a(589,0,pb,80),null):this.$.userOperationManager.oc(new Bb.a(589,0,pb,16),null)};a.prototype.gri=function(){this.bQd=!0;this.cn&&this.cn.fPi()};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.bQd||this.G1f||!this.$.fa.pc||
this.i4i()};a.prototype.i4i=function(){function pb(Qa,eb,xb){var dc=gb.$.ra.xa;Qa=vb.b(Qa,Object(L.a)(gb,gb.Qsi,"onGetHasUntrustedImageUrlsFromServerSuccess"));var Nc=dc.Ra(1,null);return na.i(dc,"GetHasUntrustedImageUrls",Nc,Qa,eb,xb,null,4)}var gb=this;zc.EwaSettings.wc()?this.$.userOperationManager.oc(new E.a(588,0,pb,80),null):this.$.userOperationManager.oc(new Bb.a(588,0,pb,16),null)};a.prototype.Qsi=function(pb){if(pb&&!Va.a(pb))try{pb.Result.HasUntrustedImageUrl&&(this.businessBar.tg(57,null),
this.G1f=!0)}catch(gb){B.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",gb)}};a.prototype.mPd=function(pb){var gb=this;if(this.s3a&&null==this.bgd&&!this.k4a&&H.AFrameworkApplication.ha.ta("SupportsPolicies")&&null!=this.OKa&&this.OKa&&(!pb||this.$.workbookContext.Options&262144)){var Qa=Gc.GetServiceTaskFactory.Xa(this.$.ea,274,275,0,"Microsoft.Office.Excel.WebUI.Client.Policy.IPolicyManagerWrapper");
Wa.TaskExtensions.Da(Qa,function(){gb.bgd=Qa.result.hDf(2)},this.$.ma,3)}};a.prototype.RQg=function(pb){(pb=this.h5g(pb))?this.convertToLinkedEntity(pb):B.ULS.sendTraceTag(593241931,0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(pb){B.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",pb.Id);if(this.gridView){var gb=this.gridView.ga.ya.Xd,Qa=gb.Of(this.gridView.kJ);this.Fva&&
this.jgd&&this.Iqg(pb);if(Qa){Qa=this.gridView.kc.t7e(Qa);if(!this.KYe(pb)&&this.Z6e(pb.Id)){B.ULS.sendTraceTag(588001754,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(nc.a.Nf.dH){gb=this.k8c();if(!gb){B.ULS.sendTraceTag(588001753,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.i0b();if(!Qa){B.ULS.sendTraceTag(588001752,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var eb={};
eb=(eb.InputMethod=va.a.Yb,eb);eb.CalloutName=3;eb.Target=gb;eb.RibbonButtonLabel=zc.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.$If(pb):this.mxb(pb.Id.toString());eb.ExampleEntities=this.fIe(pb);this.$.Na.Xb(Qa,eb);return}B.ULS.sendTraceTag(588001751,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Z6e(pb.Id)&&!pb.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.VZa(pb));
else{if(Qa){B.ULS.sendTraceTag(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.Tmj(pb)){gb=Kb.r(this.gridView.ga.ya.selectedRanges,this.$);this.cn.Y9h(gb,pb);return}if(nc.a.Nf.dH){gb=this.k8c();if(!gb){B.ULS.sendTraceTag(588001756,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.i0b();if(!Qa){B.ULS.sendTraceTag(588001755,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}eb={};eb=(eb.InputMethod=va.a.Yb,eb);eb.CalloutName=2;eb.Target=gb;eb.RibbonButtonLabel=this.$If(pb);eb.ExampleEntities=this.fIe(pb);eb.BlankCellResourceId=this.GBg(pb);eb.HasBlankCellWalkthrough=this.uPh(pb);eb.ServiceDomain=pb.Id;this.$.Na.Xb(Qa,eb);return}B.ULS.sendTraceTag(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.ZXc(pb,!1,gb)}}}else B.ULS.shipAssertTag(34415005,
0,!1,"grid view should not be null")};a.prototype.vaf=function(){if(!this.Uaf&&this.zvb()&&!this.Wgd())if(cb.a("DataTabActive"),nc.a.Nf.dH)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var pb=this.i0b();if(pb){var gb={};gb.InputMethod=va.a.Yb;gb.CalloutName=8;gb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Na.Xb(pb,gb);this.Uaf=!0}else B.ULS.sendTraceTag(558690318,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else B.ULS.sendTraceTag(558690319,
0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else B.ULS.sendTraceTag(558690320,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.d9&&this.d9.Q_b()};a.prototype.onAutoDetectUIShown=function(){function pb(Qa,eb,xb){var dc=gb.$.ra.xa,Nc=dc.Ra(1,null);return na.i(dc,"OnAutoDetectUIShown",Nc,Qa,eb,xb,null,4)}var gb=this;
zc.EwaSettings.wc()?ia.a(this.$.userOperationManager,pb,function(Qa){return new E.a(230,0,Qa,80)},null):ia.a(this.$.userOperationManager,pb,function(Qa){return new Bb.a(230,0,Qa,16)},null)};a.prototype.ZXc=function(pb,gb,Qa){function eb(){return new Ua.a}var xb=this,dc=Kb.q(Qa,this.$);ia.a(this.$.userOperationManager,function(Nc,Pc,Fd){var Ea=xb.$.ra.xa;Nc=vb.b(Nc,Object(L.a)(xb,xb.jqi,"onConvertToLinkedEntitySuccess"),Object(L.a)(xb,xb.Ozi,"onSuccessScreenReaderSaysConverted"),Object(L.a)(xb.cn,
xb.cn.iqi,"onConvertToLinkedEntitySucceeded"));var Xa=Ea.Ra(1,null);Xa.selectedRanges=dc;Xa.domainId=pb;Xa.autodetect=gb;return na.i(Ea,"ConvertToLinkedEntity",Xa,Nc,Pc,Fd,null,4)},function(Nc){return new E.a(115,0,Nc,void 0,eb)},null)};a.prototype.Iqg=function(pb){if(this.Fva&&this.jgd){var gb={};gb.Id=pb.Id;pb.StringId&&(gb.StringId=pb.StringId);if(!(0<this.OJ.length&&this.OJ[0].Id===gb.Id&&this.OJ[0].StringId===gb.StringId)){pb=!1;Array.insert(this.OJ,0,gb);for(var Qa=1;Qa<this.OJ.length;++Qa)if(this.OJ[Qa].Id===
gb.Id&&this.OJ[Qa].StringId===gb.StringId){Array.removeAt(this.OJ,Qa);pb=!0;break}for(;5<this.OJ.length;)Array.removeAt(this.OJ,this.OJ.length-1);this.Xaa.Categories[a.l5a].DomainIds=this.OJ;this.cIf();this.sjd&&!pb&&this.CEd.p6f(this.OJ)}}};a.prototype.jqi=function(pb){ec.a.eh(pb.Errors)||(this.k4a||this.mPd(!1),this.raiseEvent("LinkedEntityConverted"))};a.prototype.Ozi=function(){this.$.ea.ub(211,function(pb){pb.readText(za.a.instance.da(1735))})};a.prototype.convertLinkedEntityToText=function(){var pb=
this;B.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var gb=Kb.q(this.gridView.ga.ya.Xd,this.$);ia.a(this.$.userOperationManager,function(Qa,eb,xb){var dc=pb.$.ra.xa,Nc=dc.Ra(1,null);Nc.selectedRanges=gb;return na.i(dc,"ConvertLinkedEntityToText",Nc,Qa,eb,xb,null,4)},function(Qa){return new E.a(116,0,Qa)},null)}else B.ULS.shipAssertTag(34719502,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=
function(){var pb=this;B.ULS.sendTraceTag(572555984,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(kc.g(this.$)){this.$.isEditMode||B.ULS.sendTraceTag(572555982,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.EBd();var gb=Kb.r(this.gridView.ga.ya.selectedRanges,this.$);ia.a(this.$.userOperationManager,function(Qa,eb,xb){var dc=pb.$.ra.xa,Nc=dc.Ra(1,null);Nc.selectedRanges=gb;return na.i(dc,
"RefreshLinkedEntitiesInRange",Nc,Qa,eb,xb,null,4)},function(Qa){return new E.a(248,0,Qa)},null)}else B.ULS.shipAssertTag(572555983,0,!1,"grid view should not be null")};a.prototype.Xcj=function(){return this.MRf(this.U_a)};a.prototype.Wcj=function(){return this.MRf(this.B0a)};a.prototype.MRf=function(pb){try{if(2===this.Uq&&pb){var gb=this.w1c(parseInt(pb));return!gb||!gb.ShowInRibbon}}catch(Qa){B.ULS.sendTraceTag(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+
pb)}return!0};a.prototype.hej=function(pb){pb=this.tP(pb.DomainId);if(!pb||pb.DomainBlocked||zc.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!pb.HasCuratedData)return!1;if(this.e3h){for(var gb=Ml(this.RL),Qa=gb.next();!Qa.done;Qa=gb.next())if(Qa=Qa.value,Qa.value.DomainId.Id===pb.DomainId.Id&&Qa.value.ShowInRibbon)return!0;return!1}return pb.ShowInRibbon};a.prototype.Tcj=function(pb){return 2!==this.Uq||!this.b$[pb]};a.prototype.Vcj=function(){if(this.Cva)return B.ULS.sendTraceTag(592213150,
0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.RL)return!0;if(null!=this.mYb)return this.mYb;for(var pb=0,gb=Ml(this.RL),Qa=gb.next();!Qa.done;Qa=gb.next())Qa.value.value.DomainBlocked||++pb;return this.mYb=2>=pb};a.prototype.launchDisambiguationPaneForSearch=function(){this.cn&&this.cn.launchDisambiguationPaneForSearch()};a.prototype.gd=function(pb,gb,Qa){if("PopulateConvertToLinkedEntityMenu"!==gb)return!1;this.j7c=Qa.MenuId;if(!this.Uq||3===this.Uq)return this.oGi(),
!0;if(this.Cva)if(this.Xaa){if(this.RL)return this.wL=this.wL||this.YLa.rrh(this.Xaa,Qa.MenuId),Qa.MenuItems=this.wL,this.jgd=!0;B.ULS.sendTraceTag(593264904,0,10,"PopulateMenu: Encountered null domain collection")}else B.ULS.sendTraceTag(593264905,0,10,"PopulateMenu: Encountered null ribbon section info");this.wL=this.wL||this.YLa.qrh(this.Zva,Qa.MenuId);Qa.MenuItems=this.wL;return!0};a.prototype.oGi=function(){var pb=this;-1===this.P9b&&(this.vNa(),this.P9b=window.setInterval(function(){pb.vNa()},
2E3))};a.prototype.vNa=function(){if(this.$.fa.pc&&2!==this.Uq)if(this.lJa--,B.ULS.sendTraceTag(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Uq=1,this.Cva){var pb=this.$.ra.xa,gb=Object(L.a)(this,this.xnf,"onGetLinkedEntityServiceDomainsSuccess"),Qa=Object(L.a)(this,this.wnf,"onGetLinkedEntityServiceDomainsFailure"),eb=pb.Ra(1,null);na.i(pb,"GetLinkedEntityMetadata",eb,gb,Qa,null,null,4)}else pb=this.$.ra.xa,gb=Object(L.a)(this,this.xnf,"onGetLinkedEntityServiceDomainsSuccess"),
Qa=Object(L.a)(this,this.wnf,"onGetLinkedEntityServiceDomainsFailure"),eb=pb.Ra(1,null),na.i(pb,"GetLinkedEntityServiceDomains",eb,gb,Qa,null,null,4)};a.prototype.Wgd=function(){return this.$.isEditMode&&2!==this.Uq&&(0<=this.lJa||!this.bNa)};a.prototype.IQd=function(pb){H.AFrameworkApplication.Ng?B.ULS.sendTraceTag(587530655,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):R.a(this.$)?(this.BQd(),pb&&this.$.If()):B.ULS.sendTraceTag(587530654,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};
a.prototype.FDd=function(pb){this.ztb=this.Lzb=0;this.lJa=8;this.bNa=!1;this.Uq=this.P9b=0;this.Zva=this.Xaa=null;this.tZb();for(var gb=0;gb<this.VLa;++gb)this.b$[gb]=null;pb&&fb.a.fwb()&&this.zvb()&&this.IQd(!0)};a.prototype.sd=function(pb,gb){B.ULS.sendTraceTag(575948507,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");gb.kQ?B.ULS.sendTraceTag(575948506,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.tpe():this.FDd(!0),
zc.EwaSettings.ka(706)&&this.bQd&&this.tCe())};a.prototype.tZb=function(){this.wL=null};a.prototype.zvb=function(){var pb=ja.a.yDb,gb=R.a(this.$);return!!gb&&gb.Hn.wo===pb};a.prototype.xnf=function(pb){var gb=this;this.tZb();if(pb.Result){if(this.Cva){pb=pb.Result;var Qa=pb.DomainDataArray;this.Xaa=pb.Ribbon;if(this.Fva&&this.Xaa){var eb={};eb.Name=za.a.instance.da(1725);eb.DomainIds=this.OJ;Array.insert(this.Xaa.Categories,a.l5a,eb)}0<pb.MaximumCellsToConvert&&(this.H3d=pb.MaximumCellsToConvert)}else Qa=
pb.Result;this.Uq=2;pb=!1;if(Qa){B.ULS.sendTraceTag(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Qa.length);this.Zva||(this.Zva=[]);eb=za.a.instance.da(1722);var xb=za.a.instance.da(1724);Qa=Ml(Qa);for(var dc=Qa.next();!dc.done;dc=Qa.next())if(dc=dc.value,dc.DomainId)if(this.Zva.push(dc),dc.DomainBlocked){var Nc=!!dc.DomainId.StringId;B.ULS.sendTraceTag(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",Nc?dc.DomainId.Id.toString():
dc.Name,Nc)}else this.RL.ja(a.VZa(dc.DomainId),dc),dc.Name===eb||268435456===dc.DomainId.Id?this.U_a=dc.DomainId.Id.toString():dc.Name===xb||536870912===dc.DomainId.Id?this.B0a=dc.DomainId.Id.toString():268435712===dc.DomainId.Id&&dc.ShowInRibbon&&(this.WTc=!0),pb=!0;else B.ULS.sendTraceTag(593291469,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}pb||(this.Zva=null);this.r2f();this.sjd&&this.CEd.cGh();this.g_f||(this.qsj(),this.g_f=!0)}else this.Zva=null,this.Uq=3,this.lJa>(this.Bvb?
-1:0)&&(pb=0,this.Bvb&&(pb=100*(8-this.lJa)),window.setTimeout(function(){gb.vNa()},pb)),B.ULS.sendTraceTag(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.lmc();this.pve();this.WTc&&this.Z5e&&La.b(Object(L.a)(this,this.vaf,"launchLinkedEntityGalleryCallout"),this.$.ma,500);this.s3a&&!this.k4a&&this.mPd(!0)};a.prototype.wnf=function(pb){pb=Ga.a.Eg(pb.data);B.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",ec.a.fd(pb));this.Zva=
null;this.Uq=3;this.Bvb&&(this.bNa=!0);this.lmc()};a.prototype.r2f=function(){if(this.Xaa){var pb=0;if(this.Fva){var gb=-1,Qa=-1,eb=0,xb=0,dc=0,Nc=0,Pc=[null,null,null,null,null],Fd=Ml(this.Xaa.Categories);for(hc=Fd.next();!hc.done;hc=Fd.next()){var Ea=!1;hc=Ml(hc.value.DomainIds);for(Xb=hc.next();!Xb.done;Xb=hc.next()){Xb=Xb.value;var Xa=this.tP(Xb);Xa&&!Xa.DomainBlocked&&Xa.ShowInRibbon&&(pb<this.VLa?(this.b$[pb]=Xb,xb===a.l5a&&(-1===gb&&(gb=pb),Qa=pb,Nc=Qa-gb+1),++pb):pb===this.VLa&&eb<Nc&&xb!==
a.l5a&&(Pc[eb]=Xb,++eb),Ea=!0)}Ea&&++dc;++xb}if(-1<gb&&dc<=a.Waf){for(;Qa>=gb;--Qa)Array.removeAt(this.b$,Qa);for(gb=0;gb<Nc;++gb)Array.insert(this.b$,pb+gb,Pc[gb])}}else{Nc=Ml(this.Xaa.Categories);for(var hc=Nc.next();!hc.done;hc=Nc.next()){Pc=Ml(hc.value.DomainIds);for(var Xb=Pc.next();!Xb.done&&!(gb=Xb.value,(Qa=this.tP(gb))&&!Qa.DomainBlocked&&Qa.ShowInRibbon&&(this.b$[pb]=gb,++pb,pb>=this.VLa));Xb=Pc.next());if(pb>=this.VLa)break}}for(;pb<this.VLa;)this.b$[pb]=null,++pb}};a.prototype.onContentReady=
function(){this.u0f()&&this.gridView.Ps(Object(L.a)(this,this.onContentReady,"onContentReady"))};a.prototype.u0f=function(){var pb=Object(P.a)(453,kc.g(this.$).Ha),gb=this.gridView.ga.Ze;return pb&&pb.scd&&1===gb&&this.gridView.ga.ya.activeCell?(pb=Gc.GetServiceTaskFactory.Xa(this.$.ea,12,477,1,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),this.d9=new ba.a(this.$,this.svgIconProvider,pb.result,this),!0):!1};a.prototype.a$h=function(){this.cn&&this.cn.mmd(!0)};
a.prototype.launchLinkedEntityDataTypeSelectorPane=function(pb){if(this.cn)if(pb=this.x1c(pb))if(pb.DomainId.StringId)B.ULS.sendTraceTag(593097798,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var gb=Kb.r(this.gridView.ga.ya.selectedRanges,this.$);this.cn.launchLinkedEntityDataTypeSelectorPane(gb,pb.DomainId.Id)}else B.ULS.sendTraceTag(593097799,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.uPg=function(){return this.DXc(this.U_a)};
a.prototype.tPg=function(){return this.DXc(this.B0a)};a.prototype.DXc=function(pb){var gb=this.MSh(pb),Qa=W.a.gg(this.mxb(pb));pb=W.a.gg(this.tOd(pb));return a.Vqh(gb,tc.a.Ee(11),Qa,pb)};a.prototype.tOd=function(pb){try{return this.w1c(parseInt(pb)).Description}catch(gb){}return za.a.instance.da(1719)};a.prototype.mxb=function(pb){try{return this.w1c(parseInt(pb)).Name}catch(gb){}return za.a.instance.da(1705)};a.prototype.$If=function(pb){try{return this.tP(pb).Name}catch(gb){}return this.mxb(pb.Id.toString())};
a.prototype.GBg=function(pb){try{return this.tP(pb).BlankCellResourceId}catch(gb){}return null};a.prototype.uPh=function(pb){try{return this.tP(pb).HasBlankCellWalkthrough}catch(gb){}return!1};a.prototype.KYe=function(pb){try{var gb=a.VZa(pb);if(this.RL.tb(gb))return this.RL.oa(gb).HasCuratedData}catch(Qa){}return!1};a.prototype.Tmj=function(pb){try{return this.tP(pb).SupportsStarterData}catch(gb){}return!1};a.prototype.Z6e=function(pb){return 268435968===pb};a.prototype.k8c=function(){return 2===
R.a(this.$).jN?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.i0b=function(){return new Za.a(-847286761,va.a.Yb,this.$.jd,0,ja.a.XQ)};a.prototype.pve=function(){if(this.zvb()&&!this.Wgd()&&!this.N4e&&zc.EwaSettings.ka(464)&&this.KYe({Id:268435968,StringId:null}))if(B.ULS.sendTraceTag(574997530,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),nc.a.Nf.dH){var pb=this.k8c();if(pb){var gb=
this.i0b();if(gb){var Qa={};Qa=(Qa.InputMethod=va.a.Yb,Qa);Qa.CalloutName=6;Qa.Target=pb;Qa.ShouldCanvasTakeFocus=!0;this.$.Na.Xb(gb,Qa);this.N4e=!0}else B.ULS.sendTraceTag(574997528,0,10,"RibbonCommandInfo is null for firstOrgData")}else B.ULS.sendTraceTag(574997529,0,10,"CalloutAnchorElement is null for firstOrgData")}else B.ULS.sendTraceTag(574997527,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};
a.prototype.jSh=function(pb){pb=this.x1c(pb);return pb?this.YLa.hAg(pb.SubdomainFontLocator):(B.ULS.sendTraceTag(576057797,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.qvb=function(pb){return this.d9?this.d9.gAg(pb):!1};a.prototype.Wth=function(){return this.d9?this.d9.Juh():""};a.prototype.VZh=function(){return this.d9?this.d9.Rxb:!1};a.prototype.wyh=function(pb,gb){var Qa=this.N0e(pb);if(0>Qa)B.ULS.sendTraceTag(592843911,
0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",pb);else if(pb=(pb=this.yAe(pb))?this.tP(pb):null)gb[S.a.GalleryButtonProps]=this.YLa.Qrh(Qa,pb),gb[S.a.Alt]=this.YLa.U8c(pb)};a.prototype.cIf=function(){this.r2f();fb.a.fwb()&&this.zvb()&&this.IQd(!0);this.tZb()};a.prototype.MSh=function(pb){return pb===this.U_a?X.a.nHe:pb===this.B0a?X.a.lHe:X.a.kHe};a.prototype.fIe=function(pb){try{return this.tP(pb).ExampleEntities}catch(gb){}return za.a.instance.da(1727)};a.prototype.lmc=function(){(0>
this.lJa||this.bNa)&&B.ULS.sendTraceTag(37089859,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Uq||0>this.lJa||this.bNa)&&window.clearInterval(this.P9b);fb.a.fwb()&&!this.Wgd()?this.IQd(this.zvb()):this.j7c&&this.$.frame.yw(this.j7c)};a.prototype.jc=function(pb){return this.$.Mb+pb};a.prototype.BQd=function(){if(this.Cva){var pb=!0,gb=Array(this.VLa),Qa=R.a(this.$)?R.a(this.$).Hn:null;if(Qa){for(var eb=0;eb<gb.length;++eb)this.Tcj(eb)?gb[eb]=!0:pb=gb[eb]=
!1;Qa.JHd(["ConvertToLinkedEntityGallery"],pb);if(!pb)for(pb=0;pb<gb.length;++pb)gb[pb]&&Qa.JHd([this.vyh(pb)],!0)}else B.ULS.sendTraceTag(587530653,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}else gb=this.Xcj(),Qa=this.Wcj(),pb=gb&&Qa,this.Drb||this.HIb||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToLinkedEntityGallery",pb?!0:!1)),pb?this.Drb=this.HIb=!0:(gb?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",
!0)),this.HIb=!0):Qa&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)),this.Drb=!0),this.Vcj()&&Jb.HelperMethods.Xcd("ConvertToLinkedEntityGallery-previewExpandButton"))};a.prototype.tP=function(pb){var gb=a.VZa(pb);if(this.RL.tb(gb))return this.RL.oa(gb);B.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",pb.Id,!!pb.StringId);return null};a.prototype.vyh=function(pb){return"ConvertToLinkedEntityPreview"+
pb.toString()};a.prototype.CQd=function(){var pb=this;N.a.get_instance().en(10,function(){pb.pve();pb.WTc&&pb.Z5e&&La.b(Object(L.a)(pb,pb.vaf,"launchLinkedEntityGalleryCallout"),pb.$.ma,500)});fb.a.fwb()||N.a.get_instance().en(10,function(){pb.BQd()})};a.prototype.C9b=function(pb,gb){switch(pb){case "QueryLinkedEntityGalleryButtons":if(!gb[S.a.InnerHTML]){fb.a.fwb()||this.BQd();pb=gb[va.a.Vd].toString();var Qa=Ab.a.equals(pb,za.a.instance.da(1722),!0)||Ab.a.equals(pb,za.a.instance.da(1723),!0),eb=
Ab.a.equals(pb,za.a.instance.da(1724),!0);zc.EwaSettings.ka(467)?Qa||eb||this.wyh(pb,gb):!this.HIb&&Qa?(this.HIb=!0,gb[S.a.InnerHTML]=this.uPg()):!this.Drb&&eb&&(this.Drb=!0,gb[S.a.InnerHTML]=this.tPg())}break;case "QueryLinkedEntityMenuGalleryButtons":gb[S.a.InnerHTML]||(gb[S.a.InnerHTML]=this.DXc(gb[va.a.Vd]))}return gb};a.prototype.Lge=function(){zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&this.icc&&null!=this.Laa&&!this.Laa&&(B.ULS.sendTraceTag(541882391,0,
50,"AfterWolframAddinInstalled: User is entitled to the Wolfram add-in (by licensing) and has just installed it. Wolfram domains enabled and handshake refresh being done."),this.Laa=!0,this.hfg=!1,this.FDd(!1),this.imc(),this.$.Ss())};a.prototype.Yvg=function(){zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&this.icc&&(this.Laa=!1,this.FDd(!1),this.imc(),this.$.Ss())};a.prototype.h5g=function(pb){var gb;if(zc.EwaSettings.ka(467)&&(gb=this.yAe(pb)))return gb;if(gb=this.x1c(pb))return gb.DomainId;
if(zc.EwaSettings.ka(467))return B.ULS.sendTraceTag(592843910,0,10,"Could not convert key into domain: {0}",pb),null;gb=this.oCh(pb);return gb?gb={Id:gb,StringId:null}:(B.ULS.sendTraceTag(593241929,0,10,"Could not convert key into domain using fallback logic, Key: {0}",pb),null)};a.prototype.oCh=function(pb){var gb=parseInt(pb);if(0<gb)return gb;B.ULS.sendTraceTag(593241928,0,50,"Checking for specific domains, Key: {0}",pb);var Qa=za.a.instance.da(1723),eb=za.a.instance.da(1724);return pb===this.B0a||
pb===this.U_a?parseInt(pb):this.i6e(pb,Qa,"Stock")?parseInt(this.U_a):this.i6e(pb,eb,"Geography")?parseInt(this.B0a):gb};a.prototype.w1c=function(pb){var gb={};gb.Id=pb;return this.tP(gb)};a.prototype.x1c=function(pb){return this.RL.tb(pb)?this.RL.oa(pb):null};a.prototype.N0e=function(pb){if(!pb.startsWith(a.P1c))return-1;var gb=parseInt(pb.substr(a.P1c.length));return isNaN(gb)?(B.ULS.sendTraceTag(592843909,0,10,"Unexpected index in preview gallery button key: {0}",pb),-1):gb};a.prototype.yAe=function(pb){pb=
this.N0e(pb);return 0>pb?null:this.b$[pb]};a.prototype.kk=function(){this.tZb()};a.prototype.C2e=function(pb,gb,Qa){if(this.ewb&&this.RL&&this.RL.count){B.ULS.sendTraceTag(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",pb);var eb=this.$.ra.xa.dc();this.$.fa.pc&&(pb=this.$.ra.xa,gb=vb.b(Object(L.a)(this,this.pvi,"onLinkedEntityTryAutoRefreshSuccessCore"),gb),eb=pb.Ra(1,void 0===eb?null:eb),na.i(pb,"LinkedEntityTryAutoRefresh",eb,gb,Qa,null,null,0))}};a.prototype.pvi=
function(pb){if(Va.a(pb)){var gb=Gc.GetServiceTaskFactory.Xa(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");Wa.TaskExtensions.Da(gb,function(){var eb=null;pb&&pb.Errors&&(eb=pb.Errors[0]);gb.result.STf(eb,null)},this.$.ma,3);B.ULS.sendTraceTag(591147843,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",ec.a.fd(pb.Errors));var Qa=ec.a.$E(pb.Errors,[-1100324317,-2133389873],
"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.fa.Wo(Qa)}};a.prototype.qsj=function(){this.C2e("Auto-refresh on load",null,null)};a.prototype.tsj=function(){this.ewb&&this.RL&&this.RL.count&&(this.Axa?B.ULS.sendTraceTag(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.fa.Gn.HasAutoRefreshableLinkedEntityDomainsEver?(B.ULS.sendTraceTag(51659663,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Axa=wa.a.instance.create(Object(L.a)(this,this.MTc,"callPeriodicAutoRefreshCheck"),this.qXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):B.ULS.sendTraceTag(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};
a.prototype.MTc=function(){B.ULS.sendTraceTag(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.qXb);this.C2e("Periodic auto-refresh check",Object(L.a)(this,this.Coi,"onCallPeriodicAutoRefreshCheckSuccess"),Object(L.a)(this,this.Boi,"onCallPeriodicAutoRefreshCheckFailure"))};a.prototype.Coi=function(pb){Va.a(pb)?(B.ULS.sendTraceTag(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",
ec.a.fd(pb.Errors)),++this.RRc):this.RRc=0;C.a.Ia(this.Axa);this.RRc>=this.uAg?(B.ULS.sendTraceTag(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Axa=null):(B.ULS.sendTraceTag(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Axa=wa.a.instance.create(Object(L.a)(this,this.MTc,"callPeriodicAutoRefreshCheck"),
this.qXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};a.prototype.Boi=function(pb){pb=Ga.a.Eg(pb.data);T.a.na(pb)?B.ULS.sendTraceTag(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):B.ULS.sendTraceTag(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",ec.a.fd(pb));C.a.Ia(this.Axa);this.Axa=wa.a.instance.create(Object(L.a)(this,this.MTc,"callPeriodicAutoRefreshCheck"),
this.qXb,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};a.prototype.i6e=function(pb,gb,Qa){return Ab.a.contains(pb,gb,!0)||Ab.a.contains(pb,Qa,!0)};a.prototype.wwi=function(pb){pb=!!pb.Result&&pb.Result;B.ULS.sendTraceTag(591958236,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",pb.toString());pb?(B.ULS.sendTraceTag(589947468,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",Da.a.Ta.we.m-this.X1a,this.Lzb),
this.vNa()):this.BIb()};a.prototype.vwi=function(){B.ULS.sendTraceTag(591958235,0,15,"OnNotifyFeatureLicensingStatusFailed");this.BIb()};a.prototype.BIb=function(){if((!this.uKa||null!=this.fjd&&null!=this.gjd)&&this.$.fa.pc&&null!=this.OKa&&null!=this.Laa&&null!=this.tdc)if(++this.Lzb,12>=this.Lzb){1===this.Lzb&&(this.X1a=Da.a.Ta.we.m,B.ULS.sendTraceTag(589947467,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var pb=this.$.ra.xa.dc();na.N(this.$.ra.xa,this.Jaf,this.Kaf(),Object(L.a)(this,
this.wwi,"onNotifyFeatureLicensingStatusSuccess"),Object(L.a)(this,this.vwi,"onNotifyFeatureLicensingStatusFailed"),null,pb)}else B.ULS.sendTraceTag(591958231,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",Da.a.Ta.we.m-this.X1a),this.bNa=!0,this.lmc()};a.prototype.tpe=function(){if(this.$.isEditMode)if(null!=this.OKa)this.BIb();else{var pb=Da.a.Ta.we.m,gb=Array(6),Qa=this;fa.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(eb){eb.isFeatureEnabled("ExcelPowerBiPro",
!1).then(function(xb){B.ULS.sendTraceTag(590747350,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(590747349,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",xb);return Qa.OKa=xb}).then(function(){zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&(gb[0]=eb.isFeatureEnabled("ExcelWolframAddin",!1).then(function(xb){B.ULS.sendTraceTag(555053456,
0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAddin",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(555053455,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAddin",xb);return Qa.icc=xb}))}).then(function(){gb[1]=eb.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(xb){B.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",Da.a.Ta.we.m-pb);
B.ULS.sendTraceTag(590960587,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",xb);Qa.Laa=xb;var dc=Qa.icc||!1;!Qa.Laa&&dc&&zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WolframAddin",!1)&&Qa.mQh()&&(B.ULS.sendTraceTag(541882390,0,50,"CheckE5LicensingAndStartDelayedHandshake: User is entitled to the Wolfram add-in (has it installed), and is eligible to use it to get Wolfram domains (by licensing). Wolfram domains enabled."),xb=Qa.Laa=
!0);return xb})}).then(function(){gb[2]=eb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(xb){B.ULS.sendTraceTag(541331849,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(541331848,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",xb);var dc,Nc=[(dc=new Tb.a,dc.name="IsRestrictedByLicense",dc.bool=
xb,dc)];cb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Nc);Qa.kkd=xb&&zc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return xb})}).then(function(){gb[3]=eb.isFeatureEnabled("StockHistory",!1).then(function(xb){B.ULS.sendTraceTag(579081472,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(579081443,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"StockHistory",xb);Qa.tdc=xb;Qa.uKa||Qa.BIb();return xb})}).then(function(){Qa.uKa&&(gb[4]=eb.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(xb){B.ULS.sendTraceTag(558903365,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(558903364,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",xb);return Qa.fjd=xb}))}).then(function(){Qa.uKa&&(gb[5]=eb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(function(xb){B.ULS.sendTraceTag(558903363,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",Da.a.Ta.we.m-pb);B.ULS.sendTraceTag(558903362,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",xb);return Qa.gjd=xb}))}).then(function(){Qa.uKa&&Promise.all(gb).then(function(){Qa.BIb()})})})}};a.prototype.Fxi=function(pb){pb=!!pb.Result&&pb.Result;B.ULS.sendTraceTag(570769949,0,
50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",pb.toString());pb?(B.ULS.sendTraceTag(570769948,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",Da.a.Ta.we.m-this.X1a,this.ztb),this.vNa()):this.imc()};a.prototype.Exi=function(){B.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");this.imc()};a.prototype.imc=function(){++this.ztb;if(12>=this.ztb){1===this.ztb&&(this.X1a=Da.a.Ta.we.m,B.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));
var pb=this.$.ra.xa,gb=this.Jaf,Qa=this.Kaf(),eb=Object(L.a)(this,this.Fxi,"onRefreshHandshakeSuccess"),xb=Object(L.a)(this,this.Exi,"onRefreshHandshakeFailed"),dc=pb.Ra(1,null);dc.featureNames=gb;dc.isEnabledValues=Qa;na.i(pb,"RefreshLinkedEntityWebServiceHandshake",dc,eb,xb,null,null,4)}else B.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",Da.a.Ta.we.m-this.X1a),this.bNa=!0,this.lmc()};a.prototype.Kaf=function(){return this.uKa?
[this.OKa,this.Laa,this.tdc,this.fjd,this.gjd,this.kkd]:[this.OKa,this.Laa,this.tdc,this.kkd]};a.prototype.EBd=function(){this.businessBar&&this.businessBar.t3a(56)&&this.businessBar.removeEntry(56)};a.prototype.NNh=function(pb){if(this.Nmd!==pb&&this.businessBar)if(this.Nmd=pb){pb=this.$.ra.xa;var gb=Object(L.a)(this,this.Csi,"onGetErrorMessageForLinkedDataTypeRefreshSuccess"),Qa=pb.Ra(1,null);na.i(pb,"GetErrorMessageForLinkedDataTypeRefresh",Qa,gb,null,null,null,4)}else this.EBd()};a.prototype.Csi=
function(pb){pb.Result?(pb=pb.Result,Ab.a.na(pb)?B.ULS.sendTraceTag(561833537,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):(this.EBd(),this.businessBar.STf(null,pb))):B.ULS.sendTraceTag(561858696,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};a.prototype.mQh=function(){this.zg||B.ULS.sendTraceTag(544018915,0,10,"ConvertToLinkedEntityManager.HasWolframAddinEntitlement: IWebExtensionService still null after waiting for initialization tasks.");
var pb=new Hb.a(Y.a.instance);return(this.zg?this.zg.Ah.isAddinActivated("WA200002680")||this.zg.Ah.isAddinActivated("a048b5e5-dc67-4812-b114-0969772a09ec"):!1)||pb.B2h()||pb.A2h()};a.Vqh=function(pb,gb,Qa,eb){pb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',pb,gb,eb);Qa=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Qa);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',
pb,Qa)};a.VZa=function(pb){return pb.StringId?pb.Id.toString()+"."+pb.StringId:pb.Id.toString()};Jl.Object.defineProperties(a.prototype,{jOi:{configurable:!0,enumerable:!0,get:function(){return 5}},HDb:{configurable:!0,enumerable:!0,get:function(){return this.OJ},set:function(pb){this.OJ=pb}},VLa:{configurable:!0,enumerable:!0,get:function(){return this.b$.length}},$gi:{configurable:!0,enumerable:!0,get:function(){return this.H3d}},Jaf:{configurable:!0,enumerable:!0,get:function(){return this.uKa?
"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" "):["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelDisableStockGeographyDataTypes"]}}});a.pBe="ConvertToLinkedEntityPreview";a.P1c="PreviewGalleryButtonIndex.";a.l5a=0;a.Waf=2;Object(D.a)(a,"ConvertToLinkedEntityManager",ea.a,[454,455,7,456])}}]);

//# sourceMappingURL=EwaDS.le.js.map