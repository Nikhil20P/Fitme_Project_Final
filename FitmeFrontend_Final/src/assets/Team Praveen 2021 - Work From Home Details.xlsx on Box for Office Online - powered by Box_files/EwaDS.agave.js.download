(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1054:function(D,F,b){function a(){}function d(){}function c(P,ea,X,ja,R,ba){P=m.call(this,P,ea,X,ja,R,void 0===ba?null:ba)||this;P.MQb=null;return P}function m(P,ea,X,ja,R,ba){P=r.call(this,P,X,R.vW,void 0===ba?null:ba)||this;P.b4d=0;P.u0=P.VCh(ja);P.vVa=ea;P.Me=R;P.Spj=7;P.el=P.vVa.ownerDocument.createElement("div");P.el.className="ModalCalloutControlOverlay";P.el.tabIndex=0;P.vVa.insertBefore(P.el,P.vVa.firstChild);return P}
function r(P,ea,X,ja){var R=A.call(this,document.createElement("div"))||this;R.npa=null;R.Qna=null;R.NF=null;R.EF=null;R.Bw=null;R.QR=null;R.WR=null;R.zoa=!1;R.Ifb=!1;R.jp=null;R.content=null;R.u0=0;R.Qke=null;R.ZS=0;R.Dsf=null;R.G$d=P;R.X5d=ea;R.oO=X;R.pFa=ja;R.Ag=ea.ownerDocument;R.cgb=!1;R.Fu=!1;R.Kcd=!1;return R}D=b(0);var t=b(15),k=b(37),u=b(366),w=b(13),v=b(87),A=Sys.UI.Control;Cm(r,A);r.prototype.show=function(){this.cgb||(this.ETg(),this.Bj(),this.X5d.appendChild(this.uV),this.uV.style.display=
"Block",this.l$i(),this.cgb=!0,this.Dsf&&this.Dsf())};r.prototype.dismiss=function(){this.cgb&&(this.KT(),this.X5d.removeChild(this.uV),this.cgb=!1,this.pFa&&this.pFa())};r.prototype.dispose=function(){this.dismiss();this.QR=this.Bw=this.EF=this.Qna=this.NF=this.npa=null;Sys.Component.prototype.dispose.call(this)};r.prototype.hi=function(P){return this.get_element().id+P};r.prototype.ETg=function(){this.NF=this.Ag.createElement("div");this.NF.id=this.hi("WACCalloutHeader");this.NF.className="WACCalloutHeader";
this.Fu&&this.ade();this.Kcd&&this.jee();this.EF=this.Ag.createElement("div");this.EF.id=this.hi("WACCalloutContent");this.EF.className="WACCalloutContent";this.EF.style.width=190<this.u0?this.u0-26+"px":"164px";this.EF.appendChild(this.content);this.uV.appendChild(this.xXb);this.uV.appendChild(this.NF);this.uV.appendChild(this.EF)};r.prototype.ade=function(){this.Bw=this.Ag.createElement("a");this.Bw.className="WACCalloutCloseAnchor";this.Bw.id=this.hi("WACCalloutCloseAnchor");this.Bw.href="#";this.NF.appendChild(this.Bw);
var P=u.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Bw.appendChild(P)};r.prototype.jee=function(){this.QR=this.Ag.createElement("div");this.QR.className="WACCalloutTitle UIFontBold";this.QR.style.width=190<this.u0?this.u0-30+"px":"160px";this.QR.id=this.hi("WACCalloutTitle");this.QR.innerText=this.title;this.NF.contains(this.Bw)?this.NF.insertBefore(this.QR,this.Bw):this.NF.appendChild(this.QR)};r.prototype.l$i=function(){var P=
this.G$d;if(1===this.ZS){var ea=this.Qke.y+16;var X=-16}else 2!==this.ZS&&3!==this.ZS&&this.ZS?(ea=P.y-this.uV.clientHeight-15-2,X=this.uV.clientHeight-1):(ea=P.y+P.height+15,X=-15);this.uV.style.top=ea+"px";this.xXb.style.top=X+"px";1===this.ZS?(P=this.Qke.x-16,this.uV.style.left="50%",this.uV.style.marginLeft=-this.u0/2+"px",ea=Sys.UI.DomElement.getBounds(this.uV),this.xXb.style.left=P-ea.x+"px"):(ea=P.x+this.G$d.width/2,2===this.ZS||5===this.ZS?(P=20,ea-=36):this.ZS&&4!==this.ZS?(P=this.u0-20-
32,ea=ea-this.u0+36):(P=this.u0/2-16,ea-=this.u0/2),this.uV.style.left=ea+"px",this.xXb.style.left=P+"px")};r.prototype.Bj=function(){this.Fu&&!this.WR&&(this.WR=Object(k.a)(this,this.r9,"closeHandler"),this.oO.qa(w.a.click,this.Bw,this.WR,null))};r.prototype.KT=function(){this.Fu&&this.WR&&(this.oO.Ca(w.a.click,this.Bw,this.WR),this.WR=null)};r.prototype.r9=function(){this.dismiss();return!0};Jl.Object.defineProperties(r.prototype,{uV:{configurable:!0,enumerable:!0,get:function(){this.npa||(this.npa=
this.Ag.createElement("div"),this.npa.id=this.hi("WACCalloutOuter"),this.npa.className="WACCalloutOuter",this.npa.setAttribute(v.a.Wd,v.a.RWa),this.npa.style.width=this.u0+"px");return this.npa}},xXb:{configurable:!0,enumerable:!0,get:function(){if(!this.Qna){this.Qna=this.Ag.createElement("div");this.Qna.id=this.hi("WACCalloutBeakContainer");this.Qna.className="WACCalloutBeakContainer";var P="CalloutBeakTopFilled_32x16x32";if(5===this.ZS||6===this.ZS||4===this.ZS)P="CalloutBeakBottomFilled_32x16x32";
P=u.createClusteredImage(32,16,P,"WACCalloutBeak",!0,"");this.Qna.appendChild(P)}return this.Qna},set:function(P){this.Qna=P}},sKa:{configurable:!0,enumerable:!0,get:function(){return this.cgb}},title:{configurable:!0,enumerable:!0,get:function(){return this.jp},set:function(P){this.jp!==P&&(this.jp=P,this.QR&&(this.QR.innerText=this.jp))}},Fu:{configurable:!0,enumerable:!0,get:function(){return this.zoa},set:function(P){this.zoa!==P&&(this.zoa=P,this.NF&&(this.NF.contains(this.Bw)&&!this.zoa?this.NF.removeChild(this.Bw):
!this.NF.contains(this.Bw)&&this.zoa&&this.ade()))}},Kcd:{configurable:!0,enumerable:!0,get:function(){return this.Ifb},set:function(P){this.Ifb!==P&&(this.Ifb=P,this.NF&&(this.NF.contains(this.QR)&&!this.Ifb?this.NF.removeChild(this.QR):!this.NF.contains(this.QR)&&this.Ifb&&this.jee()))}}});Object(D.a)(r,"Callout",Sys.UI.Control,[310]);Cm(m,r);m.prototype.show=function(){this.sKa||(this.Me.RCb(),this.Me.QO(!1),this.el.style.zIndex=String(this.Me.s1),r.prototype.show.call(this),this.Xj(),this.b4d=
window.setTimeout(Object(k.a)(this,this.dismiss,"dismiss"),1E3*this.Spj))};m.prototype.dismiss=function(){this.sKa&&(this.Me.VL(!1),this.sm(),this.vVa&&this.vVa.contains(this.el)&&this.vVa.removeChild(this.el),r.prototype.dismiss.call(this),window.clearTimeout(this.b4d))};m.prototype.Xj=function(){this.Me.oqa(Object(k.a)(this,this.dismiss,"dismiss"));this.Me.nz.qa(w.a.click,this.el,Object(k.a)(this,this.Yc,"onClick"))};m.prototype.sm=function(){this.Me.d9a(Object(k.a)(this,this.dismiss,"dismiss"));
this.Me.nz.Ca(w.a.click,this.el,Object(k.a)(this,this.Yc,"onClick"))};m.prototype.Yc=function(){this.dismiss();return!0};m.prototype.VCh=function(P){var ea=0;switch(P){case 0:ea=190;break;case 1:ea=250;break;case 2:ea=300;break;case 3:ea=360}return ea};Object(D.a)(m,"ModalCallout",r,[]);var y=b(579),x=b(183);Cm(c,m);c.prototype.show=function(){var P=this;if(!this.sKa){var ea=Object.assign(new y.a,{onShow:function(){m.prototype.show.call(P)}});x.UISurfaces.eM().then(function(X){var ja=X.externalNotification();
P.MQb=X.addNotification(ja,ea);return null},function(X){t.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",X);return null})}};c.prototype.dismiss=function(){var P=this;this.sKa&&this.MQb&&(x.UISurfaces.eM().then(function(ea){ea.removeNotification(P.MQb);return P.MQb=null},function(ea){t.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",ea);return null}),m.prototype.dismiss.call(this))};Object(D.a)(c,"ReactManagedModalCallout",m,[]);var z=b(5);d.tVg=
function(P,ea,X,ja){var R=void 0===R?null:R;return z.AFrameworkApplication.za.Za.dH?new c(P,ea,X,ja,z.AFrameworkApplication.za,R):new m(P,ea,X,ja,z.AFrameworkApplication.za,R)};Object(D.a)(d,"ModalCalloutControlFactory",null,[]);var J=b(51),B=b(985),C=b(589),H=b(986),W=b(128),S=b(85),N=b(49),T=b(88),fa=b(925),Y=b(811),L=b(801);b.d(F,"a",function(){return a});a.BYc=function(P,ea,X,ja,R,ba){a.qI&&a.qI.sKa&&a.qI.dismiss();a.qI=d.tVg(ea,P,P,R);a.qI.content=X;L.b(ja)||(a.qI.title=ja,a.qI.Kcd=!0);P=new Sys.UI.Bounds(0,
0,S.a.H1a(),S.a.b9b());a.qI.ZS=a.bvh(P,ea,a.qI.u0,ba);a.qI.show();a.VWb&&a.VWb.sendNotification(X.innerText,!0)};a.DYc=function(P,ea,X,ja){ja=void 0===ja?null:ja;x.UISurfaces.eM().then(function(R){var ba=null;a.Xhb&&(R.removeNotification(a.Xhb),a.Xhb=null);var ha=R.callout(Object.assign(new B.a,{target:P,title:ea,content:X,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new H.a,{onDismiss:function(){R.removeNotification(ba)},directionalHint:null!=
ja?ja:null})})),oa=Object.assign(new y.a,{expirationOptions:Object.assign(new C.a,{displayTimeoutSeconds:7,onExpire:function(){R.removeNotification(a.Xhb)}})});ba=a.Xhb=R.addNotification(ha,oa);return null},function(R){t.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",R);return null})};a.WJd=function(P,ea){ea=void 0===ea?null:ea;a.qI&&a.qI.sKa&&a.qI.dismiss();var X=new W.StandardDialog;X.cQa=!1;X.lc=0;X.kz(J.a.S9h,CommonUIStrings.l_DialogError,L.b(P)?a.FPe():P,ea)};a.YJd=
function(P){a.qI&&a.qI.sKa&&a.qI.dismiss();t.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",P.errorCode));var ea=L.b(P.description)?a.FPe():P.description,X=new W.StandardDialog,ja=null;P.vga?(X.lc=1,X.Dc(1,P.buttonText),X.$la(1)):X.lc=0;ja=function(R){1===R?P.vga():P.nha&&P.nha()};X.cQa=!1;0===P.RJa?X.kz(P.errorCode,P.title?P.title:CommonUIStrings.l_DialogError,ea,ja):1===P.RJa?X.qW(P.title?P.title:CommonUIStrings.l_DialogWarning,ea,ja):X.hza(P.title?
P.title:CommonUIStrings.l_DialogInfo,ea,ja)};a.bvh=function(P,ea,X,ja){var R=ja?4:0,ba=P.x+P.width-ea.x-ea.width;ea.x-P.x+ea.width/2<=X/2?R=ja?5:2:ba+ea.width/2<=X/2&&(R=ja?6:3);return R};a.hfj=function(P,ea,X,ja,R){if(a.oRd)(ea=fa.a.xrb(ja))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ea,function(oa){oa&&a.DYc(oa,R,X,5)});else if(P)if(ja&&ja.tabs.count){ja=ja.tabs.oa(0);var ba=ja.JQa[Y.a.id],ha=ja.xJ.oa(0).mua[Y.a.id];P.SFd(ba)&&
(P=ja.isOfficeTab?P.GAh(ba,ha):P.SIh(ba))&&(P.x+P.width/2>S.a.H1a()&&(P=new Sys.UI.Bounds(S.a.H1a(),P.y+P.height,0,0)),a.BYc(ea,P,a.mme(X),R,2,0))}else t.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else t.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.ifj=function(P,ea,X,ja){a.hfj(P,ea,ja.startedNode?ja.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,
X),ja,ja.startedNode?ja.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,X))};a.gfj=function(P,ea,X,ja){if(a.oRd)P=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,X,ja,CommonUIStrings.l_InsertionDialogRefresh)),a.DYc(ea,P,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{ea=N.a.Cn(ea);var R=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ba=document.createElement("span");
ba.innerText=R[0];var ha=document.createElement("span");ha.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,X,ja,CommonUIStrings.l_InsertionDialogRefresh);ha.className="UIFontBold";X=document.createElement("span");X.innerText=R[1];ja=document.createElement("div");Sys.UI.DomElement.addCssClass(ja,"ModalCalloutControl");ja.appendChild(ba);ja.appendChild(ha);ja.appendChild(X);a.BYc(P,ea,ja,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.Dgj=function(P,ea){var X=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,
ja=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.oRd?a.DYc(ea,X,ja):(ea=N.a.Cn(ea),a.BYc(P,ea,a.mme(ja),X,3,1))};a.mme=function(P){var ea=document.createElement("div");Sys.UI.DomElement.addCssClass(ea,"ModalCalloutControl");ea.innerText=P;return ea};a.FPe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Jl.Object.defineProperties(a,{VWb:{configurable:!0,enumerable:!0,get:function(){return a.Wda||(a.Wda=T.a.instance.Uh("Common.Utils.IAriaNotifier"))}},
oRd:{configurable:!0,enumerable:!0,get:function(){return z.AFrameworkApplication.za.Za.xi&&z.AFrameworkApplication.za.Za.dH}}});a.qI=null;a.Xhb=null;a.Wda=null;Object(D.a)(a,"AddInCommandsNotificationFactory",null,[])},1062:function(D,F,b){function a(x,z,J,B,C){this.xv=x;this.jI=J;this.K0=B;this.ud=C;this.reb=this.jI.Ah;this.hy=this.reb.getOsfControl(z);this.Sfg=this.hy.getManifest()}function d(x,z,J,B){this._id=x;this.xv=z;this.K0=J;this.ud=B}function c(x,z,J,B){this.Dz=!1;this._id=x;this.xv=z;this.K0=
J;this.ud=B}b.r(F);D=b(0);var m=b(15),r=b(1395),t=b(145),k=b(119),u=b(829),w=b(841),v=b(338);c.prototype.setEnabled=function(){};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};c.prototype.invokePropertyGet=function(x){switch(x){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};c.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};c.prototype.invokePropertySet=function(x,z){switch(x){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};c.prototype.invokePropertySetAsync=function(x,z){this.invokePropertySet(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(x,z){switch(x){case 5:return this.b7i(z);
case 1:return this.OAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};c.prototype.invokeMethodAsync=function(x,z){x=this.invokeMethod(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};c.prototype.b7i=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"boolean");this.setEnabled(x);return null};c.prototype.OAa=function(){this._OnAccess();return null};Jl.Object.defineProperties(c.prototype,{enabled:{configurable:!0,enumerable:!0,
get:function(){return this.Dz},set:function(x){var z=b(1062).DynamicRibbon,J=this.ud.OwnerAddinStoreType,B=this.ud.PrimaryMarketplace.MarketplaceRef,C={};C=(C.addinAssetId=Telemetry.PrivacyRules.GetAssetId(J,B,this.xv),C.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(J,B,this.ud.OwnerAddinAssetId),C.ownerAddinStoreType=J,C.ribbonControlType="Button",C.toggle=x,C);t.a.sendTelemetryEvent(Object.assign(new v.a,{name:z.duc+"ControlUpdate",dataFields:k.a.kG(C)}));this.Dz=x;x={};J=(x.DynamicAddinCommandsMethodDispatchId=
1,x.SolutionId=this.xv,x.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(J,B,this.xv),x.SourceControlId=this.id,x.MethodData=this.Dz,x);this.K0.yJ(-1014260128,J)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(D.a)(c,"RibbonButton",null,[]);d.prototype.setVisibility=function(x){var z=b(1062).DynamicRibbon,J=this.ud.OwnerAddinStoreType,B=this.ud.PrimaryMarketplace.MarketplaceRef,C={};C=(C.addinAssetId=
Telemetry.PrivacyRules.GetAssetId(J,B,this.xv),C.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(J,B,this.ud.OwnerAddinAssetId),C.ownerAddinStoreType=J,C.ribbonControlType="Tab",C.toggle=x,C);t.a.sendTelemetryEvent(Object.assign(new v.a,{name:z.duc+"ControlUpdate",dataFields:k.a.kG(C)}));z={};x=(z.DynamicAddinCommandsMethodDispatchId=2,z.SolutionId=this.xv,z.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(J,B,this.xv),z.StoreType=J,z.SourceControlId=this.id,z.MethodData=x,z);this.K0.yJ(-1014260128,
x)};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};d.prototype.invokePropertyGet=function(x){switch(x){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};d.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};d.prototype.invokePropertySet=function(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);
};d.prototype.invokePropertySetAsync=function(x,z){this.invokePropertySet(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};d.prototype.invokeMethod=function(x,z){switch(x){case 3:return this.O$i(z);case 1:return this.OAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};d.prototype.invokeMethodAsync=function(x,z){x=this.invokeMethod(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};d.prototype.O$i=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,
0,"boolean");this.setVisibility(x);return null};d.prototype.OAa=function(){this._OnAccess();return null};Jl.Object.defineProperties(d.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(D.a)(d,"RibbonTab",null,[]);var A=b(1106),y=b(142);b.d(F,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(x){try{var z={},J=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ud.OwnerAddinStoreType,this.ud.PrimaryMarketplace.MarketplaceRef,this.xv),
z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ud.OwnerAddinStoreType,this.ud.PrimaryMarketplace.MarketplaceRef,this.ud.OwnerAddinAssetId),z.ownerAddinStoreType=this.ud.OwnerAddinStoreType,z.ribbonControlType="Ribbon",z);t.a.sendTelemetryEvent(Object.assign(new v.a,{name:a.duc+"ExecuteRequestCreate",dataFields:k.a.kG(J)}));var B=y.a.gi(x);x={};z={};z[u.a.ZGa]=this.hy;z[u.a.$Ga]=B;z[u.a.N1c]=this.ud;x[u.a.Lpb]=3;x[u.a.b3]=this.xv;x[u.a.j3b]=Telemetry.PrivacyRules.GetAssetId(this.ud.OwnerAddinStoreType,
this.ud.PrimaryMarketplace.MarketplaceRef,this.xv);x[u.a.a3]=z;this.K0.yJ(-1014260128,x);var C=a.B6b("ExecuteRequestCreate",!0,"");m.ULS.sendTraceTag(538572826,0,50,C)}catch(H){B=a.B6b("ExecuteRequestCreate",!1,H.toString()),m.ULS.sendTraceTag(538572825,0,50,B)}return null};a.prototype.executeRequestUpdate=function(x){try{var z=null,J=null;z=this.ud.OwnerAddinStoreType;J=this.ud.PrimaryMarketplace.MarketplaceRef;var B={},C=(B.addinAssetId=Telemetry.PrivacyRules.GetAssetId(z,J,this.xv),B.ownerAddinAssetId=
Telemetry.PrivacyRules.GetAssetId(z,J,this.ud.OwnerAddinAssetId),B.ownerAddinStoreType=this.ud.OwnerAddinStoreType,B.ribbonControlType="Ribbon",B);t.a.sendTelemetryEvent(Object.assign(new v.a,{name:a.duc+"ExecuteRequestUpdate",dataFields:k.a.kG(C)}));var H=y.a.gi(x);x={};B={};B[u.a.ZGa]=this.hy;B[u.a.$Ga]=H;B[u.a.N1c]=this.ud;x[u.a.Lpb]=3;x[u.a.b3]=this.xv;x[u.a.j3b]=Telemetry.PrivacyRules.GetAssetId(z,J,this.xv);x[u.a.a3]=B;this.K0.yJ(-1014260128,x);var W=a.B6b("ExecuteRequestUpdate",!0,"");m.ULS.sendTraceTag(538572824,
0,50,W)}catch(S){z=a.B6b("ExecuteRequestUpdate",!1,S.toString()),m.ULS.sendTraceTag(538572823,0,50,z)}return null};a.prototype.getButton=function(x){var z=null;if(!this.n4e())return this.vue();if(x&&0<x.length){if(!this.Epe(x))return this.Oue(x);z=new c(x,this.xv,this.K0,this.ud)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype.getTab=function(x){var z=null;if(!this.n4e())return this.vue();if(this.hy.getOwnerAddinControlRecreated())return this.DUg();if(x&&0<x.length){if(!this.Epe(x))return this.Oue(x);
z=new d(x,this.xv,this.K0,this.ud)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(x){switch(x){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};a.prototype.invokePropertyGetAsync=function(x){x=this.invokePropertyGet(x);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};
a.prototype.invokePropertySet=function(x){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};a.prototype.invokePropertySetAsync=function(x,z){this.invokePropertySet(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(x){switch(x){case 1:return this.OAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(x);};a.prototype.invokeMethodAsync=function(x,z){switch(x){case 7:return this.bjh(z);case 6:return this.cjh(z);
case 3:return this.Kuh(z);case 5:return this.RIh(z)}x=this.invokeMethod(x,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(x)};a.prototype.bjh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestCreate(x)};a.prototype.cjh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.executeRequestUpdate(x)};a.prototype.Kuh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,
0,"string");return this.getButton(x)};a.prototype.RIh=function(x){x=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(x,0,"string");return this.getTab(x)};a.prototype.OAa=function(){this._OnAccess();return null};a.prototype.Oue=function(x){return A.a(w.a.jQg,y.a.da(1693)+x)};a.prototype.vue=function(){return A.a(w.a.l_i,y.a.da(1689))};a.prototype.DUg=function(){return A.a(w.a.hostRestartNeeded,y.a.da(1694))};a.prototype.n4e=function(){var x=this.hy.getSharedRuntimeId();x=!!x&&0<x.length;m.ULS.sendTraceTag(538572822,
0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",x));return x};a.prototype.Epe=function(x){var z=this.Sfg.getRibbonExtensionControlMap();return x in z||this.TJg(x)};a.prototype.TJg=function(x){var z=this.Hmh();if(z){z=Ml(z.qBe.tabs);for(var J=z.next();!J.done;J=z.next()){J=J.value;if(J.id===x)return!0;J=Ml(J.groups);for(var B=J.next();!B.done;B=J.next()){B=Ml(B.value.controls);for(var C=B.next();!C.done;C=B.next()){C=C.value;if(C.id===x)return!0;if("Menu"===C.type){C=
Ml(C.items);for(var H=C.next();!H.done;H=C.next())if(H.value.id===x)return!0}}}}}return!1};a.prototype.Hmh=function(){return r.a.getInstance().KP(this.ud.PrimaryMarketplace.MarketplaceType,this.ud.PrimaryMarketplace.SolutionId,1)};a.B6b=function(x,z,J){var B={};B.methodName="DynamicRibbon."+x;B.result=z?"Succeeded":"Failed";B.message=J;return y.a.Oc(B)};Jl.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.duc="Office.Online.Extensibility.Ribbon.";
Object(D.a)(a,"DynamicRibbon",null,[])},1084:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.L4b="extId";a.Bse="ComponentType";a.DFa="ComponentId";a.Hdd="HostProps";a.qxa="OptionalProps";Object(D.a)(a,"ActionPropertyNames",null,[])},1104:function(D,F,b){function a(d,c){var m=!1;d&&(d=c.osfControl,(c=d.getManifest())&&c.getSharedRuntimeForCustomFunctions("Workbook")&&!d.getIsUpgrading()&&(m=!0));return m}b.d(F,"a",function(){return a})},1106:function(D,F,b){function a(d,c){return OfficeExtension.WacRuntime.Utility.createPromise(function(m,
r){r(OfficeExtension.WacRuntime.Utility.createRichApiException(d,c))})}b.d(F,"a",function(){return a})},1217:function(D,F,b){function a(ca,Ra,ua){this.kva=!1;this.pE={};this.$=ca;this.zg=Ra;this.Afd().Aca();this.indexedDB=ua;this.indexedDB.te()&&(this.kva=!0,this.indexedDB.initialize(a.Ced,a.Ded))}function d(ca,Ra){this.XKc=ca;this._message=Ra}function c(){}function m(){}function r(ca){switch(ca){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function t(ca,
Ra){y(b(1217).CustomFunctionsInstaller.IRe("CustomFunctionsRuntimeLogging"),function(ua){if(ua.result&&window.console)switch(ua=r(ca.severity)+" "+ca.message+Ra,ca.severity){case 2:window.console.log&&window.console.log(ua);break;case 0:window.console.info&&window.console.info(ua);break;case 1:window.console.error&&window.console.error(ua)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function k(ca,Ra,ua,ta,db){ua=ca.CWCT(function(){Ra(ca)},
ua,3,ta);ua.continueWith(function(){W.ULS.sendTraceTag(42541912,0,10,db)},4);return ua}function u(ca,Ra,ua){return k(ca,Ra,ha.a.none,oa.a.current,ua)}function w(ca,Ra,ua,ta,db){ua=ca.CWRCT(function(){return Ra(ca)},ua,3,ta);ua.continueWith(function(){W.ULS.sendTraceTag(42541911,0,10,db)},4);return X.TaskExtensions.zvc(ua)}function v(ca,Ra,ua){return w(ca,Ra,ha.a.none,oa.a.current,ua)}function A(ca,Ra,ua,ta,db){ua=ca.CWRCT(function(){return Ra(ca)},ua,3,ta);ua.continueWith(function(){W.ULS.sendTraceTag(42541910,
0,10,db)},4);return ua}function y(ca,Ra,ua){return A(ca,Ra,ha.a.none,oa.a.current,ua)}function x(ca,Ra,ua,ta,db){ua=ca.CWRCT(function(){return Ra(ca)},ua,3,ta);ua.continueWith(function(){W.ULS.sendTraceTag(42541909,0,10,db)},4);return X.TaskExtensions.zvc(ua)}function z(ca,Ra,ua){return x(ca,Ra,ha.a.none,oa.a.current,ua)}function J(ca,Ra,ua,ta,db){ua=ca.CWCT(function(){Ra(ca)},ua,3,ta);ua.continueWith(function(){W.ULS.sendTraceTag(42541908,0,10,db)},4);return ua}function B(ca,Ra,ua){return J(ca,Ra,
ha.a.none,oa.a.current,ua)}function C(){}function H(ca){ca=ca.split("|");this.xv=ca[1];this.zLc=ca[2];this.oMd=ca[3]}b.r(F);D=b(0);var W=b(15),S=b(5),N=b(139),T=b(210),fa=b(82),Y=b(519),L=b(160),P=b(81),ea=b(58),X=b(35),ja=b(218),R=b(127),ba=b(555);Jl.Object.defineProperties(H.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.xv}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.zLc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.oMd===
OSF.StoreTypeEnum.Registry.toString()}}});Object(D.a)(H,"AddinStoreInfo",null,[]);Object(D.a)(C,"CustomFunctionRegistrationInfos",null,[]);var ha=b(192),oa=b(60),Sa=b(1104);Object(D.a)(m,"InstallationInfo",null,[]);Object(D.a)(c,"UninstallationInfo",null,[]);var ma=b(26),na=b(92),xa=b(32),Oa=b(27),ib=b(1),sb=b(7),nb=b(273),Gb=b(895),Ha=b(52);Jl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.XKc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});
Object(D.a)(d,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsInstaller",function(){return a});a.prototype.zfd=function(ca,Ra,ua,ta){if(!sb.a.na(ta.invariantNamespace))for(var db=0;db<ta.invariantNamespace.length;++db){var Ta=ta.invariantNamespace.charAt(db);if("."!==Ta&&"_"!==Ta&&"a">Ta&&"z"<Ta&&"A">Ta&&"Z"<Ta&&"0">Ta&&"9"<Ta)throw W.ULS.sendTraceTag(39375492,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",Ta,db),Error.create("InvariantNamespace validation failed");
}var qb=this;return z(this.nGg(ua,ta.manifest),function(){return z(qb.Azd(ca),function(za){var Ia=za.result;return Ia&&Ia.isDynamicMetadata?qb.FAd(ca,Ra,Ia,!1,!1,!1):z(qb.eDj(ca,Ra,ta),function(va){var Ua;Ia=(Ua=new m,Ua.addinId=ua,Ua.locale=ta.locale,Ua.addinInvariantNamespace=ta.invariantNamespace,Ua.addinNamespace=ta.namespace,Ua.addinTitle=ta.title,Ua.isXllCompatible=ta.isXllCompatible,Ua.metadataContent=JSON.stringify(JSON.parse(va.result)),Ua);return qb.FAd(ca,Ra,Ia,!1,a.bkh(ta.osfControl.getStoreType()),
Sa.a(qb.$,ta))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.$1e=function(ca,Ra,ua,ta){var db=this;if(!a.Kkd(ua))throw W.ULS.sendTraceTag(39965660,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return z(this.Azd(ca),
function(Ta){Ta=Ta.result;if(!Ta&&(Ta=xa.a.Ec(db.JU,ca),!Ta))throw W.ULS.sendTraceTag(42541837,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(Ra,null,ca))),Error.create("Customfunctions dynamic registration failed");Ta.metadataContent=JSON.stringify(JSON.parse(ua));Ta.isDynamicMetadata=!0;return db.FAd(ca,Ra,Ta,!0,!0,ta)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.T0f=function(ca,Ra){var ua=this;this.zg.tha();var ta=Object.assign(new c,{solutionId:ca}),db=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(Ra,null,ca));return z(this.pBd(ca),function(){return z(ua.wBd(ca),function(){return ua.NPd(ua.zg,ca,Ra,ta)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},db)};a.prototype.eDj=function(ca,Ra,ua){var ta=new N.a;OSF.OUtil.xhrGet(ua.metadataUrl,
function(db){db?ta.setResult(db):ta.setException(Error.create("Invalid manifest"))},function(db){W.ULS.sendTraceTag(36721665,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(Ra,null,ca),db);ta.setException(Error.create("Failed to download manifest"))});return ta.task};a.prototype.Afd=function(){var ca=this;return z(this.Ulc(),function(Ra){var ua=Ra.result;if(!ua.length)return Ha.Task.Ua(!0);
W.ULS.sendTraceTag(37631833,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ra=new T.a;for(var ta=[],db={},Ta=0;Ta<ua.length;db={eMb:db.eMb},Ta++)db.eMb=Object(fa.a)(String,ua[Ta]),Ra.add(y(ca.Azd(db.eMb),function(qb){return function(za){if(za=za.result){var Ia=xa.a.Ec(ca.pE,za.addinId);Ia&&Ia===za.metadataContent||(ca.pE[za.addinId]=za.metadataContent,ca.JU[qb.eMb]=za,Array.add(ta,za))}return!0}}(db),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));
return v(Ha.Task.WAE(Ra),function(){if(ta.length){var qb,za=(qb=new C,qb.registrationInfos=ta,qb);return ca.wXb(ca.zg,ua,za)}W.ULS.sendTraceTag(41211920,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Ha.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.a2e=function(){var ca=this,Ra=new N.a;new T.a;var ua=
[],ta=[];Object.keys(this.JU).forEach(function(db){db=Object(fa.a)(String,db);var Ta=xa.a.Ec(ca.JU,db);Array.add(ua,Ta);Array.add(ta,db)});if(!ta.length)return Ra.setResult(!0),Ra.task;Ra=Object.assign(new C,{registrationInfos:ua});return this.wXb(this.zg,ta,Ra)};a.prototype.Ulc=function(){return y(this.i$c(ba.a.vWa),function(ca){ca=ca.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(sb.a.na(ca)?"[]":ca))?Sys.Serialization.JavaScriptSerializer.deserialize(sb.a.na(ca)?
"[]":ca):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.q6f=function(ca){return this.vHd(ba.a.vWa,Sys.Serialization.JavaScriptSerializer.serialize(ca))};a.prototype.Azd=function(ca){return z(this.i$c(ba.a.g1a(ca)),function(Ra){Ra=sb.a.na(Ra.result)?"":Ra.result;return 0<Ra.length?Ha.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ra,!0)):Ha.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.YCj=function(ca,Ra){var ua=this;return z(this.XCe(ca),function(){return z(ua.vHd(ba.a.g1a(ca),Sys.Serialization.JavaScriptSerializer.serialize(Ra)),function(){return a.wHd(ba.a.ycd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.pBd=function(ca){var Ra=this;return z(this.$Df(ca),function(){return z(Ra.tEf(ba.a.g1a(ca)),
function(){return z(Ra.Ulc(),function(ua){return ua.result.length?Ha.Task.Ua(!0):a.wHd(ba.a.ycd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.LBf=function(ca){return this.i$c(ba.a.f1a(ca))};
a.prototype.n6f=function(ca,Ra){var ua=this;return z(this.XCe(ca),function(){return ua.vHd(ba.a.f1a(ca),Ra)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.wBd=function(ca){var Ra=this;return z(this.$Df(ca),function(){return Ra.tEf(ba.a.f1a(ca))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.XCe=function(ca){var Ra=this;return z(this.Ulc(),function(ua){ua=ua.result;
var ta=ca.toLowerCase();if(Array.contains(ua,ta))return Ha.Task.Ua(!0);ua.push(ta);return Ra.q6f(ua)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.$Df=function(ca){var Ra=this;return z(this.Ulc(),function(ua){ua=ua.result;var ta=ca.toLowerCase();return Array.contains(ua,ta)?(ua.splice(Array.indexOf(ua,ta),1),Ra.q6f(ua)):Ha.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.nGg=function(ca,Ra){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ca=new OSF.AddinIdInfo(ca),ca.needToRestoreManifest()?this.n6f(ca.getSolutionId(),Ra):Ha.Task.Ua(!0);ca=new H(ca);return ca.needToRestoreManifest?this.n6f(ca.solutionId,Ra):Ha.Task.Ua(!0)};a.prototype.KZi=function(ca){var Ra=this;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var ua=new OSF.AddinIdInfo(ca);return ua.needToRestoreManifest()?
y(this.LBf(ua.getSolutionId()),function(db){db=db.result;sb.a.na(db)||OSF.OsfManifestManager.cacheManifestFromXml(ua.getSolutionId(),ua.getSolutionVersion(),db,Ra.$.Ba.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Ha.Task.Ua(!0)}var ta=new H(ca);return ta.needToRestoreManifest?y(this.LBf(ta.solutionId),function(db){db=db.result;sb.a.na(db)||OSF.OsfManifestManager.cacheManifestFromXml(ta.solutionId,ta.solutionVersion,db,Ra.$.Ba.UICultureTag);
return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Ha.Task.Ua(!0)};a.prototype.tEf=function(ca){return this.kva?this.indexedDB.qye(ca):a.jSi(ca)};a.prototype.vHd=function(ca,Ra){return this.kva?this.indexedDB.U9a(new Gb.a(ca,Ra)):a.wHd(ca,Ra)};a.prototype.i$c=function(ca){return this.kva?this.indexedDB.yIa(ca):a.IRe(ca)};a.prototype.FAd=function(ca,Ra,ua,ta,db,Ta){var qb=this,za=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetAssetId(Ra,null,ca));return X.TaskExtensions.zvc(y(this.GAd(this.zg,ca,Ra,ua,!1,ta,Ta),function(){return db?qb.YCj(ca,ua):Ha.Task.Ua(!0)},za))};a.prototype.GAd=function(ca,Ra,ua,ta,db,Ta,qb){var za=this;if(!Ta&&(Ta=xa.a.Ec(this.pE,ta.addinId))&&Ta===ta.metadataContent)return Ha.Task.Ua(!0);this.pE[ta.addinId]=ta.metadataContent;this.JU[Ra]=ta;qb||ca.fEb(Ra);ca.tha();return z(this.WPi(Ra,ua,ta),function(){return za.nyd(ta.addinId,db)},"Failed to register functions for customfunction addin")};
a.prototype.WPi=function(ca,Ra,ua){var ta=this,db=new N.a,Ta=this.hmb(ua);return this.Aha(function(qb){ib.EwaSettings.ka(261)&&t(a.Mob,ca);(qb=qb.Result)&&204===qb.ResponseStatusCode?db.setResult(!0):(delete ta.pE[ua.addinId],delete ta.JU[ca],B(ta.pBd(ca),function(){B(ta.wBd(ca),function(){ta.ZSf()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ca,qb?qb.ResponseStatusCode.toString():
"Unknown")),db.setResult(!1))},function(qb){qb=R.a.Eg(qb.data);W.ULS.sendTraceTag(36983963,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(Ra,null,ca),Oa.a.fd(qb));ib.EwaSettings.ka(261)&&t(a.Lob,ca);delete ta.pE[ua.addinId];delete ta.JU[ca];db.setResult(!1)},Ta,db,!0)};a.prototype.wXb=function(ca,Ra,ua){var ta=this,db=new N.a,Ta=ma.a.Ta.we.m;Ra.forEach(function(za){za=Object(fa.a)(String,
za);ca.hpe(za)});ca.tha();var qb=this.USc(ua);return this.Aha(function(za){ib.EwaSettings.ka(261)&&t(a.Mob,Sys.Serialization.JavaScriptSerializer.serialize(Ra));za=za.Result;var Ia=!0,va=Sys.Serialization.JavaScriptSerializer.deserialize(za.ResponseBody.toString());va=Array.isArray(va.value)?va.value:null;for(var Ua=new T.a,Kb={Mda:0};Kb.Mda<va.length;Kb={Mda:Kb.Mda},Kb.Mda++)if(!va[Kb.Mda]){Ia=!1;var ia=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
za.ResponseStatusCode);Ua.add(z(ta.pBd(Ra[Kb.Mda]),function(E){return function(){delete ta.pE[ua.registrationInfos[E.Mda].addinId];delete ta.JU[Ra[E.Mda]];return ta.wBd(Ra[E.Mda])}}(Kb),ia))}u(Ha.Task.WAE(Ua),function(){B(ta.nyd("",!1),function(){W.ULS.sendTraceTag(42541838,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",ma.a.Ta.we.m-Ta);Ia?db.setResult(Ia):u(ta.ZSf(),function(){db.setResult(Ia)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(za){za=R.a.Eg(za.data);W.ULS.sendTraceTag(40185999,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Oa.a.fd(za));ib.EwaSettings.ka(261)&&t(a.Lob,Sys.Serialization.JavaScriptSerializer.serialize(Ra));
for(za=0;za<ua.registrationInfos.length;za++)delete ta.pE[ua.registrationInfos[za].addinId],delete ta.JU[Ra[za]];db.setResult(!1)},qb,db,!0)};a.prototype.NPd=function(ca,Ra,ua,ta){var db=this;return z(this.Buj(ca,Ra,ua,ta),function(){return db.nyd(ta.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.Buj=function(ca,Ra,ua,ta){var db=new N.a;ca.fEb(Ra);(ca=xa.a.Ec(this.JU,Ra))&&delete this.pE[ca.addinId];delete this.JU[Ra];ta=this.eTc(ta);return this.Aha(function(){ib.EwaSettings.ka(261)&&
t(a.v_c,Ra);db.setResult(!0)},function(Ta){Ta=R.a.Eg(Ta.data);W.ULS.sendTraceTag(40186001,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(ua,ua,Ra),Oa.a.fd(Ta));ib.EwaSettings.ka(261)&&t(a.u_c,Ra);db.setResult(!1)},ta,db,!1)};a.prototype.Aha=function(ca,Ra,ua,ta,db){function Ta(){function Kb(fb,Za,ec){ib.EwaSettings.ka(261)&&t(db?a.t_c:a.w_c,ia.RequestBody);return P.i(za.xa,"ExecuteRichApiRequest",
ua,nb.b(fb,ca),nb.a(Za,Ra),ec,null,0)}if(qb.KFa()||0<za.xa.n3||0<za.Ek.n3)return!1;Ia&&qb.WC(Ia);va&&za.Tt(va);Ua&&za.YC(Ua);var ia=ua.request,E=0;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ia.RequestFlags&1&&256!==(ia.RequestFlags&256)||(E=16):E=ia.RequestFlags&1?0:16;ib.EwaSettings.wc()?qb.yt(new L.a(507,0,Kb,E|64)):qb.yt(new Y.a(507,0,Kb,E));return!0}var qb=this.$.userOperationManager,za=this.$.ra,Ia=null,va=null,Ua=null;Ta()||(Ia=function(){Ta()},va=
function(){Ta()},Ua=function(){Ta()},qb.CB(Ia),za.ls(va),za.FB(Ua));return ta.task};a.prototype.hmb=function(ca){var Ra={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ra.RequestBody=JSON.stringify(ca);Ra.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ra.RequestFlags|=256);ca=this.$.ra.xa.Ra(1);ca.request=Ra;return ca};a.prototype.USc=function(ca){var Ra={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};Ra.RequestBody=JSON.stringify(ca);Ra.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ra.RequestFlags|=256);ca=this.$.ra.xa.Ra(1);ca.request=Ra;return ca};a.prototype.eTc=function(ca){var Ra={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ra.RequestBody=JSON.stringify(ca);Ra.RequestFlags=1;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ra.RequestFlags|=
256);ca=this.$.ra.xa.Ra(1);ca.request=Ra;return ca};a.prototype.nyd=function(ca,Ra){var ua=this,ta=ea.GetServiceTaskFactory.create(this.$.ea,153,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");return x(ta,function(){ta.result.tDd();return!sb.a.na(ca)&&Ra?ua.KZi(ca):Ha.Task.Ua(!0)},this.$.ma,ja.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.ZSf=function(){var ca=new na.a(1949669462,
0,this.$.jd,0,null);return this.$.Na.Xb(ca)};a.IRe=function(ca){try{return Ha.Task.Ua(localStorage.getItem(ca))}catch(Ra){return W.ULS.sendTraceTag(37060758,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",sb.a.na(Ra.message)?"Unknown":Ra.message),Ha.Task.Ua(null)}};a.wHd=function(ca,Ra){try{return localStorage.setItem(ca,Ra),Ha.Task.Ua(!0)}catch(ua){return W.ULS.sendTraceTag(37060759,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",
sb.a.na(ua.message)?"Unknown":ua.message),Ha.Task.Ua(!1)}};a.jSi=function(ca){try{return localStorage.removeItem(ca),Ha.Task.Ua(!0)}catch(Ra){return W.ULS.sendTraceTag(39965665,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",sb.a.na(Ra.message)?"Unknown":Ra.message),Ha.Task.Ua(!1)}};a.bkh=function(ca){return sb.a.equals(ca,"registry",!0)||sb.a.equals(ca,"uploadfiledevcatalog",!0)||S.AFrameworkApplication.userNameUnknown||S.AFrameworkApplication.limitedEdit};
a.Kkd=function(ca){if(sb.a.na(ca))return!1;try{JSON.parse(ca)}catch(Ra){return!1}return!0};Jl.Object.defineProperties(a.prototype,{JU:{configurable:!0,enumerable:!0,get:function(){return this.zg.JU}}});a.Ced="CustomFunctionCache";a.Ded="CustomFunction";a.t_c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Mob=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Lob=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.w_c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");
a.v_c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.u_c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(D.a)(a,"CustomFunctionsInstaller",null,[685])},1219:function(D,F,b){function a(R){this.pE={};this.$=R;this.Afd().Aca()}function d(R,ba){this.XKc=R;this._message=ba}function c(){}function m(){}function r(R){switch(R){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function t(R,ba){if(b(1219).CustomFunctionsLegacyInstaller.Csb("CustomFunctionsRuntimeLogging")&&
window.console)switch(ba=r(R.severity)+" "+R.message+ba,R.severity){case 2:window.console.log&&window.console.log(ba);break;case 0:window.console.info&&window.console.info(ba);break;case 1:window.console.error&&window.console.error(ba)}}function k(){}function u(R){R=R.split("|");this.xv=R[1];this.zLc=R[2];this.oMd=R[3]}b.r(F);D=b(0);var w=b(15),v=b(1054),A=b(139),y=b(82),x=b(519),z=b(160),J=b(81),B=b(58),C=b(35),H=b(127),W=b(555),S=b(1104);Jl.Object.defineProperties(u.prototype,{solutionId:{configurable:!0,
enumerable:!0,get:function(){return this.xv}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.zLc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.oMd===OSF.StoreTypeEnum.Registry.toString()}}});Object(D.a)(u,"AddinStoreInfo",null,[]);Object(D.a)(k,"CustomFunctionRegistrationInfos",null,[]);Object(D.a)(m,"InstallationInfo",null,[]);Object(D.a)(c,"UninstallationInfo",null,[]);var N=b(147),T=b(32),fa=b(27),Y=b(1),L=b(7),P=b(16),ea=b(273),X=
b(997),ja=b(52);Jl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.XKc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(D.a)(d,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.zfd=function(R,ba,ha,oa){var Sa=this,ma=new A.a;if(!L.a.na(oa.invariantNamespace))for(ba=0;ba<oa.invariantNamespace.length;++ba){var na=oa.invariantNamespace.charAt(ba);if("."!==
na&&"_"!==na&&"a">na&&"z"<na&&"A">na&&"Z"<na&&"0">na&&"9"<na)return w.ULS.sendTraceTag(42541841,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",na,ba),ma.setResult(!1),ma.task}a.cacheManifest(ha,oa.manifest);var xa=a.Bzd(R);xa&&xa.isDynamicMetadata?this.EAd(R,xa,ma,!1,!1):OSF.OUtil.xhrGet(oa.metadataUrl,function(Oa){xa=Object.assign(new m,{addinId:ha,locale:oa.locale,addinInvariantNamespace:oa.invariantNamespace,addinNamespace:oa.namespace,
addinTitle:oa.title,isXllCompatible:oa.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Oa))});Sa.EAd(R,xa,ma,!1,S.a(Sa.$,oa))},function(Oa){w.ULS.sendTraceTag(42541843,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",R,Oa);ma.setResult(!1)});return ma.task};a.prototype.$1e=function(R,ba,ha,oa){ba=new A.a;if(!a.Kkd(ha))return w.ULS.sendTraceTag(42541844,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
ba.setResult(!1),ba.task;var Sa=a.Bzd(R);if(!Sa)return w.ULS.sendTraceTag(42541845,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),ba.setResult(!1),ba.task;Sa.metadataContent=JSON.stringify(JSON.parse(ha));Sa.isDynamicMetadata=!0;this.EAd(R,Sa,ba,!0,oa);return ba.task};a.prototype.T0f=function(R){var ba=this,ha=new A.a,oa=B.GetServiceTaskFactory.create(this.$.ea,106,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");
C.TaskExtensions.Da(oa,function(){var Sa=oa.result;Sa.tha();var ma=Object.assign(new c,{solutionId:R});a.qBd(R);a.xBd(R);C.TaskExtensions.Da(ba.NPd(Sa,R,ma),function(na){N.b(na)?ha.setResult(na.result):(na.ng?w.ULS.sendTraceTag(42541847,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",R):na.Dh&&w.ULS.sendTraceTag(42541848,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",R),ha.setResult(!1))},
ba.$.ma,0)},this.$.ma,3);return ha.task};a.prototype.Afd=function(){var R=this,ba=new A.a,ha=a.Ezd();0<ha.length&&w.ULS.sendTraceTag(42541849,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var oa=[];ha.forEach(function(ma){ma=Object(y.a)(String,ma);if(ma=a.Bzd(ma)){var na=T.a.Ec(R.pE,ma.addinId);na&&na===ma.metadataContent||(R.pE[ma.addinId]=ma.metadataContent,Array.add(oa,ma))}});if(!oa.length)return ba.setResult(!0),w.ULS.sendTraceTag(42541850,
0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),ba.task;var Sa=B.GetServiceTaskFactory.create(this.$.ea,106,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");C.TaskExtensions.Da(Sa,function(){var ma=Sa.result,na=Object.assign(new k,{registrationInfos:oa});C.TaskExtensions.Da(R.wXb(ma,ha,na),function(xa){N.b(xa)?ba.setResult(xa.result):(xa.ng?w.ULS.sendTraceTag(42541852,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):
xa.Dh&&w.ULS.sendTraceTag(42541853,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),ba.setResult(!1))},R.$.ma,0)},this.$.ma,3);return ba.task};a.prototype.JZi=function(R){R=new u(R);if(R.needToRestoreManifest){var ba=a.zNi(R.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(R.solutionId,R.solutionVersion,ba,this.$.Ba.UICultureTag)}};a.prototype.EAd=function(R,ba,ha,oa,Sa){var ma=this,na=B.GetServiceTaskFactory.create(this.$.ea,106,this.$.ma,
1,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService");C.TaskExtensions.Da(na,function(){C.TaskExtensions.Da(ma.GAd(na.result,R,ba,!1,oa,Sa),function(xa){N.b(xa)?((xa=xa.result)&&a.ZCj(R,ba),ha.setResult(xa)):(xa.ng?w.ULS.sendTraceTag(42541858,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",R):xa.Dh&&w.ULS.sendTraceTag(42541859,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
R),ha.setResult(!1))},ma.$.ma,0)},this.$.ma,3)};a.prototype.GAd=function(R,ba,ha,oa,Sa,ma){var na=this;if(!Sa&&(Sa=T.a.Ec(this.pE,ha.addinId))&&Sa===ha.metadataContent)return ja.Task.Ua(!0);this.pE[ha.addinId]=ha.metadataContent;var xa=new A.a;ma||R.fEb(ba);R.tha();R=this.hmb(ha);return this.Aha(function(Oa){Y.EwaSettings.ka(261)&&t(a.Mob,ba);var ib=Oa.Result;204===ib.ResponseStatusCode?C.TaskExtensions.Da(na.lyd(xa,ha.addinId,oa),function(sb){sb.ng?L.a.na(ba)?w.ULS.sendTraceTag(42541890,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",
ha.addinId):w.ULS.sendTraceTag(42541889,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",ba):sb.Dh&&(L.a.na(ba)?w.ULS.sendTraceTag(42541892,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ha.addinId):w.ULS.sendTraceTag(42541891,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
ba));xa.setResult(!1)},na.$.ma,4):(Oa=function(){delete na.pE[ha.addinId];a.qBd(ba);a.xBd(ba);w.ULS.sendTraceTag(42541893,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ba,ib.ResponseStatusCode);xa.setResult(!1)},Oa=Object.assign(new X.a,{RJa:OSF.InfoType.Error,title:ha.addinTitle,description:String.format(P.a.instance.Eb(152),P.a.instance.da(1807)),buttonText:P.a.instance.da(4),vga:Oa,z$b:!1,nha:Oa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
v.a.YJd(Oa))},function(Oa){Oa=H.a.Eg(Oa.data);w.ULS.sendTraceTag(42541894,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",ba,fa.a.fd(Oa));Y.EwaSettings.ka(261)&&t(a.Lob,ba);delete na.pE[ha.addinId];xa.setResult(!1)},R,xa,!0)};a.prototype.wXb=function(R,ba,ha){var oa=this,Sa=new A.a;ba.forEach(function(na){na=Object(y.a)(String,na);R.hpe(na)});R.tha();var ma=this.USc(ha);return this.Aha(function(na){Y.EwaSettings.ka(261)&&
t(a.Mob,Sys.Serialization.JavaScriptSerializer.serialize(ba));na=na.Result;var xa=!0,Oa=Sys.Serialization.JavaScriptSerializer.deserialize(na.ResponseBody.toString());Oa=Array.isArray(Oa.value)?Oa.value:null;for(var ib=0;ib<Oa.length;ib++)Oa[ib]||(xa=!1,delete oa.pE[ha.registrationInfos[ib].addinId],a.qBd(ba[ib]),a.xBd(ba[ib]),w.ULS.sendTraceTag(42541896,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",ba[ib],na.ResponseStatusCode));
C.TaskExtensions.Da(oa.lyd(Sa,"",!1),function(sb){sb.ng?w.ULS.sendTraceTag(42541897,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):sb.Dh&&w.ULS.sendTraceTag(42541898,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Sa.setResult(!1)},oa.$.ma,4);Sa.setResult(xa)},function(na){na=H.a.Eg(na.data);w.ULS.sendTraceTag(42541899,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(ba),fa.a.fd(na));Y.EwaSettings.ka(261)&&t(a.Lob,Sys.Serialization.JavaScriptSerializer.serialize(ba));na=Ml(ha.registrationInfos);for(var xa=na.next();!xa.done;xa=na.next())delete oa.pE[xa.value.addinId];Sa.setResult(!1)},ma,Sa,!0)};a.prototype.NPd=function(R,ba,ha){var oa=this,Sa=new A.a;R.fEb(ba);R=this.eTc(ha);return this.Aha(function(){Y.EwaSettings.ka(261)&&t(a.v_c,ba);C.TaskExtensions.Da(oa.lyd(Sa,ha.solutionId,!1),function(ma){ma.ng?L.a.na(ba)||
w.ULS.sendTraceTag(42541901,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",ba):ma.Dh&&(L.a.na(ba)||w.ULS.sendTraceTag(42541902,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",ba));Sa.setResult(!1)},oa.$.ma,4)},function(ma){ma=H.a.Eg(ma.data);w.ULS.sendTraceTag(42541903,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
ba,fa.a.fd(ma));Y.EwaSettings.ka(261)&&t(a.u_c,ba);Sa.setResult(!1)},R,Sa,!1)};a.prototype.Aha=function(R,ba,ha,oa,Sa){function ma(){function nb(ca,Ra,ua){Y.EwaSettings.ka(261)&&t(Sa?a.t_c:a.w_c,Gb.RequestBody);return J.i(xa.xa,"ExecuteRichApiRequest",ha,ea.b(ca,R),ea.a(Ra,ba),ua,null,0)}if(na.KFa()||0<xa.xa.n3||0<xa.Ek.n3)return!1;Oa&&na.WC(Oa);ib&&xa.Tt(ib);sb&&xa.YC(sb);var Gb=ha.request,Ha=Gb.RequestFlags&1?0:16;Y.EwaSettings.wc()?na.yt(new z.a(507,0,nb,Ha|64)):na.yt(new x.a(507,0,nb,Ha));return!0}
var na=this.$.userOperationManager,xa=this.$.ra,Oa=null,ib=null,sb=null;ma()||(Oa=function(){ma()},ib=function(){ma()},sb=function(){ma()},na.CB(Oa),xa.ls(ib),xa.FB(sb));return oa.task};a.prototype.hmb=function(R){var ba={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ba.RequestBody=JSON.stringify(R);ba.RequestFlags=1;R=this.$.ra.xa.Ra(1);R.request=ba;return R};a.prototype.USc=function(R){var ba={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
ba.RequestBody=JSON.stringify(R);ba.RequestFlags=1;R=this.$.ra.xa.Ra(1);R.request=ba;return R};a.prototype.eTc=function(R){var ba={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ba.RequestBody=JSON.stringify(R);ba.RequestFlags=1;R=this.$.ra.xa.Ra(1);R.request=ba;return R};a.prototype.lyd=function(R,ba,ha){var oa=this,Sa=B.GetServiceTaskFactory.create(this.$.ea,153,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");C.TaskExtensions.Da(Sa,
function(){Sa.result.tDd();!L.a.na(ba)&&ha&&oa.JZi(ba);R.setResult(!0)},this.$.ma,3);return Sa};a.prototype.a2e=function(){return ja.Task.Ua(!0)};a.Ezd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.Csb(W.a.vWa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.Csb(W.a.vWa)||"[]"):null)||[]};a.r6f=function(R){a.xHd(W.a.vWa,Sys.Serialization.JavaScriptSerializer.serialize(R))};a.Bzd=function(R){R=a.Csb(W.a.g1a(R))||"";return 0<R.length?Sys.Serialization.JavaScriptSerializer.deserialize(R,
!0):null};a.ZCj=function(R,ba){a.WCe(R);a.xHd(W.a.g1a(R),Sys.Serialization.JavaScriptSerializer.serialize(ba))};a.qBd=function(R){a.ZDf(R);a.uEf(W.a.g1a(R))};a.zNi=function(R){return a.Csb(W.a.f1a(R))};a.$Cj=function(R,ba){a.WCe(R);a.xHd(W.a.f1a(R),ba)};a.xBd=function(R){a.ZDf(R);a.uEf(W.a.f1a(R))};a.WCe=function(R){var ba=a.Ezd();R=R.toLowerCase();Array.contains(ba,R)||(ba.push(R),a.r6f(ba))};a.ZDf=function(R){var ba=a.Ezd();R=R.toLowerCase();Array.contains(ba,R)&&(ba.splice(Array.indexOf(ba,R),
1),a.r6f(ba))};a.cacheManifest=function(R,ba){R=new u(R);R.needToRestoreManifest&&a.$Cj(R.solutionId,ba)};a.Csb=function(R){try{return localStorage.getItem(R)}catch(ba){return w.ULS.sendTraceTag(42541854,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",ba.message||"Unknown"),null}};a.xHd=function(R,ba){try{localStorage.setItem(R,ba)}catch(ha){w.ULS.sendTraceTag(42541855,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
ha.message||"Unknown")}};a.uEf=function(R){try{localStorage.removeItem(R)}catch(ba){w.ULS.sendTraceTag(42541856,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ba.message||"Unknown")}};a.Kkd=function(R){if(L.a.na(R))return!1;try{JSON.parse(R)}catch(ba){return!1}return!0};a.t_c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Mob=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Lob=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
a.w_c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.v_c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.u_c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(D.a)(a,"CustomFunctionsLegacyInstaller",null,[685])},1228:function(D,F,b){function a(N,T,fa,Y,L){this.$=N;this.Ce=T;this.ownerAddinInfo=fa;this.je=void 0===L?null:L;this.COa=(void 0===Y?null:Y)||W.Task.Ua(!0);return this}function d(N){var T=H.call(this)||this;T.wBa="AddInCommandsDialog";
T.We=T.wBa;T.lc=5;T.dialogWidth=695;T.dialogHeight=438;T.GPg="100%";T.DPg="408px";T.EPg="15px";T.FPg="0";T.Jgg=N;return T}function c(N,T,fa,Y,L,P){var ea=N.Ra(9);ea.sharedInfo=T;return v.i(N,"InsertAgaveTaskpane",ea,fa,Y,L,P,0)}function m(){}D=b(0);var r=b(192),t=b(15);Object(D.a)(m,"AddinCommandsHost",null,[]);var k=b(1270),u=b(1346),w=b(933),v=b(81),A=b(519),y=b(365),x=b(160),z=b(35),J=b(1),B=b(273),C=b(140),H=C.a;Cm(d,H);d.prototype.KC=function(){H.prototype.KC.call(this);this.ep.style.width=this.GPg;
this.ep.style.height=this.DPg;this.ep.style.marginTop=this.EPg;this.ep.style.padding=this.FPg};d.prototype.CN=function(){H.prototype.CN.call(this);this.Ob.style.width=String.format("{0}px",this.dialogWidth);this.Ob.style.height=String.format("{0}px",this.dialogHeight)};d.prototype.dispose=function(){H.prototype.dispose.call(this);this.Jgg()};Jl.Object.defineProperties(d.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.ep}}});Object(D.a)(d,"AddInCommandsDialog",C.a,
[]);var W=b(52),S=b(60);C=b(107);b.d(F,"a",function(){return a});Cm(a,m);a.prototype.APg=function(){var N=this.COa;this.COa=W.Task.Ua(!0);return N};a.prototype.disposeHost=function(N){this.Ce.iOa(N)};a.prototype.setOwnerAddinEToken=function(N){this.ownerAddinInfo.eToken=N};a.prototype.showTaskpane=function(N,T,fa){var Y=this;t.ULS.sendTraceTag(17306639,220,50,"ShowTaskpane action called.");var L=null,P=!1;if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)){var ea=(new k.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new w.a,!0)).B_c(N.solutionId.substr(this.ownerAddinInfo.solutionId.length));L=T.getSharedRuntimeForTaskpane("Workbook",ea);P=!!L&&1===L.LifeTime;if(this.Ce.iVc(P?this.ownerAddinInfo.solutionId:N.solutionId,P?L:null,null))return}else if(ea=(new k.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.assetId,new w.a,!0)).B_c(N.assetId.substr(this.ownerAddinInfo.assetId.length)),L=T.getSharedRuntimeForTaskpane("Workbook",
ea),P=!!L&&1===L.LifeTime,this.Ce.iVc(P?this.ownerAddinInfo.assetId:N.assetId,P?L:null,null))return;this.Kcf(P,!0);this.COa=this.xfd(N,L,function(X,ja){X?(P&&(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?X.PrimaryMarketplace.SolutionId=Y.ownerAddinInfo.solutionId:X.PrimaryMarketplace.SolutionId=Y.ownerAddinInfo.assetId,X.SharedRuntime=L),X.WebExtensionOsfControlType=3,Y.Ce.YYa(X),fa(X.InstanceId,ja),Y.Kcf(P,!1)):(t.ULS.sendTraceTag(17306640,
220,10,"ShowTaskpane: instance id is null."),fa(null,ja))})};a.prototype.getSettings=function(N,T){var fa=null;(fa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.Ce.r3(N.solutionId):this.Ce.r3(N.assetId))?T(this.Ce.fU(fa).OsfPropertyBag):this.COa=this.xfd(N,null,function(Y){Y?T(Y.OsfPropertyBag):t.ULS.sendTraceTag(21594332,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(N,T,fa){function Y(ja,R,ba){return c(ea,
X,B.b(ja,L),R,ba,null)}function L(ja){var R=ja.Result,ba=R?R.AgaveData:null;ba?(P.Ce.cwe(ba,function(){var ha=new d(function(){P.disposeHost(ba.InstanceId)});ha.initializeAndShow("",null,null);return ha.containerDiv}),fa(ba.InstanceId,0)):(t.ULS.sendTraceTag(17306642,220,10,"ShowDialog: instance id is null."),fa(null,ja.Errors?ja.Errors[0].ErrorCause:5001))}var P=this;t.ULS.sendTraceTag(17306641,220,50,"ShowDialog action called.");var ea=this.$.ra.xa,X=a.yob(N,this.ownerAddinInfo);J.EwaSettings.wc()?
this.COa=y.a(this.$.userOperationManager,Y,function(ja){return new x.a(500,0,ja,64)},this.je):this.COa=y.a(this.$.userOperationManager,Y,function(ja){return new A.a(500,0,ja)},this.je)};a.prototype.createUILessSandbox=function(N,T,fa){var Y=this;t.ULS.sendTraceTag(17306643,220,50,"UILess action called.");var L=T.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),P=!!L&&1===L.LifeTime;(T=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.Ce.BKe(P?
this.ownerAddinInfo.solutionId:N.solutionId,P?L:null):this.Ce.BKe(P?this.ownerAddinInfo.assetId:N.assetId,P?L:null))?fa(T,0):this.COa=this.xfd(N,L,function(ea,X){ea?(P?(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?ea.PrimaryMarketplace.SolutionId=Y.ownerAddinInfo.solutionId:ea.PrimaryMarketplace.SolutionId=Y.ownerAddinInfo.assetId,ea.SharedRuntime=L,ea.TaskpaneVisible=!1,ea.WebExtensionOsfControlType=3,Y.Ce.YYa(ea)):(ea.WebExtensionOsfControlType=
4,Y.Ce.cwe(ea,function(){a.Nbb.ja(ea.InstanceId,new u.a);return a.Nbb.oa(ea.InstanceId).EGa})),fa(ea.InstanceId,X)):(t.ULS.sendTraceTag(17306644,220,10,"UILess: instance id is null."),fa(null,X))})};a.prototype.xfd=function(N,T,fa){function Y(oa,Sa,ma){return c(X,ja,B.b(oa,L),Sa,ma,null)}function L(oa){var Sa=oa.Result;(ea=Sa?Sa.AgaveData:null)||fa(null,oa.Errors?oa.Errors[0].ErrorCause:5001)}var P=this,ea=null,X=this.$.ra.xa,ja=a.yob(N,this.ownerAddinInfo);T&&(t.ULS.sendTraceTag(571774671,220,50,
"Shared runtime agave is inserted."),ja.SharedRuntimeId=T.Resid);var R=500,ba=0;void 0===ja.IsToBePersisted||null===ja.IsToBePersisted||ja.IsToBePersisted||(R=538,Y=function(oa,Sa,ma){t.ULS.sendTraceTag(542185173,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",ja.CurrentStoreType,ja.StoreId,Telemetry.PrivacyRules.GetAssetId(ja.CurrentStoreType,ja.StoreId,ja.AssetId));oa=B.b(oa,L);var na=X.Ra(9,null);na.sharedInfo=ja;return v.i(X,"ShowAgaveTaskpane",
na,oa,Sa,ma,null,0)},ba=16);if(J.EwaSettings.wc()){ba|=64;var ha=y.a(this.$.userOperationManager,Y,function(oa){return new x.a(R,0,oa,ba)},this.je)}else ha=y.a(this.$.userOperationManager,Y,function(oa){return new A.a(R,0,oa,ba)},this.je);return z.TaskExtensions.ts(ha,function(){return ea?P.bnd(X,ea.InstanceId,function(oa,Sa){if(oa){T||(ea.PrimaryMarketplace.MarketplaceType=N.storeType);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)&&(ea.OwnerAddinSolutionId=
P.ownerAddinInfo.solutionId);ea.OwnerAddinAssetId=P.ownerAddinInfo.assetId;ea.OwnerAddinStoreType=P.ownerAddinInfo.storeType;ea.OsfPropertyBag=[];for(Sa=0;Sa<oa.Settings.length;Sa++){var ma=[];ma[0]=oa.Settings[Sa].Name;ma[1]=oa.Settings[Sa].Value;ea.OsfPropertyBag[Sa]=ma}fa(ea,0)}else fa(null,Sa.Errors?Sa.Errors[0].ErrorCause:5001)}):W.Task.Ua(!1)},r.a.none,3,S.a.current)};a.prototype.bnd=function(N,T,fa){function Y(P,ea,X){P=B.b(P,L);var ja=N.Ra(1);ja.controlId=T;return v.i(N,"DdaLoadSettings",
ja,P,ea,X,null,0)}function L(P){fa(P.Result,P)}return J.EwaSettings.wc()?y.a(this.$.userOperationManager,Y,function(P){return new x.a(501,0,P,80)},this.je):y.a(this.$.userOperationManager,Y,function(P){return new A.a(501,0,P,16)},this.je)};a.prototype.Kcf=function(N,T){N&&window.performance&&window.performance.memory&&t.ULS.sendTraceTag(561598934,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",T,window.performance.memory.jsHeapSizeLimit,
window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(N){a.Nbb.tb(N)&&a.Nbb.oa(N).initializeAndShowWithTitle()};a.hideUILessDialog=function(N){a.Nbb.tb(N)&&a.Nbb.oa(N).hide()};a.yob=function(N,T){var fa={};J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(fa.SolutionId=N.solutionId,fa.Version=N.version,fa.StoreType=T.storeType,fa.StoreId=N.storeId,fa.AssetId=N.solutionId,fa.AssetStoreId=
"omex",fa.TargetType=1,fa.Width=350,fa.OwnerAddinSolutionId=T.solutionId,fa.OwnerAddinStoreType=T.storeType,fa.SharedRuntimeId=null,fa.Preload=!1,fa.Id=N.solutionId,fa.AppVersion=N.version,fa.CurrentStoreType=T.storeType,fa.OwnerAddinAssetId=T.assetId):(fa.AppVersion=N.appVersion,fa.StoreId=N.storeId,fa.AssetId=N.assetId,fa.CurrentStoreType=T.storeType,fa.TargetType=1,fa.AssetStoreId="omex",fa.Width=350,fa.OwnerAddinAssetId=T.assetId,fa.Id=fa.AssetId,fa.SharedRuntimeId=null,fa.Preload=!1);return fa};
a.Nbb=new C.a;Object(D.a)(a,"WACExcelAddinCommandsHost",m,[])},1263:function(D,F,b){function a(d,c,m,r){this._id=d;this.pkg=c;this.NLc=m;this.zSa=r}b.d(F,"a",function(){return a});D=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.pkg};a.prototype.getStoreType=function(){return this.NLc};Object(D.a)(a,"ExtensionIdentity",null,[744])},1264:function(D,F,b){function a(d,c,m){this.d3d=m}b.d(F,"a",function(){return a});D=b(0);Object(D.a)(a,"HostProperties",
null,[])},1265:function(D,F,b){function a(){this.aj={};this.zr={}}b.d(F,"a",function(){return a});D=b(0);Object(D.a)(a,"ExtensionLaunchProperties",null,[])},1266:function(D,F,b){function a(){this.Oa=k.AFrameworkApplication.Hb}b.d(F,"a",function(){return a});D=b(0);var d=b(1263),c=b(1265),m=b(1084),r=b(1268),t=b(1264),k=b(5),u=b(586),w=b(29);a.prototype.wLa=function(v,A,y,x,z){this.f$h(v,A,y,x,z)};a.prototype.f$h=function(v,A,y,x,z){var J=b(1267).ExtensionComponentInstance,B={};B[m.a.L4b]=v;B[m.a.Bse]=
A;B[m.a.DFa]=y;B[m.a.Hdd]=x;B[m.a.qxa]=z;32===(A===r.a.action?this.Oa.Pe(w.a.nIe,2,B):this.Oa.Pe(w.a.hTf,2,B))?(x=u.a.create().toString(),z.aj.InstanceToken&&(x=z.aj.InstanceToken),v=new J(v,A,y,x),a.vv[x]=v):v=new J(v,A,y,null);v.E5i(B)};a.prototype.e$h=function(v){var A=v.ExtId,y=v.ComponentType,x=v.ComponentId,z=v.HostProps;v=v.OptionalProps;A=new d.a(A.Id,A.StoreId,A.StoreType,A.AppVersion);z=new t.a(z.HostType,z.FormFactor,z.Locale);var J=new c.a;J.aj=v.OptionalProperties;J.zr=v.DevProperties;
a.instance.wLa(A,y,x,z,J)};a.prototype.getInstance=function(v){return a.vv[v]};a.prototype.fSi=function(v){delete a.vv[v]};Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.mCc||(a.mCc=new a);return a.mCc}}});a.mCc=null;a.vv={};Object(D.a)(a,"ExtensionLifeCycleManager",null,[745])},1267:function(D,F,b){function a(r,t,k,u){this.zSa=this.zF=null;this._id=r;this.rag=k;this.heg=u;this.Oa=c.AFrameworkApplication.Hb?c.AFrameworkApplication.Hb:null}b.r(F);b.d(F,"ExtensionComponentInstance",
function(){return a});D=b(0);var d=b(1266),c=b(5),m=b(29);a.prototype.D8c=function(){return this.rag};a.prototype.E5i=function(r){this.zF=r};a.prototype.stop=function(){var r=this.Oa.Pe(m.a.qMg,2,this.zF);d.a.instance.fSi(this.heg);return 32===r};a.prototype.koc=function(){this.Oa.Pe(m.a.LIf,2,this.zF)};Jl.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.zSa}}});Object(D.a)(a,"ExtensionComponentInstance",null,[768])},1268:function(D,F,b){function a(){}
b.d(F,"a",function(){return a});D=b(0);a.taskpane="Taskpane";a.action="Action";Object(D.a)(a,"ComponentTypeNames",null,[])},1270:function(D,F,b){function a(m,r,t,k){this.aMc=this.uhb=this.cMc=null;this.MCa=m;c.AFrameworkApplication.ha.ta("AddInCommandsMissingTabIsEnabled")?(this.cMc=t.RCh(),this.uhb=t.l7a,this.aMc=t.nii):(this.cMc=t.Ptc,this.aMc=this.uhb=null);this.SMb=r;this.xjg=k}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(5);a.prototype.Lta=function(m){m=this.lMa+this.assetId+m;return this.xJd?
(m in a.SVb||(a.SVb[m]="AddinControl"+a.gvg++),a.SVb[m]):m};a.prototype.B_c=function(m){if(this.xJd){var r=a.SVb,t;for(t in r){var k=t;if(m===r[t])return k.substr(this.lMa.length+this.assetId.length)}}return m};a.prototype.Kad=function(m){m=this.lMa+this.assetId+m;return this.xJd?(m in a.$Pc||(a.$Pc[m]="AddinTab"+a.nvg++),a.$Pc[m]):m};a.prototype.VDh=function(m){return m.toLowerCase()in this.Ptc?(d.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",m.toLowerCase()),this.lMa+this.Ptc[m.toLowerCase()]):
null};a.prototype.hEh=function(){if(!this.l7a)return null;for(var m=[],r=Ml(this.l7a),t=r.next();!t.done;t=r.next())m.push(this.lMa+t.value);return m};a.prototype.QBh=function(m){m=this.$Ne(m);return null===m?null:m[1]};a.prototype.OBh=function(m){m=this.$Ne(m);return null===m?null:m[2]};a.prototype.$Ne=function(m){return this.aNd&&m.toLowerCase()in this.aNd?(d.ULS.sendTraceTag(21017039,220,50,"Get attributes for Tab id: {0}.",m.toLowerCase()),this.aNd[m.toLowerCase()]):null};Jl.Object.defineProperties(a.prototype,
{lMa:{configurable:!0,enumerable:!0,get:function(){return this.MCa}},Ptc:{configurable:!0,enumerable:!0,get:function(){return this.cMc}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.SMb}},l7a:{configurable:!0,enumerable:!0,get:function(){return this.uhb}},aNd:{configurable:!0,enumerable:!0,get:function(){return this.aMc}},xJd:{configurable:!0,enumerable:!0,get:function(){return this.xjg}}});a.SVb={};a.$Pc={};a.nvg=0;a.gvg=0;Object(D.a)(a,"DefaultRibbonNamingProvider",null,[818])},
1324:function(D,F,b){function a(z){this.eA=null;this.RZf={};this.SZf={};this.a6c={};this.nrd={};this.$=z;this.Rpc=Object(c.a)(this,this.kcd,"handleServerEvent")}b.r(F);D=b(0);var d=b(15),c=b(37),m=b(82),r;(function(z){z[z.none=0]="none";z[z.testEvent=1]="testEvent";z[z.test1Event=2]="test1Event";z[z.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";z[z.worksheetActivatedEvent=11]="worksheetActivatedEvent";z[z.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";z[z.worksheetAddedEvent=
13]="worksheetAddedEvent";z[z.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";z[z.worksheetDeletedEvent=15]="worksheetDeletedEvent";z[z.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";z[z.worksheetFilteredEvent=17]="worksheetFilteredEvent";z[z.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";z[z.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";z[z.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";z[z.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";
z[z.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";z[z.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";z[z.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";z[z.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";z[z.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";z[z.worksheetMovedEvent=27]="worksheetMovedEvent";z[z.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";z[z.chartAddedEvent=
50]="chartAddedEvent";z[z.chartActivatedEvent=51]="chartActivatedEvent";z[z.chartDeactivatedEvent=52]="chartDeactivatedEvent";z[z.chartDeletedEvent=53]="chartDeletedEvent";z[z.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";z[z.tableDataChangedEvent=101]="tableDataChangedEvent";z[z.tableAddedEvent=102]="tableAddedEvent";z[z.tableDeletedEvent=103]="tableDeletedEvent";z[z.tableFilteredEvent=104]="tableFilteredEvent";z[z.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";z[z.customFunctionExecutionBeginEvent=
200]="customFunctionExecutionBeginEvent";z[z.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";z[z.commentAddedEvent=250]="commentAddedEvent";z[z.commentDeletedEvent=251]="commentDeletedEvent";z[z.commentChangedEvent=252]="commentChangedEvent";z[z.invocationMessage=1E3]="invocationMessage";z[z.cancellationMessage=1001]="cancellationMessage";z[z.metadataMessage=1002]="metadataMessage";z[z.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";z[z.visualChangeEvent=2001]=
"visualChangeEvent";z[z.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";z[z.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";z[z.shapeActivatedEvent=2101]="shapeActivatedEvent";z[z.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";z[z.shapeAddedEvent=2103]="shapeAddedEvent";z[z.shapeDeletedEvent=2104]="shapeDeletedEvent";z[z.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";z[z.wacOperationEvent=2201]="wacOperationEvent";z[z.recordingStateChangedEvent=
2202]="recordingStateChangedEvent";z[z.workbookActivatedEvent=2203]="workbookActivatedEvent";z[z.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";z[z.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";z[z.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";z[z.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";z[z.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";
z[z.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";z[z.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";z[z.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";z[z.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";z[z.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";z[z.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";z[z.pivotTableAddedEvent=
2900]="pivotTableAddedEvent";z[z.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";z[z.namedItemAddedEvent=3E3]="namedItemAddedEvent";z[z.namedItemDeletedEvent=3001]="namedItemDeletedEvent";z[z.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";z[z.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(r||(r={}));Object(D.b)("MessageType",r);var t=b(879),k=b(229),u=b(843),w=b(55),v=b(35),A=b(147),y=b(1),x=b(7);b.d(F,"DdaEventDispatch",function(){return a});
a.prototype.yVb=function(z){z&&(this.tha(),Array.add(this.eA,z))};a.prototype.inc=function(z){this.eA&&(Array.remove(this.eA,z),this.eA.length||(this.$.wantServerEvents=!1,this.$.uVi(this.Rpc),this.eA=null))};a.prototype.kcd=function(z,J){z=this.$.Zb.Ic("Task","DdaEventDispatch.HandleServerEvent");J=J.HMf;for(var B=0;B<J.length;B++)switch(J[B].EventType){case 2:var C=J[B],H={};H.Name=C.Name;H.BindingType=C.BindingType;H.ColCount=C.ColCount;H.RowCount=C.RowCount;this.pua(C.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,
H,null);break;case 4:this.pua(J[B].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(C=J[B],x.a.na(C.InstanceId)){this.a6c={};this.nrd={};for(H=0;H<C.Entries.length;H++)this.Nze(C.Entries[H],C.IsRemoteOverride);d.ULS.sendTraceTag(36444194,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",this.a6c,this.nrd,this.RZf,this.SZf)}else{H=Array(C.Entries.length);for(var W=0;W<C.Entries.length;W++)H[W]=
a.F8b(C.Entries[W],C.IsRemoteOverride);0<C.Entries.length&&1===C.Entries[0].Category?this.gJi(C.InstanceId,H):C.InstanceId&&this.pua(C.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}}z.stop()};a.prototype.gJi=function(z,J){var B=this,C=Object(m.a)(u.DdaFacade,k.a(this.$));v.TaskExtensions.Da(C.eEh(z),function(H){if(A.b(H)){var W=H.result;H=C.fn(W);if(W)if(H.Sid)B.pua(W,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J);else if(H.s_c)for(W=0;W<J.length;W++)Array.add(H.s_c,J[W]);
else H.s_c=J}else H.ng?d.ULS.sendTraceTag(38134347,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):H.Dh&&d.ULS.sendTraceTag(38134348,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)};a.prototype.jGb=function(z,J){this.pua(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)};a.prototype.CJi=function(z,J){var B=Object(m.a)(u.DdaFacade,k.a(this.$)),C=B.Ysh(z);C?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(C,
J,Object(c.a)(this,this.jGb,"sendActionToAddin")):B.FRg(z,J)};a.prototype.Nze=function(z,J){var B=!1,C=parseInt(z.Type),H=z.Target,W=Object(m.a)(u.DdaFacade,k.a(this.$));if((H=W.dj.kEh(C,H))&&0<Object.keys(H).length){B=!0;for(var S in H)if(H=S,W.dj.PWb(H)){var N=Array(1);N[0]=a.F8b(z,J);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var T=N[0][3];if(void 0!==T&&null!==T&&(T=Object(m.a)(Object,w.a.gi(T)))&&void 0!==T.triggerControlId&&null!==T.triggerControlId&&
void 0!==T.triggerSource&&null!==T.triggerSource){var fa=!1;J?(T.triggerSource="Unknown",fa=!0):W.z4g(T.triggerControlId,H)&&(T.triggerSource="ThisLocalAddin",fa=!0);fa&&(N[0][3]=w.a.Oc(T))}}this.pua(H,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,N)}}B?(this.nac(r[C],this.a6c),this.nac(r[C],this.RZf)):(this.nac(r[C],this.nrd),this.nac(r[C],this.SZf))};a.prototype.tha=function(){this.eA||(this.eA=[],this.$.Vfe(this.Rpc),this.$.wantServerEvents=!0)};a.prototype.nac=function(z,J){z in J||(J[z]=
0);J[z]+=1};a.prototype.$L=function(z,J,B){var C={};C.Target=J;C.Category=65536;C.Type=z;C.Message=B;C.Id=-1;this.Nze(C,!1)};a.prototype.Zmh=function(z,J){var B={Target:"",Category:2,Type:1E3};B.Message=J;B.Id=0;J=Array(1);J[0]=a.F8b(B,!1);this.CJi(z,J)};a.prototype.A5b=function(z,J,B,C){var H={};H.Target=B;H.Category=65536;H.Type=J;H.Message=C;H.Id=-1;J=Array(1);J[0]=a.F8b(H,!1);this.pua(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)};a.prototype.Ymh=function(z,J){this.pua(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,J)};a.prototype.pua=function(z,J,B,C){if(this.eA){var H=Object(m.a)(u.DdaFacade,k.a(this.$));if(!H||J!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&J!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||H.dj.PWb(z))for(z=new t.a(J,z,B,C),J=0,B=this.eA.length;J<B;J++)(C=this.eA[J])&&C(z)}};a.F8b=function(z,J){var B=Array(6);B[0]=z.Category;B[1]=z.Type;B[2]=z.Target;B[3]=z.Message;B[4]=z.Id;B[5]=J;return B};Object(D.a)(a,"DdaEventDispatch",null,[])},1346:function(D,F,b){function a(){var m=
c.call(this,void 0,void 0,void 0,!0)||this;m.wBa="AddinCommandsUILessDialog";m.CMc="WACDialogTitleText";m.USa="0";m.zBa=380;m.Peb=190;m.We=m.wBa;m.lc=5;m.zag=String.format("{0}px",m.zBa);m.TSa=String.format("{0}px",m.Peb);m.Fu=!1;m.EYe=!1;m.KC();return m}b.d(F,"a",function(){return a});D=b(0);F=b(140);var d=b(87),c=F.a;Cm(a,c);a.prototype.KC=function(){c.prototype.KC.call(this);this.ep.style.width=this.zag;this.ep.style.height=this.TSa;this.ep.style.padding=this.USa};a.prototype.Yu=function(m){this.CN();
document.getElementById(this.hi(this.CMc)).innerText=m};a.prototype.CN=function(){c.prototype.CN.call(this);this.Ob.style.width=String.format("{0}px",this.zBa);this.Ob.style.height=String.format("{0}px",this.Peb);this.Ob.removeAttribute(d.a.Wd);this.Ob.removeAttribute(d.a.DD)};a.prototype.hide=function(){this.kub()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Jl.Object.defineProperties(a.prototype,{EGa:{configurable:!0,
enumerable:!0,get:function(){return this.ep}}});Object(D.a)(a,"AddinCommandsUILessDialog",F.a,[816])},1352:function(D,F,b){function a(G){return Vk.call(this,G)||this}function d(G,la,Ya){this.rangePicker=null;this.$=G;this.Ce=la;this.xe=new P(G.fa);this.uz=new W(G,this.xe);this.lhf=Ya;this.b5c=new O.ScriptSharpLegacyMap}function c(G,la,Ya,Fb,lc){this.eNc=null;this.PMb=G;this.Jz=la;this.jI=Ya;this.wb=Fb;this.gmg=lc}function m(){}function r(){this.mfa=null}function t(G){if(!G)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",
"wacApiDelegates parameter is null");this.Jod=G}function k(G,la,Ya){return function(Fb){return function(lc,Lc){xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(la.ea,279,la.ma,1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(ad){ad=ad.result;var Kd=!1,ue=Ya.Ah.getOsfControl(G),af=null;ue&&(af=ue.getStoreType(),(ue=ue.getManifest())&&ue.getSharedRuntimeForCustomFunctions("Workbook")&&(Kd=!0));xh.TaskExtensions.Da(ad.$1e(G,af,Fb,Kd),function(Xe){Gk.b(Xe)?
Xe.result?lc(null):Lc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.invalidArgument,Rf.a.instance.da(1691))):Lc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,Rf.a.instance.da(1687)))},la.ma,3)},la.ma,3)}}}function u(G,la){this.cO=ei.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Jz=G;this.jI=la;this.Vgg=this.jI.Ah.getOsfControl(this.Jz)}function w(G,la,Ya,Fb){this.EVd="";this.HOb=0;this.cO=G;this._id=la;this.Jz=
Ya;this.jI=Fb}function v(G,la,Ya){this.meg=G;this.oeg=la;this.dig=Ya}function A(){this.k$d=this.u4d=this.Dz=!1}function y(G,la,Ya,Fb){this.xv=G;this.K0=Ya;this.hy=Fb.Ah.getOsfControl(la)}function x(G,la){this.jI=la;this.Jz=G}function z(G){this.Jz=G}function J(G){this.SGa={};this.Agi=G}function B(G,la){this.addinId=G;this.$=la;return this}function C(){}function H(G,la,Ya,Fb){this.Tkh=G;this.fileSize=la;this.Bij=Fb}function W(G,la){this.$=G;this.zP=la}function S(G,la,Ya,Fb){Ya=pj.call(this,576,0,Ya,
Fb)||this;Ya.BEd=new T("576",G,la);return Ya}function N(G,la,Ya,Fb,lc,Lc,ad,Kd){la=Oi.call(this,10,0,la,Kd)||this;la.Wib=Ya;la.ifb=Fb;la.L2=lc;la.HDa=Lc;la.request=ad;la.BEd=new T("10",G,ad);return la}function T(G,la,Ya){this.parentName=G;this.$=la;this.request=Ya}function fa(G,la){this.source=G;this.eventId=la}function Y(G,la,Ya,Fb,lc,Lc){var ad=G.Ra(1);ad.request=la;return Vi.i(G,"ExecuteRichApiRequest",ad,Ya,Fb,lc,Lc,0)}function L(G,la,Ya){this.$=G;this.zP=la;this.uz=Ya}function P(G){this.fa=G}
function ea(G,la,Ya,Fb){G=ke.call(this,G,"Select Data")||this;G.Tlb=null;G.txe=la;G.V_c=Ya;G.callback=Fb;return G}function X(G){this.wb=G}function ja(G){G.add("InternalTest","PreviewExecutionMethod",R)}function R(G,la){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof G+", objectId="+G+", value="+la);return null}function ba(G,la){this.Tfg=G;this.pgg=la}function ha(G){var la=G.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Ya=la.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ya.addParameter("shortcuts","String[]",1,null,0);la.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ya=la.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ya.addParameter("shortcuts","Object",1,null,0);la=G.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ya=la.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);Ya.addParameter("pickerCustomizationJsonString","String",1,null,0);la=G.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Ya=la.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Ya.addParameter("base64File","String",1,null,0);la=G.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);la.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Ya=la.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Ya.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);la=G.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);la.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Ya=la.addMethod("Register",1,"Void",0,0,"Register",0);Ya.addParameter("metadata",
"String",1,null,0);Ya.addParameter("javascript","String",1,null,0);la=G.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);la.addProperty("Enabled",1,"Boolean",1,!1,null,0);la.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);la.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);la=G.addEnumType("Microsoft.Authentication.IdentityType");la.addEnumField("OrganizationAccount",0);la.addEnumField("MicrosoftAccount",1);la=G.addEnumType("Microsoft.Authentication.AuthorityType");
la.addEnumField("External",0);la.addEnumField("Msa",1);la.addEnumField("Aad",2);la=G.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);la.addProperty("DisplayName",4,"String",1,!1,null,0);la.addProperty("Email",3,"String",1,!1,null,0);la.addProperty("FederationProvider",2,"String",1,!1,null,0);la.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);la=G.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);la.addProperty("AppId",4,"String",1,!1,null,0);la.addProperty("Authority",2,"String",1,!1,null,0);la.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);la.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);la.addProperty("TenantId",6,"String",1,!1,null,0);la.addProperty("Upn",1,"String",1,!1,null,0);la=G.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);la.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Ya=la.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Ya.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);la.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);la.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);la=G.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);la.addProperty("AuthChallenge",3,"String",1,!1,null,0);la.addProperty("CorrelationId",7,"String",1,!1,null,0);la.addProperty("Policy",4,"String",1,!1,null,0);la.addProperty("Resource",2,"String",1,!1,null,0);la.addProperty("Scope",5,"String",1,!1,null,0);la.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);la=G.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);la.addProperty("AccessToken",2,"String",1,!1,null,0);la.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);la=G.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);la.addProperty("Id",1,"String",1,!0,null,0);la.addProperty("Value",2,"Object",1,!1,null,0);la=G.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Ya=la.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Ya.addParameter("id","String",1,null,0);Ya=la.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Ya.addParameter("id","String",1,null,0);la=G.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);la.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Ya=la.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ya.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);la=G.addEnumType("Microsoft.AppRuntime.AppRuntimeState");la.addEnumField("Inactive",0);la.addEnumField("Background",1);la.addEnumField("Visible",2);la=G.addEnumType("Microsoft.AppRuntime.Visibility");la.addEnumField("Hidden",1);la.addEnumField("Visible",2);la=G.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);la.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ya=la.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ya.addParameter("jsonCreate","String",1,null,0);Ya=la.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ya.addParameter("jsonUpdate","String",1,null,0);Ya=la.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ya.addParameter("id","String",
1,null,0);Ya=la.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ya.addParameter("id","String",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=G.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);la.addProperty("Id",2,"String",1,!0,null,0);Ya=la.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Ya.addParameter("visibility","Boolean",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=G.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);la.addProperty("Enabled",3,"Boolean",1,!1,null,0);la.addProperty("Id",2,"String",1,!0,null,0);la.addProperty("Label",4,"String",1,!0,null,0);Ya=la.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ya.addParameter("enabled","Boolean",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la=G.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);la.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Ya=la.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ya.addParameter("key","String",1,null,0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);la.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);la=G.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");la.addEnumField("Unknown",0);la.addEnumField("Basic",1);la.addEnumField("Premium",2);la=G.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Ya=la.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ya.addParameter("feature","String",1,null,0);Ya.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ya=la.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ya.addParameter("feature","String",1,null,0);Ya=la.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ya.addParameter("feature","String",
1,null,0);Ya.addParameter("fallbackValue","Boolean",1,null,0);la.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ya=la.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ya.addParameter("experienceId","String",1,null,0);Ya=la.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Ya.addParameter("feature","String",1,null,0);la=G.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);la.addProperty("Id",5,"String",1,!0,null,0);la.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);la.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);la=G.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);la.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);la=G.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);la.addMethod("Disable",3,"Void",0,1,"Disable",0);la.addMethod("Enable",2,"Void",0,1,"Enable",0);la.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function oa(G,la,Ya,Fb){this.ua=G;this.PH=la;this.bmj=Ya;this.clh=Fb}function Sa(G){this.Xei=G}function ma(G){this.gwa=G;this.Gbg=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1);this.Dcg=Fk.AppsForOfficeSingleSignOnManager.QLe();
this.Ccg=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2AAD",!1);this.Ecg=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2MSA",!1)}function na(){}function xa(){}function Oa(){}function ib(G,la){this.reb=la;this.Jz=G}function sb(){this.OUd=null;this.E8d=this.YRb=this.YR="";this.M9d=!0;this.options=null}function nb(G,la){this.mdb=G;this.Ufb=la}function Gb(){}function Ha(){this.fZd=this.BYd=
this.iea=null;this.Ufb=0}function ca(G){var la=lk.call(this)||this;la.$=G;la.fc();return la}function Ra(G,la,Ya){this.z9f=null;this.B9f=0;this.yb=G;this.Ug=la;this.jWd=Ya}function ua(){}function ta(G,la,Ya,Fb,lc){var Lc=Rk.call(this)||this;Lc.J$a={};Lc.E5b={};Lc.Pua=null;Lc.S7a=null;Lc.$=G;Lc.viewBlockContainerHelpers=Ya;Lc.Ce=la;Lc.j5c=Fb;Lc.Bi=lc;Lc.Bi.$b(Cd.a.hTf,Ni.a.frame,Object(Ve.a)(Lc,Lc.SOh,"handleShowExtensionTaskPane"));Lc.Bi.$b(Cd.a.LIf,Ni.a.frame,Object(Ve.a)(Lc,Lc.COh,"handleRestartExtensionTaskPane"));
Lc.Bi.$b(Cd.a.nIe,Ni.a.frame,Object(Ve.a)(Lc,Lc.gNh,"handleExecuteAddinAction"));return Lc}function db(){var G=Nk.call(this)||this;G.TSa="calc(100% - 46px)";G.ANb="15px";G.USa="0";G.sbg="WACDialogPanel";G.zBa=695;G.tbg=462;G.Peb="80%";G.h$f=350;G.gVd="100%";G.lc=5;G.We="AppsForOfficeInsertionDialog";G.bCc=!!Jf.AFrameworkApplication.ha&&Jf.AFrameworkApplication.ha.ta("OfficeAddinEnableInsertDialogAccessibilityFix");return G}function Ta(){var G=qb.call(this)||this;G.isTable=!1;G.isPivotTable=!1;G.hasTableHeaders=
!1;G.tableName=null;G.userSelectedPivotTable=!1;return G}function qb(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function za(){this.rNd=this.auc=null;this.jr=0;this.sNd=null}function Ia(){this.Ce=null}function va(G,la){this.Thb=la}function Ua(G){return oi.call(this,G)||this}function Kb(G){var la=Uh.call(this)||this;la.$=G;la.isFirstLaunch=!1;return la}function ia(G){pe.ULS.sendTraceTag(41521353,
1313,50,"SmartLookupManager - Initialize");this.$df=Jf.AFrameworkApplication.ha.ta("IsTellMeUpSellEnterpriseEnabled");this.wei=Jf.AFrameworkApplication.ha.Wa("SmartLookupApprovedOriginPattern");this.E5a=Jf.AFrameworkApplication.ha.Wa("SmartLookupShredderServiceEndpoint");this.Vei=ii.a.dM(Jf.AFrameworkApplication.ha.Wa("AppCatalogUrl")||"");this.D5a=new Za;this.D5a.EnableAllTabV2=!0;this.D5a.EnableIntentService=!0;this.D5a.EnableInDocumentSearch=Jf.AFrameworkApplication.ha.ta("SmartLookupEnableInDocumentSearch");
this.D5a.EnableLocalSearch=Jf.AFrameworkApplication.ha.ta("SmartLookupEnableLocalSearch");this.D5a.IntentServiceEndpoint=E.yHh();this.Qei=new fb(G,this.E5a)}function E(){}function fb(G,la,Ya){this.uqj=9E5;this.xqj=3E5;this.rod=null;this.Cdf="";this.ood=0;this.qxe=Date.now;this.gwa=G;this.E5a=la;(void 0===Ya||Ya)&&this.V7c()}function Za(){}function ec(){}function zc(){}function Ab(){}function vb(){}function kc(G,la,Ya,Fb,lc,Lc){this.$=G;this.agaveCommandManager=Lc}function td(G){var la=ij.call(this)||
this;la.ddaFacade=null;la.SBf=null;la.$=G;G.ea.La(106,la);la.fc();return la}function Oc(){}function tc(){}function sc(G){this.MDa=G}function ic(G,la,Ya){this.iframe=G;this.onSuccess=la;this.onError=Ya;$addHandler(window,"message",Object(Ve.a)(this,this.bYe,"handleResponse"))}function Ga(G,la){return $f.a.$md(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},Jf.AFrameworkApplication.ha.qd("MaxRetriesForLoadingScript",0),G,la)}function cb(G){var la=Xh.call(this)||this;
la.$=G;la.fc();return la}function Tb(G,la){this.QNa=this.RNa=null;this.ariaLiveNotifier=G;this.$=la;this.FRc=!1;this.$.ea.La(224,this)}function Bb(G){var la=wh.call(this)||this;la.$=G;la.fc();return la}function nc(G){G=Fh.call(this,G)||this;G.handler=null;return G}function Gc(G,la,Ya,Fb){this.bJd=void 0===G?null:G;this.HNc=void 0===la?null:la;this.W_c=void 0===Ya?null:Ya;this.W4b=void 0===Fb?0:Fb}function La(G,la,Ya,Fb,lc,Lc,ad){ad=void 0===ad?null:ad;this.disposed=!1;this.$=G;pe.ULS.shipAssertTag(34936844,
0,!(void 0===la||null===la),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",hi.a.y2());this.Ce=la;this.kte=Ya;this.PVb=Fb;this.Wfa=lc;this.Nkb=Lc;this.Xl=new Af.a;this.Vfa=new gc;this.W4c=ad;hk.a.I$b=hk.a.jIe;this.f0c=new wg.a;this.OZa=new wg.a}function Wa(G){this.lEa=this.mEa=this.Im=this.$q=null;this.kEf=0;this.$=G.$;this.addinUICommandHandler=G;this.Xl=new Af.a}function wa(G,la){this.MCa=G;this.Oda=new dc;this.Zda=new xb(la)}function Da(G,la,Ya,Fb,lc,
Lc){G=Jb.call(this,G,la)||this;G.D7=null;G.cea=null;G.fea=null;G.Zda=Ya;G.pdg=Fb;G.SMb=lc;G.Jna=Lc;return G}function Va(G){this.B8d=null;if(cj.c(G))throw pe.ULS.sendTraceTag(9041813,220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.Uig=G}function Jb(G,la){this.A$d=new wg.a;this.Cw=this.rv=null;this.ghb=G;this.Oda=la}function Hb(G){this.C8d=this.WZd=this.w$d=null;this.isOfficeTab=!1;this.$We=this.UKf=null;this._id=
G;this.JQa[Pg.a.id]=this._id}function Mb(G){this.WWd=this.VZd=this.bjb=null;if(cj.c(G))throw pe.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),Error.create("GroupDefinition id should not be null or undefined");this._id=G;this.mua[Pg.a.id]=this._id}function Ub(G,la,Ya,Fb,lc,Lc){this.BMb=new wg.a;this.D7=this.Cw=this.rv=null;this.ghb=G;this.Oda=la;this.Zda=Ya;this.SMb=Fb;this.Jna=lc;this.WYd=Lc}function pb(){this.groups=this.attributes=this.title=this.id=null;
this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function gb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function Qa(){this.controls=this.title=this.id=null;this.groupType=0;this.attributes=null}function eb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function xb(G){this.kBa=G}function dc(){}function Nc(G,la){this.bjb=new Pc(G,la)}function Pc(G,
la){this.$kg=G;this.Iag=la}function Fd(G){this.MCa=G}function Ea(G,la,Ya){this.iI=this.bTa=null;this.ghb=G;this.Zda=la;this.Oda=Ya;this.Zfg=new wg.a}function Xa(G){this.C7=null;if(cj.c(G))throw pe.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=G}function hc(G){this.xHc=null;if(cj.c(G))throw pe.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),
Error.create("MenuItemDefinition id should not be null or undefined");this._id=G;this.zQ[Pg.a.id]=this._id}function Xb(G,la){this.Hea=this.VWd=null;if(cj.c(G)||cj.c(la))throw pe.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.YWd=la;this._id=G;this.$z[Pg.a.id]=this._id}function Ic(G,la,Ya,Fb,lc,Lc,ad,Kd){Kd=void 0===Kd?null:Kd;this.rb=new ik.a;this.vSa=G;this.UWd=la;this.wm=
Ya;this.GTb=Fb;this.afa=lc;this.$8f=Lc;this.Jna=ad;this.j5d=Kd}function Qc(G,la,Ya,Fb,lc,Lc,ad){this.qza=new uk.a;this.Kr=G;this.Ah=la;this.Xl=Ya;this.ribbonManager=Fb;this.contextMenuManager=lc;this.ez=Lc;this.Vfa=ad;this.VH=Jf.AFrameworkApplication.za.bB}function Cb(G,la,Ya){this.kUd=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=G;this.eventBuilder=la;this.contextMenuBuilder=Ya}function $c(G){this.Lbg=G.entitlement}function ae(G,
la,Ya,Fb,lc){la=void 0===la?null:la;Ya=void 0===Ya?null:Ya;Fb=void 0===Fb?null:Fb;lc=void 0===lc?0:lc;if(cj.c(G)&&cj.c(la))throw pe.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.zX=G;this.Ngg=la;this.hkg=Ya;this.uhb=Fb;this.Rcg=lc}function Mc(G){this.e5d=null;if(cj.c(G))throw pe.ULS.sendTraceTag(9175315,
220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.h9f=G}function Hd(){}function Nd(){}function ge(G){this.d2d=null;this.e0d=G}function Ed(G,la,Ya){this.rb=G;this.W7=la;this.lUd=Ya}function Zc(G,la,Ya,Fb,lc,Lc,ad){this.Kr=G;this.Im=la;this.tya=Ya;this.nMe=Fb;this.uph=lc;this.displayName=Lc;this.u$e=ad}function he(){var G=Xc.call(this)||this;G.Im=null;G.$q=null;return G}function Ke(){new Wb.a(Ec.a.instance)}function Ue(){}function Pb(G){this.Ugg=
G}function kb(G,la,Ya){this.Qa=new ik.a;this.context=new wb;this.DRa=this.N9a=this.EMb=null;this.contextActivationMgr=G;this.hvg=la;this.dvg=Ya;this.appName=Jf.AFrameworkApplication.ha.Wa("WebAppShortName")}function yb(G,la,Ya,Fb){this.tFb=Jf.AFrameworkApplication.ha.Wa("WebServiceBase");this.appName=G;this.Dfb=la;this.zfb=Ya;this.Nhb=void 0===Fb?null:Fb}function Ma(G){var la=Ba.call(this)||this;la.properties=G;return la}function jd(G){var la=-1;switch(G.toLowerCase()){case "omex":la=0;break;case "spcatalog":la=
1;break;case "spapp":la=2;break;case "filesystem":la=3;break;case "exchange":la=4;break;case "registry":la=6;break;case "inmemory":la=7;break;case "uploadfiledevcatalog":la=8;break;case "hardcodedpreinstall":la=9;break;case "excatalog":la=10;break;case "wopicatalog":la=16}return la}function Zd(G){var la=null;switch(G){case 0:la="omex";break;case 1:la="spcatalog";break;case 2:la="spapp";break;case 3:la="filesystem";break;case 4:la="exchange";break;case 6:la="registry";break;case 7:la="inmemory";break;
case 8:la="uploadfiledevcatalog";break;case 9:la="hardcodedpreinstall";break;case 10:la="excatalog";break;case 16:la="wopicatalog"}return la}function Zb(G){var la={};Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.solutionId=G.solutionId,la.version=G.version,la.storeType=G.storeType,la.storeId=G.storeId,la.assetId=G.assetId,la.assetStoreId=G.storeType,la.targetType=G.targetType,la.requireConsent=G.requireConsent||!1,la.isAddinCommands=
!0,la.id=G.solutionId,la.appVersion=G.version,la.currentStoreType=G.storeType):(la.id=G.assetId,la.assetId=G.assetId,la.appVersion=G.appVersion,la.currentStoreType=G.storeType,la.storeId=G.storeId,la.assetStoreId=G.storeType,la.targetType=G.targetType,la.requireConsent=G.requireConsent||!1,la.isAddinCommands=!0);return la}function wb(){this.Kr=this.Sba=0;this.WPc=null;this.slc=this.AOd=0;this.rqa=null}function gc(){this.sWa=null}function uc(G,la){var Ya=qk.call(this)||this;Ya.statusBarManager=null;
Ya.agaveCommandManager=null;Ya.ez=la;Ya.$=G;Ya.xlj=G.Mb+"OfficeAddinLabel-Medium14";Ya.$.ea.ub(29,function(Fb){Ya.statusBarManager=Fb;Fb.VF(Ya)});Ya.$.fa.ak(Object(Ve.a)(Ya,Ya.ed,"onSessionIdChanged"));Ya.ez.erg(Object(Ve.a)(Ya,Ya.cXe,"handleAddinCommandsLoadingMessageChanged"));Ya.$.ea.ub(206,function(Fb){Ya.agaveCommandManager=Fb;Fb.Hsg(Object(Ve.a)(Ya,Ya.kqe,"clearLoadingAddinMessage"))});return Ya}function id(){}function Wc(){this.$i=null;this.visible=!1}function pd(G,la){this.Va=G;this.TPg=la}
function Yd(){this.SUd=this.wyc=null}function be(G){this.T7d=new me(G)}function me(G){this.s8=G;this.hSb=this.s8.ribbonBuilder}function Gd(){var G=Bk.call(this)||this;G.ofd=null;G.Xed=null;G.ribbon=null;return G}function Rd(){this.C$f=new wg.a}function Yf(G){return wk.call(this,G)||this}function mg(G){var la=this;this.Qob=null;this.F_c=!1;this.oT=this.je=null;this.$=G;xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.Xa(this.$.ea,328,327,1,"Microsoft.Office.Excel.WebUI.Client.AugmentationLoop.IAugmentationLoopManager"),
function(Ya){(Ya=Ya.result)?(pe.ULS.sendTraceTag(538808589,0,50,"DataFromPicturePaneCommandManager::Initialize - AugmentationLoopManager instantiated."),la.Qob=new zf(G,Ya),la.F_c&&(la.Qob.QJf(la.je,la.oT),la.F_c=!1)):pe.ULS.sendTraceTag(538808590,0,10,"DataFromPicturePaneCommandManager::Initialize - Failed to instantiate AugmentationLoopManager.")},this.$.ma,3)}function zf(G,la){var Ya=Ai.call(this)||this;Ya.v0e=Ce.getTypeName();Ya.xub=null;Ya.imageWidth=0;Ya.imageHeight=0;Ya.tableData=null;Ya.errorMessage=
null;Ya.Aub=null;Ya.ANc=!1;Ya.$=G;Ya.augmentationLoopManager=la;Ya.initialize();return Ya}function Ce(){var G=gk.call(this)||this;G.errorCode=null;G.errorDescription=null;G.html=null;G.H_=Object.assign(new ok.a,{T_:Ce.getTypeName(),B_:Ce.ve()});return G}function ne(G){var la=Jk.call(this)||this;la.$=G;la.fc();return la}function Bf(G,la){var Ya=ld.call(this)||this;Ya.$=G;Ya.usa=new DOMParser;Ya.cache=new Vj.a;Ya.indexedDB=la;la.te()&&Ya.indexedDB.initialize("Scripts","OfficeScriptingCache");Ya.W3=
!1;Ya.Nm=new vd([],function(Fb){ld.XUf(Fb)});Ya.pg=new vd([],function(Fb){ld.Vsc(Fb)});Ya.Rs=new vd([],function(Fb){ld.Vsc(Fb)});Ya.Hk=new vd([],function(){});return Ya}function Le(G,la,Ya){this.t4a=!1;this.$=G;this.Pqa=la;this.Bv=Ya;this.Raj()}function gd(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Buc=this.V$=this.Rj=null}function $b(G,la,Ya,Fb,lc,Lc,ad,Kd,ue){var af=this;this.Rz=null;this.cache=new Vj.a;this.kva=!1;this.QA=null;this.h_d=this.k7d=this.m7d=this.j7d=this.l7d=this.i7d=!1;this.t8d=
this.u5d=this.T6d=null;this.qEa={};this.$=G;this.dKc=Ya;this.indexedDB=Fb;this.Bke=lc;this.Bv=Lc;this.Pqa=ad;this.Ue=Kd;this.UX=kf.a.Ip?ue:new Od(G,this);this.AAg=new Xd(this,G);this.$dg=Lh.a.Ta.Lb;this.nWf="";this.W3=!1;this.waj(new vd([],function(Xe){ld.XUf(Xe)}));this.vaj(new vd([],function(Xe){ld.Vsc(Xe)}));this.zaj(new vd([],function(Xe){ld.Vsc(Xe)}));this.xaj(new vd([],function(){}));Fb.te()&&(this.kva=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));G=!0;if(Ei.a.Ple){if(this.cache.te()&&
(la=this.h8c(kf.a.T6b(this.$)),la.isSuccess&&(G=ie.getElapsedSeconds(la.timeStamp,Lh.a.Ta.Lb),this.Bv.Gx=new sa(!0,!0),this.Rz=new sa(la.value,!0),G=this.Rz.value?604800<G:86400<G,this.NHb(!0))),this.v7h=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery"),this.gth(),"undefined"!==typeof makerstorage&&this.p9e)if(this.nWf=Ob(this.$),Uc(this.$))ac(this.$,"localstorageToken"),this.Bv.Gx=new sa(!0,!0),this.Rz=new sa(!0,!0),this.NHb(!0);else if((la=kf.a.PRe())&&
makerstorage.setStorageEnvironmentOverride(la),G)try{this.Bv.Bpe().then(function(){return af.Pqa.h8b()}).then(function(Xe){return af.sPh(Xe)}).then(function(){af.NHb(!1)}).catch(function(){af.NHb(!1)})}catch(Xe){pe.ULS.sendTraceTag(576026048,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",Xe.message)}}else pe.ULS.sendTraceTag(592815191,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser.")}
function Fc(G,la,Ya,Fb,lc){this.actionName=G;this.shapeId=la;this.f2i=Ya;this.Aqe=Fb;this.Gaa=lc}function Vc(G,la,Ya,Fb){this.Hdd=G;this.yjh=la;this.qxa=Ya;this.DFa=Fb}function ud(G){return aj.a.Sd(G)?Qe.a.nFe:Qe.a.mFe}function Ge(G){return aj.a.Sd(G)?G.isChromeRtl?Qe.a.odh:Qe.a.ndh:Qe.a.qHa}function ce(G){G=G.ra.xa.Ra(1);G.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,
RequestBody:"",RequestFlags:256};return G}function Ae(G,la,Ya,Fb,lc){function Lc(){function pg(sg,lh,Jh){return Vi.i(Kd.xa,"ExecuteRichApiRequest",Fb,ci.b(sg,la),ci.a(lh,Ya),Jh,null,0)}if(ad.KFa()||0<Kd.xa.n3||0<Kd.Ek.n3)return!1;ue&&ad.WC(ue);af&&Kd.Tt(af);Xe&&Kd.YC(Xe);dg.EwaSettings.wc()?ad.yt(new Oj.a(507,0,pg,80)):ad.yt(new sj.a(507,0,pg,16));return!0}var ad=G.userOperationManager,Kd=G.ra,ue=null,af=null,Xe=null;Lc()||(ue=function(){Lc()},af=function(){Lc()},Xe=function(){Lc()},ad.CB(ue),Kd.ls(af),
Kd.FB(Xe));return lc.task}function Ob(G){if(Uc(G))return dg.EwaSettings.getBooleanFeatureGate(kf.a.Nyb,!1)?"makerservicelocal":"localstorage";G=kf.a.PRe();return kf.a.rIh(G)}function ac(G,la){Uc(G)&&(dg.EwaSettings.getBooleanFeatureGate(kf.a.Nyb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(G.Ba.UserSessionId);makerstorage.setUserAccessInfo(new Vd(la,null));dg.EwaSettings.getBooleanFeatureGate(kf.a.f4f,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")}function fc(G,la){la.OfficeScriptsRunFromButton=dg.EwaSettings.getBooleanFeatureGate(kf.a.Iwa,!1);la.OfficeScriptsRunFromButtonPreAuth=dg.EwaSettings.getBooleanFeatureGate(kf.a.jni,!1);la.WacTaskPaneInfra=aj.a.Sd(G);la.PipeEnableExtractPermission=dg.EwaSettings.getBooleanFeatureGate(kf.a.vFi,!1);la.UseV1ServiceURLs=dg.EwaSettings.getBooleanFeatureGate(kf.a.f4f,!1)}function Uc(G){return"TestHost"===G.Ba.DocumentHostInfo.HostTier}function Vd(G,la){this.currentUserMlapiToken=this.currentUserToken=
null;this.currentUserToken=G;this.currentUserMlapiToken=la}function ld(){this.Hk=null;this.W3=this.Xba=this.Ms=this.Y5=this.Xxa=this.A8a=this.Czd=this.Wba=this.qJa=!1;this.Rs=this.pg=this.Nm=null}function Od(G,la){this.QA=null;this.$=G;this.automateCommandManager=la;return this}function De(){}function Yb(){this.Gx=null;return this}function sa(G,la,Ya,Fb,lc){this.value=G;this.isSuccess=la;this.timeStamp=void 0===Ya?null:Ya;this.errorCode=void 0===Fb?"":Fb;this.errorMessage=void 0===lc?"":lc}function hb(){this.Gx=
null}function cc(G,la){this.QA=null;this.$=G;this.Ue=la;return this}function xc(G){this.J9=yh.b(G)||{};this.gF=this.gF||null}function vd(G,la){this.scripts=G;this.WUf=la}function Xd(G,la){this.automateCommandManager=G;this.$=la}function Je(){this.QA=null}function ff(G,la,Ya){this.$=G;this.oAuthManager=la;this.Bv=Ya;this.Ilb=new Ye;this.qke=this.oAuthManager&&null==this.oAuthManager.b3a()?!1:this.oAuthManager.b3a()}function Ye(){this.token=null;this.timeStamp=0}function Pe(G){return zj.call(this,G)||
this}function wf(G,la){this.automateCommandManager=G;this.$=la}function lf(G){var la=Nj.call(this)||this;la.$=G;la.fc();return la}function kg(G){this.Gb=null;this.$=G}function Bg(){return zd.call(this)||this}function Qf(){return zd.call(this)||this}function Ug(){return zd.call(this)||this}function Kf(){return zd.call(this)||this}function Of(){return zd.call(this)||this}function hh(){return zd.call(this)||this}function Eg(){return zd.call(this)||this}function ng(){return zd.call(this)||this}function eg(){return zd.call(this)||
this}function Yg(){return zd.call(this)||this}function Ud(){return zd.call(this)||this}function Tc(){return zd.call(this)||this}function qg(){return zd.call(this)||this}function Lg(){return zd.call(this)||this}function de(){return zd.call(this)||this}function tg(){return zd.call(this)||this}function ve(){return zd.call(this)||this}function tf(){return zd.call(this)||this}function lg(){return zd.call(this)||this}function Og(){return zd.call(this)||this}function Fa(){return zd.call(this)||this}function lb(){return zd.call(this)||
this}function pc(){return zd.call(this)||this}function qc(){return zd.call(this)||this}function Md(){return zd.call(this)||this}function Pd(){return zd.call(this)||this}function ee(){return zd.call(this)||this}function xf(){return zd.call(this)||this}function Se(){return zd.call(this)||this}function cf(){return zd.call(this)||this}function dh(){return zd.call(this)||this}function df(){return zd.call(this)||this}function Uf(){return zd.call(this)||this}function bf(){return zd.call(this)||this}function If(){return zd.call(this)||
this}function vf(){return zd.call(this)||this}function Dg(){return zd.call(this)||this}function Pf(){return zd.call(this)||this}function gg(){return zd.call(this)||this}function Sb(){return zd.call(this)||this}function Hc(){return zd.call(this)||this}function ed(){return zd.call(this)||this}function Id(){return zd.call(this)||this}function hf(){return zd.call(this)||this}function Hf(){return zd.call(this)||this}function Cg(){return zd.call(this)||this}function uf(){return zd.call(this)||this}function ih(){return zd.call(this)||
this}function qa(){return zd.call(this)||this}function tb(){return zd.call(this)||this}function rc(){return zd.call(this)||this}function kd(){return zd.call(this)||this}function Td(){return zd.call(this)||this}function qe(){return zd.call(this)||this}function Ne(){return zd.call(this)||this}function Ja(){return le.call(this,195,16)||this}function ob(){return le.call(this,194,8)||this}function Nb(){return zd.call(this)||this}function Jc(){return le.call(this,198,2)||this}function bd(){return le.call(this,
197,1)||this}function Yc(){return le.call(this,196,32)||this}function Db(){return zd.call(this)||this}function mc(){return le.call(this,193,4)||this}function le(G,la){var Ya=zd.call(this)||this;Ya.pea=G;Ya.DRd=la;return Ya}function hd(){return zd.call(this)||this}function of(){return zd.call(this)||this}function Rc(){return zd.call(this)||this}function Kc(){return zd.call(this)||this}function yg(){return zd.call(this)||this}function nf(){return zd.call(this)||this}function Kg(){return vg.call(this,
11,16)||this}function jg(){return vg.call(this,10,128)||this}function zg(){return zd.call(this)||this}function hg(){return zd.call(this)||this}function bh(){return zd.call(this)||this}function Nf(){return zd.call(this)||this}function fe(){return zd.call(this)||this}function ch(){return zd.call(this)||this}function Wg(){return zd.call(this)||this}function qd(){return zd.call(this)||this}function fd(){return zd.call(this)||this}function kh(){return vg.call(this,9,2)||this}function Lf(){return vg.call(this,
8,1)||this}function te(){return vg.call(this,7,8)||this}function Wd(){return vg.call(this,6,32)||this}function mh(){return zd.call(this)||this}function ug(){return zd.call(this)||this}function ki(){return zd.call(this)||this}function Hg(){return zd.call(this)||this}function Mg(){return zd.call(this)||this}function Eh(){return zd.call(this)||this}function Gh(){return zd.call(this)||this}function qi(){return zd.call(this)||this}function Bh(){return zd.call(this)||this}function Cf(){return zd.call(this)||
this}function Yh(){return zd.call(this)||this}function aa(){return zd.call(this)||this}function ab(){return zd.call(this)||this}function Rb(){return zd.call(this)||this}function Cc(){return vg.call(this,4,64)||this}function Bc(){return zd.call(this)||this}function Dd(){return zd.call(this)||this}function Ee(){return zd.call(this)||this}function we(){return zd.call(this)||this}function Be(){return zd.call(this)||this}function We(){return zd.call(this)||this}function bg(){return zd.call(this)||this}
function Ff(){}function Ng(){return zd.call(this)||this}function Sg(){return vg.call(this,3,4)||this}function vg(G,la){var Ya=zd.call(this)||this;Ya.pea=G;Ya.DRd=la;return Ya}function vh(){return zd.call(this)||this}function Ag(){return zd.call(this)||this}function Aa(){return zd.call(this)||this}function pa(){return zd.call(this)||this}function ub(){return Me.call(this,185,18)||this}function xd(){return zd.call(this)||this}function oe(){return Me.call(this,181,14)||this}function sf(){return Me.call(this,
169,2)||this}function ef(){return Me.call(this,168,1)||this}function fh(){return zd.call(this)||this}function jh(){return Me.call(this,182,15)||this}function oh(){return zd.call(this)||this}function Ph(){return zd.call(this)||this}function Zg(){return Me.call(this,180,13)||this}function ig(){return Me.call(this,186,19)||this}function Sh(){return Me.call(this,175,8)||this}function Ch(){return Me.call(this,176,9)||this}function mf(){return Me.call(this,187,20)||this}function Sd(){return Me.call(this,
174,7)||this}function Gf(){return Me.call(this,179,12)||this}function Wf(){return Me.call(this,178,11)||this}function f(){return Me.call(this,177,10)||this}function rb(){return zd.call(this)||this}function oc(){return Me.call(this,170,3)||this}function cd(){return Me.call(this,172,5)||this}function $d(){return Me.call(this,173,6)||this}function ze(){return Me.call(this,183,16)||this}function He(){return Me.call(this,184,17)||this}function Ie(){return Me.call(this,171,4)||this}function Me(G,la){var Ya=
zd.call(this)||this;Ya.pea=G;Ya.opType=la;return Ya}function rg(){return zd.call(this)||this}function pf(){return zd.call(this)||this}function $g(){return zd.call(this)||this}function Df(){return zd.call(this)||this}function Vf(){return zd.call(this)||this}function og(){return zd.call(this)||this}function h(){return zd.call(this)||this}function e(){return zd.call(this)||this}function I(){return zd.call(this)||this}function Z(){return zd.call(this)||this}function Ca(){return zd.call(this)||this}function Na(){return zd.call(this)||
this}function Vb(){return zd.call(this)||this}function vc(){return zd.call(this)||this}function md(){return zd.call(this)||this}function Ld(){return zd.call(this)||this}function Jd(){return zd.call(this)||this}function je(){return zd.call(this)||this}function qf(){return zd.call(this)||this}function rf(){return zd.call(this)||this}function Zf(){return zd.call(this)||this}function Ef(){return Re.call(this)||this}function sh(){return zd.call(this)||this}function Jg(){return zd.call(this)||this}function gh(){return zd.call(this)||
this}function ah(){return zd.call(this)||this}function Wh(){return zd.call(this)||this}function zh(){return zd.call(this)||this}function Te(){return zd.call(this)||this}function Th(){return zd.call(this)||this}function V(){return zd.call(this)||this}function Pa(){return Fg.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Ib(){return Fg.call(this,79,[0,1,2,-102])||
this}function wc(){return Fg.call(this,75,[-101])||this}function nd(){return Fg.call(this,81,[100,101,102,103,104,105,106])||this}function Bd(){return zd.call(this)||this}function yd(){return Fg.call(this,85,[328,329,330,331,332,333,334,335])||this}function re(){return Re.call(this)||this}function xe(G,la,Ya){this.response=this.request=this.eventId=this.source=null;G&&(this.source=G.source,this.eventId=G.eventId,this.request=la,this.response=Ya)}function Re(){return zd.call(this)||this}function Tf(){return Fg.call(this,
83,[500,501,502])||this}function ag(){return Fg.call(this,76,[-100])||this}function Qg(){return Fg.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Rg(){return Fg.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function Hh(){return Fg.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Fg(G,la){var Ya=zd.call(this)||this;Ya.pea=G;Ya.tAj=la;return Ya}function Xg(){return zd.call(this)||this}function cg(){return zd.call(this)||
this}function Mh(){return zd.call(this)||this}function Nh(){return zd.call(this)||this}function zd(){this.tCc=this.uCc=this.uIc=this.ZMc=null}function li(G,la,Ya){this.y5b=null;this.xef=la;this.wef=Ya;this.$=G;this.$.Aaa&&this.$.xtg(Object(Ve.a)(this,this.afi,"macroRecorderEwaEventHandler"));G.ea.La(297,this)}function fg(){}function Si(){}function uj(){this.Edb=null}function $i(){this.pb=null}function ai(G){this._initialized=!1;this.n7a={};this.rtc={};this.VH=Jf.AFrameworkApplication.za.bB;this.Gdd=
G}function Q(G,la,Ya){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=la;this.expiration=Ya}function ra(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function mb(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function Qb(){}
function Sc(G,la){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=la}function Ad(){}b.r(F);var ye=b(514),Ze=b(1077),sd=b(0),pe=b(15),Ve=b(37),Li;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.notAllowed=2]="notAllowed";G[G.apiNotAvailable=3]="apiNotAvailable";G[G.unresolvedPendingRequest=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.adalTimeout=6]="adalTimeout";G[G.userNotSignedIn=7]=
"userNotSignedIn";G[G.userAborted=8]="userAborted";G[G.silentSignInFailed=9]="silentSignInFailed";G[G.invalidResourceUrl=10]="invalidResourceUrl";G[G.invalidGrant=11]="invalidGrant";G[G.connectionLost=12]="connectionLost";G[G.clientError=13]="clientError";G[G.serverError=14]="serverError"})(Li||(Li={}));Object(sd.b)("ErrorCodes",Li);Ad.XQf="SharepointOnline";Ad.quf="OneDriveWOPI";Object(sd.a)(Ad,"HostApplicationType",null,[]);Object(sd.a)(Sc,"OutstandingRequest",null,[]);Qb.Rki="AADSTS50058";Qb.invalidResourceUrl=
"AADSTS50001";Qb.Kki="AADSTS65001";Qb.dli="AADSTS70011";Qb.userAborted="13002";Qb.Kkc="Popup Window is null";Qb.Nwd="Popup Window closed";Qb.adalTimeout="Token renewal operation failed due to timeout";Qb.yqj="tokenRevoked";Object(sd.a)(Qb,"WopiHostErrorType",null,[]);var Jf=b(5),ui=b(839),bj=b(586),ji=b(41);mb.Vth=function(G){switch(G){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(sd.a)(mb,"WopiAuthContext",null,[796]);Object(sd.a)(ra,"WopiIdentityInfo",
null,[721]);Object(sd.a)(Q,"WopiIdentityToken",null,[720]);var Ei=b(24),mi=b(145),Zh=b(523),gi=b(177),gf=b(76),vj=b(338);ai.prototype.n_a=function(G){this._initialized||(G.vn(gi.a.ixf),G.km(gi.a.ixf,Object(Ve.a)(this,this.iud,"onReceivedAccessToken")),this._initialized=!0)};ai.prototype.getAccessToken=function(G,la,Ya){var Fb=this;Ya=void 0===Ya?null:Ya;this.NLa(G,la);return new Promise(function(lc,Lc){if(Fb.Zfd(la))if(la in Fb.n7a)Lc("unresolvedPendingRequest");else{var ad=window.setTimeout(function(){var ue=
{};pe.ULS.sendTraceTag(37856032,344,10,ji.c((ue.error="Request timeout.",ue.callerId=la,ue)));Lc("timeout")},12E4);Fb.J7c(G,la,Ya,function(ue,af){window.clearTimeout(ad);ue?lc(ue):(ue={},pe.ULS.sendTraceTag(37856033,369,15,ji.c((ue.error=Li[af],ue))),Lc(af))})}else{var Kd={};pe.ULS.sendTraceTag(37856034,344,10,ji.c((Kd.error="Caller is not allowed.",Kd)));Lc("notAllowed")}})};ai.prototype.getPrimaryIdentityInfo=function(G){var la=this;return new Promise(function(Ya,Fb){if(la.Zfd(G))la.jFh(function(Lc,
ad){Lc?Ya(Lc):(Lc={},pe.ULS.sendTraceTag(37856064,369,10,ji.c((Lc.error=ad.toString(),Lc))),Fb(ad))});else{var lc={};pe.ULS.sendTraceTag(37856065,344,10,ji.c((lc.error="Caller is not allowed.",lc)));Fb("notAllowed")}})};ai.prototype.getAuthContext=function(G){var la=this;return new Promise(function(Ya,Fb){var lc=la.getAuthContextSync(G);lc?Ya(lc):Fb("notAllowed")})};ai.prototype.getAuthContextSync=function(G){if(this.Zfd(G)){var la=new mb;la.upn=Jf.AFrameworkApplication.ha.Wa("UserPrincipalName");
la.userId=Jf.AFrameworkApplication.ha.Wa("LoggableUserId");la.authority=Jf.AFrameworkApplication.ha.Wa("HostAuthAuthority");la.tenantId=Jf.AFrameworkApplication.ha.Wa("TenantId");la.isAnonymous=Jf.AFrameworkApplication.ha.ta("IsAnonymousUser");la.supportsAuthToken=this.TRh(G);G=Jf.AFrameworkApplication.ha.Wa("HostAuthType");la.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return la}la={};pe.ULS.sendTraceTag(40751647,344,10,ji.c((la.error="Caller is not allowed.",la)));return null};
ai.prototype.TRh=function(G){var la=ui.a.mub;if(Ei.a.Jja){var Ya=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HostSupportsTeamsElectronSSO",!1);return la&&Ya&&ui.a.jYf?Array.contains(ui.a.jYf,G.toLowerCase()):!1}return la};ai.prototype.J7c=function(G,la,Ya,Fb){var lc=this,Lc=[];Array.add(Lc,Object.assign(new gf.a,{name:"CallerId",string:la}));Array.add(Lc,Object.assign(new gf.a,{name:Zh.a.ELd,string:G.correlationId}));mi.a.sendTelemetryEvent(Object.assign(new vj.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Lc}));Lc=bj.a.create().toString();var ad="getAccessToken_"+Lc,Kd=this.VH.Ic("ComponentAttach",ad);this.rtc[ad]=Kd;var ue={};ue[Zh.a.FLd]=Lc;ue[Zh.a.nkj]=G.resource;ue[Zh.a.okj]=G.scope;ue[Zh.a.mVf]=Jf.AFrameworkApplication.ha.Wa("HostAuthType");ue[Zh.a.rkj]=Jf.AFrameworkApplication.ha.Wa("UserPrincipalName");ue[Zh.a.pkj]=G.silentLogin;ue[Zh.a.kkj]=G.options;ue[Zh.a.ELd]=G.correlationId;ue[Zh.a.lkj]=la;Ya&&(ue[Zh.a.addinName]=
Ya.AddinName,ue[Zh.a.jkj]=Ya.AddinTrustId);this.Gdd.execute(function(af){lc.n_a(af);af.Yj(gi.a.getAuthToken,ue)});this.n7a[Lc]=new Sc(G,Fb)};ai.prototype.jFh=function(G){var la=Jf.AFrameworkApplication.ha.Wa("UserName"),Ya=Jf.AFrameworkApplication.ha.Wa("UserPrincipalName"),Fb=Jf.AFrameworkApplication.ha.Wa("LoggableUserIdSpace"),lc=new ra;lc.email=Ya;lc.displayName=la;switch(Fb){case "OrgIdPuid":lc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":lc.authority="MicrosoftAccount";
break;default:lc.authority=Fb}G(lc,null)};ai.prototype.iud=function(G){var la=null;try{var Ya=G.Values[Zh.a.FLd],Fb=G.Values[Zh.a.ikj],lc=G.Values[Zh.a.mVf],Lc=G.Values[Zh.a.qkj],ad=null,Kd=null,ue=this.n7a[Ya];if("undefined"!==typeof ue&&ue){var af=[];Array.add(af,Object.assign(new gf.a,{name:Zh.a.ELd,string:ue.requestParameters.correlationId}));mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:af}));la=ue.requestCallback;
delete this.n7a[Ya];"undefined"!==typeof Fb&&Fb&&Fb.length?Kd=new Q(Fb,lc,Lc):ad=Li[this.Qfi(G)];Ya="getAccessToken_"+Ya;Ya in this.rtc&&(this.rtc[Ya].stop(),delete this.rtc[Ya]);la(Kd,ad)}else ad={},pe.ULS.sendTraceTag(37856066,344,10,ji.c((ad.error="No matching outstanding request for request ID.",ad.requestId=Ya,ad)))}catch(Xe){G=G.Values[Zh.a.FLd],G in this.n7a&&delete this.n7a[G],this.afc(),G={},pe.ULS.sendTraceTag(37856067,344,10,ji.c((G.error=Xe.message,G.stack=Xe.stack,G))),la&&la(null,"generalException")}};
ai.prototype.Zfd=function(G){var la=Jf.AFrameworkApplication.ALh();G=G.toLowerCase();la=Ml(la);for(var Ya=la.next();!Ya.done;Ya=la.next())if(G===Ya.value.toLowerCase())return!0;la=ui.a.EQc;for(var Fb in la)if(G===la[Fb].toLowerCase())return!0;return!1};ai.prototype.Qfi=function(G){G=G.Values[Zh.a.mkj];this.afc();var la={};pe.ULS.sendTraceTag(39068821,344,15,ji.c((la.error=G,la)));return G?-1<G.indexOf(Qb.Rki)?9:-1<G.indexOf(Qb.Kkc)||-1<G.indexOf(Qb.Nwd)?12:-1<G.indexOf(Qb.invalidResourceUrl)?10:-1<
G.indexOf(Qb.userAborted)?8:-1<G.indexOf(Qb.dli)||-1<G.indexOf(Qb.Kki)||G===Qb.yqj?11:-1<G.indexOf(Qb.adalTimeout)?6:0:13};ai.prototype.NLa=function(G,la){G=this.YOi(G.resource);var Ya={};pe.ULS.sendTraceTag(39921882,344,50,ji.c((Ya.callerId=la,Ya.resource=G,Ya)))};ai.prototype.afc=function(){var G={};pe.ULS.sendTraceTag(39068822,344,50,ji.c((G.userAgent=window.navigator.userAgent,G)))};ai.prototype.YOi=function(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/",
"\\")};Object(sd.a)(ai,"WopiIdentityManager",null,[686]);var ej=b(274);$i.prototype.$h=function(G){this.pb=G;G.register(ai,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ac().Lc(function(){return new ai(G.yc("Postmessage.IHostPostmessenger"))})};$i.prototype.init=function(){Jf.AFrameworkApplication.ha&&Jf.AFrameworkApplication.ha.Xv(Object(Ve.a)(this,this.HA,"onFullAppSettingsReady"))};$i.prototype.HA=function(){try{this.pb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){pe.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}};$i.prototype.dispose=function(){};$i.main=function(){ej.a.instance.oj(new $i)};Jl.Object.defineProperties($i.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object(sd.a)($i,"WopiIdentityPackage",null,[8,9]);var Ti=b(12),oj=b(211),wg=b(210),qj=b(600);uj.prototype.ZZh=function(G){return this.aBg.contains(G.operation)};uj.prototype.Qtj=function(G){for(var la=[],Ya=Ml(G.payload.batchedOperations),
Fb=Ya.next();!Fb.done;Fb=Ya.next())la.push(new qj.a(G.operation,Fb.value));return la};Jl.Object.defineProperties(uj.prototype,{aBg:{configurable:!0,enumerable:!0,get:function(){this.Edb||(this.Edb=new wg.a,this.Edb.add(12),this.Edb.add(11));return this.Edb}}});Object(sd.a)(uj,"MacroRecorderBatchedEventList",null,[]);var Qh=b(55),Lj=b(123),Uj=b(787);Si.prototype.equals=function(G,la){return G===la};Si.prototype.getHashCode=function(G){return G};Si.prototype.C3=function(G){return G};Object(sd.a)(Si,
"UserOperationNameComparer",null,[48,182]);fg.yLh=function(){fg.Rc||(fg.Rc=new Uj.a(new Si),fg.Rc.add(507),fg.Rc.add(10),fg.Rc.add(576),fg.Rc.add(563),fg.Rc.add(564),fg.Rc.add(565),fg.Rc.add(566),fg.Rc.add(567),fg.Rc.add(568),fg.Rc.add(569),fg.Rc.add(570),fg.Rc.add(571),fg.Rc.add(572),fg.Rc.add(573),fg.Rc.add(574),fg.Rc.add(575),fg.Rc.add(501),fg.Rc.add(520),fg.Rc.add(1),fg.Rc.add(1002),fg.Rc.add(129),fg.Rc.add(198),fg.Rc.add(500),fg.Rc.add(519),fg.Rc.add(538),fg.Rc.add(1E3),fg.Rc.add(1003),fg.Rc.add(144),
fg.Rc.add(502),fg.Rc.add(505),fg.Rc.add(179),fg.Rc.add(205),fg.Rc.add(134),fg.Rc.add(230),fg.Rc.add(103),fg.Rc.add(110),fg.Rc.add(112),fg.Rc.add(113),fg.Rc.add(124),fg.Rc.add(133),fg.Rc.add(154),fg.Rc.add(162),fg.Rc.add(168),fg.Rc.add(172),fg.Rc.add(201),fg.Rc.add(222),fg.Rc.add(227),fg.Rc.add(513),fg.Rc.add(534),fg.Rc.add(539),fg.Rc.add(545),fg.Rc.add(547),fg.Rc.add(555),fg.Rc.add(558),fg.Rc.add(562),fg.Rc.add(585),fg.Rc.add(1001),fg.Rc.add(1005),fg.Rc.add(1008),fg.Rc.add(1010),fg.Rc.add(1011),fg.Rc.add(1012),
fg.Rc.add(1018),fg.Rc.add(252),fg.Rc.add(253),fg.Rc.add(258),fg.Rc.add(101),fg.Rc.add(102),fg.Rc.add(108),fg.Rc.add(118),fg.Rc.add(257),fg.Rc.add(119),fg.Rc.add(120),fg.Rc.add(123),fg.Rc.add(126),fg.Rc.add(127),fg.Rc.add(130),fg.Rc.add(140),fg.Rc.add(159),fg.Rc.add(160),fg.Rc.add(165),fg.Rc.add(166),fg.Rc.add(167),fg.Rc.add(169),fg.Rc.add(189),fg.Rc.add(223),fg.Rc.add(214),fg.Rc.add(228),fg.Rc.add(233),fg.Rc.add(247),fg.Rc.add(504),fg.Rc.add(511),fg.Rc.add(512),fg.Rc.add(525),fg.Rc.add(533),fg.Rc.add(537),
fg.Rc.add(542),fg.Rc.add(544),fg.Rc.add(548),fg.Rc.add(550),fg.Rc.add(551),fg.Rc.add(552),fg.Rc.add(554),fg.Rc.add(577),fg.Rc.add(584),fg.Rc.add(586),fg.Rc.add(587),fg.Rc.add(588),fg.Rc.add(592),fg.Rc.add(1009),fg.Rc.add(1016),fg.Rc.add(1017));return fg.Rc};fg.Rc=null;Object(sd.a)(fg,"MacroRecorderUnrecognizedEventList",null,[]);li.prototype.init=function(G){this.$.Aaa&&(G?this.y5b=G:pe.ULS.sendTraceTag(40232404,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};
li.prototype.Y5c=function(G){if(this.aSf())try{if(this.wef.ZZh(G))for(var la=this.wef.Qtj(G),Ya=Ml(la),Fb=Ya.next();!Fb.done;Fb=Ya.next())this.MKe(Fb.value);else this.MKe(G)}catch(lc){G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",Lj.a(G.operation),lc.stack),pe.ULS.sendTraceTag(40232405,0,10,G)}};li.prototype.MKe=function(G){var la=this.xef.NRe(G,!0);la?(this.y5b(la.eventId,Qh.a.Oc(G.payload)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
la.eventId),pe.ULS.sendTraceTag(42259009,0,50,G)):(la=this.xef.NRe(G,!1))?(G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",la.eventId),pe.ULS.sendTraceTag(579090249,0,50,G)):fg.yLh().contains(G.operation)||(this.y5b(0,Qh.a.Oc(G.operation)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Lj.a(G.operation)),pe.ULS.sendTraceTag(40232406,0,50,G))};li.prototype.afi=function(G,la){this.aSf()&&this.Y5c(la)};
li.prototype.aSf=function(){return this.$.zja&&this.y5b&&this.$.vaa?!0:!1};Object(sd.a)(li,"MacroRecorderEventHandler",null,[697]);var dg=b(1);zd.prototype.ug=function(){};zd.prototype.FU=function(){};zd.prototype.zd=function(G){this.Qwc.add(G)};zd.prototype.Vb=function(G){this.operations.contains(G)||this.operations.add(G)};zd.prototype.dkb=function(){this.featureGates.add(727)};zd.prototype.$Da=function(G){this.lJe.add(G)};Jl.Object.defineProperties(zd.prototype,{operations:{configurable:!0,enumerable:!0,
get:function(){this.uIc||(this.uIc=new wg.a,this.ic());return this.uIc}},Qwc:{configurable:!0,enumerable:!0,get:function(){this.ZMc||(this.ZMc=new wg.a,this.ug());return this.ZMc}},lJe:{configurable:!0,enumerable:!0,get:function(){this.tCc||(this.tCc=new wg.a);return this.tCc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.uCc||(this.uCc=new wg.a,this.FU());return this.uCc}}});Object(sd.a)(zd,"MacroRecorderEventBase",null,[]);Cm(Nh,zd);Nh.prototype.ic=function(){this.Vb(100)};Jl.Object.defineProperties(Nh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(sd.a)(Nh,"AccessibilityCheckRunEvent",zd,[]);Cm(Mh,zd);Mh.prototype.ic=function(){this.Vb(241)};Mh.prototype.ug=function(){this.zd(function(G){return G.addToPrintArea})};Jl.Object.defineProperties(Mh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(sd.a)(Mh,"AddedToPrintAreaEvent",zd,[]);Cm(cg,zd);cg.prototype.ic=function(){this.Vb(516)};Jl.Object.defineProperties(cg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 65}}});Object(sd.a)(cg,"AutoFilterToggledEvent",zd,[]);Cm(Xg,zd);Xg.prototype.ic=function(){this.Vb(502)};Xg.prototype.ug=function(){this.zd(function(G){return!(G.y1a().FirstColumn===G.y1a().LastColumn&&G.y1a().FirstRow===G.y1a().LastRow)})};Jl.Object.defineProperties(Xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(sd.a)(Xg,"AutoSumEvent",zd,[]);Cm(Fg,zd);Fg.prototype.ic=function(){this.Vb(529);this.Vb(594)};Fg.prototype.ug=
function(){var G=this;this.zd(function(la){return Array.contains(G.tAj,la.B$c())})};Jl.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pea}}});Object(sd.a)(Fg,"ChartPropertyAppliedEventBase",zd,[]);Cm(Hh,Fg);Object(sd.a)(Hh,"ChartAxisChangedEvent",Fg,[]);Cm(Rg,Fg);Object(sd.a)(Rg,"ChartAxisTitleChangedEvent",Fg,[]);Cm(Qg,Fg);Object(sd.a)(Qg,"ChartDataLabelsChangedEvent",Fg,[]);Cm(ag,Fg);Object(sd.a)(ag,"ChartDataSelectedEvent",Fg,[]);Cm(Tf,Fg);
Object(sd.a)(Tf,"ChartDataTableChangedEvent",Fg,[]);var Mj=b(786),wj=b(404),Ci=b(82);Cm(Re,zd);Object(sd.a)(Re,"RichApiRequestExecutedEventBase",zd,[]);Jl.Object.defineProperties(xe.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(sd.a)(xe,"MacroRecorderRichApiRequestExecutedPayload",null,[115]);Cm(re,Re);re.prototype.vE=function(G){re.f6||(re.f6=new Uj.a(Mj.a.Dl()),re.f6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
re.f6.add("fa000000014"));return!!G&&re.f6.contains(G.toLowerCase())};re.prototype.ic=function(){this.Vb(507);this.Vb(10);this.Vb(576)};re.prototype.ug=function(){var G=this;this.zd(function(la){return Object(wj.a)(xe,la)&&(la=Object(Ci.a)(xe,la),la.isValid&&G.vE(la.source))?(pe.ULS.sendTraceTag(589898770,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",la.eventId),!0):!1})};Jl.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});re.f6=null;Object(sd.a)(re,"ChartFormatRichApiRequestExecutedEvent",Re,[]);Cm(yd,Fg);Object(sd.a)(yd,"ChartGridlinesChangedEvent",Fg,[]);Cm(Bd,zd);Bd.prototype.ic=function(){this.Vb(528)};Jl.Object.defineProperties(Bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(sd.a)(Bd,"ChartInsertedEvent",zd,[]);Cm(nd,Fg);Object(sd.a)(nd,"ChartLegendChangedEvent",Fg,[]);Cm(wc,Fg);Object(sd.a)(wc,"ChartRowColumnSwitchedEvent",Fg,[]);Cm(Ib,Fg);
Object(sd.a)(Ib,"ChartTitleChangedEvent",Fg,[]);Cm(Pa,Fg);Object(sd.a)(Pa,"ChartTypeChangedEvent",Fg,[]);Cm(V,zd);V.prototype.ic=function(){this.Vb(521)};Jl.Object.defineProperties(V.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(sd.a)(V,"ConnectorFloatingObjectResizedEvent",zd,[]);Cm(Th,zd);Th.prototype.ic=function(){this.Vb(109)};Jl.Object.defineProperties(Th.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(sd.a)(Th,"EntitySelectedEvent",
zd,[]);Cm(Te,zd);Te.prototype.ic=function(){this.Vb(149);this.Vb(147)};Jl.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(sd.a)(Te,"FindCellEvent",zd,[]);Cm(zh,zd);zh.prototype.ic=function(){this.Vb(122)};Jl.Object.defineProperties(zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(sd.a)(zh,"FloatingObjectAltTextAppliedEvent",zd,[]);Cm(Wh,zd);Wh.prototype.ic=function(){this.Vb(522)};Jl.Object.defineProperties(Wh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(sd.a)(Wh,"FloatingObjectDeletedEvent",zd,[]);Cm(ah,zd);ah.prototype.ic=function(){this.Vb(524)};Jl.Object.defineProperties(ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(sd.a)(ah,"FloatingObjectMovedAndResizedEvent",zd,[]);Cm(gh,zd);gh.prototype.ic=function(){this.Vb(523)};Jl.Object.defineProperties(gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});
Object(sd.a)(gh,"FloatingObjectRotatedEvent",zd,[]);Cm(Jg,zd);Jg.prototype.ic=function(){this.Vb(543)};Jl.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(sd.a)(Jg,"GroupDetailsShownOrHiddenEvent",zd,[]);Cm(sh,zd);sh.prototype.ic=function(){this.Vb(125)};Jl.Object.defineProperties(sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(sd.a)(sh,"HyperlinksRemovedFromRangeEvent",zd,[]);Cm(Ef,Re);Ef.prototype.vE=
function(G){Ef.f6||(Ef.f6=new Uj.a(Mj.a.Dl()),Ef.f6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Ef.f6.add("fa000000005"));return!!G&&Ef.f6.contains(G.toLowerCase())};Ef.prototype.ic=function(){this.Vb(507);this.Vb(10);this.Vb(576)};Ef.prototype.ug=function(){var G=this;this.zd(function(la){return Object(wj.a)(xe,la)?(la=Object(Ci.a)(xe,la),la.isValid&&G.vE(la.source)):!1})};Jl.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Ef.f6=null;Object(sd.a)(Ef,
"IdeasRichApiRequestExecutedEvent",Re,[]);Cm(Zf,zd);Zf.prototype.ic=function(){this.Vb(115)};Jl.Object.defineProperties(Zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(sd.a)(Zf,"LinkedEntityConvertedEvent",zd,[]);Cm(rf,zd);rf.prototype.ic=function(){this.Vb(114)};Jl.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(sd.a)(rf,"LinkedEntityDisambiguationPaneToggledEvent",zd,[]);Cm(qf,zd);qf.prototype.ic=
function(){this.Vb(119)};Jl.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(sd.a)(qf,"MovedToEdgeEvent",zd,[]);Cm(je,zd);je.prototype.ic=function(){this.Vb(191)};je.prototype.FU=function(){this.dkb()};Jl.Object.defineProperties(je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(sd.a)(je,"NamedSheetViewCreatedEvent",zd,[]);Cm(Jd,zd);Jd.prototype.ic=function(){this.Vb(200)};Jd.prototype.FU=function(){this.dkb()};
Jl.Object.defineProperties(Jd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(sd.a)(Jd,"NamedSheetViewDeletedEvent",zd,[]);Cm(Ld,zd);Ld.prototype.ic=function(){this.Vb(192)};Ld.prototype.FU=function(){this.dkb()};Jl.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(sd.a)(Ld,"NamedSheetViewExitedEvent",zd,[]);Cm(md,zd);md.prototype.ic=function(){this.Vb(199)};md.prototype.FU=function(){this.dkb()};
Jl.Object.defineProperties(md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(sd.a)(md,"NamedSheetViewRenamedEvent",zd,[]);Cm(vc,zd);vc.prototype.ic=function(){this.Vb(195)};vc.prototype.FU=function(){this.dkb()};Jl.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(sd.a)(vc,"NamedSheetViewSwitchedEvent",zd,[]);Cm(Vb,zd);Vb.prototype.ic=function(){this.Vb(174)};Jl.Object.defineProperties(Vb.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(sd.a)(Vb,"OutlineLevelSetEvent",zd,[]);Cm(Na,zd);Na.prototype.ic=function(){this.Vb(244)};Jl.Object.defineProperties(Na.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(sd.a)(Na,"PageBreakInsertedEvent",zd,[]);Cm(Ca,zd);Ca.prototype.ic=function(){this.Vb(245)};Jl.Object.defineProperties(Ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(sd.a)(Ca,
"PageBreakRemovedEvent",zd,[]);Cm(Z,zd);Z.prototype.ic=function(){this.Vb(246)};Jl.Object.defineProperties(Z.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(sd.a)(Z,"PageBreaksAllResetEvent",zd,[]);var Ig=b(7);Cm(I,zd);I.prototype.ic=function(){this.Vb(503)};I.prototype.ug=function(){this.zd(function(G){return!Ig.a.na(G.pasteParameters.ClientEstimationFloatingObjectId)&&2===G.pasteParameters.CopyPasteTargetType&&!G.isFromCurrentSession})};Jl.Object.defineProperties(I.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(sd.a)(I,"PasteArtOtherWorkbookEvent",zd,[]);Cm(e,zd);e.prototype.ic=function(){this.Vb(503)};e.prototype.ug=function(){this.zd(function(G){return!Ig.a.na(G.pasteParameters.ClientEstimationFloatingObjectId)&&2===G.pasteParameters.CopyPasteTargetType&&G.isFromCurrentSession})};Jl.Object.defineProperties(e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(sd.a)(e,"PasteArtSameWorkbookEvent",
zd,[]);Cm(h,zd);h.prototype.ic=function(){this.Vb(204)};Jl.Object.defineProperties(h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(sd.a)(h,"PasteHtmlEvent",zd,[]);Cm(og,zd);og.prototype.ic=function(){this.Vb(506)};Jl.Object.defineProperties(og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(sd.a)(og,"PasteRangeEvent",zd,[]);Cm(Vf,zd);Vf.prototype.ic=function(){this.Vb(503)};Vf.prototype.ug=function(){this.zd(function(G){return 1===
G.pasteParameters.CopyPasteTargetType})};Jl.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(sd.a)(Vf,"PasteShadowWorkbookRangeEvent",zd,[]);Cm(Df,zd);Df.prototype.ic=function(){this.Vb(180)};Jl.Object.defineProperties(Df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(sd.a)(Df,"PasteStringEvent",zd,[]);Cm($g,zd);$g.prototype.ic=function(){this.Vb(220)};Jl.Object.defineProperties($g.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object(sd.a)($g,"PendingMergeEvent",zd,[]);Cm(pf,zd);pf.prototype.ic=function(){this.Vb(510)};Jl.Object.defineProperties(pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(sd.a)(pf,"PictureInsertedEvent",zd,[]);Cm(rg,zd);rg.prototype.ic=function(){this.Vb(161)};Jl.Object.defineProperties(rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(sd.a)(rg,"PivotDrillToggledEvent",zd,[]);
Cm(Me,zd);Me.prototype.ic=function(){this.Vb(225)};Me.prototype.ug=function(){var G=this;this.zd(function(la){return la.opType===G.opType})};Jl.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pea}}});Object(sd.a)(Me,"PivotTableSettingsChangedEventBase",zd,[]);Cm(Ie,Me);Object(sd.a)(Ie,"PivotTableAllItemLabelsRepeatedEvent",Me,[]);Cm(He,Me);Object(sd.a)(He,"PivotTableAltTextDescriptionChangedEvent",Me,[]);Cm(ze,Me);Object(sd.a)(ze,"PivotTableAltTextTitleChangedEvent",
Me,[]);Cm($d,Me);Object(sd.a)($d,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Me,[]);Cm(cd,Me);Object(sd.a)(cd,"PivotTableBlankLineAfterEachItemToggledEvent",Me,[]);Cm(oc,Me);Object(sd.a)(oc,"PivotTableColumnGrandTotalShownEvent",Me,[]);Cm(rb,zd);rb.prototype.ic=function(){this.Vb(132)};Jl.Object.defineProperties(rb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(sd.a)(rb,"PivotTableCreatedEvent",zd,[]);Cm(f,Me);Object(sd.a)(f,"PivotTableDisplayErrorStringToggledEvent",
Me,[]);Cm(Wf,Me);Object(sd.a)(Wf,"PivotTableDisplayNullStringToggledEvent",Me,[]);Cm(Gf,Me);Object(sd.a)(Gf,"PivotTableErrorStringChangedEvent",Me,[]);Cm(Sd,Me);Object(sd.a)(Sd,"PivotTableExpandCollapseButtonsShownEvent",Me,[]);Cm(mf,Me);Object(sd.a)(mf,"PivotTableIndentChangedEvent",Me,[]);Cm(Ch,Me);Object(sd.a)(Ch,"PivotTableItemsWithNoDataOnColumnsShownEvent",Me,[]);Cm(Sh,Me);Object(sd.a)(Sh,"PivotTableItemsWithNoDataOnRowsShownEvent",Me,[]);Cm(ig,Me);Object(sd.a)(ig,"PivotTableLayoutTypeSetEvent",
Me,[]);Cm(Zg,Me);Object(sd.a)(Zg,"PivotTableNullStringChangedEvent",Me,[]);Cm(Ph,zd);Ph.prototype.ic=function(){this.Vb(219)};Jl.Object.defineProperties(Ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(sd.a)(Ph,"PivotTablePivotLocationChangedEvent",zd,[]);Cm(oh,zd);oh.prototype.ic=function(){this.Vb(145)};Jl.Object.defineProperties(oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(sd.a)(oh,"PivotTablePivotedEvent",zd,
[]);Cm(jh,Me);Object(sd.a)(jh,"PivotTableRefreshDataOnLoadToggledEvent",Me,[]);Cm(fh,zd);fh.prototype.ic=function(){this.Vb(50)};fh.prototype.ug=function(){this.zd(function(G){return!!G.pivotTableId&&!!G.pivotTableName})};Jl.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(sd.a)(fh,"PivotTableRefreshedEvent",zd,[]);Cm(ef,Me);Object(sd.a)(ef,"PivotTableRenamedEvent",Me,[]);Cm(sf,Me);Object(sd.a)(sf,"PivotTableRowGrandTotalShownEvent",
Me,[]);Cm(oe,Me);Object(sd.a)(oe,"PivotTableSaveSourceDataWithFileToggledEvent",Me,[]);var rj=b(643);Cm(xd,zd);xd.prototype.ic=function(){this.Vb(131)};xd.prototype.ug=function(){this.zd(function(G){G=Object(Ci.a)(rj.a,G);return!!G&&!Ig.a.na(G.vIa())&&!Ig.a.na(G.hierarchyName)})};Jl.Object.defineProperties(xd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(sd.a)(xd,"PivotTableSortedEvent",zd,[]);Cm(ub,Me);Object(sd.a)(ub,"PivotTableSubTotalsVisibilitySettingSetEvent",
Me,[]);Cm(pa,zd);pa.prototype.ic=function(){this.Vb(560)};Jl.Object.defineProperties(pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(sd.a)(pa,"PivotValueFieldSettingAppliedEvent",zd,[]);Cm(Aa,zd);Aa.prototype.ic=function(){this.Vb(243)};Jl.Object.defineProperties(Aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(sd.a)(Aa,"PrintAreaClearedEvent",zd,[]);Cm(Ag,zd);Ag.prototype.ic=function(){this.Vb(241)};Ag.prototype.ug=
function(){this.zd(function(G){return!G.addToPrintArea})};Jl.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(sd.a)(Ag,"PrintAreaSetEvent",zd,[]);Cm(vh,zd);vh.prototype.ic=function(){this.Vb(517)};Jl.Object.defineProperties(vh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(sd.a)(vh,"RangeAutoFilterClearedEvent",zd,[]);Cm(vg,zd);vg.prototype.ic=function(){this.Vb(11)};vg.prototype.ug=function(){var G=
this;this.zd(function(la){return 16===la.cellFormat.ValidMembers});this.zd(function(la){return la.cellFormat.Font.ValidMembers===G.DRd})};Jl.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pea}}});Object(sd.a)(vg,"RangeFontFormattedEventBase",zd,[]);Cm(Sg,vg);Object(sd.a)(Sg,"RangeBoldedEvent",vg,[]);Cm(Ng,zd);Ng.prototype.ic=function(){this.Vb(11)};Ng.prototype.ug=function(){this.zd(function(G){return 128===G.cellFormat.ValidMembers})};Jl.Object.defineProperties(Ng.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(sd.a)(Ng,"RangeBorderedEvent",zd,[]);Ff.j7a="Table";Ff.Ijc="Sheet";Object(sd.a)(Ff,"MacroRecorderEventConstants",null,[]);Cm(bg,zd);bg.prototype.ic=function(){this.Vb(208)};bg.prototype.ug=function(){this.zd(function(G){return G.getParameters().FilterType===Ff.Ijc})};Jl.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(sd.a)(bg,"RangeCheckedItemsFilteredEvent",
zd,[]);Cm(We,zd);We.prototype.ic=function(){this.Vb(106);this.Vb(105)};Jl.Object.defineProperties(We.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(sd.a)(We,"RangeConditionalFormattingChangedEvent",zd,[]);Cm(Be,zd);Be.prototype.ic=function(){this.Vb(221)};Jl.Object.defineProperties(Be.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(sd.a)(Be,"RangeConditionalFormattingRuleDeletedEvent",zd,[]);Cm(we,zd);we.prototype.ic=function(){this.Vb(508)};
we.prototype.ug=function(){this.zd(function(G){return 3===G.As()||1===G.As()||4===G.As()})};Jl.Object.defineProperties(we.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(sd.a)(we,"RangeContentClearedEvent",zd,[]);Cm(Ee,zd);Ee.prototype.ic=function(){this.Vb(104)};Jl.Object.defineProperties(Ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(sd.a)(Ee,"RangeCopiedCutCellsInsertedEvent",zd,[]);Cm(Dd,zd);Dd.prototype.ic=function(){this.Vb(209)};
Dd.prototype.ug=function(){this.zd(function(G){return G.getParameters().FilterType===Ff.Ijc})};Jl.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(sd.a)(Dd,"RangeCustomFilteredEvent",zd,[]);Cm(Bc,zd);Bc.prototype.ic=function(){this.Vb(121)};Jl.Object.defineProperties(Bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(sd.a)(Bc,"RangeDataValidationChangedEvent",zd,[]);Cm(Cc,vg);Object(sd.a)(Cc,"RangeDoubleUnderlinedEvent",
vg,[]);Cm(Rb,zd);Rb.prototype.ic=function(){this.Vb(190)};Jl.Object.defineProperties(Rb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(sd.a)(Rb,"RangeDuplicatesRemovedEvent",zd,[]);Cm(ab,zd);ab.prototype.ic=function(){this.Vb(527);this.Vb(12)};Jl.Object.defineProperties(ab.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(sd.a)(ab,"RangeEditedEvent",zd,[]);Cm(aa,zd);aa.prototype.ic=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Vb(255):this.Vb(232)};aa.prototype.ug=function(){this.zd(function(G){return 4===G.actionType})};aa.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Jl.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(sd.a)(aa,"RangeExternalLinksBrokeAllLinksEvent",zd,[]);Cm(Yh,zd);Yh.prototype.ic=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Vb(255):this.Vb(232)};Yh.prototype.ug=function(){this.zd(function(G){return 3===G.actionType})};Yh.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Jl.Object.defineProperties(Yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(sd.a)(Yh,"RangeExternalLinksBrokeLinkEvent",zd,[]);Cm(Cf,zd);Cf.prototype.ic=function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Vb(256):this.Vb(249)};Cf.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Jl.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(sd.a)(Cf,"RangeExternalLinksChangeSourceEvent",zd,[]);Cm(Bh,zd);Bh.prototype.ic=function(){this.Vb(553)};Bh.prototype.ug=function(){this.zd(function(G){return 1===G.actionType})};Bh.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};
Jl.Object.defineProperties(Bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(sd.a)(Bh,"RangeExternalLinksRefreshedAllEvent",zd,[]);Cm(qi,zd);qi.prototype.ic=function(){this.Vb(553)};qi.prototype.ug=function(){this.zd(function(G){return!G.actionType})};qi.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Jl.Object.defineProperties(qi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});
Object(sd.a)(qi,"RangeExternalLinksRefreshedEvent",zd,[]);Cm(Gh,zd);Gh.prototype.ic=function(){this.Vb(224)};Gh.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};Jl.Object.defineProperties(Gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(sd.a)(Gh,"RangeExternalLinksSetAutoRefreshEvent",zd,[]);Cm(Eh,zd);Eh.prototype.ic=function(){this.Vb(11)};Eh.prototype.ug=function(){this.zd(function(G){return 64===G.cellFormat.ValidMembers})};
Jl.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(sd.a)(Eh,"RangeFillColoredEvent",zd,[]);Cm(Mg,zd);Mg.prototype.ic=function(){this.Vb(155)};Jl.Object.defineProperties(Mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(sd.a)(Mg,"RangeFilledEvent",zd,[]);Cm(Hg,zd);Hg.prototype.ic=function(){this.Vb(176)};Hg.prototype.ug=function(){this.zd(function(G){return G.autoFilterOptions.AutoFilterType===Ff.Ijc&&
!!G.autoFilterOptions.CriteriaType})};Jl.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(sd.a)(Hg,"RangeFilterAppliedEvent",zd,[]);Cm(ki,zd);ki.prototype.ic=function(){this.Vb(176)};ki.prototype.ug=function(){this.zd(function(G){return G.autoFilterOptions.AutoFilterType===Ff.Ijc&&!G.autoFilterOptions.CriteriaType})};Jl.Object.defineProperties(ki.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(sd.a)(ki,
"RangeFilterClearedEvent",zd,[]);Cm(ug,zd);ug.prototype.ic=function(){this.Vb(518)};Jl.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(sd.a)(ug,"RangeFilterReappliedEvent",zd,[]);Cm(mh,zd);mh.prototype.ic=function(){this.Vb(150)};Jl.Object.defineProperties(mh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(sd.a)(mh,"RangeFlashFilledEvent",zd,[]);Cm(Wd,vg);Object(sd.a)(Wd,"RangeFontColoredEvent",
vg,[]);Cm(te,vg);Object(sd.a)(te,"RangeFontItalicizedEvent",vg,[]);Cm(Lf,vg);Object(sd.a)(Lf,"RangeFontNamedEvent",vg,[]);Cm(kh,vg);Object(sd.a)(kh,"RangeFontSizedEvent",vg,[]);Cm(fd,zd);fd.prototype.ic=function(){this.Vb(215)};Jl.Object.defineProperties(fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(sd.a)(fd,"RangeFormattedAsTableEvent",zd,[]);Cm(qd,zd);qd.prototype.ic=function(){this.Vb(188)};Jl.Object.defineProperties(qd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 97}}});Object(sd.a)(qd,"RangeGroupedOrUngroupedEvent",zd,[]);Cm(Wg,zd);Wg.prototype.ic=function(){this.Vb(11)};Wg.prototype.ug=function(){this.zd(function(G){return 2===G.cellFormat.ValidMembers})};Jl.Object.defineProperties(Wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(sd.a)(Wg,"RangeHorizontallyAlignedEvent",zd,[]);Cm(ch,zd);ch.prototype.ic=function(){this.Vb(526)};Jl.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 43}}});Object(sd.a)(ch,"RangeHyperlinkAppliedEvent",zd,[]);Cm(fe,zd);fe.prototype.ic=function(){this.Vb(11)};fe.prototype.ug=function(){this.zd(function(G){return 256===G.cellFormat.ValidMembers})};Jl.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(sd.a)(fe,"RangeIndentChangedEvent",zd,[]);Cm(Nf,zd);Nf.prototype.ic=function(){this.Vb(156)};Nf.prototype.ug=function(){this.zd(function(G){return 2===
G.As()||5===G.As()||6===G.As()||7===G.As()})};Jl.Object.defineProperties(Nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(sd.a)(Nf,"RangeMergedEvent",zd,[]);Cm(bh,zd);bh.prototype.ic=function(){this.Vb(216)};Jl.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(sd.a)(bh,"RangeNamedCellStyleAppliedEvent",zd,[]);Cm(hg,zd);hg.prototype.ic=function(){this.Vb(11)};hg.prototype.ug=function(){this.zd(function(G){return 32===
G.cellFormat.ValidMembers})};Jl.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(sd.a)(hg,"RangeNumberFormattedEvent",zd,[]);var fk=b(1078);Cm(zg,zd);zg.prototype.ic=function(){this.Vb(141)};zg.prototype.ug=function(){this.zd(function(G){return Object(wj.a)(fk.a,G)})};Jl.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(sd.a)(zg,"RangeSortedEvent",zd,[]);Cm(jg,vg);Object(sd.a)(jg,
"RangeStrikedThroughEvent",vg,[]);Cm(Kg,vg);Object(sd.a)(Kg,"RangeUnderlinedEvent",vg,[]);Cm(nf,zd);nf.prototype.ic=function(){this.Vb(11)};nf.prototype.ug=function(){this.zd(function(G){return 1===G.cellFormat.ValidMembers})};Jl.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(sd.a)(nf,"RangeVerticallyAlignedEvent",zd,[]);Cm(yg,zd);yg.prototype.ic=function(){this.Vb(11)};yg.prototype.ug=function(){this.zd(function(G){return 8===G.cellFormat.ValidMembers})};
Jl.Object.defineProperties(yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(sd.a)(yg,"RangeWrapTextToggledEvent",zd,[]);Cm(Kc,zd);Kc.prototype.ic=function(){this.Vb(51)};Jl.Object.defineProperties(Kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(sd.a)(Kc,"RefreshedAllEvent",zd,[]);Cm(Rc,zd);Rc.prototype.ic=function(){this.Vb(148)};Jl.Object.defineProperties(Rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});
Object(sd.a)(Rc,"ReplaceAllEvent",zd,[]);Cm(of,zd);of.prototype.ic=function(){this.Vb(532)};of.prototype.ug=function(){this.zd(function(G){return 95!==G.getShapeType()&&96!==G.getShapeType()&&97!==G.getShapeType()&&98!==G.getShapeType()&&100!==G.getShapeType()&&102!==G.getShapeType()&&103!==G.getShapeType()})};Jl.Object.defineProperties(of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(sd.a)(of,"ShapeInsertedEvent",zd,[]);Cm(hd,zd);hd.prototype.ic=function(){this.Vb(531)};
Jl.Object.defineProperties(hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(sd.a)(hd,"ShapeStyleSetEvent",zd,[]);var Kj=b(929);Cm(le,zd);le.prototype.ic=function(){this.Vb(581)};le.prototype.ug=function(){var G=this;this.zd(function(la){return Object(wj.a)(Kj.a,la)&&4===la.getShapeTextFormat().ValidMembers});this.zd(function(la){return Object(wj.a)(Kj.a,la)&&la.getShapeTextFormat().Font.ValidMembers===G.DRd})};Jl.Object.defineProperties(le.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.pea}}});Object(sd.a)(le,"ShapeTextFontFormattedEventBase",zd,[]);Cm(mc,le);Object(sd.a)(mc,"ShapeTextBoldedEvent",le,[]);var ak=b(1080);Cm(Db,zd);Db.prototype.ic=function(){this.Vb(581)};Db.prototype.ug=function(){this.zd(function(G){return Object(wj.a)(ak.a,G)})};Jl.Object.defineProperties(Db.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(sd.a)(Db,"ShapeTextChangedEvent",zd,[]);Cm(Yc,le);Object(sd.a)(Yc,"ShapeTextFontColorChangedEvent",
le,[]);Cm(bd,le);Object(sd.a)(bd,"ShapeTextFontNameChangedEvent",le,[]);Cm(Jc,le);Object(sd.a)(Jc,"ShapeTextFontSizeChangedEvent",le,[]);Cm(Nb,zd);Nb.prototype.ic=function(){this.Vb(581)};Nb.prototype.ug=function(){this.zd(function(G){return Object(wj.a)(Kj.a,G)&&2===G.getShapeTextFormat().ValidMembers})};Jl.Object.defineProperties(Nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(sd.a)(Nb,"ShapeTextHorizontallyAlignedEvent",zd,[]);Cm(ob,le);Object(sd.a)(ob,
"ShapeTextItalicizedEvent",le,[]);Cm(Ja,le);Object(sd.a)(Ja,"ShapeTextUnderlinedEvent",le,[]);Cm(Ne,zd);Ne.prototype.ic=function(){this.Vb(581)};Ne.prototype.ug=function(){this.zd(function(G){return Object(wj.a)(Kj.a,G)&&1===G.getShapeTextFormat().ValidMembers})};Jl.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(sd.a)(Ne,"ShapeTextVerticallyAlignedEvent",zd,[]);Cm(qe,zd);qe.prototype.ic=function(){this.Vb(138)};Jl.Object.defineProperties(qe.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(sd.a)(qe,"SheetAddedEvent",zd,[]);var Ui=b(10);Cm(Td,zd);Td.prototype.ic=function(){this.Vb(237)};Td.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==
Ui.a.Ty)||!G.DeltaColumn&&0>G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==Ui.a.dw)})};Jl.Object.defineProperties(Td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(sd.a)(Td,"SheetCellsDeletedEvent",zd,[]);Cm(kd,zd);kd.prototype.ic=function(){this.Vb(237)};kd.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});
this.zd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==Ui.a.Ty)||!G.DeltaColumn&&0<G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==Ui.a.dw)})};Jl.Object.defineProperties(kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(sd.a)(kd,"SheetCellsInsertedEvent",zd,[]);Cm(rc,zd);rc.prototype.ic=function(){this.Vb(237)};
rc.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Ui.a.Ty})};Jl.Object.defineProperties(rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(sd.a)(rc,"SheetColumnDeletedEvent",zd,[]);Cm(tb,zd);tb.prototype.ic=function(){this.Vb(237)};tb.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Ui.a.Ty})};Jl.Object.defineProperties(tb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(sd.a)(tb,"SheetColumnInsertedEvent",zd,[]);Cm(qa,zd);qa.prototype.ic=function(){this.Vb(137)};Jl.Object.defineProperties(qa.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(sd.a)(qa,"SheetDeletedEvent",zd,[]);Cm(ih,zd);ih.prototype.ic=function(){this.Vb(185)};Jl.Object.defineProperties(ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(sd.a)(ih,"SheetDirectionChangedEvent",zd,[]);Cm(uf,zd);uf.prototype.ic=function(){this.Vb(139)};Jl.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(sd.a)(uf,"SheetDuplicatedEvent",zd,
[]);Cm(Cg,zd);Cg.prototype.ic=function(){this.Vb(207)};Jl.Object.defineProperties(Cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(sd.a)(Cg,"SheetNameEditedEvent",zd,[]);Cm(Hf,zd);Hf.prototype.ic=function(){this.Vb(151)};Jl.Object.defineProperties(Hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(sd.a)(Hf,"SheetPaneFrozenEvent",zd,[]);Cm(hf,zd);hf.prototype.ic=function(){this.Vb(226)};Jl.Object.defineProperties(hf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(sd.a)(hf,"SheetPrintSettingsSavedEvent",zd,[]);var fj=b(980);Cm(Id,zd);Id.prototype.ic=function(){this.Vb(507)};Id.prototype.FU=function(){this.$Da("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Id.prototype.ug=function(){this.zd(function(G){return Object.getType(G)===fj.a})};Jl.Object.defineProperties(Id.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(sd.a)(Id,"SheetProtectionPausedResumedEvent",
zd,[]);Cm(ed,zd);ed.prototype.ic=function(){this.Vb(557)};Jl.Object.defineProperties(ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(sd.a)(ed,"SheetReorderedEvent",zd,[]);Cm(Hc,zd);Hc.prototype.ic=function(){this.Vb(237)};Hc.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Ui.a.dw})};Jl.Object.defineProperties(Hc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(sd.a)(Hc,"SheetRowDeletedEvent",zd,
[]);Cm(Sb,zd);Sb.prototype.ic=function(){this.Vb(237)};Sb.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Ui.a.dw})};Jl.Object.defineProperties(Sb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(sd.a)(Sb,"SheetRowInsertedEvent",zd,[]);Cm(gg,zd);gg.prototype.ic=function(){this.Vb(135)};Jl.Object.defineProperties(gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(sd.a)(gg,"SheetRowsColumnsAutoFitEvent",zd,[]);
Cm(Pf,zd);Pf.prototype.ic=function(){this.Vb(136)};Jl.Object.defineProperties(Pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(sd.a)(Pf,"SheetRowsColumnsResizedEvent",zd,[]);Cm(Dg,zd);Dg.prototype.ic=function(){this.Vb(183)};Jl.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(sd.a)(Dg,"SheetShowGridlinesToggledEvent",zd,[]);Cm(vf,zd);vf.prototype.ic=function(){this.Vb(184)};Jl.Object.defineProperties(vf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(sd.a)(vf,"SheetShowHeadingsToggledEvent",zd,[]);Cm(If,zd);If.prototype.ic=function(){this.Vb(213)};Jl.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(sd.a)(If,"SheetSpellCheckedEvent",zd,[]);Cm(bf,zd);bf.prototype.ic=function(){this.Vb(515)};Jl.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(sd.a)(bf,
"SheetTabColoredEvent",zd,[]);Cm(Uf,zd);Uf.prototype.ic=function(){this.Vb(157)};Jl.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(sd.a)(Uf,"SheetVisibilityChangedEvent",zd,[]);Cm(df,zd);df.prototype.ic=function(){this.Vb(239)};Jl.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(sd.a)(df,"SheetsVisibilityChangedEvent",zd,[]);Cm(dh,zd);dh.prototype.ic=function(){this.Vb(203)};
Jl.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(sd.a)(dh,"SlicerInsertedEvent",zd,[]);Cm(cf,zd);cf.prototype.ic=function(){this.Vb(173)};cf.prototype.ug=function(){this.zd(function(G){return!G.clearFilter})};Jl.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(sd.a)(cf,"SlicerSelectionAppliedEvent",zd,[]);Cm(Se,zd);Se.prototype.ic=function(){this.Vb(173)};Se.prototype.ug=
function(){this.zd(function(G){return G.clearFilter})};Jl.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(sd.a)(Se,"SlicerSelectionClearedEvent",zd,[]);Cm(xf,zd);xf.prototype.ic=function(){this.Vb(208)};xf.prototype.ug=function(){this.zd(function(G){return G.getParameters().FilterType===Ff.j7a})};Jl.Object.defineProperties(xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(sd.a)(xf,"TableCheckedItemsFilteredEvent",
zd,[]);Cm(ee,zd);ee.prototype.ic=function(){this.Vb(237)};ee.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Jl.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(sd.a)(ee,"TableColumnDeletedEvent",zd,[]);Cm(Pd,zd);Pd.prototype.ic=function(){this.Vb(237)};Pd.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Jl.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(sd.a)(Pd,"TableColumnInsertedEvent",zd,[]);var sk=b(1079);Cm(Md,zd);Md.prototype.ic=function(){this.Vb(141)};Md.prototype.ug=function(){this.zd(function(G){return Object(wj.a)(sk.a,G)})};Jl.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(sd.a)(Md,"TableColumnSortedEvent",zd,[]);Cm(qc,zd);qc.prototype.ic=function(){this.Vb(193)};
Jl.Object.defineProperties(qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(sd.a)(qc,"TableConvertedToRangeEvent",zd,[]);Cm(pc,zd);pc.prototype.ic=function(){this.Vb(206)};Jl.Object.defineProperties(pc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(sd.a)(pc,"TableCreatedEvent",zd,[]);Cm(lb,zd);lb.prototype.ic=function(){this.Vb(209)};lb.prototype.ug=function(){this.zd(function(G){return G.getParameters().FilterType===
Ff.j7a})};Jl.Object.defineProperties(lb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(sd.a)(lb,"TableCustomFilteredEvent",zd,[]);Cm(Fa,zd);Fa.prototype.ic=function(){this.Vb(187)};Fa.prototype.ug=function(){this.zd(function(G){return 1===G.options.OperationType})};Jl.Object.defineProperties(Fa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(sd.a)(Fa,"TableCustomSortedEvent",zd,[]);Cm(Og,zd);Og.prototype.ic=function(){this.Vb(176)};
Og.prototype.ug=function(){this.zd(function(G){return G.autoFilterOptions.AutoFilterType===Ff.j7a});this.zd(function(G){return!G.autoFilterOptions.CriteriaType})};Jl.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(sd.a)(Og,"TableFilterClearedEvent",zd,[]);Cm(lg,zd);lg.prototype.ic=function(){this.Vb(176)};lg.prototype.ug=function(){this.zd(function(G){return G.autoFilterOptions.AutoFilterType===Ff.j7a});this.zd(function(G){var la=new wg.a;
la.add(1);la.add(2);la.add(8);la.add(9);la.add(10);la.add(11);la.add(12);la.add(13);la.add(14);la.add(15);la.add(16);la.add(17);la.add(18);la.add(19);la.add(20);la.add(21);la.add(22);la.add(23);la.add(24);la.add(25);la.add(26);la.add(27);la.add(28);la.add(29);la.add(30);la.add(31);la.add(32);la.add(33);la.add(34);la.add(35);la.add(36);la.add(37);la.add(38);la.add(39);return la.contains(G.autoFilterOptions.CriteriaType)})};Jl.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 32}}});Object(sd.a)(lg,"TableItemFilteredEvent",zd,[]);Cm(tf,zd);tf.prototype.ic=function(){this.Vb(217)};Jl.Object.defineProperties(tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(sd.a)(tf,"TableRenamedEvent",zd,[]);Cm(ve,zd);ve.prototype.ic=function(){this.Vb(211)};Jl.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(sd.a)(ve,"TableResizedEvent",zd,[]);Cm(tg,zd);tg.prototype.ic=
function(){this.Vb(514)};Jl.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(sd.a)(tg,"TableRowColumnRearrangedEvent",zd,[]);Cm(de,zd);de.prototype.ic=function(){this.Vb(237)};de.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Jl.Object.defineProperties(de.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(sd.a)(de,"TableRowDeletedEvent",zd,[]);Cm(Lg,zd);Lg.prototype.ic=function(){this.Vb(237)};Lg.prototype.ug=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Jl.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(sd.a)(Lg,"TableRowInsertedEvent",zd,[]);Cm(qg,zd);qg.prototype.ic=function(){this.Vb(177)};qg.prototype.ug=function(){this.zd(function(G){return G.autoFilterOptions.AutoFilterType===Ff.j7a})};Jl.Object.defineProperties(qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});
Object(sd.a)(qg,"TableSortedEvent",zd,[]);Cm(Tc,zd);Tc.prototype.ic=function(){this.Vb(212)};Jl.Object.defineProperties(Tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(sd.a)(Tc,"TableStyleAppliedEvent",zd,[]);Cm(Ud,zd);Ud.prototype.ic=function(){this.Vb(196)};Jl.Object.defineProperties(Ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(sd.a)(Ud,"TableStyleOptionToggledEvent",zd,[]);Cm(Yg,zd);Yg.prototype.ic=function(){this.Vb(210)};
Yg.prototype.ug=function(){this.zd(function(G){return G.getParameters().FilterType===Ff.j7a})};Jl.Object.defineProperties(Yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(sd.a)(Yg,"TableTop10FilteredEvent",zd,[]);Cm(eg,zd);eg.prototype.ic=function(){this.Vb(238)};Jl.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(sd.a)(eg,"TextToColumnsEvent",zd,[]);Cm(ng,zd);ng.prototype.ic=function(){this.Vb(559)};
Jl.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 128}}});Object(sd.a)(ng,"ValuesSortedEvent",zd,[]);Cm(Eg,zd);Eg.prototype.ic=function(){this.Vb(197)};Jl.Object.defineProperties(Eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(sd.a)(Eg,"WorkbookCalculationModeSetEvent",zd,[]);Cm(hh,zd);hh.prototype.ic=function(){this.Vb(181)};hh.prototype.ug=function(){this.zd(function(G){return!!G.parentCommentId})};Jl.Object.defineProperties(hh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});Object(sd.a)(hh,"WorkbookCommentRepliedEvent",zd,[]);Cm(Of,zd);Of.prototype.ic=function(){this.Vb(181)};Of.prototype.ug=function(){this.zd(function(G){return!G.parentCommentId})};Jl.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(sd.a)(Of,"WorkbookCommentedEvent",zd,[]);Cm(Kf,zd);Kf.prototype.ic=function(){this.Vb(128)};Jl.Object.defineProperties(Kf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 56}}});Object(sd.a)(Kf,"WorkbookRecalculatedEvent",zd,[]);Cm(Ug,zd);Ug.prototype.ic=function(){this.Vb(171)};Jl.Object.defineProperties(Ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(sd.a)(Ug,"WorkbookRedoEvent",zd,[]);Cm(Qf,zd);Qf.prototype.ic=function(){this.Vb(170)};Jl.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(sd.a)(Qf,"WorkbookUndoEvent",zd,[]);Cm(Bg,
zd);Bg.prototype.ic=function(){this.Vb(507);this.Vb(576);this.Vb(10)};Bg.prototype.ug=function(){this.zd(function(G){if(Object(wj.a)(xe,G)&&(G=Object(Ci.a)(xe,G),void 0!==G.source&&null!==G.source&&void 0!==G.eventId&&null!==G.eventId))return pe.ULS.sendTraceTag(594105034,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",G.source,G.eventId),!0;pe.ULS.sendTraceTag(594105033,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Jl.Object.defineProperties(Bg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 116}}});Object(sd.a)(Bg,"DefaultRichApiRequestExecutedEvent",zd,[]);kg.prototype.NRe=function(G,la){var Ya=this.ORe(G,this.macroRecorderEvents,la);Ya||(Ya=this.ORe(G,kg.tLh(),la),!Ya&&this.e6e(G,kg.Wxe,la)&&(Ya=kg.Wxe));return Ya};kg.prototype.ORe=function(G,la,Ya){var Fb=new wg.a;la=Ml(la);for(var lc=la.next();!lc.done;lc=la.next())lc=lc.value,this.e6e(G,lc,Ya)&&Fb.add(lc);return 1===Fb.count?Fb.oa(0):1<Fb.count?kg.kuh(Fb):null};kg.prototype.e6e=
function(G,la,Ya){var Fb=kg.BCi(G,la);return Ya?Fb&&kg.XAj(G,la):Fb};kg.prototype.PRi=function(){for(var G=new wg.a,la=Ml(this.Gb),Ya=la.next();!Ya.done;Ya=la.next()){Ya=Ya.value;for(var Fb=!1,lc=Ml(Ya.featureGates),Lc=lc.next();!Lc.done;Lc=lc.next())if(!dg.EwaSettings.ka(Lc.value)){G.add(Ya);Fb=!0;break}if(!Fb)for(Fb=Ml(Ya.lJe),lc=Fb.next();!lc.done;lc=Fb.next())if(!dg.EwaSettings.getBooleanFeatureGate(lc.value,!1)){G.add(Ya);break}}G=Ml(G);for(la=G.next();!la.done;la=G.next())this.Gb.remove(la.value)};
kg.tLh=function(){kg.Kyb||(kg.Kyb=new wg.a,kg.Kyb.add(new re),kg.Kyb.add(new Ef));return kg.Kyb};kg.BCi=function(G,la){return la.operations.contains(G.operation)};kg.XAj=function(G,la){var Ya=la.Qwc;if(!Ya.count)return!0;la=!0;Ya=Ml(Ya);for(var Fb=Ya.next();!Fb.done;Fb=Ya.next())if(Fb=Fb.value,!Fb(G.payload)){la=!1;break}return la};kg.kuh=function(G){var la=G.oa(0);G=Ml(G);for(var Ya=G.next();!Ya.done;Ya=G.next())Ya=Ya.value,Ya.Qwc.count>la.Qwc.count&&(la=Ya);return la};Jl.Object.defineProperties(kg.prototype,
{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Gb||(this.Gb=new wg.a,this.Gb.add(new ab),this.Gb.add(new Ng),this.Gb.add(new Sg),this.Gb.add(new Cc),this.Gb.add(new Eh),this.Gb.add(new Wd),this.Gb.add(new te),this.Gb.add(new Lf),this.Gb.add(new kh),this.Gb.add(new jg),this.Gb.add(new Kg),this.Gb.add(new hg),this.Gb.add(new qe),this.Gb.add(new qa),this.Gb.add(new Cg),this.Gb.add(new pc),this.Gb.add(new ee),this.Gb.add(new Pd),this.Gb.add(new de),this.Gb.add(new Lg),this.Gb.add(new tb),
this.Gb.add(new rc),this.Gb.add(new Sb),this.Gb.add(new Hc),this.Gb.add(new Fa),this.Gb.add(new qg),this.Gb.add(new xf),this.Gb.add(new Og),this.Gb.add(new we),this.Gb.add(new lb),this.Gb.add(new Yg),this.Gb.add(new lg),this.Gb.add(new Of),this.Gb.add(new hh),this.Gb.add(new og),this.Gb.add(new Pf),this.Gb.add(new Td),this.Gb.add(new kd),this.Gb.add(new gg),this.Gb.add(new Ee),this.Gb.add(new ug),this.Gb.add(new ch),this.Gb.add(new Df),this.Gb.add(new tg),this.Gb.add(new Ug),this.Gb.add(new Qf),this.Gb.add(new Rc),
this.Gb.add(new Te),this.Gb.add(new e),this.Gb.add(new Nf),this.Gb.add(new uf),this.Gb.add(new Eg),this.Gb.add(new Kf),this.Gb.add(new vh),this.Gb.add(new ki),this.Gb.add(new Mg),this.Gb.add(new Wg),this.Gb.add(new nf),this.Gb.add(new yg),this.Gb.add(new fe),this.Gb.add(new ed),this.Gb.add(new cg),this.Gb.add(new Bd),this.Gb.add(new vf),this.Gb.add(new Dg),this.Gb.add(new Rb),this.Gb.add(new Uf),this.Gb.add(new bf),this.Gb.add(new ve),this.Gb.add(new fd),this.Gb.add(new wc),this.Gb.add(new ag),this.Gb.add(new qi),
this.Gb.add(new Pa),this.Gb.add(new Ib),this.Gb.add(new Rg),this.Gb.add(new nd),this.Gb.add(new Qg),this.Gb.add(new Tf),this.Gb.add(new Hh),this.Gb.add(new yd),this.Gb.add(new mh),this.Gb.add(new Tc),this.Gb.add(new Ud),this.Gb.add(new If),this.Gb.add(new Hf),this.Gb.add(new of),this.Gb.add(new hd),this.Gb.add(new Wh),this.Gb.add(new ah),this.Gb.add(new gh),this.Gb.add(new zh),this.Gb.add(new qd),this.Gb.add(new rb),this.Gb.add(new Vb),this.Gb.add(new Jg),this.Gb.add(new tf),this.Gb.add(new oh),this.Gb.add(new Kc),
this.Gb.add(new fh),this.Gb.add(new qc),this.Gb.add(new Bc),this.Gb.add(new bh),this.Gb.add(new zg),this.Gb.add(new We),this.Gb.add(new h),this.Gb.add(new Vf),this.Gb.add(new I),this.Gb.add(new bg),this.Gb.add(new Dd),this.Gb.add(new Hg),this.Gb.add(new Xg),this.Gb.add(new pf),this.Gb.add(new Yh),this.Gb.add(new hf),this.Gb.add(new Md),this.Gb.add(new Be),this.Gb.add(new df),this.Gb.add(new qf),this.Gb.add(new ng),this.Gb.add(new Th),this.Gb.add(new Nh),this.Gb.add(new V),this.Gb.add(new Ld),this.Gb.add(new $g),
this.Gb.add(new je),this.Gb.add(new Zf),this.Gb.add(new ih),this.Gb.add(new rf),this.Gb.add(new Ph),this.Gb.add(new rg),this.Gb.add(new sh),this.Gb.add(new xd),this.Gb.add(new Na),this.Gb.add(new Ca),this.Gb.add(new Z),this.Gb.add(new Ag),this.Gb.add(new Mh),this.Gb.add(new Aa),this.Gb.add(new md),this.Gb.add(new Bh),this.Gb.add(new aa),this.Gb.add(new Gh),this.Gb.add(new Jd),this.Gb.add(new vc),this.Gb.add(new ef),this.Gb.add(new sf),this.Gb.add(new oc),this.Gb.add(new Ie),this.Gb.add(new cd),this.Gb.add(new $d),
this.Gb.add(new Sd),this.Gb.add(new Sh),this.Gb.add(new Ch),this.Gb.add(new f),this.Gb.add(new Wf),this.Gb.add(new Gf),this.Gb.add(new Zg),this.Gb.add(new oe),this.Gb.add(new jh),this.Gb.add(new ze),this.Gb.add(new He),this.Gb.add(new ub),this.Gb.add(new ig),this.Gb.add(new mf),this.Gb.add(new dh),this.Gb.add(new cf),this.Gb.add(new Se),this.Gb.add(new Db),this.Gb.add(new mc),this.Gb.add(new ob),this.Gb.add(new Ja),this.Gb.add(new Yc),this.Gb.add(new bd),this.Gb.add(new Jc),this.Gb.add(new Nb),this.Gb.add(new Ne),
this.Gb.add(new Cf),this.Gb.add(new pa),this.Gb.add(new eg),this.Gb.add(new Id),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.PRi());return this.Gb}}});kg.Kyb=null;kg.Wxe=new Bg;Object(sd.a)(kg,"MacroRecorderEventList",null,[]);var Nj=oj.a;Cm(lf,Nj);lf.prototype.create=function(){this.Jb(this.$.ea.Ea(297,void 0)||new li(this.$,new kg(this.$),new uj))};lf.la=function(G){G.ea.La(298,new lf(G))};Object(sd.a)(lf,"MacroRecorderEventHandlerFactory",oj.a,[]);var Hi=b(800),
Mi=b(79),xh=b(35);wf.prototype.$c=function(){return!1};wf.prototype.executeCommand=function(G,la,Ya){G=xh.TaskExtensions.um();la=la.command;switch(la){case 1845457202:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.Re(2045014907,-1,0,null),this.automateCommandManager.w$h(la,1904816141===la?Ya[Mi.a.Vd].toString():null)}return G};wf.prototype.Jc=function(G,la){G=!1;switch(la.command){case 1845457202:case -45542983:case 971811139:case 1904816141:case 1606046412:G=this.$.Aaa}return G};
wf.prototype.gd=function(G,la,Ya){return"PopulateAutomateGalleryMenu"===la&&this.$.Aaa?(this.automateCommandManager.gd(la,Ya),!0):!1};Object(sd.a)(wf,"AutomateCommandHandler",null,[159]);var lj=b(456),zj=Hi.a;Cm(Pe,zj);Pe.prototype.Rd=function(){var G=this;lj.a(this.$,374,375,this.vb,function(){var la=G.$.ea.Ea(352,void 0);la?G.Hd([new wf(la,G.$)]):pe.ULS.sendTraceTag(593605389,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")},"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager")};
Pe.la=function(G){G.ea.La(308,new Pe(G))};Object(sd.a)(Pe,"AutomateCommandHandlerFactory",Hi.a,[]);Object(sd.a)(Ye,"AuthContext",null,[]);var kf=b(574),rd=b(110),ie=b(104),Lh=b(26),M=b(930),ya=b(173);ff.prototype.getAuthContext=function(){return this.Ilb};ff.prototype.h8b=function(){function G(Lc,ad){return(new Promise(function(Kd){window.setTimeout(function(){Kd(Lc)},ad)})).then(function(Kd){Fb.push(Object.assign(new gf.a,{name:"Error"+lc,string:Kd.ErrorMessage}));Fb.push(Object.assign(new gf.a,
{name:"ErrorCode"+lc,string:Kd.ErrorCode}));lc++;return la.X_f()})}var la=this,Ya=Lh.a.Ta.Lb,Fb=[];if(this.oAuthManager)Fb.push(Object.assign(new gf.a,{name:"IsAuthSupported",bool:this.qke}));else return this.S4b(Fb,Ya,"need_OAuthManager","No OAuthManager");if(!this.Bv.Gx||!this.Bv.Gx.value)return this.S4b(Fb,Ya,"need_license","No License");if(Jf.AFrameworkApplication.ha.ta("IsAnonymousUser"))return this.S4b(Fb,Ya,"need_user","Anonymous User");if(33E5>Date.now()-this.Ilb.timeStamp)return Fb.push(Object.assign(new gf.a,
{name:"UsedCachedToken",bool:!0})),ya.a(rd.a.Xrd,!0,0,Fb),Promise.resolve(Object.assign(new M.a,{IsSuccess:!0,Token:this.Ilb.token}));Fb.push(Object.assign(new gf.a,{name:"UsedCachedToken",bool:!1}));var lc=1;return this.X_f().catch(function(Lc){return G(Lc,200)}).catch(function(Lc){return G(Lc,400)}).then(function(Lc){Lc.IsSuccess?(la.Ilb.token=Lc.Token,la.Ilb.timeStamp=Date.now()):(Fb.push(Object.assign(new gf.a,{name:"Error"+lc,string:Lc.ErrorMessage})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode"+
lc,string:Lc.ErrorCode})));Fb.push(Object.assign(new gf.a,{name:"Attempts",int64:lc}));Fb.push(Object.assign(new gf.a,{name:"Error",string:Lc.ErrorMessage}));Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:Lc.ErrorCode}));ya.a(rd.a.Xrd,Lc.IsSuccess,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);return Promise.resolve(Lc)}).catch(function(Lc){Fb.push(Object.assign(new gf.a,{name:"Error"+lc,string:Lc.ErrorMessage}));Fb.push(Object.assign(new gf.a,{name:"ErrorCode"+lc,string:Lc.ErrorCode}));Fb.push(Object.assign(new gf.a,
{name:"Attempts",int64:lc}));return la.S4b(Fb,Ya,Lc.ErrorCode,Lc.ErrorMessage)})};ff.prototype.S4b=function(G,la,Ya,Fb){G.push(Object.assign(new gf.a,{name:"Error",string:Fb}));G.push(Object.assign(new gf.a,{name:"ErrorCode",string:Ya}));ya.a(rd.a.Xrd,!1,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),G);return Promise.resolve(Object.assign(new M.a,{IsSuccess:!1,ErrorMessage:Fb,ErrorCode:Ya}))};ff.prototype.X_f=function(){var G=this,la=kf.a.zJh(),Ya=0;la=this.oAuthManager.vR("Maker",la).then(function(Fb){if(Fb)return!Fb.IsSuccess&&
G.Gdj(Fb)?Promise.reject(Fb):Promise.resolve(Fb);Fb=Object.assign(new M.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Fb)}).catch(function(Fb){var lc=new M.a;Object.getType(Fb)===Object.getType(lc)?lc=Fb:(lc.ErrorMessage=Fb.toString(),lc.ErrorCode="exception");return Promise.reject(lc)});return Promise.race([la,new Promise(function(Fb,lc){Ya=window.setTimeout(function(){lc(Object.assign(new M.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},
2E4)})]).then(function(Fb){window.clearTimeout(Ya);return Fb})};ff.prototype.Gdj=function(G){return"interaction_required"===G.ErrorCode||"InitFailed"===G.ErrorCode||"invalid_resource"===G.ErrorCode||"login_required"===G.ErrorCode&&G.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(sd.a)(ff,"AutomateCommandAuth",null,[805]);var Eb=b(931);Object(sd.a)(Je,"AutomateCommandGalleryBase",null,[]);var jc=b(828),od=b(30),Fe=b(846),Oe=b(1345),Qe=b(18),$f=b(48),Rf=b(16),uh=b(806),Tg=b(982);Xd.prototype.Yrh=
function(G){var la=this.automateCommandManager.Va.sp().JB(),Ya=Xd.tT(G,Rf.a.instance.da(2044));this.OOc(Ya,kf.a.pAi,this.automateCommandManager.pg,kf.a.omi,Rf.a.instance.da(2040),this.automateCommandManager.Va);Array.add(la.MenuSectionList,Ya);Ya=Xd.tT(G,Rf.a.instance.da(2045));this.OOc(Ya,kf.a.pji,kf.a.kV?this.automateCommandManager.Hk.EKe(this.automateCommandManager.pg):this.automateCommandManager.Nm.EKe(this.automateCommandManager.pg),kf.a.vif,Rf.a.instance.da(2041),this.automateCommandManager.Va);
Array.add(la.MenuSectionList,Ya);Ya=Xd.tT(G,Rf.a.instance.da(2046));this.OOc(Ya,kf.a.J0i,this.automateCommandManager.Rs,kf.a.vif,"",this.automateCommandManager.Va);Array.add(la.MenuSectionList,Ya);Ya=Object.assign(new jc.a,{Id:kf.a.Qge,ExternalId:kf.a.Qge,Command:"1606046412",LabelText:Rf.a.instance.da(2037),Alt:Rf.a.instance.da(2038),Image16by16:$f.a.Ee(16),Image16by16Class:Qe.a.IFe,Visible:!0});G=Xd.tT(G,null);G.ControlsId="myScriptsSection.Controls";Array.add(G.ControlList,Ya);Array.add(la.MenuSectionList,
G);return la};Xd.prototype.OOc=function(G,la,Ya,Fb,lc,Lc){if(Ya&&0<Ya.length){la=Lc.cA(la,1,"Size150by20").UXb();lc={};Lc={};Lc.root=Xd.aGa(320,30);Lc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Lc.label={margin:"0px 3px"};lc.galleryButtonInExpanded=Lc;la.GalleryStyle=lc;for(lc=0;lc<Ya.length&&lc<Fb;lc++)Lc=Ya.vJ(lc),Array.add(la.GalleryItems,Xd.t0b(Lc.id,Lc,!1));Array.add(G.ControlList,la)}else Ya=Object.assign(new Tg.a,
{Id:la,ExternalId:la,LabelText:lc}),G.ControlsId=Ya.Id+".Controls",Array.add(G.ControlList,Ya)};Xd.ZMe=function(G){if(G){var la=String.format(kf.a.aXh,G.isShared?kf.a.p_f:kf.a.lLf,$f.a.Ee(16));G=String.format(kf.a.bXh,od.a.gg(G.name));return String.format(kf.a.$Wh,la,G)}return""};Xd.tT=function(G,la){return Object.assign(new Fe.a,{Id:G,Title:la,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};Xd.t0b=function(G,la,Ya){var Fb=Ya?kf.a.Krj:kf.a.Jrj,
lc=Ya?kf.a.c2i:kf.a.b2i,Lc=Ya?kf.a.p_f:kf.a.Lrj,ad=Ya?kf.a.lLf:kf.a.d2i;return la?Xd.jve(la.gF||la.id,la.name,Ya,la.isShared?Fb:lc,G,G,la.isShared?Lc:ad):Xd.jve("","",Ya,"",G,G)};Xd.jve=function(G,la,Ya,Fb,lc,Lc,ad){lc=void 0===lc?null:lc;Lc=void 0===Lc?null:Lc;ad=void 0===ad?null:ad;var Kd=void 0===Kd?null:Kd;var ue={},af={};Ya?(ue.root=Xd.aGa(32,32),af.root=Xd.aGa(32,32)):(ue.root=Xd.aGa(20,20),af.root=Xd.aGa(20,20));return Object.assign(new Oe.a,{Id:G,ExternalId:lc||G,MenuItemId:Lc||G,Command:"1904816141",
Icon:Fb,Image:$f.a.Ee(16),ImageClass:ad,LabelText:la,FullIconStyle:ue,PreviewIconStyle:af,Alt:Kd||la})};Xd.aGa=function(G,la){var Ya={};Ya.width=G;Ya["min-width"]=G;Ya.height=la;return Ya};Object(sd.a)(Xd,"AutomateCommandRenderer",null,[]);vd.prototype.UIa=function(G){for(var la=0;la<this.scripts.length;la++)if(this.scripts[la].id===G||this.scripts[la].gF===G)return la;return-1};vd.prototype.sort=function(){this.WUf(this.scripts)};vd.prototype.Wp=function(G){return-1===this.UIa(G.id)?(this.scripts.push(G),
!0):!1};vd.prototype.bWa=function(G){return-1===this.UIa(G.id)?(G=[G],this.scripts=G.concat.apply(G,this.scripts),!0):!1};vd.prototype.ugf=function(G){G=this.UIa(G.id);if(-1!==G){for(var la=this.scripts[G].Lga();0<G;)this.scripts[G]=this.scripts[G-1],G--;this.scripts[0]=la}};vd.prototype.xda=function(G){var la=this.UIa(G.id);if(-1!==la){var Ya=this.scripts[la].gF;this.scripts[la]=G;this.scripts[la].gF=Ya}};vd.prototype.vcc=function(G){var la=this.UIa(G.id);return-1!==la?G.name===this.scripts[la].name:
!1};vd.prototype.kha=function(G){G=this.UIa(G);return-1!==G?(this.scripts.splice(G,1),!0):!1};vd.prototype.clear=function(){this.scripts=[]};vd.prototype.Ly=function(G){G=this.UIa(G);return-1!==G?this.scripts[G]:null};vd.prototype.vJ=function(G){return 0<=G&&this.length>G?this.scripts[G]:null};vd.prototype.EKe=function(G){for(var la=new vd([],this.WUf),Ya=0;Ya<this.scripts.length;Ya++){var Fb=this.scripts[Ya];G.Ly(Fb.id)||la.Wp(Fb)}return la};vd.prototype.nbb=function(){for(var G=[],la=Ml(this.scripts),
Ya=la.next();!Ya.done;Ya=la.next())G.push(Ya.value.eOd());return G};Jl.Object.defineProperties(vd.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(sd.a)(vd,"ScriptCollection",null,[]);var yh=b(179);xc.prototype.Lga=function(){return new xc(this.J9)};xc.prototype.eOd=function(){return this.J9};Jl.Object.defineProperties(xc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.J9.id}},gF:{configurable:!0,enumerable:!0,get:function(){return this.J9.shareId},
set:function(G){this.J9.shareId=G||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.J9.name}},pxe:{configurable:!0,enumerable:!0,get:function(){return this.J9.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.J9.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.J9.description}},O3e:{configurable:!0,enumerable:!0,get:function(){return this.J9.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.gF&&
0<this.gF.length}}});Object(sd.a)(xc,"ScriptCore",null,[]);var Ah=b(57),aj=b(43);Cm(cc,Je);cc.prototype.K8b=function(G){switch(G){case "1":case "2":case "3":return this.QA.vJ(parseInt(G)-1);default:return this.Ue.Hk.Ly(G)||this.Ue.Nm.Ly(G)||this.Ue.pg.Ly(G)||this.Ue.Rs.Ly(G)}};cc.prototype.P7b=function(G,la,Ya){var Fb=null;if(this.Ue.g2a)switch(G){case "1":case "2":case "3":Fb=this.QA.vJ(parseInt(G)-1);break;default:Fb=this.QA.Ly(G)}aj.a.isReactRibbonEnabled()?(Ya=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Ya:!Ah.a.Nf.xA,la[Eb.a.GalleryButtonProps]=Xd.t0b(G,Fb,Ya)):la[Eb.a.InnerHTML]=Xd.ZMe(Fb);la[Eb.a.Alt]=Fb?Fb.name:""};cc.prototype.RC=function(G){this.QA=this.DDb();this.$.If();var la=[];la.push(Object.assign(new gf.a,{name:"Operation",string:G}));la.push(Object.assign(new gf.a,{name:"HasReadRecentCachedScripts",bool:this.Ue.qJa}));la.push(Object.assign(new gf.a,{name:"ReadScriptsDone",bool:this.Ue.i2a}));la.push(Object.assign(new gf.a,{name:"ReadSamplesScriptsDone",bool:this.Ue.Xba}));la.push(Object.assign(new gf.a,
{name:"SamplesScriptCount",int64:this.Ue.Rs.length}));la.push(Object.assign(new gf.a,{name:"ReadRecentScriptsDone",bool:this.Ue.Wba}));la.push(Object.assign(new gf.a,{name:"RecentScriptCount",int64:this.Ue.Hk.length}));la.push(Object.assign(new gf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ue.Ms}));la.push(Object.assign(new gf.a,{name:"WorkbookScriptCount",int64:this.Ue.pg.length}));ya.a(rd.a.Wrd,!0,0,la)};cc.prototype.H9b=function(G){var la=!1,Ya="",Fb=new xc(G.scriptMetadata),lc={Operation:"HandleRefreshRibbonGallery"};
lc.RefreshOperation=G.operationName;switch(G.operationName){case kf.a.oAd:G=this.utb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.mAd:G=this.stb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.lAd:G=this.rtb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.nAd:G=this.ttb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.VCf:G=this.jcd(Fb),Ya=G.message,la=G.returnValue}(lc.GalleryUpdated=la)?(pe.ULS.sendTraceTag(539309782,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",
Ya),this.RC("RefreshGallery")):pe.ULS.sendTraceTag(539309781,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ya);lc.Message=Ya;pe.ULS.sendTraceTag(539309780,0,50,ji.c(lc))};cc.prototype.DDb=function(){for(var G=new vd([],function(){}),la=this.Ue.pg?this.Ue.pg.length:0,Ya=this.Ue.Hk?this.Ue.Hk.length:0,Fb=this.Ue.Rs?this.Ue.Rs.length:0,lc=0,Lc=0;Lc<kf.a.zxd;Lc++)if(Lc<la)G.Wp(this.Ue.pg.vJ(Lc));else if(Lc-la+lc<Ya){var ad=this.Ue.Hk.vJ(Lc-la+
lc);this.Ue.pg.Ly(ad.id)?(lc++,Lc--):G.Wp(ad)}else Lc-la-Ya+lc<Fb&&G.Wp(this.Ue.Rs.vJ(Lc-la+lc-Ya));return G};cc.prototype.utb=function(G){if(this.Ue.Hk.bWa(G))var la="";else{la="";var Ya=G.Lga();this.Ue.pg.xda(Ya);this.Ue.pg.sort();this.Ue.Hk.xda(G)}return{returnValue:!0,message:la}};cc.prototype.stb=function(G){this.Ue.pg.kha(G.id);return this.Ue.Hk.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};cc.prototype.rtb=
function(G){var la=G.Lga();la.gF=null;this.Ue.Hk.bWa(la);return this.Ue.pg.Wp(G)?(this.Ue.pg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};cc.prototype.ttb=function(G){return this.Ue.pg.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};cc.prototype.jcd=function(G){var la=G.Lga(),Ya=!1;this.Ue.pg.vcc(la)&&(this.Ue.pg.xda(la),this.Ue.pg.sort(),
Ya=!0);this.Ue.Hk.bWa(G)?Ya=!0:this.Ue.Hk.vcc(G)&&(this.Ue.Hk.xda(G),this.Ue.Hk.ugf(G),Ya=!0);return{returnValue:Ya,message:""}};Object(sd.a)(cc,"AutomateCommandGallery",Je,[]);var ei=b(88);Object(sd.a)(hb,"AutomateCommandLicensingBase",null,[]);Object(sd.a)(sa,"BoolResultWrapper",null,[]);Cm(Yb,hb);Yb.prototype.Bpe=function(){var G=this,la=Lh.a.Ta.Lb,Ya=[];return new Promise(function(Fb){ei.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(lc){lc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Lc){Ya.push(Object.assign(new gf.a,{name:"IsLicensed",bool:Lc}));ya.a(rd.a.Zif,!0,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Ya);G.Gx=new sa(Lc,!0);Fb(Lc)}).catch(function(Lc){Ya.push(Object.assign(new gf.a,{name:"IsLicensed",bool:!1}));Ya.push(Object.assign(new gf.a,{name:"Error",string:Lc.toString()}));Ya.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"}));ya.a(rd.a.Zif,!1,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Ya);G.Gx=new sa(!1,!1,void 0,"exception",Lc.toString());
Fb(!1)})})})};Object(sd.a)(Yb,"AutomateCommandLicensing",hb,[]);var mj=b(1266),tj=b(1264),nh=b(1263),Fi=b(1265);De.taskPaneWidth="TaskPaneWidth";De.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";De.pl="TaskPaneTitle";De.Rj="IconCssClass";De.mNd="TaskPaneIconUrl";De.MQa="TaskPaneIconId";De.$J="NonPersistedSettings";De.onTaskPaneClose="OnTaskPaneClose";De.BNc="ActionArgs";Object(sd.a)(De,"PropertyNames",null,[]);var eh=b(139),gj=b(194),Vj=b(304),si=b(4);Cm(Od,Je);Od.prototype.K8b=
function(G){switch(G){case "1":case "2":case "3":return this.QA.vJ(parseInt(G)-1);default:return this.automateCommandManager.Hk.Ly(G)||this.automateCommandManager.pg.Ly(G)||this.automateCommandManager.Rs.Ly(G)}};Od.prototype.P7b=function(G,la,Ya){var Fb=null;if(this.automateCommandManager.g2a)switch(G){case "1":case "2":case "3":Fb=this.QA.vJ(parseInt(G)-1);break;default:Fb=this.QA.Ly(G)}aj.a.isReactRibbonEnabled()?(Ya=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Ya:!Ah.a.Nf.xA,la[Eb.a.GalleryButtonProps]=Xd.t0b(G,Fb,Ya)):la[Eb.a.InnerHTML]=Xd.ZMe(Fb);la[Eb.a.Alt]=Fb?Fb.name:""};Od.prototype.RC=function(G){this.QA=this.DDb();this.$.If();var la=[];la.push(Object.assign(new gf.a,{name:"Operation",string:G}));la.push(Object.assign(new gf.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.qJa}));la.push(Object.assign(new gf.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.i2a}));la.push(Object.assign(new gf.a,{name:"ReadSamplesScriptsDone",
bool:this.automateCommandManager.Xba}));la.push(Object.assign(new gf.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.Rs.length}));la.push(Object.assign(new gf.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.Wba}));la.push(Object.assign(new gf.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Hk.length}));la.push(Object.assign(new gf.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.Ms}));la.push(Object.assign(new gf.a,{name:"WorkbookScriptCount",
int64:this.automateCommandManager.pg.length}));ya.a(rd.a.Wrd,!0,0,la)};Od.prototype.H9b=function(G){var la=!1,Ya="",Fb=new xc(G.scriptMetadata),lc={Operation:"HandleRefreshRibbonGallery"};lc.RefreshOperation=G.operationName;switch(G.operationName){case kf.a.oAd:G=this.utb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.mAd:G=this.stb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.lAd:G=this.rtb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.nAd:G=this.ttb(Fb);Ya=G.message;la=G.returnValue;
break;case kf.a.VCf:G=this.jcd(Fb),Ya=G.message,la=G.returnValue}(lc.GalleryUpdated=la)?(pe.ULS.sendTraceTag(545064346,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Ya),this.RC("RefreshGallery")):pe.ULS.sendTraceTag(545064345,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ya);lc.Message=Ya;pe.ULS.sendTraceTag(545064344,0,50,ji.c(lc))};Od.prototype.DDb=function(){for(var G=new vd([],function(){}),la=this.automateCommandManager.pg?
this.automateCommandManager.pg.length:0,Ya=this.automateCommandManager.Hk?this.automateCommandManager.Hk.length:0,Fb=this.automateCommandManager.Rs?this.automateCommandManager.Rs.length:0,lc=0,Lc=0;Lc<kf.a.zxd;Lc++)if(Lc<la)G.Wp(this.automateCommandManager.pg.vJ(Lc));else if(Lc-la+lc<Ya){var ad=this.automateCommandManager.Hk.vJ(Lc-la+lc);this.automateCommandManager.pg.Ly(ad.id)?(lc++,Lc--):G.Wp(ad)}else Lc-la-Ya+lc<Fb&&G.Wp(this.automateCommandManager.Rs.vJ(Lc-la+lc-Ya));return G};Od.prototype.utb=
function(G){if(this.automateCommandManager.Hk.bWa(G))var la="";else{la="";var Ya=G.Lga();this.automateCommandManager.pg.xda(Ya);this.automateCommandManager.pg.sort();this.automateCommandManager.Hk.xda(G)}return{returnValue:!0,message:la}};Od.prototype.stb=function(G){this.automateCommandManager.pg.kha(G.id);return this.automateCommandManager.Hk.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};Od.prototype.rtb=
function(G){var la=G.Lga();la.gF=null;this.automateCommandManager.Hk.bWa(la);return this.automateCommandManager.pg.Wp(G)?(this.automateCommandManager.pg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Od.prototype.ttb=function(G){return this.automateCommandManager.pg.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Od.prototype.jcd=function(G){var la=
G.Lga(),Ya=!1;this.automateCommandManager.pg.vcc(la)&&(this.automateCommandManager.pg.xda(la),this.automateCommandManager.pg.sort(),Ya=!0);this.automateCommandManager.Hk.bWa(G)?Ya=!0:this.automateCommandManager.Hk.vcc(G)&&(this.automateCommandManager.Hk.xda(G),this.automateCommandManager.Hk.ugf(G),Ya=!0);return{returnValue:Ya,message:""}};Object(sd.a)(Od,"AutomateCommandGalleryOld",Je,[]);ld.XUf=function(G){G.sort(function(la,Ya){return Ya.pxe-la.pxe})};ld.Vsc=function(G){G.sort(function(la,Ya){return Ig.a.compare(la.name,
Ya.name,!0)})};ld.QUe=function(G){var la;var Ya=la=null;if(G){var Fb=G.indexOf(":");if(-1!==Fb)return la=G.substr(0,Fb),Ya=G.substr(Fb+1),{returnValue:!0,kMd:la,gF:Ya}}return{returnValue:!1,kMd:la,gF:Ya}};ld.wHh=function(G,la){var Ya={};Ya[kf.a.j6f]=encodeURIComponent(G.workbookContext.WorkbookFileName);Ya[kf.a.oLf]=la.nbb();return Qh.a.Oc(Ya)};Jl.Object.defineProperties(ld.prototype,{g2a:{configurable:!0,enumerable:!0,get:function(){return this.W3||this.i2a}},i2a:{configurable:!0,enumerable:!0,get:function(){return(kf.a.kV?
this.Wba:this.Y5)&&this.Ms&&this.Xba}}});Object(sd.a)(ld,"AutomateCommandStorageBase",null,[]);Object(sd.a)(Vd,"UserInfo",null,[]);var sj=b(519),Oj=b(160),Vi=b(81),ci=b(273);Object(sd.a)(Vc,"LaunchSDXParams",null,[]);Object(sd.a)(Fc,"RunfromButtonParameters",null,[]);var Ik=b(161),tk=b(127),xj=b(27),bk=b(895),yk=b(50),uk=b(107);$b.prototype.waj=function(G){kf.a.Ip?this.Ue.Nm=G:this.T6d=G};$b.prototype.vaj=function(G){kf.a.Ip?this.Ue.pg=G:this.u5d=G};$b.prototype.zaj=function(G){kf.a.Ip?this.Ue.Rs=
G:this.t8d=G};$b.prototype.xaj=function(G){this.Ue.Hk=G};$b.prototype.NHb=function(G){var la=Jf.AFrameworkApplication.ha.ta("IsO365CommercialHost"),Ya="",Fb="";var lc=!(this.Bv.Gx&&this.Bv.Gx.isSuccess&&this.Bv.Gx.value&&(!this.Rz||!this.Rz.isSuccess));this.Bv.Gx&&!this.Bv.Gx.isSuccess?(Fb=this.Bv.Gx.errorCode,Ya=this.Bv.Gx.errorMessage):this.Rz&&!this.Rz.isSuccess&&(Fb=this.Rz.errorCode,Ya=this.Rz.errorMessage);var Lc=[];Lc.push(Object.assign(new gf.a,{name:"IsScriptingEnabled",bool:this.Gaa}));
Lc.push(Object.assign(new gf.a,{name:"IsValidHost",bool:la}));Lc.push(Object.assign(new gf.a,{name:"IsUserLicensed",bool:this.Bv.Gx?this.Bv.Gx.value:!1}));Lc.push(Object.assign(new gf.a,{name:"IsAdminSwitchOn",bool:this.Rz?this.Rz.value:!1}));Lc.push(Object.assign(new gf.a,{name:"ShowTab",bool:this.Gaa}));Lc.push(Object.assign(new gf.a,{name:"ServiceChecked",bool:!G}));this.Gaa&&aj.a.wva(this.$)&&((G=Ik.a(this.$))&&G.Hn?(Lc.push(Object.assign(new gf.a,{name:"RibbonType",string:"React"})),G.Hn.vhj(si.a.vzd),
G.Hn.JHd(["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],!1)):(Fb="ribbon_manager_error",Ya="The RibbonManager or RibbonUser is null"));Lc.push(Object.assign(new gf.a,{name:"Error",string:Ya}));Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:Fb}));ya.a(rd.a.hni,lc,ie.getElapsedMilliseconds(this.initTime,Lh.a.Ta.Lb),Lc)};$b.prototype.gd=function(G,la){if(!la)return!1;la.MenuItems=this.AAg.Yrh(la.MenuId);return!0};$b.prototype.fGi=function(){var G=this;if(this.kva)if(kf.a.kV)this.Ue.MBf(this.UX).continueWith(function(Fb){Fb.result&&
G.UX.RC(kf.a.VNa)});else if(kf.a.Ip)this.Ue.HNi(this.UX);else{var la=Lh.a.Ta.Lb,Ya=[];xh.TaskExtensions.Da(this.indexedDB.yIa(kf.a.FNa),function(Fb){var lc=!G.Y5||!G.Nm.length;Fb=Fb.result;Ya.push(Object.assign(new gf.a,{name:"ExistingScriptCount",int64:G.Nm.length}));if(""!==Fb)if(Fb=ji.b(Fb),Ya.push(Object.assign(new gf.a,{name:"CachedScriptCount",int64:Fb.length})),lc){for(var Lc=Ml(Fb),ad=Lc.next();!ad.done;ad=Lc.next())G.Nm.Wp(new xc(ad.value));G.Nm.sort();G.W3=!0;G.A8a=0<Fb.length;ya.a(rd.a.$zb,
lc,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Ya);G.RC("CachedScripts")}else ya.a(rd.a.$zb,lc,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Ya);else ya.a(rd.a.$zb,lc,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Ya)},this.$.ma,3)}Uc(this.$)?this.$Te(Object.assign(new M.a,{IsSuccess:!0,Token:"FakeToken"})):this.Pqa.h8b().then(function(Fb){G.$Te(Fb)})};$b.prototype.P7b=function(G,la,Ya){if(kf.a.kV||kf.a.Ip)this.UX.P7b(G,la,Ya);else{var Fb=null;if(this.g2a)switch(G){case "1":case "2":case "3":Fb=this.QA.vJ(parseInt(G)-
1);break;default:Fb=this.QA.Ly(G)}la[Eb.a.GalleryButtonProps]=Xd.t0b(G,Fb,this.v7h?2===Ya:!Ah.a.Nf.xA);la[Eb.a.Alt]=Fb?Fb.name:""}};$b.prototype.H9b=function(G){if(kf.a.kV||kf.a.Ip)this.UX.H9b(G);else{var la=!1,Ya="",Fb=new xc(G.scriptMetadata),lc={Operation:"HandleRefreshRibbonGallery"};lc.RefreshOperation=G.operationName;switch(G.operationName){case kf.a.oAd:G=this.utb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.mAd:G=this.stb(Fb);Ya=G.message;la=G.returnValue;break;case kf.a.lAd:G=this.rtb(Fb);
Ya=G.message;la=G.returnValue;break;case kf.a.nAd:G=this.ttb(Fb),Ya=G.message,la=G.returnValue}(lc.GalleryUpdated=la)?(pe.ULS.sendTraceTag(594137311,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Ya),this.RC("RefreshGallery")):pe.ULS.sendTraceTag(594137310,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ya);lc.Message=Ya;pe.ULS.sendTraceTag(592496471,0,50,ji.c(lc))}};$b.prototype.OOh=function(G,la,Ya){this.$.qt(null,
!1,1023)&&(G=new Fc(kf.a.w0i,G,la,Ya,this.Gaa),this.Bke.vtb(G))};$b.prototype.POh=function(G,la,Ya){G=new Fc(kf.a.BBj,G,la,Ya,this.Gaa);this.Bke.vtb(G)};$b.prototype.w$h=function(G,la){var Ya=yk.b().ji(G),Fb=[];Fb.push(Object.assign(new gf.a,{name:"SessionId",string:this.$.Ba.UserSessionId}));Fb.push(Object.assign(new gf.a,{name:"MenuItemId",string:la}));Fb.push(Object.assign(new gf.a,{name:"WorkbookScriptCount",int64:this.pg.length}));Fb.push(Object.assign(new gf.a,{name:"PublishedScriptCount",int64:this.Nm.length}));
Fb.push(Object.assign(new gf.a,{name:"RecentScriptCount",int64:this.Hk.length}));Fb.push(Object.assign(new gf.a,{name:"Command",string:Ya}));la=la?this.K8b(la):null;if(Ya=this.aCh(G,Ya,la))Fb.push(Object.assign(new gf.a,{name:kf.a.Iga,string:Ya.qxa.zr[kf.a.Iga]})),mj.a.instance.wLa(Ya.yjh,"Taskpane",Ya.DFa,Ya.Hdd,Ya.qxa),1904816141===G&&(Fb.push(Object.assign(new gf.a,{name:"ScriptId",string:la.id})),Fb.push(Object.assign(new gf.a,{name:"ShareId",string:la.gF})),Fb.push(Object.assign(new gf.a,{name:"IsPreviewGallery",
bool:kf.a.kV||kf.a.Ip?!!this.UX.QA.Ly(la.id):!!this.QA.Ly(la.id)})),Fb.push(Object.assign(new gf.a,{name:"IsOwner",bool:la.O3e||!!this.Nm.Ly(la.id)})),this.$.If());ya.a(rd.a.dni,void 0,void 0,Fb)};$b.prototype.aCh=function(G,la,Ya){var Fb=kf.a.jr,lc=new tj.a(kf.a.D_e,kf.a.YLe,kf.a.locale),Lc=new nh.a(kf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,kf.a.YFb),ad=new Fi.a;ad.zr.AdminPolicyForFeedback=ji.c(this.qEa);ad.zr.DocumentHostInfo=Qh.a.Oc(this.$.Ba.DocumentHostInfo);ad.zr.CodeEditorUrl=kf.a.fsb(this.$);
ad.zr.MakerTestService=dg.EwaSettings.getBooleanFeatureGate(kf.a.Nyb,!1);ad.zr.StorageModePreference=this.nWf||"";ad.zr.Source="Ribbon";ad.zr.IsTeams=Ei.a.Jja;ad.zr[kf.a.gYf]=Qh.a.Oc(Fb);ad.zr[kf.a.hle]=this.$.Yif?"true":"false";ad.zr[kf.a.Iga]=gj.a.create().toString();var Kd=Ge(this.$),ue=ud(this.$);ad.aj.HeaderCssClass=Kd;ad.aj.TitleCssClass=ue;ad.zr[kf.a.zZe]=Kd;ad.zr[kf.a.jZf]=ue;Kd={};Kd.ribbonCommand=la;Kd[kf.a.mWf]=this.Pqa.getAuthContext();Kd[kf.a.FNa]=this.A8a?this.Nm.nbb():null;Kd[kf.a.wLb]=
this.Xxa?this.pg.nbb():null;kf.a.kV&&(Kd[kf.a.VNa]=this.Ue.Czd?this.Hk.nbb():null);ad.zr[kf.a.u2e]=Qh.a.Oc(Kd);la={};fc(this.$,la);ad.zr[kf.a.gLe]=Qh.a.Oc(la);switch(G){case -45542983:ad.zr.Script="";ad.zr.Destination="Editor";ad.zr.IsOwner=!0;ad.aj[De.pl]=Rf.a.instance.da(2034);ad.aj[De.taskPaneWidth]=Fb;ad.aj[De.sourceLocationOverrideResourceId]=kf.a.fsb(this.$);G=kf.a.yWc;break;case 971811139:case 1606046412:ad.zr.Script="";ad.zr.Destination="BackStage";ad.zr.IsOwner=!0;ad.aj[De.pl]=Rf.a.instance.da(2034);
ad.aj[De.taskPaneWidth]=Fb;ad.aj[De.sourceLocationOverrideResourceId]=kf.a.fsb(this.$);G=kf.a.yWc;break;case 1845457202:ad.aj[De.pl]=Rf.a.instance.da(2035);ad.aj[De.taskPaneWidth]=Fb;ad.aj[De.sourceLocationOverrideResourceId]=kf.a.GTe(this.$);G=kf.a.i2i;break;case 1904816141:if(Ya)ad.zr.Script=Qh.a.Oc(Ya.eOd()),ad.zr.Destination="Details",ad.zr.IsOwner=Ya.O3e||!!this.Nm.Ly(Ya.id),ad.aj[De.pl]=Rf.a.instance.da(2034),ad.aj[De.taskPaneWidth]=Fb,ad.aj[De.sourceLocationOverrideResourceId]=kf.a.fsb(this.$),
G=kf.a.yWc;else return null;break;default:return null}return new Vc(lc,Lc,ad,G)};$b.prototype.gth=function(){var G=this;ei.a.instance.yc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(la){G.qEa.FeedbackEnabled=!0;G.qEa.ScreenshotEnabled=!0;G.qEa.EmailEnabled=!0;la.mJ("Enabled").then(function(Ya){G.qEa.FeedbackEnabled=Ya},function(){});la.mJ("IncludeScreenshot").then(function(Ya){G.qEa.ScreenshotEnabled=Ya},function(){});la.mJ("IncludeEmail").then(function(Ya){G.qEa.EmailEnabled=
Ya},function(){})})};$b.prototype.sPh=function(G){var la=this,Ya=Lh.a.Ta.Lb,Fb=[];if(!G||!G.IsSuccess){var lc=G?G.ErrorCode:"need_token";G=G?G.ErrorMessage:"No Access Token";Fb.push(Object.assign(new gf.a,{name:"ServiceChecked",bool:!1}));Fb.push(Object.assign(new gf.a,{name:"Error",string:G}));Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:lc}));ya.a(rd.a.Urd,!1,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);this.Rz=new sa(!1,!1,void 0,lc,G);return Promise.resolve(!1)}Fb.push(Object.assign(new gf.a,
{name:"ServiceChecked",bool:!0}));ac(this.$,G.Token);return makerstorage.getUserPermissions(this.$.Ba.UserSessionId).then(function(Lc){la.Rz=new sa(Lc.OfficeScriptingEnabled,!0);la.vTc(kf.a.T6b(la.$),Lc.OfficeScriptingEnabled);Fb.push(Object.assign(new gf.a,{name:"IsEnabled",bool:la.Rz.value}));ya.a(rd.a.Urd,!0,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);return Promise.resolve(la.Rz.value)}).catch(function(Lc){Object.getType(Lc)===makerstorage.StorageServiceError?(Fb.push(Object.assign(new gf.a,
{name:"Error",string:Lc.message})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Lc.errorCode.toString(),Lc.status.toString())}))):(Fb.push(Object.assign(new gf.a,{name:"Error",string:Lc.toString()})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"})));ya.a(rd.a.Urd,!1,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.Rz=new sa(!1,!1,void 0,"exception",Lc.toString());return Promise.resolve(!1)})};$b.prototype.Dzd=function(G){var la=
this;if(kf.a.Ip)return this.Ue.Dzd(G,this.UX);var Ya=new eh.a,Fb=ce(this.$);return Ae(this.$,function(lc){if((lc=lc.Result)&&200===lc.ResponseStatusCode)lc=JSON.parse(lc.ResponseBody.join("")),G(la.Mvd(lc.value)),Ya.setResult(!0);else{lc=lc?"RichApi_"+lc.ResponseStatusCode:"RichApiError";var Lc=[];Lc.push(Object.assign(new gf.a,{name:"Error",string:"Failed to read shared script ids from document"}));Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:lc}));la.Ms=!0;la.kT(Lh.a.Ta.Lb,0,Lc);Ya.setResult(!1)}},
function(lc){lc=tk.a.Eg(lc.data);pe.ULS.sendTraceTag(51684375,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",xj.a.fd(lc));var Lc=[];Lc.push(Object.assign(new gf.a,{name:"Error",string:"Failure using rich api: "+lc}));Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:"RichApiFailure"}));la.Ms=!0;la.kT(Lh.a.Ta.Lb,0,Lc);Ya.setResult(!1)},Fb,Ya)};$b.prototype.$Te=function(G){var la=this;kf.a.kV?this.Ue.bGh(G,this.UX,this.cache):this.BFh(G);this.had();this.Dzd(function(Ya){la.uad(Ya,
G)})};$b.prototype.had=function(){if(kf.a.Ip)this.Ue.had(this.UX);else{var G={id:"samples-2"};G.name=Rf.a.instance.da(2047);this.Rs.Wp(new xc(G));G.id="samples-4";G.name=Rf.a.instance.da(2048);this.Rs.Wp(new xc(G));G.id="samples-5";G.name=Rf.a.instance.da(2049);this.Rs.Wp(new xc(G));this.Xba=!0;this.RC("SampleScripts")}};$b.prototype.BFh=function(G){var la=this,Ya=Lh.a.Ta.Lb,Fb=[];if(G&&G.IsSuccess){ac(this.$,G.Token);var lc=bj.a.create().toString();Fb.push(Object.assign(new gf.a,{name:"CorrelationId",
string:lc}));makerstorage.getScripts(lc).then(function(Lc){Fb.push(Object.assign(new gf.a,{name:"HasReadCachedScripts",bool:la.W3}));la.Nm.clear();Lc=Ml(Lc);for(var ad=Lc.next();!ad.done;ad=Lc.next())la.Nm.Wp(new xc(ad.value));la.Nm.sort();la.A8a=!0;la.Y5=!0;la.kva&&(Lc=Qh.a.Oc(la.Nm.nbb()),la.indexedDB.U9a(new bk.a(kf.a.FNa,Lc)));Fb.push(Object.assign(new gf.a,{name:"ScriptCount",int64:la.Nm.length}));ya.a(rd.a.aAb,!0,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.RC(kf.a.FNa)}).catch(function(Lc){Object.getType(Lc)===
makerstorage.StorageServiceError?(Fb.push(Object.assign(new gf.a,{name:"Error",string:Lc.message})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Lc.errorCode.toString(),Lc.status.toString())})),17===Lc.errorCode&&la.cache.rBd(kf.a.T6b(la.$))):(Fb.push(Object.assign(new gf.a,{name:"Error",string:Lc.toString()})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"})));ya.a(rd.a.aAb,!1,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.Y5=
!0;la.RC(kf.a.FNa)})}else lc=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",Fb.push(Object.assign(new gf.a,{name:"ServiceChecked",bool:!1})),Fb.push(Object.assign(new gf.a,{name:"Error",string:G})),Fb.push(Object.assign(new gf.a,{name:"ErrorCode",string:lc})),ya.a(rd.a.aAb,!1,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb),this.Y5=!0,this.RC(kf.a.FNa)};$b.prototype.uad=function(G,la){var Ya=this;if(kf.a.Ip)this.Ue.uad(G,la,this.UX);else{var Fb=Lh.a.Ta.Lb,lc=0,Lc=0;this.Ms=lc===G.count;
var ad=[];ad.push(Object.assign(new gf.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(la&&la.IsSuccess){ac(this.$,la.Token);var Kd={};la=Ml(G);for(var ue=la.next();!ue.done;Kd={Scb:Kd.Scb},ue=la.next())ue=ue.value,Kd.Scb=bj.a.create().toString(),makerstorage.getSharedScript(ue.value,Kd.Scb).then(function(af){return function(Xe){var pg=[];pg.push(Object.assign(new gf.a,{name:"BodySize",int64:Xe.body.length}));pg.push(Object.assign(new gf.a,{name:"CorrelationId",string:af.Scb}));ya.a(rd.a.vhc,!0,
ie.getElapsedMilliseconds(Fb,Lh.a.Ta.Lb),pg);lc++;Xe=new xc(Xe);Xe.gF=G.oa(Xe.id);Ya.pg.Wp(Xe);Ya.Ms=lc===G.count;Ya.Xxa=!0;Ya.kT(Fb,Lc,ad)}}(Kd)).catch(function(af){return function(Xe){var pg=[];Object.getType(Xe)===makerstorage.StorageServiceError?(ad.push(Object.assign(new gf.a,{name:"Error",string:Xe.message})),ad.push(Object.assign(new gf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Xe.errorCode.toString(),Xe.status.toString())}))):(pg.push(Object.assign(new gf.a,{name:"Error",
string:Xe.toString()})),pg.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"})));pg.push(Object.assign(new gf.a,{name:"CorrelationId",string:af.Scb}));ya.a(rd.a.vhc,!1,ie.getElapsedMilliseconds(Fb,Lh.a.Ta.Lb),pg);lc++;Lc++;Ya.Ms=lc===G.count;Ya.kT(Fb,Lc,ad)}}(Kd))}else Kd=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",ad.push(Object.assign(new gf.a,{name:"Error",string:la})),ad.push(Object.assign(new gf.a,{name:"ErrorCode",string:Kd})),this.Ms=!0,this.kT(Fb,Lc,
ad);else this.Ms=this.Xxa=!0,this.kT(Fb,Lc,ad)}};$b.prototype.kT=function(G,la,Ya){this.Ms&&(Ya.push(Object.assign(new gf.a,{name:"ScriptCount",int64:this.pg.length})),Ya.push(Object.assign(new gf.a,{name:"ScriptErrorCount",int64:la})),ya.a(rd.a.ajf,!la,ie.getElapsedMilliseconds(G,Lh.a.Ta.Lb),Ya),this.pg.sort(),this.RC(kf.a.wLb))};$b.prototype.Mvd=function(G){var la=new uk.a;if(G=$b.usa.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");
for(var Ya={},Fb=0;Fb<G.length;Ya={iMb:Ya.iMb,fMb:Ya.fMb,aMb:Ya.aMb},Fb++)Ya.iMb=G[Fb].getAttribute("id"),Ig.a.na(Ya.iMb)||(Ya.fMb=void 0,Ya.aMb=void 0,function(lc){return function(){var Lc=ld.QUe(lc.iMb);lc.fMb=Lc.kMd;lc.aMb=Lc.gF;return Lc}}(Ya)().returnValue&&la.ja(Ya.fMb,Ya.aMb))}return la};$b.prototype.K8b=function(G){if(kf.a.kV||kf.a.Ip)return this.UX.K8b(G);switch(G){case "1":case "2":case "3":return this.QA.vJ(parseInt(G)-1);default:return this.Nm.Ly(G)||this.pg.Ly(G)||this.Rs.Ly(G)}};$b.prototype.utb=
function(G){if(this.Nm.Wp(G)){this.Nm.sort();var la=""}else{la="";var Ya=G.Lga();this.pg.xda(Ya);this.pg.sort();this.Nm.xda(G);this.Nm.sort()}return{returnValue:!0,message:la}};$b.prototype.stb=function(G){this.pg.kha(G.id);return this.Nm.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};$b.prototype.rtb=function(G){var la=G.Lga();la.gF=null;this.Nm.Wp(la)&&this.Nm.sort();return this.pg.Wp(G)?(this.pg.sort(),
{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};$b.prototype.ttb=function(G){return this.pg.kha(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};$b.prototype.RC=function(G){if(kf.a.kV||kf.a.Ip)this.UX.RC(G);else{this.DDb();this.$.If();var la=[];la.push(Object.assign(new gf.a,{name:"Operation",string:G}));la.push(Object.assign(new gf.a,{name:"HasReadCachedScripts",
bool:this.W3}));la.push(Object.assign(new gf.a,{name:"ReadScriptsDone",bool:this.i2a}));la.push(Object.assign(new gf.a,{name:"ReadSamplesScriptsDone",bool:this.Xba}));la.push(Object.assign(new gf.a,{name:"SamplesScriptCount",int64:this.Rs.length}));la.push(Object.assign(new gf.a,{name:"ReadPublishedScriptsDone",bool:this.Y5}));la.push(Object.assign(new gf.a,{name:"PublishedScriptCount",int64:this.Nm.length}));la.push(Object.assign(new gf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ms}));la.push(Object.assign(new gf.a,
{name:"WorkbookScriptCount",int64:this.pg.length}));ya.a(rd.a.Wrd,!0,0,la)}};$b.prototype.DDb=function(){this.QA=new vd([],function(){});for(var G=this.pg?this.pg.length:0,la=this.Nm?this.Nm.length:0,Ya=this.Rs?this.Rs.length:0,Fb=0,lc=0;lc<kf.a.zxd;lc++)if(lc<G)this.QA.Wp(this.pg.vJ(lc));else if(lc-G+Fb<la){var Lc=this.Nm.vJ(lc-G+Fb);this.pg.Ly(Lc.id)?(Fb++,lc--):this.QA.Wp(Lc)}else lc-G-la+Fb<Ya&&this.QA.Wp(this.Rs.vJ(lc-G+Fb-la))};$b.prototype.vTc=function(G,la){if(kf.a.Ip)this.Ue.vTc(G,la);else if(this.cache.te()){var Ya=
{};Ya.TimeStamp=Lh.a.Ta.Lb;Ya.IsEnabled=la;this.cache.Hqc(G,Qh.a.Oc(Ya))}};$b.prototype.h8c=function(G){if(kf.a.Ip)return this.Ue.h8c(G);var la=!1,Ya=!1,Fb=null;this.cache.te()&&(G=ji.b(this.cache.d1a(G)))&&(Ya=G.IsEnabled,Fb=new Date(G.TimeStamp),la=!0);return new sa(Ya,la,Fb)};Jl.Object.defineProperties($b.prototype,{Nm:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Nm:this.T6d}},pg:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.pg:this.u5d}},Rs:{configurable:!0,
enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Rs:this.t8d}},Hk:{configurable:!0,enumerable:!0,get:function(){return this.Ue.Hk}},Va:{configurable:!0,enumerable:!0,get:function(){return this.dKc}},Xba:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Xba:this.k7d},set:function(G){kf.a.Ip?this.Ue.Xba=G:this.k7d=G}},Ms:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Ms:this.m7d},set:function(G){kf.a.Ip?this.Ue.Ms=G:this.m7d=G}},Wba:{configurable:!0,enumerable:!0,
get:function(){return this.Ue.Wba}},qJa:{configurable:!0,enumerable:!0,get:function(){return this.Ue.qJa}},i2a:{configurable:!0,enumerable:!0,get:function(){return(kf.a.kV?this.Wba:this.Y5)&&this.Ms&&this.Xba}},g2a:{configurable:!0,enumerable:!0,get:function(){return(kf.a.kV?this.qJa:this.W3)||this.i2a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.$dg}},Gaa:{configurable:!0,enumerable:!0,get:function(){var G=!!this.Bv.Gx&&this.Bv.Gx.isSuccess&&this.Bv.Gx.value,la=!!this.Rz&&
!this.Rz.isSuccess,Ya=!!this.Rz&&this.Bv.Gx.isSuccess&&this.Rz.value;return this.p9e&&G&&(Ya||la&&!Ei.a.Eva(11))}},A8a:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.A8a:this.i7d},set:function(G){kf.a.Ip?this.Ue.A8a=G:this.i7d=G}},Xxa:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Xxa:this.l7d},set:function(G){kf.a.Ip?this.Ue.Xxa=G:this.l7d=G}},W3:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.W3:this.h_d},set:function(G){kf.a.Ip?this.Ue.W3=
G:this.h_d=G}},Y5:{configurable:!0,enumerable:!0,get:function(){return kf.a.Ip?this.Ue.Y5:this.j7d},set:function(G){kf.a.Ip?this.Ue.Y5=G:this.j7d=G}},p9e:{configurable:!0,enumerable:!0,get:function(){var G="TestHost"===this.$.Ba.DocumentHostInfo.HostTier,la=Jf.AFrameworkApplication.ha.Wa("UserPrincipalName");la=!Jf.AFrameworkApplication.ha.ta("IsAnonymousUser")&&!Ig.a.na(la)&&!Ig.a.contains(la,"ext#",!1)&&!Ig.a.contains(la,"guest#",!1);return!Ei.a.xja&&(G||this.Pqa.qke&&la)}}});$b.usa=new DOMParser;
Object(sd.a)($b,"AutomateCommandManager",null,[15]);var dj=b(1321),zk=b(1268),Wi=b(229);gd.key="InsertAgaveClientSideParametersKey";Object(sd.a)(gd,"InsertAgaveClientSideParameters",null,[]);var Xi=b(58),nk=b(103),ti=b(20);Le.prototype.vtb=function(G){if(dg.EwaSettings.getBooleanFeatureGate(kf.a.Iwa,!1)&&G.Gaa){var la=[];la.push(Object.assign(new gf.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.t4a}));la.push(Object.assign(new gf.a,{name:"actionName",string:G.actionName}));la.push(Object.assign(new gf.a,
{name:kf.a.Iga,string:G.Aqe.toString()}));this.t4a?this.eMf(G):this.nNh(G);ya.a(rd.a.eni,void 0,void 0,la)}};Le.prototype.Raj=function(){this.ZRf()?this.vxf():ti.g(this.$).Ha.Aee(Object(Ve.a)(this,this.p6a,"onAllFloatingObjectsRendered"))};Le.prototype.p6a=function(){this.ZRf()?(this.vxf(),ti.g(this.$).Ha.OBd(Object(Ve.a)(this,this.p6a,"onAllFloatingObjectsRendered"))):this.t4a&&ti.g(this.$).Ha.OBd(Object(Ve.a)(this,this.p6a,"onAllFloatingObjectsRendered"))};Le.prototype.ZRf=function(){if(this.t4a||
Uc(this.$))return!1;var G=nk.a(this.$);return ti.g(this.$).Ha.jWb&&G.NZh()};Le.prototype.vxf=function(){var G=this;this.Bv.Gx?this.Bv.Gx.value&&this.Pqa.h8b():this.Bv.Bpe().then(function(la){la&&G.Pqa.h8b()});ya.a(rd.a.ani)};Le.prototype.eqi=function(G,la){Object.getType(la)===String&&la.toString().endsWith(kf.a.OIa(this.$))&&(this.t4a=!1)};Le.prototype.o4i=function(){var G=gj.a.create().toString(),la={};fc(this.$,la);var Ya={};Ya[kf.a.mWf]=this.Pqa.getAuthContext();var Fb={};Fb[kf.a.gLe]=Qh.a.Oc(la);
Fb[kf.a.u2e]=Qh.a.Oc(Ya);Fb[kf.a.S4g]=Qh.a.Oc(this.$.Ba.DocumentHostInfo);Fb[kf.a.Rlj]=Ob(this.$);Fb[kf.a.gYf]=Qh.a.Oc(kf.a.jr);Fb[kf.a.hle]=this.$.Yif?"true":"false";Fb[kf.a.zZe]=Ge(this.$);Fb[kf.a.jZf]=ud(this.$);Fb[kf.a.Iga]=G;la=[];la.push(Object.assign(new gf.a,{name:kf.a.Iga,string:G}));ya.a(rd.a.cni,void 0,void 0,la);this.rMf(kf.a.NUh,Fb)};Le.prototype.nNh=function(G){var la=this;Uc(this.$)&&ac(this.$,"localstorage");xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.Xa(this.$.ea,374,375,1,"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager"),
function(Ya){la.Yai(Ya.result).continueWith(function(){la.n4i(G)});la.t4a=!0},this.$.ma,3)};Le.prototype.Yai=function(G){var la={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.SolutionId=kf.a.assetId,la.Version=kf.a.YFb,la.StoreType=OSF.StoreType.Sdx,la.StoreId=OSF.StoreType.Sdx,la.AssetId=kf.a.assetId,la.AssetStoreId=OSF.StoreType.Sdx,la.TargetType=1,la.SharedRuntimeId=kf.a.OIa(this.$),la.SourceLocationOverrideResourceId=kf.a.OIa(this.$),
la.IsToBePersisted=!1,la.Id=kf.a.assetId,la.AppVersion=kf.a.YFb,la.CurrentStoreType=OSF.StoreType.Sdx):(la.AppVersion=kf.a.YFb,la.AssetId=kf.a.assetId,la.AssetStoreId=OSF.StoreType.Sdx,la.CurrentStoreType=OSF.StoreType.Sdx,la.Id=kf.a.assetId,la.StoreId=OSF.StoreType.Sdx,la.TargetType=1,la.SharedRuntimeId=kf.a.OIa(this.$),la.SourceLocationOverrideResourceId=kf.a.OIa(this.$),la.IsToBePersisted=!1);var Ya=new dj.a;Ya.pl=Rf.a.instance.da(2051);Ya.taskPaneWidth=kf.a.jr;var Fb=new gd;Fb.Buc=ud(this.$);
Fb.V$=Ge(this.$);return G.kFd(la,Ya,void 0,void 0,Fb)};Le.prototype.n4i=function(G){this.o4i();Wi.a(this.$)&&Wi.a(this.$).Mee(Object(Ve.a)(this,this.eqi,"onControlDeleted"));this.eMf(G)};Le.prototype.eMf=function(G){var la={};la[kf.a.y0i]=G.shapeId;la[kf.a.x0i]=G.f2i;la[kf.a.Iga]=G.Aqe.toString();this.rMf(G.actionName,la)};Le.prototype.rMf=function(G,la){var Ya=new nh.a(kf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,kf.a.YFb),Fb=new tj.a(kf.a.D_e,kf.a.YLe,this.$.Ba.UICultureTag),lc=new Fi.a;lc.aj[De.pl]=
Rf.a.instance.da(2051);lc.aj[De.sourceLocationOverrideResourceId]=kf.a.OIa(this.$);lc.aj[De.BNc]=la;lc.aj[De.taskPaneWidth]=kf.a.jr;mj.a.instance.wLa(Ya,zk.a.action,G,Fb,lc)};Object(sd.a)(Le,"AutomateCommandRunFromButton",null,[698]);Cm(Bf,ld);Bf.prototype.vTc=function(G,la){if(this.cache.te()){var Ya={};Ya.TimeStamp=Lh.a.Ta.Lb;Ya.IsEnabled=la;this.cache.Hqc(G,Qh.a.Oc(Ya))}};Bf.prototype.h8c=function(G){var la=!1,Ya=!1,Fb=null;this.cache.te()&&(G=ji.b(this.cache.d1a(G)))&&(Ya=G.IsEnabled,Fb=new Date(G.TimeStamp),
la=!0);return new sa(Ya,la,Fb)};Bf.prototype.MBf=function(G){var la=this,Ya=Lh.a.Ta.Lb,Fb=[];return xh.TaskExtensions.PFa(this.indexedDB.yIa(kf.a.VNa),function(lc){var Lc=!la.Wba||!la.Hk.length;lc=lc.result;Fb.push(Object.assign(new gf.a,{name:"ExistingScriptCount",int64:la.Hk.length}));if(""!==lc&&(lc=ji.b(lc),Fb.push(Object.assign(new gf.a,{name:"CachedScriptCount",int64:lc.length})),Lc)){for(var ad=Ml(lc),Kd=ad.next();!Kd.done;Kd=ad.next())la.Hk.Wp(new xc(Kd.value));la.qJa=!0;la.Czd=0<lc.length;
ya.a(rd.a.$if,Lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.jAd(G);return!0}ya.a(rd.a.$if,Lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);return!1},this.$.ma,3)};Bf.prototype.HNi=function(G){this.KNi(G);kf.a.kV?this.MBf(G):this.GNi(G)};Bf.prototype.bGh=function(G,la,Ya){var Fb=this,lc=Lh.a.Ta.Lb,Lc=[];if(G&&G.IsSuccess){ac(this.$,G.Token);var ad=bj.a.create().toString();Lc.push(Object.assign(new gf.a,{name:"CorrelationId",string:ad}));makerstorage.getRecentScripts(ad).then(function(Kd){Lc.push(Object.assign(new gf.a,
{name:"HasReadCachedScripts",bool:Fb.qJa}));Fb.Hk.clear();Kd=Ml(Kd);for(var ue=Kd.next();!ue.done;ue=Kd.next())Fb.Hk.Wp(new xc(ue.value));Fb.Czd=!0;Fb.Wba=!0;Fb.indexedDB.te()&&(Kd=Qh.a.Oc(Fb.Hk.nbb()),Fb.indexedDB.U9a(new bk.a(kf.a.VNa,Kd)));Lc.push(Object.assign(new gf.a,{name:"ScriptCount",int64:Fb.Hk.length}));ya.a(rd.a.aAb,!0,ie.getElapsedMilliseconds(lc,Lh.a.Ta.Lb),Lc);la.RC(kf.a.VNa)}).catch(function(Kd){Object.getType(Kd)===makerstorage.StorageServiceError?(Lc.push(Object.assign(new gf.a,
{name:"Error",string:Kd.message})),Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Kd.errorCode.toString(),Kd.status.toString())})),17===Kd.errorCode&&Ya.rBd(kf.a.T6b(Fb.$))):(Lc.push(Object.assign(new gf.a,{name:"Error",string:Kd.toString()})),Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"})));ya.a(rd.a.bni,!1,ie.getElapsedMilliseconds(lc,Lh.a.Ta.Lb),Lc);Fb.Wba=!0;la.RC(kf.a.VNa)})}else ad=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:
"No Access Token",Lc.push(Object.assign(new gf.a,{name:"ServiceChecked",bool:!1})),Lc.push(Object.assign(new gf.a,{name:"Error",string:G})),Lc.push(Object.assign(new gf.a,{name:"ErrorCode",string:ad})),ya.a(rd.a.aAb,!1,ie.getElapsedMilliseconds(lc,Lh.a.Ta.Lb),Lc),this.Wba=!0,la.RC(kf.a.VNa)};Bf.prototype.Dzd=function(G,la){var Ya=this,Fb=new eh.a,lc=ce(this.$);return Ae(this.$,function(Lc){if((Lc=Lc.Result)&&200===Lc.ResponseStatusCode)Lc=JSON.parse(Lc.ResponseBody.join("")),G(Ya.Mvd(Lc.value)),Fb.setResult(!0);
else{Lc=Lc?"RichApi_"+Lc.ResponseStatusCode:"RichApiError";var ad=[];ad.push(Object.assign(new gf.a,{name:"Error",string:"Failed to read shared script ids from document"}));ad.push(Object.assign(new gf.a,{name:"ErrorCode",string:Lc}));Ya.Ms=!0;Ya.kT(la,Lh.a.Ta.Lb,0,ad);Fb.setResult(!1)}},function(Lc){Lc=tk.a.Eg(Lc.data);pe.ULS.sendTraceTag(539309779,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var ad=[];ad.push(Object.assign(new gf.a,{name:"Error",string:"Failure using rich api: "+
Lc}));ad.push(Object.assign(new gf.a,{name:"ErrorCode",string:"RichApiFailure"}));Ya.Ms=!0;Ya.kT(la,Lh.a.Ta.Lb,0,ad);Fb.setResult(!1)},lc,Fb)};Bf.prototype.uad=function(G,la,Ya){var Fb=this,lc=Lh.a.Ta.Lb,Lc=0,ad=0;this.Ms=Lc===G.count;var Kd=[];Kd.push(Object.assign(new gf.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(la&&la.IsSuccess){ac(this.$,la.Token);var ue={};la=Ml(G);for(var af=la.next();!af.done;ue={Tcb:ue.Tcb},af=la.next())af=af.value,ue.Tcb=bj.a.create().toString(),makerstorage.getSharedScript(af.value,
ue.Tcb).then(function(Xe){return function(pg){var sg=[];sg.push(Object.assign(new gf.a,{name:"BodySize",int64:pg.body.length}));sg.push(Object.assign(new gf.a,{name:"CorrelationId",string:Xe.Tcb}));ya.a(rd.a.vhc,!0,ie.getElapsedMilliseconds(lc,Lh.a.Ta.Lb),sg);Lc++;pg=new xc(pg);pg.gF=G.oa(pg.id);Fb.pg.Wp(pg);Fb.Ms=Lc===G.count;Fb.Xxa=!0;Fb.kT(Ya,lc,ad,Kd);Fb.indexedDB.te()&&Fb.Ms&&(pg=ld.wHh(Fb.$,Fb.pg),Fb.indexedDB.U9a(new bk.a(kf.a.wLb,pg)))}}(ue)).catch(function(Xe){return function(pg){var sg=
[];Object.getType(pg)===makerstorage.StorageServiceError?(Kd.push(Object.assign(new gf.a,{name:"Error",string:pg.message})),Kd.push(Object.assign(new gf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",pg.errorCode.toString(),pg.status.toString())}))):(sg.push(Object.assign(new gf.a,{name:"Error",string:pg.toString()})),sg.push(Object.assign(new gf.a,{name:"ErrorCode",string:"exception"})));sg.push(Object.assign(new gf.a,{name:"CorrelationId",string:Xe.Tcb}));ya.a(rd.a.vhc,!1,ie.getElapsedMilliseconds(lc,
Lh.a.Ta.Lb),sg);Lc++;ad++;Fb.Ms=Lc===G.count;Fb.kT(Ya,lc,ad,Kd)}}(ue))}else ue=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",Kd.push(Object.assign(new gf.a,{name:"Error",string:la})),Kd.push(Object.assign(new gf.a,{name:"ErrorCode",string:ue})),this.Ms=!0,this.kT(Ya,lc,ad,Kd);else this.Ms=this.Xxa=!0,this.kT(Ya,lc,ad,Kd)};Bf.prototype.had=function(G){var la={id:"samples-2"};la.name=Rf.a.instance.da(2047);this.Rs.Wp(new xc(la));la.id="samples-4";la.name=Rf.a.instance.da(2048);
this.Rs.Wp(new xc(la));la.id="samples-5";la.name=Rf.a.instance.da(2049);this.Rs.Wp(new xc(la));this.Xba=!0;G.RC("SampleScripts")};Bf.prototype.Mvd=function(G){var la=new uk.a;if(G=this.usa.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");for(var Ya={},Fb=0;Fb<G.length;Ya={jMb:Ya.jMb,gMb:Ya.gMb,bMb:Ya.bMb},Fb++)Ya.jMb=G[Fb].getAttribute("id"),Ig.a.na(Ya.jMb)||(Ya.gMb=void 0,Ya.bMb=void 0,function(lc){return function(){var Lc=ld.QUe(lc.jMb);
lc.gMb=Lc.kMd;lc.bMb=Lc.gF;return Lc}}(Ya)().returnValue&&la.ja(Ya.gMb,Ya.bMb))}return la};Bf.prototype.KNi=function(G){var la=this,Ya=Lh.a.Ta.Lb,Fb=[];xh.TaskExtensions.PFa(this.indexedDB.yIa(kf.a.wLb),function(lc){lc=lc.result;Fb.push(Object.assign(new gf.a,{name:"ExistingScriptCount",int64:la.pg.length}));if(""!==lc){var Lc=ji.b(lc);lc=Lc[kf.a.j6f];Lc=Lc[kf.a.oLf];Fb.push(Object.assign(new gf.a,{name:"CachedScriptCount",int64:Lc.length}));if(lc=lc===encodeURIComponent(la.$.workbookContext.WorkbookFileName)&&
(!la.Ms||!la.pg.length)){Lc=Ml(Lc);for(var ad=Lc.next();!ad.done;ad=Lc.next())la.pg.Wp(new xc(ad.value));la.pg.sort();ya.a(rd.a.Vrd,lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.jAd(G);return!0}ya.a(rd.a.Vrd,lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb)}else ya.a(rd.a.Vrd,!1,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);return!1},this.$.ma,3)};Bf.prototype.GNi=function(G){var la=this,Ya=Lh.a.Ta.Lb,Fb=[];xh.TaskExtensions.PFa(this.indexedDB.yIa(kf.a.FNa),function(lc){var Lc=!la.Y5||!la.Nm.length;
lc=lc.result;Fb.push(Object.assign(new gf.a,{name:"ExistingScriptCount",int64:la.Nm.length}));if(""!==lc&&(lc=ji.b(lc),Fb.push(Object.assign(new gf.a,{name:"CachedScriptCount",int64:lc.length})),Lc)){lc=Ml(lc);for(var ad=lc.next();!ad.done;ad=lc.next())la.Nm.Wp(new xc(ad.value));la.Nm.sort();ya.a(rd.a.$zb,Lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);la.jAd(G);return!0}ya.a(rd.a.$zb,Lc,ie.getElapsedMilliseconds(Ya,Lh.a.Ta.Lb),Fb);return!1},this.$.ma,3)};Bf.prototype.kT=function(G,la,Ya,Fb){this.Ms&&
(Fb.push(Object.assign(new gf.a,{name:"ScriptCount",int64:this.pg.length})),Fb.push(Object.assign(new gf.a,{name:"ScriptErrorCount",int64:Ya})),ya.a(rd.a.ajf,!Ya,ie.getElapsedMilliseconds(la,Lh.a.Ta.Lb),Fb),this.pg.sort(),G.RC(kf.a.wLb))};Bf.prototype.jAd=function(G){this.W3=!0;G.RC("CachedScripts")};Object(sd.a)(Bf,"AutomateCommandStorage",ld,[]);var Jk=oj.a;Cm(ne,Jk);ne.prototype.create=function(){var G=this,la=Xi.GetServiceTaskFactory.Xa(this.$.ea,349,350,this.vb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper"),
Ya=$f.a.loadScript(111,4,this.vb,void 0,void 0,351),Fb=Xi.GetServiceTaskFactory.create(this.$.ea,102,this.$.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),lc=Xi.GetServiceTaskFactory.create(this.$.ea,396,this.$.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IndexedDB.IIndexedDB");xh.TaskExtensions.Da(xh.TaskExtensions.Fe([la,Ya,Fb,lc],this.ma,3),function(){var Lc=la.result,ad=lc.result,Kd=new Yb,ue=new ff(G.$,Lc,Kd),af=new Bf(G.$,ad),Xe=new cc(G.$,af),pg=
new Le(G.$,ue,Kd);G.Jb(G.$.ea.Ea(352,void 0)||new $b(G.$,Lc,Fb.result,ad,pg,Kd,ue,af,Xe))},this.ma,3)};ne.la=function(G){G&&G.ea.La(351,new ne(G))};Object(sd.a)(ne,"AutomateCommandManagerFactory",oj.a,[]);var Xj=b(831),ok=b(804),gk=Xj.a;Cm(Ce,gk);Ce.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};Ce.ve=function(){return["AugLoop_Core_Annotation"]};Object(sd.a)(Ce,"DetectedHtmlTableAnnotation",Xj.a,[]);var Ej=b(36),yj=b(46),Pj=b(365),hj=b(92),Ai=Ej.a;Cm(zf,Ai);zf.prototype.dispose=
function(){window.removeEventListener("message",Object(Ve.a)(this,this.jxe,"dataFromPictureMessageReceivedEventHandler"),!1);Ai.prototype.dispose.call(this)};zf.prototype.QJf=function(G,la){this.Aub=gj.a.create().toString();this.xub="";this.imageHeight=this.imageWidth=0;this.errorMessage=this.tableData="";this.ANc=!1;this.uCi(G,la);this.uzj()};zf.prototype.jxe=function(G){if(G){var la={};if(function(){var Kd=ji.d(G.data);la=Kd.xu;return Kd}().returnValue){var Ya=Object(Ci.a)(Object,la);if("."===Ya.DataFromPictureWildcard)if(Ya.SessionId!==
this.Aub)pe.ULS.sendTraceTag(538808588,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(Ya.CmdType){case "ACK":this.ANc=!0;this.m4i();0<this.errorMessage.length?this.jMf():0<this.tableData.length&&this.BMf();break;case "insert_html":pe.ULS.sendTraceTag(544265870,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane");var Fb=
this.$.ra.xa,lc={},Lc=ti.g(this.$).ga.ya.Xd.clone();lc.PasteId=gj.a.create().toString();lc.DestinationRanges=yj.s(yj.v(Lc,this.$));lc.SourceHtml=Ya.Parameters;lc.CopyOperationId=null;var ad=Fb.Ra(1,Fb.dc());ad.pasteHtmlParameters=lc;Pj.a(this.$.userOperationManager,function(Kd,ue,af){return Vi.i(Fb,"pasteHtmlContent",ad,Kd,ue,af,null,64)},function(Kd){return new Oj.a(204,0,Kd,1)},null)}}}};zf.prototype.uzj=function(){if(this.xub.length){var G=window.self.atob(this.xub);for(var la=Array(G.length),
Ya=0;Ya<G.length;Ya++)la[Ya]=G.charCodeAt(Ya);this.augmentationLoopManager.tzj(la,this.Aub,this.imageWidth,this.imageHeight)}else pe.ULS.sendTraceTag(538808587,0,50,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};zf.prototype.uCi=function(G,la){la.SessionID=this.Aub;la.DataFromPictureURL="ImageToDoc.Dogfood.Url";la.DataFromPictureAssetId="FA000000050";la.LoadDataFromPictureTaskpane=!0;G=new hj.a(-859308420,G.method,G.mode,G.qf,G.tabName);this.$.Na.Xb(G,
la)};zf.prototype.m4i=function(){if(this.xub.length){var G=Wi.a(this.$).r3("FA000000050.ImageToDoc.Dogfood.Url"),la={};la=(la.DataFromPictureWildcard=".",la);la.imageData=this.xub;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",la,function(Ya){Ya&&pe.ULS.sendTraceTag(544265868,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else pe.ULS.sendTraceTag(544265869,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};
zf.prototype.BMf=function(){if(this.tableData.length){var G=Wi.a(this.$).r3("FA000000050.ImageToDoc.Dogfood.Url"),la={};la=(la.DataFromPictureWildcard=".",la);la.tableHtml=this.tableData;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",la,function(Ya){Ya&&pe.ULS.sendTraceTag(544265866,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else pe.ULS.sendTraceTag(544265867,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};
zf.prototype.jMf=function(){if(this.errorMessage.length){var G=Wi.a(this.$).r3("FA000000050.ImageToDoc.Dogfood.Url"),la={};la=(la.DataFromPictureWildcard=".",la);la.errorMessage=this.errorMessage;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(G,"onCustomMessage",la,function(Ya){Ya&&pe.ULS.sendTraceTag(544265864,0,50,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else pe.ULS.sendTraceTag(544265865,0,50,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
zf.prototype.initialize=function(){window.addEventListener("message",Object(Ve.a)(this,this.jxe,"dataFromPictureMessageReceivedEventHandler"),!1);this.augmentationLoopManager.activateAnnotation(this.v0e);this.augmentationLoopManager.E8(this.v0e,Object(Ve.a)(this,this.RSh,"imageToTableAnnotationHandler"))};zf.prototype.RSh=function(G,la){if(G=la.PX)if(!la.parentPath||1>=la.parentPath.length||la.parentPath[1]!==this.Aub)pe.ULS.sendTraceTag(538808585,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");
else{la=G.errorCode;switch(la){case null:case -1:this.errorMessage=Rf.a.instance.da(2158);break;case 1:this.errorMessage=Rf.a.instance.da(2159);break;case 2:this.errorMessage=Rf.a.instance.da(2160)}0<this.errorMessage.length&&pe.ULS.sendTraceTag(538808584,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",la?la.toString():"null");this.tableData=G.html;this.ANc&&(0<this.errorMessage.length?this.jMf():0<this.tableData.length&&this.BMf())}else pe.ULS.sendTraceTag(538808586,
0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};Object(sd.a)(zf,"DataFromPicturePaneCommandManager",Ej.a,[]);var vk=b(172),Aj=b(52);mg.prototype.$c=function(){return!1};mg.prototype.executeCommand=function(G,la,Ya){G=!1;switch(la.command){case 73979048:this.Qob?this.Qob.QJf(la,Ya):(this.je=la,this.oT=Ya,this.F_c=!0),G=!0}return G?Aj.Task.Ua(!0):vk.a(la.command)};mg.prototype.Jc=function(G,la){return 73979048===la.command&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)};mg.prototype.gd=function(){return!1};mg.prototype.dispose=function(){this.Qob.dispose()};Object(sd.a)(mg,"DataFromPictureCommandHandler",null,[159,7]);var wk=Hi.a;Cm(Yf,wk);Yf.prototype.Rd=function(){this.Hd([new mg(this.$)])};Yf.la=function(G){Hi.a.ie(452,new Yf(G))};Object(sd.a)(Yf,"DataFromPictureCommandHandlerFactory",Hi.a,[]);var Vg=b(829),Qj=b(802);Rd.prototype.TDh=function(G){pe.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",G);for(var la=new wg.a,Ya=Ml(this.lYb),Fb=Ya.next();!Fb.done;Fb=
Ya.next()){Fb=Ml(Fb.value.Xzb);for(var lc=Fb.next();!lc.done;lc=Fb.next())lc=lc.value,lc.id===G&&la.add(lc)}return la};Rd.prototype.dde=function(G){this.lYb.add(G)};Rd.prototype.LRi=function(G){for(var la=Ml(this.lYb),Ya=la.next();!Ya.done;Ya=la.next())if(Ya=Ya.value,Ya.Mge===G.Mge){this.lYb.remove(Ya);break}};Rd.U2g=function(G,la,Ya){Ya=void 0===Ya?null:Ya;G=Rd.Bwh(G);0<G.length&&(Rd.uqc(G,!1),Ya&&Ya(la,G))};Rd.Bwh=function(G){var la=[];if(G&&G.Xzb&&0<G.Xzb.count){G=Ml(G.Xzb);for(var Ya=G.next();!Ya.done;Ya=
G.next())if(Ya=Ya.value,Ya.controls&&0<Ya.controls.count){Ya=Ml(Ya.controls);for(var Fb=Ya.next();!Fb.done;Fb=Ya.next())if(Fb=Fb.value,Fb.menuItems&&0<Fb.menuItems.count){Fb=Ml(Fb.menuItems);for(var lc=Fb.next();!lc.done;lc=Fb.next())Array.add(la,lc.value.id)}}}return la};Rd.uqc=function(G,la){if(G.length){G=Ml(G);for(var Ya=G.next();!Ya.done;Ya=G.next())Ya=document.querySelector('[id^="'+Ya.value+'"]'),Qj.a.Jca(Ya,la)}};Jl.Object.defineProperties(Rd.prototype,{lYb:{configurable:!0,enumerable:!0,
get:function(){return this.C$f}}});Object(sd.a)(Rd,"ContextMenuExtensibilityCache",null,[827,828]);var Yj=b(1395),pk=b(997),Ak=b(868),Pg=b(811),Rj=b(877),Bk=Rj.a;Cm(Gd,Bk);Gd.prototype.clone=function(){var G=new Gd;G.ofd=this.ofd;G.Xed=this.Xed;G.ribbon=this.ribbon;return G};Object(sd.a)(Gd,"RibbonBuildContext",Rj.a,[]);var cj=b(801);me.prototype.Ofa=function(G,la,Ya){la=void 0===la?null:la;Ya=void 0===Ya?null:Ya;var Fb=Ak.Builder.U_b(G);if(cj.c(Fb))Ya&&Ya(!1);else if(G=new Gd,G.Xed=this.s8.homeTab.id,
G.ofd=this.s8.homeTab,G.ribbon=this.s8,Fb=new Pg.a(Fb),Fb=Pg.a.oU(Fb.node,Pg.a.HTd),cj.c(Fb))Ya&&Ya(!1);else{Fb=Pg.a.Gm(Fb);for(var lc=0;lc<Fb.length;lc++){var Lc=Fb[lc],ad=(new Pg.a(Lc)).attributes[Pg.a.id];if(this.s8.D$(ad))this.hSb.tEj(ad,Lc,G);else{var Kd=-1;la&&(Kd=this.wmh(ad,la));-1!==Kd?this.hSb.xqg(Lc,G,Kd):this.hSb.xqg(Lc,G)}}Ya&&Ya(!0)}};me.prototype.wmh=function(G,la){G=Array.indexOf(la,G);if(-1===G)return-1;--G;for(var Ya=-1;0<=G;){Ya=this.kBh(la[G]);if(-1!==Ya)break;G--}return Ya+1};
me.prototype.kBh=function(G){for(var la=0,Ya=!1,Fb=Ml(this.s8.children),lc=Fb.next();!lc.done;lc=Fb.next()){lc=lc.value;if(lc.id===G){Ya=!0;break}lc.visible&&la++}return Ya?la:-1};me.prototype.V8a=function(G){G=Ak.Builder.U_b(G);if(!cj.c(G)&&(G=new Pg.a(G),G=Pg.a.oU(G.node,Pg.a.HTd),!cj.c(G))){G=Pg.a.Gm(G);for(var la=0;la<G.length;la++){var Ya=G[la],Fb=(new Pg.a(Ya)).attributes[Pg.a.id];Ya=Pg.a.oU(Ya,Pg.a.mMb);Ya=Pg.a.Gm(Ya);for(var lc=0;lc<Ya.length;lc++){var Lc=Pg.a.xSe(Ya[lc],Pg.a.id);cj.c(Lc)||
this.hSb.KFj(Fb,Lc)}}}};Object(sd.a)(me,"RibbonExtensibilityBuilder",null,[]);be.prototype.Ofa=function(G,la){la=void 0===la?null:la;var Ya=G.tNe();this.T7d.Ofa(Ya,G.l7a,la)};be.prototype.V8a=function(G){G=G.tNe();this.T7d.V8a(G)};be.b3g=function(G,la,Ya){Ya=void 0===Ya?null:Ya;G=be.HGh(G);0<G.length&&(be.uqc(G,!1),Ya&&Ya(la,G))};be.HGh=function(G){var la=[];if(G){var Ya=G.yba;if(!Ya){if(G.tabs&&0<G.tabs.count)for(G=Ml(G.tabs),Ya=G.next();!Ya.done;Ya=G.next())if(Ya=Ya.value,0<Ya.xJ.count){var Fb=
Ml(Ya.xJ);for(Ya=Fb.next();!Ya.done;Ya=Fb.next())if(Ya=Ya.value,0<Ya.Zga.count){var lc=Ml(Ya.Zga);for(Ya=lc.next();!Ya.done;Ya=lc.next())Array.add(la,Ya.value.id)}}}else if(Ya.Rw&&0<Ya.Rw.count)for(G=Ml(Ya.Rw),Ya=G.next();!Ya.done;Ya=G.next())if(Ya=Ya.value,Ya.groups&&0<Ya.groups.length)for(Fb=Ml(Ya.groups),Ya=Fb.next();!Ya.done;Ya=Fb.next())if(Ya=Ya.value,Ya.controls&&0<Ya.controls.length)for(lc=Ml(Ya.controls),Ya=lc.next();!Ya.done;Ya=lc.next())Array.add(la,Ya.value.id)}return la};be.uqc=function(G,
la){if(G.length){G=Ml(G);for(var Ya=G.next();!Ya.done;Ya=G.next())Ya=document.querySelector('[id^="'+Ya.value+'"]'),Qj.a.Jca(Ya,la)}};Object(sd.a)(be,"RibbonExtensibilityManager",null,[848]);var Ij=b(1054);Yd.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(G,la){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(G,la)};Yd.prototype.Nbd=function(G,la,Ya,Fb,lc,Lc,ad){Lc=void 0===Lc?null:Lc;ad=void 0===ad?null:ad;pe.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",
G);if((G=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?la.KP(lc.ownerAddinInfo.storeType,lc.ownerAddinInfo.solutionId):la.KP(lc.ownerAddinInfo.storeType,lc.ownerAddinInfo.assetId))&&G.Yy&&!G.Yy.getIsUpgrading())if(la=null,0<G.Yy.getNotificationParams().length&&(la=this.dme(G.Yy.getNotificationParams()[0])),2!==G.Yy.getStatus()&&(1!==G.Yy.getStatus()||la&&2147758681===la.errorCode))la&&this.JSf(G,la,ad);else try{Ya.setOwnerAddinEToken(G.Yy.getEToken()),
lc.action(Ya,Fb.Ska),Lc&&Lc()}catch(Kd){pe.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",Kd.message)),Ij.a.WJd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Yd.prototype.JSf=function(G,la,Ya){var Fb=this;Ya=void 0===Ya?null:Ya;var lc=G.Yy;if(1===lc.getNotificationParams().length||la.z$b){var Lc=la.vga,ad=la.nha;la.vga=function(){lc.removeFirstNotification();if(0<lc.getNotificationParams().length){var Kd=Fb.dme(lc.getNotificationParams()[0]);
Fb.JSf(G,Kd)}2147758681===la.errorCode&&(be.b3g(G.$q,lc,Object(Ve.a)(Fb,Fb.i1e,"initUpgradeStateDetectTask")),Rd.U2g(G.Tnb,lc,Object(Ve.a)(Fb,Fb.i1e,"initUpgradeStateDetectTask")));Lc&&Lc()};la.nha=function(){ad&&ad();Ya&&Ya()};Ij.a.YJd(la)}};Yd.prototype.i1e=function(G,la){var Ya=null;Ya=function(){G.getIsUpgrading()?window.setTimeout(Ya,1E3):G.getUpgradingFailed()?be.uqc(la,!0):Jf.AFrameworkApplication.za.updateCommandUI()};window.setTimeout(Ya,1E3)};Yd.prototype.dme=function(G){var la=new pk.a;
la.RJa=G.infoType;la.id=G.id;la.title=G.title;la.description=G.description;la.buttonText=G.buttonTxt;la.vga=G.buttonCallback;la.z$b=G.highPriority;la.nha=G.dismissCallback;la.errorCode=G.errorCode;la.k0e=G.iframeNotificationUrl;return la};Jl.Object.defineProperties(Yd.prototype,{Lbe:{configurable:!0,enumerable:!0,get:function(){return this.wyc||(this.wyc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(G){this.wyc=G}},xAg:{configurable:!0,enumerable:!0,get:function(){return this.SUd||
(this.SUd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(sd.a)(Yd,"AddinCommandsActionHandler",null,[822]);pd.prototype.wrh=function(G){if(void 0!==G&&null!==G&&G===si.a.WPg)G="ContextMenuCell";else return null;var la=this.Va.Vc();this.Pqh(la,G);return la};pd.prototype.Pqh=function(G,la){la=this.TPg.TDh(la);la=Ml(la);for(var Ya=la.next();!Ya.done;Ya=la.next()){Ya=Ml(Ya.value.controls);for(var Fb=Ya.next();!Fb.done;Fb=Ya.next())this.Cqh(G,Fb.value)}};pd.prototype.Cqh=
function(G,la){var Ya=la.$z[Pg.a.id],Fb=la.$z[Pg.a.nSa],lc=la.$z[Pg.a.pSa],Lc="Image16by16",ad=la.$z[Pg.a.jdb];cj.c(lc)&&(Lc="None");0<la.menuItems.count?(Ya=this.Va.bA(Ya,Ya,Fb,798637440),Ya.LGb(Lc,lc,null),this.urh(Ya.menu,la),Array.add(G.buttons,Ya)):Array.add(G.buttons,this.Va.TFa(Ya,Fb,ad,lc,Lc,null,!1))};pd.prototype.urh=function(G,la){var Ya,Fb=this.Va.Vc();la=Ml(la.menuItems);for(Ya=la.next();!Ya.done;Ya=la.next()){var lc=Ya.value;Ya=lc.zQ[Pg.a.id];var Lc=lc.zQ[Pg.a.nSa],ad=lc.zQ[Pg.a.pSa],
Kd="Image16by16";lc=lc.zQ[Pg.a.jdb];cj.c(ad)&&(Kd="None");Ya=this.Va.TFa(Ya,Lc,lc,ad,Kd,null,!1);Array.add(Fb.buttons,Ya)}Array.add(G.Fc,Fb)};Object(sd.a)(pd,"AddInCommandsContextMenuExtensibilityHandler",null,[806]);var Ck=b(984);Object(sd.a)(Wc,"AddinStatusCommandValues",null,[]);id.tKi=function(G){var la=new Wc;la.$i=G.tWa;la.visible=la.$i?!0:!1;return la};id.rsc=function(G,la,Ya,Fb,lc){var Lc=document.getElementById(Ya);Lc?id.ygj(G,la,Lc,Fb,lc):pe.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",
Ya))};id.ygj=function(G,la,Ya,Fb,lc){Ya?G.tWa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Ij.a.gfj(la,Ya,Fb,lc):G.tWa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Ij.a.Dgj(la,Ya):pe.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(sd.a)(id,"AddinCommandsStatusHandler",null,[]);var Dk=b(214),qk=Ej.a;Cm(uc,qk);uc.prototype.np=function(G){this.addHandler("LAC",G)};uc.prototype.Kp=function(G){this.removeHandler("LAC",G)};uc.prototype.Mq=
function(G,la){var Ya=this;if("QueryAddinLabel"!==G)return!1;la[Ck.a.LabelText]!==this.ez.tWa&&(G=id.tKi(this.ez),la[Ck.a.LabelText]=G.$i,la[Ck.a.Visible]=G.visible,window.setTimeout(function(){Ya.rsc()},0));return!0};uc.prototype.Km=function(){return!0};uc.prototype.rsc=function(){this.$&&id.rsc(this.ez,this.$.domElement,this.xlj,Rf.a.instance.da(319),Rf.a.instance.da(320))};uc.prototype.dispose=function(){this.$.fa.xk(Object(Ve.a)(this,this.ed,"onSessionIdChanged"));this.ez.OSi(Object(Ve.a)(this,
this.cXe,"handleAddinCommandsLoadingMessageChanged"));this.agaveCommandManager&&(this.agaveCommandManager.cUi(Object(Ve.a)(this,this.kqe,"clearLoadingAddinMessage")),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.UC(this),this.statusBarManager=null);this.ez=this.$=null;qk.prototype.dispose.call(this)};uc.prototype.kqe=function(){this.ez&&this.ez.Tpe()};uc.prototype.cXe=function(){this.raiseEvent("LAC")};uc.prototype.ed=function(G,la){!G.pc&&Dk.b(la)&&this.statusBarManager&&
(this.statusBarManager.UC(this),this.statusBarManager=null)};Object(sd.a)(uc,"AddinCommandsStatusBarManager",Ej.a,[155,156]);var hk=b(1269),Ek=b(144);gc.prototype.setErrorMessageForAddin=function(G,la){this.sWa||(this.sWa={});this.sWa[G]=la};gc.prototype.Qyh=function(G){return this.sWa&&G in this.sWa?this.sWa[G]:null};Object(sd.a)(gc,"AddinCommandsErrorManager",null,[]);var ni=b(424),ik=b(94);Object(sd.a)(wb,"AddinCommandsListLoaderContext",null,[]);var U=b(934),Ba=Sys.EventArgs;Cm(Ma,Ba);Object(sd.a)(Ma,
"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);yb.prototype.D4c=function(G){var la=new Sys.StringBuilder(this.tFb);la.append("RoamingServiceHandler.ashx?action=");la.append("getAddinTeachingCalloutSettings");la.append("&");la.append(this.V$c(G));la.append("&");la.append(Jf.AFrameworkApplication.hj);Jf.AFrameworkApplication.Md.Wl(la.toString(),1,null,null,!0,2,Object(Ve.a)(this,this.SIa,"getRequestSuccessCallback"),Object(Ve.a)(this,this.xia,"getRequestFailureCallback"),null)};yb.prototype.E4c=
function(G){var la=new Sys.StringBuilder(this.tFb);la.append("RoamingServiceHandler.ashx?action=");la.append("saveAddinTeachingCalloutSettings");la.append("&");la.append(Jf.AFrameworkApplication.hj);la=la.toString();G=ji.c(G);Jf.AFrameworkApplication.Md.Wl(la,2,G,null,!0,4,null,Object(Ve.a)(this,this.wNa,"postRequestFailureCallback"),null)};yb.prototype.SIa=function(G){var la=!1,Ya=null;try{if(0<G.data.pe.length){for(var Fb=Object(Ci.a)(Object,ji.a(G.data.pe)),lc=Fb?Fb[this.appName]:null,Lc=Ml(Fb),
ad=Lc.next();!ad.done;ad=Lc.next()){var Kd=ad.value;pe.ULS.sendTraceTag(538765393,306,50,"All user setting Key:{0}, Value:{1}",Kd.key.toString(),Kd.value.toString())}lc&&(Ya=Object(Ci.a)(Object,ji.a(lc.toString())));var ue=Ml(Ya);for(ad=ue.next();!ad.done;ad=ue.next()){var af=ad.value;pe.ULS.sendTraceTag(538765394,306,50,"User setting Key:{0}, Value:{1}",af.key.toString(),af.value.toString())}}la=!0}catch(Xe){this.xia(null)}la&&this.Dfb&&this.Dfb(Ya)};yb.prototype.xia=function(G){this.zfb&&this.zfb(G?
G.data:null)};yb.prototype.wNa=function(G){this.Nhb&&this.Nhb(G?G.data:null)};yb.prototype.V$c=function(G){for(var la=new Sys.StringBuilder("requestedsettings="),Ya=0;Ya<G.count;Ya++)la.append(G.oa(Ya)),Ya<G.count-1&&la.append(";");return la.toString()};Object(sd.a)(yb,"AddinTeachingUIRoamingRequestHandler",null,[]);var jb=b(923);kb.prototype.crg=function(G){this.Qa.addHandler(Vg.a.QVb,G)};kb.prototype.jtj=function(G){var la=this;null!==G&&(this.context.Sba=G[Vg.a.O8],this.context.Kr=G[Vg.a.EO],this.context.AOd=
this.context.slc=0,G=Vg.a.uWa in G?G[Vg.a.uWa]:0,-1!==this.context.Sba&&this.context.Kr&&(this.context.rqa=new jb.a,this.context.WPc=this.hvg.createAddinDataProvider(Zd(this.context.Sba),this.contextActivationMgr),this.context.WPc?this.context.WPc.getEntitlementsAsync(this.contextActivationMgr.Ska,!0,G,function(Ya){la.svi(Ya)}):pe.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.Sba)))};kb.prototype.svi=function(G){var la=this;if(G&&0<G.length){this.context.AOd=
G.length;for(var Ya=0;Ya<G.length;Ya++){var Fb=G[Ya];if(!Fb||1!==Fb.targetType&&-1!==Fb.targetType)this.hsd();else{var lc={};Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(lc.marketplaceId=Fb.solutionId,lc.marketplaceVersion=Fb.version):(lc.marketplaceId=Fb.assetId,lc.marketplaceVersion=Fb.appVersion);lc.storeType=Fb.storeType;lc.storeId=Fb.storeId;lc.targetData=Fb;this.contextActivationMgr.isAddinCommandsAsync(lc,function(Lc,
ad,Kd){Lc?ad&&la.context.rqa.add(Kd.targetData):pe.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Kd.targetData.storeType,Kd.targetData.storeId,Kd.targetData.assetId),Kd.targetData.storeType);la.hsd()})}}}else this.hsd()};kb.prototype.hsd=function(){var G;(G=this.context).slc=G.slc+1;this.context.slc>=this.context.AOd&&(this.dvg.XMf(this.context.Sba,!1),Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&"Excel"===this.appName?this.cth(this.context.rqa):this.xOc(this.context.rqa))};kb.prototype.xOc=function(G){var la=new wg.a;if(G){G=Ml(this.context.rqa);for(var Ya=G.next();!Ya.done;Ya=G.next())la.add(Zb(Ya.value))}this.context.rqa&&1>this.context.rqa.count&&U.a.aKb(Vg.a.RVb,"false",this.context.Sba);G={};la=(G.ack2=la,G);la[Vg.a.O8]=this.context.Sba;la[Vg.a.EO]=this.context.Kr;this.Qa.raiseEvent(Vg.a.QVb,new Ma(la),this)};kb.prototype.N0i=function(G){if(this.appName){var la={},Ya={};Ya.LastTeachingUIShowTime=
(new Date).toUTCString();Ya.AddinHasShown=G;la[this.appName]=ji.c(Ya);this.EMb&&(this.EMb.E4c(la),pe.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else pe.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};kb.prototype.cth=function(G){if(this.DRa=G)G=new wg.a,G.add(this.appName),this.EMb=new yb(this.appName,Object(Ve.a)(this,this.SIa,"getRequestSuccessCallback"),Object(Ve.a)(this,
this.xia,"getRequestFailureCallback"),Object(Ve.a)(this,this.wNa,"postRequestFailureCallback")),this.EMb.D4c(G);else{G=new wg.a;var la={};G=(la.ack2=G,la);G[Vg.a.O8]=this.context.Sba;G[Vg.a.EO]=this.context.Kr;this.Qa.raiseEvent(Vg.a.QVb,new Ma(G),this)}};kb.prototype.SIa=function(G){G?this.iej(G)?(this.N9a="AddinHasShown"in G?G.AddinHasShown.toString():null,G=this.Qye(),this.Bde(G),pe.ULS.sendTraceTag(538248465,306,50,"Should Show TeachingUI, addinID:{0}",G)):(pe.ULS.sendTraceTag(538248466,306,50,
"Not Show TeachingUI this time"),this.xOc(this.DRa)):(this.N9a=null,G=this.Qye(),this.Bde(G),pe.ULS.sendTraceTag(538248464,306,50,"No teaching callout data found for current user. Show teaching callout for: {0}",G))};kb.prototype.xia=function(G){pe.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.xOc(this.DRa)};kb.prototype.wNa=function(G){pe.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
G?G.httpStatus:-1)};kb.prototype.iej=function(G){return"LastTeachingUIShowTime"in G&&(G=+new Date-+new Date(G.LastTeachingUIShowTime.toString()),G<Jf.AFrameworkApplication.ha.pU("AddinShowTeachingUIIntervalInMS",864E5))?(pe.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",G),!1):!0};kb.prototype.Qye=function(){for(var G=new ni.a("",0),la=new ni.a("",0),Ya=0,Fb=0,lc=0,Lc=Ml(this.DRa),ad=Lc.next();!ad.done;ad=Lc.next())if(ad=ad.value,!("excatalog"!==
ad.storeType||cj.c(ad.installTimeInMS)||!ad.installTimeInMS||ad.installTimeInMS<=Jf.AFrameworkApplication.ha.pU("DateTimeInMSForNewAddin",63776592E6))){var Kd=this.ENe(ad);if(this.N9a){var ue=this.N9a.split(",");if(0<ue.length&&Array.contains(ue,Kd)){lc++;pe.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Kd.startsWith("private_")?(G.value<ad.installTimeInMS&&(G=new ni.a(Kd,ad.installTimeInMS)),Fb++):(la.value<ad.installTimeInMS&&(la=new ni.a(Kd,ad.installTimeInMS)),
Ya++)}pe.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Fb,Ya,lc);return 0<la.value?la.key:0<G.value?G.key:null};kb.prototype.Bde=function(G){for(var la=new wg.a,Ya=Ml(this.DRa),Fb=Ya.next();!Fb.done;Fb=Ya.next()){var lc=Fb.value;Fb=Zb(lc);G&&(lc=this.ENe(lc),G===lc&&(Fb.showCallout=!0,this.N0i(this.N9a?this.N9a+","+G:G)));la.add(Fb)}this.DRa&&1>this.context.rqa.count&&U.a.aKb(Vg.a.RVb,"false",this.context.Sba);G={};
la=(G.ack2=la,G);la[Vg.a.O8]=this.context.Sba;la[Vg.a.EO]=this.context.Kr;this.Qa.raiseEvent(Vg.a.QVb,new Ma(la),this)};kb.prototype.ENe=function(G){return Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.storeId,G.assetId)?"private_"+G.installTimeInMS:G.assetId};Object(sd.a)(kb,"AddInCommandsListLoader",null,[]);Pb.prototype.insertOsfControl=function(G){return this.Ska.insertOsfControl(G)};Pb.prototype.getManifestInvaildErrorString=function(){return this.Ska.getManifestInvaildErrorString()};Pb.prototype.isAddinCommandsAsync=
function(G,la){this.Ska.isAddinCommandsAsync(G,la)};Pb.prototype.ownerAddinControlRecreated=function(G,la){this.Ska.ownerAddinControlRecreated(G,la)};Jl.Object.defineProperties(Pb.prototype,{Ska:{configurable:!0,enumerable:!0,get:function(){return this.Ugg}}});Object(sd.a)(Pb,"ContextActivationMgrWrapper",null,[813]);Ue.prototype.createAddinDataProvider=function(G,la){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(G,la.Ska)};Jl.Object.defineProperties(Ue,{instance:{configurable:!0,
enumerable:!0,get:function(){Ue.Pa||(Ue.Pa=new Ue);return Ue.Pa}}});Ue.Pa=null;Object(sd.a)(Ue,"OSFAddinDataProviderFactory",null,[815]);var Wb=b(1069),Ec=b(935);Ke.prototype.XMf=function(G,la){G=Vg.a.uQe()+G;Ec.a.instance.setItem(G,la.toString())};Jl.Object.defineProperties(Ke,{instance:{configurable:!0,enumerable:!0,get:function(){Ke.Pa||(Ke.Pa=new Ke);return Ke.Pa}}});Ke.Pa=null;Object(sd.a)(Ke,"AddInCommandsCacheManager",null,[826]);var Xc=Sys.EventArgs;Cm(he,Xc);Object(sd.a)(he,"InsertionParamEventArgs",
Sys.EventArgs,[]);Object(sd.a)(Zc,"PostLaunchAddinCommandsParameters",null,[]);var Ac=b(119);Ed.prototype.wog=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Ve.a)(this,this.gvi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Ve.a)(this,this.Nqi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Ve.a)(this,this.wpi,"onCloseButtonClickedEventHandler"),!0)):pe.ULS.sendTraceTag(539353218,
306,15,"AddEventListenerForTeachingCallout failed to get Window")};Ed.prototype.gvi=function(){var G=this,la={};la=(la["Data.AppTeachingUICalloutAction"]="ClickOnLaunch",la["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.W7.storeType,this.W7.storeId,this.W7.solutionId),la);mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(la)}));this.lUd?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.lUd,function(){var Ya=new he;
Ya.Im=G.W7;G.rb.raiseEvent(Vg.a.qaf,Ya)}):pe.ULS.sendTraceTag(539353219,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Ed.prototype.wpi=function(){var G={};G=(G["Data.AppTeachingUICalloutAction"]="ClickOnClose",G["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.W7.storeType,this.W7.storeId,this.W7.solutionId),G);mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(G)}))};Ed.prototype.Nqi=function(){var G=
{};G=(G["Data.AppTeachingUICalloutAction"]="ClickOnDismiss",G["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.W7.storeType,this.W7.storeId,this.W7.solutionId),G);mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(G)}))};Object(sd.a)(Ed,"PrivateCatalogTeachingCalloutHandler",null,[]);ge.prototype.Ofa=function(G,la){this.e0d.Ofa(G,void 0===la?null:la);this.d2d=G};ge.prototype.V8a=function(G){this.e0d.V8a(G)};Jl.Object.defineProperties(ge.prototype,
{W4a:{configurable:!0,enumerable:!0,get:function(){return this.d2d}}});Object(sd.a)(ge,"RibbonExtensibilityManagerWithChangeDetection",null,[848]);var yc=b(925);Nd.prototype.Ofa=function(G,la){la=void 0===la?null:la;if(G=yc.a.xrb(G)){appChrome.addInApi.dispatchActionsToInstallAddIn(G,la);la=Ml(G.tabs);for(var Ya=la.next();!Ya.done;Ya=la.next())if(Ya.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,function(){});break}}};Nd.prototype.V8a=function(G){(G=yc.a.xrb(G))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(G)};
Object(sd.a)(Nd,"OneLineRibbonExtensibilityManager",null,[848]);var dd=b(996);Hd.eRe=function(G){var la=new wg.a;if(Hd.ose)for(var Ya=Ml(Hd.ose),Fb=Ya.next();!Fb.done;Fb=Ya.next())la.add(Fb.value);Fb=null;switch(G){case "Workbook":Fb=Hd.KCj;break;case "Document":Fb=Hd.R4g;break;case "Presentation":Fb=Hd.mIi}if(Fb)for(G=Ml(Fb),Fb=G.next();!Fb.done;Fb=G.next())la.add(Fb.value);return la};Hd.ose=["PrimaryCommandSurface","ContextMenu"];Hd.KCj=null;Hd.R4g=null;Hd.mIi=null;Object(sd.a)(Hd,"ExtensionPointType",
null,[]);Jl.Object.defineProperties(Mc.prototype,{Xzb:{configurable:!0,enumerable:!0,get:function(){return this.e5d||(this.e5d=new wg.a)}},Mge:{configurable:!0,enumerable:!0,get:function(){return this.h9f}}});Object(sd.a)(Mc,"ContextMenuExtensibility",null,[817]);ae.prototype.tNe=function(){for(var G=new Sys.StringBuilder,la=Ml(this.zX),Ya=la.next();!Ya.done;Ya=la.next())G.append(Ya.value.R6());return this.Wpg(G.toString())};ae.prototype.Wpg=function(G){var la=new Sys.StringBuilder;la.append("<Ribbon><Tabs>");
la.append(G);la.append("</Tabs></Ribbon>");return la.toString()};Jl.Object.defineProperties(ae.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.zX}},yba:{configurable:!0,enumerable:!0,get:function(){return this.Ngg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.hkg}},l7a:{configurable:!0,enumerable:!0,get:function(){return this.uhb}},tsh:{configurable:!0,enumerable:!0,get:function(){return this.Rcg}}});Object(sd.a)(ae,"RibbonExtensibility",null,[868]);
$c.prototype.createActionContext=function(G,la){G={};G.ownerAddinInfo=this.entitlement;G.action=la;return G};Jl.Object.defineProperties($c.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Lbg}}});Object(sd.a)($c,"AddInCommandsContextProvider",null,[]);Cb.prototype.cTg=function(G){return new $c(G)};Cb.prototype.createActionBuilder=function(G,la){return OfficeExt.DefaultControlActionBinder.createActionBuilder(G,la.entitlement,la.manifest)};Cb.prototype.startApplyAddin=
function(G){this.kUd=G;var la=this.cTg(G);this.actionBuilder=this.createActionBuilder(la,G)};Cb.prototype.endApplyAddin=function(){};Cb.prototype.y0a=function(G,la,Ya){Ya=void 0===Ya?0:Ya;return this.ribbonBuilder.Qtc&&0<this.ribbonBuilder.Qtc.count||this.ribbonBuilder.Rw&&0<this.ribbonBuilder.Rw.count?new ae(this.ribbonBuilder.Qtc,this.Irh(G,la),this.XPc.startedNode,this.ribbonBuilder.c5.hEh(),Ya):null};Cb.prototype.QMe=function(){var G=void 0===G?null:G;if(this.contextMenuBuilder.jgc&&0<this.contextMenuBuilder.jgc.count){G||
(G=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.XPc.entitlement.solutionId:this.XPc.entitlement.assetId);G=new Mc(G);for(var la=Ml(this.contextMenuBuilder.jgc),Ya=la.next();!Ya.done;Ya=la.next())G.Xzb.add(Ya.value);return G}return null};Cb.prototype.Irh=function(G,la){return this.ribbonBuilder.Rw&&0<this.ribbonBuilder.Rw.count?new yc.a(this.ribbonBuilder.Rw,G,la):null};Jl.Object.defineProperties(Cb.prototype,{XPc:{configurable:!0,
enumerable:!0,get:function(){return this.kUd}}});Object(sd.a)(Cb,"AddinCommandsBuilder",null,[]);Qc.prototype.vLa=function(G,la,Ya,Fb,lc,Lc,ad){function Kd(th,Pi,Oh,pi){lc(th,Pi,Oh,pi);th=dd.a[ue.Kr]+Pi.assetId;Oh=ue.qza.Ec(th);Pi=Oh.value;Oh.returnValue&&(Pi.stop(),ue.qza.remove(th))}var ue=this;if(this.Kr&&G)for(pe.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",G.count),4===this.Kr&&(pe.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Fb)),this.RKg(G,
Fb),Lc()),G=Ml(G),Fb=G.next();!Fb.done;Fb=G.next())if(Fb=Fb.value,Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Fb.solutionId=Fb.solutionId||Fb.assetId,Fb.storeType=Fb.storeType||Fb.currentStoreType,Fb.version=Fb.version||Fb.appVersion,pe.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(Fb.storeType,Fb.storeId,Fb.solutionId)))):pe.ULS.sendTraceTag(540379088,220,
50,String.format("{0}: Install addin {1}",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(Fb.currentStoreType,Fb.storeId,Fb.assetId))),this.U4f(Fb))if(ad&&Fb.requireConsent)ad(Fb,function(th){try{if(ue.VH){var Pi=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?dd.a[ue.Kr]+th.solutionId:dd.a[ue.Kr]+th.assetId;var Oh=ue.VH.Ic("ComponentAttach",Pi);ue.qza.ja(Pi,Oh)}var pi=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?ue.ez.KP(th.storeType,th.solutionId):ue.ez.KP(th.currentStoreType,th.id);6!==ue.Kr&&(pi&&(ue.cnb(pi),pi.Yy.purge(!1)),ue.Ah.insertOsfControl(ue.U7a(th,la,Ya,Kd)),pi&&(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?ue.Ah.ownerAddinControlRecreated(th.solutionId,th.storeType):ue.Ah.ownerAddinControlRecreated(th.assetId,th.currentStoreType)))}catch(Ri){Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?pe.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",ue.Xl.oA,Telemetry.PrivacyRules.GetAssetId(th.storeType,th.storeId,th.solutionId),th.version,th.storeType,th.storeId,Ri.message)):pe.ULS.sendTraceTag(540379089,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",ue.Xl.oA,Telemetry.PrivacyRules.GetAssetId(th.currentStoreType,
th.storeId,th.assetId),th.appVersion,th.currentStoreType,th.storeId,Ri.message)),Kd(!1,th,null,null)}});else if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1))try{if(this.VH){var af=dd.a[this.Kr]+Fb.solutionId,Xe=this.VH.Ic("ComponentAttach",af);this.qza.ja(af,Xe)}var pg=this.ez.KP(Fb.storeType,Fb.solutionId);6!==this.Kr&&(pg&&(this.cnb(pg),pg.Yy.purge(!1)),this.Ah.insertOsfControl(this.U7a(Fb,la,Ya,Kd)),pg&&this.Ah.ownerAddinControlRecreated(Fb.solutionId,
Fb.storeType))}catch(th){pe.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(Fb.storeType,Fb.storeId,Fb.solutionId),Fb.version,Fb.storeType,Fb.storeId,th.message)),Kd(!1,Fb,null,null)}else try{if(this.VH){var sg=dd.a[this.Kr]+Fb.assetId,lh=this.VH.Ic("ComponentAttach",sg);this.qza.ja(sg,lh)}var Jh=this.ez.KP(Fb.currentStoreType,Fb.id);6!==
this.Kr&&(Jh&&(this.cnb(Jh),Jh.Yy.purge(!1)),this.Ah.insertOsfControl(this.U7a(Fb,la,Ya,Kd)),Jh&&this.Ah.ownerAddinControlRecreated(Fb.assetId,Fb.currentStoreType))}catch(th){pe.ULS.sendTraceTag(540379090,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(Fb.currentStoreType,Fb.storeId,Fb.assetId),Fb.appVersion,Fb.currentStoreType,Fb.storeId,th.message)),Kd(!1,Fb,null,null)}else Kd(!1,
Fb,null,null)};Qc.prototype.b$h=function(G,la,Ya,Fb,lc,Lc){function ad(pg,sg,lh,Jh){Lc(pg,sg,lh,Jh);pg=dd.a[Kd.Kr]+sg.assetId;lh=Kd.qza.Ec(pg);sg=lh.value;lh.returnValue&&(sg.stop(),Kd.qza.remove(pg))}var Kd=this;if(6===this.Kr&&G)if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(G.solutionId=G.solutionId||G.assetId,G.storeType=G.storeType||G.currentStoreType,G.version=G.version||G.appVersion,pe.ULS.sendTraceTag(592290762,220,
50,String.format("{0}: Install dynamic ribbon {1}",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId)))):pe.ULS.sendTraceTag(540379091,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.currentStoreType,G.storeId,G.assetId))),this.U4f(G))try{if(this.VH){var ue=dd.a[this.Kr]+G.assetId,af=this.VH.Ic("ComponentAttach",ue);this.qza.ja(ue,af)}var Xe=this.ez.KP(G.currentStoreType,G.id);Xe||ad(!1,G,null,null);Jf.AFrameworkApplication.za&&
Jf.AFrameworkApplication.za.Za.delayInstallAddInIsEnabled?this.rNe(G,la,Fb,lc,Ya,function(pg){ad(pg,G,Ya,Xe.displayName)}):(this.rNe(G,la,Fb,lc,Ya),ad(!0,G,Ya,Xe.displayName))}catch(pg){pe.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.currentStoreType,G.storeId,G.assetId),G.appVersion,G.currentStoreType,G.storeId,pg.message)),
ad(!1,G,null,null)}else ad(!1,G,null,null)};Qc.prototype.Ini=function(G,la,Ya,Fb,lc,Lc){if(Lc)if(Lc._isAddinCommandsManifest(this.Xl.oA))try{Jf.AFrameworkApplication.za&&Jf.AFrameworkApplication.za.Za.delayInstallAddInIsEnabled?this.qNe(G,la,Ya,lc,Lc,function(ad){Fb(ad,G,Lc,Lc.getDefaultDisplayName())}):(this.qNe(G,la,Ya,lc,Lc),Fb(!0,G,Lc,Lc.getDefaultDisplayName()))}catch(ad){pe.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.currentStoreType,G.storeId,G.assetId),G.appVersion,G.currentStoreType,G.storeId,ad.message)),Fb(!1,G,Lc,Lc.getDefaultDisplayName())}else pe.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.currentStoreType,G.storeId,G.assetId),G.appVersion,G.currentStoreType,G.storeId)),Fb(!1,G,null,
null);else pe.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Xl.oA,Telemetry.PrivacyRules.GetAssetId(G.currentStoreType,G.storeId,G.assetId),G.appVersion,G.currentStoreType,G.storeId)),Fb(!1,G,null,null)};Qc.prototype.U7a=function(G,la,Ya,Fb){function lc(ue,af){var Xe;(Xe=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Lc.ez.KP(G.storeType||
G.currentStoreType,G.solutionId||G.id):Lc.ez.KP(G.currentStoreType,G.id))&&Lc.cnb(Xe);Lc.Ini(G,la,Ya,Fb,ue,af)}var Lc=this,ad={},Kd=document.createElement("div");Kd.setAttribute("visible","false");Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(ad.div=Kd,ad.id=G.solutionId||G.id,ad.solutionId=G.solutionId||G.id,ad.version=G.version||G.appVersion,ad.storeType=G.storeType||G.currentStoreType,ad.storeId=G.storeId,ad.assetId=G.assetId,
ad.assetStoreId=G.assetStoreId,ad.isvirtualOsfControl=!0,ad.virtualOsfControlActivationCallback=lc,ad.reason=3===this.Kr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,ad.marketplaceID=G.id,ad.marketplaceVersion=G.appVersion,ad.store=G.storeId):(ad.div=Kd,ad.id=G.id,ad.marketplaceID=G.id,ad.marketplaceVersion=G.appVersion,ad.store=G.storeId,ad.storeType=G.currentStoreType,ad.osfControlType=G.targetType,ad.isvirtualOsfControl=
!0,ad.virtualOsfControlActivationCallback=lc,ad.reason=3===this.Kr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened);return ad};Qc.prototype.qNe=function(G,la,Ya,Fb,lc,Lc){Lc=void 0===Lc?null:Lc;var ad={};Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(ad.solutionId=Fb.getSolutionId(),ad.version=Fb.getVersion(),ad.storeType=Fb.getStoreType(),ad.storeId=
Fb.getStoreId(),ad.assetId=Fb.getSolutionId(),ad.assetStoreId=Fb.getAssetStoreId(),ad.targetType=Fb.getOsfControlType(),ad.appVersion=Fb.getMarketplaceVersion()):(ad.storeType=Fb.getStoreType(),ad.storeId=Fb.getStoreLocator(),ad.assetId=Fb.getMarketplaceID(),ad.appVersion=Fb.getMarketplaceVersion(),ad.targetType=Fb.getOsfControlType());var Kd=null,ue=null;if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Kd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Xl.oA,
this.Xl.formFactor)).parseExtensions(ad,lc,this.Vfa),ue=Hd.eRe(this.Xl.oA);else try{Kd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Xl.oA,this.Xl.formFactor)).parseExtensions(ad,lc,this.Vfa),ue=Hd.eRe(this.Xl.oA)}catch(Ri){throw pe.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ri.message),Ri;}if(ue&&0<ue.count){if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var af=la(G);var Xe=Ya(G);Ya=!!Jf.AFrameworkApplication.ha&&Jf.AFrameworkApplication.ha.ta("AddinCommandsMultipleCustomTabsEnabled");af=new Cb(af,null,Xe);ue=Ml(ue);for(Xe=ue.next();!Xe.done;Xe=ue.next())af.commandSurface=Xe.value,Kd.apply(af,this.Vfa,Ya)}else try{var pg=la(G),sg=Ya(G),lh=!!Jf.AFrameworkApplication.ha&&Jf.AFrameworkApplication.ha.ta("AddinCommandsMultipleCustomTabsEnabled");af=new Cb(pg,null,sg);var Jh=Ml(ue);for(Xe=Jh.next();!Xe.done;Xe=Jh.next())af.commandSurface=Xe.value,
Kd.apply(af,this.Vfa,lh)}catch(Ri){throw pe.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ri.message),Ri;}if(OSF.OUtil.checkFlight(14))try{var th=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?af.y0a(G.solutionId||G.id,lc.getDefaultDisplayName()):af.y0a(G.id,lc.getDefaultDisplayName());var Pi=af.QMe();th&&this.ribbonManager.Ofa(th,Lc);Pi&&this.contextMenuManager.dde(Pi);this.ez.Gde(Fb,
th,Pi,lc.getDefaultDisplayName());pe.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",lc.getDefaultDisplayName())}catch(Ri){throw OfficeExt.DevConsole.log(Ri),pe.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ri.message),Ri;}else try{var Oh=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?af.y0a(G.solutionId||G.id,lc.getDefaultDisplayName()):af.y0a(G.id,lc.getDefaultDisplayName());var pi=
af.QMe();Oh&&this.ribbonManager.Ofa(Oh);pi&&this.contextMenuManager.dde(pi);this.ez.Gde(Fb,Oh,pi,lc.getDefaultDisplayName());pe.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",lc.getDefaultDisplayName())}catch(Ri){throw pe.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ri.message),Ri;}}};Qc.prototype.rNe=function(G,la,Ya,Fb,lc,Lc){Lc=void 0===Lc?null:Lc;var ad={};Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(ad.solutionId=G.solutionId||G.assetId,ad.version=G.version||G.appVersion,ad.storeType=G.storeType||G.currentStoreType,ad.storeId=G.assetStoreId,ad.assetId=G.assetId,ad.assetStoreId=G.assetStoreId,ad.targetType=G.targetType,ad.appVersion=G.appVersion):(ad.storeType=G.currentStoreType,ad.storeId=G.assetStoreId,ad.assetId=G.assetId,ad.appVersion=G.appVersion,ad.targetType=G.targetType);var Kd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Xl.oA,this.Xl.formFactor);try{var ue=la.getManifest(),
af=Kd.parse(ad,ue,lc,this.Vfa,la.getSharedRuntimeId()),Xe=Ya(G),pg=Fb(G),sg=new Cb(Xe,null,pg);sg.commandSurface="PrimaryCommandSurface";af.apply(sg,this.Vfa,!0);if(sg.ribbonBuilder.Rw&&0<sg.ribbonBuilder.Rw.count){var lh=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?sg.y0a(G.solutionId||G.id,la.getManifest().getDefaultDisplayName(),1):sg.y0a(G.id,la.getManifest().getDefaultDisplayName(),1);Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.Ofa(lh,Lc):lh&&this.ribbonManager.Ofa(lh,Lc);this.ez.mpg(la,lh,lc,la.getManifest().getDefaultDisplayName());pe.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",la.getManifest().getDefaultDisplayName())}}catch(Jh){pe.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",la.getManifest().getDefaultDisplayName(),Jh.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Jh)}};Qc.prototype.cnb=function(G){G.$q&&
this.ribbonManager.V8a(G.$q);G.Tnb&&this.contextMenuManager.LRi(G.Tnb);this.ez.tRi(G.Yy.getStoreType(),G.Yy.getMarketplaceID())};Qc.prototype.RKg=function(G,la){la=Zd(la);for(var Ya=Ml(this.ez.R2a),Fb=Ya.next();!Fb.done;Fb=Ya.next())if(Fb=Fb.value,Fb.Yy.getStoreType()===la){for(var lc=!0,Lc=Ml(G),ad=Lc.next();!ad.done;ad=Lc.next())if(ad=ad.value,Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(ad&&Fb.Gjd(ad.storeType||ad.currentStoreType,
ad.solutionId||ad.id)){lc=!1;break}}else if(ad&&Fb.Gjd(ad.currentStoreType,ad.id)){lc=!1;break}lc&&(this.cnb(Fb),Fb.Yy.purge(!1))}};Qc.prototype.U4f=function(G){return Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(G.solutionId!==G.assetId&&pe.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId"),G.id!==G.assetId&&pe.ULS.sendTraceTag(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId"),!!G&&
!!G.solutionId&&!!G.version&&!!G.storeType&&!!G.storeId):!!G&&!!G.currentStoreType&&!!G.storeId&&!!G.id&&!!G.appVersion};Object(sd.a)(Qc,"AddInCommandsIntegration",null,[]);var Qd=b(844);Ic.prototype.drg=function(G){this.rb.addHandler(Vg.a.ige,G)};Ic.prototype.Wsg=function(G){this.rb.addHandler(Vg.a.qaf,G)};Ic.prototype.vug=function(G){this.rb.addHandler(Vg.a.QSf,G)};Ic.prototype.vLa=function(G,la,Ya){var Fb=this,lc=Ya[Vg.a.rWa],Lc=void 0===Ya[Vg.a.EO]?0:Ya[Vg.a.EO];if(lc&&Lc)if(0>=lc.count&&4!==
Lc)this.Okc(new Zc(Lc,null,null,G,la,null,!0));else{var ad=lc.count,Kd=new ge(new be(G));Ya=void 0===Ya[Vg.a.O8]?-1:Ya[Vg.a.O8];(new Qc(Lc,this.wm,this.vSa,Kd,this.UWd,this.afa,this.Jna)).vLa(lc,function(ue){return Fb.GTb.yEg(ue.assetId,Fb.Jna,Fb.vSa)},function(ue){return Fb.GTb.Ule(ue.assetId)},Ya,function(ue,af,Xe,pg){ad--;Xe=new Zc(Lc,af,Kd,G,la,pg,0>=ad);ue&&af?Fb.Okc(Xe):Fb.Nkc(Xe)},function(){Fb.ghc();0>=lc.count&&4===Lc&&Fb.afa.vqc()},this.j5d)}else pe.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",
this.vSa.oA)),this.Nkc(new Zc(Lc,null,null,G,la,null,!0))};Ic.prototype.s$h=function(G,la,Ya){var Fb=this,lc=Ya[Vg.a.rWa],Lc=void 0===Ya[Vg.a.EO]?0:Ya[Vg.a.EO];if(lc&&Lc)if(0>=lc.count&&4!==Lc)this.Okc(new Zc(Lc,null,null,null,la,null,!0));else{var ad=lc.count,Kd=new ge(new Nd),ue=void 0===Ya[Vg.a.O8]?-1:Ya[Vg.a.O8],af=new Qc(Lc,this.wm,this.vSa,Kd,this.UWd,this.afa,this.Jna),Xe=function(th){return Fb.GTb.kEg(th.assetId,Fb.Jna,Fb.vSa,G)},pg=function(th){return Fb.GTb.Ule(th.assetId)},sg=function(th,
Pi,Oh){ad--;Oh=new Zc(Lc,Pi,Kd,null,la,Oh,0>=ad);th&&Pi?Fb.Okc(Oh):Fb.Nkc(Oh);ad||Jf.AFrameworkApplication.za.updateCommandUI()},lh=function(th,Pi,Oh,pi){sg(th,Pi,pi)},Jh=function(){Fb.ghc();0>=lc.count&&4===Lc&&Fb.afa.vqc()};6===Lc?(ue=Ya[Vg.a.ZGa],Ya=Ya[Vg.a.$Ga],af.b$h(lc.oa(0),ue,Ya,Xe,pg,function(th,Pi,Oh,pi){sg(th,Pi,pi)})):af.vLa(lc,Xe,pg,ue,lh,Jh,this.j5d)}else pe.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.vSa.oA)),this.Nkc(new Zc(Lc,
null,null,null,la,null,!0))};Ic.prototype.Nkc=function(G){this.ghc(G);this.FTf(!1,G)};Ic.prototype.Okc=function(G){var la=G.Im;this.ghc(G);if(la){Ke.instance.XMf(jd(la.currentStoreType.toLowerCase()),!0);if("uploadfiledevcatalog"===la.currentStoreType.toLowerCase()){var Ya=this.$8f.createAddinDataProvider(la.currentStoreType.toLowerCase(),this.wm);Ya&&(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ya.localCacheAddinCommands(this.wm.Ska,
la.solutionId||la.id,la.version||la.appVersion,la.storeId):Ya.localCacheAddinCommands(this.wm.Ska,la.id,la.appVersion,la.storeId))}this.G1i(G.tya.W4a,la.currentStoreType,G.Kr,G.nMe);U.a.aKb(Vg.a.RVb,"true",jd(la.currentStoreType.toLowerCase()))}this.FTf(!0,G)};Ic.prototype.FTf=function(G,la){G?Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&la.tya&&5===la.Kr&&la.tya.W4a&&void 0!==la.Im.showCallout&&null!==la.Im.showCallout&&
la.Im.showCallout?((new Ed(this.rb,la.Im,yc.a.xrb(la.tya.W4a))).wog(),G=new he,G.$q=la.tya.W4a,G.Im=la.Im,this.rb.raiseEvent(Vg.a.QSf,G)):3!==la.Kr?la.u$e&&this.afa.vqc():la.tya&&la.tya.W4a&&(G=Object(Ci.a)(Qd.Ribbon,la.nMe),"hardcodedpreinstall"!==la.Im.currentStoreType&&Ij.a.ifj(G,la.uph,la.displayName,la.tya.W4a)):3===la.Kr?la.Im&&"uploadfiledevcatalog"===la.Im.currentStoreType.toLowerCase()?(la=this.Jna.Qyh(la.Im.assetId),Ij.a.WJd(la?la:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.afa.aOf():la.u$e&&this.afa.vqc()};Ic.prototype.ghc=function(G){var la=(G=void 0===G?null:G)?G.Im:null,Ya=new he;if(Ya.Im=la)G=6===G.Kr?1:0,(la=Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.afa.KP(la.storeType||la.currentStoreType,la.solutionId||la.id,G):this.afa.KP(la.currentStoreType,la.assetId,G))&&la.$q&&(Ya.$q=la.$q);this.rb.raiseEvent(Vg.a.ige,Ya)};Ic.prototype.G1i=function(G,la,Ya,Fb){Fb=Object(Ci.a)(Qd.Ribbon,
Fb);G&&Fb&&(G=G.tabs.oa(0).JQa[Pg.a.id],3===Ya&&"hardcodedpreinstall"!==la&&Fb.SFd(G),Fb.O5h(G)&&Fb.F1i())};Object(sd.a)(Ic,"LaunchAddinCommandsHandler",null,[823]);b(896);b(876);Xb.prototype.R6=function(){return uh.k(this.YWd,this.whi(),this.$z)};Xb.prototype.whi=function(){var G=null;if(this.Hea){G=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var la=Ml(this.Hea),Ya=la.next();!Ya.done;Ya=la.next())G.append(Ya.value.R6());G.append("</Controls></MenuSection></Menu>")}return G?
G.toString():""};Jl.Object.defineProperties(Xb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},$z:{configurable:!0,enumerable:!0,get:function(){return this.VWd||(this.VWd={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.YWd||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.Hea||(this.Hea=new wg.a)}}});Object(sd.a)(Xb,"ControlDefinition",null,[819]);hc.prototype.R6=function(){return uh.k(Pg.a.button,null,this.xHc)};
Jl.Object.defineProperties(hc.prototype,{zQ:{configurable:!0,enumerable:!0,get:function(){return this.xHc||(this.xHc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(sd.a)(hc,"MenuItemDefinition",null,[860]);Xa.prototype.R6=function(){var G=null;if(this.C7){G=new Sys.StringBuilder;for(var la=Ml(this.C7),Ya=la.next();!Ya.done;Ya=la.next())G.append(Ya.value.R6())}return G?G.toString():""};Jl.Object.defineProperties(Xa.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.C7||(this.C7=new wg.a)}}});Object(sd.a)(Xa,"OfficeMenuDefinition",null,[820]);var Cd=b(29);Ea.prototype.addButton=function(G){pe.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",G.actionType);this.iI=new Xb(this.VO(G.id),Pg.a.button);this.iI.$z[Pg.a.nMb]=G.label;this.iI.$z[Pg.a.nSa]=G.label;this.iI.$z[Pg.a.pSa]=G.icon["16"];this.Rqa(this.iI.$z[Pg.a.id],G.action);this.w1(this.iI.$z);
this.bTa.controls.add(this.iI);this.iI=null};Ea.prototype.startBuildMenu=function(G){if(cj.c(this.bTa))this.bTa=new Xa(G.id);else{var la=this.VO(G.id);this.iI=new Xb(la,Pg.a.t3);this.pga(this.iI.$z,G);this.iI.$z[Pg.a.pSa]=G.icon["16"];this.iI.$z[Pg.a.jdb]=Cd.a.alwaysEnabled}};Ea.prototype.addMenuItem=function(G){pe.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",G.actionType);var la=new hc(this.VO(G.id));this.pga(la.zQ,G);G.icon&&(la.zQ[Pg.a.pSa]=G.icon["16"]);this.Rqa(la.zQ[Pg.a.id],
G.action);this.w1(la.zQ);this.iI.menuItems.add(la)};Ea.prototype.endBuildMenu=function(){cj.c(this.iI)?(this.jgc.add(this.bTa),this.bTa=null):(this.bTa.controls.add(this.iI),this.iI=null)};Ea.prototype.Rqa=function(G,la){this.yjb.bindAction(G,la)};Ea.prototype.w1=function(G){this.wFa.w1(G)};Ea.prototype.VO=function(G){return this.c5.Lta(G)};Ea.prototype.pga=function(G,la){G[Pg.a.nMb]=la.label;G[Pg.a.nSa]=la.label};Jl.Object.defineProperties(Ea.prototype,{c5:{configurable:!0,enumerable:!0,get:function(){return this.ghb}},
wFa:{configurable:!0,enumerable:!0,get:function(){return this.Zda}},yjb:{configurable:!0,enumerable:!0,get:function(){return this.Oda}},jgc:{configurable:!0,enumerable:!0,get:function(){return this.Zfg}}});Object(sd.a)(Ea,"ContextMenuExtensibilityCreator",null,[845,840]);Fd.prototype.Lta=function(G){return this.lMa+G};Jl.Object.defineProperties(Fd.prototype,{lMa:{configurable:!0,enumerable:!0,get:function(){return this.MCa}}});Object(sd.a)(Fd,"DefaultContextMenuNamingProvider",null,[844]);Pc.prototype.Hwh=
function(G){return this.kQg+G};Jl.Object.defineProperties(Pc.prototype,{qoj:{configurable:!0,enumerable:!0,get:function(){return this.$kg}},kQg:{configurable:!0,enumerable:!0,get:function(){return this.Iag}}});Object(sd.a)(Pc,"DefaultRibbonGroupTemplate",null,[861]);Jl.Object.defineProperties(Nc.prototype,{nJb:{configurable:!0,enumerable:!0,get:function(){return this.bjb}}});Object(sd.a)(Nc,"DefaultRibbonGroupTemplateResolver",null,[843]);var se=b(1270);dc.prototype.bindAction=function(G,la){OfficeExt.DefaultControlActionBinder.bindAction(G,
la)};Object(sd.a)(dc,"DefaultUIControlActionBinder",null,[842]);xb.prototype.w1=function(G){G[Pg.a.jdb]=this.command};Jl.Object.defineProperties(xb.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.kBa}}});Object(sd.a)(xb,"DefaultUIControlCommandBinder",null,[841]);var $e=b(31);Object(sd.a)(eb,"AddInControl",null,[]);Object(sd.a)(Qa,"AddInGroup",null,[]);Object(sd.a)(gb,"AddInMenuItem",null,[]);Object(sd.a)(pb,"AddInTab",null,[]);Ub.prototype.startBuildTab=function(G){var la=
G.isOfficeTab?G.id:this.c5.Kad(G.id),Ya=G.isOfficeTab?null:G.label;this.rv=Object.assign(new pb,{id:la,title:Ya,isOfficeTab:G.isOfficeTab,visible:G.visible,groups:[],tabType:G.tabType,insertBefore:G.insertBefore,insertAfter:G.insertAfter,autoFocus:G.autoFocus})};Ub.prototype.startBuildGroup=function(G){var la=this.VO(G.id);this.Cw=Object.assign(new Qa,{id:la,title:G.label,controls:[],groupType:0})};Ub.prototype.addNativeGroup=function(G){this.Cw=Object.assign(new Qa,{id:G.id,title:G.label,controls:[],
groupType:1});this.rv.groups.push(this.Cw)};Ub.prototype.addButton=function(G){var la=this.VO(G.id);la&&(this.Rqa(la,G.action),pe.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new eb,{id:la,title:G.label,iconLocation:this.S9c(G),enabled:G.enabled,controlType:0,attributes:this.pga()}),this.WYd.Rce(new $e.a(la,this.wFa.command.toString())),this.Cw.controls.push(G))};Ub.prototype.addNativeControl=function(G){G.id&&(pe.ULS.sendTraceTag(590709920,
220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new eb,{id:G.id,title:"",iconLocation:"",enabled:G.enabled,controlType:2,attributes:this.pga()}),this.Cw.controls.push(G))};Ub.prototype.startBuildMenu=function(G){var la=this.VO(G.id);la&&(this.D7=Object.assign(new eb,{id:la,title:G.label,iconLocation:this.S9c(G),controlType:1,attributes:{},menuItems:[]}))};Ub.prototype.addMenuItem=function(G){var la=this.VO(G.id);la&&(this.Rqa(la,G.action),pe.ULS.sendTraceTag(24786642,
220,50,"AddInDataTransferObject menu item actiontype: {0}.",G.actionType),G=Object.assign(new gb,{id:la,title:G.label,iconLocation:this.S9c(G),enabled:G.enabled,attributes:this.pga()}),this.WYd.Rce(new $e.a(la,this.wFa.command.toString())),this.D7.menuItems.push(G))};Ub.prototype.endBuildMenu=function(){cj.c(this.D7.id)||this.Cw.controls.push(this.D7);this.D7=null};Ub.prototype.endBuildGroup=function(){cj.c(this.Cw.id)||this.rv.groups.push(this.Cw);this.Cw=null};Ub.prototype.endBuildTab=function(){cj.c(this.rv.id)||
this.BMb.add(this.rv);this.rv=null};Ub.prototype.pga=function(){var G={};this.w1(G);return G};Ub.prototype.S9c=function(G){return G.icon["80"]?G.icon["80"]:G.icon["32"]};Ub.prototype.w1=function(G){this.wFa.w1(G)};Ub.prototype.VO=function(G){return this.c5.Lta(G)};Ub.prototype.Rqa=function(G,la){this.yjb.bindAction(G,la)};Jl.Object.defineProperties(Ub.prototype,{c5:{configurable:!0,enumerable:!0,get:function(){return this.ghb}},Rw:{configurable:!0,enumerable:!0,get:function(){return this.BMb}},Qtc:{configurable:!0,
enumerable:!0,get:function(){return null}},yjb:{configurable:!0,enumerable:!0,get:function(){return this.Oda}},wFa:{configurable:!0,enumerable:!0,get:function(){return this.Zda}}});Object(sd.a)(Ub,"OneLineRibbonExtensibilityCreator",null,[839,840]);Mb.prototype.R6=function(){for(var G=new wg.a,la=Ml(this.Zga),Ya=la.next();!Ya.done;Ya=la.next())G.add(Ya.value.R6());G=uh.e.apply(null,[Pg.a.kdb,null].concat(G.toArray()));return uh.e(Pg.a.GROUP,this.mua,G)};Jl.Object.defineProperties(Mb.prototype,{nJb:{configurable:!0,
enumerable:!0,get:function(){return this.bjb},set:function(G){this.bjb=G;this.mua[Pg.a.p8f]=this.bjb}},mua:{configurable:!0,enumerable:!0,get:function(){return this.VZd||(this.VZd={})}},Zga:{configurable:!0,enumerable:!0,get:function(){return this.WWd||(this.WWd=new wg.a)}}});Object(sd.a)(Mb,"GroupDefinition",null,[]);Hb.prototype.R6=function(){for(var G=new wg.a,la=new wg.a,Ya=Ml(this.hFd),Fb=Ya.next();!Fb.done;Fb=Ya.next())G.add(Fb.value.R6());Ya=Ml(this.xJ);for(Fb=Ya.next();!Fb.done;Fb=Ya.next())la.add(Fb.value.R6());
la=this.ome(Pg.a.mMb,this.$We,la.toArray());G=this.ome(Pg.a.ETd,this.UKf,G.toArray());return uh.e(Pg.a.n8f,this.JQa,G,la)};Hb.prototype.ome=function(G,la,Ya){var Fb={};Fb[Pg.a.id]=la;return uh.e.apply(null,[G,Fb].concat(Ya))};Jl.Object.defineProperties(Hb.prototype,{yza:{configurable:!0,enumerable:!0,get:function(){return this._id}},JQa:{configurable:!0,enumerable:!0,get:function(){return this.w$d||(this.w$d={})}},xJ:{configurable:!0,enumerable:!0,get:function(){return this.WZd||(this.WZd=new wg.a)}},
hFd:{configurable:!0,enumerable:!0,get:function(){return this.C8d||(this.C8d=new wg.a)}}});Object(sd.a)(Hb,"TabDefinition",null,[]);Jb.prototype.startBuildTab=function(G){G=G.isOfficeTab?this.c5.VDh(G.id):this.c5.Kad(G.id);this.rv=new Hb(G)};Jb.prototype.startBuildGroup=function(G){G=this.VO(G.id);this.Cw=new Mb(G)};Jb.prototype.addButton=function(G){var la=this.VO(G.id);this.Rqa(la,G.action)};Jb.prototype.startBuildMenu=function(){};Jb.prototype.addMenuItem=function(G){var la=this.VO(G.id);this.Rqa(la,
G.action)};Jb.prototype.endBuildMenu=function(){};Jb.prototype.endBuildGroup=function(){this.rv.xJ.add(this.Cw);this.Cw=null};Jb.prototype.endBuildTab=function(){cj.c(this.rv.yza)||this.A$d.add(this.rv);this.rv=null};Jb.prototype.Rqa=function(G,la){this.yjb.bindAction(G,la)};Jb.prototype.VO=function(G){return this.c5.Lta(G)};Jl.Object.defineProperties(Jb.prototype,{Rw:{configurable:!0,enumerable:!0,get:function(){return null}},c5:{configurable:!0,enumerable:!0,get:function(){return this.ghb}},yjb:{configurable:!0,
enumerable:!0,get:function(){return this.Oda}},Qtc:{configurable:!0,enumerable:!0,get:function(){return this.A$d}}});Object(sd.a)(Jb,"RibbonExtensibilityCreatorBase",null,[839,840]);Va.prototype.R6=function(){return uh.k(this.Uig,null,this.w_)};Jl.Object.defineProperties(Va.prototype,{w_:{configurable:!0,enumerable:!0,get:function(){return this.B8d||(this.B8d={})}}});Object(sd.a)(Va,"ScalingDefinition",null,[]);Cm(Da,Jb);Da.prototype.startBuildTab=function(G){Jb.prototype.startBuildTab.call(this,
G);this.rv.isOfficeTab=G.isOfficeTab;if(!this.rv.isOfficeTab)this.rv.JQa[Pg.a.xna]=this.D3b(G.label);else if(this.rv.yza){var la=this.c5.QBh(G.id);la&&(this.rv.JQa[Pg.a.xna]=la);(G=this.c5.OBh(G.id))&&(this.rv.JQa[Pg.a.O7f]=G)}G=this.rv.yza;this.rv.UKf=G+"."+Pg.a.ETd;this.rv.$We=G+"."+Pg.a.mMb};Da.prototype.startBuildGroup=function(G){Jb.prototype.startBuildGroup.call(this,G);this.Cw.mua[Pg.a.xna]=this.D3b(G.label)};Da.prototype.addButton=function(G){Jb.prototype.addButton.call(this,G);pe.ULS.sendTraceTag(17085954,
220,50,"RibbonExtensibility button actiontype: {0}.",G.actionType);var la=this.bT(G,Pg.a.button);this.w1(la.$z);la.$z[Pg.a.oSa]=G.enabled;this.Cw.Zga.add(la)};Da.prototype.startBuildMenu=function(G){this.D7=this.bT(G,Pg.a.t3)};Da.prototype.addMenuItem=function(G){Jb.prototype.addMenuItem.call(this,G);pe.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",G.actionType);var la=this.VO(G.id);la=new hc(la);this.pga(la.zQ,G);this.w1(la.zQ);la.zQ[Pg.a.oSa]=G.enabled;this.D7.menuItems.add(la)};
Da.prototype.endBuildMenu=function(){this.Cw.Zga.add(this.D7);this.D7=null};Da.prototype.endBuildGroup=function(){this.BEg();this.rv.hFd.add(this.cea);this.fea&&(this.rv.hFd.add(this.fea),this.fea=null);this.cea=null;Jb.prototype.endBuildGroup.call(this)};Da.prototype.w1=function(G){this.wFa.w1(G)};Da.prototype.bT=function(G,la){var Ya=this.VO(G.id);la=new Xb(Ya,la);this.pga(la.$z,G);return la};Da.prototype.pga=function(G,la){G[Pg.a.nMb]=this.D3b(la.label);G[Pg.a.nSa]=this.D3b(la.label);G[Pg.a.pSa]=
la.icon["16"];G[Pg.a.K7f]=la.icon["32"]};Da.prototype.BEg=function(){var G=this.yMh.nJb;this.Cw.nJb=G.qoj;var la=this.Cw.Zga.count;pe.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",la);var Ya=this.Cw.mua[Pg.a.id];this.cea=new Va(Pg.a.ATd);this.cea.w_[Pg.a.id]=Ya+".Scaling."+Pg.a.ATd;this.cea.w_[Pg.a.vTd]=this.Cw.mua[Pg.a.id];2<la&&(this.fea=new Va(Pg.a.DTd),this.fea.w_[Pg.a.id]=Ya+".Scaling."+Pg.a.DTd,this.fea.w_[Pg.a.vTd]=this.Cw.mua[Pg.a.id]);this.M9i(la,G)};Da.prototype.M9i=function(G,
la){var Ya=1;switch(G){case 1:case 2:this.cea.w_[Pg.a.NAa]=Pg.a.LARGE;break;case 3:this.cea.w_[Pg.a.NAa]=Pg.a.LARGE;this.fea.w_[Pg.a.NAa]=Pg.a.kyc;break;case 4:this.cea.w_[Pg.a.NAa]=Pg.a.kyc+"TwoRow";this.fea.w_[Pg.a.NAa]=Pg.a.SMALL+"TwoRow";break;case 5:case 6:this.cea.w_[Pg.a.NAa]=Pg.a.kyc;this.fea.w_[Pg.a.NAa]=Pg.a.SMALL;break;default:throw pe.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",G),this.Jna.setErrorMessageForAddin(this.SMb,CommonUIStrings.l_AddinManifestInvalid_Message),
Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",G));}for(var Fb=Ml(this.Cw.Zga),lc=Fb.next();!lc.done;lc=Fb.next())lc.value.$z[Pg.a.q8f]=la.Hwh(Ya),Ya+=3!==G?1:2};Da.prototype.D3b=function(G){return G?(G=od.a.replaceAll(G,"&","&amp;"),G=od.a.replaceAll(G,"'","&apos;"),G=od.a.replaceAll(G,'"',"&quot;"),G=od.a.replaceAll(G,">","&gt;"),G=od.a.replaceAll(G,"<","&lt;")):null};Jl.Object.defineProperties(Da.prototype,{yMh:{configurable:!0,enumerable:!0,get:function(){return this.pdg}},
wFa:{configurable:!0,enumerable:!0,get:function(){return this.Zda}}});Object(sd.a)(Da,"RibbonExtensibilityCreator",Jb,[]);wa.prototype.Ule=function(G){G=new Fd(G);return new Ea(G,this.Zda,this.Oda)};wa.prototype.yEg=function(G,la,Ya){Ya=new se.a(this.MCa,G,Ya,!0);var Fb=new Nc(this.MCa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new Da(Ya,this.Oda,this.Zda,Fb,G,la)};wa.prototype.kEg=function(G,la,Ya,Fb){Ya=new se.a(this.MCa,G,Ya,!0);return new Ub(Ya,this.Oda,this.Zda,G,la,
Fb)};Object(sd.a)(wa,"UIExtensibilityFactory",null,[814]);var Af=b(933);Wa.prototype.evi=function(){if(this.Im&&this.lEa){var G=new hj.a(Cd.a.H8,0,0,2,null),la={};this.addinUICommandHandler.executeCommand(0,G,(la.SourceControlId=this.lEa,la),null);pe.ULS.sendTraceTag(537774035,220,50,"Launch addin command has been triggered")}};Wa.prototype.jfj=function(G,la){var Ya=this;G=null;if(la)if(G=la,this.Im=G.Im,(this.$q=G.$q)&&this.$q.yba&&this.$q.yba.Rw&&(this.mEa=this.$q.yba.Rw.oa(0)),this.mEa&&this.mEa.id)if(this.mEa.isOfficeTab)if(la=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),this.Im.assetId in la?this.lEa=la[this.Im.assetId]:(pe.ULS.sendTraceTag(537774033,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(this.Im.storeType,this.Im.storeId,this.Im.solutionId)),this.lEa=this.bth(this.$q)),this.lEa)if(Ig.a.contains(this.mEa.id,si.a.NV,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(yc.a.xrb(this.$q),function(){Ya.dUf(Ya.W$c(Ya.lEa))});
else{if(la=this.$.Na)la.Dug(Object(Ve.a)(this,this.gtf,"onTabSwitched")),pe.ULS.sendTraceTag(537774031,220,50,"ShowCalloutOnAddin registered a tab switched event")}else pe.ULS.sendTraceTag(537774032,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin");else this.fUf(this.W$c(this.mEa.id),0);else pe.ULS.sendTraceTag(537774034,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id")};Wa.prototype.gtf=function(){if(Ig.a.contains(this.mEa.id,appChrome.selectors.getSelectedTabId(),
!0)){var G=this.$.Na;G&&G.GVi(Object(Ve.a)(this,this.gtf,"onTabSwitched"));this.dUf(this.W$c(this.lEa))}};Wa.prototype.W$c=function(G){return"[id="+G+"]"};Wa.prototype.fUf=function(G,la){var Ya=this;la>Jf.AFrameworkApplication.ha.qd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)?(window.clearTimeout(this.kEf),this.eUf("[data-unique-id='pivotOverflowButton']"),pe.ULS.sendTraceTag(537774030,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
G)?this.eUf(G):this.kEf=window.setTimeout(function(){Ya.fUf(G,la+1)},1E3)};Wa.prototype.dUf=function(G){var la=document.querySelector("button[data-unique-id='RightPaddle']");if(la)G={},G=(G["Data.AppTeachingUICalloutAction"]="RightPaddlePresent",G["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Im.storeType,this.Im.storeId,this.Im.solutionId),G),mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(G)}));else if(la=document.querySelector("button"+
G),!la&&(la=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!la)){la={};la=(la["Data.AppTeachingUICalloutAction"]="NoAnchor",la["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Im.storeType,this.Im.storeId,this.Im.solutionId),la);mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(la)}));pe.ULS.sendTraceTag(537774029,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.r_f(la,"ShowTeachingUIForAddinButton")};
Wa.prototype.eUf=function(G){G=document.querySelector("button"+G);if(!G&&(G=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!G)){G={};G=(G["Data.AppTeachingUICalloutAction"]="NoAnchor",G["Data.SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Im.storeType,this.Im.storeId,this.Im.solutionId),G);mi.a.sendTelemetryEvent(Object.assign(new vj.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Ac.a.kG(G)}));pe.ULS.sendTraceTag(537774028,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");
return}this.r_f(G,"ShowTeachingUIForAddinTab")};Wa.prototype.r_f=function(G,la){G.setAttribute("lpp-id","latestAddin");var Ya=ei.a.instance.yc("Common.ISystemInitiatedFeedback");Ya&&G?(Ya.execute(function(Fb){Fb.logActivity(la,null)}),pe.ULS.sendTraceTag(537774026,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):pe.ULS.sendTraceTag(537774027,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture")};Wa.prototype.bth=function(G){if(!G)return null;if((G=G.yba)&&G.Rw&&0<G.Rw.count){G=
Ml(G.Rw);for(var la=G.next();!la.done;la=G.next())if(la=la.value,la.groups&&0<la.groups.length){la=Ml(la.groups);for(var Ya=la.next();!Ya.done;Ya=la.next())if(Ya=Ya.value,Ya.controls&&0<Ya.controls.length){Ya=Ml(Ya.controls);for(var Fb=Ya.next();!Fb.done;Fb=Ya.next()){Fb=Fb.value;if(Fb.attributes&&!Fb.controlType&&Fb.enabled)return Fb.id;if(Fb.menuItems)for(var lc=Ml(Fb.menuItems),Lc=lc.next();!Lc.done;Lc=lc.next())if(Lc=Lc.value,Lc.attributes&&Lc.enabled)return Fb.id}}}}return null};Object(sd.a)(Wa,
"AddinTeachingCalloutHandler",null,[]);var yf=b(1228),Gg=b(372),rh=b(9),hi=b(38);La.prototype.dispose=function(){void 0!==this.Nkb&&null!==this.Nkb&&(this.Nkb.dispose(),this.Nkb=null);this.Ce=this.$=null;this.disposed=!0};La.prototype.Gcj=function(G,la){switch(G){case Cd.a.H8:G=this.ucj(la);break;default:G=!1}return G};La.prototype.$c=function(){return!1};La.prototype.executeCommand=function(G,la,Ya){var Fb=this;G=xh.TaskExtensions.um();la=la.command;switch(la){case 843847158:break;case -2025863019:Ij.a.WJd(Ya[Vg.a.ivg].toString(),
function(){ti.g(Fb.$).focus()});break;case -1777565636:yf.a.showUILessDialog(Ya[Vg.a.Okb].toString());this.Ce.yfj(Ya[Vg.a.Okb].toString());break;case 1592314317:yf.a.hideUILessDialog(Ya[Vg.a.Okb].toString());this.Ce.UQh(Ya[Vg.a.Okb].toString());break;case Cd.a.H8:G=this.Nbd(Ya);break;case Cd.a.Qxb:this.vLa(Ya);break;case Cd.a.Hla:this.Hla(Ya);break;case Cd.a.XJd:this.Nkb.rsc();break;case Cd.a.refreshAddinCommands:this.$Oi();break;case 1949669462:this.Wfa.aOf(!0);break;case -1014260128:G=this.executeDynamicAddInCommandsAPI(Ya);
break;default:G=vk.a(la)}return G};La.prototype.Jc=function(G,la){G=!1;switch(la.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Cd.a.Hla:case Cd.a.XJd:case Cd.a.refreshAddinCommands:case 1949669462:case Cd.a.Qxb:case -1014260128:G=!0;break;case Cd.a.H8:G=!Jf.AFrameworkApplication.protectedFile}return G};La.prototype.gd=function(){return!1};La.prototype.$Oi=function(){if(this.Wfa.fnd()){this.Wfa.Tpe();var G=this.b8c();if(G&&0<G.count){G=Ml(G);for(var la=G.next();!la.done;la=
G.next()){var Ya={};la=(Ya.ack1=la.value,Ya.ack0=4,Ya.ak0=(new Date).getTime(),Ya);this.Hla(la)}}}};La.prototype.Hla=function(G){var la=this;pe.ULS.sendTraceTag(17408928,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",G[Vg.a.EO],G[Vg.a.O8]);this.Wfa.X5i();window.setTimeout(function(){if(void 0===la.Ce||null===la.Ce)pe.ULS.sendTraceTag(39613472,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
hi.a.y2()));else{var Ya=new kb(new Pb(la.Ce.Ah),Ue.instance,Ke.instance);Ya.crg(function(Fb,lc){la.vLa(lc.properties)});Ya.jtj(G)}},0)};La.prototype.vLa=function(G){var la=this;if(!this.disposed){pe.ULS.sendTraceTag(17306637,220,50,"LaunchOperationType {0}.",G[Vg.a.EO]);try{if(dg.EwaSettings.ka(189)){var Ya=G[Vg.a.rWa];if(Ya&&0<Ya.count){for(var Fb=Ya.count,lc=Fb-1;0<=lc;lc--){var Lc=Ya.oa(lc);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Lc.currentStoreType)||
Ya.remove(Ya.oa(lc)):Lc.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&Ya.remove(Ya.oa(lc))}if(Ya.count<Fb){var ad=Xi.GetServiceTaskFactory.Xa(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");xh.TaskExtensions.Da(ad,function(){ad.result.tg(35,null)},this.$.ma,3)}if(!Ya.count)return}}if(void 0===this.Ce||null===this.Ce)pe.ULS.sendTraceTag(34936846,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",
hi.a.y2()));else{var Kd=null;Kd=Jf.AFrameworkApplication.ha.ta("HostInstallAddInsIsEnabled")?new Ic(this.Xl,this.kte,new Pb(this.Ce.Ah),new wa(this.$.Mb,Cd.a.H8),this.Wfa,Ue.instance,this.Vfa,function(af,Xe){var pg={};pg.InstanceId=bj.a.create().toString();pg.PrimaryMarketplace={};pg.PrimaryMarketplace.MarketplaceRef=af.storeId;pg.PrimaryMarketplace.MarketplaceType=af.currentStoreType;pg.PrimaryMarketplace.SolutionId=af.assetId;pg.PrimaryMarketplace.SolutionVersion=af.appVersion;pg.WebExtensionType=
1;la.Ce.Ohj(pg,function(){Xe(af)})}):new Ic(this.Xl,this.kte,new Pb(this.Ce.Ah),new wa(this.$.Mb,Cd.a.H8),this.Wfa,Ue.instance,this.Vfa);Kd.drg(Object(Ve.a)(this,this.fvi,"onLaunchAddinCommandsCompleted"));if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var ue=new Wa(this);Kd.Wsg(Object(Ve.a)(ue,ue.evi,"onLaunchAddinButtonClicked"));Kd.vug(Object(Ve.a)(ue,ue.jfj,"showCalloutOnAddin"))}this.$.ea.Ea(53,void 0).Hn&&Ek.a.get_instance().en(5,
null).continueWith(function(){la.disposed||Kd.s$h(la.W4c,la.$.domElement,G)})}}catch(af){pe.ULS.sendTraceTag(17651478,220,10,String.format("LaunchAddinCommands error message : {0}.",af.message))}}};La.prototype.Nbd=function(G){var la=xh.TaskExtensions.um();G=G[this.Xl.$ga];var Ya=this.PVb.Lbe(G),Fb=new yf.a(this.$,this.Ce,Ya.ownerAddinInfo,la);return this.bXe(la,G,Ya,Fb)};La.prototype.bXe=function(G,la,Ya,Fb){var lc=this;this.PVb.Nbd(la,this.Wfa,Fb,new Pb(this.Ce.Ah),Ya,function(){G=Fb.APg()},function(){ti.g(lc.$).focus()});
return G};La.prototype.wAg=function(G){var la=this,Ya=xh.TaskExtensions.um(),Fb=this.Ce.r3(G.assetId);if(Fb){var lc=this.Ce.fU(Fb);if(rh.HelperMethods.My(lc)&&lc.SharedRuntime.State)return}lc=this.PVb.xAg;var Lc=G.assetId in lc?lc[G.assetId]:null;if(Lc){var ad=this.PVb.Lbe(Lc),Kd=new yf.a(this.$,this.Ce,ad.ownerAddinInfo,Ya);lc=function(af){if(af){var Xe={};af=Ml(af);for(var pg=af.next();!pg.done;pg=af.next())pg=pg.value,Xe[pg[0]]=pg[1];(Xe=Vg.a.hge in Xe?Xe[Vg.a.hge]:null)&&"true"===Xe.toLowerCase()&&
(pe.ULS.sendTraceTag(542185175,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==ad.ownerAddinInfo?ad.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId)),la.bXe(Ya,Lc,ad,Kd))}};pe.ULS.sendTraceTag(542185174,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==ad.ownerAddinInfo?
ad.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId));if(Fb)lc(this.Ce.fU(Fb).OsfPropertyBag);else if(Fb=this.$.fa.workbookContext.WebExtensions){Fb=Ml(Fb);for(var ue=Fb.next();!ue.done;ue=Fb.next())if(ue=ue.value,(1===ue.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===G.targetType&&ue.PrimaryMarketplace.MarketplaceType.toLowerCase()===G.currentStoreType.toLowerCase()&&ue.PrimaryMarketplace.MarketplaceRef.toLowerCase()===G.storeId.toLowerCase()&&ue.PrimaryMarketplace.SolutionId.toLowerCase()===
G.assetId.toLowerCase()){lc(ue.OsfPropertyBag);break}}}};La.prototype.aJb=function(G,la,Ya){Ya=void 0===Ya?!1:Ya;Ig.a.na(G)||(!Ya||la||this.f0c.contains(G)||this.f0c.add(G),(Ya=this.OZa.contains(G))&&la&&this.OZa.remove(G),Ya||la||this.OZa.add(G))};La.prototype.v9i=function(G){var la=G.yba;if(la){if(la.Rw)for(G=Ml(la.Rw),la=G.next();!la.done;la=G.next())if(la=la.value,la.groups){la=Ml(la.groups);for(var Ya=la.next();!Ya.done;Ya=la.next())if(Ya=Ya.value,Ya.controls){var Fb=Ml(Ya.controls);for(Ya=Fb.next();!Ya.done;Ya=
Fb.next())if(Ya=Ya.value,this.aJb(Ya.id,Ya.enabled,!0),1===Ya.controlType&&Ya.menuItems){var lc=Ml(Ya.menuItems);for(Ya=lc.next();!Ya.done;Ya=lc.next())Ya=Ya.value,this.aJb(Ya.id,Ya.enabled,!0)}}}}else if(G.tabs)for(G=Ml(G.tabs),la=G.next();!la.done;la=G.next())if(la=la.value,la.xJ)for(la=Ml(la.xJ),Ya=la.next();!Ya.done;Ya=la.next())if(Ya=Ya.value,Ya.Zga)for(Fb=Ml(Ya.Zga),Ya=Fb.next();!Ya.done;Ya=Fb.next())if(Ya=Ya.value,this.aJb(Ya.id,Pg.a.oSa in Ya.$z?Ya.$z[Pg.a.oSa]:!0,!0),Ya.controlType===Pg.a.t3&&
Ya.menuItems)for(lc=Ml(Ya.menuItems),Ya=lc.next();!Ya.done;Ya=lc.next())Ya=Ya.value,this.aJb(Ya.id,Pg.a.oSa in Ya.zQ?Ya.zQ[Pg.a.oSa]:!0,!0)};La.prototype.fvi=function(G,la){G=null;la&&(G=la);G&&G.$q&&this.v9i(G.$q);this.$.If();dg.EwaSettings.ka(88)&&G&&G.Im&&this.wAg(G.Im)};La.prototype.b8c=function(){var G=new wg.a;dg.EwaSettings.ka(54)&&(this.$.fa.gh.get(27)&&(G.add(0),G.add(16)),this.$.fa.gh.get(33)&&G.add(1),G.add(8));return G};La.prototype.executeDynamicAddInCommandsAPI=function(G){var la=!0;
if(void 0===G||null===G||void 0===G[Vg.a.Lpb]||null===G[Vg.a.Lpb])return Aj.Task.Ua(!1);switch(G[Vg.a.Lpb]){case 1:la=this.gwj(G);break;case 2:la=this.z9i(G);break;case 4:this.OZa.clear();this.OZa.addRange(this.f0c);break;case 3:la=this.installContextualTab(G);break;default:la=!1}return Aj.Task.Ua(la)};La.prototype.ucj=function(G){if(!(G&&this.Xl.$ga in G))return!1;G=G[this.Xl.$ga];return Ig.a.na(G)?!1:this.OZa.contains(G)};La.prototype.gwj=function(G){var la=null,Ya=null,Fb=null,lc=!0;void 0!==G[Vg.a.b3]&&
null!==G[Vg.a.b3]&&void 0!==G[this.Xl.$ga]&&null!==G[this.Xl.$ga]&&void 0!==G[Vg.a.a3]&&null!==G[Vg.a.a3]&&(la=G[Vg.a.b3],Ya=G[Vg.a.j3b],Fb=G[this.Xl.$ga],lc=G[Vg.a.a3]);if(Ig.a.na(la)||Ig.a.na(Fb))return pe.ULS.sendTraceTag(51515651,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;G=(new se.a(this.$.Mb,la,this.Xl,!0)).Lta(Fb);la={DynamicAddinCommandsApiName:"UpdateControlEnableState"};la.AssetId=Ya;la.MaskedTabId=G;la.IsToEnable=lc;pe.ULS.sendTraceTag(51515652,220,15,
Qh.a.Oc(la));this.aJb(G,lc);Gg.a.yI.updateCommandUI();return!0};La.prototype.z9i=function(G){var la=null,Ya=null,Fb=null,lc=null,Lc=!0;void 0!==G[Vg.a.M1c]&&null!==G[Vg.a.M1c]&&void 0!==G[Vg.a.b3]&&null!==G[Vg.a.b3]&&void 0!==G[this.Xl.$ga]&&null!==G[this.Xl.$ga]&&void 0!==G[Vg.a.a3]&&null!==G[Vg.a.a3]&&(la=G[Vg.a.M1c],Ya=G[Vg.a.b3],Fb=G[Vg.a.j3b],lc=G[this.Xl.$ga],Lc=G[Vg.a.a3]);if(Ig.a.na(la)||Ig.a.na(Ya)||Ig.a.na(lc))return pe.ULS.sendTraceTag(51515653,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),
!1;G=(new se.a(this.$.Mb,Ya,this.Xl,!0)).Kad(lc);lc={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};lc.StoreType=la;lc.AssetId=Fb;lc.MaskedTabId=G;lc.IsToShow=Lc;pe.ULS.sendTraceTag(51515654,220,15,Qh.a.Oc(lc));Ya=this.Wfa.KP(la,Ya,1);la=!1;if(Ya&&Ya.$q&&Ya.$q.yba&&Ya.$q.yba.Rw)for(Ya=Ml(Ya.$q.yba.Rw),Fb=Ya.next();!Fb.done;Fb=Ya.next())if(Fb.value.id===G){la=!0;break}if(!la)return pe.ULS.sendTraceTag(591001285,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;la=[];Lc?appChrome.selectors.getSelectedTabId()!==
G&&la.push(appChrome.actions.activateRibbonTab(G)):(appChrome.selectors.getSelectedTabId()===G&&la.push(appChrome.actions.setCurrentTab(si.a.NV)),la.push(appChrome.actions.deactivateRibbonTab(G)));appChrome.api.dispatch(la);return!0};La.prototype.installContextualTab=function(G){var la=null,Ya=null,Fb=null,lc=null;if(void 0!==G[Vg.a.b3]&&null!==G[Vg.a.b3]&&void 0!==G[Vg.a.a3]&&null!==G[Vg.a.a3]){var Lc=G[Vg.a.a3];la=G[Vg.a.b3];void 0!==Lc[Vg.a.ZGa]&&null!==Lc[Vg.a.ZGa]&&void 0!==Lc[Vg.a.$Ga]&&null!==
Lc[Vg.a.$Ga]&&(Ya=Lc[Vg.a.ZGa],Fb=Lc[Vg.a.$Ga],lc=Lc[Vg.a.N1c])}if(Ig.a.na(la)||!Fb||!Ya||!lc)return pe.ULS.sendTraceTag(591971673,220,15,"InstallContextualTab failed to invalid parameters"),!1;if((G=this.Wfa.KP(lc.PrimaryMarketplace.MarketplaceType,lc.PrimaryMarketplace.SolutionId,1))&&G.$q)return pe.ULS.sendTraceTag(591001284,220,15,"InstallContextualTab was called multiple times"),!1;G={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(G.solutionId=
lc.PrimaryMarketplace.SolutionId,G.version=lc.PrimaryMarketplace.SolutionVersion,G.storeType=lc.PrimaryMarketplace.MarketplaceType,G.storeId=lc.PrimaryMarketplace.MarketplaceRef,G.assetId=lc.PrimaryMarketplace.SolutionId,G.assetStoreId=lc.PrimaryMarketplace.MarketplaceRef,G.targetType=lc.WebExtensionOsfControlType,G.width=lc.TaskpaneWidth,G.height=0,G.isAddinCommands=!0,G.id=G.assetId,G.appVersion=lc.PrimaryMarketplace.SolutionVersion,G.currentStoreType=lc.PrimaryMarketplace.MarketplaceType):(G.appVersion=
lc.PrimaryMarketplace.SolutionVersion,G.assetId=lc.PrimaryMarketplace.SolutionId,G.assetStoreId=lc.PrimaryMarketplace.MarketplaceRef,G.currentStoreType=lc.PrimaryMarketplace.MarketplaceType,G.id=G.assetId,G.storeId=G.assetStoreId,G.targetType=lc.WebExtensionOsfControlType,G.width=lc.TaskpaneWidth,G.height=0,G.isAddinCommands=!0);lc=new wg.a;lc.add(G);G={};G[Vg.a.rWa]=lc;G[Vg.a.EO]=6;G[Vg.a.ZGa]=Ya;G[Vg.a.$Ga]=Fb;this.vLa(G);return!0};Object(sd.a)(La,"AddinUICommandHandler",null,[160,159,7]);var fi=
b(69);Gc.prototype.aJd=function(){return this.bJd()};Gc.prototype.activate=function(){return this.HNc()};Gc.prototype.deactivate=function(){this.W_c()};Gc.prototype.dispose=function(){this.W_c=this.HNc=this.bJd=null};Object(sd.a)(Gc,"FeatureActivator",null,[51,7]);var di=b(21),Rh=b(19),Fh=Hi.a;Cm(nc,Fh);nc.prototype.Rd=function(){var G=this;pe.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");fi.a(this.$).add(Object.assign(new Gc,{bJd:function(){var la=G.$.fa.yE&&
G.$.fa.pc&&!!(G.$.Gd&16384)&&G.$.isEditMode;G.$.fa.pc&&pe.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",la,G.$.fa.yE,G.$.fa.pc,!!(G.$.Gd&16384),G.$.isEditMode);return la},HNc:Object(Ve.a)(this,this.$mg,"activateFeature"),W_c:Object(Ve.a)(this,this.D_g,"deactivateFeature"),W4b:2}))};nc.prototype.$mg=function(){var G=this;pe.ULS.sendTraceTag(38410434,
0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",this.$.isEditMode,!!(this.$.Gd&16384));var la=new eh.a;this.$.ea.ub(53,function(af){pe.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");la.setResult(af)});var Ya=la.task,Fb=new Rd,lc=Yj.a.getInstance(),Lc=new uc(this.$,lc),ad=Xi.GetServiceTaskFactory.create(this.$.ea,203,this.ma,this.vb,"System.IDisposable"),Kd=this.FPi(Fb),ue=Xi.GetServiceTaskFactory.Xa(this.$.ea,
349,350,this.vb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper");return xh.TaskExtensions.Da(xh.TaskExtensions.Fe([Ya,ad,Kd,ue],this.ma),function(){pe.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(G.$.ea,106,G.ma,G.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),function(af){G.handler=new La(G.$,af.result,Fb,new Yd,lc,Lc,ei.a.instance.Uh("Common.IExternalUICommandDefinitionMapping"));
pe.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");G.Hd([G.handler]);G.$.ea.La(198,G.handler)},G.ma,3)},this.ma,3)};nc.prototype.D_g=function(){void 0!==this.handler&&null!==this.handler?(this.$.Na.T8a(this.handler),this.$.ea.qP(198),this.handler=null):pe.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ea.qP(204);Rh.a(2,di.a,21,this.$.ea,198,
"Microsoft.Office.Excel.WebUI.Client.IServiceFactory<Microsoft.Office.Excel.WebUI.Client.ICommandHandler>")};nc.prototype.FPi=function(G){var la=this,Ya=Xi.GetServiceTaskFactory.create(this.$.ea,102,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager");return xh.TaskExtensions.Da(Ya,function(){pe.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");la.$.ea.La(204,new pd(Ya.result,
G))},this.ma,3)};nc.la=function(G){Hi.a.ie(199,new nc(G))};Object(sd.a)(nc,"AddinUICommandHandlerFactory",Hi.a,[]);var ph=b(1217),bi=b(1219),wh=oj.a;Cm(Bb,wh);Bb.prototype.create=function(){var G=this,la;if(dg.EwaSettings.ka(419)){var Ya=Xi.GetServiceTaskFactory.create(this.$.ea,106,this.$.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Fb=Xi.GetServiceTaskFactory.create(this.$.ea,396,this.$.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IndexedDB.IIndexedDB");xh.TaskExtensions.Da(Aj.Task.WAA(Ya,
Fb),function(){G.Jb(G.$.ea.Ea(278,void 0)||new ph.CustomFunctionsInstaller(G.$,Ya.result,Fb.result))},this.$.ma,3)}else(la=this.$.ea.Ea(278,void 0))||(la=this.$.ea.La(278,new bi.CustomFunctionsLegacyInstaller(this.$))),this.Jb(la)};Bb.la=function(G){G.ea.La(279,new Bb(G))};Object(sd.a)(Bb,"CustomFunctionsInstallerFactory",oj.a,[]);var $h=b(86),ri=b(44),Qi=b(42);Tb.prototype.la=function(G){this.FRc?pe.ULS.sendTraceTag(19718340,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.FRc=!0,this.QNa={},this.RNa={},G?G.Org(Object(Ve.a)(this,this.v_f,"triggerReadout")):pe.ULS.sendTraceTag(19273180,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};Tb.prototype.detach=function(G){if(G){G.rTi(Object(Ve.a)(this,this.v_f,"triggerReadout"));G=this.QNa;for(var la in G)$h.a.Ia(G[la]);this.RNa=this.QNa=null;this.FRc=!1}else pe.ULS.sendTraceTag(19273181,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};Tb.prototype.v_f=function(G,
la){var Ya=this,Fb=null,lc=null,Lc=null;la?(Object(wj.a)(223,la)?(Fb=la.rEa,Lc=la.instanceId):Object(wj.a)(215,la)&&(Fb=la.get_element(),Lc=la.instanceId),Fb)?(lc=Object(Ci.a)(683,G),lc)?this.TBf(Lc,Fb,lc)||Lc in this.QNa||(this.RNa[Lc]=0,this.QNa[Lc]=ri.a.instance.UB(function(){10<=Ya.RNa[Lc]||Ya.TBf(Lc,Fb,lc)?(delete Ya.RNa[Lc],Ya.QNa[Lc].dispose(),delete Ya.QNa[Lc]):Ya.RNa[Lc]+=1},500,Qi.a.Zvg,!0,!1)):pe.ULS.sendTraceTag(19273182,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):
pe.ULS.sendTraceTag(19273183,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):pe.ULS.sendTraceTag(19718341,0,10,"Invalid parameter for ReadoutSelection")};Tb.prototype.TBf=function(G,la,Ya){if(this.CZh(Ya,G))return!1;G=la.querySelector("iframe");if(!G)return pe.ULS.sendTraceTag(20022086,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;G=G.title;if(!G||!G.length)return pe.ULS.sendTraceTag(19273185,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(G);return!0};Tb.prototype.CZh=function(G,la){return(G=G.Ah.getOsfControl(la))?G.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(sd.a)(Tb,"AgaveOnSelectedReadoutHandler",null,[684]);var Xh=oj.a;Cm(cb,Xh);cb.prototype.create=function(){var G=this,la=this.$.ea;xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.Xa(la,211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(Ya){Ya=la.Ea(224,void 0)||new Tb(Ya.result,G.$);G.Jb(Ya)},
this.ma,3)};cb.la=function(G){G.ea.La(225,new cb(G))};Object(sd.a)(cb,"AgaveOnSelectedReadoutHandlerFactory",oj.a,[]);var Dh=b(843),vi=b(228);ic.prototype.bYe=function(G){try{if(G&&G.rawEvent&&G.rawEvent.origin&&this.iframe&&this.iframe.id){var la=this.Fvf(G.rawEvent.origin),Ya=this.Fvf(document.domain);if(Mj.a.Dl().equals(Ya,la))if(G.rawEvent.source&&G.rawEvent.source.frameElement&&G.rawEvent.source.frameElement.id&&Mj.a.Dl().equals(G.rawEvent.source.frameElement.id,this.iframe.id)){la=null;try{la=
JSON.parse(G.rawEvent.data)}catch(Fb){pe.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Fb.message)}la?(la.statusCode!==vi.a.bO||void 0!==la.error&&la.error?(pe.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",la.statusCode,la.error),this.onError()):(pe.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(la.authorizationCode?la.authorizationCode:la.signInUrl)),$removeHandler(window,"message",Object(Ve.a)(this,this.bYe,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):pe.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):pe.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):pe.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else pe.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else pe.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else pe.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Fb){pe.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Fb.message)}};ic.prototype.Fvf=
function(G){var la="";try{G&&(la=-1<G.indexOf("//")?G.split("/")[2]:G.split("/")[0])&&(la=la.split(":")[0],la=la.split("?")[0])}catch(Ya){pe.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Ya.message)}return la};ic.la=function(G,la,Ya){new ic(G,la,Ya)};Object(sd.a)(ic,"ResponseHandler",null,[]);var Gi=b(277);sc.prototype.tryAuthenticate=function(G,la){this.G7a(sc.Odg,function(){G()},la)};sc.prototype.tryAuthorize=function(G,la){this.G7a(sc.T9f,G,la)};sc.prototype.getSignInUrl=
function(G,la){this.G7a(sc.K9d,G,la)};sc.prototype.signOut=function(G,la){this.G7a(sc.Ujg,G,la)};sc.prototype.G7a=function(G,la,Ya){var Fb=new Gi.QueryStringBuilder("AuthenticationProxyHandler.aspx");Fb.Ym("responseType",G);Jf.AFrameworkApplication.Zjb(Fb);Fb=String.format("{0}{1}&{2}",this.MDa,Fb.toString(),Jf.AFrameworkApplication.hj);var lc=document.createElement("iframe");lc.setAttribute("id","privateCatalogIframe");lc.setAttribute("name","privateCatalogIframe");lc.setAttribute("style","display: none");
Mj.a.Dl().equals(G,sc.K9d)||lc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");ic.la(lc,la,Ya);lc.setAttribute("src",Fb);document.body.appendChild(lc)};sc.T9f="authcode";sc.Odg="identitytoken";sc.K9d="signinurl";sc.Ujg="signout";Object(sd.a)(sc,"AuthenticationProxy",null,[]);tc.getUserId="getUserId";tc.getLastStoreUpdate="laststoreupdate";tc.getEntitlement="getEntitlements";tc.getEToken="getEToken";tc.getManifest="getManifest";tc.getAppState="getAppState";
tc.getKilledApps="getRemovedAddins";tc.getAppDetails="getAppDetails";tc.removeApps="removeAddin";tc.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";tc.getPrivateCatalogAddIns="getAddIns";tc.getPrivateCatalogManifests="getAppManifests";tc.isStoreDisabled="isStoreDisabled";Object(sd.a)(tc,"S2SWebRequestActions",null,[]);var zi=b(590);Oc.prototype.getUserId=function(G,la){var Ya=new wg.a;Ya.add(new ni.a("corr",G));this.jW(tc.getUserId,Ya,1,la)};Oc.prototype.getLastStoreUpdate=function(G,la,
Ya){var Fb=new wg.a;Fb.add(new ni.a("lc",G));Fb.add(new ni.a("corr",la));this.jW(tc.getLastStoreUpdate,Fb,1,Ya)};Oc.prototype.getEntitlement=function(G,la,Ya,Fb){G=new wg.a;G.add(new ni.a("av",la));G.add(new ni.a("corr",Ya));this.jW(tc.getEntitlement,G,1,Fb)};Oc.prototype.getEToken=function(G,la,Ya,Fb,lc,Lc){var ad=new wg.a;ad.add(new ni.a("cmu",G));ad.add(new ni.a("cmf",la));ad.add(new ni.a("assetid",Ya));ad.add(new ni.a("expver",Fb));ad.add(new ni.a("corr",lc));this.jW(tc.getEToken,ad,1,Lc)};Oc.prototype.getManifest=
function(G,la,Ya,Fb){var lc=new wg.a;lc.add(new ni.a("cmu",G));lc.add(new ni.a("assetid",la));lc.add(new ni.a("corr",Ya));this.jW(tc.getManifest,lc,1,Fb)};Oc.prototype.getAppState=function(G,la,Ya){var Fb=new wg.a;Fb.add(new ni.a("ma",G));Fb.add(new ni.a("corr",la));this.jW(tc.getAppState,Fb,1,Ya)};Oc.prototype.getKilledApps=function(G,la){var Ya=new wg.a;Ya.add(new ni.a("corr",G));this.jW(tc.getKilledApps,Ya,1,la)};Oc.prototype.getAppDetails=function(G,la,Ya,Fb){var lc=new wg.a;lc.add(new ni.a("cmo",
G));lc.add(new ni.a("corr",Ya));this.h$a(tc.getAppDetails,lc,la,2,Fb,!1)};Oc.prototype.removeApps=function(G,la,Ya){var Fb=new wg.a;Fb.add(new ni.a("corr",la));this.h$a(tc.removeApps,Fb,G,2,Ya,!1)};Oc.prototype.getLastPrivateCatalogUpdate=function(G,la,Ya,Fb,lc,Lc){var ad=new wg.a;ad.add(new ni.a("catalog","privatecatalog"));ad.add(new ni.a("clientCode",G));ad.add(new ni.a("clientVersion",la));ad.add(new ni.a("corr",lc));G=String.format("authorizationCode={0}&refreshToken={1}",Ya?od.a.rf(Ya):"",Fb?
od.a.rf(Fb):"");this.h$a(tc.getLastPrivateCatalogUpdate,ad,G,2,Lc,!0)};Oc.prototype.getPrivateCatalogAddIns=function(G,la,Ya,Fb,lc,Lc){var ad=new wg.a;ad.add(new ni.a("catalog","privatecatalog"));ad.add(new ni.a("clientCode",G));ad.add(new ni.a("clientVersion",la));ad.add(new ni.a("corr",lc));G=String.format("authorizationCode={0}&refreshToken={1}",Ya?od.a.rf(Ya):"",Fb?od.a.rf(Fb):"");this.h$a(tc.getPrivateCatalogAddIns,ad,G,2,Lc,!0)};Oc.prototype.getPrivateCatalogManifests=function(G,la,Ya,Fb,lc){var Lc=
new wg.a;Lc.add(new ni.a("catalog","privatecatalog"));Lc.add(new ni.a("corr",Fb));G=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",od.a.rf(G),la?od.a.rf(la):"",Ya?od.a.rf(Ya):"");this.h$a(tc.getPrivateCatalogManifests,Lc,G,2,lc,!0)};Oc.prototype.isStoreDisabled=function(G,la){var Ya=new wg.a;Ya.add(new ni.a("corr",G));this.jW(tc.isStoreDisabled,Ya,2,la)};Oc.prototype.jW=function(G,la,Ya,Fb){this.h$a(G,la,null,Ya,Fb,!1)};Oc.prototype.h$a=function(G,la,Ya,Fb,lc,Lc){var ad=new Gi.QueryStringBuilder("AddinServiceHandler.ashx");
ad.Ym("action",G);ad.Ym("app",zi.a[Jf.AFrameworkApplication.za.Za.Xk]);la=Ml(la);for(var Kd=la.next();!Kd.done;Kd=la.next())Kd=Kd.value,ad.Ym(Kd.key,Kd.value);ad=String.format("{0}{1}&{2}",Jf.AFrameworkApplication.za.Za.PZ,ad.toString(),Jf.AFrameworkApplication.hj);Jf.AFrameworkApplication.Md.Wl(ad,Fb,Ya,null,!1,2,function(ue){var af=null;ue&&ue.data&&(ue.data.responseHeaders["X-BlockedForMinor"]&&"1"===ue.data.responseHeaders["X-BlockedForMinor"].toString()&&(ue.data.httpStatus=451),af=ue.data.pe);
lc(ue.data.httpStatus,af)},function(ue){var af=null;Lc&&ue&&ue.data&&ue.data.pe&&(af=ue.data.pe);lc(ue.data.httpStatus,af);if(Jf.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){af={message:"AddinServiceHandler request failed"};af.code=ue.data.httpStatus;af.action=G;if(ue.data.request||ue.data.request.get_headers())af["X-UserSessionId"]=ue.data.request.get_headers()["X-UserSessionId"];408===ue.data.httpStatus||503===ue.data.httpStatus?
pe.ULS.sendTraceTag(538784582,220,10,JSON.stringify(af)):pe.ULS.sendTraceTag(18392345,220,50,JSON.stringify(af))}else pe.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",ue.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+G)};Object(sd.a)(Oc,"S2SWebRequestManager",null,[]);var ij=oj.a;Cm(td,ij);td.prototype.create=function(){var G=this;pe.ULS.sendTraceTag(38942484,0,50,"DdaFacadeServiceFactory:Create.");Jf.AFrameworkApplication.disableWholeAppsForOfficeFeature?
pe.ULS.sendTraceTag(38537093,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",Jf.AFrameworkApplication.disableWholeAppsForOfficeFeature):dg.EwaSettings.ka(424)?ei.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(la){la.isFeatureEnabled("mso_officeStore",!0).then(function(Ya){Dh.DdaFacade.RXc=Ya;G.ove();return null})}):this.ove()};td.prototype.ove=function(){var G=this,la=Xi.GetServiceTaskFactory.Xa(this.$.ea,
224,225,this.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveOnSelectedReadoutHandler"),Ya=$f.a.$md(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.Ba.MaxRetriesForLoadingScript,this.$.ma,this.vb,106),Fb=Ga(this.ma,this.vb);xh.TaskExtensions.Da(xh.TaskExtensions.Fe([la,Ya,Fb],this.$.ma),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?pe.ULS.sendTraceTag(40421204,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
hi.a.y2()):G.pUh();pe.ULS.sendTraceTag(38537094,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");G.SBf=la.result;G.Jb(G.Ce);pe.ULS.sendTraceTag(39965575,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)};td.prototype.pUh=function(){dg.EwaSettings.ka(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Oc);this.$.lg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Oc,new sc(Jf.AFrameworkApplication.ha.appSettings.WebServiceBase),dg.EwaSettings.ka(72),
dg.EwaSettings.ka(455))};td.prototype.dispose=function(){$h.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;ij.prototype.dispose.call(this)};td.la=function(G){new td(G)};Jl.Object.defineProperties(td.prototype,{Ce:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new Dh.DdaFacade(this.$,this.SBf))}}});Object(sd.a)(td,"DdaFacadeServiceFactory",oj.a,[]);kc.prototype.gd=function(){return!1};kc.prototype.$c=function(){return!1};kc.prototype.Jc=function(G,la,Ya,Fb){var lc=
!1;switch(la.command){case -684355545:lc=!0;break;case -741808261:lc=!!Ya;break;case -859308420:lc=!!Fb&&1===Fb.Wz;break;case 418618014:lc=1===G&&!!Fb&&1===Fb.Wz;break;case -515602470:la=dg.EwaSettings.ka(239)&&2===G;lc=(1===G||la)&&!!Fb&&1===Fb.Wz;break;case 2086613372:lc=dg.EwaSettings.ka(239)&&2===G&&!!Fb&&1===Fb.Wz;break;case -1336341324:lc=dg.EwaSettings.ka(509)&&1===G&&!!Fb&&1===Fb.Wz;break;case -1444574190:case -336193495:lc=1===G&&!!Fb&&1===Fb.Wz;break;case 1296389134:lc=1===G&&!!Fb&&1===
Fb.Wz;break;case 1221897806:lc=dg.EwaSettings.ka(169)&&2===G;break;case -1753056834:lc=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:lc=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertPivotTableFromPowerBI",!1)&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExternalConnectionCreate",!1);break;case 301511274:lc=dg.EwaSettings.ka(640);break;case 515196233:lc=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!1)&&this.$.isEditMode;break;case 1723441034:lc=this.$.fa.rHb}return lc};kc.prototype.executeCommand=function(G,la,Ya){var Fb=xh.TaskExtensions.um(),lc=la.command;switch(la.command){case 1296389134:this.agaveCommandManager.Mkj(Ya.SourceControlId,Ya.LabelText);break;case -684355545:this.agaveCommandManager.dUc();break;case -741808261:Fb=this.agaveCommandManager.insertAgave(Ya,la);break;case -1336341324:dg.EwaSettings.ka(509)&&(Fb=this.agaveCommandManager.CXe(Ya,G,la));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Fb=
this.agaveCommandManager.CXe(Ya,G,la);break;default:Fb=vk.a(lc)}return Fb};Object(sd.a)(kc,"AgaveCommandHandler",null,[159]);Object(sd.a)(vb,"Selection",null,[]);Object(sd.a)(Ab,"SmartLookupApplicationInterface",null,[]);Object(sd.a)(zc,"ApplicationProperties",null,[]);Object(sd.a)(ec,"EnterpriseUserInfo",null,[]);Object(sd.a)(Za,"FeatureGates",null,[]);fb.prototype.VHh=function(){var G=void 0===G?!0:G;var la=this.qxe();if(la<this.ood+this.uqj)return la>this.ood+this.xqj&&this.V7c(),this.Cdf;G&&this.V7c();
return""};fb.prototype.V7c=function(){var G=this;this.rod=this.rod||new Promise(function(la){G.WHh().then(function(Ya){G.Cdf=Ya;G.ood=G.qxe();G.rod=null;la(Ya)})})};fb.prototype.WHh=function(){var G=this;return this.E5a&&this.E5a.length?new Promise(function(la){G.gwa.vR("SmartLookup",G.E5a).then(function(Ya){Ya.IsSuccess?Ya.Token||(la(""),pe.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(pe.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Ya.ErrorCode+": "+Ya.ErrorMessage),la(""));la(Ya.Token)}).catch(function(Ya){Ya=ji.c(Ya);pe.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Ya);la("")})}):(pe.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(sd.a)(fb,"SmartLookupAuthenticationManager",null,[736]);E.Lyh=function(){switch(Object(Ci.a)(String,Jf.AFrameworkApplication.Kb.AudienceGroup)||""){case "Dogfood":if(Jf.AFrameworkApplication.ha){var G=
Jf.AFrameworkApplication.ha.Wa("UserPrincipalName");G=od.a.un(G);var la=Jf.AFrameworkApplication.ha.xy("SmartLookupINTEnabledForSKITeam")?Jf.AFrameworkApplication.ha.zx("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(la,G)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};E.yHh=function(){switch(Jf.AFrameworkApplication.ha.ta("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Jf.AFrameworkApplication.ha.ta("IntentSvcEnableProdSourceLocationOverride")?"PROD":Jf.AFrameworkApplication.ha.ta("IntentSvcEnableIntSourceLocationOverride")?
"INT":E.Lyh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(sd.a)(E,"Utils",null,[]);var ii=b(75),Ih=b(576);ia.prototype.Fth=function(){return Promise.resolve(this.Gth())};ia.prototype.Gth=function(){var G=new zc;G.anid="";G.applicationVersion=Jf.AFrameworkApplication.buildVersion;
G.appCorrelationId=gj.a.create().toString();G.themePlatform=ia.YBj;G.lcid=Jf.AFrameworkApplication.lcid;G.launchUtcTime=(new Date).toUTCString();G.featureGates=this.D5a;var la=Ih.a.pJ(Jf.AFrameworkApplication.lcid);la=la?la.name:null;G.market=this.s7b(la);G.uiLanguage=la;G.sessionId=Jf.AFrameworkApplication.userSessionId;G.themeId=0;G.parentalControl=ia.RDi;var Ya=new ec;Ya.CountryCode=this.s7b(la);Ya.ServiceEndpoint=this.E5a;Ya.IsGoLocal=!1;Ya.IsEnabled=this.$df;Ya.IsEnterpriseEnabled=this.$df;Ya.TenantRoot=
this.Vei;G.enterpriseUserInfo=Ya;G.accessToken=this.Qei.VHh();return G};ia.prototype.s7b=function(G){G=G.split("-");return G[G.length-1]};Jl.Object.defineProperties(ia.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.wei}}});ia.YBj="web";ia.RDi="yes";Object(sd.a)(ia,"SmartLookupManager",null,[718]);var Uh=Ej.a;Cm(Kb,Uh);Kb.prototype.gd=function(){return!1};Kb.prototype.$c=function(){return!1};Kb.prototype.Jc=function(G,la){G=dg.EwaSettings.ka(137);return-983891024===
la.command&&G};Kb.prototype.executeCommand=function(G,la){G=xh.TaskExtensions.um();-983891024===la.command&&this.c$h();return G};Kb.prototype.c$h=function(){var G=this,la=new ia(null),Ya={},Fb=ti.g(this.$).Cc(null).originalText;Fb=Object.assign(new vb,{neighborhood:Fb,mentionStart:0,mentionLength:Fb?Fb.length:0});var lc=Object.assign(new Ab,{selection:Fb,entryPoint:0});la.Fth().then(function(ad){ad.applicationName=Kb.appName;ad.isFirstLaunch=G.isFirstLaunch;ad.themeId=5;Ya[Kb.smartLookupApplicationInterface]=
JSON.stringify(lc);Ya[Kb.axg]=JSON.stringify(ad);G.isFirstLaunch=!1});la=new tj.a("ExcelOnline","Web","en-Us");Fb=new nh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Lc=new Fi.a;Lc.aj[De.pl]=Rf.a.instance.da(1732);Lc.aj[De.taskPaneWidth]=350;Lc.aj[De.sourceLocationOverrideResourceId]="WAC.PROD.URL";Lc.zr=Ya;mj.a.instance.wLa(Fb,"Taskpane","SmartLookupSDXTaskpane",la,Lc)};Kb.axg="AppProperties";Kb.appName="Excel";Kb.smartLookupApplicationInterface="SmartLookupApplicationInterface";
Object(sd.a)(Kb,"SmartLookupCommandHandler",Ej.a,[159]);var oi=Hi.a;Cm(Ua,oi);Ua.prototype.Rd=function(){var G=this;lj.a(this.$,374,375,this.vb,function(la){G.Hd([new kc(G.$,null,null,null,null,la),new Kb(G.$)])},"Microsoft.Office.Excel.WebUI.Client.Agave.IAgaveCommandManager")};Ua.la=function(G){Hi.a.ie(76,new Ua(G))};Object(sd.a)(Ua,"AgaveCommandHandlerFactory",Hi.a,[]);Object(sd.a)(function(){},"AppInfoDetail",null,[]);b(1063);Object(sd.a)(function(){},"AppsForOfficeUtils",null,[]);Object(sd.a)(va,
"AppsDataManager",null,[792]);var wi=b(1272),Ni=b(111);Ia.prototype.initialize=function(G){Ia.initialized||(this.Ce=G,this.Rg(),Ia.initialized=!0)};Ia.prototype.Rg=function(){Jf.AFrameworkApplication.Hb.Jf(Cd.a.Hyd,Ni.a.frame,Object(Ve.a)(this,this.Hyd,"queryEntitledAppsForOffice"),96);Jf.AFrameworkApplication.Hb.$b(Cd.a.wPi,Ni.a.frame,Object(Ve.a)(this,this.wQi,"registerOsfControlInsertedEvent"))};Ia.prototype.Hyd=function(G,la,Ya,Fb,lc){if(2===Ya){G=lc?lc:{};la=G.callback;if(!la)return 16;this.Ce.Gyd(la,
G.refresh?G.refresh:!1)}return 32};Ia.prototype.wQi=function(G,la,Ya,Fb,lc){2===Ya&&(G=lc?lc.callback:null)&&this.Ce.Nrg(G);return 32};Jl.Object.defineProperties(Ia,{instance:{configurable:!0,enumerable:!0,get:function(){Ia.Pa||(Ia.Pa=new Ia);return Ia.Pa}}});Ia.Pa=null;Ia.initialized=!1;Object(sd.a)(Ia,"AgaveCommandActor",null,[]);var jj=b(349),Bj=b(346),Fj=b(1243),nj=b(113),ck=b(337);Object(sd.a)(za,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(sd.a)(qb,"IdeasSelectionContext",null,[]);Cm(Ta,
qb);Object(sd.a)(Ta,"IdeasTableSelectionContext",qb,[]);var Sj=b(63),Di=b(154),Bi=b(583),jk=b(108),Mk=b(140),xk=b(169),Nk=Mk.a;Cm(db,Nk);db.prototype.KC=function(){Nk.prototype.KC.call(this);this.ep.style.width=this.gVd;this.ep.style.height=this.TSa;this.ep.style.marginTop=this.ANb;this.ep.style.padding=this.USa};db.prototype.MNa=function(){this.ep.style.width=this.gVd;this.ep.style.height=this.TSa;this.ep.style.marginTop=this.ANb;this.ep.style.padding=this.USa;this.zBa>xk.a.t7a?(this.Ob.style.width=
String.format("{0}px",xk.a.t7a),this.Ob.style.overflowX="scroll",Jf.AFrameworkApplication.isRtl?this.Ob.style.right="0":this.Ob.style.left="0"):(this.Ob.style.width=String.format("{0}px",this.zBa),this.Ob.style.overflowX="hidden");this.Ob.offsetHeight>xk.a.r7a||this.tbg+50>xk.a.r7a?(this.Ob.style.height=String.format("{0}px",xk.a.r7a),this.Ob.style.overflowY="scroll",this.Ob.style.top="0",Jf.AFrameworkApplication.isRtl?this.Ob.style.right="0":this.Ob.style.left="0",this.bCc||(this.Ob.style.marginTop=
"-48px"),this.ep.style.minHeight=String.format("{0}px",this.h$f)):(this.Ob.style.overflowY="hidden",this.Ob.style.top="10%",this.Ob.style.height=this.Peb);this.cYa()};db.prototype.cYa=function(){if(this.Ob){var G=this.Ob.style.zIndex;this.Ob.style.zIndex="-9999";if(this.zBa>xk.a.t7a)Jf.AFrameworkApplication.isRtl?this.Ob.style.marginRight="0":this.Ob.style.marginLeft="0";else{var la=String.format("{0}px",Math.floor(-this.Ob.offsetWidth/2));Jf.AFrameworkApplication.isRtl?this.Ob.style.marginRight=
la:this.Ob.style.marginLeft=la;Jf.AFrameworkApplication.isRtl?this.Ob.style.right="50%":this.Ob.style.left="50%"}this.Ob.style.zIndex=String(G)}else pe.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};db.prototype.CN=function(){Nk.prototype.CN.call(this);var G=document.getElementById(this.hi(this.sbg));G.style.width=String.format("{0}px",this.zBa);G.style.height=this.Peb};Jl.Object.defineProperties(db.prototype,{EGa:{configurable:!0,enumerable:!0,get:function(){return this.ep}}});
Object(sd.a)(db,"AppsForOfficeInsertionDialog",Mk.a,[789]);var kk=b(1084),Rk=Ej.a;Cm(ta,Rk);ta.prototype.Hsg=function(G){this.addHandler(ta.bvd,G)};ta.prototype.cUi=function(G){this.removeHandler(ta.bvd,G)};ta.prototype.dispose=function(){$h.a.Ia(this.Pua);this.Pua=null;Rk.prototype.dispose.call(this)};ta.prototype.dUc=function(){this.Pua.hide()};ta.prototype.Mkj=function(G,la){if(G){this.raiseEvent(ta.bvd);var Ya=G.split("|");this.Rci(G,la,Ya);this.Pua=new db;this.Pua.initializeAndShow("",null,null);
this.Ce.u$h(this.Pua.EGa,Ya)}};ta.prototype.CXe=function(G,la,Ya){var Fb=xh.TaskExtensions.um();if(-515602470===Ya.command||-336193495===Ya.command||2086613372===Ya.command||-1444574190===Ya.command||-1336341324===Ya.command)Fb=this.ANh(G,la,Ya);418618014===Ya.command&&(la=new dj.a,la.pl=Rf.a.instance.da(1743),Fb=this.O_(Ya,ta.HQh,la,!0));if((Ya.tabName===this.$.Mb+si.a.dJf||Ya.tabName===si.a.XQ)&&2===Ya.qf||-1!==Array.indexOf(["A0","A1","Help","ContactSupport","WhatsNew"],G[Mi.a.Vd])||G[Mi.a.Vd]===
si.a.bZ)return this.MXe(G,Ya);if(7===Ya.qf&&G.SourceControlId===this.$.Mb+si.a.o9b)return G.MenuItemId=si.a.Fzd,this.MXe(G,Ya);1221897806===Ya.command&&(Fb=this.pfj(Ya));-1753056834===Ya.command&&(Fb=this.wgj(Ya));932597253===Ya.command&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertPivotTableFromPowerBI",!1)&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExternalConnectionCreate",!1)&&(pe.ULS.sendTraceTag(573835101,0,50,"InsertPowerBIPivotTable - addin launch requested"),
ya.c(932597253,!0),la=new dj.a,la.pl=Rf.a.instance.da(2062),la.sourceLocationOverrideResourceId=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?ta.kHi:ta.lHi,la.focusOnIframeWhenLoaded=!0,la.taskPaneWidth=ta.h0e,Fb={},Fb.LaunchSource=Object(Ci.a)(String,G.SourceControlId),Fb.LaunchMode="Default",la.$J=Fb,Fb=this.O_(Ya,ta.jHi,la,!0));301511274===Ya.command&&(Fb=this.Ggj(Ya));515196233===Ya.command&&((la=this.$.ea.Ea(465,void 0))&&la.PZe(),la=new dj.a,la.pl=Rf.a.instance.da(2125),
Fb=new gd,Fb.V$=Qe.a.qHa,Fb=this.O_(Ya,ta.CCi,la,!0,Fb,void 0,la.pl));1723441034===Ya.command&&(la=new dj.a,la.pl=Rf.a.instance.da(2137),la.focusOnIframeWhenLoaded=!0,la.taskPaneWidth=ta.$Ji,Fb=new gd,Fb.V$=Qe.a.Qbh,Fb=this.O_(Ya,ta.ZJi,la,!0,Fb));dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&G.LoadDataFromPictureTaskpane&&(la={},Fb=new dj.a,Fb.pl="Data From Picture",Fb.sourceLocationOverrideResourceId=G.DataFromPictureURL?G.DataFromPictureURL:"",la.SessionID=
G.SessionID,Fb.$J=la,Fb.focusOnIframeWhenLoaded=!0,Fb=this.O_(Ya,G.DataFromPictureAssetId,Fb));return Fb};ta.prototype.insertAgave=function(G,la){var Ya=this,Fb=xh.TaskExtensions.um(),lc=this.$,Lc=G[Vg.a.Mkb];if("SourceControlId"in G){var ad={};var Kd=G.SourceControlId.split("|");if(8!==Kd.length||Ig.a.na(Kd[0])||Ig.a.na(Kd[1])||Ig.a.na(Kd[2])||isNaN(parseInt(Kd[2]))||Ig.a.na(Kd[3])||isNaN(parseInt(Kd[3]))||Ig.a.na(Kd[4])||Ig.a.na(Kd[5])||isNaN(parseInt(Kd[5]))||Ig.a.na(Kd[6])||Ig.a.na(Kd[7]))return xh.TaskExtensions.P3();
dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Lc={},Lc.version=ad.Version=Kd[0],Lc.assetId=ad.AssetId=Kd[1],Lc.solutionId=ad.SolutionId=Kd[1],Lc.height=ad.Height=parseInt(Kd[2]),Lc.width=ad.Width=parseInt(Kd[3]),Lc.storeId=ad.StoreId=Kd[4],Lc.targetType=ad.TargetType=parseInt(Kd[5]),Lc.assetStoreId=ad.AssetStoreId=Kd[6],Lc.storeType=ad.StoreType=Kd[7],Lc.appVersion=Kd[0],Lc.currentStoreType=Kd[7],Lc.id=Kd[1]):(Lc={},Lc.appVersion=ad.AppVersion=
Kd[0],Lc.assetId=ad.AssetId=Kd[1],Lc.id=ad.Id=Kd[1],Lc.height=ad.Height=parseInt(Kd[2]),Lc.width=ad.Width=parseInt(Kd[3]),Lc.storeId=ad.StoreId=Kd[4],Lc.targetType=ad.TargetType=parseInt(Kd[5]),Lc.assetStoreId=ad.AssetStoreId=Kd[6],Lc.currentStoreType=ad.CurrentStoreType=Kd[7])}else ad=G[Mi.a.Mj];Kd=null;gd.key in G&&(Kd=G[gd.key]);this.Pua&&this.Pua.hide();if(!ad||!Lc)return pe.ULS.sendTraceTag(593605401,220,10,"Inserting addin needs inserted agave parameters"),Fb;this.$.q4&&si.a.Yab in G&&(ad.EnabledInViewMode=
G[si.a.Yab]);G=this.bwh(la.command);if(!ad.EnabledInViewMode&&!lc.qt(null,!1,G))return Fb;dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(ad.AssetId===ta.V5f||ad.SolutionId===ta.W5f)&&(Fb=this.$.ea.Ea(271,void 0))&&Fb.Lge():(ad.AssetId===ta.V5f||ad.AssetId===ta.W5f)&&(Fb=this.$.ea.Ea(271,void 0))&&Fb.Lge();var ue=void 0===ad.IsToBePersisted||null===ad.IsToBePersisted||ad.IsToBePersisted?0:16;if(1===ad.TargetType)Fb=this.yXh(ad,Lc,la,Kd,ue);
else{Kd=ti.g(lc);Lc=this.viewBlockContainerHelpers.zcb(Kd);var af=lc.fa.isNamedObjectViewMode?lc.sa.sheetName:lc.sa.name;if(Lc){Kd=Lc.Sg;var Xe=Kd.mg.top;var pg=Kd.mg.left;var sg=Lc.cI.x;var lh=Lc.cI.y}else Xe=pg=1,Lc=this.viewBlockContainerHelpers.$Ia(Kd),sg=Lc.x,lh=Lc.y;var Jh=this.$.ra.xa.dc();Lc=function(th,Pi,Oh){var pi=lc.ra.xa,Ri=ad,Zj=Xe,Gj=pg,Wj=sg,Hj=lh;th=ci.b(th,Object(Ve.a)(Ya,Ya.aHi,"postInsertWebExtensionSuccess"));var ek=pi.Ra(9,Jh);ek.sharedInfo=Ri;ek.sheetName=af;ek.positionRow=
Zj;ek.positionCol=Gj;ek.positionOffsetX=Wj;ek.positionOffsetY=Hj;return Vi.i(pi,"InsertWebExtension",ek,th,Pi,Oh,null,0)};dg.EwaSettings.wc()?(ue|=64,Fb=Pj.a(this.$.userOperationManager,Lc,function(th){return new Oj.a(534,0,th,ue)},la)):Fb=Pj.a(this.$.userOperationManager,Lc,function(th){return new sj.a(534,0,th,ue)},la)}return Fb};ta.prototype.sPg=function(){var G=ei.a.instance.yc("Common.App.ICustomerFeedbackUiWrapper"),la=ei.a.instance.yc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.j5c?this.j5c.tgb?this.moe():la.instance.y1c(Object(Ve.a)(this,this.okh,"feedbackDownloaded")):pe.ULS.sendTraceTag(593605400,1302,15,"feedbackFormManager is undefined");la={};Jf.AFrameworkApplication.ha.zde(la);G=G.instance.getContext(la);la={};"telemetryGroup"in G&&(la=G.telemetryGroup);la.processSessionId=G.sessionId;la.officeBuild=G.build;G.telemetryGroup=la;G.feedbackType=-1;G.userVoiceEnabled=!1;"disableIncludeScreenshot"in G||(G.disableIncludeScreenshot=!1);"screenshot"in G||(G.screenshot=
!1);G.disableScreenshotPreview=!1;G.includeScreenshotSelectedDefault=!0;return G};ta.prototype.xHi=function(G){if(!this.S7a&&dg.EwaSettings.ka(761)&&dg.EwaSettings.getBooleanFeatureGate(ta.wSh,!1)){var la=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";la=this.Yle(la);var Ya=new gd;Ya.Rj=Qe.a.g4c;this.S7a=this.kFd(la,null,!1,null,Ya);dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?
(la={},jk.b(this.$).Jd(rd.a.Gxf,(la.Location=jj.a[G.qf],la.InputMethod=Bj.a[G.method],la),void 0,!0)):jk.b(this.$).Jd(rd.a.Gxf,{},void 0,!0)}};ta.prototype.bOf=function(G){var la=this.$.fa.gh.get(17);ei.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ya){Ya.isFeatureEnabled("mso_sendASmile",la).then(function(Fb){G.FeedbackEnabled=la&&Fb;return null})})};ta.prototype.pfj=function(G){var la=ti.g(this.$),Ya=new dj.a,Fb={ActiveTab:"Format"};Fb.DatapaneFlighting=
dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Fb.AceFlighting=!0;Fb.ChartNewSDXRecording=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Fb.ThemeColorsFlighting=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");this.bOf(Fb);Fb.startTimeMs=Date.now();Fb.UserSessionId=this.$.Ba.UserSessionId;
(la=la.ga.Sa.fr)&&(Fb.SubSelection=la);pe.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",Fb.UserSessionId,void 0===G.qf||null===G.qf?"Null":jj.a[G.qf],la?la:"ChartRoot");Ya.$J=Fb;Ya.pl=Rf.a.instance.da(931);Fb=new gd;Fb.V$=Qe.a.qHa;return this.O_(G,ta.uJg,Ya,!0,Fb)};ta.prototype.wgj=function(G){var la=new dj.a;la.$J={};la.pl=Rf.a.instance.da(1731);la.MQa=ta.Xaf;var Ya=new gd;Ya.V$=Qe.a.qHa;return this.O_(G,ta.Xaf,la,!0,Ya,void 0,
la.pl)};ta.prototype.Ggj=function(G){var la=new dj.a;la.$J={};la.pl=Rf.a.instance.da(2086);var Ya=new gd;Ya.V$=Qe.a.qHa;return this.O_(G,ta.aki,la,!0,Ya)};ta.prototype.MXe=function(G,la){var Ya=ta.HZe,Fb=G[Mi.a.Vd].toString(),lc={},Lc=new dj.a;Lc.pl=Rf.a.instance.da(9);switch(Fb){case "A0":lc.query=(G[Mi.a.Mj]||"").split("|").slice(2,ck.a.PW).join("|");break;case "A1":lc.query=G.CommandValueId;break;case "Help":lc.gwdropdownflightinfo=dg.EwaSettings.ka(244);lc.query="";break;case si.a.Fzd:dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(Lc.pl=Rf.a.instance.da(1697),Lc.sourceLocationOverrideResourceId=ta.uWe,lc.feedback=this.sPg()):lc.query=Fb;break;case "HelpArticle":lc.query=G[Mi.a.Mj];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":lc.query=Fb;break;default:return Aj.Task.Ua(!0)}Lc.$J=lc;Fb=new gd;Fb.V$=Qe.a.qHa;return this.O_(la,Ya,Lc,!1,Fb,G[si.a.Yab]||!1)};ta.prototype.Yle=function(G){var la={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(la.Version=
"0.0.0.0",la.AssetId=ta.baa,la.SolutionId=ta.baa,la.AssetStoreId="",la.StoreType=OSF.StoreType.Sdx,la.Height=0,la.Width=0,la.StoreId=OSF.StoreType.Sdx,la.TargetType=OSF.OsfControlTarget.TaskPane,la.IsToBePersisted=!1,la.SourceLocationOverrideResourceId=G,la.SharedRuntimeId=G,la.Id=ta.baa,la.CurrentStoreType=OSF.StoreType.Sdx,la.AppVersion="0.0.0.0"):(la.AppVersion="0.0.0.0",la.AssetId=ta.baa,la.Id=ta.baa,la.AssetStoreId="",la.CurrentStoreType=OSF.StoreType.Sdx,la.Height=0,la.Width=0,la.StoreId=OSF.StoreType.Sdx,
la.TargetType=OSF.OsfControlTarget.TaskPane,la.IsToBePersisted=!1,la.SourceLocationOverrideResourceId=G,la.SharedRuntimeId=G);return la};ta.prototype.ANh=function(G,la,Ya){var Fb=this,lc=new dj.a,Lc=new gd,ad={};this.bOf(ad);ad.LaunchSource="";ad.StartTimeMs=Date.now();ad.CorrelationId=gj.a.create().toString();lc.$J=ad;lc.focusOnIframeWhenLoaded=!0;lc.taskPaneWidth=ta.h0e;Lc.V$=Qe.a.mdh;Lc.Buc=Qe.a.lFe;switch(Ya.command){case -1444574190:var Kd,ue;ad.LaunchMode="RecommendedPivotTables";ad.SelectionContext=
"";ad.LaunchSource="PivotTableHandRaise"===Object(Ci.a)(String,G.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&!Ig.a.na(G.SourceSelection)){var af=G.SourceSelection.split(",")[0];la=dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var sg=yj.Y(af,Fb.$.Aa);Kd=sg.sheetName;ue=sg.sDb;Xe=sg.range;return sg}().returnValue&&!ti.g(this.$).kc.Caa(Xe))G=
this.$.Aa.getItemByName(Kd),ad.SelectionContext=JSON.stringify(Object.assign(new qb,{address:ue,addressWithSheet:Kd+"!"+Xe.GG(!1),sheetId:Sj.d(G),sheetName:Kd,isSheetEmpty:!1,columnCount:Xe.width,rowCount:Xe.height,columnIndex:Xe.left+la,rowIndex:Xe.top+la,selectionType:"Continuous"}));else if((G=this.$.Ab.getItemByName(Object(Ci.a)(String,G.SourceSelection)))&&Sj.o(G)){var Xe=Di.a(G,!0);var pg=this.$.Aa.getItemByName(G.sheetName);ad.SelectionContext=JSON.stringify(Object.assign(new Ta,{tableName:G.name,
hasTableHeaders:Di.d(G),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Xe.GG(!1),addressWithSheet:pg.name+"!"+Xe.GG(!1),sheetId:Sj.d(pg),sheetName:pg.name,isSheetEmpty:!1,columnCount:Xe.width,rowCount:Xe.height,columnIndex:Xe.left+la,rowIndex:Xe.top+la,selectionType:"Continuous"}))}}dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?lc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":lc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";
lc.pl=Rf.a.instance.da(1741);lc.Rj=Qe.a.EHe;Lc.Rj=Qe.a.EHe;break;case -336193495:ad.LaunchMode="RecommendedCharts";dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?lc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":lc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";lc.pl=Rf.a.instance.da(1740);lc.Rj=Qe.a.FHe;Lc.Rj=Qe.a.FHe;break;case -1336341324:if(!dg.EwaSettings.ka(509))return Aj.Task.Ua(!1);ad.LaunchMode="NL";dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?lc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":lc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(dg.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:lc.pl=Rf.a.instance.da(1745);ad.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:lc.pl=Rf.a.instance.da(1746);ad.NLLaunchModeBrandingCandidatesIndex=2;break;default:lc.pl=Rf.a.instance.da(1744),ad.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!dg.EwaSettings.ka(239))return Aj.Task.Ua(!1);
ad.LaunchMode="ChartDesigner";ad.LaunchSelectionMode=la.toString();dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?lc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":lc.sourceLocationOverrideResourceId="Insights.Https.Bundle";lc.pl=Rf.a.instance.da(1747);break;default:ad.LaunchMode="Default",dg.EwaSettings.ka(239)&&(ad.LaunchSelectionMode=la.toString()),dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?lc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":lc.sourceLocationOverrideResourceId="Insights.Https.Bundle",lc.pl=Rf.a.instance.da(1742),lc.Rj=Qe.a.g4c,Lc.Rj=Qe.a.g4c}return dg.EwaSettings.ka(761)?(dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?lc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":lc.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.S7a?this.S7a.CWR(function(){return Fb.dMf(ad,lc)}):this.MVh(Ya,lc,Lc,ad)):this.O_(Ya,ta.baa,lc,!0,Lc)};ta.prototype.MVh=
function(G,la,Ya,Fb){var lc=this,Lc=this.Yle(la.sourceLocationOverrideResourceId);this.S7a=this.kFd(Lc,la,!1,G,Ya,!1);return this.S7a.CWR(function(){return lc.dMf(Fb,la)})};ta.prototype.dMf=function(G,la){var Ya=this.Ce.r3(this.Ce.$ha(ta.baa,la.sourceLocationOverrideResourceId));if(Ya){this.J$a[ta.baa]=G;var Fb=this.mgc(this.Ce.fU(Ya).OsfPropertyBag,ta.baa);this.Ce.fU(Ya).OsfPropertyBag=Fb}this.wLa(ta.baa,"LaunchIdeasAction",G,la);return Aj.Task.Ua(!0)};ta.prototype.SOh=function(G,la,Ya,Fb,lc){if(2!==
Ya)return 32;G=lc[kk.a.L4b];Ya=lc[kk.a.DFa];lc=lc[kk.a.qxa];la=new dj.a;la.CXh=lc.aj.InstanceToken;la.pl=lc.aj[De.pl];la.MQa=lc.aj[De.MQa];De.taskPaneWidth in lc.aj&&(la.taskPaneWidth=lc.aj[De.taskPaneWidth]);la.sourceLocationOverrideResourceId=lc.aj[De.sourceLocationOverrideResourceId];la.$J=lc.zr;la.onTaskPaneClose=lc.aj[De.onTaskPaneClose];la.DFa=Ya;Ya=new hj.a(-859308420,0,2,0,"");Fb=G.getStoreType()===OSF.StoreType.Sdx;var Lc=new gd,ad=lc.aj.HeaderCssClass;Lc.V$=ad?ad:Qe.a.qHa;Lc.Buc=lc.aj.TitleCssClass;
this.O_(Ya,G.getId(),la,Fb,Lc);return 32};ta.prototype.COh=function(G,la,Ya,Fb,lc){if(2!==Ya)return 32;G=lc[kk.a.L4b].getId();lc=lc[kk.a.qxa].aj[De.sourceLocationOverrideResourceId];return G?(this.Ce.Ah.refreshOsfControl(G,lc),32):8};ta.prototype.O_=function(G,la,Ya,Fb,lc,Lc,ad){Ya=void 0===Ya?null:Ya;Fb=void 0===Fb?!1:Fb;lc=void 0===lc?null:lc;Lc=void 0===Lc?!1:Lc;ad=void 0===ad?null:ad;xh.TaskExtensions.um();Ya||(Ya=new dj.a);var Kd={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(Kd.Version="0.0.0.0",Kd.AssetId=la,Kd.SolutionId=la,Kd.AssetStoreId="",Kd.StoreType=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Kd.Height=0,Kd.Width=0,Kd.StoreId=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Kd.TargetType=OSF.OsfControlTarget.TaskPane,Kd.IsToBePersisted=!1,Kd.SourceLocationOverrideResourceId=Ya.sourceLocationOverrideResourceId,Kd.AppVersion="0.0.0.0",Kd.Id=la,Kd.CurrentStoreType=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty):(Kd.AppVersion="0.0.0.0",Kd.AssetId=la,Kd.Id=la,
Kd.AssetStoreId="",Kd.CurrentStoreType=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Kd.Height=0,Kd.Width=0,Kd.StoreId=Fb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,Kd.TargetType=OSF.OsfControlTarget.TaskPane,Kd.IsToBePersisted=!1,Kd.SourceLocationOverrideResourceId=Ya.sourceLocationOverrideResourceId);if(Ya.pl||ad)this.E5b[la]=Object.assign(new za,{auc:Ya.pl,rNd:ad,sNd:Ya.MQa});dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)?(Ya.$J||(Ya.$J={}),Ya.$J.ShowFeedback=this.$.isFeedbackEnabled,this.J$a[la]=Ya.$J):Ya.$J&&(this.J$a[la]=Ya.$J);la={};la[Mi.a.Mj]=Kd;ad={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(ad.id=Kd.Id,ad.solutionId=Kd.SolutionId,ad.version=Kd.Version,ad.storeType=Kd.StoreType,ad.storeId=Kd.StoreId,ad.assetId=Kd.AssetId,ad.assetStoreId=Kd.AssetStoreId,ad.height=Kd.Height,ad.targetType=Kd.TargetType,ad.width=Kd.Width,ad.isAddinCommands=!Fb,ad.appVersion=
Kd.AppVersion,ad.currentStoreType=Kd.CurrentStoreType):(ad.appVersion=Kd.AppVersion,ad.assetId=Kd.AssetId,ad.assetStoreId=Kd.AssetStoreId,ad.currentStoreType=Kd.CurrentStoreType,ad.height=Kd.Height,ad.id=Kd.Id,ad.storeId=Kd.StoreId,ad.targetType=Kd.TargetType,ad.width=Kd.Width,ad.isAddinCommands=!Fb);la[Vg.a.Mkb]=ad;lc||(lc=new gd);lc.focusOnIframeWhenLoaded=Ya.focusOnIframeWhenLoaded;lc.width=Ya.taskPaneWidth;la[gd.key]=lc;la[si.a.Yab]=Lc;return this.insertAgave(la,G)};ta.prototype.yXh=function(G,
la,Ya,Fb,lc){function Lc(Xe){dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pe.ULS.sendTraceTag(542185171,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(Xe.storeType,Xe.storeId,Xe.solutionId),Xe.storeType):pe.ULS.sendTraceTag(537968906,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(Xe.currentStoreType,Xe.storeId,Xe.assetId),Xe.currentStoreType);var pg={},sg=new wg.a;sg.add(Xe);
pg[Vg.a.rWa]=sg;pg[Vg.a.EO]=3;Xe=new hj.a(Cd.a.Qxb,0,Kd.$.jd,0,null);return Kd.$.Na.Xb(Xe,pg)}function ad(Xe,pg){if(dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){var sg=Xe.SolutionId;var lh=Xe.StoreType;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(lh)&&Xe.SourceLocationOverrideResourceId&&(sg=Kd.Ce.$ha(sg,Xe.SourceLocationOverrideResourceId)):lh!==OSF.StoreType.FirstParty&&
lh!==OSF.StoreType.Sdx||!Xe.SourceLocationOverrideResourceId||(sg=Kd.Ce.$ha(sg,Xe.SourceLocationOverrideResourceId))}else sg=Xe.Id,lh=Xe.CurrentStoreType,dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Xe.CurrentStoreType)&&Xe.SourceLocationOverrideResourceId&&(sg=Kd.Ce.$ha(sg,Xe.SourceLocationOverrideResourceId)):Xe.CurrentStoreType!==OSF.StoreType.FirstParty&&Xe.CurrentStoreType!==OSF.StoreType.Sdx||!Xe.SourceLocationOverrideResourceId||
(sg=Kd.Ce.$ha(sg,Xe.SourceLocationOverrideResourceId));var Jh=Kd.Ce.iVc(sg,null,Xe.SharedRuntimeId);if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(lh):lh===OSF.StoreType.FirstParty||lh===OSF.StoreType.Sdx)dg.EwaSettings.ka(304)&&Jh&&(lh=Kd.Ce.r3(sg))&&(sg=null,sg=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Kd.mgc(Kd.Ce.fU(lh).OsfPropertyBag,Xe.SolutionId):Kd.mgc(Kd.Ce.fU(lh).OsfPropertyBag,
Xe.AssetId),(lh=Kd.Ce.Ah.getOsfControl(lh))&&lh.setSettings(sg)),Xe.SharedRuntimeId&&Jh||(dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Kd.Ce.Ah.refreshOsfControl(Xe.SolutionId,Xe.SourceLocationOverrideResourceId):Kd.Ce.Ah.refreshOsfControl(Xe.Id,Xe.SourceLocationOverrideResourceId));if(!Jh){var th=Kd.$.ra.xa.dc(),Pi=519;Jh=function(Oh,pi,Ri){var Zj=Kd.$.ra.xa;Oh=ci.b(Oh,Object(Ve.a)(Kd,Kd.mxf,"postInsertAgaveTaskpaneSuccess"));var Gj=Zj.Ra(9,
th);Gj.sharedInfo=Xe;return Vi.i(Zj,"InsertAgaveTaskpane",Gj,Oh,pi,Ri,Fb,0)};void 0===Xe.IsToBePersisted||null===Xe.IsToBePersisted||Xe.IsToBePersisted||(Pi=538,Jh=function(Oh,pi,Ri){dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pe.ULS.sendTraceTag(542185172,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Xe.StoreType,Xe.StoreId,Telemetry.PrivacyRules.GetAssetId(Xe.StoreType,Xe.StoreId,Xe.SolutionId)):
pe.ULS.sendTraceTag(539305360,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Xe.CurrentStoreType,Xe.StoreId,Telemetry.PrivacyRules.GetAssetId(Xe.CurrentStoreType,Xe.StoreId,Xe.AssetId));var Zj=Kd.$.ra.xa;Oh=ci.b(Oh,Object(Ve.a)(Kd,Kd.mxf,"postInsertAgaveTaskpaneSuccess"));var Gj=Zj.Ra(9,void 0===th?null:th);Gj.sharedInfo=Xe;return Vi.i(Zj,"ShowAgaveTaskpane",Gj,Oh,pi,Ri,Fb,0)});return dg.EwaSettings.wc()?(lc|=64,Pj.a(Kd.$.userOperationManager,Jh,function(Oh){return new Oj.a(Pi,
0,Oh,lc)},pg)):Pj.a(Kd.$.userOperationManager,Jh,function(Oh){return new sj.a(Pi,0,Oh,lc)},pg)}return xh.TaskExtensions.P3()}var Kd=this;if(!dg.EwaSettings.ka(54)||G.StoreId===OSF.StoreType.FirstParty)return ad(G,Ya,Fb);if(la.isAddinCommands)return Lc(la);var ue=new eh.a,af={};dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(af.marketplaceId=G.SolutionId,af.marketplaceVersion=G.Version,af.storeType=G.StoreType):(af.marketplaceId=G.Id,af.marketplaceVersion=
G.AppVersion,af.storeType=G.CurrentStoreType);af.storeId=G.StoreId;af.targetData=G;dg.EwaSettings.ka(94)&&(af.clearCache=!0);this.Ce.Ah.isAddinCommandsAsync(af,function(Xe,pg,sg){ue.setResult(pg);Xe||(Xe=sg.targetData,dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?pe.ULS.sendTraceTag(542185170,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(Xe.StoreType,Xe.StoreId,Xe.SolutionId),
Xe.StoreType):pe.ULS.sendTraceTag(539305359,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(Xe.CurrentStoreType,Xe.StoreId,Xe.Id),Xe.CurrentStoreType))});return xh.TaskExtensions.ts(ue.task,function(Xe){return Xe.result?Lc(la):ad(G,Ya,Fb)},this.$.ma)};ta.prototype.aHi=function(G){G=G.Result;G=null===G?null:G.SolutionId;Ig.a.na(G)||(this.Ce.gde(G),nk.a(this.$).Rla(3,G))};ta.prototype.mgc=function(G,la){if(!this.J$a[la])return G;var Ya=
{};if(G){G=Ml(G);for(var Fb=G.next();!Fb.done;Fb=G.next())Fb=Fb.value,Ya[Fb[0]]=Fb[1]}G=this.J$a[la];Fb=Ml(Object.keys(G));for(la=Fb.next();!la.done;la=Fb.next())la=la.value,la===ta.qkh&&dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Ya[la]=Sys.Serialization.JavaScriptSerializer.serialize(G[la]):Ya[la]=Sys.Serialization.JavaScriptSerializer.serialize(G[la].toString());la=Object.keys(Ya).length;G=Array(la);Fb=0;var lc=Ml(Object.keys(Ya));for(la=
lc.next();!la.done;la=lc.next())la=la.value,G[Fb]=[la,Ya[la].toString()],Fb++;return G};ta.prototype.mxf=function(G,la){var Ya=(G=G.Result)?G.AgaveData:null;if(Ya){pe.ULS.shipAssertTag(593605393,0,Ya.TaskpaneWidth===ta.r0g,"Taskpane width is {0}, assetId is {1}.",Ya.TaskpaneWidth,Ya.PrimaryMarketplace.SolutionId);var Fb=this.E5b[Ya.PrimaryMarketplace.SolutionId];Fb&&(Fb.auc&&(Ya.TaskpaneTitle=Fb.auc),Fb.sNd&&(Ya.TaskpaneIconId=Fb.sNd),Fb.rNd&&(Ya.TaskpaneButtonTooltip=Fb.rNd),0<Fb.jr&&(Ya.TaskpaneWidth=
Fb.jr));la&&(Ya.FocusOnIframeWhenLoaded=la.focusOnIframeWhenLoaded,la.width&&(Ya.TaskpaneWidth=la.width),Ya.TaskpaneIconCssClass=la.Rj,Ya.TaskpaneHeaderCssClass=la.V$,Ya.TaskpaneTitleCssClass=la.Buc);this.J$a[Ya.PrimaryMarketplace.SolutionId]&&(Ya.OsfPropertyBag=this.mgc(Ya.OsfPropertyBag,Ya.PrimaryMarketplace.SolutionId));Bi.a(Ya)||(Ya.WebExtensionOsfControlType=1);Ya&&(this.Ce.gde(G.SolutionId),this.Ce.YYa(Ya))}else pe.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};
ta.prototype.Rci=function(G,la,Ya){var Fb=this.$.Ba.UserSessionId,lc=this.$.Ba.UICultureTag,Lc=this.$.Ba.UICultureTagLcid,ad=this.$.Ba.WacHostId,Kd="",ue="";5<=Ya.length&&(Kd=Ya[3],ue=Ya[4]);this.Sci(Kd,ue,G,la,lc,Lc,Fb,ad)};ta.prototype.Sci=function(G,la,Ya,Fb,lc,Lc,ad,Kd){var ue={};ue.a=ad;ue.b=Ya;ue.c=Fb;ue.d=G;ue.e=la;ue.f=lc;ue.g=Lc;ue.h=Kd;yk.b().Se(36,ue)};ta.prototype.moe=function(){if(Fj.a.Rif())pe.ULS.sendTraceTag(593605392,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(Ve.a)(this,
this.oxf,"postScreenshotData"));return}catch(G){pe.ULS.sendTraceTag(593605391,1302,15,"Failed to use createScreenshot "+(G?G.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(Ve.a)(this,this.oxf,"postScreenshotData"))}catch(G){pe.ULS.sendTraceTag(593605390,1302,15,"Failed to use html2canvas"+(G?G.toString():null))}}};ta.prototype.okh=function(G){G&&(this.j5c.b$e(G),this.moe())};ta.prototype.oxf=function(G){G=G.toDataURL("image/jpeg");var la=this.Ce.r3(ta.HZe+
"."+ta.uWe);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(la,"onScreenshot",{screenshot:G},function(){})};ta.prototype.kFd=function(G,la,Ya,Fb,lc,Lc){la=void 0===la?null:la;Ya=void 0===Ya?!1:Ya;Fb=void 0===Fb?null:Fb;lc=void 0===lc?null:lc;Lc=void 0===Lc?!0:Lc;var ad=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?G.SolutionId:G.AssetId,Kd=Aj.Task.Ua(!1);!G||Ig.a.na(ad)||Ig.a.na(G.SharedRuntimeId)||(Fb=Fb?Fb:new hj.a(-859308420,0,2,
0,""),ad={},dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(ad.id=G.Id,ad.solutionId=G.SolutionId,ad.version=G.Version,ad.storeType=G.StoreType,ad.storeId=G.StoreId,ad.assetId=G.AssetId,ad.assetStoreId=G.AssetStoreId,ad.height=G.Height,ad.targetType=G.TargetType,ad.width=0,ad.isAddinCommands=!1,ad.sharedRuntimeId=G.SharedRuntimeId,G.Preload=Lc,ad.appVersion=G.AppVersion,ad.currentStoreType=G.CurrentStoreType):(ad.appVersion=G.AppVersion,ad.assetId=
G.AssetId,ad.assetStoreId=G.AssetStoreId,ad.currentStoreType=G.CurrentStoreType,ad.height=G.Height,ad.id=G.Id,ad.storeId=G.StoreId,ad.targetType=G.TargetType,ad.width=0,ad.isAddinCommands=!1,ad.sharedRuntimeId=G.SharedRuntimeId,G.Preload=Lc),lc=lc?lc:new gd,lc.width=0,la&&(lc.focusOnIframeWhenLoaded=la.focusOnIframeWhenLoaded,Lc=new za,la.pl&&(Lc.auc=la.pl),0<la.taskPaneWidth&&(Lc.jr=la.taskPaneWidth),dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?this.E5b[G.SolutionId]=Lc:this.E5b[G.AssetId]=Lc),la={},la[Mi.a.Mj]=G,la[Vg.a.Mkb]=ad,la[gd.key]=lc,la[si.a.Yab]=Ya,Kd=this.insertAgave(la,Fb));return Kd};ta.prototype.wLa=function(G,la,Ya,Fb){Fb=void 0===Fb?null:Fb;if(!Ig.a.na(G)&&!Ig.a.na(la)){G=new nh.a(G,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var lc=new tj.a("ExcelOnline","Web",this.$.Ba.UICultureTag),Lc=new Fi.a;Lc.aj[De.BNc]=Ya;Fb&&(Ya=Fb,Ig.a.na(Ya.sourceLocationOverrideResourceId)||(Lc.aj[De.sourceLocationOverrideResourceId]=Ya.sourceLocationOverrideResourceId),
Ig.a.na(Ya.pl)||(Lc.aj[De.pl]=Ya.pl),Ig.a.na(Ya.Rj)||(Lc.aj.IconCssClass=Ya.Rj),Ig.a.na(Ya.mNd)||(Lc.aj.TaskPaneIconUrl=Ya.mNd),Ig.a.na(Ya.MQa)||(Lc.aj.TaskPaneIconId=Ya.MQa));mj.a.instance.wLa(G,zk.a.action,la,lc,Lc)}};ta.prototype.gNh=function(G,la,Ya,Fb,lc){if(2!==Ya)return 32;if(nj.a.na(lc)||lc[kk.a.Bse]!==zk.a.action)return 8;G=lc[kk.a.qxa];if(!G)return 8;la=(la=this.jEh(lc))?this.Ce.r3(la):null;return Ig.a.na(la)?8:(lc=this.Ce.CRg(lc[kk.a.DFa],G.aj[De.BNc]),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&
(Ya=this.Ce.fU(la),Ya.TaskpaneTitle!==G.aj[De.pl]&&(Ya.TaskpaneTitle=G.aj[De.pl],Ya.TaskpaneIconCssClass=G.aj.IconCssClass,Ya.TaskpaneIconUrl=G.aj.TaskPaneIconUrl,Ya.TaskpaneIconId=G.aj.TaskPaneIconId,G=this.Ce.Ah.getOsfControl(la),this.Ce.Ah.raiseOsfControlStatusChange(G))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(la,lc,Object(Ve.a)(this,this.jGb,"sendActionToAddin")),32)};ta.prototype.jGb=function(G,la){this.Ce.Umh(G,la)};ta.prototype.jEh=function(G){if(!nj.a.na(G)){var la=
G[kk.a.L4b];if(la&&(la=la.getId(),G=G[kk.a.qxa],!Ig.a.na(la)&&G))return this.$ha(la,G.aj[De.sourceLocationOverrideResourceId])}return null};ta.prototype.$ha=function(G,la){la=void 0===la?null:la;return Ig.a.na(G)||Ig.a.na(la)?G:String.format("{0}.{1}",G,la)};ta.prototype.bwh=function(G){switch(G){case 1221897806:return 2;case -515602470:case 2086613372:return dg.EwaSettings.ka(239)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};ta.wSh=
"Microsoft.Office.Excel.IdeasXLOPreload";ta.bvd="IDS";ta.HZe="FA000000012";ta.baa="FA000000005";ta.HQh="HelloWorld";ta.uJg="FA000000014";ta.uWe="Help.GiveFeedback.Url";ta.qkh="feedback";ta.Xaf="FA000000066";ta.lHi="PowerBi.Url";ta.kHi="PowerBi.DevUrl";ta.jHi="FA000000054";ta.aki="FA000000064";ta.CCi="FA000000075";ta.ZJi="FA000000080";ta.V5f="WA200002680";ta.W5f="a048b5e5-dc67-4812-b114-0969772a09ec";ta.r0g=350;ta.h0e=320;ta.$Ji=320;Object(sd.a)(ta,"AgaveCommandManager",Ej.a,[807,808]);Jl.Object.defineProperties(ua,
{instance:{configurable:!0,enumerable:!0,get:function(){return ua.Pa}}});ua.Pa=new ua;Object(sd.a)(ua,"AppsDataManagerFactory",null,[]);Object(sd.a)(function(G,la){this.httpStatus=G;this.data=la},"AppData",null,[]);Ra.prototype.hvb=function(G){this.z9f(this.B9f,G)};Ra.prototype.jW=function(G,la,Ya,Fb){G?(la={},pe.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(la.dataType=G,la))):this.yb&&this.Ug&&la?this.Ug.Wl(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",
this.yb.appSettings.WebServiceBase,Jf.AFrameworkApplication.lcid,la),1,"",null,!0,2,Ya,Fb,null):pe.ULS.sendTraceTag(6070476,344,10,"The request objects are not available")};Object(sd.a)(Ra,"AppsDataProvider",null,[791]);var lk=oj.a;Cm(ca,lk);ca.prototype.create=function(){var G=this,la=this.$.ea,Ya=Xi.GetServiceTaskFactory.create(la,106,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Fb=Xi.GetServiceTaskFactory.create(la,104,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IViewBlockContainerHelpers"),
lc=$f.a.loadScript(36,0,this.vb,void 0,void 0,375);xh.TaskExtensions.Da(xh.TaskExtensions.Fe([Fb,Ya,lc],this.ma),function(){var Lc=new Wb.a(Ec.a.instance),ad=new Ra(Jf.AFrameworkApplication.ha,Jf.AFrameworkApplication.Md,"WAC_Excel");new va(Lc,ad,"PreinstalledAppsData_Excel");Lc=null;dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Lc=ei.a.instance.yc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Ia.instance.initialize(Ya.result);
Lc=new ta(G.$,Ya.result,Fb.result,Lc,Jf.AFrameworkApplication.Hb);la.La(206,Lc);G.Jb(la.Ea(374,void 0)||la.La(374,Lc))},this.ma,3);ei.a.instance.register(wi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ac().Lc(function(){return new wi.a(G.$.yy)})};ca.la=function(G){G.ea.La(375,new ca(G))};Object(sd.a)(ca,"AgaveCommandManagerFactory",oj.a,[]);var Ii=b(841);Ha.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};Ha.prototype.invokePropertyGet=function(G){switch(G){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ha.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ha.prototype.invokePropertySet=function(G,la){switch(G){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ha.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ha.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};Ha.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ha.jUg=function(G){var la=new Ha;la.displayName=G.displayName;la.email=G.email;switch(G.authority){case Ad.quf:la.identityType=1;break;default:la.identityType=0}la.federationProvider="";return la};Jl.Object.defineProperties(Ha.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.iea},set:function(G){this.iea=G}},email:{configurable:!0,
enumerable:!0,get:function(){return this.BYd},set:function(G){this.BYd=G}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.fZd},set:function(G){this.fZd=G}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Ufb},set:function(G){this.Ufb=G}}});Object(sd.a)(Ha,"OfficeIdentityInfo",null,[]);Gb.G7b=function(G){return G in Gb.CDe?Gb.CDe[G].toString():G};Jl.Object.defineProperties(Gb,{CDe:{configurable:!0,enumerable:!0,get:function(){return Gb.Pbg}}});Gb.map=
null;var Tj={};Gb.Pbg=(Tj.GeneralException=Ii.a.generalException,Tj.AccessDenied=Ii.a.xNc,Tj.ApiNotAvailable=Ii.a.apiNotAvailable,Tj.UserNotSignedIn=Ii.a.userNotSignedIn,Tj.UserAborted=Ii.a.userAborted,Tj.UnsupportedUserIdentity=Ii.a.nvj,Tj.InvalidResourceUrl=Ii.a.invalidResourceUrl,Tj.InvalidGrant=Ii.a.invalidGrant,Tj.AddinIsAlreadyRequestingToken=Ii.a.kvg,Tj.ResourceNotAllowed=Ii.a.uZi,Tj.ClientError=Ii.a.clientError,Tj.ServerError=Ii.a.serverError,Tj);Object(sd.a)(Gb,"SingleSignOnErrorCodeMap",
null,[]);nb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};nb.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};nb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};nb.prototype.invokePropertySet=function(G,la){switch(G){case 2:this.accessToken=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};nb.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};nb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};nb.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Jl.Object.defineProperties(nb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.mdb},set:function(G){this.mdb=G}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Ufb},set:function(G){this.Ufb=G}}});Object(sd.a)(nb,"SingleSignOnToken",null,[]);sb.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};
sb.prototype.invokePropertyGet=function(G){switch(G){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};sb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};sb.prototype.invokePropertySet=function(G,la){switch(G){case 3:this.authChallenge=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"string");return;case 6:this.silentLogin=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};sb.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};sb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};sb.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
Jl.Object.defineProperties(sb.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.OUd},set:function(G){this.OUd=G}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.YR},set:function(G){this.YR=G}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.YRb},set:function(G){this.YRb=G}},scope:{configurable:!0,enumerable:!0,get:function(){return this.E8d},
set:function(G){this.E8d=G}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.M9d},set:function(G){this.M9d=G}}});Object(sd.a)(sb,"TokenParameters",null,[616]);ib.prototype.getAccessToken=function(G){var la=this,Ya=this.reb.getOsfControl(this.Jz),Fb=Ya.getManifest(),lc=Fb.getMarketplaceID();this.NLa(G,lc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Lc,ad){Ya.isFirstParty()&&la.reb._enableFirstPartySSO?la.UZh(Fb,G)?ei.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(G,
lc).then(function(Kd){Lc(Kd)},function(Kd){ad(Kd)}):ad(Ii.a.xNc):ad(Ii.a.apiNotAvailable)}).then(function(Lc){switch(Lc.authority){case Ad.quf:var ad=1;break;default:ad=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new nb(Lc.accessToken,ad))},function(Lc){la.ici(G,lc,Lc);return Lc?OfficeExtension.WacRuntime.Utility.createPromise(function(ad,Kd){Kd(OfficeExtension.WacRuntime.Utility.createRichApiException(Lc,Gb.G7b(Lc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(ad,
Kd){Kd(OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,Gb.G7b(Ii.a.generalException)))})})};ib.prototype.getAuthContext=function(){return null};ib.prototype.getPrimaryIdentityInfo=function(){var G=this.reb.getOsfControl(this.Jz);G.getManifest();var la=G.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Ya,Fb){ei.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(la).then(function(lc){Ya(lc)},
function(lc){Fb(lc.toString())})}).then(function(Ya){Ya=Ha.jUg(Ya);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Ya)},function(Ya){return Ya?OfficeExtension.WacRuntime.Utility.createPromise(function(Fb,lc){lc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ya,Gb.G7b(Ya)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Fb,lc){lc(OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,Gb.G7b(Ii.a.generalException)))})})};ib.prototype.getTypeName=
function(){return"Microsoft.Authentication.AuthenticationService"};ib.prototype.invokePropertyGet=function(G){switch(G){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ib.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ib.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ib.prototype.invokePropertySetAsync=
function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ib.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ib.prototype.invokeMethodAsync=function(G,la){switch(G){case 1:return this.Esh(la);case 3:return this.Tth();case 2:return this.iFh()}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ib.prototype.Esh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,sb);return this.getAccessToken(G)};ib.prototype.Tth=function(){return this.getAuthContext()};ib.prototype.iFh=function(){return this.getPrimaryIdentityInfo()};ib.prototype.UZh=function(G,la){var Ya=!1,Fb=G.getWebApplicationAuthorizations();G=null;Fb=Ml(Fb);for(var lc=Fb.next();!lc.done;lc=Fb.next())if(lc=lc.value,lc.getResource().toLowerCase()===la.resource.toLowerCase()){G=lc;Ya=!0;break}if(!Ya)return!1;la=la.scope.split(" ,+");la=Ml(la);for(Ya=la.next();!Ya.done;Ya=la.next())if((Ya=Ya.value)&&
Ya.length){Fb=!1;lc=Ml(G.getScopes());for(var Lc=lc.next();!Lc.done;Lc=lc.next())Ya.toLowerCase()===Lc.value.toLowerCase()&&(Fb=!0);if(!Fb)return!1}return!0};ib.prototype.NLa=function(G,la){G=this.Kif(G.resource);var Ya={};pe.ULS.sendTraceTag(538572831,369,50,"{0}",(Ya.manifestId=la,Ya.resource=G,Ya))};ib.prototype.ici=function(G,la,Ya){G=this.Kif(G.resource);var Fb={};pe.ULS.sendTraceTag(538572830,369,10,"{0}",(Fb.manifestId=la,Fb.resource=G,Fb.error=Ya,Fb))};ib.prototype.Kif=function(G){return G.replace("://",
"__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Jl.Object.defineProperties(ib.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(sd.a)(ib,"AuthenticationService",null,[]);Oa.prototype.create=function(G,la){return new ib(G,la)};Object(sd.a)(Oa,"AuthenticationServiceFactory",null,[]);var Fk=b(969),Kk=b(998),Yk=b(1066);xa.generalException="generalException";xa.invalidArgument="invalidArgument";xa.notAllowed="notAllowed";xa.apiNotAvailable="apiNotAvailable";
xa.unresolvedPendingRequest="unresolvedPendingRequest";xa.timeout="timeout";xa.adalTimeout="adalTimeout";xa.userNotSignedIn="userNotSignedIn";xa.userAborted="userAborted";xa.silentSignInFailed="silentSignInFailed";xa.invalidResourceUrl="invalidResourceUrl";xa.invalidGrant="invalidGrant";xa.connectionLost="connectionLost";xa.clientError="clientError";xa.serverError="serverError";Object(sd.a)(xa,"WopiHostErrorCodes",null,[]);Object(sd.a)(na,"OAuthCallerMetadata",null,[]);ma.prototype.Ibe=function(G,
la,Ya,Fb,lc,Lc,ad,Kd){var ue=this;if(!this.gwa)return lc=new Kk.a,lc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(lc);var af=new na;af.AddinName=ad;af.AddinTrustId=Kd;var Xe=-1;G=null;if(lc&&this.G5e())G=this.gwa.b0f(Vg.a.suc,la,lc,ma.vTe(ad),af);else{var pg=Date.now();G=this.gwa.vR(Vg.a.suc,la,af).then(function(sg){Xe=Date.now()-pg;var lh=(Ya||Fb)&&"login_required"===sg.ErrorCode;return(Ya&&("interaction_required"===sg.ErrorCode||"consent_required"===sg.ErrorCode||
"invalid_grant"===sg.ErrorCode)||lh)&&ue.G5e()?ue.gwa.b0f(Vg.a.suc,la,null,ma.vTe(ad),af):Promise.resolve(sg)})}return G.then(function(sg){var lh=new Kk.a;sg.IsSuccess?(lh.token=sg.Token,sg.Telemetry&&(lh.T6=sg.Telemetry.fromCache,lh.expiresOn=sg.Telemetry.expiresOn)):(lh.errorCode=ue.Pfi(sg),lh.cuc=ue.Hvd(sg));return lh}).catch(function(){var sg=new Kk.a;sg.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(sg)}).then(function(sg){sg.VS="OauthManager";0<=Xe&&(sg.Bia=
Xe);return sg})};ma.prototype.$Rf=function(){return this.JRf()};ma.prototype.s4e=function(G,la){var Ya=(Jf.AFrameworkApplication.ha.Wa(Jf.AFrameworkApplication.$ma)||"").toLowerCase();return(Ei.a.Jja||"teams"===Ya&&ui.a.mub)&&!ma.g4e(G)||!this.gwa||!this.gwa.b3a()?!1:0<la||this.JRf()||ma.g4e(G)};ma.prototype.JRf=function(){var G=Yk.a.Lrb();return this.Dcg||this.Ecg&&1===G||this.Ccg&&2===G};ma.prototype.G5e=function(){return this.Gbg||1!==Yk.a.Lrb()};ma.prototype.Pfi=function(G){switch(G.ErrorCode){case "UserCancelled":case "interaction_required":G=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:G=G.ErrorCode===xa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:G.ErrorCode===xa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:G.ErrorCode===xa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:G.ErrorCode===xa.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:G.ErrorCode===xa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return G};
ma.prototype.Hvd=function(G){var la="";(G=RegExp("AADSTS(\\d+)").exec(G.ErrorMessage))&&1<G.length&&(la=G[1]);return la};ma.vTe=function(G){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,G)};ma.g4e=function(G){if(!G)return!1;G=G.toLowerCase();for(var la=Ml(Fk.AppsForOfficeSingleSignOnManager.UKe),Ya=la.next();!Ya.done;Ya=la.next())if(Ya.value===G)return!0;return!1};Object(sd.a)(ma,"AppsforOfficeTokenFromOauthManager",null,[875]);Sa.Yma=function(){if(Jf.AFrameworkApplication.ha.ta("AppForOfficeSSOV2IsEnabled")){var G=
null;try{G=ei.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){pe.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+la)}G=new ma(G);Sa.Pa=new Sa(G)}};Sa.getInstance=function(){Sa.X_d||(Sa.Yma(),Sa.X_d=!0);return Sa.Pa};Sa.Pa=null;Sa.X_d=!1;Object(sd.a)(Sa,"AppsForOfficeOauthManagerFactory",null,[866]);var n=b(128);Object(sd.a)(oa,"NewDocumentParameters",null,[]);var O=b(249),da=b(142);ba.prototype.createAndOpenWorkbook=function(G){var la=this;if(G&&G.length>this.Tfg)throw pe.ULS.sendTraceTag(538572821,
0,15,"Too large base64 stream size:{0}",G.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.invalidArgument,da.a.da(1691));var Ya=new oa("blank","agave",G?"streamBase64":"streamEmpty",G),Fb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(lc,Lc){var ad=new n.StandardDialog;ad.lc=4;ad.Hl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Kd){2!==Kd&&Kd?(Fb=window.open(""),la.pgg.create(lc,Lc,Ya).XYa()):Lc("Cancelled")})}).then(function(lc){if(!lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,
da.a.da(1687));try{Fb.top.location.href=lc}catch(Lc){pe.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Ei.a.Oo,Lc),pe.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Fb.location.replace(lc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(lc){if("Cancelled"===lc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.xCi,
da.a.da(1690));Fb.close();la.cpj();return null})};ba.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ba.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ba.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ba.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};ba.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ba.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ba.prototype.invokeMethodAsync=function(G,la){switch(G){case 1:return this.VRg(la)}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ba.prototype.VRg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return this.createAndOpenWorkbook(G)};ba.prototype.cpj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,da.a.da(1687));};Object(sd.a)(ba,"WacWorkbook",null,[]);var l=b(840),K=b(850);Jl.Object.defineProperties(X.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(sd.a)(X,"RichApiPreviewExecutionContext",null,[]);var ka=b(25),$a=b(999),Lb=b(193),bc=b(196),Dc=b(118),wd=b(11),ke=bc.a;Cm(ea,ke);ea.prototype.start=
function(G,la){var Ya="<div class='"+Dc.a.yah+" "+Qe.a.Er+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Dc.a.bU+"' /></div>";Ya=String.format(Ya,od.a.gg(this.V_c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Qb.innerHTML=Ya;this.Tlb=wd.DOMElementExtensions.getElementById(this.Qb,"bindingText");(G=Ig.a.na(la)?null:G.W_a(la,this.V_c.DdaBindingsMethod.BindingId))&&G.IsValidRef?(la=new ka.Range(G.Reference.FirstRow+1,G.Reference.FirstColumn+
1,G.Reference.LastRow+1,G.Reference.LastColumn+1,!1,!1),this.Tlb.value=G.Reference.SheetName+"!"+la):(G=ti.g(this.$).ga,this.Tlb.value=Sj.f(this.$.sa)||!G.ya.Eh?"":G.hha);this.initialize();this.Bf()};ea.prototype.rm=function(){this.AVc();this.addButton(0);this.addButton(1);ke.prototype.rm.call(this)};ea.prototype.setFocus=function(){wd.DOMElementExtensions.setFocus(this.Tlb)};ea.prototype.validate=function(){return!0};ea.prototype.commit=function(){var G=this.Tlb.value.trim(),la=G.indexOf("!");-1!==
la&&(G=this.PHh(G.substring(0,la))+G.substr(la));this.txe.addBinding(this.V_c,G,0,this.callback);return!0};ea.prototype.aFa=function(){this.txe.zP.sf(l.a.internalError,this.callback);ke.prototype.aFa.call(this)};ea.prototype.PHh=function(G){G=Ig.a.trimStart(G.trim(),"=");return G.length?G.startsWith("'")&&G.endsWith("'")?G:rh.HelperMethods.X3b(G):""};Jl.Object.defineProperties(ea.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(sd.a)(ea,"DdaBindingPrompt",
bc.a,[]);P.prototype.sf=function(G,la){if(la){var Ya={};Ya.Error=G;Ya.Version=this.fa.zf;la(Ya)}};P.prototype.gIa=function(G,la){this.sf(G,la)};P.prototype.yG=function(G,la){this.sf(l.a.qMe(G.Errors[0].MessageId),la)};P.prototype.Bu=function(G){G&&G(this.gP())};P.prototype.gP=function(){var G={Error:0};G.Version=this.fa.zf;return G};Object(sd.a)(P,"DdaErrorGenerator",null,[]);var jf=b(303),Xf=b(106);L.prototype.rqd=function(G,la){function Ya(Kd){var ue=Fb.$.Aa.getItemByName(Kd.SheetName);ue&&ue.visible?
(ti.g(Fb.$).ui(Kd,null,null,null,3,Xf.a.z_g,void 0,void 0,void 0,void 0,!0),Fb.zP.Bu(la)):Fb.zP.sf(l.a.hIg,la)}var Fb=this,lc=G.DdaGoToByIdMethod.GoToType,Lc=G.DdaGoToByIdMethod.SelectionMode,ad=G.DdaGoToByIdMethod.Id.toString().trim();lc?1===lc?this.Vji(ad,Lc,Ya,la):this.zP.sf(l.a.kvj,la):this.Rji(ad,Lc,G.DdaMethod.ControlId,Ya,la)};L.prototype.Rji=function(G,la,Ya,Fb,lc){var Lc=this;this.uz.ddaGetBinding(Ya,G,function(ad){if(!jf.a(ad)&&ad.Result&&ad.Result.Reference){ad=ad.Result;var Kd={};Kd.SheetName=
ad.Reference.SheetName;Kd.FirstRow=ad.Reference.FirstRow;Kd.FirstColumn=ad.Reference.FirstColumn;Kd.LastRow=ad.Reference.LastRow;Kd.LastColumn=ad.Reference.LastColumn;L.lQc(Kd,la);1!==ad.BindingType?Fb(Kd):Lc.uz.ddaGetBindingData(Ya,G,1,0,2,0,0,-1,-1,function(ue){jf.a(ue)||!ue.Result?Lc.zP.yG(ue,lc):(ue=ue.Result,2!==la&&(Kd.FirstRow-=ue.Headers.length,0>Kd.FirstRow&&(Kd.FirstRow=0)),Fb(Kd))},lc)}else Lc.zP.gIa(l.a.dVf,lc)},lc)};L.prototype.Vji=function(G,la,Ya,Fb){var lc=this,Lc=yj.z(G);Lc?(Lc=yj.v(Lc,
this.$),L.lQc(Lc,la),Ya(Lc)):this.$.fa.isNamedObjectViewMode&&this.$.Ab.Gj(G)?this.$.Ab.sa=this.$.Ab.getItemByName(G):(Lc=function(ad){jf.a(ad)||!ad.Result?lc.$.Aa.contains(G)?(ad={},ad.SheetName=G,ad.FirstRow=0,ad.FirstColumn=0,ad.LastRow=0,ad.LastColumn=0,Ya(ad)):lc.zP.gIa(l.a.dVf,Fb):(ad=ad.Result,L.lQc(ad,la),Ya(ad))},this.$.Aa.sa?this.uz.parseRangeForGoto(G,this.$.Aa.sa.name,Lc,Fb):this.uz.parseRange(G,Lc,Fb))};L.lQc=function(G,la){G.LastRow=2===la?G.FirstRow:G.LastRow;G.LastColumn=2===la?G.FirstColumn:
G.LastColumn};Object(sd.a)(L,"DdaNavigator",null,[]);var Sf=b(288),xg;(function(G){G[G.unsupported=0]="unsupported";G[G.surface=1]="surface";G[G.combo=2]="combo";G[G.column=3]="column";G[G.column3D=4]="column3D";G[G.bar=5]="bar";G[G.bar3D=6]="bar3D";G[G.line=7]="line";G[G.line3D=8]="line3D";G[G.pie=9]="pie";G[G.pie3D=10]="pie3D";G[G.scatter=11]="scatter";G[G.bubble=12]="bubble";G[G.area=13]="area";G[G.area3D=14]="area3D";G[G.doughnut=15]="doughnut";G[G.radar=16]="radar";G[G.stock=17]="stock";G[G.waterfall=
18]="waterfall";G[G.funnel=19]="funnel";G[G.treemap=20]="treemap";G[G.sunburst=21]="sunburst";G[G.boxWhisker=22]="boxWhisker";G[G.histogram=23]="histogram";G[G.pareto=24]="pareto";G[G.regionMap=25]="regionMap";G[G.noVisibleSeries=26]="noVisibleSeries";G[G.complexDataSource=27]="complexDataSource";G[G.pivotChart=28]="pivotChart"})(xg||(xg={}));Object(sd.b)("ChartCategory",xg);Object(sd.a)(fa,"MacroRecorderEventData",null,[]);T.prototype.wGh=function(G){if(void 0===G||null===G||void 0===G.RequestBody||
null===G.RequestBody)return null;var la=JSON.parse(G.RequestBody);if(void 0!==G.ActiveChartId&&null!==G.ActiveChartId){la.ActiveChartId=G.ActiveChartId;var Ya=ti.g(this.$).ga.Sa.nc;Ya&&Ya.floatingObject&&Ya.floatingObject.hd&&(la.ActiveChartType=xg[Ya.floatingObject.hd.ChartCategory])}void 0!==G.SheetMultiRange&&null!==G.SheetMultiRange&&(la.SheetName=G.SheetMultiRange.SheetName);return la};T.prototype.DGh=function(G){if(void 0===G||null===G||void 0===G.Result||null===G.Result)return null;G=G.Result;
return void 0===G.ResponseBody||null===G.ResponseBody||G.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(G.ResponseBody.join(""))};T.prototype.W4h=function(G){return!!G&&!(void 0===G.eventId||null===G.eventId)&&0<G.eventId.length};T.prototype.Yl=function(G){var la=this;return function(){if(la.$.vaa){var Ya=la.sEg(la.request);if(la.W4h(Ya)){var Fb=la.wGh(la.request),lc=la.DGh(G);if(Fb&&!nj.a.isEmpty(Fb)&&lc&&!nj.a.isEmpty(lc))return pe.ULS.sendTraceTag(579216154,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new xe(Ya,Fb,lc);Ya=String.format("requestInfo: {0}; responseInfo: {1}",Fb?"(not null)":"(null)",lc?"(not null)":"(null)");pe.ULS.sendTraceTag(579216153,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Ya)}}return new xe(null,null,null)}};T.prototype.sEg=function(G){var la=this.X4h(G.SolutionId),Ya=T.dGh(G);if(Ya&&la)return la={},pe.ULS.sendTraceTag(579216152,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(la.recorderEventId=Ya,la["request.SolutionId"]=G.SolutionId,la)),new fa(G.SolutionId,
Ya);var Fb={};pe.ULS.sendTraceTag(579216151,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Fb.recorderEventId=Ya,Fb.isRecorderAwareAddin=la,Fb["request.SolutionId"]=G.SolutionId,Fb));return null};T.prototype.X4h=function(G){if(!G)return!1;G=G.toLowerCase();return T.vLh().contains(G)};T.vLh=function(){T.Zxa||(T.Zxa=new Uj.a(Mj.a.Dl()),T.Zxa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),T.Zxa.add("fa000000005"),T.Zxa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),T.Zxa.add("fa000000014"),T.Zxa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return T.Zxa};T.dGh=function(G){var la=null,Ya=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Ya.test(G.RequestBody))la=Ya.exec(G.RequestBody)[1];else{G=G.RequestHeaders;if(!G)return la;Ya=Ui.a.Zmi.toLowerCase();for(var Fb=0;Fb<G.length;Fb++)if(G[Fb].Name.toLowerCase()===Ya){la=G[Fb].Value;break}}return la};T.Zxa=null;Object(sd.a)(T,"DdaRichApiRequestRecorder",null,[]);var xi=b(65),Oi=Sf.a;Cm(N,Oi);N.prototype.X1=function(G){return Oi.prototype.X1.call(this,G)||
this.eHg(G)};N.prototype.Yl=function(){return this.BEd.Yl(this.od)};N.prototype.obb=function(){var G={OperationType:3};G.RichApiRequest=this.request;return G};N.prototype.eHg=function(G){var la=this;return function(Ya,Fb,lc){return Y(G,la.request,ci.b(Ya,la.Wib),ci.a(Fb,la.ifb),lc,la.L2)}};Jl.Object.defineProperties(N.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return dg.EwaSettings.wc()?Object(xi.a)(N.prototype,this,"operationWorkingState"):2}},Dwc:{configurable:!0,
enumerable:!0,get:function(){return this.HDa}},gr:{configurable:!0,enumerable:!0,get:function(){return this.Wib}},p3:{configurable:!0,enumerable:!0,get:function(){return this.ifb}}});Object(sd.a)(N,"DdaRichApiRequestBatchOperation",Sf.a,[]);var pj=Oj.a;Cm(S,pj);S.prototype.Yl=function(){return this.BEd.Yl(this.od)};Jl.Object.defineProperties(S.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return dg.EwaSettings.wc()?Object(xi.a)(S.prototype,this,"operationWorkingState"):
0}}});Object(sd.a)(S,"DdaRichApiRequestOperation",Oj.a,[]);W.prototype.ddaAddBinding=function(G,la,Ya,Fb,lc,Lc,ad){var Kd=this;this.eJ(function(ue,af,Xe){var pg=Kd.$.ra.xa,sg=Kd.iia();ue=ci.b(ue,Lc);af=ci.a(af,Object(Ve.a)(Kd,Kd.vH,"onWebServiceFailed"));var lh=pg.Ra(9);lh.controlId=G;lh.bindingId=la;lh.bindingType=Ya;lh.currentSheetName=sg;lh.formula=Fb;lh.options=lc;return Vi.i(pg,"DdaAddBinding",lh,ue,af,Xe,ad,0)},ad,563)};W.prototype.ddaReleaseBinding=function(G,la,Ya,Fb){var lc=this;this.eJ(function(Lc,
ad,Kd){var ue=lc.$.ra.xa;Lc=ci.b(Lc,Ya);ad=ci.a(ad,Object(Ve.a)(lc,lc.vH,"onWebServiceFailed"));var af=ue.Ra(9);af.controlId=G;af.bindingId=la;return Vi.i(ue,"DdaReleaseBinding",af,Lc,ad,Kd,Fb,0)},Fb,564)};W.prototype.ddaGetBinding=function(G,la,Ya,Fb){var lc=this;this.eJ(function(Lc,ad,Kd){var ue=lc.$.ra.xa;Lc=ci.b(Lc,Ya);ad=ci.a(ad,Object(Ve.a)(lc,lc.vH,"onWebServiceFailed"));var af=ue.Ra(1);af.controlId=G;af.bindingId=la;return Vi.i(ue,"DdaGetBinding",af,Lc,ad,Kd,Fb,0)},Fb,565,16)};W.prototype.ddaGetAllBindings=
function(G,la,Ya){var Fb=this;this.eJ(function(lc,Lc,ad){var Kd=Fb.$.ra.xa;lc=ci.b(lc,la);Lc=ci.a(Lc,Object(Ve.a)(Fb,Fb.vH,"onWebServiceFailed"));var ue=Kd.Ra(1);ue.controlId=G;return Vi.i(Kd,"DdaGetAllBindings",ue,lc,Lc,ad,Ya,0)},Ya,566,16)};W.prototype.ddaGetBindingData=function(G,la,Ya,Fb,lc,Lc,ad,Kd,ue,af,Xe){var pg=this;this.eJ(function(sg,lh,Jh){var th=pg.$.ra.xa,Pi=pg.iia();sg=ci.b(sg,af);lh=ci.a(lh,Object(Ve.a)(pg,pg.vH,"onWebServiceFailed"));var Oh=th.Ra(1);Oh.controlId=G;Oh.bindingId=la;
Oh.coerceType=Ya;Oh.valueFormat=Fb;Oh.filterType=lc;Oh.startRow=Lc;Oh.startCol=ad;Oh.rowCount=Kd;Oh.colCount=ue;Oh.currentSheetName=Pi;return Vi.i(th,"DdaGetBindingData",Oh,sg,lh,Jh,Xe,0)},Xe,567,16)};W.prototype.ddaSetBindingData=function(G,la,Ya,Fb,lc,Lc,ad){var Kd=this;this.eJ(function(ue,af,Xe){var pg=Kd.$.ra.xa,sg=Kd.iia();ue=ci.b(ue,Lc);af=ci.a(af,Object(Ve.a)(Kd,Kd.vH,"onWebServiceFailed"));var lh=pg.Ra(9);lh.controlId=G;lh.bindingId=la;lh.startRow=Ya;lh.startCol=Fb;lh.currentSheetName=sg;
lh.bindingData=lc;return Vi.i(pg,"DdaSetBindingData",lh,ue,af,Xe,ad,0)},ad,568)};W.prototype.ddaGetSelectedData=function(G,la,Ya,Fb,lc,Lc,ad){var Kd=this;this.eJ(function(ue,af,Xe){var pg=Kd.$.ra.xa,sg=Kd.iia();ue=ci.b(ue,Lc);af=ci.a(af,Object(Ve.a)(Kd,Kd.vH,"onWebServiceFailed"));var lh=pg.Ra(1);lh.controlId=G;lh.coerceType=la;lh.valueFormat=Ya;lh.filterType=Fb;lh.currentSheetName=sg;lh.formula=lc;return Vi.i(pg,"DdaGetSelectedData",lh,ue,af,Xe,ad,0)},ad,569,16)};W.prototype.ddaSetSelectedData=function(G,
la,Ya,Fb,lc){var Lc=this;this.eJ(function(ad,Kd,ue){var af=Lc.$.ra.xa,Xe=Lc.iia();ad=ci.b(ad,Fb);Kd=ci.a(Kd,Object(Ve.a)(Lc,Lc.vH,"onWebServiceFailed"));var pg=af.Ra(9);pg.controlId=G;pg.currentSheetName=Xe;pg.formula=la;pg.bindingData=Ya;return Vi.i(af,"DdaSetSelectedData",pg,ad,Kd,ue,lc,0)},lc,570)};W.prototype.ddaLoadSettings=function(G,la,Ya){var Fb=this;this.eJ(function(lc,Lc,ad){var Kd=Fb.$.ra.xa;lc=ci.b(lc,la);Lc=ci.a(Lc,Object(Ve.a)(Fb,Fb.vH,"onWebServiceFailed"));var ue=Kd.Ra(1);ue.controlId=
G;return Vi.i(Kd,"DdaLoadSettings",ue,lc,Lc,ad,Ya,0)},Ya,501,16)};W.prototype.ddaSaveSettings=function(G,la,Ya,Fb,lc){var Lc=this;this.eJ(function(ad,Kd,ue){var af=Lc.$.ra.xa;ad=ci.b(ad,Fb);Kd=ci.a(Kd,Object(Ve.a)(Lc,Lc.vH,"onWebServiceFailed"));var Xe=af.Ra(9);Xe.controlId=G;Xe.settings=la;Xe.overwriteIfStale=Ya;return Vi.i(af,"DdaSaveSettings",Xe,ad,Kd,ue,lc,0)},lc,571)};W.prototype.ddaAddRowsColumns=function(G,la,Ya,Fb,lc,Lc){var ad=this;this.eJ(function(Kd,ue,af){var Xe=ad.$.ra.xa,pg=ad.iia();
Kd=ci.b(Kd,lc);ue=ci.a(ue,Object(Ve.a)(ad,ad.vH,"onWebServiceFailed"));var sg=Xe.Ra(9);sg.controlId=G;sg.bindingId=la;sg.isRow=Ya;sg.currentSheetName=pg;sg.bindingData=Fb;return Vi.i(Xe,"DdaAddRowsColumns",sg,Kd,ue,af,Lc,0)},Lc,572)};W.prototype.ddaDeleteAllDataValues=function(G,la,Ya,Fb){var lc=this;this.eJ(function(Lc,ad,Kd){var ue=lc.$.ra.xa,af=lc.iia();Lc=ci.b(Lc,Ya);ad=ci.a(ad,Object(Ve.a)(lc,lc.vH,"onWebServiceFailed"));var Xe=ue.Ra(9);Xe.controlId=G;Xe.bindingId=la;Xe.currentSheetName=af;return Vi.i(ue,
"DdaDeleteAllDataValues",Xe,Lc,ad,Kd,Fb,0)},Fb,573)};W.prototype.ddaClearBindingFormats=function(G,la,Ya,Fb){var lc=this;this.eJ(function(Lc,ad,Kd){var ue=lc.$.ra.xa,af=lc.iia();Lc=ci.b(Lc,Ya);ad=ci.a(ad,Object(Ve.a)(lc,lc.vH,"onWebServiceFailed"));var Xe=ue.Ra(9);Xe.controlId=G;Xe.bindingId=la;Xe.currentSheetName=af;return Vi.i(ue,"DdaClearBindingFormats",Xe,Lc,ad,Kd,Fb,0)},Fb,574)};W.prototype.ddaSetBindingFormats=function(G,la,Ya,Fb,lc,Lc){var ad=this;this.eJ(function(Kd,ue,af){var Xe=ad.$.ra.xa,
pg=ad.iia();Kd=ci.b(Kd,lc);ue=ci.a(ue,Object(Ve.a)(ad,ad.vH,"onWebServiceFailed"));var sg=Xe.Ra(9);sg.controlId=G;sg.bindingId=la;sg.currentSheetName=pg;sg.bindingData=Ya;sg.isSetFormats=Fb;return Vi.i(Xe,"DdaSetBindingFormats",sg,Kd,ue,af,Lc,0)},Lc,575)};W.prototype.parseRange=function(G,la,Ya){var Fb=this;this.eJ(function(lc,Lc,ad){var Kd=Fb.$.ra.xa.dc();return Vi.P(Fb.$.ra.xa,G,-1,ci.b(lc,la),ci.a(Lc,Object(Ve.a)(Fb,Fb.vH,"onWebServiceFailed")),ad,Ya,Kd)},Ya,162,16)};W.prototype.parseRangeForGoto=
function(G,la,Ya,Fb){var lc=this;this.eJ(function(Lc,ad,Kd){var ue=lc.$.ra.xa.dc();return Vi.Q(lc.$.ra.xa,G,la,ci.b(Lc,Ya),ci.a(ad,Object(Ve.a)(lc,lc.vH,"onWebServiceFailed")),Kd,Fb,ue)},Fb,562,16)};W.prototype.executeRichApiRequest=function(G,la,Ya){var Fb=this;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(G.RequestFlags&=8191);if(dg.EwaSettings.ka(263))this.fjh(this.$.ra.xa.dc(),la,function(){Fb.zP.gIa(l.a.internalError,Ya)},Ya,G);else{var lc=Dh.DdaFacade.A$c(G);
!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Db.MJ||lc&16?(dg.EwaSettings.wc()&&(lc|=64),this.$.userOperationManager.yt(new S(this.$,G,function(Lc,ad,Kd){return Y(Fb.$.ra.xa,G,ci.b(Lc,la),ci.a(ad,Object(Ve.a)(Fb,Fb.vH,"onWebServiceFailed")),Kd,Ya)},lc))):(this.zP.gIa(l.a.yxc,Ya),pe.ULS.sendTraceTag(579216150,0,50,"Write operation is not allowed"))}};W.prototype.iia=function(){return this.$.fa.isNamedObjectViewMode?this.$.sa.sheetName:this.$.activeItemName};
W.prototype.vH=function(G,la){this.zP.gIa(l.a.internalError,la)};W.prototype.eJ=function(G,la,Ya,Fb){Fb=void 0===Fb?0:Fb;!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Db.MJ||Fb&16?dg.EwaSettings.wc()?this.$.userOperationManager.yt(new Oj.a(Ya,0,G,Fb|64)):this.$.userOperationManager.yt(new sj.a(Ya,0,G,Fb)):(this.zP.gIa(l.a.yxc,la),pe.ULS.sendTraceTag(590488149,0,50,"Write operation is not allowed"))};W.prototype.fjh=function(G,la,Ya,Fb,lc){var Lc=
Dh.DdaFacade.A$c(lc);if(!dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Db.MJ||Lc&16){var ad=this.$.Zb.Ic("UserAction","Rich Api request");dg.EwaSettings.wc()&&(Lc|=64);this.$.userOperationManager.oc(new N(this.$,G,la,Ya,Fb,ad,lc,Lc),null)}else this.zP.gIa(l.a.yxc,Fb),pe.ULS.sendTraceTag(590488148,0,50,"Write operation is not allowed")};Object(sd.a)(W,"DdaWebServiceHelper",null,[]);Object(sd.a)(H,"DocumentFile",null,[]);C.prototype.replaceShortcuts=
function(){return Promise.reject("ReplaceShortcuts method is not overridden")};C.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};C.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(sd.a)(C,"WacApiDelegates",null,[]);var dk=b(651);Cm(B,C);B.prototype.replaceShortcuts=function(G){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,G,Object(Ve.a)(this,this.s8e,
"isShortcutKeyUsedByHost"))};B.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};B.prototype.checkShortcutsInUse=function(G){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(G,Object(Ve.a)(this,this.s8e,"isShortcutKeyUsedByHost"))};B.prototype.s8e=function(G,la){G=B.zQg(G,la);if(!dk.a(this.$,G))return!0;G=this.$.shortcutKeyManager.FUe(G);return!!G&&0<G.length};B.SUg=function(G,la){var Ya=document.createEvent("KeyboardEvent");if(Ei.a.zE)Ya.initKeyboardEvent("keydown",
!1,!1,window.self,"A",0,!!(G&8),!!(G&32),!!(G&4),!!(G&256));else{var Fb=[];G&4&&Fb.push("Shift");G&8&&Fb.push("Control");G&32&&Fb.push("Alt");Ya.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Fb,!1,"en-US")}G=new Sys.UI.DomEvent(Ya);G.keyCode=la;return G};B.zQg=function(G,la){if(Ei.a.Pf)switch(la){case 189:la=173;break;case 187:la=61;break;case 186:la=59}return B.SUg(G,la)};Object(sd.a)(B,"ExcelWacApiDelegates",C,[]);J.prototype.sog=function(G,la){this.T9b(G)||(this.SGa[G]={});if(this.B0h(G))return pe.ULS.sendTraceTag(8946273,
344,50,"App {0} has reach the limit of number of cached files.",G),l.a.fhi;this.SGa[G][la.Tkh.toString()]=la;return l.a.success};J.prototype.kyh=function(G,la){var Ya=null;this.T9b(G)&&(Ya=this.SGa[G][la.toString()]);Ya||pe.ULS.sendTraceTag(8946274,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",G,la);return Ya};J.prototype.T9b=function(G){return G in this.SGa};J.prototype.lRi=function(G,la){if(this.T9b(G)){var Ya=this.SGa[G];delete Ya[la.toString()];1>Object.keys(Ya).length&&delete this.SGa[G];
return la.toString()in Ya?l.a.internalError:l.a.success}return l.a.internalError};J.prototype.B0h=function(G){return this.T9b(G)?Object.keys(this.SGa[G]).length>=this.Agi:!1};J.getInstance=function(G){return G.ea.Ea(200,void 0)||G.ea.La(200,new J(J.Bgi))};J.Cki=function(){return++J.uGg};J.hgi=4194304;J.Bgi=1;J.uGg=0;Object(sd.a)(J,"GetFileApiHelper",null,[]);z.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Jz)};z.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};
z.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};z.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};z.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};z.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
z.prototype.invokeMethod=function(G){switch(G){case 1:return this.oli()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};z.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};z.prototype.oli=function(){this.notifyActionHandlerReady();return null};Object(sd.a)(z,"AddinInternalService",null,[]);x.prototype.getAppRuntimeState=function(){return this.jI.getAppRuntimeState(this.Jz)?2:1};x.prototype.setAppRuntimeState=
function(G){switch(G){case 2:G=!0;break;case 1:G=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.invalidArgument,da.a.da(1691));}this.jI.setAppRuntimeState(this.Jz,G)};x.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};x.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
x.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(G,la){switch(G){case 2:return this.Hth();case 1:return this.O5i(la)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,
la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.Hth=function(){return this.getAppRuntimeState()};x.prototype.O5i=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");this.setAppRuntimeState(G);return null};Object(sd.a)(x,"AppRuntimeService",null,[]);var Yi=b(1106);y.prototype.disable=function(){try{if(!da.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.wue();if(!this.Y7e())return this.xue();
this.K0.ruj(this.xv)}catch(G){return pe.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",G.message||"Unknown"),this.uue()}return null};y.prototype.enable=function(){try{if(!da.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.wue();if(!this.Y7e())return this.xue();this.K0.BPi(this.xv)}catch(G){return pe.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",G.message||
"Unknown"),this.uue()}return null};y.prototype._OnAccess=function(){};y.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};y.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};y.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(G){switch(G){case 1:return this.OAa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokeMethodAsync=function(G,la){switch(G){case 3:return this.Y2g();case 2:return this.e8g()}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.Y2g=
function(){return this.disable()};y.prototype.e8g=function(){return this.enable()};y.prototype.OAa=function(){this._OnAccess();return null};y.prototype.wue=function(){return Yi.a(Ii.a.notImplemented,da.a.da(1692))};y.prototype.xue=function(){return Yi.a(Ii.a.sharedRuntimeNotAvailable,da.a.da(1696))};y.prototype.uue=function(){return Yi.a(Ii.a.generalException,da.a.da(1687))};y.prototype.Y7e=function(){var G=this.hy.getSharedRuntimeId();return!!G&&0<G.length};Object(sd.a)(y,"BeforeDocumentCloseNotification",
null,[]);A.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};A.prototype.invokePropertyGet=function(G){switch(G){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};A.prototype.invokePropertySet=function(G,
la){switch(G){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(la,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
A.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokeMethodAsync=function(G,la){G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Jl.Object.defineProperties(A.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Dz},set:function(G){this.Dz=G}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.u4d},set:function(G){this.u4d=G}},streamingEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.k$d},set:function(G){this.k$d=G}}});Object(sd.a)(A,"CustomFunctionEngineStatus",null,[]);v.prototype.register=function(G){return OfficeExtension.WacRuntime.Utility.createPromise(this.dig(G))};v.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};v.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertyGetAsync=
function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokeMethodAsync=
function(G,la){switch(G){case 1:return this.jQi(la)}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.jQi=function(G){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"string");return this.register(la,G)};Jl.Object.defineProperties(v.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var G=new A;G.enabled=this.meg;G.streamingEnabled=this.oeg;
G.nativeRuntime=!1;return G}}});Object(sd.a)(v,"CustomFunctionManager",null,[]);var Jj=b(1062);w.prototype._RegisterStateChange=function(){var G=this;this.HOb||this.cO.execute(function(la){G.EVd=la.$Na(G._id,function(Ya){G.jI.Xmh(G.Jz,G._id,JSON.stringify(Ya))})});this.HOb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var G=this;this.HOb--;this.HOb||this.cO.execute(function(la){la.lBd(G._id,G.EVd)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=function(G){switch(G){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertySetAsync=
function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokeMethodAsync=function(G,la){switch(G){case 6:return this.P8f();case 7:return this.R8f()}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.P8f=function(){return this._RegisterStateChange()};w.prototype.R8f=
function(){return this._UnregisterStateChange()};Jl.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(sd.a)(w,"LicenseFeature",null,[]);u.prototype.getFeatureTier=function(G,la){var Ya=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Fb){var lc=1===la?1:2===la?2:0;Ya.cO.execute(function(Lc){Lc.getFeatureTier(G,lc).then(function(ad){Fb(Ya.kCh(ad))},function(){Fb(la)})})})};u.prototype.getLicenseFeature=function(G){G=
new w(this.cO,G,this.Jz,this.jI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.isFeatureEnabled=function(G,la){var Ya=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Fb){Ya.cO.execute(function(lc){lc.isFeatureEnabled(G,la).then(function(Lc){Fb(Lc)},function(){Fb(la)})})})};u.prototype.isFreemiumUpsellEnabled=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(la){G.cO.execute(function(Ya){Ya=Ya.isFreemiumUpsellEnabled();
la(Ya)})})};u.prototype.launchUpsellExperience=function(G){var la=this;if(this.Vgg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){la.cO.execute(function(Ya){Ya.launchUpsellExperience(G)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.xNc,"");};u.prototype._TestFireStateChangedEvent=function(){};u.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};u.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(G,la){switch(G){case 6:return this.Q8f(la)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokeMethodAsync=function(G,la){switch(G){case 2:return this.dzh(la);case 5:return this.jCh(la);case 1:return this.m1h(la);case 3:return this.S1h();case 4:return this.C$h(la)}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.dzh=function(G){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"int");return this.getFeatureTier(la,G)};u.prototype.jCh=
function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getLicenseFeature(G)};u.prototype.m1h=function(G){var la=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"boolean");return this.isFeatureEnabled(la,G)};u.prototype.S1h=function(){return this.isFreemiumUpsellEnabled()};u.prototype.C$h=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");
return this.launchUpsellExperience(G)};u.prototype.Q8f=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");this._TestFireStateChangedEvent(G);return null};u.prototype.kCh=function(G){switch(G){case 1:return 1;case 2:return 2;default:return 0}};Object(sd.a)(u,"License",null,[]);var Gk=b(147);t.prototype.areShortcutsInUse=function(G){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ya,Fb){la.Jod.checkShortcutsInUse(G).then(function(lc){Ya(lc)}).catch(function(lc){Fb(lc)})})};
t.prototype.getShortcuts=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(la,Ya){G.Jod.getShortcuts().then(function(Fb){la(Fb)}).catch(function(Fb){Ya(Fb)})})};t.prototype.replaceShortcuts=function(G){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ya,Fb){la.Jod.replaceShortcuts(G).then(function(){Ya(null)}).catch(function(lc){Fb(lc)})})};t.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};t.prototype.invokePropertyGet=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokeMethodAsync=function(G,la){switch(G){case 3:return this.Ayg(la);case 1:return this.THh();case 2:return this.NWi(la)}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.Ayg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"Array<string>");return this.areShortcutsInUse(G)};t.prototype.THh=function(){return this.getShortcuts()};
t.prototype.NWi=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"any");return this.replaceShortcuts(G)};Object(sd.a)(t,"ActionService",null,[]);var Hk=b(525);r.prototype.KHh=function(){this.mfa||(this.mfa=Hk.a.uq(ei.a.instance.yc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.mfa};r.prototype.getSharedFilePickerResponse=function(G){var la=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ya,Fb){try{var lc=la.KHh();Aj.Task.WAA.call(null,
lc).continueWith(function(){var Lc=lc.result;if(Lc){var ad={};(function(){var Kd=ji.d(G);ad=Kd.xu;return Kd})().returnValue?Lc.L7b(ad).then(function(Kd){Kd&&0<Kd.length?Ya(Kd):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function(Kd){Fb(Kd)}):Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Fb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(Lc){Fb(Lc)}})};r.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};r.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};r.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};r.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};r.prototype.invokePropertySetAsync=function(G,la){this.invokePropertySet(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};r.prototype.invokeMethodAsync=function(G,la){switch(G){case 1:return this.JHh(la)}G=this.invokeMethod(G,la);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};r.prototype.JHh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return this.getSharedFilePickerResponse(G)};Object(sd.a)(r,"SharedFilePicker",null,[]);m.prototype.createInstance=function(G,la){switch(G){case "Microsoft.Office.ActionService":return new t(la);case "Microsoft.Office.SharedFilePicker":return new r}return null};Object(sd.a)(m,"WacApiHost",null,[]);c.prototype.hostName=function(){return"ExcelOnline"};c.prototype.appId=function(){return this.PMb};c.prototype.createInstance=function(G){switch(G){case "Microsoft.Authentication.AuthenticationService":return ei.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.Jz,
this.jI.Ah);case "Microsoft.Authentication.TokenParameters":return new sb;case "Microsoft.ExcelServices.CustomFunctionManager":G=this.wb.ka(123);var la=this.wb.ka(124);return new v(G,la,k(this.PMb,this.wb,this.jI));case "Microsoft.AppRuntime.AppRuntimeService":return new x(this.Jz,this.jI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return G=Wi.a(this.wb),new y(this.PMb,this.Jz,G,this.jI);case "Microsoft.DynamicRibbon.DynamicRibbon":return G=Wi.a(this.wb),new Jj.DynamicRibbon(this.PMb,
this.Jz,this.jI,G,G.fn(this.Jz).al);case "Microsoft.Office.Licensing.License":return new u(this.Jz,this.jI);case "Microsoft.InternalService.AddinInternalService":return new z(this.Jz);default:if(this.eNc||(this.eNc=new m),la=this.eNc.createInstance(G,this.gmg))return la}pe.ULS.sendTraceTag(36542161,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",G);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Ii.a.generalException,Ii.a.generalException);};
Object(sd.a)(c,"RichApiHost",null,[]);var Ok=b(380),bl=b(117),Uk=b(32),cl=b(95),el=b(278),fl=b(39),gl=b(243),hl=b(6),dl=b(64),Pk=b(186);d.prototype.dispose=function(){this.$=this.b5c=null};d.prototype.$c=function(){return!1};d.prototype.gd=function(){return!1};d.prototype.executeCommand=function(G,la,Ya){G=la.command;switch(G){case 451041795:this.xe.sf(Ya[Mi.a.Mj],Ya[Mi.a.L2]);break;case 974713501:this.QNh(Ya[Mi.a.Mj],Ya[Mi.a.L2]);break;case 1237877382:this.xe.Bu(Ya[Mi.a.L2]);break;default:return vk.a(G)}return Aj.Task.Ua(!0)};
d.prototype.Jc=function(G,la,Ya){if(G=!!Ya)switch(la.command){case 974713501:case 1237877382:case 451041795:break;default:G=!1}return G};d.prototype.QNh=function(G,la){var Ya=G.DdaMethod;if("undefined"===typeof Ya.DispatchId)this.xe.sf(l.a.internalError,la);else if(d.v0h(G)||this.$.Gd&1){if(Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new ea(this.$,this,G,la)).start(this.Ce,G.DdaMethod.ControlId):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.kHh(G,
la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.$9i(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(G,this.P8c(G.DdaMethod.ControlId),0,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.muh(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Y5i(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.luh(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?
this.kRi(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.lth(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.bnd(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(G.DdaAddRowsColumns.IsRow=!0,this.Zde(G,la)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(G.DdaAddRowsColumns.IsRow=!1,this.Zde(G,la)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.M0g(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.WKg(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(G.DdaSetBindingFormats.IsSetFormats=!0,this.mNf(G,la)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(G.DdaSetBindingFormats.IsSetFormats=!1,this.mNf(G,la)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(G,G.DdaBindingsMethod.ItemName,G.DdaBindingsMethod.FailOnCollision?2:1,la):Ya.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.hzh(la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.rqd(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.hyh(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.iyh(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.mRi(G,la):Ya.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(G.DdaMethod.ControlId,G),this.xe.Bu(la)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?dg.EwaSettings.ka(25)?this.xe.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,la):this.Nhi(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?dg.EwaSettings.ka(25)?this.xe.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,la):this.Jhi(G,
la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(G,la):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(G,la):this.xe.sf(l.a.gvd,la),dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Ya.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){G=this.Ce.fU(G.DdaMethod.ControlId);la="";if(G){la=Dh.DdaFacade.getSolutionId(G,this.$);var Fb=G.PrimaryMarketplace.MarketplaceType;
Fb===OSF.StoreType.InMemory?G.OwnerAddinAssetId&&G.AssetMarketplace&&(Fb=G.AssetMarketplace.MarketplaceType):Fb===OSF.StoreType.WopiCatalog&&(Fb=OSF.StoreType.OMEX);la=Telemetry.PrivacyRules.GetAssetId(Fb,G.PrimaryMarketplace.MarketplaceRef,la)}pe.ULS.sendTraceTag(539353235,344,50,"DDA method Id: {0}, AppID: {1}",Ya.DispatchId,la)}}else this.xe.sf(l.a.sAe,la)};d.prototype.muh=function(G,la){var Ya=this;G.DdaGetBindingData.CoerceType=d.PZb(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.FilterType=
d.cKe(G.DdaGetBindingData.FilterType);G.DdaGetBindingData.ValueFormat=d.O4f(G.DdaGetBindingData.ValueFormat);if(this.Hdc(G.DdaGetBindingData.CoerceType,la)){if(G.DdaGetBindingData){var Fb=G.DdaGetBindingData;Fb.FilterType||(Fb.FilterType=2);Fb.StartCol|=0;Fb.StartRow|=0;Fb.ColCount=void 0===Fb.ColCount?-1:Fb.ColCount;Fb.RowCount=void 0===Fb.RowCount?-1:Fb.RowCount}this.uz.ddaGetBindingData(G.DdaMethod.ControlId,G.DdaGetBindingData.BindingId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,
G.DdaGetBindingData.FilterType,G.DdaGetBindingData.StartRow,G.DdaGetBindingData.StartCol,G.DdaGetBindingData.RowCount,G.DdaGetBindingData.ColCount,function(lc){if(jf.a(lc)||!lc.Result)Ya.xe.yG(lc,la);else{var Lc=Ya.xe.gP();Lc.Data=d.Wle(lc.Result);la(Lc)}},la)}};d.prototype.Y5i=function(G,la){var Ya=this;G.DdaSetBindingData.CoerceType=d.PZb(G.DdaSetBindingData.CoerceType);if(this.Hdc(G.DdaSetBindingData.CoerceType,la)){var Fb=d.VSc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data);d.cbc(Fb)?
this.xe.sf(l.a.xvc,la):(1===Fb.CoerceType&&(Fb.CellFormat||(Fb.CellFormat=G.DdaSetBindingData.CellFormat),Fb.TableOptions||(Fb.TableOptions=G.DdaSetBindingData.TableOptions)),G.DdaSetBindingData&&(G.DdaSetBindingData.StartCol|=0,G.DdaSetBindingData.StartRow|=0),this.uz.ddaSetBindingData(G.DdaMethod.ControlId,G.DdaSetBindingData.BindingId,G.DdaSetBindingData.StartRow,G.DdaSetBindingData.StartCol,Fb,function(lc){jf.a(lc)?Ya.xe.yG(lc,la):Ya.xe.Bu(la)},la))}};d.prototype.kHh=function(G,la){var Ya=this;
G.DdaGetBindingData.CoerceType=d.PZb(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.ValueFormat=d.O4f(G.DdaGetBindingData.ValueFormat);G.DdaGetBindingData.FilterType=d.cKe(G.DdaGetBindingData.FilterType);if(this.Hdc(G.DdaGetBindingData.CoerceType,la)){var Fb=this.P8c(G.DdaMethod.ControlId);Ig.a.na(Fb)?this.xe.sf(l.a.mUe,la):this.uz.ddaGetSelectedData(G.DdaMethod.ControlId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,Fb,function(lc){if(jf.a(lc))Ya.xe.yG(lc,
la);else{var Lc=Ya.xe.gP();Lc.Data=d.Wle(lc.Result);la(Lc)}},la)}};d.prototype.hyh=function(G,la){var Ya=this;if(Ei.a.aid)this.xe.sf(l.a.BCg,la);else{var Fb=G[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],lc=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Lc=G.DdaMethod.ControlId,ad=J.getInstance(this.$);if(0>=lc)pe.ULS.sendTraceTag(8946265,344,15,"Invalid slice size. It should be greater than 0."),this.xe.sf(l.a.zYh,la);else if(lc>J.hgi)pe.ULS.sendTraceTag(8946266,344,
15,"Invalid slice size. It should be not greater than 4MB."),this.xe.sf(l.a.yPe,la);else{var Kd=null;switch(Fb){case 1:Kd="Compressed";break;case 0:Kd="Text";break;case 2:Kd="Pdf";break;default:pe.ULS.sendTraceTag(8946267,344,15,"Requested file type {0} is not supported.",Fb);this.xe.sf(l.a.QJe,la);return}if("Text"===Kd)pe.ULS.sendTraceTag(8946268,344,15,"Requested file type {0} is not supported.",Kd),this.xe.sf(l.a.QJe,la);else{dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(G=new Sys.StringBuilder,G.append($a.a(this.$,Kd)),"Pdf"===Kd&&Lb.a.Bg(G,Ui.a.Kyd,"WholeWorkbook"),G=G.toString()):G=$a.a(this.$,Kd);var ue=null,af=new XMLHttpRequest;af.onreadystatechange=function(){if(4===af.readyState)if(200===af.status){var Xe=af.response;if(Xe){ue=new Uint8Array(Xe);Xe=Ya.xe.gP();for(var pg=ue.length,sg=J.Cki(),lh={},Jh=0,th=0;th<pg;th+=lc){for(var Pi=[],Oh=th+lc<pg?th+lc:pg,pi=0,Ri=th;Ri<Oh;pi++,Ri++)Pi[pi]=ue[Ri];lh[(Jh++).toString()]=Pi}lh=new H(sg,pg,lc,lh);lh=ad.sog(Lc,
lh);lh!==l.a.success?Ya.xe.sf(lh,la):(Xe[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=sg,Xe[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=pg,pe.ULS.sendTraceTag(8946270,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Kd,pg),la(Xe))}else pe.ULS.sendTraceTag(8946269,344,15,"Request is successful, but respone have no data for file type {0}.",Kd),Ya.xe.sf(l.a.internalError,la)}else 500===af.status?Ya.xe.sf(l.a.qMe(parseInt(af.statusText)),
la):(pe.ULS.sendTraceTag(8946271,344,15,"Request failed to obtain the file for type {0}.",Kd),Ya.xe.sf(l.a.jki,la))};af.open("GET",G,!0);af.responseType="arraybuffer";af.setRequestHeader("If-Modified-Since","0");af.send(null)}}}};d.prototype.iyh=function(G,la){var Ya=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Fb=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];G=G.DdaMethod.ControlId;(Ya=J.getInstance(this.$).kyh(G,Ya))?(Ya=Ya.Bij,0>Fb||Fb>=Object.keys(Ya).length?this.xe.sf(l.a.sTh,
la):(Fb=Ya[Fb.toString()],Ya=this.xe.gP(),Ya[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=Fb,Ya[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Fb.length,la(Ya))):this.xe.sf(l.a.internalError,la)};d.prototype.mRi=function(G,la){var Ya=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];G=G.DdaMethod.ControlId;Ya=J.getInstance(this.$).lRi(G,Ya);Ya===l.a.success?this.xe.Bu(la):this.xe.sf(Ya,la)};d.prototype.$9i=function(G,la){var Ya=this;G.DdaSetBindingData.CoerceType=
d.PZb(G.DdaSetBindingData.CoerceType);if(this.Hdc(G.DdaSetBindingData.CoerceType,la)){var Fb=this.P8c(G.DdaMethod.ControlId);if(Ig.a.na(Fb))this.xe.sf(l.a.joe,la);else{var lc=d.VSc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data),Lc=ti.g(this.$).ga;1===lc.CoerceType&&(!lc.Data&&Lc.ya.TU&&(lc.Headers||(lc.Headers=[]),lc.Headers.length||Array.add(lc.Headers,[]),lc.Headers[0].length||Array.add(lc.Headers[0],"")),d.cbc(lc)||(lc.CellFormat||(lc.CellFormat=G.DdaSetBindingData.CellFormat),lc.TableOptions||
(lc.TableOptions=G.DdaSetBindingData.TableOptions)));if(d.cbc(lc))this.xe.sf(l.a.xvc,la);else{var ad=Lc.ya.Xd.clone(),Kd=Lc.ya.activeCell.clone();this.uz.ddaSetSelectedData(G.DdaMethod.ControlId,Fb,lc,function(ue){if(jf.a(ue))Ya.xe.yG(ue,la);else{ue=ad.clone();var af=lc.Headers?lc.Headers[0].length:lc.Data[0].length;1!==lc.CoerceType||lc.Data?1===lc.CoerceType&&lc.TableOptions&&lc.TableOptions.length&&0==lc.TableOptions[0]?(ue.top+=1,ue.bottom=ue.top+lc.Data.length-1):ue.bottom=ue.top+lc.Data.length-
(1===lc.CoerceType?0:1):ue.bottom=ue.top+1;ue.right=ue.left+af-1;af=ue.contains(Kd)?Kd:ue.topLeft;Lc.updateSelection(ue,af,0);Ya.xe.Bu(la)}},la)}}}};d.prototype.addBinding=function(G,la,Ya,Fb){var lc=this;la?this.uz.ddaAddBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,G.DdaBindingsMethod.BindingType,la,Ya,function(Lc){if(jf.a(Lc))lc.xe.yG(Lc,Fb);else{var ad=lc.xe.gP();ad.Bindings=Array(1);ad.Bindings[0]=lc.Ce.BXb(Lc.Result);Fb(ad)}},Fb):this.xe.sf(l.a.r3i,Fb)};d.prototype.luh=function(G,
la){var Ya=this;this.uz.ddaGetBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(Fb){if(jf.a(Fb)||!Fb.Result)Ya.xe.yG(Fb,la);else{var lc=Ya.xe.gP();lc.Bindings=Array(1);lc.Bindings[0]=Ya.Ce.BXb(Fb.Result);la(lc)}},la)};d.prototype.hzh=function(G){var la=this.xe.gP(),Ya={};Ya[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;la[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Ya;G(la)};d.prototype.kRi=function(G,la){var Ya=this;this.uz.ddaReleaseBinding(G.DdaMethod.ControlId,
G.DdaBindingsMethod.BindingId,function(Fb){jf.a(Fb)?Ya.xe.yG(Fb,la):Ya.xe.Bu(la)},la)};d.prototype.lth=function(G,la){var Ya=this;this.uz.ddaGetAllBindings(G.DdaMethod.ControlId,function(Fb){if(jf.a(Fb))Ya.xe.yG(Fb,la);else{var lc=Ya.xe.gP();if(Fb.Result){Fb=Fb.Result;lc.Bindings=Array(Fb.length);for(var Lc=0;Lc<Fb.length;Lc++)lc.Bindings[Lc]=Ya.Ce.BXb(Fb[Lc])}else lc.Bindings=null;la(lc)}},la)};d.prototype.bnd=function(G,la){var Ya=this;this.uz.ddaLoadSettings(G.DdaMethod.ControlId,function(Fb){if(jf.a(Fb))Ya.xe.yG(Fb,
la);else{var lc=Ya.xe.gP();lc.Properties=Fb.Result;la(lc)}},la)};d.prototype.saveSettings=function(G,la){for(var Ya=this,Fb={Settings:[]},lc=0;lc<G.DdaSettingsMethod.Properties.length;lc++){var Lc={};Lc.Name=G.DdaSettingsMethod.Properties[lc][0];Lc.Value=G.DdaSettingsMethod.Properties[lc][1];Fb.Settings[lc]=Lc}this.uz.ddaSaveSettings(G.DdaMethod.ControlId,Fb,G.DdaSettingsMethod.OverwriteIfStale,function(ad){jf.a(ad)?Ya.xe.yG(ad,la):Ya.xe.Bu(la)},la)};d.prototype.Zde=function(G,la){var Ya=this,Fb=
d.VSc(1,G.DdaAddRowsColumns.Data);d.cbc(Fb)?this.xe.sf(l.a.xvc,la):this.uz.ddaAddRowsColumns(G.DdaMethod.ControlId,G.DdaAddRowsColumns.BindingId,G.DdaAddRowsColumns.IsRow,Fb,function(lc){jf.a(lc)?Ya.xe.yG(lc,la):Ya.xe.Bu(la)},la)};d.prototype.M0g=function(G,la){var Ya=this;this.uz.ddaDeleteAllDataValues(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(Fb){jf.a(Fb)?Ya.xe.yG(Fb,la):Ya.xe.Bu(la)},la)};d.prototype.WKg=function(G,la){var Ya=this;this.uz.ddaClearBindingFormats(G.DdaMethod.ControlId,
G.DdaClearBindingFormats.BindingId,function(Fb){jf.a(Fb)?Ya.xe.yG(Fb,la):Ya.xe.Bu(la)},la)};d.prototype.mNf=function(G,la){var Ya=this,Fb={},lc=G.DdaSetBindingFormats.IsSetFormats;lc?Fb.CellFormat=G.DdaSetBindingFormats.CellFormat:Fb.TableOptions=G.DdaSetBindingFormats.TableOptions;this.uz.ddaSetBindingFormats(G.DdaMethod.ControlId,G.DdaSetBindingFormats.BindingId,Fb,lc,function(Lc){jf.a(Lc)?Ya.xe.yG(Lc,la):Ya.xe.Bu(la)},la)};d.prototype.executeRichApiRequest=function(G,la){var Ya=this,Fb=G.ArrayData,
lc={},Lc=ti.g(this.$).ga;if(Fb){if("WacPartition"===Fb[0]){this.Pih(G,la);return}var ad=Object(Ci.a)(Dh.DdaFacade,Wi.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Fb[0]){var Kd=ad.fn(G.DdaMethod.ControlId);Kd&&(Kd.Sid=!0,Kd.hzf())}lc.HttpMethod=Fb[1];lc.PathAndQuery=Fb[2];lc.RequestHeaders=d.VQe(Fb[3]);lc.RequestBody=Fb[4];lc.AppPermission=Fb[5];Kd=Fb[6];lc.RequestFlags=Kd;var ue=0;if(Sj.i(this.$.sa))switch(Lc.Ze){case 1:ue=2;break;case 2:ue=3;break;case 128:ue=4;break;default:ue=
1}var af=null;Lc.Sa.XB&&(af=Lc.Sa.XB.qj);lc.SheetMultiRange=yj.r(Lc.ya.selectedRanges,this.$);lc.ActiveCell=yj.v(Lc.ya.activeCell,this.$);lc.ActiveChartId=af;lc.SelectionState=ue;ue=this.Ce.fU(G.DdaMethod.ControlId);lc.InstanceId=ue?ue.InstanceId:"";if(ue&&ue.PrimaryMarketplace){af=Dh.DdaFacade.getSolutionId(ue,this.$);var Xe=ue.PrimaryMarketplace.MarketplaceType;if(Xe===OSF.StoreType.InMemory){if(dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)){if(!ue.OwnerAddinSolutionId){this.xe.sf(l.a.U2a,la);return}}else if(!ue.OwnerAddinAssetId){this.xe.sf(l.a.U2a,la);return}if(ue.AssetMarketplace)Xe=ue.AssetMarketplace.MarketplaceType;else{this.xe.sf(l.a.U2a,la);return}}else Xe===OSF.StoreType.WopiCatalog&&(Xe=OSF.StoreType.OMEX);var pg=Telemetry.PrivacyRules.GetAssetId(Xe,ue.PrimaryMarketplace.MarketplaceRef,af);lc.CompliantSolutionId=pg;lc.SolutionId=af;lc.MarketplaceType=Xe;lc.SolutionVersion=ue.PrimaryMarketplace.SolutionVersion;lc.StoreLocation=
ue.PrimaryMarketplace.MarketplaceRef}else lc.SolutionId=lc.MarketplaceType="",lc.CompliantSolutionId="";lc.IsEventsEnabled=void 0===ad||null===ad||ad.dj.PWb(lc.InstanceId);lc.RequestGuid=gj.a.create().toString();ad=lc.RequestBody.length;if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&ad>this.$.Ba.ExcelRichApiMaxAllowedRequestPayloadSize){this.xe.sf(l.a.fYi,la);pe.ULS.sendTraceTag(578048010,0,50,"Request payload size:{0} exceeded the limit",ad);return}dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
Kd&4096&&(ad=new X(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(ad,ja,Fb),lc.RequestBody=Fb[4])}var sg=d.STe(lc.RequestHeaders);d.Yvd++;var lh=Lh.a.Ta.Lb;dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&lc&&lc.RequestBody&&pe.ULS.sendTraceTag(589608415,0,50,String.format("Richapi json request body size is {0}",lc.RequestBody.length));this.uz.executeRichApiRequest(lc,function(Jh){Ya.vMf(lh,!0,Jh.ServerCorrelationId);var th=null,Pi=null,Oh=Jh.ServerCorrelationId;
Jh&&Jh.Errors&&Jh.Errors[0]&&(th=Jh.Errors[0].MessageIdName,Pi=Jh.Errors[0].Description,dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&dl.a(Ya.$).ld.AO(Jh.Errors[0].MessageId));if(jf.a(Jh)||!Jh.Result)Ya.MLa(Oh,sg,"Server error",th,Pi),Ya.xe.yG(Jh,la);else{var pi=null;if(dg.EwaSettings.ka(263)){var Ri=Jh.Result;if(Ri&&Ri.length){for(var Zj=0;Zj<Ri.length;Zj++)if(Ri[Zj].RequestGuid===lc.RequestGuid){pi=Ri[Zj];break}pi||Ya.xe.yG(Jh,la)}else pi=Jh.Result}else pi=Jh.Result;
if(!th&&pi&&pi.ResponseBody&&!Ig.a.na(pi.ResponseBody[0]))if(Jh=pi.ResponseBody[0],Jh.startsWith('{"Error":')){1<pi.ResponseBody.length&&(Jh=Jh.substring(0,Jh.indexOf("}")+1),Jh+="}");try{var Gj=Qh.a.gi(Jh);Gj.Error&&Ya.MLa(Oh,sg,"Pipeline error",Gj.Error.d7f,Gj.Error.Message)}catch($k){Ya.MLa(Oh,sg,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Ya.MLa(Oh,sg);else Ya.MLa(Oh,sg,"Server error",th,Pi);var Wj=(Gj=pi.SheetMultiRange)?Gj.SheetName:null;Jh=pi.ActiveChartId;var Hj=
pi.SelectionState;th=5===Hj&&!!Gj||6===Hj||7===Hj||8===Hj;if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Ya.$.Db.MJ&&th)Ya.xe.sf(l.a.yxc,la),pe.ULS.sendTraceTag(590488150,0,50,String.format("{0} is not allowed",Hj.toString()));else if(5===Hj&&Gj){if(Ya.$.Aa&&Wj)if(Ya.$.Aa.Gj(Wj))Ya.SNc(Wj);else{var ek=null;ek=function(){Ya.$.Aa.Gj(Wj)&&(pe.ULS.sendTraceTag(593900563,0,50,"Sheets item add event handler called"),Ya.SNc(Wj),Ya.$.Aa.b9a(ek))};Ya.$.Aa.lWa(ek);
if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Wk=null;Wk=function(){Ya.$.Aa.Gj(Wj)&&(Ya.SNc(Wj),Ya.$.Aa.ula(Wk))};Ya.$.Aa.Sfa(Wk)}}}else if(6===Hj||7===Hj||8===Hj||9===Hj){if(Gj){var Sk=yj.g(Gj.Ranges);if(Wj&&yj.bb(Sk,!0))if(dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Ya.$.Aa.Gj(Wj)){var Zk=null;Zk=function(){Ya.q3f(Lc,Sk,Wj,Hj);Ya.$.Aa.ula(Zk)};Ya.$.Aa.Sfa(Zk)}else Ya.q3f(Lc,Sk,
Wj,Hj)}7===Hj?(Jh="38.{"+Pk.c(Jh)+"}",nk.a(Ya.$).Rla(0,Jh,!0)):8===Hj&&nk.a(Ya.$).Rla(2,Jh,!0);9===Hj&&(Ya.$.Ba.ApiCallToSetPageLayout=!0)}Ig.a.na(pi.PostProcessActions)?Ya.f$a(pi,la):Ya.$.n7e?(Oh=Qh.a.gi(pi.PostProcessActions),Ya.fHi(Oh).then(function(){Ya.f$a(pi,la);Ya.Z5c(G.DdaMethod.ControlId,lc);return Promise.resolve(null)},function($k){Ya.f$a(pi,la,$k);return Promise.reject($k)})):(Ya.MLa(Oh,sg,"Promise not supported",null,"Promise is not supported on this browser."),Ya.xe.sf(l.a.internalError,
la))}},function(Jh){Ya.vMf(lh,!1,null);Ya.MLa(null,sg,"Web service error");la(Jh)})};d.prototype.Z5c=function(G,la){var Ya=Object(Ci.a)(Dh.DdaFacade,Wi.a(this.$));Ya&&Ya.AEd&&Ya.fn(G)&&d.Pcj(la.RequestHeaders)&&(pe.ULS.sendTraceTag(592196423,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",G,la.SolutionId),Ya.AEd.m9g(G))};d.prototype.Pih=function(G,la){var Ya=this,Fb=this.Ce.fU(G.DdaMethod.ControlId),lc=Dh.DdaFacade.getSolutionId(Fb,
this.$),Lc=null;Lc=Dh.DdaFacade.Cta(Fb,this.$);Lc=new B(Lc,this.$);Lc=new c(lc,G.DdaMethod.ControlId,this.Ce,this.$,Lc);var ad={ResponseHeaders:[]};ad.ResponseBody=Array(1);Fb=d.VQe(G.ArrayData[3]);var Kd=d.STe(Fb);Fb=new ba(this.$.Ba.CreateWorkbookMaxAllowedBase64Size,this.lhf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Lc,ha,Fb,G.ArrayData).then(function(ue){if(!ue)return Ya.Knd(!1,"The rich api executor call failed",Kd),pe.ULS.sendTraceTag(36542158,0,10,"The rich api executor call failed"),
ad.ResponseStatusCode=500,Ya.f$a(ad,la),null;Ya.Knd(!0,"The rich api executor call succeeded",Kd);ad.ResponseStatusCode=ue[0];ad.ResponseBody[0]=ue[2];Ya.f$a(ad,la);return null},function(ue){ad.ResponseStatusCode=400;ad.ResponseBody[0]=ue.toString();Ya.Knd(!1,"The rich api executor call failed",Kd);pe.ULS.sendTraceTag(36542159,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",lc);Ya.f$a(ad,la);return null})};d.prototype.vMf=function(G,la,Ya){d.Yvd--;G=bl.a(Lh.a.Ta,G);pe.ULS.sendTraceTag(36763356,
0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",G,d.Yvd,la?"success":"false",Ya)};d.prototype.f$a=function(G,la,Ya){Ya=void 0===Ya?null:Ya;var Fb=Array(3);Fb[0]=G.ResponseStatusCode;Fb[1]=d.uIh(G.ResponseHeaders);var lc=[],Lc=!1;if(Ya&&G.ResponseBody){var ad=Qh.a.gi(G.ResponseBody.join(""));ad.Error||(Lc={},Lc.Error=Ya,Lc.A8f=ad.A8f,Lc.a8f={},Lc.a8f.Results=ad.Results,lc[0]=Qh.a.Oc(Lc),Lc=!0)}Fb[2]=Lc?lc:G.ResponseBody;
G=this.xe.gP();G.Data=Fb;la(G)};d.prototype.rqd=function(G,la){(new L(this.$,this.xe,this.uz)).rqd(G,la)};d.prototype.Nhi=function(G,la){pe.ULS.sendTraceTag(19931724,0,50,"MessageParent API called!");var Ya=G[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Fb=G[Vg.a.YPc],lc=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];G=this.$.ea.Ea(232,void 0).JZa.Ohi(G.DdaMethod.ControlId,Ya,Fb,lc);G===l.a.success?this.xe.Bu(la):(pe.ULS.sendTraceTag(19931725,0,10,"MessageParent API Failed!"),this.xe.sf(G,
la))};d.prototype.Jhi=function(G,la){pe.ULS.sendTraceTag(595121570,0,50,"MessageChild API called!");var Ya=G[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Fb=G[Vg.a.YPc],lc=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.ea.Ea(232,void 0).JZa.s4i(G.DdaMethod.ControlId,Ya,Fb,lc);this.xe.Bu(la)};d.prototype.getAccessToken=function(G,la){function Ya(Lc,ad){if(Lc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Lc=Fb.xe.gP(),Lc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=
ad.accessToken,la(Lc);else{ad=Fb.Ce.fU(G.DdaMethod.ControlId);var Kd=dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?null!==ad.OwnerAddinSolutionId?ad.OwnerAddinSolutionId:ad.PrimaryMarketplace.MarketplaceType:null!==ad.OwnerAddinAssetId?ad.OwnerAddinAssetId:ad.PrimaryMarketplace.MarketplaceType;var ue={};pe.ULS.sendTraceTag(542185163,0,10,"{0}.",(ue.errorCode=Lc.toString(),ue.appId=Telemetry.PrivacyRules.GetAssetId(Kd,ad.PrimaryMarketplace.MarketplaceRef,
Dh.DdaFacade.getSolutionId(ad,Fb.$)),ue.storeType=Kd,ue));Fb.xe.sf(Lc,la)}}var Fb=this;pe.ULS.sendTraceTag(22071488,0,50,"GetAccessToken API called!");var lc=!dg.EwaSettings.ka(25);xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(this.$.ea,137,this.$.ma,1,"Postmessage.IHostPostmessenger"),function(Lc){var ad=Fb.Ce.Ah,Kd=Sa.getInstance();Fk.AppsForOfficeSingleSignOnManager.getInstance(ad,Lc.result,Kd).getAccessToken(G.DdaMethod.ControlId,lc,G,Ya)},this.$.ma)};d.prototype.getAuthContext=function(G,
la){var Ya=this;xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(this.$.ea,137,this.$.ma,1,"Postmessage.IHostPostmessenger"),function(){var Fb=Ya.Ce.Ah.getOsfControl(G.DdaMethod.ControlId);if(!dg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Fb.isFirstParty()){Fb=Fb.getManifest();var lc=Fb.getMarketplaceID(),Lc=Fb.getWebApplicationId(),ad=Fb.getWebApplicationMsaId();ei.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(lc).then(function(Kd){var ue=
Ya.xe.gP(),af={};af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Lc;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ad?ad:Lc;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Kd.upn;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Kd.userId;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Kd.authority;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=mb.Vth(Kd.authorityType);af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Kd.isAnonymous;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Kd.tenantId;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Kd.supportsAuthToken;ue[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=af;la(ue)},function(Kd){var ue=Ya.xe.gP(),af={},Xe=new mb;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Lc;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ad?ad:Lc;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Xe.upn;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Xe.userId;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Xe.authority;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Xe.authorityType;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Xe.isAnonymous;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Xe.tenantId;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Kd;af[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
Xe.supportsAuthToken;ue[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=af;ue.Error=1;la(ue)})}},this.$.ma)};d.prototype.m0h=function(G){var la=ti.g(this.$).ga;return 16===la.Ze&&!!la.Sa.nc&&!!la.Sa.nc.floatingObject&&Ig.a.equals(la.Sa.nc.floatingObject.id,G,!0)};d.prototype.P8c=function(G){var la=ti.g(this.$).ga;return la.ya.Eh?1===la.Ze||this.m0h(G)?la.hha:null:null};d.prototype.Hdc=function(G,la){return 1!==G&&2!==G&&3!==G?(this.xe.sf(l.a.xre,la),!1):!0};d.prototype.Knd=function(G,
la,Ya){var Fb={};Fb.a=this.$.Ba.UserSessionId;Fb.b=G;Fb.c=la;Fb.d=null;Fb.e=Ya;yk.b().Se(37,Fb)};d.prototype.MLa=function(G,la,Ya,Fb,lc){Ya=void 0===Ya?null:Ya;Fb=void 0===Fb?null:Fb;lc=void 0===lc?null:lc;var Lc={};Ig.a.na(G)||(Lc.ServerCorrelationId=G);void 0!==la&&null!==la&&(Lc.Source=la);Ig.a.na(Ya)||(Lc.ErrorType=Ya);Ig.a.na(Fb)||(Lc.MessageId=Fb);Ig.a.na(lc)||(Lc.StatusDescription=lc);pe.ULS.sendTraceTag(50688452,0,50,Qh.a.Oc(Lc))};d.prototype.fHi=function(G){for(var la=new Promise(function(Fb){Fb(null)}),
Ya=0;Ya<G.length;Ya++)la=this.eHi(la,G[Ya]);return la};d.prototype.eHi=function(G,la){var Ya=this;if(!la)return pe.ULS.sendTraceTag(34625095,0,10,"Null PostProcessAction."),G.then(function(){return Promise.reject(d.z0a(OfficeExtension.Runtime.ErrorCodes.generalException,Rf.a.instance.da(1687),null))});switch(la.actionType){case 1:case 2:G=G.then(function(){var Fb=Object(Ci.a)(Dh.DdaFacade,Wi.a(Ya.$));if(Fb.fn(la.controlId))switch(Fb.dj.fNh(la),la.messageType){case 14:case 100:Fb.zEd.jXb(la);break;
case 11:case 12:Fb.J_i.Flb(la);break;case 51:case 52:Fb.H_i.Flb(la);break;case 2101:case 2102:Fb.I_i.Flb(la);break;case 2E3:Fb.K_i.jXb(la);break;case 2201:Ya.$.zja&&Fb.AEd.uzg(la);break;case 2203:Fb.L_i.vzg(la);break;case 2700:dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Fb.yEd.jXb(la)}else pe.ULS.sendTraceTag(23941466,0,10,"OsfControl with instanceId[{0}] doesn't exist.",la.controlId);return Promise.resolve(null)});break;case 3:G=G.then(function(){Ya.VMh(la);return Promise.resolve(null)});
break;case 15:dg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(G=G.then(function(){Ya.tOh(la);return Promise.resolve(null)}));break;case 4:G=G.then(function(){if(dg.EwaSettings.ka(106)){var Fb=ti.g(Ya.$).ga.ya.activeCell;Fb.top!==la.row+1&&Fb.left!==la.column+1&&(Fb=yj.v(ka.Range.xd(la.row+1,la.column+1),Ya.$),ti.g(Ya.$).ui(Fb,null,null,null,3,Xf.a.x_g));lj.a(Ya.$,243,242,0,function(lc){lc.PHb(la.row+1,la.column+1,1,!1,!1)},"Microsoft.Office.Excel.WebUI.Client.CardView.ICardViewManager")}return Promise.resolve(null)});
break;case 7:G=G.then(function(){Object(Ci.a)(Dh.DdaFacade,Wi.a(Ya.$)).dj.rCe(la.controlId,la.isEnableEvents);return Promise.resolve(null)});break;case 5:G=G.then(function(){return Ya.RYg(la)});break;case 6:G=G.then(function(){return Ya.vCi(la)});break;case 8:G=G.then(function(){dg.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(Ci.a)(Dh.DdaFacade,Wi.a(Ya.$)).VKg();var Fb=new gl.a(hl.a.Ck,5,null);fl.a(Ya.$).Nr(Fb);return Promise.resolve(null)});
break;case 9:G=G.then(function(){return Ya.a6i(la)});break;case 10:G=G.then(function(){return Ya.RCj(la)});break;case 11:G=G.then(function(){return Ya.QCj()});break;case 12:G=G.then(function(){return Ya.NCj()});break;case 13:G=G.then(function(){return Ya.OCj(la)});break;case 14:G=G.then(function(){return Ya.PCj(la)});break;case 16:G=G.then(function(){return Promise.resolve(la)});break;case 17:G=G.then(function(){return Ya.t2i(la,Object(Ci.a)(Dh.DdaFacade,Wi.a(Ya.$)))});break;case 18:ti.g(this.$).focus();
break;default:G=G.then(function(){return Promise.reject(d.z0a(OfficeExtension.Runtime.ErrorCodes.apiNotFound,Rf.a.instance.da(1688),null))})}return G};d.prototype.tOh=function(G){var la=Object(Ci.a)(Dh.DdaFacade,Wi.a(this.$)).fn(G.controlId);if(la&&!(!G.operationType^!la.xca)){ti.g(this.$).adc=!0;switch(G.operationType){case 0:var Ya=new el.a(document.createElement("input"));Ya.text=G.range;la.pWh(ti.g(this.$).Vi.kXg(Ya,new Ok.a(this.$)));la.xca.startEdit(!0);break;case 1:la.DEf();this.rangePicker=
null;break;case 2:la.xca.G3f(G.range);break;case 3:la.xca.G3f(G.startingRange);la=G.expandSelection;Ya=G.getNextDataRegionCell;var Fb=0;switch(G.keyboardDirectionValue){case 2:Fb=38;G=la&&Ya?105288353:la?-31900117:Ya?542791952:137938150;break;case 3:Fb=40;G=la&&Ya?-1297307319:la?-1603798598:Ya?1713663844:-798660877;break;case 0:Fb=37;G=la&&Ya?-403586027:la?2039316657:Ya?-2012742350:-1470715894;break;case 1:Fb=39;G=la&&Ya?784916030:la?589730764:Ya?1324884057:-1231471547;break;default:G=1461300262}la=
this.w0b("keydown",Fb,la,Ya);ti.g(this.$).vFb(la,new hj.a(G,1,0,8,null))}ti.g(this.$).adc=!1}};d.prototype.w0b=function(G,la,Ya,Fb){var lc=document.createEvent("KeyboardEvent");if(Ei.a.zE)lc.initKeyboardEvent(G,!1,!1,window.self,"A",0,Fb,!1,Ya,!1);else{var Lc="";Ya&&(Lc+="Shift");Fb&&(Lc+=0<Lc.length?" Control":"Control");lc.initKeyboardEvent(G,!1,!1,window.self,"A",0,Lc,!1,"en-US")}G=new Sys.UI.DomEvent(lc);G.keyCode=la;return G};d.prototype.VMh=function(G){switch(G.operationType){case 1:xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(this.$.ea,
153,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager"),function(la){la.result.tDd()},this.$.ma,3);break;case 2:if(G=Object(Ci.a)(Dh.DdaFacade,Wi.a(this.$)).fn(G.controlId))G.Sid=!0,G.hzf()}};d.prototype.RYg=function(G){var la=this,Ya=G.fileBase64;return Ya&&Ya.length>this.$.Ba.CreateWorkbookMaxAllowedBase64Size?Promise.reject(d.z0a(OfficeExtension.Runtime.ErrorCodes.invalidArgument,Rf.a.instance.da(1691),"Application.CreateWorkbook")):(new Promise(function(Fb,
lc){var Lc=new n.StandardDialog;Lc.lc=4;Lc.Hl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(ad){2!==ad&&ad||lc(d.z0a(OfficeExtension.Runtime.ErrorCodes.operationCancelled,Rf.a.instance.da(1690),"Application.CreateWorkbook"));ad=new oa("blank","agave",Ya?"streamBase64":"streamEmpty",Ya);la.lhf.create(Fb,lc,ad).XYa()})})).then(function(Fb){la.b5c.add(G.fakeFileId,Fb);return Promise.resolve(null)},function(Fb){return Fb?Promise.reject(Fb):Promise.reject(d.z0a(OfficeExtension.Runtime.ErrorCodes.generalException,
Rf.a.instance.da(1687),"Application.CreateWorkbook"))})};d.prototype.vCi=function(G){var la=this;return new Promise(function(Ya,Fb){var lc=null;(function(){var Lc=la.b5c.Ec(G.fakeFileId);lc=Lc.value;return Lc})().returnValue?(Fb=new n.StandardDialog,Fb.lc=4,Fb.Hl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Lc){1===Lc&&rh.HelperMethods.wf(lc,void 0,void 0,"DdaMethodHandler.fileUrl");Ya(null)})):Fb(d.z0a(OfficeExtension.Runtime.ErrorCodes.generalException,
Rf.a.instance.da(1687),"Document.Open"))})};d.prototype.a6i=function(G){var la=this;return new Promise(function(Ya){Object(Ci.a)(Dh.DdaFacade,Wi.a(la.$)).iJf=G.runtimeCalculationMode;var Fb=la.$.ea.Ea(268,void 0);Fb&&Fb.trd(3===G.runtimeCalculationMode);Ya(null)})};d.prototype.RCj=function(G){aj.a.axb(this.$)&&this.$.ea.Ea(331,void 0).g$a(0,G.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.QCj=function(){aj.a.axb(this.$)&&this.$.ea.Ea(331,void 0).g$a(1,null,!0,!0,null);return Promise.resolve(null)};
d.prototype.NCj=function(){aj.a.axb(this.$)&&this.$.ea.Ea(331,void 0).pCe();return Promise.resolve(null)};d.prototype.OCj=function(G){aj.a.axb(this.$)&&this.$.ea.Ea(331,void 0).g$a(5,G.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.PCj=function(G){if(aj.a.axb(this.$)){var la=this.$.ea.Ea(331,void 0);la=Ml(la.m$);for(var Ya=la.next();!Ya.done;Ya=la.next())Ya=Ya.value,Ya.IsActive&&Ya.HostEditUrl&&Ya.UrlStr===G.hostEditUrlStr&&rh.HelperMethods.wf(Ya.HostEditUrl,"_blank")}return Promise.resolve(null)};
d.prototype.t2i=function(G,la){var Ya=K.a.eW;G=Qh.a.gi(G.payload);var Fb={};"eventId"in G&&"payload"in G&&(Fb.eventId=G.eventId,Fb.payload=G.payload);la.$L(2201,Ya,Qh.a.Oc(Fb));return Promise.resolve(null)};d.prototype.SNc=function(G){(G=Object(Ci.a)(cl.a,this.$.Aa.getItemByName(G)))&&G.visible&&G.activate(!0)};d.prototype.q3f=function(G,la,Ya,Fb){var lc=G.ya.pA,Lc=lc<la.length&&la[lc].contains(G.ya.activeCell);G=Lc?G.ya.activeCell:la[0].topLeft;lc=Lc?lc:0;ti.g(this.$).sU(la,lc,Ya,null,G,null,null,
3,Xf.a.y_g,void 0,void 0,void 0,6===Fb)};d.VQe=function(G){if(!G||!G.length)return null;for(var la=Array(G.length/2),Ya=0;Ya<G.length/2;Ya++)la[Ya]={},la[Ya].Name=G[2*Ya],la[Ya].Value=G[2*Ya+1];return la};d.uIh=function(G){if(!G||!G.length)return null;for(var la=Array(2*G.length),Ya=0;Ya<G.length;Ya++)la[2*Ya]=G[Ya].Name,la[2*Ya+1]=G[Ya].Value;return la};d.l6c=function(G){if(!G||!G.length)return null;for(var la=Array(G.length),Ya=0,Fb=G.length;Ya<Fb;Ya++){var lc=G[Ya].length;if(lc){la[Ya]=Array(lc);
for(var Lc=0;Lc<lc;Lc++)la[Ya][Lc]=null==G[Ya][Lc]?null:G[Ya][Lc].toString()}else return null}return la};d.PZb=function(G){return"string"===typeof G?Uk.a.Nn(d.t_g,G,0):G};d.cKe=function(G){return"string"===typeof G?Uk.a.Nn(d.w_g,G,0):G};d.O4f=function(G){return"string"===typeof G?Uk.a.Nn(d.A_g,G,0):G};d.v0h=function(G){switch(G.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};d.VSc=function(G,la){var Ya={};Ya.CoerceType=G;1===Ya.CoerceType?(Ya.Data=
d.l6c(la.Rows),Ya.Headers=d.l6c(la.Headers)):Ya.Data=d.l6c(la);return Ya};d.Wle=function(G){if(1===G.CoerceType){var la={};return la.Headers=G.Headers,la.Rows=G.Data,la}return G.Data};d.cbc=function(G){return 1===G.CoerceType?!G.Data&&!G.Headers:!G.Data};d.STe=function(G){var la="Unknown";if(!G)return la;for(var Ya=0;Ya<G.length;Ya++)if(G[Ya].Name.toLowerCase()===Ui.a.M_i){la=G[Ya].Value;break}return la};d.Pcj=function(G){if(!G)return!1;for(var la=Ui.a.$mi.toLowerCase(),Ya=0;Ya<G.length;Ya++)if(G[Ya].Name.toLowerCase()===
la)return!0;return!1};d.z0a=function(G,la,Ya){var Fb={};Fb.d7f=G;Fb.Message=la;Fb.Location=Ya;Fb.EDj=0;return Fb};Jl.Object.defineProperties(d.prototype,{zP:{configurable:!0,enumerable:!0,get:function(){return this.xe}}});Jl.Object.defineProperties(d,{t_g:{configurable:!0,enumerable:!0,get:function(){d.foa||(d.foa={},d.foa[Microsoft.Office.WebExtension.CoercionType.Table]=1,d.foa[Microsoft.Office.WebExtension.CoercionType.Text]=2,d.foa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,d.foa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,d.foa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return d.foa}},w_g:{configurable:!0,enumerable:!0,get:function(){d.Eeb||(d.Eeb={},d.Eeb[Microsoft.Office.WebExtension.FilterType.All]=1,d.Eeb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return d.Eeb}},A_g:{configurable:!0,enumerable:!0,get:function(){d.Feb||(d.Feb={},d.Feb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,d.Feb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return d.Feb}}});d.foa=null;d.Eeb=
null;d.Feb=null;d.Yvd=0;Object(sd.a)(d,"DdaMethodHandler",null,[159,7]);var Vk=Hi.a;Cm(a,Vk);a.prototype.Rd=function(){var G=this,la=Xi.GetServiceTaskFactory.create(this.$.ea,106,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.Agave.IWebExtensionService"),Ya=Xi.GetServiceTaskFactory.create(this.$.ea,165,this.ma,this.vb,"System.IDisposable"),Fb=Ga(this.ma,this.vb);xh.TaskExtensions.Da(xh.TaskExtensions.Fe([la,Ya,Fb],this.ma),function(){var Lc=la.result,ad=ei.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
G.Hd([new d(G.$,Lc,ad)])},this.ma,3);var lc=ei.a.instance;xh.TaskExtensions.Da(Xi.GetServiceTaskFactory.create(this.$.ea,137,this.$.ma,this.vb,"Postmessage.IHostPostmessenger"),function(){lc.register(Oa,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ac().Lc(function(){return new Oa})},this.$.ma)};a.la=function(G){Hi.a.ie(82,new a(G))};Object(sd.a)(a,"DdaCommandHandlerFactory",Hi.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");ye.a.Xi("");ye.a.Xi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ze.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.WopiIdentity");$i.main();(function(){Ti.a.Ja(function(G){lf.la(G)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Ti.a.Ja(function(G){Pe.la(G);ne.la(G)})})();(function(){Ti.a.Ja(function(G){Yf.la(G)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){Ti.a.Ja(function(G){dg.EwaSettings.ka(54)&&nc.la(G)})})();(function(){Ti.a.Ja(function(G){dg.EwaSettings.ka(123)&&Bb.la(G)})})();
Ti.a.Ja(cb.la);Ti.a.Ja(td.la);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){Ti.a.Ja(function(G){Ua.la(G);ca.la(G)})})();Ti.a.Ja(a.la)},1395:function(D,F,b){function a(){this.Myc=null;this.uDc=0;this.bFc=!1;this.rb=new m.a;this.feg=new c.a}function d(){this.qBe=this.displayName=this.Tnb=this.$q=this.Yy=null}D=b(0);var c=b(210),m=b(94);d.prototype.Gjd=function(r,t){return this.Yy.getStoreType().toLowerCase()===r.toLowerCase()&&this.Yy.getMarketplaceID().toLowerCase()===
t.toLowerCase()};Object(D.a)(d,"AddinCommandsResourceItem",null,[]);b.d(F,"a",function(){return a});a.prototype.erg=function(r){this.rb.addHandler("AddinCommandsLoadingMessageChanged",r)};a.prototype.OSi=function(r){this.rb.removeHandler("AddinCommandsLoadingMessageChanged",r)};a.prototype.H$a=function(r){r!==this.Myc&&(this.Myc=r,this.rb.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.X5i=function(){this.uDc++;this.tWa||this.H$a(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.vqc=
function(){this.uDc--;this.fnd()&&(this.bFc?this.tWa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.H$a(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.H$a(null))};a.prototype.aOf=function(r){this.bFc=!0;this.H$a((void 0===r?0:r)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.Tpe=function(){this.bFc=!1;this.fnd()?this.H$a(null):this.H$a(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.fnd=function(){return 0>=this.uDc};a.prototype.KP=
function(r,t,k){k=void 0===k?0:k;for(var u=Ml(this.R2a),w=u.next();!w.done;w=u.next())if(w=w.value,w.Gjd(r,t)&&(!w.$q||w.$q.tsh===k))return w;return null};a.prototype.Gde=function(r,t,k,u){var w=new d;w.Yy=r;w.$q=t;w.Tnb=k;w.displayName=u;this.R2a.add(w)};a.prototype.mpg=function(r,t,k,u){var w=new d;w.Yy=r;w.$q=t;w.Tnb=null;w.qBe=k;w.displayName=u;this.R2a.add(w)};a.prototype.tRi=function(r,t){for(var k=0,u=Ml(this.R2a),w=u.next();!w.done;w=u.next())w=w.value,w.Yy.getStoreType()===r&&w.Yy.getMarketplaceID()===
t?this.R2a.removeAt(k):k++};a.getInstance=function(){a.Pa||(a.Pa=new a);return a.Pa};Jl.Object.defineProperties(a.prototype,{tWa:{configurable:!0,enumerable:!0,get:function(){return this.Myc}},R2a:{configurable:!0,enumerable:!0,get:function(){return this.feg}}});a.Pa=null;Object(D.a)(a,"AddinCommandsResourceManager",null,[])},840:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);var d=b(32);a.qMe=function(c){return d.a.Nn(a.Lhi,c.toString(),a.internalError)};Jl.Object.defineProperties(a,
{Lhi:{configurable:!0,enumerable:!0,get:function(){var c={};return a.S3d||(a.S3d=(c["-2002156328"]=a.xre,c["-1954750170"]=a.mUe,c["317650254"]=a.LMg,c["-1005263101"]=a.rYh,c["1353664579"]=a.K3i,c["159671765"]=a.sYh,c["1446690022"]=a.yPe,c["1150069548"]=a.xvc,c["-1409306331"]=a.joe,c["338507772"]=a.kxe,c["-457159301"]=a.rDi,c["-1037701970"]=a.TZg,c["-1893322318"]=a.yYh,c["965579896"]=a.VZg,c["93287890"]=a.UZg,c["358088857"]=a.H6i,c["-1223650923"]=a.kxe,c["2007306190"]=a.PIg,c["1549955423"]=a.ele,c["-1275974171"]=
a.xYh,c["382101082"]=a.zCi,c["-898776235"]=a.tji,c["335464256"]=a.kji,c["1677378049"]=a.vYh,c["-261992848"]=a.luj,c["-980820954"]=a.ele,c["-931375837"]=a.yCi,c["929186550"]=a.H6g,c["-982144310"]=a.YJi,c["-785741187"]=a.pYh,c["2125217573"]=a.AYh,c["299124955"]=a.qYh,c["1669853884"]=a.Z_i,c["-1515932330"]=a.MMg,c["314621024"]=a.Voh,c["-300049690"]=a.TIg,c["14766835"]=a.Iaj,c["-1251992761"]=a.sAe,c["-2087635043"]=a.invalidOrTimedOutSession,c["2100961153"]=a.invalidOrTimedOutSession,c["-1218744139"]=
a.invalidSheetName,c["-1468309555"]=5006,c["-315732528"]=a.invalidOrTimedOutSession,c["611268539"]=a.invalidOrTimedOutSession,c["1531005923"]=5006,c["1593924569"]=5006,c["299476328"]=a.TDa,c["49173765"]=a.TDa,c["-907155566"]=a.TDa,c["-1201603824"]=a.TDa,c["1541165282"]=a.TDa,c["-1347753427"]=a.TDa,c["134912532"]=a.TDa,c["1780971550"]=a.responsePayloadSizeLimitExceeded,c))}}});a.success=0;a.xre=1E3;a.mUe=1001;a.LMg=1002;a.rYh=1003;a.K3i=1004;a.sYh=1005;a.yPe=1008;a.QJe=1009;a.invalidSheetName=1014;
a.xvc=2E3;a.joe=2001;a.kxe=2002;a.rDi=2003;a.TZg=2004;a.yYh=2005;a.VZg=2007;a.UZg=2008;a.H6i=2009;a.PIg=2014;a.r3i=3E3;a.ele=3002;a.xYh=3004;a.zCi=3005;a.tji=3006;a.kji=3007;a.vYh=3008;a.luj=3009;a.yCi=3010;a.Iaj=4002;a.gvd=5E3;a.internalError=5001;a.sAe=5002;a.U2a=5004;a.kvj=5007;a.sTh=5008;a.BCg=5009;a.invalidOrTimedOutSession=5012;a.yxc=5016;a.TDa=5102;a.fYi=5103;a.responsePayloadSizeLimitExceeded=5104;a.hIg=7001;a.dVf=7002;a.H6g=8E3;a.YJi=8001;a.pYh=8010;a.AYh=8011;a.qYh=8012;a.Z_i=8020;a.MMg=
8021;a.Voh=8022;a.TIg=8023;a.fhi=11E3;a.jki=11001;a.zYh=11002;a.S3d=null;Object(D.a)(a,"DdaErrorIds",null,[])},841:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.xNc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.xCi="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.nvj=
"UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.kvg="AddinIsAlreadyRequestingToken";a.uZi="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.jQg="ControlIdNotFound";a.l_i="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(D.a)(a,"ErrorCodes",null,[])},843:function(D,F,b){function a(sa,hb){var cc=
Yb.call(this)||this;cc.fa=null;cc.wm=null;cc.Ch=null;cc.Af=[];cc.gHa=null;cc.Swe=!1;cc.vLb=!1;cc.initialized=!1;cc.disposed=!1;cc.wAa=null;cc.Ljc=[];cc.Nwe=[];cc.jNa=[];cc.yZa=null;cc.kwd=new Oc.a(tc.a.Dl());cc.OVb=new sc.a(tc.a.Dl());cc.sCb=[];cc.lwf=[];cc.J1b=350;cc.Wda=null;cc.Ova=null;cc.hNc=!1;cc.Y7d=null;cc.V7d=null;cc.Z7d=null;cc.X7d=null;cc.a8d=null;cc.Eig=null;cc.W7d=null;cc.$7d=null;cc.b8d=null;cc.c8d=null;cc.d8d=null;cc.wb=sa;cc.rQc=hb;cc.initialize();fa.la(cc);cc.iJf=0;(sa=(sa=!(Ta.a.Sq||
Ta.a.xja))&&(!Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Ta.a.Pf))&&OfficeExt.ShortcutKeyDispatchManager.init();cc.geg={};cc.Mcj=!Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5696885_ArgumentAssistanceHelpTaskPane");return cc}function d(sa){Uc.a.sendOtelCustomerContent(Object.assign(new Vd.a,{otelEvent:sa}))}function c(sa){Uc.a.sendOtelEvent(Object.assign(new Vd.a,{otelEvent:sa}))}function m(sa,hb,cc){sa=Gd.call(this,cc,sa)||this;sa.hashCode=
null;sa.iua=null;sa.C_b=!1;sa.YRa=hb;Sys.UI.DomElement.addCssClass(sa.domElement,gc.a.s4b);Sys.UI.DomElement.addCssClass(sa.domElement,uc.a.Er);cc.tabIndex=0;sa.vQa(sa.$.sa,!1);sa.tc.la("mousedown",Object(ca.a)(sa,sa.RM,"onMouseDown"));sa.tc.la("contextmenu",function(xc){me.g(xc)});sa.$.Aa.rL(Object(ca.a)(sa,sa.ro,"onActiveItemChanging"));sa.$.Ab.rL(Object(ca.a)(sa,sa.ro,"onActiveItemChanging"));sa.$.Ab.Vf(Object(ca.a)(sa,sa.vf,"onActiveItemChanged"));sa.$.Aa.Vf(Object(ca.a)(sa,sa.vf,"onActiveItemChanged"));
sa.Ha.Dq(Object(ca.a)(sa,sa.Le,"onBlockCacheItemChanged"));sa.Ha.XF(Object(ca.a)(sa,sa.jm,"onBlockCacheItemEvicted"));sa.Ha.Xp(Object(ca.a)(sa,sa.Zg,"onBlockCacheConsistent"));Ub.EwaSettings.wc()&&sa.Eq(Object(ca.a)(sa,sa.onContentReady,"onContentReady"));return sa}function r(sa,hb,cc,xc,vd,Xd,Je,ff,Ye){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=
!1;this.enqueueUtcTime=sa;this.processUtcTime=hb;this.dequeueUtcTime=cc;this.inQueueDurationInMS=xc;this.executionDurationInMS=vd;this.operationCount=Xd;this.ServerCorrelationId=Je;this.UserOperationName=ff;this.IsDocumentHidden=Ye}function t(sa,hb,cc){this.$=sa;this.dj=hb;this.runtimeCalculationMode=cc}function k(){}function u(sa,hb,cc){this.Tuf=null;this.$=sa;this.dj=hb;this.Ch=cc;this.UVh()}function w(sa,hb,cc){this.ZDb=0;this.k6f=!0;this.Q5b=0;this.Ajd=!0;this.$=sa;this.dj=hb;this.Ch=cc;window.requestIdleCallback||
(this.Ajd=!1)}function v(sa,hb,cc){this.YDb=0;this.Q7a=this.Z7a=null;this.$=sa;this.dj=hb;this.Ch=cc}function A(sa,hb,cc){this.EZb=null;this.Cdc=!1;this.$=sa;this.gridView=pb.g(sa);this.dj=hb;this.Ch=cc;this.Y1h=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetCellOffSetPointFromEventPointOptimization",!1);this.TQi()}function y(sa,hb,cc,xc){var vd=jd.call(this)||this;vd.sheet=sa;vd.NIg=hb;vd.offsetX=cc;vd.offsetY=xc;return vd}function x(sa,hb,cc){this.GDf=this.FDf=this.HDf=this.EDf=
0;this.$=sa;this.dj=hb;this.Ch=cc}function z(sa,hb,cc){this.cOa=this.bOa=0;this.XEa=this.yga=null;this.$=sa;this.dj=hb;this.Ch=cc}function J(sa,hb,cc){sa=B.call(this,sa,hb,cc)||this;sa.E$e=null;sa.D$e=null;return sa}function B(sa,hb,cc){var xc=Ue.call(this)||this;xc.cya=0;xc.OT=0;xc.$=sa;xc.dj=hb;xc.Ch=cc;xc.grid=pb.g(sa);xc.nLa={};xc.nec={};return xc}function C(sa,hb,cc){this.DDf=this.CDf=0;this.qHb=this.b8a=null;this.$=sa;this.dj=hb;this.Ch=cc}function H(){this.wWa={}}function W(sa,hb,cc,xc){xc=
void 0===xc?!1:xc;var vd=Mc.call(this)||this;vd.j$a=0;vd.WD=null;vd.Eua=!1;vd.ilc=null;vd.OT=0;vd.NUd=null;vd.qBc=null;vd.dTa=null;vd.r1b=null;vd.r1d=!1;vd.pSd=null;vd.xca=null;vd.wIc=null;vd.wb=sa.$;vd.fh=sa;vd.ud=cc;vd.ud.InstanceId=cc.SrcLocationOverrideResourceId?sa.$ha(cc.InstanceId,cc.SrcLocationOverrideResourceId):cc.InstanceId;vd.Ch=hb;vd.t0={};vd.t0.WebExtensionId=cc.InstanceId;vd.Suf="osfControl_"+cc.InstanceId;vd.V0c="disabled_"+cc.InstanceId;vd.t0.BindingData=cc.BindingData;vd.a3a=vd.fh.a3a(cc.InstanceId);
vd.Uac=vd.fh.Uac(cc.InstanceId);vd.K5d=cc.WebExtensionOsfControlType;vd.dyf=xc;return vd}function S(sa,hb,cc,xc,vd,Xd,Je,ff){sa=Qa.call(this,sa,hb,cc)||this;sa.startRow=0;sa.startColumn=0;sa.rowCount=0;sa.columnCount=0;sa.startColumn=Xd-xc.Reference.FirstColumn;sa.columnCount=ff;Xd=Math.max(vd,xc.Reference.FirstRow);vd=Math.min(vd+Je-1,xc.Reference.LastRow);Xd>vd?sa.startRow=sa.rowCount=void 0:(sa.startRow=Xd-xc.Reference.FirstRow,sa.rowCount=vd-Xd+1);return sa}function N(sa){this.WD=null;this.Eua=
!1;this.fh=sa}function T(sa,hb){this.eA=null;this.pea=sa;this.Kkg=hb}function fa(sa){this.Ah=this.TQc=null;this.handlers=new ia.a;this.ngc=new ia.a;this.fh=sa;this.JZa.Atg(Object(ca.a)(this,this.Qvi,"onMessageParentEvent"));this.JZa.ztg(Object(ca.a)(this,this.Pvi,"onMessageDialogEvent"))}function Y(sa,hb,cc,xc,vd,Xd,Je){sa=Mb.call(this,sa,hb,cc)||this;sa.messageType=0;sa.messageContent=null;sa.messageOrigin=null;sa.targetOrigin=null;sa.messageType=xc;sa.messageContent=vd;sa.messageOrigin=Xd;sa.targetOrigin=
Je;return sa}function L(sa,hb,cc,xc,vd,Xd,Je){sa=Hb.call(this,sa,hb,cc)||this;sa.messageType=0;sa.messageContent=null;sa.messageOrigin=null;sa.targetOrigin=null;sa.messageType=xc;sa.messageContent=vd;sa.messageOrigin=Xd;sa.targetOrigin=Je;return sa}function P(sa,hb){var cc=Va.call(this)||this;cc.requests=new Tb.a;cc.PYb=!1;cc.disposed=!1;cc.ddaFacade=sa;cc.grid=hb;return cc}function ea(){this.command=0;this.properties=null}function X(sa){return sa.ea.Ea(34,void 0)}function ja(sa){this.rb=new Ra.a;
this.wm=sa}function R(sa,hb,cc,xc,vd){cc=void 0===cc?null:cc;xc=void 0===xc?"":xc;vd=void 0===vd?"":vd;var Xd=Ia.call(this)||this;Xd.controlId=sa;Xd.messageType=hb;Xd.messageContent=cc;Xd.messageOrigin=xc;Xd.targetOrigin=vd;return Xd}function ba(sa,hb,cc,xc,vd){cc=void 0===cc?null:cc;xc=void 0===xc?"":xc;vd=void 0===vd?"":vd;var Xd=za.call(this)||this;Xd.controlId=sa;Xd.messageType=hb;Xd.messageContent=cc;Xd.messageOrigin=xc;Xd.targetOrigin=vd;return Xd}function ha(){this.height=this.width=0;this.We=
this.controlId=this.pageUrl=null;this.y$b=this.a1c=!1}function oa(){}function Sa(){this.dialog=this.We=null}function ma(sa,hb,cc){var xc=qb.call(this)||this;xc.x8=null;xc.CMc="WACDialogTitleText";xc.USa="0";xc.ANb="15px";xc.yag="0px";xc.TSa="calc(100% - 30px)";xc.xag="100%";xc.w7d=0;xc.rb=new Ra.a;xc.d9f=new xa;xc.lc=5;xc.wBa=cc;xc.We=cc;xc.MBc=sa;xc.RXd=hb;xc.bCc=!!ta.AFrameworkApplication.ha&&ta.AFrameworkApplication.ha.ta("OfficeAddinEnableInsertDialogAccessibilityFix");return xc}function na(){}
function xa(){}function Oa(sa,hb){sa=ib.call(this,1,sa,hb)||this;sa.E2e=OfficeExt.CommandInvokeMode.ExclusiveForNew;return sa}function ib(sa,hb,cc){this._id=sa;this.b9f=hb;this.iag=cc;this.E2e=OfficeExt.CommandInvokeMode.Default}b.r(F);var sb=b(0),nb=b(15),Gb=b(1266),Ha=b(969),ca=b(37),Ra=b(94);ib.prototype.execute=function(sa,hb,cc){var xc=this;cc=cc||{};cc.commandMode=this.E2e;hb.invokeAppCommand(this.jvg,this.lNg,cc,function(){sa.awi(xc.id)})};Jl.Object.defineProperties(ib.prototype,{id:{configurable:!0,
enumerable:!0,get:function(){return this._id}},jvg:{configurable:!0,enumerable:!0,get:function(){return this.b9f}},lNg:{configurable:!0,enumerable:!0,get:function(){return this.iag}}});Object(sb.a)(ib,"AddinNativeActionBase",null,[833]);Cm(Oa,ib);Object(sb.a)(Oa,"AddinTakeSnapshotAction",ib,[]);xa.prototype.GRg=function(sa){return new ib(3,sa,this.$sh().getNativeActionName(3))};xa.prototype.$sh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(sb.a)(xa,"AddinNativeActionManager",
null,[800]);var ua=b(140);na.prototype.invokeAppCommand=function(sa,hb,cc,xc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(sa,hb,cc,xc)};na.getInstance=function(){na.Pa||(na.Pa=new na);return na.Pa};na.Pa=null;Object(sb.a)(na,"OSFAddinCommandsRuntimeManager",null,[799]);var ta=b(5),db=b(169),Ta=b(24),qb=ua.a;Cm(ma,qb);ma.prototype.ttg=function(sa){this.rb.addHandler("OnDialogClosedEventKey",sa)};ma.prototype.w8i=function(){this.FCa=null};ma.prototype.KC=function(){qb.prototype.KC.call(this);
this.ep.style.width="100%";this.ep.style.height=this.Y9b?this.TSa:this.xag;this.ep.style.marginTop=this.Y9b?this.ANb:this.yag;this.ep.style.padding=this.USa};ma.prototype.CN=function(){qb.prototype.CN.call(this);this.Ob.style.width=String.format("{0}px",this.MBc*window.innerWidth/100);this.Ob.style.height=String.format("{0}px",this.RXd*window.innerHeight/100);this.Ob.style.minWidth="0px";this.bCc&&ta.AFrameworkApplication.isRtl&&100===this.MBc&&(this.Ob.style.right="0px",this.Ob.style.marginRight=
"0px");this.x8=document.getElementById(this.hi(this.CMc));this.x8.style.position="absolute";this.x8.style.whiteSpace="nowrap";this.x8.style.textOverflow="ellipsis";ta.AFrameworkApplication.isRtl?(this.x8.style.right="14px",this.x8.style.left="44px"):(this.x8.style.right="44px",this.x8.style.left="14px")};ma.prototype.Yu=function(sa){qb.prototype.Yu.call(this,sa);this.x8&&this.x8.setAttribute("title",sa)};ma.prototype.zDd=function(){this.Ob.style.width=String.format("{0}px",this.MBc*window.innerWidth/
100);this.Ob.style.height=String.format("{0}px",this.RXd*window.innerHeight/100);this.Ob.style.overflowY="hidden";this.Ob.style.overflowX="hidden";this.Ob.style.marginTop="";this.Ob.style.top="";Ta.a.iQ&&ta.AFrameworkApplication.isRtl?(this.Ob.style.right="",this.Ob.style.marginRight=""):(this.Ob.style.left="",this.Ob.style.marginLeft="")};ma.prototype.hide=function(){var sa=this;this.d9f.GRg(this.wBa).execute(this,na.getInstance(),{});this.w7d=window.setTimeout(function(){sa.rb.raiseEvent("OnDialogClosedEventKey",
sa.wBa);db.a.prototype.hide.call(sa)},500)};ma.prototype.awi=function(sa){3===sa&&(window.clearTimeout(this.w7d),this.rb.raiseEvent("OnDialogClosedEventKey",this.wBa),qb.prototype.hide.call(this))};Jl.Object.defineProperties(ma.prototype,{EGa:{configurable:!0,enumerable:!0,get:function(){return this.ep}}});Object(sb.a)(ma,"AppsForOfficeDialog",ua.a,[794,795]);Object(sb.a)(Sa,"DialogInfo",null,[]);oa.url="url";oa.height="height";oa.width="width";oa.a1c="displayInIframe";oa.y$b="hideTitle";Object(sb.a)(oa,
"DialogSettings",null,[]);Object(sb.a)(ha,"DisplayDialogParams",null,[]);var za=Sys.EventArgs;Cm(ba,za);Object(sb.a)(ba,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var Ia=Sys.EventArgs;Cm(R,Ia);Object(sb.a)(R,"OnMessageParentEventArgs",Sys.EventArgs,[]);var va=b(41),Ua=b(30),Kb=b(194),ia=b(107);ja.prototype.Atg=function(sa){this.rb.addHandler("OnMessageParentEventKey",sa)};ja.prototype.ztg=function(sa){this.rb.addHandler("OnMessageDialogEventKey",sa)};ja.prototype.showDialog=function(sa,hb,cc,xc){if(ja.n7.tb(hb))nb.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var vd=va.b(sa),Xd=vd[oa.url];if(this.wm.getOsfControl(hb).checkAppDomains(Xd)){var Je=new ha;Je.width=vd[oa.width];Je.height=vd[oa.height];Je.pageUrl=Xd;Je.a1c=vd[oa.a1c];Je.y$b=vd[oa.y$b];Je.controlId=hb;Je.We=Kb.a.create().toString();var ff=new Sa;ff.We=Je.We;var Ye=this.wm.getOsfControl(Je.controlId).getManifest().getDefaultDisplayName(),Pe=this.wm.getOsfControl(Je.controlId).getStoreType().toLowerCase();
sa=null;sa=4===ta.AFrameworkApplication.za.Za.Xk&&"hardcodedpreinstall"===Pe&&Je.y$b?this.createAndShowAppsForOfficeDialog(Je.width,Je.height,Je.We,!0,Ye):this.createAndShowAppsForOfficeDialog(Je.width,Je.height,Je.We,!1,Ye);var wf=this.wm.getOsfControl(Je.controlId),lf=wf.getManifest();hb={};ta.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hb.id=Je.We,hb.solutionId=lf.getMarketplaceID(),hb.version=lf.getMarketplaceVersion(),hb.storeType=
Pe,hb.storeId=wf.getStoreLocator(),hb.assetId=wf.getAssetId(),hb.assetStoreId=wf.getAssetStoreId(),hb.ownerAddinSolutionId=wf.getOwnerAddinSolutionId(),hb.ownerAddinStoreType=wf.getOwnerAddinStoreType(),hb.appDomains=lf.getAppDomains(),hb.dialogUrl=Xd,hb.osfControlType=1,hb.marketplaceID=lf.getMarketplaceID(),hb.marketplaceVersion=lf.getMarketplaceVersion(),hb.store=wf.getStoreLocator(),hb.ownerAddinAssetId=wf.getOwnerAddinAssetId(),hb.agaveName=Ye,hb.div=sa.EGa,nb.ULS.sendTraceTag(542978531,344,
50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==hb.ownerAddinStoreType?hb.ownerAddinStoreType:hb.storeType,hb.store,hb.solutionId),Ua.a.Dv(Je.pageUrl))):(hb.id=Je.We,hb.marketplaceID=lf.getMarketplaceID(),hb.marketplaceVersion=lf.getMarketplaceVersion(),hb.appDomains=lf.getAppDomains(),hb.store=wf.getStoreLocator(),hb.storeType=Pe,hb.ownerAddinAssetId=wf.getOwnerAddinAssetId(),hb.ownerAddinStoreType=wf.getOwnerAddinStoreType(),hb.dialogUrl=Xd,hb.osfControlType=
1,hb.agaveName=Ye,hb.div=sa.EGa,nb.ULS.sendTraceTag(540379087,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==hb.ownerAddinStoreType?hb.ownerAddinStoreType:hb.storeType,hb.store,hb.marketplaceID),Ua.a.Dv(Je.pageUrl)));this.wm.insertDialogControl(hb);sa.ttg(Object(ca.a)(this,this.Iqi,"onDialogClosed"));ff.dialog=sa;ja.n7.ja(Je.controlId,ff);xc&&xc(hb);cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else nb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),
cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(kg){nb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",kg.message),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};ja.prototype.Ohi=function(sa,hb,cc,xc){ta.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===xc&&(xc=cc);try{var vd=this.Lta(sa);vd&&this.rb.raiseEvent("OnMessageParentEventKey",new R(vd,OSF.DialogMessageType.DialogMessageReceived,
hb,cc,xc))}catch(Xd){return nb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Xd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};ja.prototype.mWc=function(sa,hb){if(ja.n7.tb(sa))try{var cc=ja.n7.oa(sa);cc.dialog&&cc.dialog.hide();this.wm.purgeDialogControl(cc.We);ja.n7.remove(sa);hb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(xc){nb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",
xc.message),hb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else nb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),hb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};ja.prototype.s4i=function(sa,hb,cc,xc){ta.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===xc&&(xc=cc);if(ja.n7.tb(sa)&&(sa=ja.n7.oa(sa),sa.dialog))try{this.rb.raiseEvent("OnMessageDialogEventKey",
new ba(sa.We,OSF.DialogMessageType.DialogParentMessageReceived,hb,cc,xc))}catch(vd){nb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",vd.message)}};ja.prototype.Lta=function(sa){for(var hb=null,cc=Ml(ja.n7),xc=cc.next();!xc.done;xc=cc.next())if(xc=xc.value,xc.value.We===sa){hb=xc.key;break}return hb};ja.prototype.Iqi=function(sa,hb){if(sa=this.Lta(hb))this.wm.purgeDialogControl(hb),ja.n7.remove(sa),this.rb.raiseEvent("OnMessageParentEventKey",new R(sa,
OSF.DialogMessageType.DialogClosed,null,null,"*"))};ja.prototype.createAndShowAppsForOfficeDialog=function(sa,hb,cc,xc,vd){sa=new ma(sa,hb,cc);vd=xc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,vd);xc&&(sa.Y9b=!1,sa.Fu=!1);sa.initializeAndShow(vd,null,null);sa.w8i();return sa};ja.eLh=function(){return ja.n7};ja.getInstance=function(sa){ja.Pa||(ja.Pa=new ja(sa));return ja.Pa};ja.Pa=null;ja.n7=new ia.a;Object(sb.a)(ja,"AppsForOfficeDialogManager",null,[790]);var E=b(1270),fb=b(1346),
Za=b(1054),ec=b(1272),zc=b(162),Ab=b(88),vb=b(86),kc=b(829),td=b(183),Oc=b(787),tc=b(786),sc=b(797),ic=b(82),Ga=b(404),cb=b(139),Tb=b(210),Bb=b(36),nc=b(4),Gc=b(933),La=b(1228),Wa=b(74);Object(sb.a)(ea,"DdaRequestInfo",null,[]);var wa=b(840),Da=b(79),Va=Wa.a;Cm(P,Va);P.prototype.C0g=function(sa,hb){this.disposed||(this.PYb||(this.grid.Hc.mt(Object(ca.a)(this,this.Zk,"onEditEnded")),this.PYb=!0),this.requests.add(Object.assign(new ea,{command:sa,properties:hb})))};P.prototype.Zk=function(){if(!this.disposed){this.grid.Hc.Qs(Object(ca.a)(this,
this.Zk,"onEditEnded"));this.PYb=!1;var sa=this.requests;this.requests=new Tb.a;sa=Ml(sa);for(var hb=sa.next();!hb.done;hb=sa.next())hb=hb.value,this.ddaFacade.yJ(hb.command,hb.properties)}};P.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.PYb&&this.grid.Hc.Qs(Object(ca.a)(this,this.Zk,"onEditEnded"));var sa=this.requests;this.requests=null;sa=Ml(sa);for(var hb=sa.next();!hb.done;hb=sa.next())hb=hb.value,(hb=hb.properties?hb.properties[Da.a.L2]:null)&&this.ddaFacade.sf(wa.a.U2a,
hb);this.ddaFacade=this.grid=null;Va.prototype.dispose.call(this)}};P.oNg=function(sa,hb){var cc=!1;974713501===sa&&(hb=(sa=hb?hb[Da.a.Mj]:null)?sa.DdaMethod:null)&&hb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(cc=sa.ArrayData,cc=!!cc&&64===(cc[6]&64));return cc};Object(sb.a)(P,"DdaCellEditDelayRequestHandler",Wa.a,[]);var Jb=b(879),Hb=Jb.a;Cm(L,Hb);Object(sb.a)(L,"DialogMessageReceivedEventArgs",Jb.a,[]);var Mb=Jb.a;Cm(Y,Mb);Object(sb.a)(Y,"DialogParentMessageReceivedEventArgs",
Jb.a,[]);var Ub=b(1);fa.prototype.addHandler=function(sa,hb,cc,xc){var vd=this;if(Ub.EwaSettings.ka(25))this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc);else{nb.ULS.sendTraceTag(19931726,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var Xd=function(Je){Je===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(vd.handlers.ja(sa,hb),vd.fh.Bu(cc)):(nb.ULS.sendTraceTag(19931727,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),vd.fh.sf(Je,cc))};this.handlers.tb(sa)?
Xd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(sa,xc,Xd)}};fa.prototype.dpg=function(sa,hb,cc){Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):(nb.ULS.sendTraceTag(595121569,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.ngc.ja(sa,hb),this.fh.Bu(cc))};fa.prototype.removeHandler=function(sa,hb){var cc=this;Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
hb):this.handlers.tb(sa)?(nb.ULS.sendTraceTag(19931728,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.JZa.mWc(sa,function(xc){cc.handlers.remove(sa);xc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?cc.fh.Bu(hb):(nb.ULS.sendTraceTag(19931729,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),cc.fh.sf(xc,hb))})):this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hb)};fa.prototype.lSi=function(sa,hb){Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
hb):(nb.ULS.sendTraceTag(595121568,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.ngc.remove(sa),this.fh.Bu(hb))};fa.prototype.showDialog=function(sa,hb,cc){var xc=this;try{this.JZa.showDialog(hb,sa,cc,function(vd){xc.fh.vpg(xc.mFg(vd))})}catch(vd){nb.ULS.sendTraceTag(19690967,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",vd.message),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};fa.prototype.mFg=function(sa){var hb={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(hb.InstanceId=sa.id,hb.WebExtensionType=sa.osfControlType===OSF.OsfControlTarget.InContent?0:1,hb.PrimaryMarketplace={},hb.PrimaryMarketplace.SolutionId=sa.solutionId,hb.PrimaryMarketplace.SolutionVersion=sa.version,hb.PrimaryMarketplace.MarketplaceRef=sa.storeId):(hb.InstanceId=sa.id,hb.WebExtensionType=sa.osfControlType===OSF.OsfControlTarget.InContent?0:1,hb.PrimaryMarketplace={},hb.PrimaryMarketplace.SolutionId=sa.marketplaceID,hb.PrimaryMarketplace.SolutionVersion=sa.marketplaceVersion,
hb.PrimaryMarketplace.MarketplaceRef=sa.store);hb.PrimaryMarketplace.MarketplaceType=sa.storeType;return hb};fa.prototype.Qvi=function(sa,hb){this.handlers.tb(hb.controlId)&&(sa=new L(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,hb.controlId,null,hb.messageType,hb.messageContent,hb.messageOrigin,hb.targetOrigin),this.handlers.oa(hb.controlId)(sa),hb.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(hb.controlId))};fa.prototype.Pvi=function(sa,hb){this.ngc.tb(hb.controlId)&&
(sa=new Y(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,hb.controlId,null,hb.messageType,hb.messageContent,hb.messageOrigin,hb.targetOrigin),this.ngc.oa(hb.controlId)(sa))};fa.la=function(sa){if(!sa.$.ea.Ea(232,void 0)){var hb=new fa(sa);sa.$.ea.La(232,hb)}};Jl.Object.defineProperties(fa.prototype,{JZa:{configurable:!0,enumerable:!0,get:function(){this.TQc||(this.TQc=ja.getInstance(this.contextActivationMgr));return this.TQc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Ah&&
this.fh&&(this.Ah=this.fh.Ah);return this.Ah}}});Object(sb.a)(fa,"DialogMessageReceivedEventManager",null,[847]);T.prototype.yVb=function(sa){sa&&(this.eA||(this.eA=[]),Array.add(this.eA,sa))};T.prototype.inc=function(sa){this.eA&&Array.remove(this.eA,sa)};T.prototype.fgi=function(sa){return this.eventId!==sa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===sa.ddaBinding.Name:!0};T.prototype.vYb=
function(sa){this.eA&&Array.forEach(this.eA,function(hb){hb(sa)})};T.prototype.rla=function(){this.eA=[]};Jl.Object.defineProperties(T.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pea}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Kkg}},QPh:{configurable:!0,enumerable:!0,get:function(){return 0<this.eA.length}}});Object(sb.a)(T,"DdaEventRegistration",null,[]);var pb=b(20);N.prototype.invokeDdaMethod=function(sa,hb){var cc={};cc[Da.a.Mj]=sa;cc[Da.a.L2]=
hb;this.fh.yJ(974713501,cc)};N.prototype.registerDdaEventAsync=function(sa,hb,cc,xc,vd){N.Ivb(sa)?(N.Mgd(sa)&&this.udd(),this.WD||(this.WD=[]),hb=this.Jqb(sa,cc),hb||(hb=new T(sa,cc),Array.add(this.WD,hb)),hb.yVb(xc),this.fh.Bu(vd)):this.fh.sf(-1,vd)};N.prototype.unregisterDdaEventAsync=function(sa,hb,cc,xc,vd){N.Ivb(sa)?((sa=this.Jqb(sa,cc))&&sa.inc(xc),this.fh.Bu(vd)):this.fh.sf(-1,vd)};N.prototype.udd=function(){this.Eua||(pb.g(this.fh.$).ga.ZF(Object(ca.a)(this,this.nd,"onSelectionChanged")),
this.Eua=!0)};N.prototype.nd=function(){Array.forEach(this.WD,function(sa){sa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&sa.vYb(new Jb.a(sa.eventId,"",null))})};N.prototype.Jqb=function(sa,hb){if(!this.WD)return null;for(var cc=0;cc<this.WD.length;cc++){var xc=this.WD[cc];if(xc.eventId===sa&&xc.targetId===hb)return xc}return null};N.Ivb=function(sa){return sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};N.Mgd=function(sa){return sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};
Object(sb.a)(N,"EmbeddingPage",null,[812]);var gb=b(187),Qa=Jb.a;Cm(S,Qa);S.prototype.getStartRow=function(){return this.startRow};S.prototype.getStartColumn=function(){return this.startColumn};S.prototype.getRowCount=function(){return this.rowCount};S.prototype.getColumnCount=function(){return this.columnCount};Object(sb.a)(S,"DdaBindingSelectionEventArgs",Jb.a,[]);var eb=b(184),xb=b(25),dc=b(46),Nc=b(58),Pc=b(405),Fd=b(43),Ea=b(35),Xa=b(583),hc=b(109),Xb=b(48),Ic=b(92),Qc=b(11),Cb=b(9),$c=b(7),
ae=b(103),Mc=gb.a;Cm(W,Mc);W.prototype.pWh=function(sa){this.xca||(this.xca=sa)};W.prototype.DEf=function(){this.xca&&(this.xca.dispose(),this.xca=null)};W.prototype.Med=function(){var sa=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.ud.PrimaryMarketplace.MarketplaceType)&&Ub.EwaSettings.ka(189)){var hb=Nc.GetServiceTaskFactory.Xa(this.$.ea,5,4,0,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");Ea.TaskExtensions.Da(hb,function(){hb.result.tg(35,null)},this.ma,3);return this}if(1===
this.ud.WebExtensionType)Ea.TaskExtensions.Da(Pc.a(this.$),function(vd){vd.result.lob(sa.$.ea,77,6,Object(ca.a)(sa,sa.zjf,"onAgavePaneCreated"),1)},this.ma,3);else{var cc=this.hKe(),xc=ae.a(this.$);cc||(cc={Type:3},cc.Id=this.t0.WebExtensionId,cc.WebExtensionData=this.ud,cc.ContentHtml="<div/>",cc.Version=0,cc.AbsoluteLeft=0,cc.AbsoluteTop=0,cc.AbsoluteRight=0,cc.AbsoluteBottom=0,cc.Width=0,cc.Height=0,cc.ZOrder=0,cc.OriginDeltaX=0,cc.OriginDeltaY=0,cc=new eb.a(cc),xc.c0b(cc,null),cc=xc.Cp(cc.Lg()));
cc?(this.Nqc(cc.$d.firstChild),this.dga=Object(ic.a)(250,cc)):xc.jPc(Object(ca.a)(this,this.onFloatingObjectControlAdded,"onFloatingObjectControlAdded"))}return this};W.prototype.c1e=function(sa){this.Nqc(sa);return this};W.prototype.Xhc=function(){this.dyf||this.fh.Ah.purgeOsfControl(this.controlId,!1);this.P0f(!0);var sa=this.hKe();sa&&ae.a(this.$).deleteFloatingObject(sa);this.fh.dj.XRi(this.controlId);this.fh.dj.rCe(this.controlId,!0);this.wIc=null};W.prototype.Qtd=function(sa){this.t0=sa};W.prototype.invokeDdaMethod=
function(sa,hb){if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var cc={};cc[Da.a.Mj]=sa;cc[Da.a.L2]=hb;this.fh.yJ(974713501,cc)}else this.fh.sf(wa.a.U2a,hb)};W.prototype.HPi=function(sa,hb,cc,xc){if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!W.$4g(sa)||void 0!==hb&&null!==hb&&void 0!==this.W_a(hb)&&null!==this.W_a(hb))if(nb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",sa,hb),W.a4e(sa)&&this.DRh(),
W.Mgd(sa)&&this.udd(),W.Z3e(sa))Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.fh.$.ea.Ea(232,void 0).addHandler(this.controlId,cc,xc,hb);else if(W.$3e(sa))Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.fh.$.ea.Ea(232,void 0).dpg(this.controlId,cc,xc);else{W.Y3e(sa)&&this.oXe(-1777565636,xc);this.WD||(this.WD=[]);var vd=this.Jqb(sa,hb);vd||(vd=new T(sa,hb),Array.add(this.WD,vd));vd.rla();
vd.yVb(cc);this.fh.Bu(xc);sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.dTa&&(this.r1b=cc)}else this.fh.sf(3002,xc);else this.fh.sf(-1,xc)};W.prototype.vuj=function(sa,hb,cc,xc){W.Z3e(sa)?Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.fh.$.ea.Ea(232,void 0).removeHandler(this.controlId,xc):W.$3e(sa)?Ub.EwaSettings.ka(25)?this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xc):this.fh.$.ea.Ea(232,void 0).lSi(this.controlId,
xc):(W.Y3e(sa)&&this.oXe(1592314317,xc),hb=this.Jqb(sa,hb),this.enabled?(hb&&(hb.inc(cc),hb.QPh||Array.remove(this.WD,hb),this.WD.length?W.a4e(sa)&&this.Q0f(!1):this.P0f(!1)),this.fh.Bu(xc)):this.fh.sf(-1,xc))};W.prototype.la=function(sa){Qc.DOMElementExtensions.getElementById(sa,this.Suf)||sa.appendChild(Qc.DOMElementExtensions.rg(this.Pt))};W.prototype.showHide=function(sa){Qc.DOMElementExtensions.setVisible(this.Pt,sa)};W.prototype.resize=function(sa,hb){Qc.DOMElementExtensions.vq(this.Pt,sa);
Qc.DOMElementExtensions.wF(this.Pt,hb)};W.prototype.kze=function(sa){if(!this.OT&&!Qc.DOMElementExtensions.getElementById(this.Pt,this.V0c)&&this.Pt){var hb=document.createElement("div");hb.id=this.V0c;hb.className="ewa-wx-disabled-div";hb.style.backgroundImage="url("+Xb.a.current.En(83)+")";hb.style.opacity=sa?"1":"0";hb.style.backgroundRepeat="no-repeat";hb.style.backgroundPosition="center";this.Pt.insertBefore(hb,this.Pt.firstChild)}this.OT++};W.prototype.b8g=function(){0<this.OT&&this.OT--;this.OT||
(Qc.DOMElementExtensions.rg(Qc.DOMElementExtensions.getElementById(this.Pt,this.V0c)),this.Eua&&!dc.Q(this.ilc,pb.g(this.$).ga.ya.selectedRanges)&&this.nd(null,null))};W.prototype.W_a=function(sa){if(!this.t0||!this.t0.BindingData)return null;for(var hb=0;hb<this.t0.BindingData.length;hb++)if(this.t0.BindingData[hb].Name===sa)return this.t0.BindingData[hb];return null};W.prototype.getDefaultIconUrl=function(){var sa=this.USe();return sa?sa.getDefaultIconUrl():null};W.prototype.getDefaultDisplayName=
function(){if(this.ud.TaskpaneTitle)return this.ud.TaskpaneTitle;var sa=this.USe();return sa?sa.getDefaultDisplayName():null};W.prototype.hzf=function(){if(this.dTa&&this.r1b){var sa=new Jb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.dTa);this.r1b(sa);this.r1b=this.dTa=null}};W.prototype.Rf=function(sa){this.pSd&&this.pSd.Rf(sa)};W.prototype.u6i=function(){var sa=this;this.$.fa.isNamedObjectViewMode&&this.x4h()&&(X(this.$).t6i(this.Pt),this.showHide(!1));if(this.fh.kCj){if(!this.dyf){var hb=
{};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hb.div=this.Pt,hb.id=this.ud.InstanceId,hb.solutionId=this.ud.PrimaryMarketplace.SolutionId,hb.version=this.ud.PrimaryMarketplace.SolutionVersion,hb.storeId=this.ud.PrimaryMarketplace.MarketplaceRef,hb.storeType=this.ud.PrimaryMarketplace.MarketplaceType,hb.ownerAddinSolutionId=this.ud.OwnerAddinSolutionId,hb.ownerAddinStoreType=this.ud.OwnerAddinStoreType,this.ud.AssetMarketplace&&(hb.assetId=
this.ud.AssetMarketplace.SolutionId,hb.assetStoreId=this.ud.AssetMarketplace.MarketplaceRef,hb.alternateReference={},hb.alternateReference.marketplaceID=this.ud.AssetMarketplace.SolutionId,hb.alternateReference.marketplaceVersion=this.ud.AssetMarketplace.SolutionVersion,hb.alternateReference.store=this.ud.AssetMarketplace.MarketplaceRef,hb.alternateReference.storeType=this.ud.AssetMarketplace.MarketplaceType),hb.marketplaceID=this.ud.PrimaryMarketplace.SolutionId,hb.marketplaceVersion=this.ud.PrimaryMarketplace.SolutionVersion,
hb.store=this.ud.PrimaryMarketplace.MarketplaceRef,hb.ownerAddinAssetId=this.ud.OwnerAddinAssetId):(hb.div=this.Pt,hb.id=this.ud.InstanceId,hb.marketplaceID=this.ud.PrimaryMarketplace.SolutionId,hb.marketplaceVersion=this.ud.PrimaryMarketplace.SolutionVersion,hb.store=this.ud.PrimaryMarketplace.MarketplaceRef,hb.storeType=this.ud.PrimaryMarketplace.MarketplaceType,hb.ownerAddinAssetId=this.ud.OwnerAddinAssetId,hb.ownerAddinStoreType=this.ud.OwnerAddinStoreType,this.ud.AssetMarketplace&&(hb.alternateReference=
{},hb.alternateReference.marketplaceID=this.ud.AssetMarketplace.SolutionId,hb.alternateReference.marketplaceVersion=this.ud.AssetMarketplace.SolutionVersion,hb.alternateReference.store=this.ud.AssetMarketplace.MarketplaceRef,hb.alternateReference.storeType=this.ud.AssetMarketplace.MarketplaceType));hb.settings=this.ud.OsfPropertyBag;Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?hb.reason=this.a3a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
this.Uac?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:hb.reason=this.a3a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;hb.osfControlType=this.ud.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent;hb.isForUILessAction=4===this.ud.WebExtensionOsfControlType;hb.sourceLocationOverrideResourceId=this.ud.SrcLocationOverrideResourceId;
hb.focusOnIframeWhenLoaded=this.ud.FocusOnIframeWhenLoaded;Xa.a(this.ud)&&(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?hb.featureGates=ta.AFrameworkApplication.ha.vQe(hb.solutionId):hb.featureGates=ta.AFrameworkApplication.ha.vQe(hb.marketplaceID));hb.hostInfoFlags=0;$c.a.na(this.qGa)||(hb.hostInfoFlags|=2);Cb.HelperMethods.My(this.ud)&&(hb.hostInfoFlags|=1);this.$.Hqa||(nb.ULS.sendTraceTag(571774818,0,50,"Content web add-in disabled by doc IRM"),
hb.hostInfoFlags|=4);Ub.EwaSettings.ka(680)&&(hb.hostInfoFlags|=8);Ub.EwaSettings.ka(54)&&Ub.EwaSettings.ka(94)&&$c.a.na(this.qBc)&&(hb.virtualOsfControlActivationCallback=function(){sa.fh.Vtf(sa.ud)});hb.sharedRuntimeId=this.ud.SharedRuntime?this.ud.SharedRuntime.Resid:this.ud.SharedRuntimeId;!Cb.HelperMethods.My(this.ud)||this.ud.Preload||Xa.a(this.ud)||this.fh.Ah.getOsfControl(b(843).DdaFacade.getSolutionId(this.ud,this.$))||this.fh.Vtf(this.ud);hb.initialDisplayMode=this.ud.TaskpaneVisible?2:
1;this.fh.Ah.insertOsfControl(hb)}this.OT=0}else this.kze(!0)};W.prototype.P0f=function(sa){this.Q0f(sa);this.duj()};W.prototype.DRh=function(){this.j$a||this.Ch.yVb(Object(ca.a)(this,this.mXe,"handleDdaEvent"));this.j$a++};W.prototype.Q0f=function(sa){0<this.j$a&&(sa?this.j$a=0:this.j$a--,this.j$a||this.Ch.inc(Object(ca.a)(this,this.mXe,"handleDdaEvent")))};W.prototype.udd=function(){if(!this.Eua){var sa=pb.g(this.$).ga;this.ilc=dc.d(pb.g(this.$).ga.ya.selectedRanges);sa.ZF(Object(ca.a)(this,this.nd,
"onSelectionChanged"));this.Eua=!0}};W.prototype.duj=function(){this.Eua&&(pb.g(this.$).ga.pK(Object(ca.a)(this,this.nd,"onSelectionChanged")),this.Eua=!1)};W.prototype.s3i=function(sa){var hb=new xb.Range(sa.Reference.FirstRow+1,sa.Reference.FirstColumn+1,sa.Reference.LastRow+1,sa.Reference.LastColumn+1,!1,!1);1===sa.BindingType&&(sa.HasHeaders&&--hb.top,sa.HasTotals&&(hb.bottom+=1));var cc=pb.g(this.$).ga.ya.selectedRanges;sa=hb.fvb(this.ilc);cc=hb.fvb(cc);return(hb=hb.Of(pb.g(this.$).ga.ya.activeRange))&&
(hc.e(sa)&&!hc.e(cc)||!hc.e(sa)&&!hc.e(cc)&&!dc.Q(sa,cc))?hb:null};W.prototype.C4i=function(){var sa=this;Array.forEach(this.WD,function(hb){if(hb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&hb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa.fh.dj.PWb(sa.controlId))if(hb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)hb.vYb(new Jb.a(hb.eventId,sa.controlId,null));else if(hb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var cc=
sa.W_a(hb.targetId);if(cc&&cc.IsValidRef&&(sa.$.fa.isNamedObjectViewMode?sa.$.Ab.sa.sheetName:sa.$.Aa.sa.name)===cc.Reference.SheetName){var xc=sa.s3i(cc);xc&&hb.vYb(new S(hb.eventId,sa.controlId,sa.fh.BXb(cc),cc,xc.top-1,xc.left-1,xc.height,xc.width))}}})};W.prototype.nd=function(){this.enabled&&(this.C4i(),this.ilc=dc.d(pb.g(this.$).ga.ya.selectedRanges))};W.prototype.Jqb=function(sa,hb){if(!this.WD)return null;for(var cc=0;cc<this.WD.length;cc++){var xc=this.WD[cc];if(xc.eventId===sa&&xc.targetId===
hb)return xc}return null};W.prototype.mXe=function(sa){sa.controlId===this.ud.InstanceId&&Array.forEach(this.WD,function(hb){hb.fgi(sa)&&hb.vYb(sa)})};W.prototype.hKe=function(){for(var sa=ae.a(this.$).Hy,hb=sa.length-1;0<=hb;--hb){var cc=sa[hb];if(3===cc.floatingObject.type&&cc.floatingObject.al.InstanceId===this.t0.WebExtensionId)return cc}return null};W.prototype.x4h=function(){for(var sa=0;sa<this.$.Ab.count;sa++)if(this.$.Ab.getItem(sa).Xia===this.t0.WebExtensionId)return!0;return!1};W.prototype.zjf=
function(sa){(sa=Object(ic.a)(223,sa))&&!sa.Ep()&&(!this.ud||OSF.OsfControl.isFirstPartyStoreString(this.ud.PrimaryMarketplace.MarketplaceType)||this.$.Hqa?(sa.eg=this.ud,sa.zg=this.fh,this.pSd=sa,this.Nqc(sa.rEa),Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(sa.qof(),(this.ud.SharedRuntime&&1===this.ud.SharedRuntime.LifeTime||this.ud.SharedRuntimeId)&&!this.ud.TaskpaneVisible&&sa.Rf(!1)):((this.ud.SharedRuntime&&1===this.ud.SharedRuntime.LifeTime||
this.ud.SharedRuntimeId)&&!this.ud.TaskpaneVisible&&sa.Rf(!1),sa.qof()),this.a3a||(Fd.a.Sd(this.$)?sa.QQ():Pc.a(this.$).result.$C(sa,!0)),this.$.ea.Ea(77,void 0).UEf(Object(ca.a)(this,this.zjf,"onAgavePaneCreated")),this.dga=Object(ic.a)(250,sa)):nb.ULS.sendTraceTag(571774816,0,50,"Taskpane web add-in disabled by doc IRM"))};W.prototype.Nqc=function(sa){this.wIc=sa;this.Pt.id=this.Suf;this.Pt.className="ewa-wx-container-div";this.Pt.dir=this.$.isChromeRtl?"rtl":"ltr";this.u6i()};W.prototype.onFloatingObjectControlAdded=
function(sa,hb){3===hb.control.floatingObject.type&&hb.control.floatingObject.al.InstanceId===this.t0.WebExtensionId&&(this.dga=Object(ic.a)(250,hb.control),this.Nqc(hb.control.$d.firstChild),ae.a(this.$).XBd(Object(ca.a)(this,this.onFloatingObjectControlAdded,"onFloatingObjectControlAdded")))};W.prototype.USe=function(){if(!this.enabled)return null;var sa=Xa.a(this.al)?"":this.al.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.al.PrimaryMarketplace.SolutionId,
sa)};W.prototype.oXe=function(sa,hb){if(Ub.EwaSettings.ka(25))this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hb);else try{if(nb.ULS.sendTraceTag(19931730,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.K5d)this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,hb);else{var cc={};cc[kc.a.Okb]=this.controlId;var xc=new Ic.a(sa,0,this.$.isEditMode?2:1,0,null);this.$.Na.Xb(xc,cc);this.fh.Bu(hb)}}catch(vd){nb.ULS.sendTraceTag(19931731,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",
vd.message),this.fh.sf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,hb)}};W.$4g=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};W.a4e=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||sa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent};W.Mgd=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};W.Z3e=function(sa){return sa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};W.$3e=function(sa){return sa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};W.Y3e=function(sa){return sa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Jl.Object.defineProperties(W.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.ud.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.ud.WebExtensionType}},
ownerAddinAssetId:{configurable:!0,enumerable:!0,get:function(){return this.ud.OwnerAddinAssetId}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.ud.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.OT}},Pt:{configurable:!0,enumerable:!0,get:function(){return this.wIc}},rT:{configurable:!0,enumerable:!0,get:function(){return this.ud.SrcLocationOverrideResourceId?
this.fh.$ha(this.ud.PrimaryMarketplace.SolutionId,this.ud.SrcLocationOverrideResourceId):this.ud.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.ud.SrcLocationOverrideResourceId}},al:{configurable:!0,enumerable:!0,get:function(){return this.ud}},dga:{configurable:!0,enumerable:!0,get:function(){return this.NUd},set:function(sa){this.NUd=sa}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.K5d}},qGa:{configurable:!0,
enumerable:!0,get:function(){return this.qBc},set:function(sa){this.qBc=sa}},s_c:{configurable:!0,enumerable:!0,get:function(){return this.dTa},set:function(sa){this.dTa=sa}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.ud.FocusOnIframeWhenLoaded}},Sid:{configurable:!0,enumerable:!0,get:function(){return this.r1d},set:function(sa){this.r1d=sa}}});Object(sb.a)(W,"OsfControl",gb.a,[846]);H.prototype.add=function(sa){this.wWa[sa]=!0};H.prototype.remove=function(sa){delete this.wWa[sa]};
H.prototype.clear=function(){for(var sa=Ml(Object.keys(this.wWa)),hb=sa.next();!hb.done;hb=sa.next())delete this.wWa[hb.value]};H.prototype.zYe=function(){return 0<Object.keys(this.wWa).length};H.prototype.Zsh=function(){return Object.keys(this.wWa)};Object(sb.a)(H,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Hd=b(55);C.prototype.Flb=function(sa){51===sa.messageType?this.CDf=this.GEa(sa.actionType,this.CDf,Object(ca.a)(this,this.Soi,"onChartActiveChartChanged")):52===sa.messageType&&
(this.DDf=this.GEa(sa.actionType,this.DDf,Object(ca.a)(this,this.Toi,"onChartDeactiveChartChanged")))};C.prototype.GEa=function(sa,hb,cc){if(1===sa)hb||pb.g(this.$).ga.Sa.kPc(cc),hb++,this.Z9i();else if(2===sa){if(1>hb)return hb;1===hb&&pb.g(this.$).ga.Sa.YBd(cc);hb--}return hb};C.prototype.Soi=function(){var sa=pb.g(this.$).ga.Sa.XB;if(this.vgd(sa)&&(sa=this.$6b(sa))){var hb={chartId:sa};hb.worksheetId=this.jia();hb=Hd.a.Oc(hb);this.Nha(51,sa,hb);this.Nha(51,this.jia(),hb)}};C.prototype.Toi=function(){if(this.b8a){var sa=
{};sa.chartId=this.b8a;sa.worksheetId=this.qHb;sa=Hd.a.Oc(sa);this.Nha(52,this.b8a,sa);this.Nha(52,this.qHb,sa)}sa=pb.g(this.$).ga.Sa.XB;this.vgd(sa)?(this.b8a=this.$6b(sa),this.qHb=this.jia()):this.qHb=this.b8a=null};C.prototype.Nha=function(sa,hb,cc){hb&&this.dj.nZ(sa,hb)&&this.Ch.$L(sa,hb,cc)};C.prototype.$6b=function(sa){return sa&&sa.floatingObject?(sa=sa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===sa.length?sa[0]:null:null};C.prototype.jia=function(){var sa=
this.$.Aa.sa;return!sa||sa.NH?null:sa.sheetId};C.prototype.Z9i=function(){var sa=pb.g(this.$).ga.Sa.XB;this.vgd(sa)&&(this.b8a=this.$6b(sa),this.qHb=this.jia())};C.prototype.vgd=function(sa){return!!sa&&!!sa.floatingObject&&!sa.floatingObject.type};Object(sb.a)(C,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Nd=b(850),ge=b(179),Ed=b(647),Zc=b(95),he=b(336),Ke=b(52),Ue=Wa.a;Cm(B,Ue);B.prototype.jXb=function(sa){Object(ic.a)(he.a,this.$.Aa);1===sa.actionType?(this.cya||this.grid.ga.ZF(Object(ca.a)(this,
this.nd,"onSelectionChanged")),this.cya++):2!==sa.actionType||1>this.cya||(1===this.cya&&this.grid.ga.pK(Object(ca.a)(this,this.nd,"onSelectionChanged")),this.cya--)};B.prototype.sqc=function(sa){sa?this.OT++:(0<this.OT&&this.OT--,this.OT||this.nd(null,new Ed.a(!1)))};B.prototype.nd=function(sa,hb){var cc=this;if(this.enabled&&!(this.J5e()||hb&&hb.U8e)&&(sa=Object(ic.a)(Zc.a,this.$.Aa.sa))&&!sa.NH){var xc=sa.sheetId,vd=this.sPe(),Xd=null,Je=null;this.dj.J8e()&&(Xd=this.grid.kc.Rk(this.grid.ga.ya.activeCell),
Je=xc in this.nec?this.nec[xc]:null);this.aRc(xc,vd)&&Ea.TaskExtensions.Da(Ke.Task.Ua(!0),function(){cc.nPh(xc,vd);cc.YOh(xc,vd,Xd,Je)},this.ma);this.p1c(xc,vd,Xd)}};B.prototype.sPe=function(){return this.grid.ga.ya.selectedRanges};B.prototype.aRc=function(sa,hb){return Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!sa&&ge.e(this.nLa)||sa in this.nLa)&&!dc.Q(this.nLa[sa],hb):sa in this.nLa&&!dc.Q(this.nLa[sa],hb)};B.prototype.p1c=function(sa,
hb,cc){this.nLa[sa]=dc.d(hb);this.nec[sa]=cc};B.prototype.J5e=function(){return this.grid.isEditing||this.grid.wi};B.prototype.JKe=function(sa,hb){this.dj.nZ(14,sa)&&this.Ch.$L(14,sa,hb);this.dj.nZ(14,Nd.a.eW)&&this.Ch.$L(14,Nd.a.eW,hb)};B.prototype.nPh=function(sa,hb){var cc={};cc.worksheetId=sa;cc.address=this.Z$c(hb);hb=Hd.a.Oc(cc);this.JKe(sa,hb)};B.prototype.YOh=function(sa,hb,cc,xc){if(this.dj.J8e()){var vd="",Xd="";xc&&(vd=xc.qj);cc&&(Xd=cc.qj);xc?cc?(hb=cc.usedRange.fvb(hb),vd!==Xd&&this.B5b(vd,
"",sa),this.B5b(Xd,this.Z$c(hb),sa)):this.B5b(vd,"",sa):cc&&(vd=cc.usedRange.fvb(hb),this.B5b(Xd,this.Z$c(vd),sa))}};B.prototype.B5b=function(sa,hb,cc){if(this.dj.nZ(100,sa)){var xc={};xc.address=hb;xc.worksheetId=cc;this.Ch.$L(100,sa,Hd.a.Oc(xc))}};B.prototype.Z$c=function(sa){return dc.i(sa,",",this.$,!1)};B.prototype.dispose=function(){0<this.cya&&this.grid.ga.pK(Object(ca.a)(this,this.nd,"onSelectionChanged"));this.nec=this.nLa=null;this.cya=0;this.Ch=this.dj=this.$=this.grid=null};Jl.Object.defineProperties(B.prototype,
{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.OT&&0<this.cya}}});Object(sb.a)(B,"RichApiEventSelectionChangedHandler",Wa.a,[]);var Pb=b(334);Cm(J,B);J.prototype.sPe=function(){return Pb.a.ZYa(this.grid.ga.rangePicker.ZM)};J.prototype.aRc=function(sa,hb){return Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5670378_EnablePickedRangesSelectionChangedEventForFirstTimeOnOpenSheet")?this.E$e!==sa||!dc.Q(this.D$e,hb):B.prototype.aRc.call(this,sa,hb)};J.prototype.p1c=function(sa,hb,cc){Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5670378_EnablePickedRangesSelectionChangedEventForFirstTimeOnOpenSheet")?
(this.E$e=sa,this.D$e=dc.d(hb)):B.prototype.p1c.call(this,sa,hb,cc)};J.prototype.J5e=function(){return!this.grid.isEditing&&!this.grid.wi};J.prototype.JKe=function(sa,hb){this.dj.nZ(2700,Nd.a.eW)&&this.Ch.$L(2700,Nd.a.eW,hb)};Object(sb.a)(J,"RichApiEventPickedRangesChangedHandler",B,[]);z.prototype.Flb=function(sa){var hb=pb.g(this.$).ga;1===sa.actionType?(this.bOa||this.cOa||hb.Sa.kPc(Object(ca.a)(this,this.Tmf,"onFloatingObjectSelectionChangedByUserAction")),2101===sa.messageType?this.bOa++:2102===
sa.messageType&&this.cOa++):2===sa.actionType&&(2101===sa.messageType?this.bOa=0<this.bOa?this.bOa-1:0:2102===sa.messageType&&(this.cOa=0<this.cOa?this.cOa-1:0),this.bOa||this.cOa||hb.Sa.YBd(Object(ca.a)(this,this.Tmf,"onFloatingObjectSelectionChangedByUserAction")))};z.prototype.Tmf=function(){var sa=pb.g(this.$).ga.Sa.XB;if(0<this.cOa&&this.yga&&this.XEa){var hb={};hb.shapeId=this.yga;hb.worksheetId=this.XEa;hb=Hd.a.Oc(hb);this.fireEvent(2102,this.yga,hb)}this.a6h(sa)?(this.yga=this.Isj(sa),this.XEa=
this.jia(),this.yga&&this.XEa)?0<this.bOa&&(sa={},sa.shapeId=this.yga,sa.worksheetId=this.XEa,sa=Hd.a.Oc(sa),this.fireEvent(2101,this.yga,sa)):nb.ULS.sendTraceTag(38372579,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",this.yga,this.XEa):this.XEa=this.yga=null};z.prototype.a6h=function(sa){return!!sa&&!!sa.floatingObject&&(!sa.floatingObject.type||7===sa.floatingObject.type||1===sa.floatingObject.type||3===sa.floatingObject.type||
5===sa.floatingObject.type)};z.prototype.Isj=function(sa){if(!sa||!sa.floatingObject)return null;sa=sa.floatingObject.id;var hb=sa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));hb=hb&&1===hb.length?hb[0]:null;return hb?hb:(nb.ULS.sendTraceTag(38372608,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",sa),null)};z.prototype.jia=function(){var sa=this.$.Aa.sa;return!sa||sa.NH?null:sa.sheetId};z.prototype.fireEvent=function(sa,hb,cc){hb&&this.dj.nZ(sa,
hb)&&this.Ch.$L(sa,hb,cc)};Object(sb.a)(z,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);x.prototype.Flb=function(sa){11===sa.messageType?sa.targetId===Nd.a.eW?this.xzg(sa.actionType):this.wzg(sa.actionType):12===sa.messageType&&(sa.targetId===Nd.a.eW?this.yzg(sa.actionType):this.zzg(sa.actionType))};x.prototype.wzg=function(sa){this.EDf=this.GEa(sa,this.EDf,Object(ca.a)(this,this.JBi,"onWorksheetActiveSheetChanged"))};x.prototype.zzg=function(sa){this.HDf=this.GEa(sa,this.HDf,Object(ca.a)(this,
this.MBi,"onWorksheetDeactiveSheetChanged"))};x.prototype.xzg=function(sa){this.FDf=this.GEa(sa,this.FDf,Object(ca.a)(this,this.KBi,"onWorksheetCollectionActiveSheetChanged"))};x.prototype.yzg=function(sa){this.GDf=this.GEa(sa,this.GDf,Object(ca.a)(this,this.LBi,"onWorksheetCollectionDeactiveSheetChanged"))};x.prototype.GEa=function(sa,hb,cc){1===sa?hb=this.DRc(hb,cc):2===sa&&(hb=this.G0c(hb,cc));return hb};x.prototype.DRc=function(sa,hb){sa||this.$.Aa.Vf(hb);sa++;return sa};x.prototype.G0c=function(sa,
hb){if(1>sa)return sa;1===sa&&this.$.Aa.wg(hb);sa--;return sa};x.prototype.JBi=function(sa,hb){sa=Object(ic.a)(Zc.a,hb.sa);this.K4a(sa)&&(hb={},hb.worksheetId=sa.sheetId,hb=Hd.a.Oc(hb),this.Nha(11,sa.sheetId,hb))};x.prototype.MBi=function(sa,hb){sa=Object(ic.a)(Zc.a,hb.lK);this.K4a(sa)&&(hb={},hb.worksheetId=sa.sheetId,hb=Hd.a.Oc(hb),this.Nha(12,sa.sheetId,hb))};x.prototype.KBi=function(sa,hb){sa=Object(ic.a)(Zc.a,hb.sa);this.K4a(sa)&&(hb={},hb.worksheetId=sa.sheetId,sa=Hd.a.Oc(hb),this.Nha(11,null,
sa,!0))};x.prototype.LBi=function(sa,hb){sa=Object(ic.a)(Zc.a,hb.lK);this.K4a(sa)&&(hb={},hb.worksheetId=sa.sheetId,sa=Hd.a.Oc(hb),this.Nha(12,null,sa,!0))};x.prototype.K4a=function(sa){return!!sa&&!sa.NH};x.prototype.Nha=function(sa,hb,cc,xc){hb=(void 0===xc?0:xc)?Nd.a.eW:hb;this.dj.nZ(sa,hb)&&this.Ch.$L(sa,hb,cc)};Object(sb.a)(x,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var kb=b(167),yb=b(13),Ma=b(276),jd=Sys.EventArgs;Cm(y,jd);Object(sb.a)(y,"ClickInActiveCellEventArgs",Sys.EventArgs,
[]);A.prototype.dispose=function(){this.Ruj()};A.prototype.TQi=function(){for(var sa=Ml(this.gridView.uo),hb=sa.next();!hb.done;hb=sa.next())hb=hb.value.domElement,kb.a.instance.qa(yb.a.pointerDown,hb,Object(ca.a)(this,this.onPointerDown,"onPointerDown")),Ma.a.instance.qa(yb.a.click,hb,Object(ca.a)(this,this.Yc,"onClick"))};A.prototype.Ruj=function(){for(var sa=Ml(this.gridView.uo),hb=sa.next();!hb.done;hb=sa.next())hb=hb.value.domElement,kb.a.instance.Ca(yb.a.pointerDown,hb,Object(ca.a)(this,this.onPointerDown,
"onPointerDown")),Ma.a.instance.Ca(yb.a.click,hb,Object(ca.a)(this,this.Yc,"onClick"))};A.prototype.onPointerDown=function(sa){var hb=this,cc;this.Y1h?3===sa.Cb?(function(){var xc=hb.gridView.X6b(sa.clientPoint);cc=xc.lFa;return xc}(),this.Cdc=!!cc&&this.gridView.ga.ya.u1c(cc)):this.Cdc=!1:(function(){var xc=hb.gridView.X6b(sa.clientPoint);cc=xc.lFa;return xc}(),this.Cdc=3===sa.Cb&&!!cc&&this.gridView.ga.ya.u1c(cc));this.EZb=sa.clientPoint;return!1};A.prototype.Yc=function(sa){if(this.gridView.inRangePicker||
this.gridView.wi||this.Cdc||sa.shiftKey||sa.ctrlKey||sa.Ga.button||!this.EZb||!sa.clientPoint||sa.clientPoint.x!==this.EZb.x||sa.clientPoint.y!==this.EZb.y)return!1;var hb=this.gridView.X6b(sa.clientPoint);sa=hb.lFa;hb=hb.returnValue;var cc=Object(ic.a)(Zc.a,this.$.Aa.sa);if(hb&&cc&&!cc.NH){if(!this.gridView.ga.ya.z3.contains(sa))return!1;sa=new y(cc,sa,Cb.HelperMethods.twd(hb.x),Cb.HelperMethods.twd(hb.y));this.NBi(sa)}return!1};A.prototype.NBi=function(sa){var hb=sa.sheet;if(this.K4a(hb)){var cc=
{};cc.worksheetId=hb.sheetId;cc.address=sa.NIg.toString();cc.offsetX=sa.offsetX;cc.offsetY=sa.offsetY;sa=hb.sheetId;this.dj.nZ(21,sa)&&(hb=Hd.a.Oc(cc),this.Ch.$L(21,sa,hb));sa=Nd.a.eW;this.dj.nZ(21,sa)&&(cc=Hd.a.Oc(cc),this.Ch.$L(21,sa,cc))}};A.prototype.K4a=function(sa){return!!sa&&!sa.NH};Object(sb.a)(A,"RichApiEventSingleClickedHandler",null,[]);v.prototype.jXb=function(sa){2E3===sa.messageType&&(1===sa.actionType?(this.YDb||pb.g(this.$).ga.Sa.kPc(Object(ca.a)(this,this.cuf,"onVisualSelectionChanged")),
this.YDb++,this.B6i()):2===sa.actionType&&this.YDb&&(1===this.YDb&&pb.g(this.$).ga.Sa.YBd(Object(ca.a)(this,this.cuf,"onVisualSelectionChanged")),this.YDb--))};v.prototype.cuf=function(){var sa=pb.g(this.$).ga.Sa.XB;if(sa)if(this.t9e(sa)){var hb=this.jia();this.$5c(hb);this.Z7a=sa.floatingObject.id;this.Q7a=hb}else this.Z7a&&(this.$5c(this.Q7a),this.Q7a=this.Z7a=null);else this.Z7a&&(this.$5c(this.Q7a),this.Q7a=this.Z7a=null)};v.prototype.$5c=function(sa){var hb={};hb.worksheetId=sa;hb.revisionLoad=
!1;if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Ub.EwaSettings.ka(774)||Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var cc=pb.g(this.$).ga.Sa.XB;hb.selectedVisualId=cc&&cc.floatingObject&&cc.floatingObject.hd?cc.floatingObject.hd.VisualID:null}hb=Hd.a.Oc(hb);sa&&this.dj.nZ(2E3,sa)&&this.Ch.$L(2E3,sa,hb)};v.prototype.jia=function(){var sa=this.$.Aa.sa;return!sa||sa.NH?null:sa.sheetId};
v.prototype.B6i=function(){var sa=pb.g(this.$).ga.Sa.XB;this.t9e(sa)&&(this.Z7a=sa.floatingObject.id,this.Q7a=this.jia())};v.prototype.t9e=function(sa){return!!sa&&sa.Tkd()};Object(sb.a)(v,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.vzg=function(sa){1===sa.actionType?(this.ZDb||this.Szg(),this.ZDb++):2!==sa.actionType||1>this.ZDb||(1===this.ZDb&&this.G1g(),this.ZDb--)};w.prototype.vpe=function(){var sa=document.hasFocus();if(this.k6f!==sa){if(sa){var hb=Hd.a.Oc({});this.Ch.$L(2203,
Nd.a.eW,hb)}this.k6f=sa}};w.prototype.Szg=function(){if(this.dj.nZ(2203,Nd.a.eW))if(this.Ajd){var sa={};sa.timeout=this.$.Ba.CheckFocusTimeout;this.Q5b=window.requestIdleCallback(Object(ca.a)(this,this.wpe,"checkFocusCallback"),sa)}else this.Q5b=window.setInterval(Object(ca.a)(this,this.vpe,"checkFocus"),this.$.Ba.CheckFocusTimeInterval)};w.prototype.G1g=function(){this.Ajd?window.cancelIdleCallback(this.Q5b):window.clearInterval(this.Q5b)};w.prototype.wpe=function(sa){(0<sa.timeRemaining()||sa.didTimeout)&&
this.vpe();window.requestIdleCallback(Object(ca.a)(this,this.wpe,"checkFocusCallback"))};Object(sb.a)(w,"RichApiEventWorkbookActivatedHandler",null,[]);var Zd;(function(sa){sa[sa.none=0]="none";sa[sa.registerEvent=1]="registerEvent";sa[sa.unregisterEvent=2]="unregisterEvent";sa[sa.customFunction=3]="customFunction";sa[sa.showCard=4]="showCard";sa[sa.createWorkbook=5]="createWorkbook";sa[sa.openWorkbook=6]="openWorkbook";sa[sa.enableEvents=7]="enableEvents";sa[sa.closeWorkbook=8]="closeWorkbook";sa[sa.setCalculationMode=
9]="setCalculationMode";sa[sa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";sa[sa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";sa[sa.workbookLinksEnableContent=12]="workbookLinksEnableContent";sa[sa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";sa[sa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";sa[sa.rangePicker=15]="rangePicker";sa[sa.enableRichApiRecording=16]="enableRichApiRecording";sa[sa.recordAction=17]="recordAction";sa[sa.focus=
18]="focus"})(Zd||(Zd={}));Object(sb.b)("PostProcessActionType",Zd);var Zb=b(229);u.prototype.uzg=function(sa){1===sa.actionType?(this.$.vaa=!0,Object(ic.a)(b(843).DdaFacade,Zb.a(this.$)).Z5c(!0)):2===sa.actionType&&(this.$.vaa=!1);this.Tuf=sa.controlId;nb.ULS.sendTraceTag(594105035,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",Zd[sa.actionType],this.Tuf,this.$.vaa)};u.prototype.m9g=function(sa){Object(ic.a)(b(843).DdaFacade,
Zb.a(this.$)).LKe(sa,this.$.vaa)};u.prototype.UVh=function(){var sa=this;this.$.Aaa&&Ea.TaskExtensions.Da(Nc.GetServiceTaskFactory.Xa(this.$.ea,297,298,1,"Microsoft.Office.Excel.WebUI.Client.MacroRecorderEvents.IMacroRecorderEventHandler"),function(hb){(hb=hb.result)&&hb.init(Object(ca.a)(sa,sa.Y5c,"fireMacroRecorderEvent"))},this.$.ma,3)};u.prototype.Y5c=function(sa,hb){var cc=Nd.a.eW,xc={};xc.eventId=sa;xc.payload=hb;this.dj.nZ(2201,cc)&&this.Ch.$L(2201,cc,Hd.a.Oc(xc))};Object(sb.a)(u,"RichApiMacroRecorderEventHandler",
null,[]);Object(sb.a)(k,"SessionRecreationInfo",null,[]);t.prototype.cki=function(){return Ub.EwaSettings.ka(264)?this.dj.ZPh()||!!this.runtimeCalculationMode:!1};t.prototype.xEg=function(){var sa={};sa.eventRegistrationInfos=this.dj.Uyh();sa.runtimeCalculationMode=this.runtimeCalculationMode;sa=Object.assign(new k,{runtimeState:sa});var hb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};hb.RequestBody=JSON.stringify(sa);hb.RequestFlags=1;return hb};Object(sb.a)(t,"RichApiRuntimeStateHandler",
null,[]);Object(sb.a)(r,"UserOperationQueueItemsStatisticsData",null,[]);var wb=b(321),gc=b(28),uc=b(18),id=b(287),Wc=b(45),pd=b(606),Yd=b(63),be=b(57),me=b(68),Gd=wb.a;Cm(m,Gd);m.prototype.dispose=function(){this.$&&(this.$.Aa.yH(Object(ca.a)(this,this.ro,"onActiveItemChanging")),this.$.Ab.yH(Object(ca.a)(this,this.ro,"onActiveItemChanging")),this.$.Ab.wg(Object(ca.a)(this,this.vf,"onActiveItemChanged")),this.$.Aa.wg(Object(ca.a)(this,this.vf,"onActiveItemChanged")));this.YRa&&(this.YRa.Jp(Object(ca.a)(this,
this.Le,"onBlockCacheItemChanged")),this.YRa.zH(Object(ca.a)(this,this.jm,"onBlockCacheItemEvicted")),this.YRa.Yq(Object(ca.a)(this,this.Zg,"onBlockCacheConsistent")));Ub.EwaSettings.wc()&&this.Ps(Object(ca.a)(this,this.onContentReady,"onContentReady"));this.clearCache();vb.a.Ia(this.YRa);this.YRa=null;Qc.DOMElementExtensions.rg(this.domElement);Gd.prototype.dispose.call(this)};m.prototype.t6i=function(sa){Qc.DOMElementExtensions.rg(Qc.DOMElementExtensions.getElementById(this.domElement,sa.id));this.domElement.appendChild(sa)};
m.prototype.bfd=function(){if(this.iua&&!this.C_b){var sa=Object(ic.a)(b(843).DdaFacade,Zb.a(this.$)).fn(this.iua.InstanceId);sa&&(sa.resize(this.iua.Width,this.iua.Height),sa.la(this.domElement),sa.showHide(!0),this.C_b=!0)}};m.prototype.M4a=function(){return!0};m.prototype.jm=function(sa,hb){hb.Qd.hash===this.hashCode&&this.iua&&Object(ic.a)(b(843).DdaFacade,this.$.ea.Ea(35,void 0)).dgj(this.iua.InstanceId)};m.prototype.Le=function(sa,hb){switch(hb.Qd.block.state){case 1:case 3:case 5:this.fma(hb)}};
m.prototype.Zg=function(){this.pDb(!0)};m.prototype.fma=function(sa){this.iua=sa.Qd.block.ye;this.C_b=!1;this.bfd()};m.prototype.qRa=function(sa){this.$.fa.jZ&&sa&&(sa.gu||(sa.gu=new id.a),sa.gu.Tg=new Wc.a(this.domElement.scrollLeft,this.domElement.scrollTop),sa.gu.MCb=20)};m.prototype.clearCache=function(){this.Ha.fya(this.hashCode);this.iua=this.hashCode=null;this.C_b=!1};m.prototype.ro=function(sa,hb){this.isVisible&&this.qRa(hb.lK);this.clearCache()};m.prototype.vf=function(sa,hb){this.vQa(hb.sa,
!!hb.lK)};m.prototype.vQa=function(sa,hb){if(this.isVisible=!!sa&&Yd.p(sa))this.hashCode=this.Ha.Kfa(sa,be.a.Vob,this.hashCode),this.Zqc(hb)};m.prototype.RM=function(){this.$.fa.Pka()};m.HEa=function(sa){if(!X(sa)){var hb=sa.gf;sa.ea.La(34,new m(sa,new pd.a(sa,sa.fa,sa.ra.Ek,3,0),hb.appendChild(hb.ownerDocument.createElement("div"))))}};Jl.Object.defineProperties(m.prototype,{Ha:{configurable:!0,enumerable:!0,get:function(){return this.YRa}}});Object(sb.a)(m,"WebExtensionView",wb.a,[838,163,7]);var Rd=
b(214),Yf=b(519),mg=b(365),zf=b(430),Ce=b(160),ne=b(81),Bf=b(127),Le=b(44),gd=b(42),$b=b(147),Fc=b(104),Vc=b(69),ud=b(26),Ge=b(27),ce=b(303),Ae=b(16),Ob=b(273),ac=b(862),fc=b(50),Uc=b(145),Vd=b(1105),ld=b(186),Od=b(997),De=b(29);b.d(F,"DdaFacade",function(){return a});var Yb=Bb.a;Cm(a,Yb);a.prototype.Mee=function(sa){this.addHandler("cd",sa)};a.prototype.qTi=function(sa){this.removeHandler("cd",sa)};a.prototype.Nee=function(sa){this.addHandler("csc",sa)};a.prototype.Zmc=function(sa){this.removeHandler("csc",
sa)};a.prototype.Mrg=function(sa){this.addHandler("ca",sa)};a.prototype.pTi=function(sa){this.removeHandler("ca",sa)};a.prototype.Nrg=function(sa){this.addHandler("ci",sa)};a.prototype.Org=function(sa){this.addHandler("ekros",sa)};a.prototype.rTi=function(sa){this.removeHandler("ekros",sa)};a.prototype.Nvd=function(sa,hb){try{return JSON.parse(sa)[hb].toLowerCase()}catch(cc){return""}};a.prototype.Tbj=function(sa){var hb=this.Nvd(sa,"AudienceGroup"),cc=this.Nvd(sa,"SessionOrigin");try{var xc=parseInt(this.Nvd(sa,
"Ring"));if("automation"!==hb&&"bluechicken"!==cc&&-2<=xc)return!0}catch(vd){if("automation"!==hb&&"bluechicken"!==cc)return!0}return!1};a.prototype.BXb=function(sa){var hb={};hb.Name=sa.Name;hb.BindingType=sa.BindingType;hb.HasHeaders=sa.HasHeaders;sa.IsValidRef&&(hb.ColCount=sa.Reference.LastColumn-sa.Reference.FirstColumn+1,hb.RowCount=sa.Reference.LastRow-sa.Reference.FirstRow+1);return hb};a.prototype.u$h=function(sa,hb){hb=this.CDg(hb);this.wm.launchInsertDialog(sa,null,hb)};a.prototype.Gyd=
function(sa,hb){var cc={};cc.callbackFunc=sa;cc.storeType=OSF.StoreTypeEnum.MarketPlace;cc.fromInsertDialog=!1;cc.refresh=hb;this.wm.queryEntitlementDetails(cc)};a.prototype.invokeDdaMethod=function(sa,hb){var cc=this.fn(sa.DdaMethod.ControlId);cc?cc.invokeDdaMethod(sa,hb):this.sf(wa.a.internalError,hb)};a.prototype.registerDdaEventAsync=function(sa,hb,cc,xc,vd){(hb=this.fn(hb))?a.Ivb(sa)?hb.HPi(sa,cc,xc,vd):this.sf(wa.a.gvd,vd):this.sf(wa.a.internalError,vd)};a.prototype.unregisterDdaEventAsync=
function(sa,hb,cc,xc,vd){(hb=this.fn(hb))?a.Ivb(sa)?hb.vuj(sa,cc,xc,vd):this.sf(wa.a.gvd,vd):this.sf(wa.a.internalError,vd)};a.prototype.dispose=function(){this.disposed||(this.$.nl(Object(ca.a)(this,this.sd,"onWorkbookOpened")),this.fa.xk(Object(ca.a)(this,this.ed,"onSessionIdChanged")),this.fa.WV(Object(ca.a)(this,this.rq,"onLoadOnDemandOccurred")),this.fa.ow(Object(ca.a)(this,this.hg,"onWorkbookMetadataChanged")),this.rQc.detach(this),this.$.userOperationManager.WC(Object(ca.a)(this,this.NQ,"onQueueItemChanged")),
this.Ljc=this.Af=this.Ch=this.rQc=this.wb=null,this.gHa&&(this.gHa.dispose(),this.gHa=null),vb.a.Ia(this.zEd),vb.a.Ia(this.yEd),this.yZa&&(this.yZa.dispose(),this.yZa=null),Yb.prototype.dispose.call(this),this.disposed=!0,nb.ULS.sendTraceTag(39613473,0,50,"DdaFacade is disposed"))};a.prototype.w7b=function(sa){return(sa=this.fn(sa))?sa.getDefaultIconUrl():null};a.prototype.sqc=function(sa){if(this.Swe!==sa){this.Swe=sa;for(var hb=0,cc=this.Af.length;hb<cc;hb++){var xc=this.Af[hb];sa?xc.kze(!1):xc.b8g()}this.zEd.sqc(sa);
this.yEd.sqc(sa)}};a.prototype.Hxh=function(sa){return(sa=this.fn(sa))?sa.getDefaultDisplayName():null};a.prototype.hg=function(){this.wAa=this.fa.Gn.WebExtensions;for(var sa=this.Af.length-1;0<=sa;--sa){var hb=this.Af[sa],cc;if(cc=!this.Qmh(hb.controlId))cc=hb,cc=Ub.EwaSettings.ka(123)?$c.a.na(cc.qGa):!0;cc&&(hb.Xhc(),Array.removeAt(this.Af,sa))}if(this.wAa)for(sa=0,hb=this.wAa.length;sa<hb;sa++){cc=this.wAa[sa];var xc=this.fn(cc.WebExtensionId);xc&&xc.Qtd(cc)}};a.prototype.Lka=function(sa){this.raiseEvent("csc",
sa.getID())};a.prototype.Xpf=function(sa,hb,cc){if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&hb===OSF.AgaveHostAction.KeyboardShortcuts){var xc=Object(ic.a)(Object,cc);hb={};hb.keyCode=xc.keyCode;hb.type="keydown";hb.ctrlKey=xc.ctrlKey;hb.shiftKey=xc.shiftKey;hb.altKey=xc.altKey;hb.metaKey=xc.metaKey;sa=this.fn(sa);xc=sa.dga;hb.srcElement=Object(Ga.a)(223,xc)?xc.rEa:pb.g(this.$).Nb;hb=new Sys.UI.DomEvent(hb);sa={focusedAddinId:a.Cta(sa.al,this.$)};xc=
new Ic.a(1461300262,1,this.$.jd,6,null);pb.g(this.$).vFb(hb,xc,sa)}else if(hb===OSF.AgaveHostAction.Select)this.Mcj&&pb.g(this.$).Zo(!0),this.dXe(!0);else if(hb===OSF.AgaveHostAction.UnSelect)this.dXe(!1);else if(hb===OSF.AgaveHostAction.CancelDialog)this.yJ(-684355545,null);else if(hb===OSF.AgaveHostAction.InsertAgave)sa={},cc&&(sa[kc.a.Mkb]=cc,sa[Da.a.Mj]=a.yob(cc),this.yJ(-741808261,sa));else if(hb===OSF.AgaveHostAction.InsertDevManifest)sa={},cc&&(sa[kc.a.Mkb]=cc,sa[Da.a.Mj]=a.yob(cc),this.yJ(-741808261,
sa));else if(hb===OSF.AgaveHostAction.InsertDevManifestError)sa=Object(ic.a)(Object,cc),hb={},sa=(hb.ak1=this.wm.getDevManifestInvalidUrlErrorString(sa.manifestUrl),hb),this.yJ(-2025863019,sa);else if(hb===OSF.AgaveHostAction.NotifyHostError)sa={},sa=(sa.ak1=this.wm.getManifestInvaildErrorString(),sa),this.yJ(-2025863019,sa);else if(hb===OSF.AgaveHostAction.RefreshAddinCommands)Ub.EwaSettings.ka(54)&&this.yJ(De.a.refreshAddinCommands,null);else if(hb===OSF.AgaveHostAction.CtrlF6Exit||hb===OSF.AgaveHostAction.CtrlF6ExitShift){if(xc=
this.$.ea.Ea(15,void 0)){(sa=this.fn(sa).dga)&&sa.ntc();Ta.a.Pf&&document.activeElement.blur();var vd={keyCode:117,type:"keydown",ctrlKey:!0};vd.shiftKey=hb===OSF.AgaveHostAction.CtrlF6ExitShift;vd.srcElement=Object(Ga.a)(223,sa)?sa.rEa:pb.g(this.$).Nb;sa=new Sys.UI.DomEvent(vd);xc.qV(sa)}}else if(hb===OSF.AgaveHostAction.PageIsReady){if((sa=this.fn(sa).dga)&&sa.AWa===OSF.OsfControlTarget.TaskPane&&(sa=this.$.ea.Ea(183,void 0))&&this.Af)for(hb=Fd.a.Sd(this.$),xc=Ml(this.Af),vd=xc.next();!vd.done;vd=
xc.next())a.lKa(vd.value.rT)&&(hb?sa.Ye(!0,!1):sa.setFocusOnToolbarFirstElement())}else if(hb===OSF.AgaveHostAction.TabExit){hb=this.fn(sa);var Xd=hb.dga;if(Xd)if(Xd.AWa===OSF.OsfControlTarget.InContent)Xd.k$e();else{if(Xd.AWa===OSF.OsfControlTarget.TaskPane)if(Fd.a.Sd(this.$))Ta.a.Pf&&document.activeElement.blur(),td.UISurfaces.Sk().then(function(Ye){var Pe=Object(Ga.a)(223,Xd)?Xd:null;Pe?Pe.isResizable?Ye.focusResizeHandle():Ye.focusTabbedTaskPaneArea():Ye.focusTabbedTaskPaneArea();return null});
else if(sa=this.$.ea.Ea(183,void 0))Ta.a.Pf&&document.activeElement.blur(),(hb=document.getElementById(this.$.Mb+nc.a.jhc))&&Qc.DOMElementExtensions.isVisible(hb)?Qc.DOMElementExtensions.setFocus(hb):sa.setFocusOnToolbarFirstElement()}else hb&&4===hb.osfControlType&&this.wm.notifyAgave(sa,OSF.AgaveHostAction.TabIn)}else if(hb===OSF.AgaveHostAction.TabExitShift)(hb=this.fn(sa),xc=hb.dga)?xc.AWa===OSF.OsfControlTarget.InContent?xc.l$e():xc.AWa===OSF.OsfControlTarget.TaskPane&&(sa=Object(Ga.a)(223,xc)?
xc:null)&&(Ta.a.Pf&&document.activeElement.blur(),sa.jOf()):hb&&4===hb.osfControlType&&this.wm.notifyAgave(sa,OSF.AgaveHostAction.TabIn);else if(hb===OSF.AgaveHostAction.EscExit||hb===OSF.AgaveHostAction.ExitNoFocusable||hb===OSF.AgaveHostAction.ExitNoFocusableShift)if(xc=this.fn(sa).dga)xc.ntc();else{if(hb===OSF.AgaveHostAction.EscExit){hb=null;xc=Ml(ja.eLh());for(vd=xc.next();!vd.done;vd=xc.next())if(vd=vd.value,vd.value.We===sa){vd.value.dialog.hide();hb=vd.key;break}hb&&(sa=this.fn(hb))&&4!==
sa.osfControlType&&this.Ah.notifyAgave(hb,OSF.AgaveHostAction.TabIn)}}else if(hb===OSF.AgaveHostAction.InstallCustomFunctions)if(Ub.EwaSettings.ka(123)){Vc.a(this.$).PLe(function(){return!1});var Je=this;Ea.TaskExtensions.Da(Nc.GetServiceTaskFactory.Xa(this.$.ea,278,279,1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(Ye){Ye=Ye.result;Je.$.ea.Ea(278,void 0)||Je.$.ea.La(278,Ye);var Pe=cc.osfControl.getStoreType();Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?Ye.zfd(cc.osfControl.getSolutionId(),Pe,a.vPe(cc.osfControl),cc).Aca():Ye.zfd(cc.osfControl.getMarketplaceID(),Pe,a.vPe(cc.osfControl),cc).Aca()},this.ma,3)}else nb.ULS.sendTraceTag(36721667,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(hb===OSF.AgaveHostAction.UninstallCustomFunctions)if(Ub.EwaSettings.ka(123)){Vc.a(this.$).PLe(function(){return!1});var ff=this;Ea.TaskExtensions.Da(Nc.GetServiceTaskFactory.Xa(this.$.ea,278,279,
1,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(Ye){Ye=Ye.result;ff.$.ea.Ea(278,void 0)||ff.$.ea.La(278,Ye);Ye.T0f(cc.solutionId,cc.storeType).Aca()},this.ma,3)}else nb.ULS.sendTraceTag(39965697,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else hb===OSF.AgaveHostAction.SendTelemetryEvent?c(cc):hb===OSF.AgaveHostAction.SendCustomerContent?d(cc):hb===OSF.AgaveHostAction.LaunchExtensionComponent?
Gb.a.instance.e$h(cc):hb===OSF.AgaveHostAction.RefreshRibbonGallery?(sa=this.$.ea.Ea(352,void 0))&&sa.H9b(cc):hb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.sSi(cc.assetId),Fd.a.Sd(this.$)||(sa=this.$.ea.Ea(183,void 0))&&sa.$o()):hb===OSF.AgaveHostAction.GetOriginalControlId&&(sa=new E.a(this.$.Mb,cc.ownerAssetId,new Gc.a,!0),cc.originalControlId=sa?sa.B_c(cc.controlId):cc.controlId)};a.prototype.sf=function(sa,hb,cc){var xc={};xc[Da.a.Mj]=sa;xc[Da.a.L2]=hb;this.yJ(451041795,xc,void 0===cc?
!0:cc)};a.prototype.Bu=function(sa){var hb={};hb[Da.a.L2]=sa;this.yJ(1237877382,hb)};a.prototype.yJ=function(sa,hb,cc){var xc=this;cc=void 0===cc?!0:cc;var vd=new Ic.a(sa,0,this.$.jd,0,null),Xd=hb?hb[Da.a.L2]:null;this.yZa&&pb.g(this.$).isEditing&&P.oNg(sa,hb)?this.yZa.C0g(sa,hb):(sa=this.$.Na.Xb(vd,hb),cc&&Ea.TaskExtensions.Da(sa,function(Je){$b.a(Je)?xc.sf(wa.a.internalError,Xd,!1):Je.result||(pb.g(xc.$).isEditing?xc.sf(wa.a.U2a,Xd,!1):xc.sf(wa.a.internalError,Xd,!1))},this.ma,8))};a.prototype.HPg=
function(sa){var hb=this;return!!this.Mha(function(cc){return a.getSolutionId(cc.al,hb.$)===a.getSolutionId(sa,hb.$)&&cc.al.PrimaryMarketplace.MarketplaceType===sa.PrimaryMarketplace.MarketplaceType&&cc.al.PrimaryMarketplace.MarketplaceRef===sa.PrimaryMarketplace.MarketplaceRef&&cc.al.PrimaryMarketplace.SolutionVersion===sa.PrimaryMarketplace.SolutionVersion})};a.prototype.fn=function(sa){return this.Mha(function(hb){return hb.controlId.startsWith(sa)})};a.prototype.Emh=function(sa){return this.Mha(function(hb){return hb.qGa===
sa})};a.prototype.iKe=function(sa){return this.Mha(function(hb){return hb.rT===sa&&!$c.a.na(hb.qGa)})};a.prototype.AKe=function(sa,hb,cc,xc){return this.Mha(function(vd){return vd.rT===sa&&vd.al.PrimaryMarketplace.MarketplaceRef.toLowerCase()===hb.toLowerCase()&&vd.al.PrimaryMarketplace.MarketplaceType.toLowerCase()===cc.toLowerCase()&&!!vd.al.SharedRuntime&&!!vd.al.SharedRuntime.Resid&&!!xc&&!!xc.Resid&&vd.al.SharedRuntime.Resid.toLowerCase()===xc.Resid.toLowerCase()})};a.prototype.izg=function(sa,
hb){if(sa=this.fn(sa))sa.la(hb),sa.showHide(!0)};a.prototype.dgj=function(sa){(sa=this.fn(sa))&&sa.showHide(!1)};a.prototype.YYa=function(sa){if(1!==sa.WebExtensionType||this.$.Gd&8388608&&sa.TaskpaneVisible||this.$.Gd&8388608&&!sa.TaskpaneVisible&&Cb.HelperMethods.My(sa)){var hb=null;Cb.HelperMethods.My(sa)&&(hb=a.Cta(sa,this.$),sa.TaskpaneWidth||(sa.TaskpaneWidth=this.J1b));var cc=(new W(this,this.Ch,sa)).Med();nb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",
Telemetry.PrivacyRules.GetAssetId(sa.PrimaryMarketplace.MarketplaceType,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.SolutionId),sa.PrimaryMarketplace.MarketplaceType,Cb.HelperMethods.My(sa));hb&&(cc.qGa=hb);Array.add(this.Af,cc);this.Ova=null;this.a3a(sa.InstanceId)||(sa=String.format("{0}|{1}|{2}|{3}|{4}",sa.PrimaryMarketplace.SolutionId,sa.PrimaryMarketplace.SolutionVersion,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.MarketplaceType,sa.WebExtensionType),this.raiseEvent("ci",
sa))}};a.prototype.Ohj=function(sa,hb){function cc(){xc.iOa(Xd.controlId);xc.Ah.purgeOsfControl(Xd.controlId,!1);hb()}var xc=this;sa.TaskpaneWidth=this.J1b;sa.TaskpaneVisible=!0;var vd={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(vd.SolutionId=sa.PrimaryMarketplace.SolutionId,vd.TargetType=sa.WebExtensionType,vd.Version=sa.PrimaryMarketplace.SolutionVersion,vd.StoreType=sa.PrimaryMarketplace.MarketplaceType,vd.StoreId=sa.PrimaryMarketplace.MarketplaceRef,
vd.AssetId=sa.PrimaryMarketplace.SolutionId,vd.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,vd.Width=sa.TaskpaneWidth,vd.Id=sa.PrimaryMarketplace.SolutionId,vd.AppVersion=sa.PrimaryMarketplace.SolutionVersion,vd.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType):(vd.Id=sa.PrimaryMarketplace.SolutionId,vd.TargetType=sa.WebExtensionType,vd.AppVersion=sa.PrimaryMarketplace.SolutionVersion,vd.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType,vd.StoreId=sa.PrimaryMarketplace.MarketplaceRef,
vd.AssetId=sa.PrimaryMarketplace.SolutionId,vd.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,vd.Width=sa.TaskpaneWidth);var Xd=new W(this,this.Ch,sa,!0);Xd.Med();Array.add(this.Af,Xd);var Je=null;Je=Le.a.instance.UB(function(){Xd.Pt&&(vb.a.Ia(Je),Je=null,xc.Ah.insertBlankControlWithErrorUX(xc.U7a(Xd,vd),cc))},100,gd.a.v_g)};a.prototype.jTg=function(sa){var hb=this;if(sa&&sa.length){var cc=[];sa.forEach(function(xc){if(xc.ContainsCustomFunctions){var vd=a.Cta(xc,hb.$);hb.kwd.contains(vd)||(hb.kwd.add(vd),
Array.add(hb.lwf,xc));hb.HPg(xc)||Array.add(cc,xc)}});cc.length&&this.mue(cc)}};a.prototype.cwe=function(sa,hb){this.fn(sa.InstanceId)||(hb=hb(),sa=(new W(this,this.Ch,sa)).c1e(hb),Array.add(this.Af,sa),this.Ova=null)};a.prototype.yfj=function(sa){a.tZa.tb(sa)&&a.tZa.oa(sa).initializeAndShowWithTitle()};a.prototype.UQh=function(sa){a.tZa.tb(sa)&&a.tZa.oa(sa).hide()};a.prototype.eEh=function(sa){var hb=this,cc=null,xc,vd=null;var Xd=a.rbd(sa,!0);if(!Xd)return nb.ULS.sendTraceTag(50426760,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),
Ke.Task.Ua(null);(xc=this.wm.getOsfControl(a.getSolutionId(Xd,this.$)))&&(cc=xc.getManifest())&&(vd=cc.getSharedRuntimeForCustomFunctions("Workbook"));if(cc=vd&&1===vd.LifeTime?this.AKe(Xd.PrimaryMarketplace.SolutionId,Xd.PrimaryMarketplace.MarketplaceRef,Xd.PrimaryMarketplace.MarketplaceType,vd):this.Emh(sa))return Ke.Task.Ua(cc.controlId);var Je=new cb.a;Cb.HelperMethods.Kdc(vd)&&(Xd.SharedRuntime=vd);sa=xc?xc.getNotificationParams():[];if(!sa.length)return this.Pue(Xd);this.LSf(sa,function(){Ea.TaskExtensions.Da(Je.task,
function(){hb.Pue(Xd)},hb.ma,3)},function(){});return Je.task};a.prototype.Ysh=function(sa){sa=a.rbd(sa,!1);if(!sa)return nb.ULS.sendTraceTag(592196425,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var hb=null,cc=this.wm.getOsfControl(a.getSolutionId(sa,this.$));cc&&(cc=cc.getManifest())&&(hb=cc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Cb.HelperMethods.Kdc(hb)&&(sa=this.AKe(sa.PrimaryMarketplace.SolutionId,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.MarketplaceType,
hb))?sa.controlId:null};a.prototype.FRg=function(sa,hb){var cc=this,xc=a.rbd(sa,!1);if(xc){var vd=null,Xd=this.wm.getOsfControl(a.getSolutionId(xc,this.$));Xd&&(Xd=Xd.getManifest())&&(vd=Xd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Cb.HelperMethods.Kdc(vd)){xc.SharedRuntime=vd;var Je=xc.PrimaryMarketplace.SolutionId;Xd=xc.PrimaryMarketplace.SolutionVersion;var ff=OSF.OsfManifestManager.getCachedManifest(Je,Xd);if(ff)if(this.OVb.tb(sa))vd=this.OVb.oa(sa),Ea.TaskExtensions.Da(vd,function(wf){(wf=
wf.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wf,hb,Object(ca.a)(cc.Ch,cc.Ch.jGb,"sendActionToAddin"))},this.ma,3);else{var Ye={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Ye.solutionId=Je,Ye.version=Xd,Ye.storeType=xc.PrimaryMarketplace.MarketplaceType,Ye.storeId=xc.PrimaryMarketplace.MarketplaceRef,Ye.assetId=Je,Ye.assetStoreId=null):(Ye.appVersion=Xd,Ye.assetId=Je,Ye.storeType=xc.PrimaryMarketplace.MarketplaceType,
Ye.storeId=xc.PrimaryMarketplace.MarketplaceRef);Ye.targetType=OSF.OsfControlTarget.TaskPane;var Pe=new cb.a;xc=Ea.TaskExtensions.um();xc=new La.a(this.$,this,Ye,xc);vd=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Je,vd.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ff,vd,Xd);xc.createUILessSandbox(Ye,ff,function(wf,lf){wf&&!lf?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wf,hb,Object(ca.a)(cc.Ch,cc.Ch.jGb,"sendActionToAddin")),Pe.setResult(wf)):
Pe.setResult(null);cc.OVb.remove(sa)});this.OVb.ja(sa,Pe.task)}}}else nb.ULS.sendTraceTag(592196424,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.hpe=function(sa){(sa=this.iKe(sa))&&(sa.al.SharedRuntime||this.fEb(sa.controlId))};a.prototype.fEb=function(sa){(sa=this.iKe(sa))&&this.iOa(sa.controlId)};a.prototype.z4g=function(sa,hb){if(!this.Af||!sa||!hb)return!1;if(sa.toLowerCase()===hb.toLowerCase())return!0;for(var cc=null,xc=null,vd=0,Xd=this.Af.length;vd<
Xd;vd++){var Je=this.Af[vd];if(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(Je.ownerAddinSolutionId&&(Je.controlId===sa&&(cc=Je.ownerAddinSolutionId.toLowerCase()),Je.controlId===hb&&(xc=Je.ownerAddinSolutionId.toLowerCase()),cc&&xc))break}else if(Je.ownerAddinAssetId&&(Je.controlId===sa&&(cc=Je.ownerAddinAssetId.toLowerCase()),Je.controlId===hb&&(xc=Je.ownerAddinAssetId.toLowerCase()),cc&&xc))break}return cc&&cc===xc?!0:!1};a.prototype.vpg=
function(sa){this.fn(sa.InstanceId)||(sa=new W(this,this.Ch,sa),Array.add(this.Af,sa),this.Ova=null)};a.prototype.zBd=function(sa){if(this.Af&&0<=sa&&sa<this.Af.length){var hb=this.Af[sa],cc=hb.Pt;Array.removeAt(this.Af,sa);this.Ilf(hb);Qc.DOMElementExtensions.rg(cc)}};a.prototype.iOa=function(sa){if(this.Af)for(var hb=0,cc=this.Af.length;hb<cc;hb++)if(this.Af[hb].controlId===sa){this.zBd(hb);break}};a.prototype.sSi=function(sa){if(this.Af){"WA200002680"===sa&&this.$.ea.Ea(271,void 0).Yvg();sa=sa.toLowerCase();
for(var hb=0,cc=this.Af.length;hb<cc;hb++)if(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(sa===this.Af[hb].ownerAddinSolutionId.toLowerCase()){this.zBd(hb);break}}else if(sa===this.Af[hb].ownerAddinAssetId.toLowerCase()){this.zBd(hb);break}}};a.prototype.Rzg=function(sa){sa.qA&&(this.fn(sa.floatingObject.al.InstanceId)||(this.Uac(sa.floatingObject.al.InstanceId)||Array.add(this.Ljc,sa.floatingObject.al.InstanceId),this.YYa(sa.floatingObject.al)),
this.fa.isNamedObjectViewMode&&this.izg(sa.floatingObject.al.InstanceId,sa.$d))};a.prototype.r3=function(sa){if(this.Af)for(var hb=0,cc=this.Af.length;hb<cc;hb++)if(1===this.Af[hb].controlType&&$c.a.equals(this.Af[hb].rT,sa,!0))return this.Af[hb].controlId;return null};a.prototype.emh=function(sa){var hb=[];if(this.Af)for(var cc=0,xc=this.Af.length;cc<xc;cc++)$c.a.equals(this.Af[cc].rT,sa,!0)&&hb.push(this.Af[cc].controlId);return hb};a.prototype.BKe=function(sa,hb){if(!hb||$c.a.na(sa))return null;
if(this.Af)for(var cc=0,xc=this.Af.length;cc<xc;cc++)if(1===this.Af[cc].controlType&&$c.a.equals(this.Af[cc].rT,sa,!0)&&this.Af[cc].al.SharedRuntime&&$c.a.equals(this.Af[cc].al.SharedRuntime.Resid,hb.Resid,!0))return this.Af[cc].controlId;return null};a.prototype.$ha=function(sa,hb){hb=void 0===hb?null:hb;return sa?hb?String.format("{0}.{1}",sa,hb):sa:""};a.prototype.iVc=function(sa,hb,cc){if(this.Ova===sa)return!0;this.Ova=sa;var xc=null,vd=!1;if($c.a.na(xc)&&this.Af)for(var Xd=0,Je=this.Af.length;Xd<
Je;Xd++)if(1===this.Af[Xd].controlType&&$c.a.equals(this.Af[Xd].rT,sa,!0)){var ff=!1,Ye=!1;hb?(ff=!0,Ye=!!this.Af[Xd].al.SharedRuntime&&$c.a.equals(this.Af[Xd].al.SharedRuntime.Resid,hb.Resid,!0)):cc&&(ff=!0,Ye=$c.a.equals(this.Af[Xd].al.SharedRuntimeId,cc,!0));if(!ff||Ye){Ye&&this.Af[Xd].Rf(!0);xc=this.Af[Xd].controlId;vd=!0;this.Ova=null;break}}$c.a.na(xc)||this.raiseEvent("ca",xc);return vd};a.prototype.setAppRuntimeState=function(sa,hb){if($c.a.na(sa))throw nb.ULS.sendTraceTag(51176384,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ae.a.instance.da(2139));var cc=this.fn(sa);if(cc&&Cb.HelperMethods.My(cc.al))cc.Rf(hb),hb&&(this.raiseEvent("ca",sa),cc.Pt&&cc.Pt.firstChild&&(sa=cc.Pt.firstChild.title)&&0<sa.length&&this.VWb.u4i(sa));else throw nb.ULS.sendTraceTag(51176355,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ae.a.instance.da(2138));};a.prototype.getAppRuntimeState=function(sa){if($c.a.na(sa))throw nb.ULS.sendTraceTag(51176386,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ae.a.instance.da(2139));if((sa=this.fn(sa))&&Cb.HelperMethods.My(sa.al))sa=sa.al.TaskpaneVisible;else throw nb.ULS.sendTraceTag(51176385,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ae.a.instance.da(2138));return sa};a.prototype.W_a=function(sa,hb){return(sa=this.fn(sa))?sa.W_a(hb):null};a.prototype.a3a=function(sa){return this.mpe(this.Ljc,sa)};a.prototype.Uac=function(sa){return this.mpe(this.Nwe,sa)};a.prototype.gde=function(sa){Array.add(this.Nwe,
sa)};a.prototype.fU=function(sa){return(sa=this.fn(sa))?sa.al:null};a.prototype.vrd=function(sa){this.raiseEvent("ekros",sa,this)};a.prototype.Vtf=function(sa){if(sa){var hb=this.fn(sa.InstanceId);hb&&(sa.SharedRuntime||sa.SharedRuntimeId||(this.iOa(hb.controlId),this.Ah.purgeOsfControl(hb.controlId,!1)),hb={},Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hb.SolutionId=sa.PrimaryMarketplace.SolutionId,hb.TargetType=sa.WebExtensionType,hb.Version=
sa.PrimaryMarketplace.SolutionVersion,hb.StoreType=sa.PrimaryMarketplace.MarketplaceType,hb.StoreId=sa.PrimaryMarketplace.MarketplaceRef,hb.AssetId=sa.PrimaryMarketplace.SolutionId,hb.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,hb.Width=sa.TaskpaneWidth,hb.SharedRuntimeId=sa.SharedRuntimeId,hb.Id=sa.PrimaryMarketplace.SolutionId,hb.AppVersion=sa.PrimaryMarketplace.SolutionVersion,hb.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType):(hb.Id=sa.PrimaryMarketplace.SolutionId,hb.TargetType=
sa.WebExtensionType,hb.AppVersion=sa.PrimaryMarketplace.SolutionVersion,hb.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType,hb.StoreId=sa.PrimaryMarketplace.MarketplaceRef,hb.AssetId=sa.PrimaryMarketplace.SolutionId,hb.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,hb.Width=sa.TaskpaneWidth,hb.SharedRuntimeId=sa.SharedRuntimeId),this.s_f(hb))}};a.prototype.tha=function(){this.Ch.tha()};a.prototype.$L=function(sa,hb,cc){this.Ch.$L(sa,hb,cc)};a.prototype.D4i=function(sa,hb){var cc=Array(2);
cc[0]=hb;cc[1]=null;this.Ch.Zmh(sa,JSON.stringify(cc))};a.prototype.LKe=function(sa,hb){hb=a.VWg(hb);sa=this.fU(sa);this.Ch.A5b(sa.InstanceId,2202,Nd.a.eW,hb)};a.prototype.Z5c=function(sa){for(var hb=0,cc=this.Af.length;hb<cc;hb++)this.LKe(this.Af[hb].controlId,sa)};a.prototype.Vmh=function(sa,hb){hb=a.lSg(hb);this.Ch.A5b(sa,65539,"",hb)};a.prototype.Xmh=function(sa,hb,cc){this.Ch.A5b(sa,1,hb,cc)};a.prototype.Umh=function(sa,hb){this.Ch.Ymh(sa,hb)};a.prototype.CRg=function(sa,hb){return[[2,1E3,"",
JSON.stringify([sa,hb]),0,!1]]};a.prototype.$Zh=function(){return!!this.Ila&&this.Ila.zYe()};a.prototype.VKg=function(){this.Ila&&this.Ila.clear()};a.prototype.Wmh=function(){if(this.Ila&&this.Ila.zYe()){var sa=this.Ila.Zsh();sa=Ml(sa);for(var hb=sa.next();!hb.done;hb=sa.next()){hb=this.emh(hb.value);hb=Ml(hb);for(var cc=hb.next();!cc.done;cc=hb.next())this.Ch.A5b(cc.value,65540,"","{}")}}};a.prototype.BPi=function(sa){this.Ila.add(sa)};a.prototype.ruj=function(sa){this.Ila.remove(sa)};a.prototype.Mha=
function(sa){if(!this.Af)return null;for(var hb=Ml(this.Af),cc=hb.next();!cc.done;cc=hb.next())if(cc=cc.value,sa(cc))return cc;return null};a.prototype.Pue=function(sa){var hb=this,cc=new cb.a,xc=a.Cta(sa,this.$);if(Cb.HelperMethods.My(sa))nb.ULS.sendTraceTag(571774670,0,50,"Shared runtime custom function agave is started."),this.iwf(sa,function(Xd){Xd?(sa.InstanceId=Xd.InstanceId,sa.WebExtensionOsfControlType=3,sa.TaskpaneVisible=!1,hb.YYa(sa),cc.setResult(sa.InstanceId)):(nb.ULS.sendTraceTag(542185168,
0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(sa.PrimaryMarketplace.MarketplaceType,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.SolutionId)),cc.setException(Error.create("Null insert data")))});else{a.tZa.ja(sa.InstanceId,new fb.a);var vd=a.tZa.oa(sa.InstanceId).EGa;this.iTg(sa,vd,xc);this.iwf(sa,null);cc.setResult(sa.InstanceId)}return cc.task};a.prototype.iTg=function(sa,hb,cc){this.fn(sa.InstanceId)||(sa=new W(this,this.Ch,sa),sa.qGa=
cc,sa.c1e(hb),Array.add(this.Af,sa),this.Ova=null)};a.prototype.iwf=function(sa,hb){var cc=a.Cta(sa,this.$);if(!this.kwd.contains(cc))this.sCb.push(sa),1<=this.sCb.length&&this.jwf(sa,hb);else if(hb){sa=Ml(this.lwf);for(var xc=sa.next();!xc.done;xc=sa.next())if(xc=xc.value,a.Cta(xc,this.$)===cc){hb(xc,0);break}}};a.prototype.jwf=function(sa,hb){function cc(wf){if(!wf||ce.a(wf))Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?nb.ULS.sendTraceTag(39965700,
0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(Je.StoreType,Je.StoreId,Je.SolutionId),Ge.a.fd(wf.Errors)):nb.ULS.sendTraceTag(539305358,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(Je.CurrentStoreType,Je.StoreId,Je.Id),Ge.a.fd(wf.Errors));vd.sCb.shift();0<vd.sCb.length&&vd.jwf(vd.sCb[0],hb)}function xc(wf){wf=Bf.a.Eg(wf.data);nb.ULS.sendTraceTag(38372576,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",
Ge.a.fd(wf))}var vd=this,Xd=null,Je={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(Je.SolutionId=a.getSolutionId(sa,this.$),Je.TargetType=sa.WebExtensionType,Je.Version=sa.PrimaryMarketplace.SolutionVersion,Je.StoreType=sa.PrimaryMarketplace.MarketplaceType,Je.StoreId=sa.PrimaryMarketplace.MarketplaceRef,Je.AssetId=sa.PrimaryMarketplace.SolutionId,Je.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,Je.Width=sa.TaskpaneWidth,Je.ContainsCustomFunctions=
!0,Je.Id=a.getSolutionId(sa,this.$),Je.AppVersion=sa.PrimaryMarketplace.SolutionVersion,Je.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType):(Je.Id=a.getSolutionId(sa,this.$),Je.TargetType=sa.WebExtensionType,Je.AppVersion=sa.PrimaryMarketplace.SolutionVersion,Je.CurrentStoreType=sa.PrimaryMarketplace.MarketplaceType,Je.StoreId=sa.PrimaryMarketplace.MarketplaceRef,Je.AssetId=sa.PrimaryMarketplace.SolutionId,Je.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,Je.Width=sa.TaskpaneWidth,Je.ContainsCustomFunctions=
!0);Cb.HelperMethods.My(sa)&&(Je.SharedRuntimeId=sa.SharedRuntime.Resid);var ff=this.$.ra.xa;sa=this.$.ra.xa.dc();var Ye=ff.Ra(9,sa);Ye.sharedInfo=Je;if(hb){var Pe=function(wf){var lf=wf.Result;(Xd=lf?lf.AgaveData:null)||hb(null,wf.Errors?wf.Errors[0].ErrorCause:5001);hb(Xd,0)};sa=function(wf,lf,kg){return ne.i(ff,"InsertAgaveTaskpane",Ye,Ob.b(wf,cc,Pe),Ob.a(lf,xc),kg,null,0)}}else sa=function(wf,lf,kg){return ne.i(ff,"InsertAgaveTaskpane",Ye,Ob.b(wf,cc),Ob.a(lf,xc),kg,null,0)};Ub.EwaSettings.wc()?
mg.a(this.$.userOperationManager,sa,function(wf){return new Ce.a(519,0,wf,64)},null):mg.a(this.$.userOperationManager,sa,function(wf){return new Yf.a(519,0,wf)},null)};a.prototype.Icj=function(){return this.$.lg.get(35)};a.prototype.DBd=function(sa){(sa=this.fn(sa))&&sa.xca&&sa.DEf()};a.prototype.tli=function(sa){var hb=this.Mha(function(cc){return a.lKa(cc.rT)});hb&&(hb=this.Ah.getOsfControl(hb.controlId))&&hb.notifyAgave(OSF.AgaveHostAction.SendMessage,sa)};a.prototype.F_h=function(){return!!this.Mha(function(sa){return 1===
sa.controlType&&a.lKa(sa.rT)})};a.prototype.E_h=function(){var sa=this.Mha(function(hb){return a.lKa(hb.rT)});return sa?sa.Pt?Qc.DOMElementExtensions.isVisible(sa.Pt):!1:!1};a.prototype.r7i=function(){var sa=this.Mha(function(hb){return a.lKa(hb.rT)});sa&&(sa.Rf(!0),this.raiseEvent("ca",sa.controlId))};a.prototype.initialize=function(){var sa=b(1324).DdaEventDispatch,hb=void 0===this.$||null===this.$||Ub.EwaSettings.ka(264);void 0!==this.$&&null!==this.$||nb.ULS.sendTraceTag(39965576,0,50,"VSO#2693929: Initialize is called. EwaControl is null");
hb&&nb.ULS.sendTraceTag(39965577,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(m.HEa(this.$),this.fa=this.$.fa,this.Ch=new sa(this.$),this.$.Nk(Object(ca.a)(this,this.sd,"onWorkbookOpened")),this.fa.ak(Object(ca.a)(this,this.ed,"onSessionIdChanged")),this.fa.DO(Object(ca.a)(this,this.rq,"onLoadOnDemandOccurred")),this.fa.ot(Object(ca.a)(this,this.hg,"onWorkbookMetadataChanged")),this.$.userOperationManager.CB(Object(ca.a)(this,this.NQ,"onQueueItemChanged")),
this.ibf(),this.wvi(),this.iVh(),this.$.ea.La(35,this),this.rQc.la(this),hb&&nb.ULS.sendTraceTag(39965578,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Y7d=new Nd.a,hb&&nb.ULS.sendTraceTag(39965579,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.a8d=new x(this.$,this.dj,this.Ch),this.Eig=new A(this.$,this.dj,this.Ch),this.Z7d=new B(this.$,this.dj,this.Ch),this.X7d=new J(this.$,this.dj,this.Ch),this.W7d=new C(this.$,this.dj,this.Ch),this.$7d=new z(this.$,this.dj,
this.Ch),this.b8d=new v(this.$,this.dj,this.Ch),this.c8d=new w(this.$,this.dj,this.Ch),this.$.Aaa&&(this.d8d=new u(this.$,this.dj,this.Ch)),Ub.EwaSettings.ka(193)&&(this.yZa=new P(this,pb.g(this.$))),Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.V7d=new H),this.initialized=!0,nb.ULS.sendTraceTag(39613474,0,50,"DdaFacade is initialized"))};a.prototype.Qmh=function(sa){if(!this.wAa)return null;for(var hb=0,cc=this.wAa.length;hb<cc;hb++)if(sa.startsWith(this.wAa[hb].WebExtensionId))return this.wAa[hb];
return null};a.prototype.ibf=function(){var sa=this.fa;if(sa.pc&&!this.vLb){if(sa.workbookContext){if(this.hNc=this.$.fa.gh.get(22),sa.workbookContext.WebExtensions&&sa.workbookContext.WebExtensions.length){sa=sa.workbookContext.WebExtensions;for(var hb=!1,cc={},xc=sa.length-1;0<=xc;cc={PLb:cc.PLb},xc--){if(!this.fa.isNamedObjectViewMode){Array.add(this.Ljc,sa[xc].InstanceId);if(1!==sa[xc].WebExtensionType){Array.removeAt(sa,xc);continue}if(Cb.HelperMethods.My(sa[xc])&&sa[xc].SharedRuntime.State)1===
sa[xc].SharedRuntime.State?sa[xc].TaskpaneVisible=!1:2===sa[xc].SharedRuntime.State?sa[xc].TaskpaneVisible=!0:nb.ULS.sendTraceTag(51176387,0,10,"The sharedRuntime state is invalid");else if(!sa[xc].ContainsCustomFunctions&&!sa[xc].TaskpaneVisible&&!Xa.a(sa[xc])){Array.removeAt(sa,xc);continue}}var vd=OSF.OsfControl.isFirstPartyStoreString(sa[xc].PrimaryMarketplace.MarketplaceType);Ub.EwaSettings.ka(189)&&!vd&&(Array.removeAt(sa,xc),hb||(hb=!0,cc.PLb=Nc.GetServiceTaskFactory.Xa(this.$.ea,5,4,3,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager"),
Ea.TaskExtensions.Da(cc.PLb,function(Xd){return function(){Xd.PLb.result.tg(35,null)}}(cc),this.ma,3)));Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&sa[xc].PrimaryMarketplace&&a.lKa(sa[xc].PrimaryMarketplace.SolutionId)&&(nb.ULS.sendTraceTag(593248416,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(sa,xc))}this.mue(sa)}}else this.hNc=!1;this.vLb=!0}};a.prototype.dXe=function(sa){var hb=pb.g(this.$),cc=hb.ga.Sa.nc;
if(cc&&sa){sa=!1;if(this.Af)for(var xc=Ml(this.Af),vd=xc.next();!vd.done;vd=xc.next())if(vd=vd.value,a.lKa(vd.rT)||a.v2h(vd.rT)){sa=!0;break}sa||hb.ga.Sa.jG(cc)}};a.prototype.wvi=function(){this.Ah&&this.fa.isNamedObjectViewMode&&this.$.sa&&Yd.p(this.$.sa)&&(X(this.$).eQ?X(this.$).bfd():X(this.$).Eq(Object(ca.a)(this,this.sBi,"onWebExtensionContentReady")))};a.prototype.sBi=function(){this.$.sa&&Yd.p(this.$.sa)&&X(this.$).bfd()};a.prototype.mue=function(sa){var hb=this,cc=null;cc=function(Xd){function Je(){hb.jNa.shift();
0<hb.jNa.length&&cc(hb.jNa[0])}var ff=Xd.WebExtensionData,Ye=Xd.IsTaskPane,Pe=Xd.RecordHandler;if(hb.r3(ff.PrimaryMarketplace.SolutionId))Je();else{Ye&&(ff.WebExtensionOsfControlType=1);var wf=Xa.a(ff);if(!Ye||ff.TaskpaneVisible||wf||ff.SharedRuntime&&ff.SharedRuntime.State||ff.ContainsCustomFunctions){var lf=new W(hb,hb.Ch,ff,!Ye);nb.ULS.sendTraceTag(542185165,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(ff.PrimaryMarketplace.MarketplaceType,
ff.PrimaryMarketplace.MarketplaceRef,ff.PrimaryMarketplace.SolutionId),ff.PrimaryMarketplace.MarketplaceType,Cb.HelperMethods.My(ff));lf.Med();Cb.HelperMethods.My(ff)&&(lf.qGa=a.Cta(ff,hb.$),ff.TaskpaneWidth=hb.J1b);wf&&(ff.WebExtensionToolTip="");Ye&&ff.TaskpaneVisible&&!wf&&(ff.TaskpaneWidth=hb.J1b);Array.add(hb.Af,lf);var kg=hb.Ova=null;kg=Le.a.instance.UB(function(){lf.Pt&&(vb.a.Ia(kg),kg=null,Pe&&Pe(Xd,lf),Je())},100,gd.a.u_g)}else Je()}};for(var xc={},vd=0;vd<sa.length;xc={w0:xc.w0},vd++)if(!this.fn(sa[vd].InstanceId))if(1!==
sa[vd].WebExtensionType)this.YYa(sa[vd]);else if(!Ub.EwaSettings.ka(54))this.Gjb(sa[vd],cc);else if(this.$.Gd&8388608||sa[vd].TaskpaneVisible)xc.w0={},xc.w0.marketplaceId=sa[vd].PrimaryMarketplace.SolutionId,xc.w0.marketplaceVersion=sa[vd].PrimaryMarketplace.SolutionVersion,xc.w0.storeType=sa[vd].PrimaryMarketplace.MarketplaceType,xc.w0.storeId=sa[vd].PrimaryMarketplace.MarketplaceRef,xc.w0.targetData=sa[vd],this.Ah.isAddinCommandsAsync(xc.w0,function(Xd){return function(Je,ff,Ye){if(Je){var Pe=Ye.targetData;
if(ff){if(Ub.EwaSettings.ka(88))if(Xd.w0.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Je=Xd.w0.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),ff=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&Xd.w0.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),!Je&&!ff||!Cb.HelperMethods.My(Pe)||Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppLoadIssueInViewMode")&&!hb.$.isEditMode||
hb.Gjb(Pe,cc);else if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))hb.bOh(Ye,cc);else{var wf=!1;hb.Gyd(function(lf){if(!lf.errorCode){if(lf.value){lf=Ml(lf.value);for(var kg=lf.next();!kg.done&&!wf;kg=lf.next())wf=ld.c(kg.value[1])===ld.c(Pe.PrimaryMarketplace.SolutionId)}wf?Cb.HelperMethods.My(Pe)&&hb.Gjb(Pe,cc):(lf={},Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(lf.SolutionId=Ye.marketplaceId,
lf.TargetType=Pe.WebExtensionType,lf.Version=Ye.marketplaceVersion,lf.StoreType=Pe.PrimaryMarketplace.MarketplaceType,lf.StoreId=Ye.storeId,lf.AssetId=Ye.marketplaceId,lf.AssetStoreId=Ye.storeId,lf.Width=Pe.TaskpaneWidth,Pe.TaskpaneVisible=!0,lf.Id=Ye.marketplaceId,lf.AppVersion=Ye.marketplaceVersion,lf.CurrentStoreType=Pe.PrimaryMarketplace.MarketplaceType):(lf.Id=Ye.marketplaceId,lf.TargetType=Pe.WebExtensionType,lf.AppVersion=Ye.marketplaceVersion,lf.CurrentStoreType=Pe.PrimaryMarketplace.MarketplaceType,
lf.StoreId=Ye.storeId,lf.AssetId=Ye.marketplaceId,lf.AssetStoreId=Ye.storeId,lf.Width=Pe.TaskpaneWidth,Pe.TaskpaneVisible=!0),hb.Qbe(lf,Pe,cc))}},!0)}}else hb.Gjb(Pe,cc)}else Je=Ye.targetData,nb.ULS.sendTraceTag(542185164,220,10,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(Je.PrimaryMarketplace.MarketplaceType,Je.PrimaryMarketplace.MarketplaceRef,Je.PrimaryMarketplace.SolutionId),Je.PrimaryMarketplace.MarketplaceType)}}(xc))};a.prototype.bOh=
function(sa,hb){var cc=this,xc=!1;this.Gyd(function(vd){var Xd=sa.targetData;if(!vd.errorCode){if(vd.value){vd=Ml(vd.value);for(var Je=vd.next();!Je.done&&!xc;Je=vd.next())xc=ld.c(Je.value[1])===ld.c(Xd.PrimaryMarketplace.SolutionId)}xc?!Cb.HelperMethods.My(Xd)||Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppLoadIssueInViewMode")&&!cc.$.isEditMode||cc.Gjb(Xd,hb):(vd={},Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(vd.SolutionId=
sa.marketplaceId,vd.TargetType=Xd.WebExtensionType,vd.Version=sa.marketplaceVersion,vd.StoreType=Xd.PrimaryMarketplace.MarketplaceType,vd.StoreId=sa.storeId,vd.AssetId=sa.marketplaceId,vd.AssetStoreId=sa.storeId,vd.Width=Xd.TaskpaneWidth,vd.Id=sa.marketplaceId,vd.AppVersion=sa.marketplaceVersion,vd.CurrentStoreType=Xd.PrimaryMarketplace.MarketplaceType):(vd.Id=sa.marketplaceId,vd.TargetType=Xd.WebExtensionType,vd.AppVersion=sa.marketplaceVersion,vd.CurrentStoreType=Xd.PrimaryMarketplace.MarketplaceType,
vd.StoreId=sa.storeId,vd.AssetId=sa.marketplaceId,vd.AssetStoreId=sa.storeId,vd.Width=Xd.TaskpaneWidth),Xd.TaskpaneVisible=!0,cc.Qbe(vd,Xd,hb))}},!0)};a.prototype.Gjb=function(sa,hb){var cc={};cc.WebExtensionData=sa;cc.IsTaskPane=!0;this.jNa.push(cc);1===this.jNa.length&&hb(cc)};a.prototype.Qbe=function(sa,hb,cc){var xc=this,vd={};vd.ActivationInfo=sa;vd.WebExtensionData=hb;vd.IsTaskPane=!1;vd.RecordHandler=function(Xd,Je){var ff=Xd.ActivationInfo;xc.Ah.insertBlankControlWithErrorUX(xc.U7a(Je,ff),
function(){xc.iOa(Je.controlId);xc.Ah.purgeOsfControl(Je.controlId,!1);xc.s_f(ff)})};this.jNa.push(vd);1===this.jNa.length&&cc(vd)};a.prototype.s_f=function(sa){var hb={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hb.solutionId=sa.SolutionId,hb.version=sa.Version,hb.storeType=sa.StoreType,hb.storeId=sa.StoreId,hb.assetId=sa.AssetId,hb.assetStoreId=sa.AssetStoreId,hb.targetType=sa.TargetType,hb.sharedRuntimeId=sa.SharedRuntimeId,hb.id=sa.Id,
hb.currentStoreType=sa.CurrentStoreType,hb.appVersion=sa.AppVersion):(hb.id=sa.Id,hb.targetType=sa.TargetType,hb.currentStoreType=sa.CurrentStoreType,hb.assetId=sa.AssetId,hb.appVersion=sa.AppVersion,hb.storeId=sa.StoreId,hb.assetStoreId=sa.AssetStoreId,hb.sharedRuntimeId=sa.SharedRuntimeId);sa=new Tb.a;sa.add(hb);hb={};hb[kc.a.rWa]=sa;hb[kc.a.EO]=3;sa=new Ic.a(De.a.Qxb,0,this.$.jd,0,null);this.$.Na.Xb(sa,hb)};a.prototype.U7a=function(sa,hb){var cc={};ta.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",
!1)?(cc.div=sa.Pt,cc.id=sa.controlId,cc.solutionId=hb.SolutionId,cc.version=hb.Version,cc.storeId=hb.StoreId,cc.storeType=hb.StoreType,cc.osfControlType=OSF.OsfControlTarget.TaskPane,cc.marketplaceID=hb.Id,cc.marketplaceVersion=hb.AppVersion,cc.store=hb.StoreId):(cc.div=sa.Pt,cc.id=sa.controlId,cc.marketplaceID=hb.Id,cc.marketplaceVersion=hb.AppVersion,cc.store=hb.StoreId,cc.storeType=hb.CurrentStoreType,cc.osfControlType=OSF.OsfControlTarget.TaskPane);return cc};a.prototype.sd=function(){this.ibf()};
a.prototype.NQ=function(sa,hb){1===hb.QC&&(sa=hb.Sh)&&(sa=new r(Fc.toTimestamp(sa.enqueueUtcTime),Fc.toTimestamp(sa.processUtcTime),Fc.toTimestamp(sa.dequeueUtcTime),Fc.getElapsedMilliseconds(sa.enqueueUtcTime,sa.processUtcTime),Fc.getElapsedMilliseconds(sa.processUtcTime,sa.dequeueUtcTime),sa.operationCount,sa.operation&&sa.operation.od&&sa.operation.od.ServerCorrelationId?sa.operation.od.ServerCorrelationId:null,sa.operation?Enum.toString(zf.a,sa.operation.operationName):null,ac.a.GJ(Fc.getElapsedMilliseconds(sa.enqueueUtcTime,
ud.a.Ta.Lb))),sa=Sys.Serialization.JavaScriptSerializer.serialize(sa),nb.ULS.sendTraceTag(50872916,0,50,sa))};a.prototype.ed=function(sa,hb){!this.fa.pc&&Rd.a(hb)?(Array.forEach(this.Af,Object(ca.a)(this,this.Ilf,"onDeleteOsfControl")),Array.clear(this.Af),this.vLb=!1):(hb.TG&&(nb.ULS.sendTraceTag(578888858,0,50,"Silent Reload require reset osf controls."),this.mIf()),this.sK(),Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.vLb=!1))};a.prototype.rq=
function(){Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(nb.ULS.sendTraceTag(578888857,0,50,"Load on demand occurred require reset osf controls."),this.mIf());this.sK();Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.vLb=!1)};a.prototype.mIf=function(){var sa=this;if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var hb=[],cc=0;cc<this.Af.length;cc++){var xc=
this.Af[cc];xc.osfControlType&&3!==xc.osfControlType&&4!==xc.osfControlType||Array.add(hb,xc)}cc=!1;for(xc=0;xc<hb.length;xc++){var vd=hb[xc];this.iOa(vd.controlId);!cc&&vd&&vd.al&&(cc=Cb.HelperMethods.My(vd.al))}cc&&(hb={},hb=(hb.DynamicAddinCommandsMethodDispatchId=4,hb),this.yJ(-1014260128,hb))}Ub.EwaSettings.ka(419)&&Ea.TaskExtensions.Da(Nc.GetServiceTaskFactory.Xa(this.$.ea,278,279,3,"Microsoft.Office.Excel.WebUI.Client.CustomFunctions.ICustomFunctionsInstaller"),function(Xd){Xd&&(Xd=Xd.result)&&
(sa.$.ea.Ea(278,void 0)||sa.$.ea.La(278,Xd),Xd.a2e().Aca())},this.ma,3)};a.prototype.sK=function(){var sa=this,hb=new t(this.$,this.dj,this.iJf);void 0===this.$||null===this.$?nb.ULS.sendTraceTag(39965580,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Ub.EwaSettings.ka(264)&&nb.ULS.sendTraceTag(39965581,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.dj||null===this.dj));if(hb.cki()){var cc=function(){},xc=
function(Je){Je=Bf.a.Eg(Je.data);nb.ULS.sendTraceTag(38372578,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",Ge.a.fd(Je))},vd=hb.xEg();hb=function(Je,ff,Ye){return ne.i(sa.$.ra.xa,"ExecuteRichApiRequest",sa.zEg(vd),Ob.b(Je,cc),Ob.a(ff,xc),Ye,null,0)};var Xd=a.A$c(vd);Ub.EwaSettings.wc()?this.$.userOperationManager.yt(new Ce.a(507,0,hb,Xd|64)):this.$.userOperationManager.yt(new Yf.a(507,0,hb,Xd))}};a.prototype.zEg=function(sa){var hb=this.$.ra.xa.Ra(1);
hb.request=sa;return hb};a.prototype.Ilf=function(sa){sa.Xhc();this.raiseEvent("cd",sa.controlId)};a.prototype.mpe=function(sa,hb){if(sa)for(var cc=0;cc<sa.length;cc++)if($c.a.equals(sa[cc],hb,!0))return!0;return!1};a.prototype.CDg=function(sa){var hb={};hb.navigationMode=OSF.OsfNavigationMode.DefaultMode;hb.assetId=null;hb.category=null;if(!sa||3>sa.length)return hb;if(!$c.a.na(sa[0])){var cc=parseInt(sa[0]);isNaN(parseInt(cc))||(hb.navigationMode=cc)}$c.a.na(sa[1])||(hb.assetId=sa[1]);$c.a.na(sa[2])||
(hb.category=sa[2]);return hb};a.prototype.iVh=function(){if(Ub.EwaSettings.ka(62)){var sa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(!$c.a.na(sa)&&"*"!==sa.trim()){this.gHa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new N(this),sa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.lg.get(2));try{this.gHa.init()}catch(hb){try{this.gHa.dispose()}catch(cc){}this.gHa=null;nb.ULS.sendTraceTag(41181569,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+
hb.message)}sa={};sa.a=this.$.Ba.UserSessionId;fc.b().Se(39,sa)}}};a.prototype.LSf=function(sa,hb,cc){var xc=this,vd=a.SCg(sa[0]),Xd=vd.vga,Je=vd.nha;vd.vga=function(){Xd&&Xd();var ff=vd.RJa!==OSF.InfoType.Error?hb:null;sa.shift();sa.length?xc.LSf(sa,ff,cc):ff&&ff()};vd.nha=function(){Je&&Je();cc&&vd.RJa!==OSF.InfoType.Error&&cc()};Za.a.YJd(vd)};a.prototype.XAh=function(){var sa={};sa.AddinRibbonControlsOverriddenByApi=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
sa.AddinActionDefinitionHybridMode=Ub.EwaSettings.ka(685).toString();sa.UseActionIdForUILessCommand=Ub.EwaSettings.ka(691).toString();sa.AllowStorageAccessByUserActivationOnIFrame=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();sa.RequirementSetRibbonApiOnePointTwo=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();sa.flightingTreatmentVariables=ta.AFrameworkApplication.ha.J5b;
sa.ShortcutInfoArrayInUserPreferenceData=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return sa};a.getSolutionId=function(sa){var hb=sa.PrimaryMarketplace.SolutionId;Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Ub.EwaSettings.ka(302)&&sa.OwnerAddinSolutionId&&(hb=sa.OwnerAddinSolutionId):Ub.EwaSettings.ka(302)&&sa.OwnerAddinAssetId&&(hb=sa.OwnerAddinAssetId);return hb};a.A$c=function(sa){var hb=
0;Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?sa.RequestFlags&1&&256!==(sa.RequestFlags&256)||(hb=16):hb=sa.RequestFlags&1?0:16;return hb};a.Cta=function(sa,hb){hb=a.getSolutionId(sa,hb);return a.Q8c(hb,sa.PrimaryMarketplace.SolutionVersion,sa.PrimaryMarketplace.MarketplaceType,sa.PrimaryMarketplace.MarketplaceRef)};a.VWg=function(sa){var hb={};sa=(hb.recording=sa,hb);return JSON.stringify(sa)};a.lSg=function(sa){var hb={};hb.visibility=sa?"Visible":"Hidden";
return JSON.stringify(hb)};a.vPe=function(sa){if(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){var hb=sa.getSolutionId(),cc=sa.getVersion(),xc=sa.getStoreType();sa=sa.getStoreId();return a.Q8c(hb,cc,xc,sa)}hb=sa.getMarketplaceID();cc=sa.getMarketplaceVersion();xc=sa.getStoreType();sa=sa.getStoreLocator();return a.Q8c(hb,cc,xc,sa)};a.Q8c=function(sa,hb,cc,xc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",sa,hb,a.sIh(cc).toString(),xc)};
a.rbd=function(sa,hb){var cc=sa.split("|");if(7>cc.length)return nb.ULS.sendTraceTag(542185166,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==cc[0])return nb.ULS.sendTraceTag(35755851,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",cc[0]),null;var xc=cc[1],vd=cc[2],Xd=a.tIh(cc[3]),Je=cc[4];cc=cc[5];xc&&xc.length||(xc=cc);cc={};cc.InstanceId=String.format("{{{0}}}",Kb.a.create().toString());cc.WebExtensionOsfControlType=
4;cc.WebExtensionType=1;cc.PrimaryMarketplace={};cc.PrimaryMarketplace.SolutionId=xc;cc.PrimaryMarketplace.SolutionVersion=vd;cc.PrimaryMarketplace.MarketplaceRef=Je;cc.PrimaryMarketplace.MarketplaceType=Xd;cc.ContainsCustomFunctions=hb?!0:!1;hb&&(cc.OsfPropertyBag=[["customFunctionAddinId",sa]]);return cc};a.tIh=function(sa){sa=parseInt(sa);return sa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:sa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:sa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:
sa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:sa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:sa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:sa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:sa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:sa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:sa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:sa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:
null};a.sIh=function(sa){return sa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:sa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:sa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:sa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:sa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:sa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:sa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:sa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
sa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:sa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:sa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.yob=function(sa){var hb={};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(hb.Version=sa.appVersion,hb.AssetId=sa.assetId,hb.AssetStoreId=null!==sa.assetStoreId?sa.assetStoreId.toString():null,hb.StoreType=sa.storeType,hb.Height=sa.height,
hb.SolutionId=sa.solutionId,hb.StoreId=sa.storeId,hb.TargetType=sa.targetType,hb.Width=1===hb.TargetType?0:sa.width,hb.SharedRuntimeId=sa.sharedRuntimeId,hb.AppVersion=sa.appVersion,hb.CurrentStoreType=sa.currentStoreType,hb.Id=sa.id):(hb.AppVersion=sa.appVersion,hb.AssetId=sa.assetId,hb.AssetStoreId=null!==sa.assetStoreId?sa.assetStoreId.toString():null,hb.CurrentStoreType=sa.currentStoreType,hb.Height=sa.height,hb.Id=sa.id,hb.StoreId=sa.storeId,hb.TargetType=sa.targetType,hb.Width=1===hb.TargetType?
0:sa.width,hb.SharedRuntimeId=sa.sharedRuntimeId);return hb};a.Ivb=function(sa){return sa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||sa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||sa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||sa===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.SCg=function(sa){return Object.assign(new Od.a,{RJa:sa.infoType,id:sa.id,title:sa.title,description:sa.description,buttonText:sa.buttonTxt,vga:sa.buttonCallback,z$b:sa.highPriority,nha:sa.dismissCallback,errorCode:sa.errorCode,k0e:sa.iframeNotificationUrl})};a.lKa=function(sa){var hb="FA000000014"===sa;hb||(hb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===sa);return hb};a.v2h=function(sa){return"FA000000005"===sa};Jl.Object.defineProperties(a.prototype,
{VWb:{configurable:!0,enumerable:!0,get:function(){return this.Wda||(this.Wda=new ec.a(this.$.yy))}},Ah:{configurable:!0,enumerable:!0,get:function(){if(!this.wm){var sa={},hb=!(this.$.Gd&1),cc=Xb.a.current.wH,xc=this.$.workbookContext,vd=zc.a.V_+zc.a.d_b,Xd=0;Ub.EwaSettings.ka(518)&&(Xd|=2);sa.pageBaseUrl=cc.LayoutsContentUrlPrefix;sa.appName=OSF.AppName.ExcelWebApp;sa.appVersion="16";sa.appSettings=this.XAh();sa.singleSignOnSettings=Ha.AppsForOfficeSingleSignOnManager.$Hh();sa.clientMode=hb?OSF.ClientMode.ReadOnly:
OSF.ClientMode.ReadWrite;sa.appUILocale=this.$.Ba.UICultureTag;sa.dataLocale=this.$.Ba.DataCultureTag;sa.docUrl=xc.ClientUrl;sa.hostControl=this;sa.formFactor=OSF.FormFactor.Default;sa.lcid=this.$.uF.toString();sa.localizedScriptsUrl=zc.a.V_+zc.a.hXc;sa.localizedImagesUrl=vd;sa.localizedStylesUrl=zc.a.V_+zc.a.nse;sa.localizedResourcesUrl=vd;sa.osfOmexBaseUrl=cc.OsfOmexBaseUrl;sa.firstPartyManifestCDNUrl=cc.FirstPartyAddInManifestCDN;sa.sdxAssetsToPrefetchMapping=ta.AFrameworkApplication.ha.Wa("SdxAssetsToPrefetchMapping");
sa.sdxCdnUrl=cc.SdxCdnUrl;sa.sdxDmsUrl=cc.SdxDmsUrl;sa.devCatalogUrl=cc.DevCatalogUrl;sa.controlStatusChanged=Object(ca.a)(this,this.Lka,"onOsfControlStatusChanged");sa.notifyHost=Object(ca.a)(this,this.Xpf,"onOsfNotifyHost");sa.allowExternalMarketplace=this.$.fa.gh.get(27)&&a.RXc;sa.trustAgaves=Ub.EwaSettings.ka(4);sa.enableAddinCommands=Ub.EwaSettings.ka(54);sa.enableBlackForestRedirect=Ub.EwaSettings.ka(89);sa.enableMyOrg=this.$.fa.gh.get(33);sa.enableMyApps=this.$.fa.gh.get(34);sa.enableDevCatalog=
Ub.EwaSettings.ka(46);sa.enablePrivateCatalog=this.Icj();sa.enableTaskpaneUpgradeToAppCommand=Ub.EwaSettings.ka(94);sa.showSignOutFromPrivateCatalogMessage=this.$.fa.gh.get(36);sa.enableUploadFileDevCatalog=Ub.EwaSettings.ka(54)&&!Ub.EwaSettings.ka(289);sa.userNameHashCode=Ua.a.Dv(ta.AFrameworkApplication.userName);sa.envCode=this.$.Ba.OfficeAddinTelemetryDataSourceCode.toString();sa.enableSingleSignOnForAddin=!Ub.EwaSettings.ka(25)&&ta.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
sa.enableServiceDeliveredExperience=Ub.EwaSettings.ka(86);sa.enableDisplayBlockedMinorError=Ub.EwaSettings.ka(186);sa.hideAppsExtensionUrl=ta.AFrameworkApplication.hideAppsExtensionUrl;sa.enableAnonymousUseLegacyCatalogService=Ub.EwaSettings.ka(176);sa.enableInsertDialogAccessibilityFix=Ub.EwaSettings.ka(183);sa.disableAppsForOfficeThirdParty=Ub.EwaSettings.ka(189);sa.enableFirstPartySSO=Ub.EwaSettings.ka(201);sa.wacSessionId=this.$.Ba.UserSessionId;sa.disableLogging=!this.$.Ba.AriaLoggingIsEnabled;
sa.enableFirstPartySDXErrorMessages=Ub.EwaSettings.ka(215);sa.enableRichApiCellEditDelay=Ub.EwaSettings.ka(193);sa.isHostDocumentDomain=Ub.EwaSettings.ka(231);sa.loggableUserId=ta.AFrameworkApplication.ha.Wa("LoggableUserId");sa.sessionStartInfoJson=ta.AFrameworkApplication.ha.Wa("SessionStartInfoJson");sa.wopiHostOriginFromPostMessage=ta.AFrameworkApplication.wopiHostOriginFromPostMessage;sa.wopiHostOriginFromWacPropBag=ta.AFrameworkApplication.ha.Wa("PostMessageOrigin");sa.wacIsEmbedded=ta.AFrameworkApplication.ha.ta("IsEmbedded");
sa.accessibilityAllowFocusAddinTaskpane=ta.AFrameworkApplication.ha.ta("AccessibilityAllowFocusAddinTaskpane");sa.enableRemoveAppCommandsAddin=ta.AFrameworkApplication.ha.ta("RemoveAppCommandsAddinIsEnabled");sa.isHostFrameTrustCheckEnabledForAddIns=ta.AFrameworkApplication.ha.ta("HostFrameTrustCheckIsEnabledForAddIns");sa.isHostFrameTrusted=ta.AFrameworkApplication.isHostFrameTrusted;sa.agaveAddinUploadEnabled=Ub.EwaSettings.ka(48);sa.hostAllowedOfficeStore=ta.AFrameworkApplication.ha.ta("HostAllowedOfficeStore");
sa.hostAllowedSdxEmbedding=ta.AFrameworkApplication.ha.ta("HostAllowedSdxEmbedding");sa.hostInstallAddIns=ta.AFrameworkApplication.ha.Wa("HostInstallAddIns");sa.hostInstallAddInsIsEnabled=ta.AFrameworkApplication.ha.ta("HostInstallAddInsIsEnabled");sa.approvedAddIns=ta.AFrameworkApplication.ha.Wa("ApprovedAddIns");sa.addinEnforceHttpsIsEnabled=this.Tbj(sa.sessionStartInfoJson);sa.hostFeatureGateFlag=Xd;sa.isUpnCheckEnabled=ta.AFrameworkApplication.ha.ta("IsUpnCheckEnabled");sa.wacUpn=ta.AFrameworkApplication.ha.Wa("UserPrincipalName");
sa.isReactRibbonEnabled=Fd.a.isReactRibbonEnabled();sa.enableSetFocusOnTaskpaneOnUserAction=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);sa.isSafariWithIndexedDBDisabled=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ta.a.m4a;sa.isIndexedDBDisabled=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ta.a.m4a||Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Ta.a.Pf;sa.enableCustomShortcuts=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");sa.changeGetModifierKeyStringOutputOrder=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.wm=new OSF.ContextActivationManager(sa);sa={};this.wm.setIframeAttributeBag((sa.frameborder=0,sa.marginheight=0,sa.marginwidth=0,sa));this.wm.setWSA(ta.AFrameworkApplication.Sm);this.wm&&"undefined"!==typeof this.wm.hostCheckReadyHandler&&ta.AFrameworkApplication.Msg(Object(ca.a)(this.wm,
this.wm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var Je=Ab.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.wm.setOAuthManager(Je)}catch(ff){}}return this.wm}},kCj:{configurable:!0,enumerable:!0,get:function(){return this.hNc}},dj:{configurable:!0,enumerable:!0,get:function(){return this.Y7d}},Ila:{configurable:!0,enumerable:!0,get:function(){return this.V7d}},zEd:{configurable:!0,enumerable:!0,get:function(){return this.Z7d}},yEd:{configurable:!0,enumerable:!0,get:function(){return this.X7d}},
J_i:{configurable:!0,enumerable:!0,get:function(){return this.a8d}},H_i:{configurable:!0,enumerable:!0,get:function(){return this.W7d}},I_i:{configurable:!0,enumerable:!0,get:function(){return this.$7d}},K_i:{configurable:!0,enumerable:!0,get:function(){return this.b8d}},L_i:{configurable:!0,enumerable:!0,get:function(){return this.c8d}},AEd:{configurable:!0,enumerable:!0,get:function(){return this.d8d}},JU:{configurable:!0,enumerable:!0,get:function(){return this.geg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.wb}}});Jl.Object.defineProperties(a,{RXc:{configurable:!0,enumerable:!0,get:function(){return a.ZWd},set:function(sa){a.ZWd=sa}}});a.tZa=new ia.a;a.ZWd=!0;Object(sb.a)(a,"DdaFacade",Bb.a,[186,810,683,811,812,7])},850:function(D,F,b){function a(){this.WAd=0;this.VV={};this.Cra={}}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(113);a.prototype.kEh=function(m,r){return this.VV[a.XSc(m,r)]};a.prototype.rCe=function(m,r){r||void 0!==this.Cra[m]&&null!==this.Cra[m]?r&&
void 0!==this.Cra[m]&&null!==this.Cra[m]&&delete this.Cra[m]:this.Cra[m]=1};a.prototype.PWb=function(m){return void 0===this.Cra[m]||null===this.Cra[m]};a.prototype.fNh=function(m){var r=a.XSc(m.messageType,m.targetId);1===m.actionType?this.xOh(m.controlId,m.messageType,r):2===m.actionType&&this.gPh(m.controlId,m.messageType,r)};a.prototype.XRi=function(m){if(m){var r=Object.keys(this.VV);if(!(void 0===r||null===r||0>=r.length)){r=Ml(r);for(var t=r.next();!t.done;t=r.next()){t=t.value;var k=this.VV[t];
k[m]&&(delete k[m],Object.keys(k).length||delete this.VV[t])}}}};a.prototype.nZ=function(m,r){m=a.XSc(m,r);m=this.VV[m];return!!m&&0<Object.keys(m).length};a.prototype.ZPh=function(){return!c.a.isEmpty(this.VV)};a.prototype.J8e=function(){return 0<this.WAd};a.prototype.Uyh=function(){var m=[],r=this.VV,t;for(t in r){var k=t,u=r[t],w;for(w in u){u=w;var v={};v.eventType=parseInt(k.split("#")[0]);v.targetId=k.split("#")[1];v.addinId=u;m.push(v)}}return m};a.prototype.xOh=function(m,r,t){if(this.VV[t])t=
this.VV[t],t[m]=t[m]?t[m]+1:1;else{var k={};k[m]=1;this.VV[t]=k}100===r&&this.WAd++};a.prototype.gPh=function(m,r,t){if(this.VV[t]){var k=this.VV[t];if(m){var u=k[m];1===u?(delete k[m],Object.keys(k).length||delete this.VV[t]):k[m]=u-1;100===r&&this.WAd--}else d.ULS.sendTraceTag(23941468,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",m,t)}else d.ULS.sendTraceTag(23941467,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",t)};a.XSc=function(m,r){return String.format("{0}#{1}",
m,r)};a.eW="Workbook";Object(D.a)(a,"RichApiEventRegistration",null,[])},879:function(D,F,b){function a(d,c,m,r){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=d;this.controlId=c;this.ddaBinding=m;this.ArrayData=void 0===r?null:r}b.d(F,"a",function(){return a});D=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(D.a)(a,"DdaEventArgs",null,[])},925:function(D,F,b){function a(c,m,r){this.BMb=
c;this.Y8f=m;this.Z8f=r}function d(){this.title=this.id=this.tabs=null}D=b(0);Object(D.a)(d,"AddInDataTransferObject",null,[]);b.d(F,"a",function(){return a});a.xrb=function(c){return(c=c.yba)?Object.assign(new d,{tabs:c.Rw.toArray(),id:c.Qog,title:c.Rog}):null};Jl.Object.defineProperties(a.prototype,{Rw:{configurable:!0,enumerable:!0,get:function(){return this.BMb}},Qog:{configurable:!0,enumerable:!0,get:function(){return this.Y8f}},Rog:{configurable:!0,enumerable:!0,get:function(){return this.Z8f}}});
Object(D.a)(a,"OneLineRibbonExtensibility",null,[])},933:function(D,F,b){function a(){var c={};this.x4c=(c.tabhome="Ribbon.Home",c.tabinsert="Ribbon.Insert",c.tabdata="Ribbon.Data",c.tabreview="Ribbon.Review",c.tabview="Ribbon.View",c);c={};this.v4c=(c.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",d.a.instance.da(1560),d.a.instance.da(1564)],c.tabformulas=["Ribbon.Formulas",d.a.instance.da(1561),d.a.instance.da(1565)],c.tabdeveloper=["Ribbon.Developer",d.a.instance.da(1562),d.a.instance.da(1566)],
c.tabaddins=["Ribbon.AddIns",d.a.instance.da(1563),d.a.instance.da(1567)],c);this.Hih="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.I_a=null}b.d(F,"a",function(){return a});D=b(0);var d=b(16);a.prototype.RCh=function(){if(this.I_a)return this.I_a;this.I_a={};for(var c=Ml(Object.keys(this.x4c)),m=c.next();!m.done;m=c.next())m=m.value,this.I_a[m]=this.x4c[m];c=Ml(Object.keys(this.v4c));for(m=c.next();!m.done;m=
c.next())m=m.value,this.I_a[m]=this.v4c[m][0];return this.I_a};Jl.Object.defineProperties(a.prototype,{$ga:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},oA:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},Ptc:{configurable:!0,enumerable:!0,get:function(){return this.x4c}},l7a:{configurable:!0,enumerable:!0,get:function(){return this.Hih}},nii:{configurable:!0,enumerable:!0,
get:function(){return this.v4c}}});Object(D.a)(a,"AddinCommandsStringProvider",null,[857])},969:function(D,F,b){function a(X,ja){this.Lyc=new x.a;this.wm=X;this.tlg=ja}function d(X,ja,R,ba){this.pS=new A.a;this.LF=new A.a;this.Tna=null;this.aib=new A.a;this.A2d=Promise.resolve(null);this.I9d=!1;this.YRb=ja;this.XWd=X;this.NLc=R;this.c9f=ba}function c(){var X=m.call(this)||this;X.errorCode=0;return X}function m(){this.gNb=new A.a;this.K1=this.J1=!1;this.Rma=this.authChallenge=null;this.startTime=this.retryCount=
0;this.mge=null}function r(){this.token=null;this.expiresOn=0;this.VS=this.authChallenge=null}function t(){this.accessToken=null}function k(){this.startTime=0;this.callback=null}function u(X){this.Boa=X;this.Boa.vn(W.a.hxf);this.Boa.km(W.a.hxf,Object(z.a)(this,this.iud,"onReceivedAccessToken"))}function w(){}function v(){}b.r(F);D=b(0);var A=b(210),y=b(15),x=b(107),z=b(37),J=b(998);v.XQf="SharepointOnline";v.SBi="OnedriveWOPI";Object(D.a)(v,"HostApplicationType",null,[]);w.Tki="login_required";w.Ski=
"AADSTS50058";w.wYh="AADSTS50001";w.userAborted="13002";w.userNotSignedIn="13001";w.fli="consent_required";w.eli="AADSTS70011";w.Kkc="Popup Window is null";w.Nwd="Popup Window closed";w.Lki="AADSTS65001";w.Pzj="access_denied";w.Ozj="AADSTS65004";w.F9g="Environment not supported";w.ung="adal.js load failed";Object(D.a)(w,"SSOErrorType",null,[]);var B=b(5),C=b(194),H=b(523),W=b(177);u.prototype.Ibe=function(X,ja,R,ba,ha,oa,Sa){var ma=this,na=C.a.create().toString()+"-"+X,xa={};xa[H.a.jge]=na;xa[H.a.cvg]=
ja;xa[H.a.mvg]=oa;xa[H.a.lvg]=ha;xa[H.a.J1]=R;xa[H.a.K1]=ba;xa[H.a.addinName]=Sa;return new Promise(function(Oa){ma.Boa.Yj(W.a.getAccessToken,xa);u.jUd.ja(na,Oa)})};u.prototype.$Rf=function(){return!1};u.prototype.s4e=function(){if(!B.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost)return!1;var X=(B.AFrameworkApplication.ha.Wa(B.AFrameworkApplication.$ma)||"").toLowerCase();return"teams"!==X&&"officecom"!==X&&"officecomhwa"!==X&&"officecompwa"!==X};u.prototype.iud=function(X){var ja=
u.jUd.oa(X.Values[H.a.jge]);if(ja){var R=new J.a,ba=X.Values[H.a.accessToken];void 0!==X.Values[H.a.Bia]&&null!==X.Values[H.a.Bia]&&(R.Bia=X.Values[H.a.Bia]);void 0!==X.Values[H.a.YIa]&&null!==X.Values[H.a.YIa]&&(R.YIa=X.Values[H.a.YIa]);void 0!==X.Values[H.a.CIa]&&null!==X.Values[H.a.CIa]&&(R.CIa=X.Values[H.a.CIa]);void 0!==X.Values[H.a.T6]&&null!==X.Values[H.a.T6]&&(R.T6=X.Values[H.a.T6]);void 0!==X.Values[H.a.VS]&&null!==X.Values[H.a.VS]&&(R.VS=X.Values[H.a.VS]);var ha=0;if(ba&&"undefined"!==typeof ba&&
ba.length)R.token=ba;else if(ha=this.Nfi(X),X=this.Hvd(X))R.cuc=X;R.errorCode=ha;ja(R)}};u.prototype.Nfi=function(X){var ja=X.Values[H.a.z_e];X=X.Values[H.a.lge];var R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError;ja&&ja.toLowerCase()===v.SBi.toLowerCase()?X===w.Tki?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn:X===w.userAborted||X===w.Pzj?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:X===w.fli&&(R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant):-1<X.indexOf(w.Ski)?
R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:-1<X.indexOf(w.Kkc)?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:-1<X.indexOf(w.wYh)?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:-1<X.indexOf(w.userAborted)||-1<X.indexOf(w.Ozj)||-1<X.indexOf(w.Nwd)?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:-1<X.indexOf(w.eli)||-1<X.indexOf(w.Lki)?R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:-1<X.indexOf(w.userNotSignedIn)&&(R=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn);
return R};u.prototype.Hvd=function(X){var ja="",R=X.Values[H.a.z_e];X=X.Values[H.a.lge];R&&R.toLowerCase()===v.XQf.toLowerCase()&&(X===w.F9g?ja="EnvironmentNotSupported":X===w.ung?ja="AdalJSFailed":ja===w.Kkc?ja="PopupWindowNull":(R=RegExp("AADSTS(\\d+)").exec(X))&&1<R.length&&(ja=R[1]));return ja};u.jUd=new x.a;Object(D.a)(u,"AppsForOfficeTokenFromWOPI",null,[875]);Object(D.a)(k,"SSOCallbackInfo",null,[]);Object(D.a)(t,"AccessTokenInformation",null,[889]);Object(D.a)(r,"CachedTokenInfo",null,[]);
Jl.Object.defineProperties(m.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.gNb}}});Object(D.a)(m,"SSORequestInfo",null,[]);Cm(c,m);Object(D.a)(c,"SSOFailedRequestInfo",m,[]);d.prototype.Idj=function(X){if(this.Tna&&this.Tna.authChallenge===X.authChallenge){if(Date.now()/1E3+d.sgi>this.Tna.expiresOn)return this.Tna=null,!1;X=new J.a;X.token=this.Tna.token;X.expiresOn=this.Tna.expiresOn;X.VS=this.Tna.VS;X.T6=!0;X.Bia=0;this.wtb(X);return!0}return!1};d.prototype.qcj=
function(X){for(var ja=0;ja<this.LF.count;ja++)if(this.LF.oa(ja).authChallenge===X.authChallenge&&this.LF.oa(ja).Rma===X.Rma){var R=void 0;(R=this.LF.oa(ja)).retryCount=R.retryCount+1;X.retryCount=this.LF.oa(ja).retryCount;if(this.LF.oa(ja).retryCount<d.Ogi||!this.LF.oa(ja).J1&&X.J1||!this.LF.oa(ja).K1&&X.K1){if(!this.LF.oa(ja).J1&&X.J1||!this.LF.oa(ja).K1&&X.K1)X.retryCount=0;this.LF.removeAt(ja);break}X=new J.a;X.errorCode=this.LF.oa(ja).errorCode;this.wtb(X);return!0}return!1};d.prototype.Fqg=
function(X,ja){for(var R=0;R<this.LF.count;R++)if(this.LF.oa(R).Rma===X.Rma&&this.LF.oa(R).authChallenge===X.authChallenge)return;this.LF.add(Object.assign(new c,{J1:X.J1,K1:X.K1,authChallenge:X.authChallenge,Rma:X.Rma,errorCode:ja,retryCount:X.retryCount}))};d.prototype.I7c=function(X,ja,R,ba,ha,oa){var Sa=this,ma=b(969).AppsForOfficeSingleSignOnManager;""===R&&(R=null);if(this.I9d)ma.R4(oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var na=null,xa=Ml(this.pS),Oa=xa.next();!Oa.done;Oa=
xa.next())if(Oa=Oa.value,Oa.J1===X&&Oa.K1===ja&&Oa.authChallenge===R&&Oa.Rma===ha){na=Oa;break}na||(na=Object.assign(new m,{J1:X,K1:ja,authChallenge:R,mge:ba,Rma:ha,retryCount:0,startTime:ma.Rv()}),this.pS.add(na));na.retryCount=0;na.callbacks.add(oa);this.A2d=this.A2d.then(function(){var ib=b(969).AppsForOfficeSingleSignOnManager;if(0<Sa.pS.count){var sb=Sa.pS.oa(0);if(Sa.Idj(sb)||Sa.qcj(sb))return null;for(var nb=0;nb<Sa.aib.count;)Sa.aib.oa(nb)+d.Woj<ib.Rv()?Sa.aib.removeAt(nb):nb++;if(Sa.aib.count>=
d.Jgi||Sa.pS.count>=d.pgi)return sb=new J.a,sb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,Sa.wtb(sb),null;var Gb=null;B.AFrameworkApplication.za&&(ib=B.AFrameworkApplication.za.bB)&&(Gb=ib.Ic("ComponentAttach",Sa.XWd+d.okg));return sb.Rma.Ibe(Sa.XWd,Sa.resource,sb.J1,sb.K1,sb.authChallenge,Sa.NLc,Sa.c9f,sb.mge).then(function(Ha){Gb&&Gb.stop();Sa.wtb(Ha)},function(){Gb&&Gb.stop();var Ha=new J.a;Ha.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;Sa.wtb(Ha)})}return null})}};
d.prototype.wtb=function(X){var ja=b(969).AppsForOfficeSingleSignOnManager;try{if(this.pS.count){var R=this.pS.oa(0);this.pS.removeAt(0);var ba=null;X.errorCode||(ba=new t,ba.accessToken=X.token);X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Fqg(R,X.errorCode);
var ha={};null!=X.Bia&&(ha.getTokenSilentTime=X.Bia.toString());null!=X.YIa&&(ha.getTokenPopupTime=X.YIa.toString());null!=X.CIa&&(ha.getIDTokenTime=X.CIa.toString());null!=X.T6&&(ha.tokenCached=X.T6.toString());X.cuc&&(ha.detailedError=X.cuc);X.VS&&(ha.authLibrary=X.VS);R.retryCount&&(ha.retryCount=R.retryCount);for(var oa=Ml(R.callbacks),Sa=oa.next();!Sa.done;Sa=oa.next())ja.R4(Sa.value,X.errorCode,ba,ha);null!=X.T6&&X.T6||this.aib.add(R.startTime);if(!X.errorCode)for(null!=X.expiresOn&&(this.Tna=
Object.assign(new r,{token:X.token,expiresOn:X.expiresOn,authChallenge:R.authChallenge,VS:X.VS})),this.LF.clear(),oa=0;oa<this.pS.count;)if(this.pS.oa(oa).authChallenge===R.authChallenge){var ma=Ml(this.pS.oa(oa).callbacks);for(Sa=ma.next();!Sa.done;Sa=ma.next())ja.R4(Sa.value,X.errorCode,ba,ha);this.pS.removeAt(oa)}else oa++}}catch(na){y.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",na.message)}};d.prototype.shutdown=function(){this.I9d=!0;this.pS.clear()};
Jl.Object.defineProperties(d.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.YRb}}});d.Woj=6E4;d.Jgi=6;d.pgi=6;d.Ogi=3;d.sgi=300;d.okg="GetAccessToken";Object(D.a)(d,"SSOCallbackManager",null,[]);var S=b(829),N=b(839),T=b(119),fa=b(75),Y=b(24),L=b(30),P=b(145),ea=b(338);b.d(F,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.J7c=function(X,ja,R,ba,ha,oa,Sa,ma,na,xa,Oa){Oa=Object.assign(new k,{startTime:a.Rv(),callback:Oa});try{var ib=!!R&&""!==R,sb=
Oa.startTime,nb=this.getOsfControl(X),Gb=nb.getStoreType()||"",Ha=nb.getOwnerAddinStoreType()||"",ca=nb.getMarketplaceID()||"",Ra=nb.getMarketplaceVersion()||"";Gb=Gb.toLowerCase();Ha=Ha.toLowerCase();ca=ca.toLowerCase();var ua=fa.a.R9c(ja)||"",ta=fa.a.R9c(nb.getIframeUrl())||"",db=ua.toLowerCase()===ta.toLowerCase();ua=Gb;"inmemory"===Gb&&(ua=Ha);var Ta=Telemetry.PrivacyRules.GetAssetId(ua,nb.getStoreLocator(),ca);nb={};var qb=(nb.callInstanceId=sb.toString(),nb.controlAssetId=Ta,nb.controlVersion=
Ra,nb.storeType=Gb,nb.ownerStoreType=Ha,nb.allowConsentPrompt=ba.toString(),nb.forMSGraphAccess=ha.toString(),nb.allowSignInPrompt=oa.toString(),nb.hasAddinAuthChallenge=ib.toString(),nb.securityOriginEqualsSourceLocation=db.toString(),nb.singleSignOnEnabled=Sa.toString(),nb.accountTypeFilter=na||"",nb);y.ULS.sendTraceTag(51401115,344,50,"{0}",qb);P.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:T.a.kG(qb)}));sb=!0;var za=B.AFrameworkApplication.ha.Wa("HostAuthType");
switch(na){case "aad":sb="aad"===za;break;case "msa":sb="msa"===za;break;default:sb=!na||"noFilter"===na}if(sb){na=null;if(Sa)for(var Ia=Ml(this.tlg),va=Ia.next();!va.done;va=Ia.next()){var Ua=va.value;if(Ua.s4e(ca,ma)){na=Ua;break}else if(Ua.$Rf())break}na?this.isSSOAddin(X)?(Sa=!0,"omex"===ua&&(Sa=!1),"spapp"===ua||"spcatalog"===ua?(y.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):ha&&!Sa?(y.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ha&&"exchange"===ua&&(ba=!1),this.I7c(X,ja,R,ua,ba,oa,xa,na,Oa))):(y.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Kb){this.afc(),y.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Kb.message),a.R4(Oa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(X,ja,R,ba){this.J7c(X,R[S.a.YPc]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||
!1,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,ja,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.EnableNewHosts]||0,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,ba)};a.prototype.I7c=function(X,ja,R,ba,ha,oa,Sa,ma,na){this.Lyc.tb(X)?ba=this.Lyc.oa(X):(ba=new d(X,this.getWebApplicationResource(X).split(",")[0],
ba,this.getDefaultDisplayName(X)),this.Lyc.add(X,ba));var xa=ba.resource;X=a.CGh(xa,this.getWebApplicationId(X));var Oa=OfficeExt.WACUtils.getHostSecure(ja);X&&Oa?X.toLowerCase()===Oa.toLowerCase()?ba.I7c(ha,oa,R,Sa,ma,na):(a.OLa('SSO Resource "'+xa+'" cannot be used from "'+ja+'" origin due to domain mismatch.'),y.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.R4(na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null)):(X||y.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Oa||y.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.R4(na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.afc=function(){var X={};y.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(X.UserAgent=window.navigator.userAgent,X))};a.prototype.getOsfControl=function(X){return this.wm.getOsfControl(X)};a.prototype.isSSOAddin=function(X){return this.getOsfControl(X).getManifest().isSSOAddin()};
a.prototype.getWebApplicationId=function(X){return this.getOsfControl(X).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(X){return this.getOsfControl(X).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(X){return this.getOsfControl(X).getManifest().getDefaultDisplayName()};a.QLe=function(){return B.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2",!1)};a.$Hh=function(){try{var X=
{};Y.a.Jja&&N.a.mub&&(X.UiHostSupportsAuthTokenAddinList=a.UKe);X.UiHostSupportsAuthToken=N.a.mub;return X}catch(ja){y.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ja.message)}return null};a.getInstance=function(X,ja,R){R=void 0===R?null:R;if(!a.Pa){var ba=new A.a;R&&ba.add(R.Xei);a.QLe()||ba.add(new u(ja));a.Pa=new a(X,ba)}return a.Pa};a.OLa=function(X){window.console.warn&&window.console.warn(X)};a.CGh=function(X,ja){if(!X)return"";ja||(ja="");var R=
X.toLowerCase(),ba=ja.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(ba)||(a.OLa('SSO App Id "'+ja+'" is not a valid format. It will be rejected from store submission.'),y.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));R.endsWith(ba)||(a.OLa('SSO Resource "'+X+'" does not end with App Id "'+ja+'". It will be rejected from store submission.'),y.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!R.startsWith("https://")&&
!R.startsWith("api://"))return a.OLa('SSO Resource "'+X+'" must be https:// or api:// protocol.'),y.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ja=0;ja<X.length;ja++){ba=X.charAt(ja);var ha=L.a.charCodeAt(X,ja);if(33>ha||126<ha||"&"===ba||"?"===ba||"#"===ba||"%"===ba||"\\"===ba)return a.OLa('SSO Resource "'+X+'" contains an invalid character "'+ba+'".'),y.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+ba+"' in resource URI."),""}if(0<=X.indexOf("::"))return a.OLa('SSO Resource "'+
X+'" contains an invalid string "::".'),y.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<X.length)return a.OLa('SSO Resource "'+X+'" is '+X.length+" characters and exceeds the max length of 120 characters."),y.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+X.length+"."),"";R.startsWith("api://")&&(R="https://"+R.substring(6,R.length));return 8===R.length?"":OfficeExt.WACUtils.getHostSecure(R)||""};a.R4=function(X,ja,R,ba){var ha=X.startTime,oa=0;0<ha&&(oa=a.Rv()-ha);
var Sa={};ha=(Sa.callInstanceId=ha.toString(),Sa.callDuration=oa.toString(),Sa.errorCode=ja.toString(),Sa);if(ba)for(var ma in ba)ha[ma]=ba[ma];y.ULS.sendTraceTag(51401116,344,50,"{0}",ha);P.a.sendTelemetryEvent(Object.assign(new ea.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:T.a.kG(ha)}));X.callback(ja,R)};a.Rv=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(X){}return Date.now()};a.UKe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
a.Pa=null;Object(D.a)(a,"AppsForOfficeSingleSignOnManager",null,[865])},997:function(D,F,b){function a(){this.RJa=0;this.vga=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.z$b=!1;this.k0e=this.nha=null}b.d(F,"a",function(){return a});D=b(0);Object(D.a)(a,"AddInCommandsNotificationParameters",null,[])},998:function(D,F,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.VS=this.T6=this.CIa=this.YIa=this.Bia=this.cuc=null}b.d(F,"a",function(){return a});
D=b(0);Object(D.a)(a,"AppsForOfficeOauthResult",null,[])}}]);

//# sourceMappingURL=EwaDS.agave.js.map