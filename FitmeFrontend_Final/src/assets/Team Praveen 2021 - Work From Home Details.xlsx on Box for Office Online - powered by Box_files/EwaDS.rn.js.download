(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1370:function(D,F,b){function a(eb){return Qa.call(this,eb)||this}function d(eb){this.Bi=eb}function c(eb){var xb=gb.call(this)||this;xb.renameFileManager=null;xb.oY=null;xb.$=eb;xb.fc();return xb}function m(eb,xb){var dc=Ub.call(this)||this;dc.e0c=null;dc.lGf=null;dc.ECd=null;dc.bca=null;dc.$=eb;dc.Ir=xb;dc.$.fa.ot(Object(R.a)(dc,dc.Nia,"handleWorkbookMetadataChanged"));return dc}function r(eb){this.$=eb}function t(eb){return sc.call(this,
eb)||this}function k(eb){this.renameFileManager=eb}function u(){this.yb=this.pb=null}function w(eb,xb,dc,Nc,Pc,Fd,Ea,Xa,hc,Xb){var Ic=A.call(this,eb,dc,Nc,Pc,Fd,hc)||this;Ic.VTb=null;Ic.fib=null;Ic.phg=xb;Ic.Oa=Ea;Ic.re=Xa;Xb&&Xb.execute(function(Qc){Ic.fRi(Qc)});return Ic}function v(eb,xb,dc,Nc,Pc,Fd,Ea,Xa){eb=A.call(this,eb,xb,dc,Nc,Pc,Fd)||this;eb.t7d=Pc;eb.gig=Ea;eb.Jdg=Xa;return eb}function A(eb,xb,dc,Nc,Pc,Fd){this.rl=!1;this.zGc=new Za.a;this.kTa=xb;this.aL=dc;this.Y$f=Nc;this.yb=Pc;this.f$d=
Fd}function y(eb,xb,dc,Nc,Pc){this.FAc=Pc;this.A1d=dc;this.z1d=Nc;this.Slg=eb;this.Hoa=xb}function x(eb){this.Oa=eb}function z(eb){this.H7=null;this.voa=0;this.Oa=eb;this._initialized=!1}function J(eb,xb,dc){var Nc=E.call(this)||this;Nc.Oa=eb;Nc.sv=xb;Nc.voa=dc;Nc.We="RenameDialog";Nc.Mf=B.Mf;return Nc}function B(){}function C(eb,xb,dc){this.dialog=null;this.Oa=eb;this.sv=xb;this.voa=dc}function H(eb,xb){this.Oa=eb;this.eTa=xb}function W(){}function S(eb,xb,dc,Nc,Pc,Fd,Ea,Xa,hc,Xb,Ic,Qc){this.z1d=
eb;this.Oa=xb;this.FAc=dc;this.sv=Nc;this.wCa=Pc;this.Olg=Fd;this.Zpa=Ea;this.xae=Xa;this.iig=hc;this.Hoa=Xb;this.yb=Ic;this.hig=Qc}function N(){this.ski=this.oki=this.nZg=null}function T(){}function fa(eb,xb,dc,Nc,Pc,Fd,Ea,Xa,hc,Xb,Ic,Qc){this._initialized=!1;this._element=null;this.CCa=0;this.LKc=this.lEc=!1;this.Oa=eb;this.Dzc=xb;this.qe=dc;this.Kz=Nc;this.H7=Pc;this.A8d=Fd;this.sSb=Ea;this.vAc=Xa;this.T7=hc;this.n1d=Xb;this.WTa=Ic;this.cFc=Qc}function Y(eb,xb){this.CCa=0;this.Oa=eb;this.H7=xb}
function L(eb,xb,dc,Nc,Pc){var Fd=na.call(this)||this;Fd.U0=new ja(eb,xb,dc);Fd.Zpa=Nc;Fd.Hoa=Pc;Fd.We="RenameDisabledDialog";Fd.lc=0;Fd.Dc(1,CommonUIStrings.l_DialogClose);Fd.Mf=P.Mf;Fd.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);Fd.kW("RenameRow");return Fd}function P(){}function ea(eb,xb,dc,Nc,Pc){return X.call(this,eb,xb,dc,Nc,Pc)||this}function X(eb,xb,dc,Nc,Pc){var Fd=Sa.call(this)||this;Fd.DNd=[];Fd.U0=new ja(eb,xb,dc);Fd.Zpa=Nc;Fd.Hoa=Pc;Fd.We="RenameDisabledDialog";Fd.lc=
0;Fd.Dc(1,CommonUIStrings.l_DialogClose);Fd.A$i();Fd.iWi();return Fd}function ja(eb,xb,dc){this.rKd=this.sKd=this.tKd=!1;this.LKd=!eb&&!xb;this.MKd=!eb&&!dc;this.LKd||this.MKd||(this.tKd=!eb,this.sKd=!xb,this.rKd=!dc)}b.r(F);D=b(0);var R=b(37),ba=b(675),ha=b(15),oa=b(128);Object(D.a)(ja,"RenameDisabledDialogInfo",null,[]);var Sa=oa.StandardDialog;Cm(X,Sa);X.prototype.A$i=function(){this.U0.LKd?this.eIb(this.Zpa?this.Hoa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.U0.MKd?this.eIb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Yog();this.iqa(this.DNd)};X.prototype.eIb=function(eb){Array.add(this.DNd,eb)};X.prototype.Yog=function(){var eb=[];this.U0.tKd||Array.add(eb,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.U0.sKd||Array.add(eb,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.U0.rKd||Array.add(eb,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<eb.length&&Array.add(this.DNd,
eb)};Object(D.a)(X,"ReactRenameDisabledDialogBase",oa.StandardDialog,[]);Cm(ea,X);ea.prototype.iWi=function(){this.czb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)};Object(D.a)(ea,"ReactRenameDisabledDialog",X,[]);var ma=b(140);Jl.Object.defineProperties(P,{Mf:{configurable:!0,enumerable:!0,get:function(){return ma.a.jj(P.Oj,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,
CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}});P.Oj="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";Object(D.a)(P,"RenameDisabledDialogHtml",null,
[]);var na=ma.a;Cm(L,na);L.prototype.D6a=function(){if(this.U0.LKd){var eb=this.Zpa?this.Hoa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;L.eIb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),eb)}else this.U0.MKd?L.eIb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):
this.mRh()};L.prototype.mRh=function(){this.U0.tKd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.U0.sKd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.U0.rKd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")};L.eIb=function(eb,xb,dc){eb.style.display="none";xb.innerText=dc};Object(D.a)(L,"RenameDisabledDialog",ma.a,[]);var xa=b(5),Oa=b(30),ib=b(111),sb=b(29);Y.prototype.initialize=
function(eb){if(!this.Oa||!this.H7)return!1;this.CCa=eb;this.Rg();return!0};Y.prototype.Rg=function(){this.Oa.$b(sb.a.Tga,ib.a.frame,Object(R.a)(this,this.Tga,"commitNewDocumentTitle"))};Y.prototype.Tga=function(eb,xb,dc,Nc,Pc){if(1===dc)return this.Oa.processAction(sb.a.renameFile,1);eb=Oa.a.Pq(this.H7.zn);Pc=(0,Pc.getNewDocumentTitle)();Pc.length>this.CCa&&(Pc=Pc.substr(0,this.CCa));if(32!==this.Oa.Pe(sb.a.renameFile,2,Pc))return this.HW(eb),8;this.HW(Pc);return 32};Y.prototype.HW=function(eb){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(eb))};
Y.$9c=function(){return new Y(xa.AFrameworkApplication.Hb,xa.AFrameworkApplication.zl)};Object(D.a)(Y,"ReactRenameUIHandler",null,[272]);var nb=b(814),Gb=b(901),Ha=b(573),ca=b(13),Ra=b(120),ua=b(167),ta=b(87),db=b(49),Ta=b(24),qb=b(88);fa.prototype.initialize=function(eb,xb,dc){if(!(this.Oa&&this.H7&&this.A8d&&this.sSb&&this.vAc&&xb)||0>=eb)return!1;this._element=xb;this._element.title=dc;this._element.setAttribute(ta.a.Wd,ta.a.Gq);this._element.setAttribute("Unselectable","on");this.CCa=eb;this.Vx();
return this._initialized=!0};fa.prototype.Vx=function(){this.Dzc&&(this.Dzc.qa(ca.a.blur,this._element,Object(R.a)(this,this.onBlur,"onBlur")),this.Dzc.qa(ca.a.paste,this._element,Object(R.a)(this,this.onPaste,"onPaste")));this.qe.qa(ca.a.Rb,this._element,Object(R.a)(this,this.onKeyDown,"onKeyDown"));this.Kz.qa(ca.a.pointerDown,this._element,Object(R.a)(this,this.onPointerDown,"onPointerDown"));this.Kz.qa(ca.a.de,this._element,Object(R.a)(this,this.Hh,"onPointerUp"))};fa.prototype.onBlur=function(){this.isActive&&
!this.lEc&&(this.n1d||this.vAc(this._element),this.fse(),this.X_c(!1));return this.lEc=!1};fa.prototype.onPaste=function(){ha.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0};fa.prototype.onKeyDown=function(eb){return this.isActive?this.Yui(eb):this.Zui(eb)};fa.prototype.Yui=function(eb){var xb=!1;switch(eb.Ga.keyCode){case Sys.UI.Key.enter:this.fse();this.X_c(this.WTa||this.cFc);xb=!0;break;case Sys.UI.Key.tab:this.n1d&&this.vAc(this._element);break;case Sys.UI.Key.esc:this.bEd(),
this.X_c(this.WTa||this.cFc),xb=!0}return xb};fa.prototype.Zui=function(eb){var xb=!1;switch(eb.Ga.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.I_f(this.cFc),this.isActive&&this.sSb(this._element),xb=!0}return xb};fa.prototype.onPointerDown=function(){this.isActive||(this.I_f(!1),this.isActive&&(this._element.focus(),this.sSb(this._element),this.LKc=!0));return!1};fa.prototype.Hh=function(){return this.LKc?(this.sSb(this._element),this.LKc=!1,!0):!1};fa.prototype.h4a=function(){return 32===
this.Oa.processAction(sb.a.renameFile,1)};fa.prototype.fse=function(){var eb=Oa.a.Pq(this.H7.zn),xb=this._element.innerText.trim();xb.length>this.CCa&&(xb=xb.substr(0,this.CCa));xb!==eb&&""!==xb?32!==this.Oa.Pe(sb.a.renameFile,2,xb)?this.bEd():this.HW(xb):this.bEd()};fa.prototype.bEd=function(){this.HW(Oa.a.Pq(this.H7.zn))};fa.prototype.HW=function(eb){this._initialized&&(this._element.innerText=eb,this.A8d())};fa.prototype.I_f=function(eb){this.h4a()?this.isActive||(eb&&(this.lEc=!0,this._element.blur()),
this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ta.a.Wd,ta.a.mRc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,nb.CuiHelper.yBe),this.T7&&this.T7.execute(function(xb){xb.KAf(!0)}),eb&&this._element.focus(),ha.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Oa.processAction(sb.a.mab,2)};fa.prototype.X_c=function(eb){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable",
"on");this._element.setAttribute(ta.a.Wd,ta.a.Gq);Sys.UI.DomElement.removeCssClass(this._element,nb.CuiHelper.yBe);this.T7&&this.T7.execute(function(xb){xb.KAf(!1)});eb&&(this._element.blur(),this._element.focus())};fa.Xx=function(){Gb.a.Xx(xa.AFrameworkApplication.isRtl)};fa.$9c=function(){return new fa(xa.AFrameworkApplication.Hb,Ha.a.instance,Ra.KeyInputManager.instance,ua.a.instance,xa.AFrameworkApplication.zl,fa.Xx,db.a.Z2i,db.a.BLg,qb.a.instance.yc("Common.App.Header.HeaderEventSource"),Ta.a.$G,
Ta.a.hh,Ta.a.Pf)};Jl.Object.defineProperties(fa.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return"true"===this._element.getAttribute("contentEditable")}}});Object(D.a)(fa,"RenameUIHandler",null,[272]);Jl.Object.defineProperties(T,{instance:{configurable:!0,enumerable:!0,get:function(){return xa.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled?T.Pa||(T.Pa=Y.$9c()):T.Pa||(T.Pa=fa.$9c())}}});T.Pa=null;Object(D.a)(T,"RenameUIHandlerFactory",null,[]);var za=b(93);Object(D.a)(N,
"RenameMruEntryProperties",null,[]);var Ia=b(523),va=b(177),Ua=b(678),Kb;(function(eb){eb[eb.unknown=-1]="unknown";eb[eb.success=0]="success";eb[eb.renameInvalidFileName=1]="renameInvalidFileName";eb[eb.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";eb[eb.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";eb[eb.permissionDenied=4]="permissionDenied";eb[eb.serverCommunicationFailure=5]="serverCommunicationFailure";eb[eb.fileNameTooLong=6]="fileNameTooLong"})(Kb||(Kb={}));Object(D.b)("CommonOperationResult",
Kb);S.prototype.Rg=function(){xa.AFrameworkApplication.za&&xa.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled||this.Bi.$b(sb.a.Zub,ib.a.frame,Object(R.a)(this,this.Zub,"initializeRenameUIHandler"));this.Bi.$b(sb.a.mab,ib.a.frame,Object(R.a)(this,this.mab,"showRenameDisabledDialog"));this.Bi.$b(sb.a.renameFile,ib.a.frame,Object(R.a)(this,this.renameFile,"renameFile"));this.Bi.Jf(sb.a.fileNameUpdate,ib.a.frame,Object(R.a)(this,this.iPi,"refreshFilename"),64);this.Bi.Jf(sb.a.Dgc,ib.a.frame,
Object(R.a)(this,this.Dgc,"moveToFolderCompleteByHost"),64);this.Bi.$b(sb.a.hMa,ib.a.frame,Object(R.a)(this,this.hMa,"moveToFolder"));xa.AFrameworkApplication.za&&(xa.AFrameworkApplication.ha.ta("PostMessageEmbedded")||xa.AFrameworkApplication.ha.ta("IsJsApi"))&&xa.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&xa.AFrameworkApplication.$Y().execute(function(eb){eb.vn(va.a.vgf);eb.km(va.a.vgf,S.gOi);eb.vn(va.a.D5c);eb.km(va.a.D5c,S.eOi)})};S.prototype.h4a=
function(){return this.hig.LTe()?8:32};S.prototype.Nzj=function(){return this.uy?this.Zpa?this.uy.tAe:this.uy.Irb:!0};S.prototype.Zub=function(){return T.instance.initialize(xa.AFrameworkApplication.h5b,xa.AFrameworkApplication.SZa,xa.AFrameworkApplication.FCd||CommonUIStrings.l_RenameFileTooltip)?32:8};S.prototype.mab=function(){var eb=this.Nzj(),xb=this.Olg();ha.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.wCa,xb,eb,this.Zpa);xa.AFrameworkApplication.za&&xa.AFrameworkApplication.za.Za.Ju&&xa.AFrameworkApplication.ha.ta("ReactRenameDisabledDialogIsEnabled")?new ea(this.wCa,!xb,!eb,this.Zpa,this.Hoa()):new L(this.wCa,!xb,!eb,this.Zpa,this.Hoa());return 32};S.prototype.renameFile=function(eb,xb,dc,Nc,Pc){if(1===dc)return this.h4a();if(!xa.AFrameworkApplication.E4b)return 8;if(8===this.h4a())return this.Bi.processAction(sb.a.mab,2),8;ha.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");xa.AFrameworkApplication.E4b(Pc,
Object(R.a)(this,this.pBb,"onRenameFileSuccess"),Object(R.a)(this,this.Kxi,"onRenameFileFailure"));return 32};S.prototype.pBb=function(eb,xb){eb?eb.OperationResult?this.zXe(eb.OperationResult):(this.t4i(xb,eb.NewName),this.xvj(eb,Object(R.a)(xa.AFrameworkApplication.za.Za,xa.AFrameworkApplication.za.Za.$2f,"updateOpenInClientDocumentUrl")),xa.AFrameworkApplication.ha.ta("DocumentNameInJewelInfoMenuIsEnabled")&&xa.AFrameworkApplication.za.updateCommandUI(),this.iig.I1f()):this.zXe(5)};S.prototype.t4i=
function(eb,xb){var dc={};dc[Ia.a.blh]=xb;eb.Yj(va.a.D5c,dc)};S.prototype.xvj=function(eb,xb){this.Ivj(eb);xa.AFrameworkApplication.j2b=eb.DirectInvokeDavUrl;xb=xb(eb.EditDocInClientUrl);var dc=new N;dc.ski=this.sv.zn;dc.nZg=xb;dc.oki=eb.EditDocInClientUrl;this.Bi.Pe(sb.a.renameMostRecentlyUsedFileEntry,2,dc)};S.prototype.zXe=function(eb){switch(eb){case 1:eb=new oa.StandardDialog,eb.lc=0,eb.qW(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.RIf()}};
S.prototype.Ivj=function(eb){this.sv.zn=S.kxg(this.sv.zn,eb.NewName);eb.BreadcrumbFolderName&&(this.sv.breadcrumbFolderName=eb.BreadcrumbFolderName);eb.BreadcrumbFolderUrl&&(this.sv.breadcrumbFolderUrl=eb.BreadcrumbFolderUrl);this.xae(eb.NewName)};S.prototype.Kxi=function(eb){var xb=new oa.StandardDialog;xb.lc=0;switch(eb){case 1:ha.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");xb.hza(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);
break;case 6:ha.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");xb.hza(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:var dc={};ha.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",(dc.Result=eb,dc));xb.hza(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}xa.AFrameworkApplication.$Y().execute(function(Nc){var Pc={};Nc.Yj(va.a.alh,(Pc.FailureMessage=Kb[eb],Pc))});
this.RIf()};S.prototype.iPi=function(eb,xb,dc){if(1===dc)return this.h4a();if(!xa.AFrameworkApplication.xHa)return 8;xa.AFrameworkApplication.xHa(Object(R.a)(this,this.Zic,"onRefreshFilenameSuccess"),Object(R.a)(this,this.Yic,"onRefreshFilenameFailure"),!1);return 32};S.prototype.hMa=function(eb,xb,dc,Nc,Pc){if(1===dc)return xa.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DTTMoveButton",!1)&&xa.AFrameworkApplication.ha.ta("UiHostSupportsMoveToFolder")?32:8;if(2===
dc){var Fd={};eb=xa.AFrameworkApplication.Lja;xb=xa.AFrameworkApplication.ha.ta("UiHostSupportsDocRebootFeatures");eb=(!eb||eb&&xb)&&xa.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Fd[Ia.a.Kmj]=eb;Pc&&Pc.MoveButtonClickedTime&&(Fd[Ia.a.Rii]=Pc.MoveButtonClickedTime.getTime());xa.AFrameworkApplication.$Y().execute(function(Ea){Ea.Yj(va.a.hMa,Fd)});if(Pc&&Pc.MoveButtonClickedTime){if(eb=this.xs())Pc=(new Date).getTime()-Pc.MoveButtonClickedTime.getTime(),
eb.set("MovePostDuration",Pc.toString());za.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",eb)}return 32}return 8};S.prototype.Dgc=function(eb,xb,dc,Nc,Pc){if(1===dc)return xa.AFrameworkApplication.ha.ta("UiHostSupportsMoveToFolder")?this.h4a():8;if(2===dc){if(!xa.AFrameworkApplication.kMf)return za.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Pc)return za.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",
!1,!1,null),8;if(Pc[Ia.a.l0h])if(Pc[Ia.a.T3f])if(eb=Pc[Ia.a.T3f].toLowerCase(),xb=xa.AFrameworkApplication.ha.ta("UiHostSupportsDocRebootFeatures"),dc=xa.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),xb&&xa.AFrameworkApplication.Lja&&dc){var Fd={};Fd[Ia.a.TNa]="1";Fd[Ia.a.documentUrl]=eb;Fd[Ia.a.reason]=Ua.a.saveAs;za.Health.instance.recordKpiSuccess("MoveToFolder",null);xa.AFrameworkApplication.$Y().execute(function(Ea){Ea.Yj(va.a.tsa,Fd)})}else if(!xa.AFrameworkApplication.Lja&&
dc)za.Health.instance.recordKpiSuccess("MoveToFolder",null),db.a.wf(eb,db.a.JW(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return za.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else za.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else xa.AFrameworkApplication.xHa(Object(R.a)(this,this.Zic,"onRefreshFilenameSuccess"),Object(R.a)(this,this.Yic,"onRefreshFilenameFailure"),!1),xa.AFrameworkApplication.kMf(),za.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32};S.prototype.Gej=function(eb,xb){return eb&&xb?eb!==this.sv.breadcrumbFolderName||xb!==this.sv.breadcrumbFolderUrl:!1};S.prototype.Zic=function(eb,xb){eb&&(eb.NewName!==Oa.a.Pq(this.sv.zn)||this.Gej(eb.BreadcrumbFolderName,eb.BreadcrumbFolderUrl))&&this.pBb(eb,xb)};S.prototype.Yic=function(){};S.prototype.RIf=function(){this.xae(Oa.a.Pq(this.sv.zn))};S.prototype.xs=function(){try{return new Map}catch(eb){return null}};S.Jrb=function(){return new S(xa.AFrameworkApplication.i4a,new ba.a(function(){return xa.AFrameworkApplication.Hb}),
new ba.a(function(){return xa.AFrameworkApplication.uy}),xa.AFrameworkApplication.zl,xa.AFrameworkApplication.limitedEdit,function(){return xa.AFrameworkApplication.userCanRename},xa.AFrameworkApplication.xnc,Object(R.a)(T.instance,T.instance.HW,"updateTitle"),qb.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),function(){return xa.AFrameworkApplication.isReadOnlyRecommended},xa.AFrameworkApplication.ha,qb.a.instance.resolve("Common.IRenameProps"))};S.kxg=function(eb,xb){eb=Oa.a.I$(eb);
return xb+eb};S.gOi=function(eb){var xb=eb.Values[Ia.a.z3h];ha.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",xb);xb?xa.AFrameworkApplication.Hb.Pe(sb.a.Dgc,2,eb.Values):za.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)};S.eOi=function(eb){xa.AFrameworkApplication.Hb.Pe(sb.a.renameFile,2,eb.Values.NewName)};Jl.Object.defineProperties(S.prototype,{Bi:{configurable:!0,enumerable:!0,get:function(){return this.Oa.value}},uy:{configurable:!0,
enumerable:!0,get:function(){return this.FAc.value}}});Jl.Object.defineProperties(S,{instance:{configurable:!0,enumerable:!0,get:function(){return S.Pa||(S.Pa=S.Jrb())}}});S.Pa=null;Object(D.a)(S,"RenameActor",null,[]);b(922);Object(D.a)(function(){},"ActivityEventName",null,[]);W.compatMode="CompatMode";W.noSelection="NoSelection";Object(D.a)(W,"ActivityEventReason",null,[]);var ia=b(677);H.prototype.Rg=function(){this.Oa.$b(sb.a.UTf,ib.a.frame,Object(R.a)(this,this.thj,"showRenameDialogAction"))};
H.prototype.thj=function(eb,xb,dc){eb=32;if(1===dc)return ia.SessionStatusManager.instance.Ftb||xa.AFrameworkApplication.NU?8:32;2===dc&&(32!==this.Oa.processAction(sb.a.renameFile,1)?(this.Oa.processAction(sb.a.mab,2),eb=8):32===this.Oa.processAction(sb.a.FKd,1)?this.Oa.processAction(sb.a.FKd,2):this.eTa.value.create().dsc());return eb};Object(D.a)(H,"RenameDialogActor",null,[262]);C.prototype.oGh=function(){var eb={},xb={};eb.nameInputProps=(xb.type="AppInputProps",xb.id=C.RZa,xb.label=CommonUIStrings.l_RenameDialogLabel,
xb.value=Oa.a.Pq(this.sv.zn),xb.maxLength=this.voa,xb);return eb};C.prototype.dsc=function(){var eb=this.oGh(),xb={};eb=(xb.id="RenameDialog",xb.bodyControls=eb,xb);this.dialog=new ma.a(!1,!1,!0);this.dialog.lc=1;this.dialog.We="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(R.a)(this,this.DCd,"renameDialogHandler"),eb)};C.prototype.DCd=function(eb,xb){xb&&1===eb&&xb[C.RZa]&&(eb=Oa.a.Pq(this.sv.zn),xb=(xb[C.RZa]||"").trim(),xb!==eb&&""!==xb&&this.Oa.Pe(sb.a.renameFile,
2,xb))};C.RZa="txtDocumentName";Object(D.a)(C,"ReactRenameDialog",null,[273]);Jl.Object.defineProperties(B,{Mf:{configurable:!0,enumerable:!0,get:function(){return ma.a.jj(B.Oj,CommonUIStrings.l_RenameDialogLabel)}}});B.Oj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(D.a)(B,"RenameDialogHtml",null,[]);var E=
ma.a;Cm(J,E);J.prototype.dsc=function(){var eb={};eb=(eb.txtDocumentName=Oa.a.Pq(this.sv.zn),eb);this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(R.a)(this,this.DCd,"renameDialogHandler"),eb);eb=document.getElementById(J.RZa);0<this.voa&&(eb.maxLength=this.voa);eb.focus()};J.prototype.DCd=function(eb,xb){1===eb&&(eb=Oa.a.Pq(this.sv.zn),xb=(xb[J.RZa]||"").trim(),xb!==eb&&""!==xb&&this.Oa.Pe(sb.a.renameFile,2,xb))};J.RZa="txtDocumentName";Object(D.a)(J,"RenameDialog",ma.a,[273]);z.prototype.initialize=
function(eb,xb){this.H7=eb;this.voa=xb;this._initialized=!0};z.prototype.create=function(){return this._initialized?xa.AFrameworkApplication.za&&xa.AFrameworkApplication.za.Za.Ju&&xa.AFrameworkApplication.ha.ta("ReactRenameDialogIsEnabled")?new C(this.Oa,this.H7,this.voa):new J(this.Oa,this.H7,this.voa):null};Object(D.a)(z,"RenameDialogFactory",null,[261]);var fb=b(242);x.prototype.Rg=function(){this.Oa.$b(sb.a.FKd,ib.a.frame,Object(R.a)(this,this.uhj,"showRenameFlyoutAction"))};x.prototype.FHg=function(){return fb.appChromeContainsAction("setDocumentTitleFlyoutOpened")&&
xa.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled};x.prototype.uhj=function(eb,xb,dc){if(1===dc)return this.FHg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32};Object(D.a)(x,"RenameFlyoutActor",null,[259]);y.prototype.LTe=function(){if(!this.z1d())return 5;if(this.Hoa())return 1;if(this.uy){if(this.A1d&&!this.uy.tAe)return 3;if(!this.A1d&&!this.uy.Irb)return 4}return this.Slg()?0:2};Jl.Object.defineProperties(y.prototype,{uy:{configurable:!0,
enumerable:!0,get:function(){return this.FAc.value}}});Object(D.a)(y,"RenameProps",null,[258]);b(210);var Za=b(107);A.prototype.enable=function(){this.rl||(this.I1f(),this.$Ld(),this.rl=!0)};A.prototype.generateKey=function(eb,xb,dc){return String.format("{0}/{1}/{2}",dc,eb,xb)};A.prototype.LBh=function(){var eb=Oa.a.Pq(this.kTa().zn);return this.generateKey(this.kTa().breadcrumbFolderName,this.kTa().breadcrumbFolderUrl,eb)};A.prototype.MBh=function(eb,xb,dc){return eb&&xb?this.generateKey(eb,xb,
dc):dc};A.prototype.G2g=function(eb,xb,dc){return eb&&eb!==this.kTa().breadcrumbFolderName||xb&&xb!==this.kTa().breadcrumbFolderUrl?!0:dc!==Oa.a.Pq(this.kTa().zn)};A.prototype.I1f=function(){var eb=this.LBh();this.zGc.ja(eb,new Date)};A.prototype.hwd=function(eb){this.pdj(eb)&&this.Hbe(eb)};A.prototype.pdj=function(eb){var xb=this.Y$f();return xb?this.f$d&&this.f$d.dwb||!xb.I4e||!xa.AFrameworkApplication.xHa?(this.jWf(eb),this.rl=!1):!0:!1};A.prototype.Usf=function(eb,xb,dc,Nc){var Pc=this.G2g(eb,
xb,dc);eb=this.MBh(eb,xb,dc);xb=this.zGc.Ec(eb).returnValue;Pc&&!xb&&(this.AXe(Nc),ha.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Dnd));Pc||this.zGc.ja(eb,this.aL())};Object(D.a)(A,"ARenamedFileChecker",null,[232]);Cm(v,A);v.prototype.$Ld=function(){this.t7d.CPc(Object(R.a)(this,this.gYe,"handleSettingsRefresh"))};v.prototype.gYe=function(eb,xb){xb&&xb.zzb&&xb.tni&&(xb.r4a("BreadcrumbDocName")||xb.r4a("BreadcrumbFolderName")||xb.r4a("BreadcrumbFolderUrl")||xb.r4a("DirectInvokeDAVUrl")||
xb.r4a("EditDocInClientUrl"))&&(ha.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Dnd),this.hwd(xb))};v.prototype.jWf=function(){this.t7d.MUi(Object(R.a)(this,this.gYe,"handleSettingsRefresh"))};v.prototype.Hbe=function(eb){if(eb&&eb.zzb){var xb=eb.zzb;this.Usf(xb.Wa("BreadcrumbFolderName"),xb.Wa("BreadcrumbFolderUrl"),xb.Wa("BreadcrumbDocName"),eb)}};v.prototype.AXe=function(eb){var xb=this,dc={OperationResult:0,classId:1};eb=eb.zzb;dc.BreadcrumbFolderName=eb.Wa("BreadcrumbFolderName");
dc.BreadcrumbFolderUrl=eb.Wa("BreadcrumbFolderUrl");dc.DirectInvokeDavUrl=eb.Wa("DirectInvokeDAVUrl");dc.EditDocInClientUrl=eb.Wa("EditDocInClientUrl");eb=eb.Wa("BreadcrumbDocName");dc.NewName=xa.AFrameworkApplication.TGa?eb:Oa.a.Pq(eb);this.Jdg.execute(function(Nc){xb.$Yh(dc,Nc)})};v.prototype.$Yh=function(eb,xb){this.gig().pBb(eb,xb)};Jl.Object.defineProperties(v.prototype,{Dnd:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingSettingsRefresh"}}});Object(D.a)(v,"RenamedFileCheckerUsingSettingsRefresh",
A,[]);var ec=b(112);Cm(w,A);w.prototype.fRi=function(eb){this.VTb=eb;this.VTb.Ntg(Object(R.a)(this,this.ocd,"handleVisibilityChange"))};w.prototype.ocd=function(eb,xb){!this.rl||xb.newState&&1!==xb.newState||this.fib||(this.$Ld(),this.hwd(this.fib))};w.prototype.$Ld=function(){this.fib=new ec.a(3,2,this.phg(),Object(R.a)(this,this.hwd,"performRenameFileCheckTick"),89);this.re.sh(this.fib)};w.prototype.jWf=function(eb){this.re.xp(eb)};w.prototype.Hbe=function(eb){this.VTb&&2===this.VTb.zEj?this.bSi(eb):
xa.AFrameworkApplication.xHa(Object(R.a)(this,this.Zic,"onRefreshFilenameSuccess"),Object(R.a)(this,this.Yic,"onRefreshFilenameFailure"),!0)};w.prototype.bSi=function(eb){this.re.xp(eb);this.fib=null};w.prototype.Zic=function(eb){eb&&this.Usf(eb.BreadcrumbFolderName,eb.BreadcrumbFolderUrl,eb.NewName,null)};w.prototype.AXe=function(){this.Oa.processAction(sb.a.fileNameUpdate,2)};w.prototype.Yic=function(){};Jl.Object.defineProperties(w.prototype,{Dnd:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingTask"}}});
Object(D.a)(w,"RenamedFileCheckerUsingTask",A,[]);u.prototype.$h=function(eb){var xb=this;this.pb=eb;this.yb=xa.AFrameworkApplication.ha;this.pb.register(H,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Lc(function(){return new H(xa.AFrameworkApplication.Hb,xb.pb.WDd("Common.App.Rename.IRenameDialogFactory"))}).Ac();this.pb.register(z,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Lc(function(){return new z(xa.AFrameworkApplication.Hb)}).Ac();
this.pb.register(232,"Common.App.Rename.IRenamedFileChecker").Lc(function(){return xb.XWg()}).Ac();this.pb.register(x,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Lc(function(){return new x(xa.AFrameworkApplication.Hb)}).Ac()};u.prototype.XWg=function(){var eb=this;if(this.yb.ta("RenamedFileCheckerWithSettingsRefreshIsEnabled")){var xb=this.pb.Uh("Common.IRefreshableAppSettings");if(xb&&xb.Z4h)return new v(function(){return xb.qd("RenamedFileCheckerMaxCachedAgeInMs",
48E4)},function(){return xa.AFrameworkApplication.zl},function(){return new Date},function(){return xa.AFrameworkApplication.uy},xb,this.pb.Uh("Common.ISessionStatus"),function(){return S.instance},this.pb.yc("Postmessage.IHostPostmessenger"))}return new w(function(){return eb.yb.qd("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return eb.yb.qd("RenamedFileCheckerPingIntervalInMs",12E4)},function(){return xa.AFrameworkApplication.zl},function(){return new Date},function(){return xa.AFrameworkApplication.uy},
xa.AFrameworkApplication.ha,xa.AFrameworkApplication.Hb,xa.AFrameworkApplication.$j,this.pb.Uh("Common.ISessionStatus"),this.pb.yc("Common.App.VisibilityManagement.IVisibilityManager"))};u.prototype.init=function(){this.yb.Xv(Object(R.a)(this,this.HA,"onFullAppSettingsReady"))};u.prototype.HA=function(){var eb=xa.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled;xa.AFrameworkApplication.i4a()&&T.instance.initialize(xa.AFrameworkApplication.h5b,eb?null:xa.AFrameworkApplication.SZa,eb?null:xa.AFrameworkApplication.FCd||
CommonUIStrings.l_RenameFileTooltip)&&(this.pb.register(y,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Lc(function(){return new y(function(){return xa.AFrameworkApplication.userCanRename},function(){return xa.AFrameworkApplication.isReadOnlyRecommended},xa.AFrameworkApplication.xnc,xa.AFrameworkApplication.i4a,new ba.a(function(){return xa.AFrameworkApplication.uy}))}).Ac(),S.instance.Rg(),this.yb.ta("RenameDialogIsEnabled")&&(this.pb.resolve("Common.App.Rename.RenameDialogFactory").initialize(xa.AFrameworkApplication.zl,
xa.AFrameworkApplication.h5b),this.pb.resolve("Common.App.Rename.IRenameDialogActor").Rg()),this.pb.resolve("Common.App.Rename.IRenameFlyoutActor").Rg(),xa.AFrameworkApplication.xnc&&this.pb.resolve("Common.App.Rename.IRenamedFileChecker").enable())};u.prototype.dispose=function(){};Jl.Object.defineProperties(u.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.RenameFile"}}});Object(D.a)(u,"PackageManager",null,[8,9]);F=b(274);var zc=b(12),Ab=b(800),vb=b(58),kc=b(35),
td=b(57),Oc=b(172),tc=b(52);k.prototype.executeCommand=function(eb,xb,dc){switch(xb.command){case sb.a.Tga:return td.a.Nf.isReactSharedHeaderUxEnabled?2!==xa.AFrameworkApplication.Hb.Pe(sb.a.Tga,2,dc)?tc.Task.Ua(!0):Oc.a(xb.command):Oc.a(xb.command);case 1897077126:return this.renameFileManager.renameFile(dc,xb),tc.Task.Ua(!0);default:return Oc.a(xb.command)}};k.prototype.Jc=function(eb,xb,dc,Nc){switch(xb.command){case sb.a.Tga:return td.a.Nf.isReactSharedHeaderUxEnabled;case 1897077126:return!!Nc&&
2===Nc.Wz}return!1};k.prototype.gd=function(){return!1};k.prototype.$c=function(){return!1};k.prototype.dispose=function(){this.renameFileManager=null};Object(D.a)(k,"RenameFileCommandHandler",null,[159,7]);var sc=Ab.a;Cm(t,sc);t.prototype.Rd=function(){var eb=this,xb=vb.GetServiceTaskFactory.create(this.$.ea,119,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RenameFile.IRenameFileManager");kc.TaskExtensions.Da(xb,function(){eb.Hd([new k(xb.result)])},this.ma,3)};t.la=function(eb){Ab.a.ie(118,
new t(eb))};Object(D.a)(t,"RenameFileCommandHandlerFactory",Ab.a,[]);var ic=b(86),Ga=b(211),cb=b(218),Tb=b(74),Bb=b(374),nc=b(79),Gc=b(365),La=b(160),Wa=b(92),wa=b(303),Da=b(1),Va=b(7),Jb=b(273);Jl.Object.defineProperties(r.prototype,{I4e:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FileCoauthorable}},dwb:{configurable:!0,enumerable:!0,get:function(){return!1}},Irb:{configurable:!0,enumerable:!0,get:function(){return this.$.fa.amIAlone}},tAe:{configurable:!0,enumerable:!0,
get:function(){if(this.Irb)return!0;for(var eb=Ml(this.$.fa.Lm),xb=eb.next();!xb.done;xb=eb.next())if(!xb.value.SupportsRename)return!1;return!0}}});Object(D.a)(r,"EwaCoauthManager",null,[603]);var Hb=b(81),Mb=b(64),Ub=Tb.a;Cm(m,Ub);m.prototype.initialize=function(){xa.AFrameworkApplication.E4b=Object(R.a)(this,this.rri,"onExecuteRenameFile");xa.AFrameworkApplication.xHa=Object(R.a)(this,this.qri,"onExecuteRefreshFilename");this.e0c=xa.AFrameworkApplication.uy;xa.AFrameworkApplication.uy=new r(this.$)};
m.prototype.dispose=function(){xa.AFrameworkApplication.E4b=null;xa.AFrameworkApplication.xHa=null;this.$.fa.ow(Object(R.a)(this,this.Nia,"handleWorkbookMetadataChanged"));xa.AFrameworkApplication.uy=this.e0c;this.$=this.e0c=null;Ub.prototype.dispose.call(this)};m.prototype.Nia=function(){var eb=this.$.fa.Gn;if(eb&&!Va.a.na(eb.WorkbookFileName)){var xb=Oa.a.Pq(eb.WorkbookFileName),dc=!!Va.a.compare(this.$.workbookContext.WorkbookFileName,eb.WorkbookFileName,!1),Nc=Da.EwaSettings.ka(576)&&!Va.a.na(eb.BreadcrumbFolderUrl)&&
!!Va.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,eb.BreadcrumbFolderUrl,!1);if(dc||Nc)this.bca={},this.bca.NewFileName=xb,this.bca.EditDocInClientUrl=eb.EditDocInClientUrl,this.bca.DirectInvokeDAVUrl=eb.DirectInvokeDAVUrl,this.bca.DownloadACopyUrl=eb.DownloadACopyUrl,Da.EwaSettings.ka(576)&&!Va.a.na(eb.BreadcrumbFolderUrl)&&(this.bca.BreadcrumbFolderName=eb.BreadcrumbFolderName,this.bca.BreadcrumbFolderUrl=eb.BreadcrumbFolderUrl),eb=xa.AFrameworkApplication.Hb.Pe(sb.a.fileNameUpdate,
2,xb),this.bca=null,ha.ULS.shipAssertTag(42258589,0,32===eb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};m.prototype.renameFile=function(eb,xb){var dc=this,Nc=eb.newFileName;if(!Va.a.na(Nc)){var Pc=this.$.ra.xa.dc();Gc.a(this.$.userOperationManager,function(Fd,Ea,Xa){var hc=dc.$.ra.xa;Fd=Jb.b(Fd,Object(R.a)(dc,dc.pBb,"onRenameFileSuccess"));Ea=Jb.a(Ea,Object(R.a)(dc,dc.Jxi,"onRenameFileFail"));var Xb=hc.Ra(9,Pc);Xb.newFileName=Nc;return Hb.i(hc,"RenameFile",Xb,
Fd,Ea,Xa,null,0)},function(Fd){return new La.a(134,0,Fd)},xb)}};m.prototype.X_h=function(){return 32===xa.AFrameworkApplication.Hb.processAction(sb.a.Tga,1)};m.prototype.rri=function(eb,xb,dc){this.lGf=xb;this.ECd=dc;xb={};this.$.Na.Xb(new Wa.a(1897077126,nc.a.Yb,2,3,null),(xb.newFileName=eb,xb))};m.prototype.qri=function(eb){this.bca&&eb(this.MTe(this.bca),this.Ir)};m.prototype.pBb=function(eb){wa.a(eb)||!eb.Result?(eb=m.Urh(eb),Mb.a(this.$).ld.Wjb([-414480287,650565124,-782844485,1223808266,-62451516,
1636785843]),this.ECd(eb)):this.lGf(this.MTe(eb.Result),this.Ir)};m.prototype.MTe=function(eb){var xb=this.$.workbookContext;xa.AFrameworkApplication.X2=eb.DownloadACopyUrl;var dc=Da.EwaSettings.ka(576)&&!Va.a.na(eb.BreadcrumbFolderUrl);dc&&(xa.AFrameworkApplication.zl.breadcrumbFolderName=eb.BreadcrumbFolderName,xa.AFrameworkApplication.zl.breadcrumbFolderUrl=eb.BreadcrumbFolderUrl,xb.FullDocumentInfo.BreadcrumbFolderUrl=eb.BreadcrumbFolderUrl,xb.FullDocumentInfo.BreadcrumbFolderName=eb.BreadcrumbFolderName);
xb.FullDocumentInfo.BreadcrumbDocName=eb.NewFileName;Bb.d(xb,eb.NewFileName);xb={};xb.NewName=eb.NewFileName;xb.DirectInvokeDavUrl=eb.DirectInvokeDAVUrl;xb.EditDocInClientUrl=eb.EditDocInClientUrl;dc&&(xb.BreadcrumbFolderName=eb.BreadcrumbFolderName,xb.BreadcrumbFolderUrl=eb.BreadcrumbFolderUrl);xb.OperationResult=0;return xb};m.prototype.Jxi=function(){this.ECd(5)};m.Urh=function(eb){switch(eb.Errors[0].MessageId){case -414480287:eb=2;break;case 650565124:eb=1;break;case 1636785843:eb=6;break;case -782844485:eb=
4;break;default:eb=5}return eb};Object(D.a)(m,"RenameFileManager",Tb.a,[589,7]);var pb=b(50),gb=Ga.a;Cm(c,gb);c.prototype.create=function(){var eb=this;if(!this.oY){var xb=cb.a.dZa(pb.b(),this.ma,"Task","IRenameFileManager");this.oY=xb.task;var dc=vb.GetServiceTaskFactory.create(this.$.ea,137,this.ma,this.vb,"Postmessage.IHostPostmessenger"),Nc=vb.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary");kc.TaskExtensions.Da(kc.TaskExtensions.Fe([Nc,dc],this.ma),function(){var Pc=
new m(eb.$,dc.result);eb.$.ea.La(120,Pc);xb.setResult(Pc)},this.ma,3)}this.oY.continueWith(function(Pc){eb.Jb(Pc.result)})};c.prototype.dispose=function(){ic.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;gb.prototype.dispose.call(this)};c.la=function(eb){eb.ea.La(119,new c(eb))};Object(D.a)(c,"RenameFileManagerServiceFactory",Ga.a,[]);d.prototype.$c=function(){return!1};d.prototype.executeCommand=function(eb,xb,dc){return 2!==this.Bi.Pe(sb.a.UTf,2,dc)?tc.Task.Ua(!0):Oc.a(xb.command)};
d.prototype.Jc=function(eb,xb){return 1204860550===xb.command};d.prototype.gd=function(){return!1};Object(D.a)(d,"RenameFileDialogCommandHandler",null,[159]);var Qa=Ab.a;Cm(a,Qa);a.prototype.Rd=function(){var eb=this;kc.TaskExtensions.Da(vb.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){eb.Hd([new d(xa.AFrameworkApplication.Hb)])},this.ma,3)};a.la=function(eb){Ab.a.ie(131,new a(eb))};Object(D.a)(a,"RenameFileDialogCommandHandlerFactory",Ab.a,[]);Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.Rename");F.a.instance.oj(new u,7);(function(){zc.a.Ja(function(eb){c.la(eb);t.la(eb)})})();zc.a.Ja(a.la)}}]);

//# sourceMappingURL=EwaDS.rn.js.map