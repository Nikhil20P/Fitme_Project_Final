(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1119:function(D,F,b){function a(r,t){r=m.call(this,r,t)||this;t!==c.a.U8&&r.XDa(t);r.Jfa(a.iterateNext);r.Jfa(a.Mva);r.iOc(d.a.URa);r.iOc(d.a.VRa);return r}b.d(F,"a",function(){return a});D=b(0);var d=b(177);F=b(1232);var c=b(872),m=F.a;Cm(a,m);a.iterateNext="IterateNext";a.Mva="IteratePrevious";a.FJb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.SMa=
"OnVHDiffReady";Object(D.a)(a,"VersionHistoryMessenger",F.a,[])},1235:function(D,F,b){function a(ja,R,ba,ha){this.authorColor=this.n1=this.lna=null;this.z4a=!1;this.QZf=0;this.sZa=-1;this.n_c=0;this.BGa=100;this.Pja=-1;this.SRd=null;this.Plb=w.a.jBj;this.Gxe=w.a.kBj;c.ULS.sendTraceTag(41743366,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=ja;this.ariaLiveNotifier=ha;this.gridView=fa.g(this.$);this.gridView.ga.$F(Object(t.a)(this,this.nd,"onSelectionChanged"));this.gridView.AD(Object(t.a)(this,
this.Uo,"onCurrentSelectionModeChanged"));this.gridView.Hc.Cm(Object(t.a)(this,this.tk,"onEditStarted"));this.exj();R&&(this.SRd=ja.Zb.Ic("UserAction","VersionHistoryDiffManagerStopWatch"),this.fPd());if(this.Ir=ba)ja=m.a.K$(this.$.Ba.VersionHistoryActionUrl)||ea.a.U8,ja!==ea.a.U8&&this.Ir.XDa(ja),this.Ir.vn(L.a.iterateNext),this.Ir.vn(L.a.Mva),this.Ir.vn(L.a.FJb),this.Ir.km(L.a.iterateNext,Object(t.a)(this,this.dld,"iterateMessageHandler")),this.Ir.km(L.a.Mva,Object(t.a)(this,this.dld,"iterateMessageHandler")),
this.Ir.km(L.a.FJb,Object(t.a)(this,this.dld,"iterateMessageHandler"))}function d(ja,R,ba){this.UDa=ja;this.Em=R;this.Ewc=ba}D=b(0);var c=b(15),m=b(75),r=b(944),t=b(37),k=b(82),u=b(210),w=b(10),v=b(198),A=b(63),y=b(46),x=b(519),z=b(160),J=b(109),B=b(303),C=b(1),H=b(9),W=b(95),S=b(7),N=b(16),T=b(273);b(106);var fa=b(20),Y=b(334);Object(D.a)(d,"UserActivityLocation",null,[]);var L=b(1119),P=b(81),ea=b(872),X=b(52);b.d(F,"a",function(){return a});a.prototype.dispose=function(){this.dya();this.lna=this.n1=
null;this.gridView&&(this.gridView.ga&&this.gridView.ga.bF(Object(t.a)(this,this.nd,"onSelectionChanged")),this.gridView.aF(Object(t.a)(this,this.Uo,"onCurrentSelectionModeChanged")),this.gridView.Hc&&this.gridView.Hc.mm(Object(t.a)(this,this.tk,"onEditStarted")),this.Ir&&(this.Ir.cna(L.a.Mva),this.Ir.cna(L.a.iterateNext),this.Ir.cna(L.a.FJb)))};a.prototype.initialize=function(ja,R){ja?(this.dya(),this.sZa=-1,this.lna=[],this.z4a=!1,this.n1={},this.authorColor={},this.Mfi(R),this.WZc(ja)):c.ULS.shipAssertTag(40944519,
0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.fPd=function(){function ja(ba,ha,oa){var Sa=R.$.ra.xa;ba=T.b(ba,Object(t.a)(R,R.Zh,"onWebMethodSuccess"));ha=T.a(ha,Object(t.a)(R,R.lxa,"onWebMethodFailure"));var ma=Sa.Ra(1,null);return P.i(Sa,"GetVersionHistoryHighlightActivitiesData",ma,ba,ha,oa,null,4)}var R=this;c.ULS.sendTraceTag(41743367,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.n_c.toString(),
this.BGa.toString());this.n_c++;C.EwaSettings.wc()?this.$.userOperationManager.oc(new z.a(537,0,ja,80),null):this.$.userOperationManager.oc(new x.a(537,0,ja,16),null)};a.prototype.Zh=function(ja){var R=this;(ja=B.a(ja)?null:ja.Result)?ja.OperationWaitingForFileDownload?20>this.n_c?(this.BGa*=2,X.Task.delay(this.BGa).continueWith(function(){R.fPd()})):(this.Wvc(),c.ULS.sendTraceTag(41743371,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):ja.ActivityList?(this.initialize(ja.ActivityList,
ja.VersionAuthors),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.SMa():this.ssc(!0),this.SRd.stop(),c.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",this.SRd.Gc.toString())):(this.Wvc(),c.ULS.sendTraceTag(41743370,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(this.BGa*=2,X.Task.delay(this.BGa).continueWith(function(){R.fPd()}),c.ULS.sendTraceTag(41743368,
0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};a.prototype.lxa=function(){this.Wvc();c.ULS.sendTraceTag(41743372,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};a.prototype.ssc=function(ja){var R=this.n1,ba;for(ba in R){var ha=ba,oa=R[ba];oa?oa.$Hb(ja):c.ULS.shipAssertTag(41244700,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+ha+"view was Null")}};a.prototype.dya=function(){var ja=this.n1,R;for(R in ja){var ba=
R,ha=ja[R];ha?ha.dSi():c.ULS.shipAssertTag(41244701,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+ba+"view was Null")}this.lna=this.n1=null};a.prototype.LLf=function(ja){var R=this.GDh(ja,this.sZa);var ba=R.P0e;ja=R.j4f;R.returnValue&&(c.ULS.shipAssertTag(41976982,0,!!ja,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.T1b(),ja.UDa.toString()in this.n1?(this.n1[ja.UDa.toString()].k3i(ja.Em),R=y.D(ja.Em),this.ariaLiveNotifier.setEnabled(!1),
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(N.a.instance.Eb(156),ba+1,this.pR.length,R.GG(!1),ja.Ewc.DisplayName)),this.sZa=ba):c.ULS.shipAssertTag(41976983,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",ja.UDa.toString())))};a.prototype.dld=function(ja){c.ULS.sendTraceTag(50405838,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ja.MessageId);switch(ja.MessageId){case L.a.iterateNext:this.iterateNext();
this.Pja=(this.Pja+1)%this.pR.length;this.nGb(L.a.setCurrentChangeCount,this.Pja+1);break;case L.a.Mva:this.Mva();this.Pja=0>this.Pja?0:this.Pja;this.Pja=(this.Pja+this.pR.length-1)%this.pR.length;this.nGb(L.a.setCurrentChangeCount,this.Pja+1);break;case L.a.FJb:this.ssc(ja.Values.ToggleValue)}};a.prototype.nGb=function(ja,R){if(C.EwaSettings.ka(333))if(this.Ir){var ba={};ba.count=R;ja=new r.a(ja);ja.Values=ba;this.Ir.send(ja)}else c.ULS.sendTraceTag(50469004,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");
else c.ULS.sendTraceTag(50469003,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.GDh=function(ja,R){var ba=!1;var ha=null;for(var oa=0;!ba&&oa<this.pR.length;){R=ja?this.xDh(R):this.gFh(R);ha=this.pR[R];var Sa=Object(k.a)(W.a,this.$.Aa.getItemByName(ha.Em.SheetName));if(!Sa)return c.ULS.shipAssertTag(41980624,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,P0e:R,j4f:ha};Sa.visible&&(ba=!0);oa++}return{returnValue:ba,P0e:R,j4f:ha}};a.prototype.xDh=function(ja){return-1===ja?this.mSe():(ja+1)%this.pR.length};a.prototype.gFh=function(ja){-1===ja&&(ja=this.mSe());return ja=(ja+this.pR.length-1)%this.pR.length};a.prototype.WZc=function(ja){this.FYg(ja);this.CZc()};a.prototype.iKh=function(ja,R){var ba=[];if(!ja.RangeList)return c.ULS.shipAssertTag(41976984,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
ba;ja=Ml(ja.RangeList);for(var ha=ja.next();!ha.done;ha=ja.next())(ha=ha.value)&&this.$.Aa.Gj(ha.SheetName)?(ha=new d(0,ha,R),ba.push(ha)):c.ULS.shipAssertTag(41976985,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - "+ha?" Inavlid sheet name"+ha.SheetName:"Null Sheet Range");return ba};a.prototype.FYg=function(ja){ja=Ml(ja);for(var R=ja.next();!R.done;R=ja.next())if(R=R.value,!R||J.e(R.LocationList))c.ULS.sendTraceTag(41244702,0,50,"VersionHistoryHighlightManager.CreateUserActivityLocationList - "+
R?"Empty Location list":"Null user activity");else for(var ba=Ml(R.LocationList),ha=ba.next();!ha.done;ha=ba.next())if(ha=ha.value)switch(ha.Type){case 0:var oa=void 0;(oa=this.lna).push.apply(oa,this.iKh(ha,R.Person));break;default:c.ULS.sendTraceTag(41244704,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else c.ULS.shipAssertTag(41244703,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.CZc=function(){for(var ja=
{},R=new u.a,ba=[],ha=Ml(this.lna),oa=ha.next();!oa.done;oa=ha.next())if(oa=oa.value,R.contains(oa.Ewc)||R.add(oa.Ewc),!oa.UDa){var Sa=new Y.a(y.D(oa.Em),A.d(this.$.Aa.getItemByName(oa.Em.SheetName))),ma=a.orc(Sa);ma in ja||ba.push(Sa);ja[ma]=this.Tvh(oa.Ewc)}c.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.lna.length,ba.length,R.count,
this.QZf);this.Wvc();0<ba.length&&(ja=new (b(1325).RangeVersionHistoryHighlightView)(this.$,ba,ja,this.Plb),this.n1["0"]=ja)};a.prototype.Wvc=function(){var ja=this.lna?this.pR.length:0;this.nGb(L.a.setCurrentChangeCount,0);this.nGb(L.a.setTotalChangesCount,ja)};a.prototype.SMa=function(){this.nGb(L.a.SMa,0)};a.prototype.Mfi=function(ja){if(ja){this.QZf=ja.length;for(var R=0;R<ja.length;++R)if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&S.a.na(ja[R].InitialsColor))c.ULS.sendTraceTag(556836888,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var ba=ja[R].EmailAddress;var ha=ja[R].UserName;var oa=null;if(ja[R].LoginName){var Sa=ja[R].LoginName.split("|");3===Sa.length&&(oa=Sa[2])}oa?this.authorColor[oa]=ja[R].InitialsColor:ba?(c.ULS.sendTraceTag(42341888,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[ba]=ja[R].InitialsColor):ha?(c.ULS.sendTraceTag(42341889,0,15,
String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[ha]=ja[R].InitialsColor):c.ULS.sendTraceTag(42341890,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else c.ULS.sendTraceTag(42550406,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.exj=function(){if(S.a.na(this.$.Ba.VersionHistoryHighlightsSettings))c.ULS.sendTraceTag(42504652,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"));
else for(var ja=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.Ba.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.Ba.VersionHistoryHighlightsSettings):null,R=0;R<ja.length;R++){var ba=ja[R],ha=ba.key?ba.key:ba.Key?ba.Key:"";ba=ba.value?ba.value:ba.Value?ba.Value:"";"DefaultColor"===ha?this.Gxe=ba:"InitialTint"===ha?this.Plb=ba:c.ULS.sendTraceTag(42504653,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}};
a.prototype.Tvh=function(ja){if(ja.Email in this.authorColor)return this.authorColor[ja.Email];if(ja.DisplayName in this.authorColor)return this.authorColor[ja.DisplayName];c.ULS.sendTraceTag(42271374,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.Gxe};a.prototype.qOg=function(ja,R){return this.f_b(ja.Em,R.Em)};a.prototype.pOg=function(ja,R){return this.f_b(ja.Em,R)};a.prototype.f_b=function(ja,R){var ba=
Object(k.a)(W.a,this.$.Aa.getItemByName(ja.SheetName)),ha=Object(k.a)(W.a,this.$.Aa.getItemByName(R.SheetName));return ba&&ha?(ba=(ba=H.HelperMethods.xC(ba.index,ha.index))?ba:H.HelperMethods.xC(ja.FirstRow,R.FirstRow))?ba:H.HelperMethods.xC(ja.FirstColumn,R.FirstColumn):(c.ULS.sendTraceTag(41976986,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.mSe=function(){var ja=y.m(this.gridView.ga.ya.activeRange,this.$.Aa.sa);if(!ja)return c.ULS.sendTraceTag(41976988,
0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;ja=H.HelperMethods.Uw(new v.a(this.pR),0,this.pR.length,ja,Object(t.a)(this,this.pOg,"compareSelectedCellWithUserActivityLocation"));0>ja&&(ja=~ja);return ja%this.pR.length};a.prototype.T1b=function(){if(this.iGb){if(!(this.iGb.UDa.toString()in this.n1)){c.ULS.shipAssertTag(41976989,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.iGb.UDa.toString()));return}this.n1[this.iGb.UDa.toString()].n1g(this.iGb.Em)}this.sZa=-1};a.prototype.nd=function(){this.T1b()};a.prototype.Uo=function(){this.T1b()};a.prototype.tk=function(){this.T1b()};a.prototype.iterateNext=function(){this.LLf(!0)};a.prototype.Mva=function(){this.LLf(!1)};a.orc=function(ja){return String.format("{0}{1}",ja.range,ja.sheetId)};Jl.Object.defineProperties(a.prototype,{Acb:{configurable:!0,enumerable:!0,get:function(){return this.n1}},iGb:{configurable:!0,enumerable:!0,
get:function(){return-1===this.sZa?null:this.pR[this.sZa]}},pR:{configurable:!0,enumerable:!0,get:function(){this.z4a||(this.lna.sort(Object(t.a)(this,this.qOg,"compareUserActivityLocation")),this.z4a=!0);return this.lna}}});Object(D.a)(a,"VersionHistoryHighlightManager",null,[16,7])},1325:function(D,F,b){function a(y,x,z,J){this.Ffb=null;this.$=y;this.pjg=x;this.KPa=z;this.LPa={};this.Plb=J;this.tWh()}function d(){}b.r(F);D=b(0);var c=b(15),m=b(10);d.oeh="ewa-vhr-rectinnerborder";Object(D.a)(d,"CssClassNames",
null,[]);var r=b(63),t=b(46),k=b(212),u=b(106),w=b(20),v=b(334),A=b(1235);b.d(F,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.$Hb=function(y){y?this.Sb.Wr(this.ldd):this.Sb.ll(this.ldd)};a.prototype.dSi=function(){this.$Hb(!1);this.Sb.x$a(new v.a(null,r.d(this.$.sa)),this.ldd)};a.prototype.k3i=function(y){if(this.KPa){var x=new v.a(t.D(y),r.d(this.$.Aa.getItemByName(y.SheetName))),z=A.a.orc(x);if(z in this.KPa)if(z in this.LPa){x=k.a.Bp(this.KPa[z]);z=this.LPa[z];for(var J in z)z[J].style.backgroundColor=
String.format("rgba({0},{1},{2},{3})",x.r,x.g,x.b,m.a.lBj);w.g(this.$).ga.Sa.jG(null);w.g(this.$).IWe(y,60,!0,u.a.yMi)}else c.ULS.sendTraceTag(41976976,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+z);else c.ULS.sendTraceTag(41976975,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+z)}else c.ULS.sendTraceTag(41976974,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};
a.prototype.n1g=function(y){y=new v.a(t.D(y),r.d(this.$.Aa.getItemByName(y.SheetName)));var x=A.a.orc(y);if(x in this.LPa)if(x in this.KPa){y=k.a.Bp(this.KPa[x]);x=this.LPa[x];for(var z in x)x[z].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",y.r,y.g,y.b,this.Plb)}else c.ULS.sendTraceTag(42068037,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+x);else c.ULS.sendTraceTag(41976978,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+
x)};a.prototype.tWh=function(){var y=this;this.Sb.Zu(this.pjg,[a.b4],!1,function(x,z){if(x&&x.range&&x.sheetId&&z){var J=new v.a(x.range,x.sheetId);J=A.a.orc(J);J in y.LPa||(y.LPa[J]={});y.LPa[J][x.paneType.toString()]=z;J in y.KPa?(x=y.KPa[J],J=k.a.Bp(x),z.style.borderColor=x,z.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",J.r,J.g,J.b,y.Plb),x=document.createElement("div"),x.className=d.oeh,z.appendChild(x)):c.ULS.sendTraceTag(41976980,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+
J)}else c.ULS.shipAssertTag(41244696,0,!!x,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),c.ULS.shipAssertTag(41244697,0,!x||!!x.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),c.ULS.shipAssertTag(41244698,0,!x||!!x.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),c.ULS.shipAssertTag(41244699,0,!!z,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Jl.Object.defineProperties(a.prototype,{ldd:{configurable:!0,
enumerable:!0,get:function(){return[a.b4]}},Sb:{configurable:!0,enumerable:!0,get:function(){return this.Ffb||(this.Ffb=w.g(this.$).Sb)}}});a.b4=23;Object(D.a)(a,"RangeVersionHistoryHighlightView",null,[717])},1362:function(D,F,b){function a(Sb){var Hc=gg.call(this)||this;Hc.$=Sb;Hc.fc();return Hc}function d(Sb,Hc,ed,Id){var hf=this;ed=void 0===ed?null:ed;Id=void 0===Id?null:Id;this.emptyCatchUpBehaviorManager=this.fFa=null;this.DYe=!1;this.$=Sb;this.YXa=new S(this.$);this.RVd=new ja(Mb.AFrameworkApplication.Hb,
Ue.EwaSettings.ka(478));Sb=Md.a.cqj(Fc.a.instance.yc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.Qaf=Id;this.uoe=new w(this.$,this,Sb,this.K3a());this.toe=new W(this.$,Mb.AFrameworkApplication.Hb);Ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EmptyCatchUpExperience",!1)&&Ue.EwaSettings.ka(510)&&(this.emptyCatchUpBehaviorManager=new u(this.$));this.Bai(function(Hf){hf.Koi(Hf)},Hc);this.oci();Hc=null;ed||(Hc=Fc.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));
this.flyoutRibbonButton=ed||new r(Hc);this.flyoutFocus=new t(this.$,this.flyoutRibbonButton)}function c(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function m(){this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=
this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function r(Sb){this.buttonClickedCallback=null;this.fgb=this.Nvb=!1;this.goh=new Date;this.pLe=Sb}function t(Sb,Hc){this.$=Sb;this.flyoutRibbonButton=void 0===Hc?null:Hc;jd.a(this.$).$g(this);this.hasFocus=!1}function k(Sb){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Sb)}function u(Sb){this.$=
Sb}function w(Sb,Hc,ed,Id){Id=void 0===Id?!1:Id;this.$=Sb;this.catchUpActivityManager=Hc;this.voe=ed;this.vCb=Fc.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.tlc=Fc.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.K3a=Id}function v(){var Sb=J.call(this)||this;Sb.relationship=0;return Sb}function A(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function y(){this.lowWaterline=this.highWaterline=this.wywaWaterline=
this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function x(){this.activityFeedItems=null}function z(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function J(){this.activityFeedItemId=this.activityId=null;this.type=0;this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function B(Sb,Hc,ed,Id,hf,Hf,Cg){Cg=Sb.Ra(1,void 0===Cg?null:Cg);Cg.getRelevantActivitiesDataRequest=
Hc;return hb.i(Sb,"GetRelevantActivitiesData",Cg,ed,Id,hf,Hf,0)}function C(Sb,Hc,ed,Id,hf,Hf){Hf=Sb.Ra(1,void 0===Hf?null:Hf);return hb.i(Sb,"GetLineageWywaAuthors",Hf,Hc,ed,Id,hf,4)}function H(){}function W(Sb,Hc){this.$=Sb;this.Bi=Hc}function S(Sb){this.WOa=this.P_b=this.Sda=null;this.a4={};this.KBa=null;this.rdd=!1;this.$=Sb;this.gridView=Yb.g(this.$);this.ga=this.gridView.ga;this.qb=this.gridView.Hc;this.ga.rVb(Object(gb.a)(this,this.Yk,"onContextMenu"));this.ga.$F(Object(gb.a)(this,this.nd,"onSelectionChanged"));
this.gridView.AD(Object(gb.a)(this,this.Uo,"onCurrentSelectionModeChanged"));this.qb.Cm(Object(gb.a)(this,this.tk,"onEditStarted"));this.Tia=this.B$b=null;this.Pbc=!1;this.r6c={}}function N(){this.target=null;this.isSticky=!1}function T(){this.clearSticky=!1}function fa(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function Y(){this.mXc=new Fa.a;this.sHb={};this.qce={}}function L(Sb,Hc,ed,Id,hf){Sb=P.call(this,Sb,Hc,ed,Id)||this;Sb.ranges=hf;Sb.z4a=!1;return Sb}
function P(Sb,Hc,ed,Id){var hf=bf.call(this)||this;hf.$=Sb;hf.eUd=Hc;hf.X8f=ed;hf.yB=Id;hf.state=0;return hf}function ea(Sb,Hc,ed){ed=df.call(this,Sb,Hc,ed)||this;ed.gridView=Yb.g(Sb);ed.kla=Hc;return ed}function X(Sb){this.Edg=Sb;this.Gu.Cee(Object(gb.a)(this,this.NAb,"onHighlightStateChanged"));this.X$=[]}function ja(Sb){this.Bi=Sb}function R(Sb){return Pd.call(this,Sb)||this}function ba(Sb,Hc){this.$=Sb;this.catchUpActivityManager=Hc}function ha(){this.pb=null}function oa(Sb){this.Rea=Sb}function Sa(Sb){this.lhg=
Sb}function ma(Sb){this.jVa=Sb;this.j3d=new Og.a}function na(Sb,Hc,ed){this.ngg=Sb;this.DSa=Hc;this.RSa=ed}function xa(Sb,Hc,ed){Sb=tf.call(this,Sb,Hc)||this;Sb.DocumentId=null;Sb.DocumentId=ed;return Sb}function Oa(Sb,Hc){this.Ug=Sb;this.Rea=Hc}function ib(Sb,Hc,ed,Id,hf,Hf,Cg){this.h8=this.ZHc=this.YHc=this.Lea=this.Lhb=this.NCa=this.rNb=this.PF=null;this.I4d=0;this.GRb=null;this.mgb=!1;this.IIc=this.QUd=null;this.e_d=this.b_d=!1;this.wVd=null;this.y_d=!1;this.Xg=Sb;this.hc=Hc;this.KF=ed;this.Me=
Id;this.Oa=void 0===hf?null:hf;this.eBa=void 0===Hf?null:Hf;this.yX=void 0===Cg?null:Cg;this.Oa.$b(Lg.a.rce,qg.a.frame,hh.ActionManager.Wf)}function sb(Sb){var Hc=Of.call(this)||this;Hc.$=Sb;Hc.fc();return Hc}function nb(Sb,Hc){this.vjd=!1;this.$=Sb;Ue.EwaSettings.ka(655)&&this.$.fa.ayb&&!nb.Mtb&&(Hc&&!Hc.pab||this.bBj(),nb.GYe?pb.ULS.sendTraceTag(572400704,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):Hc&&!Hc.pab||this.hBj());
pb.ULS.sendTraceTag(578076752,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Gb(Sb){var Hc=Kf.call(this)||this;Hc.oi=null;Hc.Wg=null;Hc.$=Sb;Hc.fc();return Hc}function Ha(Sb,Hc,ed){Sb=Ug.call(this,Sb)||this;Sb.se=null;Sb.Xqe=null;Sb.SAb=null;Sb.Yid=!0;Sb.jr=0;Sb.cp=!1;Sb.$=Hc;Sb.taskPaneManager=ed;Sb.$.yn(Object(gb.a)(Sb,Sb.Yd,"onWorkbookClosing"));jd.a(Sb.$).$g(Sb);$b.a.Sd(Sb.$)&&(Sb.isVisible=!1);return Sb}function ca(Sb){var Hc=vd.call(this)||this;Hc.lineageTaskPane=null;
Hc.y6=null;Hc.$=Sb;Hc.fc();return Hc}function Ra(Sb,Hc,ed,Id){this.Gqb=this.FE=null;this.xD=this.Lmd=0;this.$=Sb;Hc.La(366,this);this.gridView=Yb.g(this.$);this.lineageTaskPane=ed;this.Gmd=this.lineageTaskPane.LL();this.batchSize=50;this.y6=Id;this.QHb=this.$.Zb.yi("UserAction","LineagePaneLoadingShimmerStopWatch");this.tlc=Fc.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.TVh();this.xog()}function ua(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=
null}function ta(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function db(){this.sheetName=this.rangeList=null}function Ta(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function qb(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=
this.filterableSheetList=null}function za(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function Ia(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function va(){var Sb=Ua.call(this)||this;Sb.hasNewActivities=!1;Sb.filterSheetMultiRange=
null;return Sb}function Ua(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Kb(Sb,Hc,ed,Id,hf,Hf){Hf=Sb.Ra(1,void 0===Hf?null:Hf);return hb.i(Sb,"LineageClosePane",Hf,Hc,ed,Id,hf,0)}function ia(Sb,Hc,ed,Id,hf,Hf){Hf=Sb.Ra(1,void 0===Hf?
null:Hf);return hb.i(Sb,"LineageUpdateView",Hf,Hc,ed,Id,hf,0)}function E(){}function fb(){}function Za(Sb){var Hc=Le.call(this)||this;Hc.$=Sb;Hc.fc();return Hc}function ec(Sb){this.pab=!0;ec.q3e()?ec.x3e()?this.pab=Sb:this.pab=!1:this.pab=!0}function zc(Sb){return Bf.call(this,Sb)||this}function Ab(Sb,Hc){this.$=Sb;this.lineageManager=Hc;Sb=[new Ce.a(Nc.a.Imd,1038647878,0,0,2132),new Ce.a(Nc.a.idle,1038647878,0,1)];uc.a(this.$).xAd(new ne.a(Nc.a.Hmd,Nc.a.idle,Sb),new vb(Nc.a.Imd,Nc.a.idle,Hc))}function vb(Sb,
Hc,ed){Sb=zf.call(this,Sb,Hc)||this;Sb.lineageManager=ed;return Sb}function kc(Sb){var Hc=me.call(this)||this;Hc.$=Sb;Hc.fc();return Hc}function td(Sb){return Yd.call(this,Sb)||this}function Oc(Sb){this.baseVersionInfo=this.I2=this.nna=this.tm=this.ewaAccessibilityManager=this.cKb=null;this.TAd=this.Ahf=!1;this.Vwe=!0;this.dialog=this.iB=this.cLe=this.aD=this.VRd=this.TRd=this.URd=null;this.$=Sb;this.A4b=this.$.Mb+Oc.Kih;this.SAd=!1;Ue.EwaSettings.ka(403)&&this.JYg();this.Kxb="";this.Zld=0;this.perfTelemetryInfos=
[]}function tc(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function sc(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=
null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=this.wdEnableDownloadVersion=!1;this.wdEnableAppColorUpdate=null}function ic(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function Ga(){this.rootDiv=this.appBootSettings=null}function cb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function Tb(Sb){this.kw=Sb}function Bb(Sb){this.kw=Sb}function nc(Sb){this.kw=Sb}function Gc(){}function La(Sb,Hc){this.$=Sb;this.oBj=Hc}function Wa(Sb,
Hc){var ed=Ea.call(this)||this;ed.activityName=Sb;ed.HT=Hc;ed.fc();return ed}function wa(Sb,Hc){return Fd.call(this,Sb,Hc)||this}function Da(Sb,Hc,ed){var Id=Pc.call(this)||this;Id.activityName=Sb;Id.HT=Hc;Id.gJ=ed;Id.fc();return Id}function Va(Sb,Hc,ed,Id,hf){Sb=dc.call(this,Sb,Hc)||this;Sb.di=null;Sb.retryCount=0;Sb.gJ=ed;Sb.m2=Id;Sb.baseUrl=hf;return Sb}b.r(F);var Jb=b(12),Hb=b(0),Mb=b(5),Ub=b(211),pb=b(15),gb=b(37),Qa=b(114),eb=b(173),xb=b(41),dc=Qa.a;Cm(Va,dc);Va.prototype.execute=function(Sb){this.di=
Sb;this.retryCount=3;this.SIf();return 1};Va.prototype.SIf=function(){var Sb=this.di.activityState[Va.Clc],Hc=this.di.activityState[Va.c5f],ed=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");Sb=xb.c({VersionId:Hc,QuerySignature:Sb});this.m2.Wl(ed,2,Sb,{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(gb.a)(this,this.Yxi,"onRestoreSuccessCallback"),Object(gb.a)(this,this.Wxi,"onRestoreFailureCallback"),null)};Va.prototype.Yxi=function(Sb){var Hc=this.Esj(Sb);Sb=Hc.cEd;Hc.returnValue?
Sb.Success?(eb.c(2138207060,!0),pb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(eb.c(2138207060,!1),pb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",Sb.Output),this.mh(this.gJ)):(eb.c(2138207060,!1),this.mh(this.gJ));(Sb=this.di.activityState[Va.Qnd])&&Sb();this.So();this.di.WI()};Va.prototype.Wxi=function(){if(0<this.retryCount)pb.ULS.sendTraceTag(42287319,
0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",this.retryCount),this.retryCount--,this.SIf();else{pb.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");eb.c(2138207060,!1);this.mh(this.gJ);var Sb=this.di.activityState[Va.Qnd];Sb&&Sb();this.So();this.di.WI()}};Va.prototype.Esj=function(Sb){var Hc=null;Sb=Sb?Sb.data?Sb.data.pe:null:null;if(!Sb||!Sb.length)return pb.ULS.sendTraceTag(42287321,0,10,
"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,cEd:Hc};Sb=xb.d(Sb);Hc=Sb.xu;return Sb.returnValue?{returnValue:!0,cEd:Hc}:(pb.ULS.sendTraceTag(42287322,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,cEd:Hc})};Va.c5f="RVAvi";Va.Clc="RVAqs";Va.Qnd="RVlvrt";Object(Hb.a)(Va,"RestoreVersionActivity",Qa.a,[]);var Nc=b(6),Pc=Ub.a;Cm(Da,Pc);Da.prototype.create=
function(){this.Jb(new Va(this.activityName,this.HT,this.gJ,Mb.AFrameworkApplication.Md,Mb.AFrameworkApplication.za.Za.PZ))};Da.la=function(Sb){Sb.ea.La(320,new Da(Nc.a.fEd,Nc.a.nj,Nc.a.gEd))};Object(Hb.a)(Da,"RestoreVersionActivityFactory",Ub.a,[]);var Fd=Qa.a;Cm(wa,Fd);wa.prototype.execute=function(Sb){var Hc=this;(0,Sb.activityState[wa.YTf])(function(){Hc.So();Sb.WI()});return 1};wa.YTf="RVEAssea";Object(Hb.a)(wa,"RestoreVersionErrorActivity",Qa.a,[]);var Ea=Ub.a;Cm(Wa,Ea);Wa.prototype.create=
function(){this.Jb(new wa(this.activityName,this.HT))};Wa.la=function(Sb){Sb.ea.La(321,new Wa(Nc.a.gEd,Nc.a.nj))};Object(Hb.a)(Wa,"RestoreVersionErrorActivityFactory",Ub.a,[]);var Xa=b(75),hc=b(800),Xb=b(58),Ic=b(35),Qc=b(172),Cb=b(367),$c=b(52);La.prototype.$c=function(){return Mb.AFrameworkApplication.ha.ta("IsAnonymousUser")?(pb.ULS.sendTraceTag(42813647,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};La.prototype.executeCommand=function(Sb,Hc){pb.ULS.sendTraceTag(41739618,0,50,
"VersionHistoryCommandHandler:ExecuteCommand called.");Sb=!1;switch(Hc.command){case -1112508866:Cb.a(this.$)&&this.$.ea.Ea(423,void 0).tsc(!1),Sb=this.oBj.Vhj()}pb.ULS.sendTraceTag(41739619,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",Sb);return Sb?$c.Task.Ua(Sb):Qc.a(Hc.command)};La.prototype.Jc=function(Sb,Hc){return-1112508866===Hc.command&&this.$.isVersionHistoryEnabled()};La.prototype.gd=function(){return!1};Object(Hb.a)(La,"VersionHistoryCommandHandler",null,[159]);var ae=
b(382),Mc=b(24),Hd=b(177),Nd=b(277);Gc.addAppPLTEventToLog=function(Sb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Sb)}catch(Hc){}};Gc.setIsPageLoadForFirstTime=function(Sb){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Sb)}catch(Hc){}};Object(Hb.a)(Gc,"VersionHistoryLogConnector",null,[]);var ge=b(944),Ed=b(1232),Zc=b(148),he=b(92),Ke=b(27),Ue=b(1),Pb=b(7),kb=b(39),yb=b(243),Ma=b(1119),jd=b(254),Zd=b(241),Zb=b(11);nc.prototype.$g=function(){jd.a(this.kw.$).fM(this.he)||
jd.a(this.kw.$).$g(this)};nc.prototype.Z6=function(){jd.a(this.kw.$).fM(this.he)&&jd.a(this.kw.$).UA(this)};nc.prototype.Lh=function(Sb){return Zb.DOMElementExtensions.jf(this.Nb,Sb)};nc.prototype.vi=function(){this.kw.$.frame.Te.Zj(this.kw.$.frame.Te.XD)};nc.prototype.ei=function(){};nc.prototype.Ye=function(Sb,Hc){Hc||this.kw.cKb.then(function(ed){ed.enterHeaderFocusTrapZone();return null});return!Hc};Jl.Object.defineProperties(nc.prototype,{he:{configurable:!0,enumerable:!0,get:function(){return Zd.a.$4f}},
Nb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(nc,"VersionHistoryHeader",null,[135]);Bb.prototype.$g=function(){jd.a(this.kw.$).fM(this.he)||jd.a(this.kw.$).$g(this)};Bb.prototype.Z6=function(){jd.a(this.kw.$).fM(this.he)&&jd.a(this.kw.$).UA(this)};Bb.prototype.Lh=function(Sb){return Zb.DOMElementExtensions.jf(this.Nb,Sb)};Bb.prototype.vi=function(){this.kw.$.frame.Te.Zj(this.kw.$.frame.Te.XD)};
Bb.prototype.ei=function(){};Bb.prototype.Ye=function(Sb,Hc){Hc||this.kw.cKb.then(function(ed){ed.enterFocusTrapZone();return null});return!Hc};Jl.Object.defineProperties(Bb.prototype,{he:{configurable:!0,enumerable:!0,get:function(){return Zd.a.a5f}},Nb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(Bb,"VersionHistoryPane",null,[135]);Tb.prototype.$g=
function(){jd.a(this.kw.$).fM(this.he)||jd.a(this.kw.$).$g(this)};Tb.prototype.Z6=function(){jd.a(this.kw.$).fM(this.he)&&jd.a(this.kw.$).UA(this)};Tb.prototype.Lh=function(Sb){return Zb.DOMElementExtensions.jf(this.Nb,Sb)};Tb.prototype.vi=function(){this.kw.$.frame.Te.Zj(this.kw.$.frame.Te.XD)};Tb.prototype.ei=function(){};Tb.prototype.Ye=function(Sb,Hc){Hc||this.kw.cKb.then(function(ed){ed.enterViewerFocusTrapZone();return null});return!Hc};Jl.Object.defineProperties(Tb.prototype,{he:{configurable:!0,
enumerable:!0,get:function(){return Zd.a.b5f}},Nb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Hb.a)(Tb,"VersionHistoryViewer",null,[135]);var wb=b(134),gc=b(244),uc=b(64),id=b(411),Wc=b(872);Object(Hb.a)(cb,"AppBootSettings",null,[]);Object(Hb.a)(Ga,"AppVersionControllerFactoryParameters",null,[]);Object(Hb.a)(ic,"OnVersionSelectedParams",null,[]);Object(Hb.a)(sc,
"AppSettings",null,[]);Object(Hb.a)(tc,"ControllerFactoryParameters",null,[]);Oc.prototype.dispose=function(){this.Xpe()};Oc.prototype.LGi=function(){var Sb=this;this.$.ea.ub(15,function(Hc){Sb.ewaAccessibilityManager=Hc;Sb.ewaAccessibilityManager.mode=2})};Oc.prototype.JYg=function(){this.URd=new Bb(this);this.TRd=new nc(this);this.VRd=new Tb(this)};Oc.prototype.Vhj=function(){var Sb=this;pb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");Mb.AFrameworkApplication.uQ("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");
Mb.AFrameworkApplication.uQ("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");Mb.AFrameworkApplication.uQ("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");Mb.AFrameworkApplication.qyb("gj946531;j6gcd431");this.aD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.aD.startTimer(Oc.$Yf);if(!this.tm&&(id.a(function(){Sb.tm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new tc,
{ulsLogger:new ae.a,docId:Mb.AFrameworkApplication.hj,appSettings:Object.assign(new sc,{appName:120,userSessionId:Mb.AFrameworkApplication.userSessionId,wdEnableSaveACopy:Ue.EwaSettings.ka(371),wdEnableDownloadTokens:Ue.EwaSettings.ka(366),wacCluster:Mb.AFrameworkApplication.Md.CR,uiLocale:Mb.AFrameworkApplication.uiCulture?Mb.AFrameworkApplication.uiCulture:"en-us",wdEnableRestore:Ue.EwaSettings.ka(335)&&Sb.$.isEditMode,wdEnableIterator:Ue.EwaSettings.ka(332)&&Ue.EwaSettings.ka(333),useXhr:Mc.a.rM,
wdEnableHiddenButtonsUntilVersionLoadComplete:Ue.EwaSettings.ka(443),disableSaveACopy:Sb.zRf(),wdEnableShowVersionChanges:Ue.EwaSettings.ka(332)&&Ue.EwaSettings.ka(334),disabledChangeGates:Sb.$.Ba.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:Ue.EwaSettings.ka(578),isRtl:Mb.AFrameworkApplication.isRtl,wdEnableDownloadVersion:Ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.VersionHistoryDownloadVersionIsEnabled",!1)||Sb.$.lg.get(51)}),perfTelemetryInfos:Sb.perfTelemetryInfos}))}),
!this.tm))return pb.ULS.sendTraceTag(41239235,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),eb.c(429638140,!1),!1;this.Whj();this.aD.endTimer(Oc.$Yf);this.aD.startTimer(Oc.cZf);pb.ULS.sendTraceTag(41739650,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");eb.c(429638140,!0);return!0};Oc.prototype.Whj=function(){this.Xj();if(!document.getElementById(this.A4b)){var Sb=document.createElement("div");Sb.id=this.A4b;
Sb.style.width="100%";Sb.style.height="100%";Sb.style.zIndex="998";Sb.style.display="block";Sb.style.position="absolute";this.$.sr.insertBefore(Sb,this.$.sr.firstChild);this.cKb=this.tm.createVersionHistoryDialog(Sb)}document.getElementById(this.A4b).style.display="block";this.KAd();this.aD.startTimer(Oc.PNd);this.tm.getVersions("")};Oc.prototype.KAd=function(){Ue.EwaSettings.ka(403)&&(this.URd.$g(),this.TRd.$g(),this.VRd.$g(),this.LGi())};Oc.prototype.QPd=function(){Ue.EwaSettings.ka(403)&&(this.URd.Z6(),
this.TRd.Z6(),this.VRd.Z6(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Oc.prototype.Xj=function(){this.tm.getVersionsReadyEvent().addListener(Object(gb.a)(this,this.Ztf,"onVersionsReady"));this.tm.getVersionSelectedEvent().addListener(Object(gb.a)(this,this.onVersionSelected,"onVersionSelected"));this.tm.getCloseSelectedEvent().addListener(Object(gb.a)(this,this.Ykf,"onCloseVersionHistoryDialog"));this.tm.getFullAppErrorEvent().addListener(Object(gb.a)(this,this.fnf,"onFullAppError"));
this.tm.getIteratorSelectedEvent().addListener(Object(gb.a)(this,this.uof,"onIteratorSelected"));this.tm.getShowVersionChangesToggledEvent().addListener(Object(gb.a)(this,this.Bud,"onShowChangesToggleSelected"));Ue.EwaSettings.ka(366)&&(this.tm.getDownloadTokenReadyEvent().addListener(Object(gb.a)(this,this.Vlf,"onDownloadTokenReady")),this.SAd=!0);Ue.EwaSettings.ka(371)&&(this.tm.getSaveACopySelectedEvent().addListener(Object(gb.a)(this,this.Frf,"onSaveACopy")),this.tm.getDownloadVersionSelectedEvent().addListener(Object(gb.a)(this,
this.Wlf,"onDownloadVersion")));Ue.EwaSettings.ka(335)&&this.$.isEditMode&&(this.tm.getRestoreVersionSelectedEvent().addListener(Object(gb.a)(this,this.orf,"onRestoreVersionSelected")),this.TAd=!0);this.nna&&this.nna.getAppErrorEvent().addListener(Object(gb.a)(this,this.Bjf,"onAppError"))};Oc.prototype.sm=function(){this.tm.getVersionsReadyEvent().removeListener(Object(gb.a)(this,this.Ztf,"onVersionsReady"));this.tm.getVersionSelectedEvent().removeListener(Object(gb.a)(this,this.onVersionSelected,
"onVersionSelected"));this.tm.getCloseSelectedEvent().removeListener(Object(gb.a)(this,this.Ykf,"onCloseVersionHistoryDialog"));this.tm.getFullAppErrorEvent().removeListener(Object(gb.a)(this,this.fnf,"onFullAppError"));this.tm.getIteratorSelectedEvent().removeListener(Object(gb.a)(this,this.uof,"onIteratorSelected"));this.tm.getShowVersionChangesToggledEvent().removeListener(Object(gb.a)(this,this.Bud,"onShowChangesToggleSelected"));Ue.EwaSettings.ka(371)&&(this.tm.getSaveACopySelectedEvent().removeListener(Object(gb.a)(this,
this.Frf,"onSaveACopy")),this.tm.getDownloadVersionSelectedEvent().removeListener(Object(gb.a)(this,this.Wlf,"onDownloadVersion")));this.SAd&&(this.tm.getDownloadTokenReadyEvent().removeListener(Object(gb.a)(this,this.Vlf,"onDownloadTokenReady")),this.SAd=!1);this.TAd&&(this.tm.getRestoreVersionSelectedEvent().removeListener(Object(gb.a)(this,this.orf,"onRestoreVersionSelected")),this.TAd=!1);this.nna&&this.nna.getAppErrorEvent().removeListener(Object(gb.a)(this,this.Bjf,"onAppError"))};Oc.prototype.Bej=
function(){var Sb=!0;if(Ue.EwaSettings.ka(649)&&!this.$.dQ)return pb.ULS.sendTraceTag(579631304,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.fa.amIAlone.toString()),!0;if(!this.$.fa.amIAlone&&!Ue.EwaSettings.ka(331)){this.Obi();this.tm.setCoauthRestoreError();Sb=!1;var Hc=new he.a(-729359593,0,this.$.jd,0,null);this.$.Na.Xb(Hc)}this.$.dQ&&(pb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),
Sb&&(Sb=!1,this.Rhj()));return Sb};Oc.prototype.orf=function(Sb){var Hc=this;pb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(this.Bej()){var ed=function(hf){eb.c(2138207060,!1);Hc.tm.setRestoreFailedAtServer(hf)};this.aD&&this.aD.startTimer(Oc.aZf);var Id=function(){Hc.aD.endTimer(Oc.aZf);Hc.noe(Hc.aD)};this.tm.setRestoreInProgress();kb.a(this.$).Nr(new yb.a(Nc.a.xx,5,function(){var hf=uc.a(Hc.$).ld.activityState;hf[gc.a.kp]=Nc.a.gre;
hf[wb.a.GX]=!0;hf[wb.a.DS]=0;hf[Va.c5f]=Sb;hf[Va.Clc]=Mb.AFrameworkApplication.hj;hf[Va.Qnd]=Id;hf[wa.YTf]=ed}))}else eb.c(2138207060,!1)};Oc.prototype.Rhj=function(){var Sb=Ke.a.Ad(1,0,1818,1817,0,-1603358883,"RestoreVersionUnsavedChangesError");Sb=this.dialog||new Zc.ErrorDialog(this.$,Sb);Sb.initialize();Sb.Bf()};Oc.prototype.Ztf=function(Sb){this.cKb.then(function(Hc){Hc.enterFocusTrapZone();return null});pb.ULS.sendTraceTag(41739651,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.aD.endTimer(Oc.PNd);
this.aD.incrementCounter(Oc.vRg);pb.ULS.sendTraceTag(41739652,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",this.aD.getTimerDuration(Oc.PNd));this.sYi(Sb.containerDiv);Sb.versions&&0<Sb.versions.length&&(this.cLe=Oc.kE(Sb.versions[Sb.versions.length-1]));this.I2&&this.nna&&this.TFd(this.I2);pb.ULS.sendTraceTag(41739654,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};Oc.prototype.onVersionSelected=function(Sb){pb.ULS.sendTraceTag(41739655,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
Oc.kE(Sb.currentVersion),Oc.kE(this.I2));this.aD.incrementCounter(Oc.uRg);this.I2=Sb.currentVersion;this.baseVersionInfo=Sb.baseVersion;this.Ahf=Sb.noBaseToCompareTo;this.nna&&this.GAj()&&(this.TFd(Sb.currentVersion),pb.ULS.sendTraceTag(41739657,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};Oc.prototype.GAj=function(){pb.ULS.sendTraceTag(42472802,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?Oc.kE(this.baseVersionInfo):"");if(Oc.kE(this.I2)===
this.cLe)return pb.ULS.sendTraceTag(42472832,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Ahf)return pb.ULS.sendTraceTag(588862345,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return pb.ULS.sendTraceTag(42472833,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),
!1;var Sb=Oc.nyh(this.baseVersionInfo);pb.ULS.sendTraceTag(42472834,0,50,"downloadURL length {0}",Sb?Sb.length:0);return Pb.a.na(Sb)?(pb.ULS.sendTraceTag(42472835,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1):!0};Oc.prototype.Vlf=function(Sb){pb.ULS.sendTraceTag(41739658,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",Sb&&Sb.versionSelected?Oc.kE(Sb.versionSelected.currentVersion):null,Sb&&Sb.updatedVersions?
Sb.updatedVersions.length:0,Oc.kE(this.I2));this.aD.incrementCounter(Oc.tRg);if(this.baseVersionInfo){if(Sb&&Sb.updatedVersions&&2<=Sb.updatedVersions.length){var Hc=null,ed=null,Id=Oc.kE(this.I2),hf=Oc.kE(this.baseVersionInfo);Sb=Ml(Sb.updatedVersions);for(var Hf=Sb.next();!Hf.done;Hf=Sb.next()){Hf=Hf.value;var Cg=Oc.kE(Hf);Id===Cg?Hc=Hf:hf===Cg&&(ed=Hf);if(Hc&&ed)break}Hc&&ed?(this.I2=Hc,this.baseVersionInfo=ed,pb.ULS.sendTraceTag(41739659,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
Oc.kE(this.I2),Oc.kE(this.baseVersionInfo)),this.TFd(this.I2)):pb.ULS.sendTraceTag(41439558,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Id,hf)}else pb.ULS.sendTraceTag(41439559,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");pb.ULS.sendTraceTag(41739660,0,
50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else pb.ULS.sendTraceTag(41439557,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};Oc.prototype.zRf=function(){return!this.$.qaa};Oc.prototype.Ykf=function(){pb.ULS.sendTraceTag(41739661,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.DMg();var Sb=new he.a(1470556788,0,this.$.jd,0,null);this.$.Na.Xb(Sb)};Oc.prototype.DMg=function(){document.getElementById(this.A4b).style.display=
"none";var Sb=new he.a(-1423792966,0,this.$.jd,0,null);this.$.Na.Xb(Sb);this.Xpe()};Oc.prototype.Xpe=function(){this.aD&&(this.aD.endTimer(Oc.cZf),this.noe(this.aD),this.aD=null);this.sm();this.QPd();this.perfTelemetryInfos&&(pb.ULS.sendTraceTag(42067140,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.iB&&(this.iB.cna(Hd.a.URa),this.iB.cna(Hd.a.VRa),this.iB.cna(Ma.a.setCurrentChangeCount),this.iB.cna(Ma.a.setTotalChangesCount),Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.iB.cna(Ma.a.SMa),this.iB.dispose(),this.iB=null)};Oc.prototype.Frf=function(Sb){pb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var Hc=new he.a(-1244760097,0,this.$.jd,0,null);this.$.lg.get(51)&&(pb.ULS.sendTraceTag(593367364,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Hc=new he.a(-309686558,0,this.$.jd,0,null));eb.c(1604651619,!0);var ed={};this.$.Na.Xb(Hc,(ed.FileDownloadUrl=Sb,ed))};Oc.prototype.Wlf=function(Sb){pb.ULS.sendTraceTag(587830285,
0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");Sb=new Nd.QueryStringBuilder(Sb);Sb.Ym("fn",Mb.AFrameworkApplication.fileName);pb.ULS.sendTraceTag(587830284,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Sb.toString().length);8===this.$.frame.uzb(Sb.toString(),!0)?(pb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),eb.c(1316171850,!1)):eb.c(1316171850,!0)};Oc.prototype.Bjf=function(Sb){this.tm.setFullAppErrorCode(Sb)};Oc.prototype.sYi=
function(Sb){var Hc=this;try{this.nna?Gc.setIsPageLoadForFirstTime(!1):(Gc.setIsPageLoadForFirstTime(!0),id.a(function(){var ed=new cb;ed.ulsLogger=new ae.a;ed.actionUrl=Hc.$.Ba.VersionHistoryActionUrl;ed.hideEmbedFooter=!0;ed.useFetch=Ue.EwaSettings.ka(435)&&!Mc.a.Iu;Hc.nna=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new Ga,{appBootSettings:ed,rootDiv:Sb}))}))}catch(ed){pb.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",
ed)}};Oc.prototype.TFd=function(Sb){pb.ULS.sendTraceTag(42016800,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Oc.kE(Sb),this.Kxb);if(Sb)if(Oc.kE(Sb).length){var Hc=(new Date).getTime();if(Oc.kE(Sb)===this.Kxb&&1E3>Hc-this.Zld)pb.ULS.sendTraceTag(42016803,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Oc.kE(Sb)!==this.Kxb&&(pb.ULS.sendTraceTag(51131787,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),
this.tm.setTotalChangesCount(-1),this.tm.setCurrentChangeCount(-1));var ed=excelVersionHistory.FactoryGlobal.getTelemetryCollector();ed.addEvent("SelectVersion",Oc.kE(Sb));try{this.bDj(ed);this.Zld=Hc;this.Kxb=Oc.kE(Sb);var Id=new ic;Id.selectedVersionInfo=this.I2;Id.baseVersionInfo=this.baseVersionInfo;Id.telemetryCollector=ed;this.nna.onVersionSelectedWithParams(Id);this.tm&&Ue.EwaSettings.ka(371)&&this.tm.setDisableSaveACopy(this.zRf());var hf=document.getElementById(Oc.Jih);hf&&!this.iB&&(pb.ULS.sendTraceTag(50405839,
0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.iB=new Ma.a(hf.contentWindow,Xa.a.K$(this.$.Ba.VersionHistoryActionUrl)||Wc.a.U8),this.iB.km(Hd.a.URa,Object(gb.a)(this,this.EDb,"receivePostMessageFromVHSession")),this.iB.km(Hd.a.VRa,Object(gb.a)(this,this.EDb,"receivePostMessageFromVHSession")),this.iB.vn(Ma.a.setCurrentChangeCount),this.iB.vn(Ma.a.setTotalChangesCount),Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.iB.vn(Ma.a.SMa),this.iB.km(Ma.a.setCurrentChangeCount,Object(gb.a)(this,this.EDb,"receivePostMessageFromVHSession")),this.iB.km(Ma.a.setTotalChangesCount,Object(gb.a)(this,this.EDb,"receivePostMessageFromVHSession")),Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.iB.km(Ma.a.SMa,Object(gb.a)(this,this.EDb,"receivePostMessageFromVHSession")))}catch(Hf){this.Zld=0,this.Kxb="",ed.addEvent("Exception",Hf.toString()),pb.ULS.sendTraceTag(42016832,
0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",Hf)}finally{pb.ULS.sendTraceTag(42016833,0,50,ed?ed.getJsonForLogging():"")}}}else pb.ULS.sendTraceTag(42016802,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else pb.ULS.sendTraceTag(42016801,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Oc.prototype.bDj=function(Sb){for(var Hc=Ml(this.perfTelemetryInfos),ed=Hc.next();!ed.done;ed=Hc.next()){var Id=ed.value;ed=
Id.TelemetryEventKey?Id.TelemetryEventKey:Id.telemetryEventKey?Id.telemetryEventKey:"";Id=Id.TelemetryEventData?Id.TelemetryEventData:Id.telemetryEventData?Id.telemetryEventData:"";ed&&Id&&Sb.addEvent(ed,Id)}Array.clear(this.perfTelemetryInfos)};Oc.prototype.fnf=function(Sb){switch(Sb){case 101:Sb="VHFailedToGetDownloadToken";break;case 100:Sb="VHFailedToLoadVersionList";break;case 104:Sb="VHVersioningNotEnabled";break;case 105:Sb="VHFileNotFound";break;case 106:Sb="VHVersionTooOld";break;default:Sb=
"None"}this.aD.addEvent("OnFullAppError",Sb);pb.ULS.sendTraceTag(42468675,0,10,"FullApp Error Event: {0}",Sb)};Oc.prototype.noe=function(Sb){pb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",Sb?Sb.getJsonForLogging():"")};Oc.prototype.Obi=function(){for(var Sb=this.$.fa.Lm,Hc={},ed=null,Id=Ml(Sb),hf=Id.next();!hf.done;hf=Id.next())hf=hf.value,hf.UserEmail&&(Hc[hf.UserEmail]=hf.UserEmail in Hc?Hc[hf.UserEmail]+1:1),hf.User.UserID===this.$.fa.clientId&&(ed=hf.UserEmail);
pb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",Sb.length,ed?Hc[ed]:-1)};Oc.prototype.Bud=function(Sb){this.Vwe=Sb;pb.ULS.sendTraceTag(51175900,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",Sb.toString());var Hc={};this.oGd(Ma.a.FJb,(Hc.ToggleValue=Sb,Hc))};Oc.prototype.uof=function(Sb){pb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",Sb);eb.c(1488635506,
!0);var Hc={};Sb?this.oGd(Ma.a.iterateNext,Hc):this.oGd(Ma.a.Mva,Hc)};Oc.prototype.EDb=function(Sb){switch(Sb.MessageId){case Hd.a.URa:pb.ULS.sendTraceTag(50708956,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");Ue.EwaSettings.ka(443)&&this.tm.setVersionLoadComplete();break;case Hd.a.VRa:pb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case Ma.a.setCurrentChangeCount:Sb=Sb.Values.count;pb.ULS.sendTraceTag(50469005,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",Sb);this.tm.setCurrentChangeCount(Sb);break;case Ma.a.setTotalChangesCount:Sb=Sb.Values.count;pb.ULS.sendTraceTag(50469006,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",Sb);this.tm.setTotalChangesCount(Sb);break;case Ma.a.SMa:this.Bud(this.Vwe);break;default:pb.ULS.sendTraceTag(51175901,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",Sb.MessageId)}};
Oc.prototype.oGd=function(Sb,Hc){pb.ULS.sendTraceTag(50405841,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",Sb);if(this.iB){Sb=new ge.a(Sb);Sb.Values[Ed.a.l_c]=this.$.Ba.UserSessionId;if(Hc)for(var ed in Hc)Sb.Values[ed]=Hc[ed];this.iB.send(Sb)}else pb.ULS.sendTraceTag(50405842,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Oc.kE=function(Sb){return Sb?Sb.RevisionID?Sb.RevisionID:Sb.revisionID?Sb.revisionID:"":
""};Oc.nyh=function(Sb){return Sb?Sb.DownloadUrl?Sb.DownloadUrl:Sb.downloadUrl?Sb.downloadUrl:"":""};Oc.Kih="_excelVersionHistoryOverlay";Oc.Jih="vhs_frame";Oc.$Yf="TimeTakenShowVersionHistoryDialogAction";Oc.cZf="TimeTillVersionHistoryDialogWasOpenMs";Oc.PNd="TimeTakenGetVersionsToOnVersionsReady";Oc.uRg="CountOnVersionSelectedCalledinOneVHSession";Oc.vRg="CountOnVersionsReadyCalledinOneVHSession";Oc.tRg="CountOnDownloadTokenReadyCalledinOneVHSession";Oc.aZf="TimeTakenVersionRestore";Object(Hb.a)(Oc,
"VersionHistoryPaneActor",null,[7]);var pd=b(333),Yd=hc.a;Cm(td,Yd);td.prototype.Rd=function(){var Sb=this,Hc=this.ebi(),ed=Xb.GetServiceTaskFactory.Xa(this.$.ea,21,137,this.vb,"Postmessage.IHostPostmessenger");Ic.TaskExtensions.Da(Ic.TaskExtensions.Fe([Hc,ed],this.ma,3),function(){var Id=ed.result,hf=Xa.a.K$(Sb.$.Ba.VersionHistoryActionUrl);hf!==Wc.a.U8&&Id.XDa(hf);Id=new Oc(Sb.$);Sb.Hd([new La(Sb.$,Id)])},this.ma,3)};td.prototype.ebi=function(){var Sb=Xb.GetServiceTaskFactory.PSe(this.$.ea,this.vb).then(function(Hc){return Hc.xq.loadScript("excelVersionHistory")},
function(Hc){pb.ULS.sendTraceTag(41239234,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Hc);return Promise.reject(Hc)});return pd.c(Sb)};td.la=function(Sb){hc.a.ie(304,new td(Sb))};Object(Hb.a)(td,"VersionHistoryCommandHandlerFactory",hc.a,[]);var be=b(1235),me=Ub.a;Cm(kc,me);kc.prototype.create=function(){var Sb=this,Hc=Xb.GetServiceTaskFactory.Xa(this.$.ea,211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),ed=Xb.GetServiceTaskFactory.Xa(this.$.ea,
21,137,this.vb,"Postmessage.IHostPostmessenger");Ic.TaskExtensions.Da(Ic.TaskExtensions.Fe([Hc,ed],this.$.ma),function(){Sb.Jb(Sb.$.ea.Ea(305,void 0)||new be.a(Sb.$,!0,ed.result,Hc.result))},this.$.ma,3)};kc.la=function(Sb){Sb.ea.La(306,new kc(Sb))};Object(Hb.a)(kc,"VersionHistoryHighlightManagerFactory",Ub.a,[]);var Gd=b(514),Rd=b(4),Yf=b(161),mg=b(16),zf=Qa.a;Cm(vb,zf);vb.prototype.execute=function(Sb){this.lineageManager.lineageHidePreviousHistory();return zf.prototype.execute.call(this,Sb)};Object(Hb.a)(vb,
"LineageClearHistoryConfirmedActivity",Qa.a,[]);var Ce=b(17),ne=b(131);Ab.prototype.$c=function(){return!1};Ab.prototype.executeCommand=function(Sb,Hc,ed){Sb=!1;switch(Hc.command){case 1834994092:9===Hc.qf&&this.inj();this.nfj(Hc,ed);Sb=!0;break;case -409942531:this.qfj(),Sb=!0}return Sb?$c.Task.Ua(!0):Qc.a(Hc.command)};Ab.prototype.Jc=function(Sb,Hc){return 1834994092===Hc.command||-409942531===Hc.command};Ab.prototype.gd=function(){return!1};Ab.prototype.nfj=function(Sb,Hc){pb.ULS.sendTraceTag(593854557,
0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",Hc.MenuItemId||Sb.qf);this.lineageManager.vTf(19===Sb.qf&&!!Hc.MenuItemId,Hc.MenuItemId,Sb.qf)};Ab.prototype.inj=function(){var Sb=Rd.a.Qlc;Sb!==Yf.a(this.$).Hn.wo&&Yf.a(this.$).Hn.activateRibbonTab(Sb)};Ab.prototype.qfj=function(){var Sb=this;kb.a(this.$).Nr(new yb.a(Nc.a.Hmd,5,function(){var Hc=uc.a(Sb.$).ld,ed=Ke.a.Ad(3,1,2129,2130,2131,1038647878,"LineageConfirmClearHistory");ed.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";
ed.HelpDescription=mg.a.instance.da(1254);Hc.it([ed])}))};Object(Hb.a)(Ab,"LineageActivityCommandHandler",null,[159]);var Bf=hc.a;Cm(zc,Bf);zc.prototype.Rd=function(){var Sb=this;Ic.TaskExtensions.Da(Xb.GetServiceTaskFactory.Xa(this.$.ea,366,367,this.vb,"Microsoft.Office.Excel.WebUI.Client.ILineageManager"),function(Hc){Sb.Hd([new Ab(Sb.$,Hc.result)])},this.ma,3)};zc.la=function(Sb){hc.a.ie(363,new zc(Sb))};Object(Hb.a)(zc,"LineageActivityCommandHandlerFactory",hc.a,[]);ec.prototype.K3a=function(){return!this.pab};
ec.x3e=function(){return ec.q3e()&&Ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)};ec.q3e=function(){return Ue.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Hb.a)(ec,"LineageCatchUpExperimentManager",null,[707]);var Le=Ub.a;Cm(Za,Le);Za.prototype.create=function(){var Sb=this;ec.x3e()?Ic.TaskExtensions.Da(Xb.GetServiceTaskFactory.Xa(this.$.ea,456,457,this.vb,
"Microsoft.Office.Excel.WebUI.Client.Callouts.ILineageDiscoverabilityCallout"),function(Hc){Ic.TaskExtensions.Da(Hc.result.Sdj(),function(ed){Sb.Zue(ed.result)},Sb.$.ma,3)},this.$.ma,3):this.Zue(!0)};Za.prototype.Zue=function(Sb){this.Jb(this.$.ea.Ea(458,void 0)||this.$.ea.La(458,new ec(Sb)))};Za.la=function(Sb){Sb.ea.La(459,new Za(Sb))};Object(Hb.a)(Za,"LineageCatchUpExperimentManagerFactory",Ub.a,[]);var gd=b(405),$b=b(43),Fc=b(88),Vc=b(145),ud=b(119);Object(Hb.a)(fb,"LineageClientParams",null,
[]);Object(Hb.a)(E,"LineageFilter",null,[]);var Ge=b(63),ce=b(79),Ae=b(110),Ob=b(46),ac=b(519),fc=b(160),Uc=b(127),Vd=b(109),ld=b(303),Od=b(273),De=b(106),Yb=b(20),sa=b(108),hb=b(81),cc=b(50),xc=b(338);Object(Hb.a)(Ua,"LineageActivitiesResponseDTO",null,[]);Cm(va,Ua);Object(Hb.a)(va,"LineageActivitiesUpdateResponseDTO",Ua,[]);Object(Hb.a)(Ia,"LineageAppCallbacks",null,[]);Object(Hb.a)(za,"LineageAuthorDTO",null,[]);Object(Hb.a)(qb,"LineageControllerFactoryParams",null,[]);Object(Hb.a)(Ta,"LineageSharedRangeDTO",
null,[]);Object(Hb.a)(db,"LineageSheetMultiRangeDTO",null,[]);Object(Hb.a)(ta,"LineageUserActivityDTO",null,[]);Object(Hb.a)(ua,"LineageValueChangeDTO",null,[]);Ra.prototype.dispose=function(){this.VRi();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.hN(Object(gb.a)(this,this.onPaneClosed,"onPaneClosed")),this.lineageTaskPane.XC(Object(gb.a)(this,this.Wy,"onPaneVisibilityChanged")),this.lineageTaskPane=null);this.QHb=this.tlc=this.Gqb=this.Gmd=this.FE=null};Ra.prototype.vTf=function(Sb,Hc,
ed){if(this.lineageTaskPane.isVisible){if(9===ed){pb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Sb&&(!Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5554950_interactiveElement")||16!==ed&&18!==ed)){this.lineageTaskPane.pWc();return}}$b.a.Sd(this.$)&&Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")||(this.QHb.start(),this.y6&&(cc.b().AB(this.QHb.id,this.y6.id,"actions",
"actions"),this.y6.stop(),this.y6=null));this.lineageTaskPane.jcc||pb.ULS.sendTraceTag(591161311,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",Sb?Hc:ed);this.xD=this.$.fa.zf;this.Gqb=null;Sb&&(Sb=Ob.r(this.gridView.ga.ya.selectedRanges,this.$),this.Gqb=Object.assign(new db,{rangeList:Hc.toString()===Rd.a.RSf?this.Rsb(Sb.Ranges):null,sheetName:Sb.SheetName}));$b.a.Sd(this.$)&&Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")&&this.lineageTaskPane.jcc?
this.lineageTaskPane.p8i(Object(gb.a)(this,this.SAb,"onLineagePaneOpened")):this.FE.createLineagePane(this.Gmd,this.Gqb);this.lineageTaskPane.Rf(!0);this.$.Re(-71295319,-1,0,null)};Ra.prototype.SAb=function(){this.y6&&(this.y6.stop(),this.y6=null);this.QHb.start();this.FE.createLineagePane(this.Gmd,this.Gqb)};Ra.prototype.lineageHidePreviousHistory=function(){function Sb(Id,hf,Hf){var Cg=Hc.$.ra.xa,uf=Cg.Ra(1,null);return hb.i(Cg,"LineageHidePreviousHistory",uf,Id,hf,Hf,null,0)}var Hc=this,ed={};
ed=(ed.paneVisible=this.lineageTaskPane.isVisible,ed);Vc.a.sendTelemetryEvent(Object.assign(new xc.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:ud.a.kG(ed)}));Ue.EwaSettings.wc()?this.$.userOperationManager.oc(new fc.a(1018,0,Sb,64),null):this.$.userOperationManager.oc(new ac.a(1018,0,Sb,0),null);this.lineageTaskPane.isVisible||this.vTf(!1,null,4)};Ra.prototype.TVh=function(){var Sb=this,Hc=Object.assign(new Ia,{tryParseRangeInfo:Object(gb.a)(this,this.tryParseRangeInfo,
"tryParseRangeInfo"),isFeatureEnabled:Object(gb.a)(this,this.isFeatureEnabled,"isFeatureEnabled"),onCardSelected:Object(gb.a)(this,this.onCardSelected,"onCardSelected"),onVersionHistoryButtonClicked:Object(gb.a)(this,this.onVersionHistoryButtonClicked,"onVersionHistoryButtonClicked"),onRangeFilterInputEnabled:Object(gb.a)(this,this.onRangeFilterInputEnabled,"onRangeFilterInputEnabled"),onLearnMoreLinkClicked:Object(gb.a)(this,this.onLearnMoreLinkClicked,"onLearnMoreLinkClicked"),lineageOpenPaneOrChangeFilterRequest:Object(gb.a)(this,
this.lineageOpenPaneOrChangeFilterRequest,"lineageOpenPaneOrChangeFilterRequest"),lineageLoadMoreRequest:Object(gb.a)(this,this.lineageLoadMoreRequest,"lineageLoadMoreRequest"),lineageRefreshViewRequest:Object(gb.a)(this,this.lineageRefreshViewRequest,"lineageRefreshViewRequest"),lineageUpdateViewRequest:Object(gb.a)(this,this.lineageUpdateViewRequest,"lineageUpdateViewRequest")});id.a(function(){Sb.FE=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new qb,
{clientBatchSize:Sb.batchSize,filterableSheetList:Sb.B1a(),uiCulture:Sb.$.Ba.UICultureTag,dataCulture:Sb.$.Ba.DataCultureTag,logger:new ae.a,lineageAppCallbacks:Hc}))})};Ra.prototype.lineageOpenPaneOrChangeFilterRequest=function(Sb,Hc){function ed(uf,ih,qa){var tb=hf.$.ra.xa,rc=Cg;uf=Od.b(uf,hf.g$c("LineageOpenPaneOrChangeFilter"));ih=Od.a(ih,Id);var kd=tb.Ra(1,null);kd.clientParams=Hf;kd.lineageFilter=rc;return hb.i(tb,"LineageOpenPaneOrChangeFilter",kd,uf,ih,qa,null,0)}function Id(uf){uf=Uc.a.Eg(uf.data);
pb.ULS.sendTraceTag(575447172,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",Ke.a.fd(uf))}var hf=this;this.QHb.stop();sa.b(this.$).Jd(Ae.a.lvi,{});this.Ihj();var Hf=Object.assign(new fb,{ClientViewCapacity:Sb.clientViewCapacity}),Cg=null;Hc&&(Cg=Object.assign(new E,{FilterSheetMultiRange:this.Brj(Hc.filterSheetMultiRange)}));Ue.EwaSettings.wc()?this.$.userOperationManager.oc(new fc.a(1010,0,ed,80),null):this.$.userOperationManager.oc(new ac.a(1010,0,ed,16),
null)};Ra.prototype.lineageLoadMoreRequest=function(Sb){function Hc(hf,Hf,Cg){var uf=Id.$.ra.xa;hf=Od.b(hf,Id.g$c("LineageLoadMore"));Hf=Od.a(Hf,ed);var ih=uf.Ra(1,null);ih.fetchFromBelow=Sb;return hb.i(uf,"LineageLoadMore",ih,hf,Hf,Cg,null,0)}function ed(hf){hf=Uc.a.Eg(hf.data);pb.ULS.sendTraceTag(575447171,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Ke.a.fd(hf))}var Id=this;sa.b(this.$).Jd(Ae.a.kvi,{});Ue.EwaSettings.wc()?this.$.userOperationManager.oc(new fc.a(1011,
0,Hc,80),null):this.$.userOperationManager.oc(new ac.a(1011,0,Hc,16),null)};Ra.prototype.lineageRefreshViewRequest=function(){function Sb(Id,hf,Hf){var Cg=ed.$.ra.xa;Id=Od.b(Id,ed.g$c("LineageRefreshView"));hf=Od.a(hf,Hc);var uf=Cg.Ra(1,null);return hb.i(Cg,"LineageRefreshView",uf,Id,hf,Hf,null,0)}function Hc(Id){Id=Uc.a.Eg(Id.data);pb.ULS.sendTraceTag(575447170,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Ke.a.fd(Id))}var ed=this;sa.b(this.$).Jd(Ae.a.mvi,{});Ue.EwaSettings.wc()?
this.$.userOperationManager.oc(new fc.a(1012,0,Sb,80),null):this.$.userOperationManager.oc(new ac.a(1012,0,Sb,16),null)};Ra.prototype.g$c=function(Sb){var Hc=this;return function(ed){if(ed=ld.a(ed)?null:ed.Result){var Id={};Id=(Id.CountOfActivities=ed.ActivityList.length,Id);Id.WebRequestName=Sb;sa.b(Hc.$).Jd(Ae.a.Usi,Id);ed=Object.assign(new Ua,{activityList:Hc.kyd(ed.ActivityList),latestActivityId:ed.LastSearchedActivityId,oldestActivityId:ed.FirstSearchedActivityId,serverMessageCode:ed.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(ed.EcmaLastSearchedDate),serverFirstActivityId:ed.ServerFirstActivityId,serverLastActivityId:ed.ServerLastActivityId,showLoadPrevious:ed.ShowLoadPrevious,eolCorrelationId:ed.EolCorrelationId,eolDateHideHistory:new Date(ed.EolDateHideHistory),eolPersonHideHistory:Hc.Msb(ed.EolPersonHideHistory)});Hc.FE.onLineageActivitiesResponse(ed)}else pb.ULS.shipAssertTag(592724495,0,!!ed,"LineageManager."+Sb+" returned null response.")}};Ra.prototype.lineageUpdateViewRequest=
function(){var Sb=this;ia(this.$.ra.xa,function(Hc){if(Hc=ld.a(Hc)?null:Hc.Result){var ed={};ed=(ed.CountOfUpdatedActivities=Hc.LineageActivitiesResponse.ActivityList.length,ed);sa.b(Sb.$).Jd(Ae.a.nvi,ed);Hc=Object.assign(new va,{activityList:Sb.kyd(Hc.LineageActivitiesResponse.ActivityList),latestActivityId:Hc.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:Hc.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:Hc.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Hc.LineageActivitiesResponse.EcmaLastSearchedDate),
hasNewActivities:Hc.HasNewActivities,filterSheetMultiRange:Sb.rrj(Hc.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:Hc.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:Hc.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:Hc.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:Hc.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(Hc.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:Sb.Msb(Hc.LineageActivitiesResponse.EolPersonHideHistory)});
Sb.FE.onLineageActivitiesUpdateResponse(Hc)}else pb.ULS.shipAssertTag(575447168,0,!!Hc,"LineageManager.LineageUpdateView returned null response.")},function(Hc){Hc=Uc.a.Eg(Hc.data);pb.ULS.sendTraceTag(575447139,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Ke.a.fd(Hc))},null,null)};Ra.prototype.rrj=function(Sb){return Vd.e(Sb.Ranges)&&Pb.a.na(Sb.SheetName)?null:Object.assign(new db,{rangeList:this.Rsb(Sb.Ranges),sheetName:Sb.SheetName})};Ra.prototype.Rsb=function(Sb){var Hc=
[];Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())ed=ed.value,ed=Object.assign(new Ta,{firstCol:ed.FirstColumn,firstRow:ed.FirstRow,lastRow:ed.LastRow,lastCol:ed.LastColumn}),Hc.push(ed);return Hc};Ra.prototype.Brj=function(Sb){if(!Sb)return null;var Hc={};Hc.Ranges=this.$$c(Sb.rangeList);Hc.SheetName=Sb.sheetName;return Hc};Ra.prototype.$$c=function(Sb){var Hc=[];if(Vd.e(Sb))return Hc;Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next()){ed=ed.value;var Id={};Id.FirstColumn=ed.firstCol;Id.FirstRow=
ed.firstRow;Id.LastRow=ed.lastRow;Id.LastColumn=ed.lastCol;Hc.push(Id)}return Hc};Ra.prototype.onCardSelected=function(Sb,Hc){if(Sb=Sb.rangeHighlightLocation){if(Hc){var ed=Ob.Y(Hc,null);var Id=ed.range;if(ed.returnValue){this.m_e(Sb.sheetName,this.Rsb([Ob.j(Id)]));return}pb.ULS.shipAssertTag(556799200,0,!1,"The produced subCellLocation string "+Hc+" is not valid.")}Sb.rangeList.length?this.m_e(Sb.sheetName,Sb.rangeList):this.yRh(Sb.sheetName)}};Ra.prototype.yRh=function(Sb){(Sb=this.$.Aa.getItemByName(Sb))&&
Sb.visible&&Sb.activate(!0)};Ra.prototype.m_e=function(Sb,Hc){var ed=[];Hc=Ml(Hc);for(var Id=Hc.next();!Id.done;Id=Hc.next()){Id=Id.value;var hf={};hf.FirstColumn=Id.firstCol;hf.FirstRow=Id.firstRow;hf.LastRow=Id.lastRow;hf.LastColumn=Id.lastCol;ed.push(Ob.D(hf))}Hc=ed.length-1;Id=ed[Hc].topLeft;Yb.g(this.$).sU(ed,Hc,Sb,null,Id,null,null,3,De.a.jai,void 0,void 0,void 0,!0)};Ra.prototype.onLearnMoreLinkClicked=function(){if(Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var Sb=
new he.a(-859308420,ce.a.Yb,this.$.jd,12,null),Hc={};Hc=(Hc.CommandValueId="HelpID=XLO_LineageTS",Hc.InputMethod=ce.a.Yb,Hc.MenuItemId=Rd.a.bZ,Hc.ShouldCanvasTakeFocus=!0,Hc);this.$.Na.Xb(Sb,Hc)}};Ra.prototype.onVersionHistoryButtonClicked=function(Sb){this.$.Na.Xb(new he.a(-1112508866,Sb,this.$.jd,12,null))};Ra.prototype.isFeatureEnabled=function(Sb){switch(Sb){case "ScrollToIndexAndSeparatorEnabled":return Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4879296_ScrollToIndexAndSeparatorEnabled");
case "EolCorrelationIdCheckEnabled":return Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5197331_EolCorrelationIdCheckEnabled");case "ServerClientOutOfSyncHandlingEnabled":return Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5343119_ServerClientOutOfSyncHandlingEnabled");default:return!1}};Ra.prototype.refreshRequired=function(){this.FE&&this.lineageTaskPane.isVisible&&(this.xD=this.$.fa.zf,this.FE.onRefreshRequired())};Ra.prototype.hg=function(){var Sb=this.$.fa.Gn.LineageVersion;Sb!==this.Lmd&&
(pb.ULS.sendTraceTag(591696593,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",Sb,this.Lmd),this.Lmd=Sb,this.refreshRequired())};Ra.prototype.xog=function(){this.lineageTaskPane.sL(Object(gb.a)(this,this.onPaneClosed,"onPaneClosed"));this.lineageTaskPane.EB(Object(gb.a)(this,this.Wy,"onPaneVisibilityChanged"));this.$.fa.ot(Object(gb.a)(this,this.hg,"onWorkbookMetadataChanged"));this.$.fa.ak(Object(gb.a)(this,this.ed,"onSessionIdChanged"));this.$.fa.DO(Object(gb.a)(this,
this.rq,"onLoadOnDemandOccurred"));var Sb=this.$.Aa;Sb.MX(Object(gb.a)(this,this.zC,"onSheetDeleted"));Sb.Sfa(Object(gb.a)(this,this.ojc,"onSheetAddedOrVisibilityChanged"));Sb.gEa(Object(gb.a)(this,this.hxa,"onSheetRenamed"));Sb.kWa(Object(gb.a)(this,this.ojc,"onSheetAddedOrVisibilityChanged"))};Ra.prototype.VRi=function(){this.$.fa.ow(Object(gb.a)(this,this.hg,"onWorkbookMetadataChanged"));this.gridView.ga.nca(Object(gb.a)(this,this.nd,"onSelectionChanged"));this.$.fa.xk(Object(gb.a)(this,this.ed,
"onSessionIdChanged"));this.$.fa.WV(Object(gb.a)(this,this.rq,"onLoadOnDemandOccurred"));var Sb=this.$.Aa;Sb.h6(Object(gb.a)(this,this.zC,"onSheetDeleted"));Sb.ula(Object(gb.a)(this,this.ojc,"onSheetAddedOrVisibilityChanged"));Sb.lOa(Object(gb.a)(this,this.hxa,"onSheetRenamed"));Sb.AEb(Object(gb.a)(this,this.ojc,"onSheetAddedOrVisibilityChanged"))};Ra.prototype.onStaleActivitiesDetected=function(){this.FE.onStaleActivitiesDetected()};Ra.prototype.ed=function(Sb,Hc){this.FE&&!this.lineageTaskPane.jcc&&
Hc.TG&&(pb.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),this.onStaleActivitiesDetected())};Ra.prototype.rq=function(){this.FE&&!this.lineageTaskPane.jcc&&(pb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),this.onStaleActivitiesDetected())};Ra.prototype.zC=function(){var Sb=this.B1a();this.FE.onFilterableSheetListChange(Sb)};Ra.prototype.hxa=function(){var Sb=this.B1a();this.FE.onFilterableSheetListChange(Sb)};Ra.prototype.ojc=function(){var Sb=
this.B1a();this.FE.onFilterableSheetListChange(Sb)};Ra.prototype.B1a=function(){for(var Sb=[],Hc=Ml(this.$.Aa.items),ed=Hc.next();!ed.done;ed=Hc.next())ed=ed.value,ed.visible&&!Ge.e(ed)&&Sb.push(ed.sheetName);return Sb};Ra.prototype.onPaneClosed=function(){this.FE.onPaneClosed();Kb(this.$.ra.xa,null,function(Sb){Sb=Uc.a.Eg(Sb.data);pb.ULS.sendTraceTag(575022273,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Ke.a.fd(Sb))},null,null)};Ra.prototype.onRangeFilterInputEnabled=
function(Sb){Sb?this.gridView.ga.I1(Object(gb.a)(this,this.nd,"onSelectionChanged")):this.gridView.ga.nca(Object(gb.a)(this,this.nd,"onSelectionChanged"))};Ra.prototype.nd=function(){var Sb=Ob.q(this.gridView.ga.ya.activeRange,this.$);Sb=Object.assign(new db,{rangeList:this.Rsb(Sb.Ranges),sheetName:Sb.SheetName});this.FE.onSelectedRangeUpdated(Sb)};Ra.prototype.tryParseRangeInfo=function(Sb){var Hc=Ob.Y(Sb,this.$.Aa);var ed=Hc.sheetName;Sb=Hc.range;return Hc.returnValue?(ed||(ed=this.$.Aa.sa.sheetName),
Hc=[],Hc.push(Sb),Sb=Ob.u(ed,null,Hc),Object.assign(new db,{rangeList:this.Rsb(Sb.Ranges),sheetName:Sb.SheetName})):null};Ra.prototype.Wy=function(){var Sb=this.xD!==this.$.fa.zf;this.FE&&this.lineageTaskPane.isVisible&&Sb&&(this.xD=this.$.fa.zf,this.FE.onRefreshRequired())};Ra.prototype.Ihj=function(){if(Ue.EwaSettings.ka(655)){var Sb=this.$.ea.Ea(403,void 0);Sb&&Sb.disable();Sb=new he.a(-847286761,ce.a.Yb,this.$.jd,0,Rd.a.XQ);var Hc={};Hc=(Hc.InputMethod=ce.a.Yb,Hc);Hc.CalloutName=5;this.$.Na.Xb(Sb,
Hc)}};Ra.prototype.kyd=function(Sb){var Hc=[];Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())ed=ed.value,ed=Object.assign(new ta,{activityId:Number.parseLocale(ed.UserActivity.Id),activityGuid:ed.Uid,activityType:ed.UserActivity.Type,author:this.Msb(ed.UserActivity.Person),sheetName:ed.SheetName,displayTimestamp:new Date(ed.UserActivity.DisplayTimestamp),gridLocation:ed.DisplayLocation,valueChanges:this.JJi(ed.LineageValueChangeList),isBulkEditOverflow:ed.IsBulkEditOverFlow,rangeHighlightLocation:this.xJi(ed.UserActivity.LocationList,
ed.UserActivity.Type),nestedActivityList:this.qJi(ed.NestedActivityList),degradedCardTypeBits:ed.DegradedCardTypeBits}),Hc.push(ed);return Hc};Ra.prototype.xJi=function(Sb,Hc){if(!Sb)return pb.ULS.sendTraceTag(593601666,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!Sb.length)return pb.ULS.sendTraceTag(593601665,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var ed=[],Id=[],hf="";21===Hc?Id.push(Sb[0]):Id=Sb;Sb=Ml(Id);for(Id=
Sb.next();!Id.done;Id=Sb.next())switch(Id=Id.value,Id.Type){case 1:break;case 2:hf=Id.SheetName;break;case 0:if(!Id.RangeList){pb.ULS.sendTraceTag(593601635,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}hf=Id.RangeList[0].SheetName;var Hf=[];21===Hc?Hf.push(Id.RangeList[0]):Hf=Id.RangeList;Id=Ml(Hf);for(Hf=Id.next();!Hf.done;Hf=Id.next())Hf=Hf.value,Hf=Object.assign(new Ta,{firstCol:Hf.FirstColumn,firstRow:Hf.FirstRow,lastRow:Hf.LastRow,lastCol:Hf.LastColumn}),
ed.push(Hf);break;default:pb.ULS.sendTraceTag(593601634,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Id.Type)}return Object.assign(new db,{sheetName:hf,rangeList:ed})};Ra.prototype.JJi=function(Sb){var Hc=[];Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())ed=ed.value,ed=Object.assign(new ua,{hasNewValue:ed.HasNewValue,hasOldValue:ed.HasOldValue,newValue:ed.HasNewValue?ed.NewValue:null,oldValue:ed.HasOldValue?ed.OldValue:null,cellLocation:ed.CellLocation}),
Hc.push(ed);return Hc};Ra.prototype.qJi=function(Sb){return Sb?this.kyd(Sb):null};Ra.prototype.Msb=function(Sb){if(!Sb)return null;var Hc=null;Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Mb.AFrameworkApplication.ha.ta("IsUserProfilePictureResolutionEnabled")&&(Hc=this.tlc.cGa(Sb.Email,Sb.Provider,Mb.AFrameworkApplication.hj,0));return Object.assign(new za,{id:Sb.Id,provider:Sb.Provider,displayName:Sb.DisplayName,email:Sb.Email,imageUrl:Hc})};
Object(Hb.a)(Ra,"LineageManager",null,[706,7]);var vd=Ub.a;Cm(ca,vd);ca.prototype.Pai=function(Sb){var Hc=this;Ic.TaskExtensions.Da(Sb,function(){Hc.Jb(Hc.$.ea.Ea(366,void 0)||new Ra(Hc.$,Hc.$.ea,Hc.lineageTaskPane,Hc.y6))},this.$.ma,3)};ca.prototype.create=function(){var Sb=this;this.y6=this.$.Zb.Ic("UserAction","LineagePaneSeenStopwatch");this.y6.start();var Hc=Xb.GetServiceTaskFactory.Xa(this.$.ea,365,364,this.vb,"Microsoft.Office.Excel.WebUI.Client.ILineageTaskPane"),ed=gd.a(this.$),Id=Xb.GetServiceTaskFactory.Xa(this.$.ea,
283,284,this.vb,"Common.IDynamicScriptLoaderProvider");Ic.TaskExtensions.Da(Ic.TaskExtensions.Fe([Hc,ed,Id],this.$.ma),function(){Sb.lineageTaskPane=Hc.result;$b.a.Sd(Sb.$)||ed.result.aQ(Sb.lineageTaskPane);Sb.Pai(pd.c(Id.result.xq.loadScript("cellLineage")))},this.$.ma,3)};ca.la=function(Sb){Sb.ea.La(367,new ca(Sb))};Object(Hb.a)(ca,"LineageManagerFactory",Ub.a,[]);var Xd=b(904),Je=b(276),ff=b(13),Ye=b(120),Pe=b(275),wf=b(90),lf=b(227),kg=b(18),Bg=b(808),Qf=b(65),Ug=lf.a;Cm(Ha,Ug);Ha.prototype.YF=
function(Sb){this.get_events().addHandler("LineageTaskPaneRemove",Sb)};Ha.prototype.BH=function(Sb){this.get_events().removeHandler("LineageTaskPaneRemove",Sb)};Ha.prototype.EB=function(Sb){this.addHandler("LineageTaskPaneVisibilityChanged",Sb)};Ha.prototype.XC=function(Sb){this.removeHandler("LineageTaskPaneVisibilityChanged",Sb)};Ha.prototype.sL=function(Sb){this.get_events().addHandler("LineageTaskPaneClose",Sb)};Ha.prototype.hN=function(Sb){this.get_events().removeHandler("LineageTaskPaneClose",
Sb)};Ha.prototype.Uv=function(){};Ha.prototype.YB=function(){};Ha.prototype.ln=function(){return this.cp};Ha.prototype.Ep=function(){return this.cp};Ha.prototype.UE=function(){};Ha.prototype.LG=function(){return!1};Ha.prototype.vi=function(){};Ha.prototype.ei=function(){};Ha.prototype.dispose=function(){this.$&&(this.$.Xo(Object(gb.a)(this,this.Yd,"onWorkbookClosing")),jd.a(this.$).UA(this));this.se&&(Je.a.instance.Ca(ff.a.click,this.se,Object(gb.a)(this,this.Uj,"onClosePaneClick")),Ye.KeyInputManager.instance.jv(this.se,
this.Xqe));this.se=this.taskPaneManager=this.$=null;Ug.prototype.dispose.call(this)};Ha.prototype.Ye=function(Sb,Hc){if(!Hc){Sb=Zb.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Sb)return!1;Zb.DOMElementExtensions.setFocus(Sb)}return!Hc};Ha.prototype.Lh=function(Sb){return Zb.DOMElementExtensions.jf(this.Nb,Sb)};Ha.prototype.Rf=function(Sb){this.cp=Sb;var Hc=this.taskPaneManager;if(this.isVisible=Sb)this.$.frame.Te.Ij("LineagePane"),this.Yid=!1;if($b.a.Sd(this.$))Sb?
Hc.QQ("LineageTaskPane",this.GK):Hc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.$o();var ed=!!this.taskPaneManager.Dg&&15===this.taskPaneManager.Dg.taskPane.xg;Sb&&0<Hc.mz.length&&(!ed||Hc.isCollapsed)&&Hc.$C(this,!0)}this.$.If()};Ha.prototype.LL=function(){var Sb=this.$.Mb;Sb=$b.a.Sd(this.$)?this.domElement:document.getElementById(Sb+Rd.a.Kmd);var Hc=this.hG();Sb.appendChild(Hc);Hc=Bg.b("div","LineagePaneBodyId","LineageActivityBody");Sb.appendChild(Hc);this.q8i();return Hc};Ha.prototype.pWc=
function(){this.$.frame.Te.Ij(this.$.frame.Te.XD||Pe.AFrame.HO);this.Yid=!0;this.Rf(!1);this.raiseEvent("LineageTaskPaneClose")};Ha.prototype.p8i=function(Sb){this.SAb=Sb};Ha.prototype.q8i=function(){this.$.frame.Te.Zj("LineagePane");var Sb=this.$.frame.Te.Wh("LineagePane");Sb.parent=Pe.AFrame.HO;Sb.pQ=!0};Ha.prototype.Yd=function(Sb,Hc){Hc.Yg||this.pWc()};Ha.prototype.hG=function(){var Sb=Bg.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Hc=Bg.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");
Hc.innerText=this.titleText;this.se=Xd.a.zb("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",mg.a.instance.da(10),"ClosePaneGlyph_16x16x32",!1);Sys.UI.DomElement.addCssClass(this.se,Mb.AFrameworkApplication.isRtl?Rd.a.v$:Rd.a.w$);Je.a.instance.qa(ff.a.click,this.se,Object(gb.a)(this,this.Uj,"onClosePaneClick"));this.Xqe=Ye.KeyInputManager.instance.Qr(this.se,Object(gb.a)(this,this.Uj,"onClosePaneClick"),wf.a.Vh);Sb.appendChild(Hc);Sb.appendChild(this.se);return Sb};Ha.prototype.Uj=
function(){this.pWc();return!0};Ha.la=function(Sb,Hc){var ed=Sb.Mb,Id=document.getElementById(ed+Rd.a.Kmd);Id||(Id=document.createElement("div"),Id.id=Sb.Mb+Rd.a.Kmd,Sys.UI.DomElement.addCssClass(Id,"LineageActivityPane"),$b.a.Sd(Sb)||document.getElementById(ed+Rd.a.HQ).appendChild(Id));return Sb.ea.Ea(365,void 0)||Sb.ea.La(365,new Ha(Id,Sb,Hc))};Jl.Object.defineProperties(Ha.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Qf.a)(Ha.prototype,this,"isVisible")},set:function(Sb){Object(Qf.a)(Ha.prototype,
this,"isVisible")!==Sb&&(Object(Qf.b)(Ha.prototype,this,"isVisible",Sb),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},jcc:{configurable:!0,enumerable:!0,get:function(){return this.Yid}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},xg:{configurable:!0,enumerable:!0,get:function(){return 15}},he:{configurable:!0,enumerable:!0,get:function(){return Zd.a.kai}},Rj:{configurable:!0,enumerable:!0,get:function(){return kg.a.ggh}},oC:{configurable:!0,enumerable:!0,
get:function(){return mg.a.instance.da(1008)}},Il:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.FK.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return mg.a.instance.da(1229)}},GK:{configurable:!0,enumerable:!0,get:function(){var Sb=this;return this.taskPaneManager.Ata(this.Nb,
this.titleText,this.Il,this.isResizable,function(){Sb.isVisible=!0;Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5645904_LineageWacTaskPaneInfraOpenPaneFlow")&&(Sb.SAb?Sb.SAb():pb.ULS.shipAssertTag(539096854,0,!1,"OnLineagePaneOpened callback not set."))},function(){Sb.isVisible=!1},function(){Sb.isVisible=!0},function(){Sb.isVisible=!1},this.Il)}}});Object(Hb.a)(Ha,"LineageTaskPane",lf.a,[704,7,224,135]);var Kf=Ub.a;Cm(Gb,Kf);Gb.prototype.create=function(){var Sb=this,Hc=Xb.GetServiceTaskFactory.create(this.$.ea,
203,this.ma,this.vb,"System.IDisposable"),ed=Xb.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary");Ic.TaskExtensions.Da(Ic.TaskExtensions.ts(Ic.TaskExtensions.Fe([Hc,ed],this.ma),function(){return Sb.FC},this.ma),function(){Sb.Jb(Sb.Wg)},this.ma,3)};Gb.prototype.dispose=function(){this.Wg=this.oi=this.$=null;Kf.prototype.dispose.call(this)};Gb.la=function(Sb){Sb.ea.La(364,new Gb(Sb))};Jl.Object.defineProperties(Gb.prototype,{FC:{configurable:!0,enumerable:!0,get:function(){var Sb=
this;this.oi||(this.oi=Ic.TaskExtensions.Da(gd.a(this.$),function(Hc){Sb.Wg=Ha.la(Sb.$,Hc.result)},this.ma,3));return this.oi}}});Object(Hb.a)(Gb,"LineageTaskPaneFactory",Ub.a,[]);nb.prototype.dispose=function(){this.uBd();this.$=null;pb.ULS.sendTraceTag(578076751,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};nb.prototype.disable=function(){nb.Mtb||(nb.Mtb=!0,pb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.uBd()};nb.prototype.hBj=
function(){var Sb=this;Ue.EwaSettings.ka(651)&&!this.$.isAnonymousUser()&&hb.l(this.$.ra.xa,function(Hc){Sb.$?(Hc=Hc.Result,pb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Hc),nb.GYe=!0,Hc&&Sb.j_f(0)):pb.ULS.sendTraceTag(570770392,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){pb.ULS.sendTraceTag(578557779,0,10,"CheckLineageWywaChanges service call failed.")},null,
null)};nb.prototype.bBj=function(){Ue.EwaSettings.ka(650)&&!this.w_f()&&(this.$.fa.ot(Object(gb.a)(this,this.hg,"onWorkbookMetadataChanged")),this.vjd=!0)};nb.prototype.w_f=function(){return this.$.fa&&this.$.fa.Gn&&this.$.fa.Gn.ShouldTriggerLineageCalloutOnMerge?(pb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.j_f(1),!0):!1};nb.prototype.hg=function(){this.w_f()};nb.prototype.j_f=function(Sb){if(nb.Mtb)pb.ULS.sendTraceTag(578557777,0,50,
"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(nb.Mtb=!0,pb.ULS.sendTraceTag(578557776,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",Sb),this.uBd(),Ue.EwaSettings.ka(510)){Sb=new he.a(-847286761,ce.a.Yb,this.$.jd,0,Rd.a.XQ);var Hc={};Hc=(Hc.CalloutName=4,Hc);this.$.Na.Xb(Sb,Hc)}};nb.prototype.uBd=function(){this.vjd&&(this.vjd=!1,this.$.fa.ow(Object(gb.a)(this,this.hg,"onWorkbookMetadataChanged")))};
nb.Mtb=!1;nb.GYe=!1;Object(Hb.a)(nb,"LineageTeachingCalloutTriggerManager",null,[705,7]);var Of=Ub.a;Cm(sb,Of);sb.prototype.create=function(){var Sb=this;Ic.TaskExtensions.Da(Xb.GetServiceTaskFactory.Xa(this.$.ea,458,459,this.vb,"Microsoft.Office.Excel.WebUI.Client.ILineageCatchUpExperimentManager"),function(Hc){Hc=new nb(Sb.$,Hc.result);Sb.Jb(Hc)},this.$.ma,3)};sb.la=function(Sb){Sb.ea.La(402,new sb(Sb))};Object(Hb.a)(sb,"LineageTeachingCalloutTriggerManagerFactory",Ub.a,[]);var hh=b(185),Eg=b(366),
ng=b(589),eg=b(579),Yg=b(183),Ud=b(87),Tc=b(85),qg=b(111),Lg=b(29);ib.prototype.show=function(Sb,Hc,ed,Id,hf,Hf,Cg){var uf=this;this.mgb||(this.QUd=void 0===Sb?null:Sb,this.IIc=void 0===Hc?null:Hc,this.b_d=void 0===Id?!1:Id,this.e_d=void 0===hf?!1:hf,this.wVd=void 0===Hf?null:Hf,this.Lhb=void 0===ed?null:ed,this.y_d=void 0===Cg?!1:Cg,Mb.AFrameworkApplication.za.Za.dH?Yg.UISurfaces.eM().then(function(ih){var qa=Object.assign(new eg.a,{onShow:function(){uf.wBb()},expirationOptions:Object.assign(new ng.a,
{onExpire:function(){uf.dismiss()},displayTimeoutSeconds:10})}),tb=ih.externalNotification();uf.GRb=ih.addNotification(tb,qa);return null},function(ih){pb.ULS.sendTraceTag(593352347,383,15,"Failed to GetNotificationsAPIAsync: {0}",ih);return null}):this.eBa?this.eBa.C9g(this,Object(gb.a)(this,this.wBb,"onShowApproved")):this.wBb())};ib.prototype.wBb=function(){if(!this.mgb&&(this.NCa=this.IIc?this.IIc:document.getElementById("WACDocumentPanel"))){this.Me.RCb();this.PF=document.createElement("Div");
this.PF.className="CatchUpActivityNotificationContainer CatchUpActivityNotificationContainerBorder";this.PF.id=Pe.AFrame.Jmb;this.NCa.appendChild(this.PF);this.b_d&&this.Lhb&&(this.ZHc=document.createElement("Div"),this.ZHc.className="CatchUpActivityNotificationBeakBorder CatchUpActivityNotificationBeak",this.PF.appendChild(this.ZHc),this.YHc=document.createElement("Div"),this.YHc.className="CatchUpActivityNotificationBeak",this.PF.appendChild(this.YHc));this.VYa(this.QUd,this.e_d,this.wVd,this.y_d);
this.Xj();if(this.Lhb){var Sb=Sys.UI.DomElement.getBounds(this.Lhb),Hc=Sys.UI.DomElement.getBounds(this.NCa);this.PF.style.top=Sb.y-Hc.y+this.Lhb.clientHeight+12+"px"}else this.PF.style.bottom="-"+(this.PF.clientHeight+10)+"px";this.kma();this.mgb=!0;Mb.AFrameworkApplication.za.Za.dH||(this.I4d=window.setTimeout(Object(gb.a)(this,this.dismiss,"dismiss"),1E4));this.uwi()}};ib.prototype.Xj=function(){this.Xg.qa(ff.a.click,this.PF,Object(gb.a)(this,this.slf,"onContainerInput"));this.Xg.qa(ff.a.click,
this.rNb,Object(gb.a)(this,this.Skf,"onClickClose"));this.h8&&this.Xg.qa(ff.a.click,this.h8,Object(gb.a)(this,this.Rkf,"onClickButton"))};ib.prototype.sm=function(){this.Xg.Ca(ff.a.click,this.PF,Object(gb.a)(this,this.slf,"onContainerInput"));this.Xg.Ca(ff.a.click,this.rNb,Object(gb.a)(this,this.Skf,"onClickClose"));this.h8&&this.Xg.Ca(ff.a.click,this.h8,Object(gb.a)(this,this.Rkf,"onClickButton"))};ib.prototype.VYa=function(Sb,Hc,ed,Id){Sb=void 0===Sb?null:Sb;Hc=void 0===Hc?!1:Hc;ed=void 0===ed?
null:ed;Id=void 0===Id?!1:Id;this.rNb=this.JSg();this.PF.appendChild(this.rNb);this.Lea=document.createElement("Div");this.Lea.className="CatchUpActivityNotificationMessageContainer";this.Lea.setAttribute(Ud.a.bga,Ud.a.UWa);this.Lea.setAttribute(Ud.a.pje,Ud.a.rj);this.Lea.setAttribute(Ud.a.Wd,Ud.a.aga);this.PF.appendChild(this.Lea);this.Lea.appendChild(this.qVg());this.Lea.appendChild(this.pVg(Sb,Id));Hc&&(this.h8=document.createElement("button"),this.h8.className="CatchUpActvitiyNotificationButton",
this.h8.innerText=ed?ed:CommonUIStrings.l_CatchUpChangeNotificationButtonLabel,this.Lea.appendChild(this.h8))};ib.prototype.qVg=function(){var Sb=document.createElement("Div");Sb.className="CatchUpActivityNotificationTitle";Sb.innerText=CommonUIStrings.l_CatchUpChangeNotificationMessage;return Sb};ib.prototype.pVg=function(Sb,Hc){Sb=void 0===Sb?null:Sb;Hc=void 0===Hc?!1:Hc;var ed=document.createElement("Div");ed.className="CatchUpActivityNotificationMessage";if(!Hc){Hc=document.createElement("Div");
Hc.className="CatchUpActivityNotificationDotContainer";var Id=document.createElement("Div");Id.className="CatchUpActivityNotificationDot";Hc.appendChild(Id);ed.appendChild(Hc);Hc=document.createElement("span");Hc.className="CatchUpActivityNotificationNewText";Hc.innerText=CommonUIStrings.l_CatchUpChangeNotificationNew;ed.appendChild(Hc)}Hc=document.createElement("span");Hc.className="CatchUpActivityNotificationMessageText";if(!Sb||1>Sb.length)Hc.innerText=CommonUIStrings.l_CatchUpChangeNotificationText;
else{switch(Sb.length){case 1:Id=CommonUIStrings.l_CatchUpChangeNotificationTextOneName;break;case 2:Id=CommonUIStrings.l_CatchUpChangeNotificationTextTwoNames;break;case 3:Id=CommonUIStrings.l_CatchUpChangeNotificationTextThreeNames;break;case 4:Id=CommonUIStrings.l_CatchUpChangeNotificationTextFourNames;break;default:Id=CommonUIStrings.l_CatchUpChangeNotificationTextMoreNames}Tc.a.rOf(Hc,Id,Sb,function(hf){var Hf=document.createElement("span");Hf.setAttribute("dir","auto");Hf.style.fontFamily="'Segoe UI Semibold', 'Segoe UI Web', Arial, Verdana, sans-serif";
Hf.setAttribute("unselectable","on");Hf.innerText=hf;return Hf})}Hc.setAttribute("dir","auto");ed.appendChild(Hc);return ed};ib.prototype.JSg=function(){var Sb=document.createElement("a");Sb.className="CatchUpActivityNotificationCloseAnchor";Sb.href="#";var Hc=Eg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","CatchUpActivityNotificationCloseIcon",!0,CommonUIStrings.l_DialogClose);Sb.appendChild(Hc);return Sb};ib.prototype.Skf=function(){pb.ULS.sendTraceTag(50643481,207,50,"Close button was clicked on Catch-Up Activity Notification callout.");
this.Oa.processAction(Lg.a.rce,2);this.dismiss();return!0};ib.prototype.dismiss=function(){var Sb=this;this.mgb&&(Mb.AFrameworkApplication.za.Za.dH?this.GRb&&Yg.UISurfaces.eM().then(function(Hc){Hc.removeNotification(Sb.GRb);Sb.GRb=null;Sb.bC(!0);return null},function(Hc){pb.ULS.sendTraceTag(593352346,383,15,"Failed to GetNotificationsAPIAsync: {0}",Hc);return null}):this.bC(!1))};ib.prototype.bC=function(Sb){this.NCa&&this.PF&&this.NCa.contains(this.PF)&&(this.sm(),this.NCa.removeChild(this.PF),
Sb||window.clearTimeout(this.I4d));this.mgb=!1;!Sb&&this.eBa&&this.eBa.jjh(this)};ib.prototype.slf=function(){return!0};ib.prototype.Rkf=function(){pb.ULS.sendTraceTag(50643482,207,50,"Primary Button was clicked on Catch-Up Activity Notification callout.");eb.c(Lg.a.zIg);this.Oa.processAction(Lg.a.ong,2);this.dismiss();return!0};ib.prototype.kma=function(){var Sb=this,Hc=this.hc.Wh(Pe.AFrame.Jmb);Hc.parent=Pe.AFrame.kwa;this.Xg.VVa(Pe.AFrame.Jmb,this.PF);Hc.GOc(function(){Sb.oPa()});this.KF.UVa(Pe.AFrame.Jmb);
this.KF.Fjb(Pe.AFrame.Jmb)};ib.prototype.oPa=function(){this.h8&&(pb.ULS.sendTraceTag(50643483,207,50,"Focus was set to the Button on the Activity Notification Callout."),this.h8.focus())};ib.prototype.uwi=function(){var Sb=this;pb.ULS.sendTraceTag(37552158,207,50,"The Catch-Up Activity Notification callout was shown in the UI.");this.yX?this.yX.continueWith(function(){window.setTimeout(function(){Sb.yX.result.logActivity("CatchUpChangesFeedback",null)},2E4)}):pb.ULS.sendTraceTag(50656925,207,15,
"CatchUpActivityNotification ISystemInitiatedFeedback was null")};Object(Hb.a)(ib,"CatchUpActivityNotification",null,[661]);var de=b(1008),tg=b(73);Oa.prototype.jW=function(Sb,Hc,ed,Id){var hf=this;return this.M4g(Sb,void 0===Id?null:Id,function(Hf){return hf.Ug.gVb(Hf,2,ed,Hc,void 0,void 0,void 0,void 0,void 0,"2")})};Oa.prototype.M4g=function(Sb,Hc,ed){var Id=this,hf=!!Hc&&""!==Hc,Hf=Sb;hf&&(Hf=Xa.a.JS(Sb,"perfTag",Hc));var Cg=new Date;return de.a.then(ed(Hf),function(uf){var ih=+new Date-+Cg;if(!uf||
!uf.Qg||!uf.Qg.data)return uf;hf&&uf.Qg.data.request&&Id.x4i(uf.Qg.data.request.getResolvedUrl(),Hc,ih);return uf})};Oa.prototype.x4i=function(Sb,Hc,ed){Sb=this.Rea.BGh(Sb);if(Sb.count&&(Sb=tg.last(Sb))){var Id={Message:"Request durations for activities calls."};Id.PerfTag=Hc;Id.CustomDuration=ed;Id.PerformanceDuration=Sb.duration;pb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Id))}};Object(Hb.a)(Oa,"CatchUpNetworkingWrapper",null,[804]);var ve=b(237),tf=ve.a;Cm(xa,tf);xa.prototype.eia=function(){return 6};
Object(Hb.a)(xa,"GetActivityFeedRequest",ve.a,[]);var lg=b(383);na.prototype.Ush=function(Sb){var Hc=this;return de.a.then(this.RSa.execute(new xa(this.DSa(),null,Sb),function(ed,Id,hf){return Hc.ngg.jW(ed,Id,hf,"ActivityFeed")}),function(ed){if(!ed)return pb.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeedEntries: Response is null"),null;if(!ed.Qg)return pb.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeedEntries: Response.Args is null"),null;if(!ed.Qg.data)return pb.ULS.sendTraceTag(572846939,
3012,10,"GetActivityFeedEntries: Response.Args.Data is null"),null;if(!ed.Qg.data.pe)return pb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeedEntries: Response.Args.Data.ResponseData is null"),null;ed=lg.a.CGa(ed.Qg.data.pe);return ed?ed:(pb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeedEntries: Deserialized response is null"),null)})};Object(Hb.a)(na,"CatchUpRequestHandler",null,[803]);var Og=b(473);ma.prototype.Mbi=function(){this.uci()};ma.prototype.uci=function(){var Sb=this;this.jVa?
this.jVa.execute(function(Hc){window.setTimeout(function(){Sb.j3d.contains("CatchUpChangesFeedback")||(Sb.j3d.add("CatchUpChangesFeedback"),Hc.logActivity("CatchUpChangesFeedback",null))},2E4)}):pb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Hb.a)(ma,"FloodgateEventLogger",null,[]);var Fa=b(210);Jl.Object.defineProperties(Sa.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.lhg.duration}}});Object(Hb.a)(Sa,
"PerformanceResourceTimingWrapper",null,[]);oa.prototype.BGh=function(Sb){var Hc=new Fa.a;if(!this.Rea)return Hc;Sb=this.Rea.getEntriesByName(Sb,"resource");if(!Sb)return Hc;Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())Hc.add(new Sa(ed.value));return Hc};Object(Hb.a)(oa,"PerformanceWrapper",null,[]);var lb=b(878),pc=b(100),qc=b(274),Md=b(525);ha.prototype.$h=function(Sb){var Hc=this;this.pb=Sb;this.pb.register(661,"Common.App.CatchUpActivity.ICatchUpActivityNotification").Ac().Lc(function(){return new ib(Je.a.instance,
pc.FocusManager.instance(),lb.a.instance,Mb.AFrameworkApplication.za,Mb.AFrameworkApplication.Hb,Hc.pb.resolve("CommonUI.ICalloutManager"),Md.a.uq(Hc.pb.yc("Common.ISystemInitiatedFeedback")))});this.pb.register(Oa,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Ac().Lc(function(){return new Oa(Mb.AFrameworkApplication.Md,new oa(window.performance))});this.pb.register(na,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Ac().Lc(function(){return new na(Hc.pb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),
function(){return Mb.AFrameworkApplication.hj},new lg.a)});this.pb.register(ma,"Common.App.CatchUpActivity.FloodgateEventLogger").Ac().Lc(function(){return new ma(Hc.pb.yc("Common.ISystemInitiatedFeedback"))})};ha.prototype.init=function(){this.pb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.pb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ha.prototype.dispose=function(){};ha.main=function(){qc.a.instance.oj(new ha)};Jl.Object.defineProperties(ha.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Hb.a)(ha,"CatchUpActivityPackage",null,[8,9]);ba.prototype.$c=function(Sb,Hc){return this.catchUpActivityManager?-876699925===Hc?!this.catchUpActivityManager.p3e:!1:!0};ba.prototype.executeCommand=function(Sb,Hc){Sb=!1;switch(Hc.command){case -876699925:Sb=this.catchUpActivityManager.EAi()}return Sb?$c.Task.Ua(!0):Qc.a(Hc.command)};ba.prototype.Jc=function(Sb,Hc){return Ue.EwaSettings.ka(459)&&-876699925===
Hc.command?!0:!1};ba.prototype.gd=function(){return!1};Object(Hb.a)(ba,"CatchUpActivityCommandHandler",null,[159]);var Pd=hc.a;Cm(R,Pd);R.prototype.Rd=function(){var Sb=this;this.$.ea.ub(286,function(Hc){Sb.Hd([new ba(Sb.$,Hc)])})};R.la=function(Sb){hc.a.ie(285,new R(Sb))};Object(Hb.a)(R,"CatchUpActivityCommandHandlerFactory",hc.a,[]);var ee=b(86),xf=b(371),Se=b(82);ja.prototype.doesContentExist=function(Sb){if(!Sb)return pb.ULS.sendTraceTag(590348556,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(Sb.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Sb.navigationId)return pb.ULS.sendTraceTag(590348555,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Hc={};Hc.NavigationId=atob(Sb.navigationId);return 32===this.Bi.Pe(Lg.a.UGa,2,Hc);default:return!1}};Object(Hb.a)(ja,"CatchUpActivityContentManager",null,[692]);var cf=b(945),dh=b(1230);X.prototype.dispose=function(){this.Gu.YEf(Object(gb.a)(this,this.NAb,"onHighlightStateChanged"));this.X$=
null};X.prototype.Q7i=function(Sb){this.X$.push(Sb)};X.prototype.FLg=function(){Array.clear(this.X$)};X.prototype.NAb=function(){switch(this.Gu.model.state){case 1:this.HTf(!0);break;case 0:this.$Hb(!1);break;case 2:case 3:this.$Hb(!0);break;default:pb.ULS.shipAssertTag(42795992,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+this.Gu.model.state)}};X.prototype.HTf=function(Sb){for(var Hc=Ml(this.X$),ed=Hc.next();!ed.done;ed=Hc.next())ed=ed.value,ed.className=
cf.a.CIg,ed=document.getElementById(String.format("{0}-{1}",ed.id,Rd.a.soe)),Zb.DOMElementExtensions.setVisible(ed,Sb)};X.prototype.$Hb=function(Sb){for(var Hc=Ml(this.X$),ed=Hc.next();!ed.done;ed=Hc.next())if(ed=ed.value)Sb?ed.className=2===this.Gu.model.state?cf.a.nMi:cf.a.oMi:this.HTf(!1)};Jl.Object.defineProperties(X.prototype,{Gu:{configurable:!0,enumerable:!0,get:function(){return this.Edg}}});Object(Hb.a)(X,"RangeCatchUpActivityView",null,[793,7]);var df=dh.a;Cm(ea,df);ea.prototype.dispose=
function(){this.gridView=null;df.prototype.dispose.call(this)};ea.prototype.Rqg=function(Sb){var Hc=this.Acb[0];Hc?Hc.Q7i(Sb):pb.ULS.shipAssertTag(42795991,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.kla.activityId)};ea.prototype.ZYi=function(){var Sb=this.Acb[0];Sb&&Sb.FLg()};ea.prototype.gpg=function(Sb){this.kla.addRange(Sb)};ea.prototype.iwh=function(){if(3!==this.kla.activityType)return null;pb.ULS.shipAssertTag(50606105,
0,1===this.kla.xIb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Ob.D(this.kla.xIb[0])};ea.prototype.eGb=function(Sb){if(Sb){if(!this.kla)return;this.tqd(this.ZZi())}df.prototype.eGb.call(this,Sb)};ea.prototype.WZc=function(){var Sb=this.CZc();Array.add(this.Acb,Sb)};ea.prototype.CZc=function(){return new X(this)};ea.prototype.tqd=function(Sb){Sb?Sb.SheetName?(this.gridView.ga.Sa.jG(null),this.gridView.focus(),this.gridView.IWe(Sb,
3,!1,De.a.mMi)):pb.ULS.shipAssertTag(41493472,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):pb.ULS.shipAssertTag(40482388,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};ea.prototype.ZZi=function(){if(Vd.e(this.kla.xIb))return pb.ULS.shipAssertTag(42006230,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),
null;var Sb=this.$.Aa.sa;pb.ULS.shipAssertTag(42006231,0,!!Sb,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");Sb=this.psj(Sb.sheetName,this.kla.xIb);if(!Sb&&(Sb=this.MKh(this.kla.xIb),!Sb))return null;var Hc={};Hc.SheetName=Sb.SheetName;Hc.FirstColumn=Sb.FirstColumn;Hc.FirstRow=Sb.FirstRow;Hc.LastColumn=Sb.FirstColumn;Hc.LastRow=Sb.FirstRow;return Hc};ea.prototype.MKh=function(Sb){if(Vd.e(Sb))return null;for(var Hc=null,ed=0;ed<Sb.length;ed++){var Id=
Sb[ed].SheetName;if(!Pb.a.equals(Id,Hc,!1)&&(Hc=Id,(Id=this.$.Aa.getItemByName(Id))&&Id.visible))return Sb[ed]}return null};ea.prototype.psj=function(Sb,Hc){if(Hc){Hc=Ml(Hc);for(var ed=Hc.next();!ed.done;ed=Hc.next())if(ed=ed.value,Pb.a.equals(ed.SheetName,Sb,!1))return ed}return null};Object(Hb.a)(ea,"RangeCatchUpActivityHighlightController",dh.a,[]);var Uf=b(74),bf=Uf.a;Cm(P,bf);P.prototype.dispose=function(){this.eUd=null;bf.prototype.dispose.call(this)};Jl.Object.defineProperties(P.prototype,
{type:{configurable:!0,enumerable:!0,get:function(){return this.yB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.eUd}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.X8f}}});Object(Hb.a)(P,"CatchUpActivityHighlightModelBase",Uf.a,[]);Cm(L,P);L.prototype.addRange=function(Sb){Sb=Ml(Sb);for(var Hc=Sb.next();!Hc.done;Hc=Sb.next())this.ranges.push(Hc.value)};L.prototype.dispose=function(){this.ranges=null;P.prototype.dispose.call(this)};L.f_b=function(Sb,
Hc){if(!Sb.SheetName||!Hc.SheetName)return pb.ULS.shipAssertTag(42006232,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var ed=Sb.SheetName.localeCompare(Hc.SheetName);return ed?ed:Sb.FirstColumn<Hc.FirstColumn||Sb.FirstColumn===Hc.FirstColumn&&Sb.FirstRow<Hc.FirstRow?-1:Sb.FirstColumn===Hc.FirstColumn&&Sb.FirstRow===Hc.FirstRow?0:1};Jl.Object.defineProperties(L.prototype,{xIb:{configurable:!0,enumerable:!0,get:function(){this.z4a||(this.ranges.sort(L.f_b),
this.z4a=!0);return this.ranges}}});Object(Hb.a)(L,"RangeCatchUpActivityHighlightModel",P,[]);var If=b(334);Y.prototype.dispose=function(){this.qce=this.sHb=this.mXc=null};Y.prototype.dWi=function(Sb){Yb.g(Sb).Sb.Wr([24])};Y.prototype.fTg=function(Sb,Hc,ed){var Id={};Hc=Ml(Hc);for(var hf=Hc.next();!hf.done;hf=Hc.next())if((hf=hf.value)&&!Vd.e(hf.LocationList)){for(var Hf=[],Cg={},uf=[],ih=Ml(hf.LocationList),qa=ih.next();!qa.done;qa=ih.next()){qa=qa.value;if(!qa){pb.ULS.shipAssertTag(50731148,0,!1,
"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+hf.Id);break}switch(qa.Type){case 0:var tb=qa;"0"in Cg?(qa=Cg["0"],qa.gpg(tb.RangeList)):(qa=new ea(Sb,new L(Sb,hf.Id,hf.Type,0,tb.RangeList),ed),Hf.push(qa),Cg["0"]=qa);tb=Ml(tb.RangeList);for(var rc=tb.next();!rc.done;rc=tb.next()){rc=rc.value;rc=new If.a(Ob.D(rc),Ge.d(Sb.Aa.getItemByName(rc.SheetName)));if(this.nrc(rc)in this.sHb)this.sHb[this.nrc(rc)].push(qa);else{var kd=[];kd.push(qa);
this.sHb[this.nrc(rc)]=kd}uf.push(rc);this.mXc.add(rc)}break;default:pb.ULS.sendTraceTag(50731149,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}pb.ULS.shipAssertTag(50731150,0,!(hf.Id in Id),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+hf.Id);this.qce[hf.Id]=uf;Id[hf.Id]=Hf}this.BUg(Sb,this.mXc.toArray(),this.sHb);return Id};Y.prototype.yLg=function(Sb){for(var Hc in Sb)for(var ed=
Ml(Sb[Hc]),Id=ed.next();!Id.done;Id=ed.next())Id.value.ZYi()};Y.prototype.nrc=function(Sb){return String.format("{0}-{1}",Sb.range,Sb.sheetId)};Y.prototype.BUg=function(Sb,Hc,ed){var Id=this;this.yLg(ed);Yb.g(Sb).Sb.Zu(Hc,[24],!0,function(hf,Hf){var Cg=new If.a(hf.range,hf.sheetId);Cg=Id.nrc(Cg);var uf=ed[Cg];if(uf)for(Cg=Ml(uf),uf=Cg.next();!uf.done;uf=Cg.next())uf=uf.value,uf.Rqg(Hf),hf.metadata=uf;else pb.ULS.shipAssertTag(50731151,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+
Cg)})};Object(Hb.a)(Y,"CatchUpHighlightControllersCreator",null,[]);Object(Hb.a)(fa,"CreateIndicatorTooltipParameters",null,[]);Object(Hb.a)(T,"DismissIndicatorTooltipParameters",null,[]);Object(Hb.a)(N,"UpdateIndicatorTooltipParameters",null,[]);S.prototype.dispose=function(){this.ga.Ymc(Object(gb.a)(this,this.Yk,"onContextMenu"));this.ga.bF(Object(gb.a)(this,this.nd,"onSelectionChanged"));this.gridView.aF(Object(gb.a)(this,this.Uo,"onCurrentSelectionModeChanged"));this.qb.mm(Object(gb.a)(this,this.tk,
"onEditStarted"));this.Hye();this.r6c=this.Tia=this.B$b=this.WOa=this.qb=this.ga=this.gridView=null};S.prototype.F5i=function(){var Sb=[];this.Hye();if(!Vd.e(Sb)){pb.ULS.sendTraceTag(42795989,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.a4=this.O_b.fTg(this.$,Sb,this)){Sb=this.a4;for(var Hc in Sb)for(var ed=Ml(Sb[Hc]),Id=ed.next();!Id.done;Id=ed.next())this.kzg(Id.value)}this.O_b.dWi(this.$)}};S.prototype.ssc=function(Sb){if(Sb&&this.rdd)pb.ULS.shipAssertTag(40482380,
0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Sb||this.cpb(),this.a4){var Hc=this.a4,ed;for(ed in Hc)for(var Id=Ml(Hc[ed]),hf=Id.next();!hf.done;hf=Id.next())hf.value.Rgj(Sb)}};S.prototype.xRh=function(Sb){this.Tia&&this.p2b(!0);this.A0c();if(Sb=this.a4[Sb.activityId]){Sb=Ml(Sb);for(var Hc=Sb.next();!Hc.done;Hc=Sb.next())Hc.value.eGb(!0)}else pb.ULS.sendTraceTag(40482385,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};
S.prototype.Hye=function(){if(this.a4){var Sb=this.a4,Hc;for(Hc in Sb)for(var ed=Ml(Sb[Hc]),Id=ed.next();!Id.done;Id=ed.next())Id=Id.value,this.WRi(Id),Id.dispose()}this.a4={};this.O_b.dispose();this.O_b=null};S.prototype.NAb=function(Sb,Hc){switch(Hc.state){case 0:case 1:3===Hc.Txd&&(this.QQh(),this.WOa=null);break;case 2:break;case 3:this.A0c();this.WOa=Hc.activityId;this.rfj();break;default:pb.ULS.shipAssertTag(40482382,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
Hc.state)}};S.prototype.rfj=function(){if(this.excelCommentManager){var Sb=this.a4[this.WOa];Sb&&0<Sb.length&&3===Sb[0].model.activityType&&((Sb=Sb[0])?this.excelCommentManager.Tfj(Sb.iwh()):pb.ULS.shipAssertTag(50606102,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};S.prototype.QQh=function(){this.excelCommentManager&&this.excelCommentManager.p_a()};S.prototype.A0c=function(){if(this.WOa){var Sb=this.a4[this.WOa];if(Sb){Sb=Ml(Sb);
for(var Hc=Sb.next();!Hc.done;Hc=Sb.next())Hc.value.eGb(!1);this.WOa=null}else pb.ULS.sendTraceTag(40482386,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};S.prototype.Yk=function(){this.cpb()};S.prototype.nd=function(){this.cpb()};S.prototype.Uo=function(){this.cpb()};S.prototype.tk=function(){this.cpb()};S.prototype.cpb=function(){this.A0c();this.p2b(!0)};S.prototype.ISf=function(Sb,Hc){this.Sda&&Hc.PG!==this.Tia&&(Hc.isSticky&&this.p2b(!0),
(Sb=this.Csj(Hc.PG))?(this.Sda.createActivityIndicatorTooltip(Object.assign(new fa,{target:Hc.PG,container:Sb,activityIds:[Hc.activityId],isSticky:Hc.isSticky,dirHint:this.gridView.rtl?12:9})),Hc.isSticky?(this.Tia=Hc.PG,pb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(this.B$b=Hc.PG,pb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
this.Pbc||(this.gridView.view.nt(Object(gb.a)(this,this.Avc,"updateActivityFlyouts")),this.gridView.Eq(Object(gb.a)(this,this.Avc,"updateActivityFlyouts")),this.Pbc=!0)):pb.ULS.shipAssertTag(41996808,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};S.prototype.Csj=function(Sb){if(!Sb)return pb.ULS.shipAssertTag(41996809,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Sb=String.format("{0}-{1}",Sb.id,Rd.a.AIg);var Hc=
this.r6c[Sb];if(!Hc){if(!this.gridView.domElement)return pb.ULS.shipAssertTag(41996810,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;Hc=document.createElement("Div");Hc.className=cf.a.BIg;Hc.id=Sb;this.gridView.domElement.appendChild(Hc);this.r6c[Sb]=Hc}return Hc};S.prototype.Cze=function(Sb,Hc){this.p2b(Hc.t3g)};S.prototype.Avc=function(){this.Sda?(this.Tia&&this.Sda.updateActivityIndicatorTooltip(Object.assign(new N,{target:this.Tia,isSticky:!0})),
this.B$b&&this.Sda.updateActivityIndicatorTooltip(Object.assign(new N,{target:this.Tia,isSticky:!1}))):pb.ULS.shipAssertTag(578421981,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};S.prototype.p2b=function(Sb){this.Sda&&(this.Sda.dismissActivityIndicatorTooltips(Object.assign(new T,{clearSticky:Sb})),this.B$b=null,Sb&&(this.Tia=null),this.Pbc&&!this.Tia&&(this.gridView.view.Tr(Object(gb.a)(this,this.Avc,"updateActivityFlyouts")),this.gridView.Ps(Object(gb.a)(this,
this.Avc,"updateActivityFlyouts")),this.Pbc=!1))};S.prototype.kzg=function(Sb){Sb.Cee(Object(gb.a)(this,this.NAb,"onHighlightStateChanged"));Sb.vrg(Object(gb.a)(this,this.ISf,"showActivityFlyoutHandler"));Sb.urg(Object(gb.a)(this,this.Cze,"dismissActivityFlyoutHandler"))};S.prototype.WRi=function(Sb){Sb.YEf(Object(gb.a)(this,this.NAb,"onHighlightStateChanged"));Sb.$Si(Object(gb.a)(this,this.ISf,"showActivityFlyoutHandler"));Sb.ZSi(Object(gb.a)(this,this.Cze,"dismissActivityFlyoutHandler"))};Jl.Object.defineProperties(S.prototype,
{nng:{configurable:!0,enumerable:!0,get:function(){return this.Sda},set:function(Sb){this.Sda=Sb}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.KBa||(this.KBa=this.$.ea.Ea(65,void 0));return this.KBa}},O_b:{configurable:!0,enumerable:!0,get:function(){this.P_b||(this.P_b=new Y);return this.P_b},set:function(Sb){this.P_b=Sb}}});Object(Hb.a)(S,"CatchUpActivityHighlightManager",null,[771,7]);W.prototype.navigateToActivity=function(Sb){if(Sb.fromSummaryString){var Hc=new he.a(1834994092,
ce.a.Yb,this.$.jd,18,null);this.$.Na.Xb(Hc);return this.bSa(4)}Sb=Sb.activity;if(!this.vZh(Sb))return this.bSa(4);if(!this.E6h(Sb))return this.bSa(7);var ed={};try{Hc=window.self.atob(Sb.navigationId);if(Pb.a.na(Hc))return this.bSa(5);ed.NavigationId=Hc}catch(Id){return pb.ULS.sendTraceTag(590956161,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Id),this.bSa(5)}if(8===this.Bi.Pe(Lg.a.UGa,2,ed))return this.Bi.processAction(Lg.a.f6a,2),this.bSa(2);Hc=32===this.Bi.Pe(Lg.a.CYa,
2,ed)?1:6;return this.bSa(Hc)};W.prototype.vZh=function(Sb){return Sb&&Sb.navigationId?!0:!1};W.prototype.E6h=function(Sb){switch(Sb.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};W.prototype.bSa=function(Sb){return Promise.resolve(Sb)};Object(Hb.a)(W,"CatchUpActivityNavigationManager",null,[693]);var vf=b(437);Object(Hb.a)(H,"GetRelevantActivitiesDataRequest",null,[]);Object(Hb.a)(J,"Activity",null,[]);Object(Hb.a)(z,"ActivityFeedItem",null,[]);Object(Hb.a)(x,"ActivityFeedPayload",
null,[]);Object(Hb.a)(y,"ActivityRequestPayload",null,[]);Object(Hb.a)(A,"Person",null,[]);Cm(v,J);Object(Hb.a)(v,"TaskActivity",J,[]);w.prototype.requestWYWAActivities=function(){var Sb=this;return this.K3a?new Promise(function(Hc,ed){C(Sb.$.ra.xa,function(Id){Id=ld.a(Id)?null:Id.Result;Id=Object.assign(new y,{activities:[],actors:Id?Sb.N$c(Id.WywaAuthors):null,hasMore:!1,highWaterline:w.AZa,lowWaterline:w.AZa,wywaWaterline:w.AZa});Hc(Id)},function(){pb.ULS.sendTraceTag(541373261,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");
ed(null)},null,null)}):Promise.resolve(w.F1b)};w.prototype.requestActivities=function(){return Promise.resolve(w.F1b)};w.prototype.requestRelevantActivities=function(){var Sb=this;if(!this.$.fa.pc||this.$.fa.h2a)return pb.ULS.sendTraceTag(561584145,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.fa.pc,this.$.fa.h2a),Promise.resolve(w.F1b);var Hc=Object.assign(new H,{SetDaysBack:Mb.AFrameworkApplication.ha.qd("AppWaterlineOverrideDaysValue",
0),SetTimestamp:Mb.AFrameworkApplication.ha.qd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(ed,Id){B(Sb.$.ra.xa,Hc,function(hf){var Hf=w.F1b;hf?ld.a(hf)?pb.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Ke.a.fd(hf.Errors)):Hf=Sb.lGh(hf.Result):pb.ULS.sendTraceTag(51499462,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");ed(Hf)},function(hf){hf=Uc.a.Eg(hf.data);
pb.ULS.sendTraceTag(51499463,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Ke.a.fd(hf));Id(null)},null,null)})};w.prototype.requestActivityFeed=function(){var Sb=this;return pd.b(this.getActivityFeed()).then(function(Hc){return Object.assign(new x,{activityFeedItems:Sb.prj(Hc)})})};w.prototype.getActivityFeed=function(){var Sb=this;return this.voe?de.a.KNd(this.voe,function(Hc){return Hc.Ush(Sb.lyh())}):$c.Task.Ua([])};w.prototype.lyh=function(){var Sb=
RegExp("^(([^:/?#]+):)?(\\\\/\\\\/([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?").exec(decodeURIComponent(Xa.a.Jy(window.location.href,"WOPISrc",!0)))[5].split("/");return Sb[Sb.length-1]};w.prototype.lGh=function(Sb){if(!Sb)return pb.ULS.sendTraceTag(578110038,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new y,{activities:[]});var Hc=this.e_f(Sb.NewActivities,2);Sb=this.e_f(Sb.OutstandingActivities,3);Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=
Sb.next())Hc.push(ed.value);return Object.assign(new y,{activities:Hc})};w.prototype.e_f=function(Sb,Hc){Hc=void 0===Hc?1:Hc;var ed=[];if(!Sb||!Sb.length)return ed;Sb=Ml(Sb);for(var Id=Sb.next();!Id.done;Id=Sb.next())if(Id=Id.value){var hf=w.wrj(Id.Type);6===hf||7===hf||9===hf||8===hf?ed.push(Object.assign(new v,{activityId:Id.Id,type:hf,displayTimestamp:new Date(Id.DisplayTimestamp),navigationId:Id.NavigationId,actors:this.N$c(Id.People),relevancy:Hc,relationship:this.vrj(Id.Relationship)})):ed.push(Object.assign(new J,
{activityId:Id.Id,type:hf,displayTimestamp:new Date(Id.DisplayTimestamp),navigationId:Id.NavigationId,actors:this.N$c(Id.People),relevancy:Hc}))}else pb.ULS.shipAssertTag(51499464,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return ed};w.prototype.vrj=function(Sb){switch(Sb){case 1:return 1;case 2:return 2;case 3:return 3}pb.ULS.sendTraceTag(575522897,0,10,"Unexpected Relationship.");return 1};w.prototype.prj=function(Sb){var Hc=[];Sb=
Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())ed=ed.value,ed=Object.assign(new z,{id:ed.id,type:ed.type,collectionId:ed.collectionId,activityState:ed.activityState,activityFeedItemPayload:ed.activityFeedItemPayload,timestamp:ed.timestamp}),Hc.push(ed);return Hc};w.prototype.N$c=function(Sb){var Hc=[];if(!Sb||!Sb.length)return Hc;Sb=Ml(Sb);for(var ed=Sb.next();!ed.done;ed=Sb.next())(ed=ed.value)&&Hc.push(this.Msb(ed));return Hc};w.prototype.Msb=function(Sb){return Object.assign(new A,{id:Sb.Id,
provider:Sb.Provider,displayName:Sb.DisplayName,email:Sb.Email,imageUrl:this.tlc.cGa(Sb.Email,Sb.Provider,Mb.AFrameworkApplication.hj,0),color:this.vCb.ebd(new vf.a(null,void 0,Sb.DisplayName),6)})};w.wrj=function(Sb){switch(Sb){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return pb.ULS.shipAssertTag(51499465,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),
1}};w.F1b=Object.assign(new y,{activities:[],actors:[],hasMore:!1,highWaterline:w.AZa,lowWaterline:w.AZa,wywaWaterline:w.AZa});Object.assign(new y,{activities:[Object.assign(new J,{activityId:"activityId1",type:3,actors:[Object.assign(new A,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new J,{activityId:"activityId2",type:4,actors:[Object.assign(new A,{id:"personId2",
provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});w.AZa="<WywaWaterline>DefaultWaterline</WywaWaterline>";Object(Hb.a)(w,"CatchUpActivityRequestManager",null,[694]);u.prototype.shouldShowEmptyExperienceButton=function(){var Sb=this.$.ea.Ea(365,void 0);return this.$.fa.ayb&&(!Sb||!Sb.isVisible)};u.prototype.onButtonClick=function(){var Sb={};Sb=(Sb.InputMethod=ce.a.Yb,Sb);this.$.Na.Xb(new he.a(1834994092,
ce.a.Yb,this.$.jd,16,null),Sb)};Object(Hb.a)(u,"CatchUpEmptyExperienceBehaviorManager",null,[695]);t.prototype.dispose=function(){jd.a(this.$).UA(this)};t.prototype.Ye=function(Sb,Hc){if(Hc)return!1;Sb=document.getElementById("flyoutItem0");if(!Sb)return pb.ULS.sendTraceTag(587747732,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Sb.focus();this.y3g(Sb);return!0};t.prototype.Lh=function(Sb){return this.Nb?Zb.DOMElementExtensions.jf(this.Nb,Sb):!1};t.prototype.vi=function(){this.hasFocus=
!0};t.prototype.ei=function(){this.hasFocus=!1};t.prototype.y3g=function(Sb){if(Sys.Browser.agent===Sys.Browser.Firefox){var Hc=document.createEvent("KeyboardEvent");Hc.initKeyEvent(ff.a.Rb,!0,!0,window.self,!1,!1,!1,!1,wf.a.Mwc,0);Sb.dispatchEvent(Hc)}else Hc=document.createEvent("Events"),Hc.initEvent(ff.a.Rb,!0,!0),Hc.keyCode=wf.a.Mwc,Hc.which=wf.a.Mwc,Sb.dispatchEvent(Hc)};Jl.Object.defineProperties(t.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Y4e&&!this.hasFocus}},he:{configurable:!0,enumerable:!0,get:function(){return Zd.a.HUc}}});Object(Hb.a)(t,"FlyoutFocus",null,[135,7]);var Dg=b(372);r.prototype.dispose=function(){this.fgb=this.Nvb=!1};r.prototype.registerButtonClickedEvent=function(Sb){this.buttonClickedCallback&&pb.ULS.sendTraceTag(587747731,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=
Sb.buttonClickedCallback};r.prototype.onFlyoutInitialized=function(){this.Nvb&&pb.ULS.sendTraceTag(587747730,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var Sb=(new Date).getTime()-this.goh.getTime();pb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",Sb);eb.c(Lg.a.EIg,!0,eb.e,0,0,Sb);this.Nvb=!0;Dg.a.yI&&Dg.a.yI.updateCommandUI(!0)};r.prototype.logFlightTriggers=function(){};r.prototype.toggleCatchUpFlyout=function(){this.Nvb?
this.buttonClickedCallback?this.buttonClickedCallback():pb.ULS.sendTraceTag(587747728,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):pb.ULS.sendTraceTag(587747729,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};r.prototype.onFlyoutVisibilityChanged=function(Sb){this.fgb!==Sb.flyoutIsVisible&&(this.fgb=Sb.flyoutIsVisible,Dg.a.yI&&Dg.a.yI.updateCommandUI(!0),this.fgb||this.pLe&&this.pLe.Mbi())};Jl.Object.defineProperties(r.prototype,
{Y4e:{configurable:!0,enumerable:!0,get:function(){return this.fgb}}});Object(Hb.a)(r,"FlyoutRibbonButton",null,[770]);var Pf=b(529);Object(Hb.a)(m,"CatchUpConfiguration",null,[]);Object(Hb.a)(c,"SharedControllerFactoryParameters",null,[]);d.prototype.dispose=function(){this.fFa&&this.fFa.getWywaEvent().removeListener(Object(gb.a)(this,this.ouf,"onWywaActivitiesReady"));this.fFa=this.$=null;ee.a.Ia(this.YXa);this.flyoutRibbonButton=this.flyoutFocus=this.RVd=this.toe=this.uoe=this.YXa=null};d.prototype.EAi=
function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};d.prototype.oci=function(){pb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");pb.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled")};d.prototype.ouf=function(Sb){this.YXa.F5i();this.YXa.ssc(!0);xf.a.na(Sb.wywaActivities)||2===Sb.wywaActivities[0].type||this.YXa.xRh(Sb.wywaActivities[0])};d.prototype.Bai=function(Sb,Hc){k("ScriptDownload");Ic.TaskExtensions.Da(Xb.GetServiceTaskFactory.Xa(this.$.ea,
283,284,Hc,"Common.IDynamicScriptLoaderProvider"),function(ed){Sb(pd.c(ed.result.xq.loadScript("catchUpActivity")))},this.$.ea.ma,3)};d.prototype.K3a=function(){return!!this.Qaf&&this.Qaf.K3a()};d.prototype.Koi=function(Sb){var Hc=this;Ic.TaskExtensions.Da(Sb,function(){id.a(function(){Hc.fFa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new c,{activityContentManager:Object(Se.a)(692,Hc.RVd),activityNavigationManager:Object(Se.a)(693,Hc.toe),activityRequestManager:Object(Se.a)(694,
Hc.uoe),dataCulture:Hc.$.Ba.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Se.a)(r,Hc.flyoutRibbonButton),uiCulture:Hc.$.Ba.UICultureTag,ulsLogger:new ae.a,emptyCatchUpBehaviorManager:Object(Se.a)(695,Hc.emptyCatchUpBehaviorManager)}))});Hc.YXa.nng=Hc.fFa.getActivityIndicatorTooltipManager();Pf.a(Hc.$);Hc.fFa.getWywaEvent().addListener(Object(gb.a)(Hc,Hc.ouf,"onWywaActivitiesReady"));k("InitializeCatchUpApp");Hc.fFa.initialize(Object.assign(new m,{featuredActivityGroupsEnabled:!1,flyoutEnabled:!0,
summaryStringEnabled:Hc.K3a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:Ue.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel")}))},this.$.ma,3)};Jl.Object.defineProperties(d.prototype,{p3e:{configurable:!0,enumerable:!0,get:function(){var Sb=this.flyoutRibbonButton.Nvb;Sb&&!this.DYe&&(pb.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.DYe=!0);return Sb}},y_h:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Y4e}}});
Object(Hb.a)(d,"CatchUpActivityManager",null,[696,7]);var gg=Ub.a;Cm(a,gg);a.prototype.create=function(){var Sb=this;Ic.TaskExtensions.Da(Xb.GetServiceTaskFactory.Xa(this.$.ea,458,459,this.vb,"Microsoft.Office.Excel.WebUI.Client.ILineageCatchUpExperimentManager"),function(Hc){Hc=Hc.result;Sb.Jb(Sb.$.ea.Ea(286,void 0)||new d(Sb.$,Sb.vb,null,Hc))},this.$.ma,3)};a.la=function(Sb){Sb.ea.La(287,new a(Sb))};Object(Hb.a)(a,"CatchUpActivityManagerFactory",Ub.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");Jb.a.Ja(td.la);Jb.a.Ja(kc.la);Jb.a.Ja(Wa.la);Jb.a.Ja(Da.la);Gd.a.Xi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){Jb.a.Ja(function(Sb){Gb.la(Sb);ca.la(Sb);Za.la(Sb);sb.la(Sb);zc.la(Sb)})})();Type.registerNamespace("Common.App.CatchUpActivity");ha.main();(function(){Jb.a.Ja(function(Sb){k("Begin");a.la(Sb);R.la(Sb)})})()}}]);

//# sourceMappingURL=EwaDS.catchup.js.map