(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1029:function(D,F,b){function a(u,w){var v=k.call(this,w.textBox.domElement)||this;v.MRc=null;v.wb=u;v.lD=w;w.MO&&(w.MO.add(v),w.Cm(Object(c.a)(v,v.tk,"onEditStarted")),w.mt(Object(c.a)(v,v.Zk,"onEditEnded")));return v}b.d(F,"a",function(){return a});D=b(0);var d=b(86),c=b(37);F=b(83);var m=b(44),r=b(42),t=b(68),k=F.a;Cm(a,k);a.prototype.dispose=function(){var u=this.lD;u&&u.MO&&(u.MO.remove(this),u.mm(Object(c.a)(this,this.tk,
"onEditStarted")),u.Qs(Object(c.a)(this,this.Zk,"onEditEnded")));d.a.Ia(this.MRc);this.lD=null;k.prototype.dispose.call(this)};a.prototype.Xh=function(u,w){switch(w){case -1470715894:case -1231471547:this.lT(!1);break;default:if(this.xyd(u,w))return t.g(u),!0;a.E3h(w)||this.lT(!1)}return!1};a.prototype.lT=function(){d.a.Ia(this.MRc);this.MRc=m.a.instance.create(Object(c.a)(this,this.nsd,"onAutoCompleteTimerTick"),10,r.a.oai)};a.prototype.tk=function(){this.lT(!1)};a.E3h=function(u){switch(u){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};
Jl.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},qb:{configurable:!0,enumerable:!0,get:function(){return this.lD}}});Object(D.a)(a,"ListAutoCompleteBehavior",F.a,[395,7])},1170:function(D,F,b){function a(A){var y=v.call(this,document.createElement("div"))||this;y.KGa=!1;y.LGa=!1;y.JGa=!1;y.HGa=!1;y.IGa=!1;y.sQ=!1;y.lD=null;y.$=A;u.g(A)&&u.g(A).ga&&u.g(y.$).ga.WF(Object(d.a)(y,y.uh,"onActiveCellChanged"));y.oaa=r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",
!1)&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return y}b.d(F,"a",function(){return a});D=b(0);var d=b(37);F=b(227);var c=b(4),m=b(43),r=b(1),t=b(9),k=b(7),u=b(20),w=b(34),v=F.a;Cm(a,v);a.prototype.qq=function(){this.aAa(!1);this.Zp.qq()};a.prototype.dispose=function(){this.$&&u.g(this.$)&&u.g(this.$).ga&&u.g(this.$).ga.gN(Object(d.a)(this,this.uh,"onActiveCellChanged"));v.prototype.dispose.call(this)};a.prototype.Xh=function(A,y,x){x=void 0===
x?!1:x;A=!1;if((!k.a.na(this.iZa)||x)&&!this.lva()&&this.get_visible()&&this.isListVisible)switch(this.oaa&&this.Evc(y),y){case 1872288872:this.isListVisible=!1;A=!0;break;case -798660877:this.Zp.Pu(1);A=!0;break;case 137938150:this.Zp.Pu(-1);A=!0;break;case 2091832999:this.Zp.Pu(this.uC-1);A=!0;break;case 742457698:this.Zp.Pu(-(this.uC-1));A=!0;break;case 125627505:A=this.pt(!1);break;case 267796030:r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(A=this.pt(!1))}return A};a.prototype.aAa=function(A){if(this.isListVisible||A){var y=u.g(this.$);A=y.domElement;var x=this.lD.textBox.domElement,z=w.a(this.$).Ci(x.offsetHeight),J=w.a(this.$).Ci(x.offsetTop),B=w.a(this.$).Ci(x.offsetWidth);x=w.a(this.$).Ci(x.offsetLeft);y=y.Zi;var C=$get(this.$.Mb+c.a.pYa,this.$.domElement),H=new Sys.UI.Point(y?this.Zp.j6b:0,y?this.iph:a.vMh);z=C.offsetTop+H.y+(m.a.tM(this.$)&&y?0:z+J);this.$.raa||(J=$get(c.a.clb,this.$.domElement),z+=J?J.offsetHeight:0);J=
this.domElement;J.style.top=t.HelperMethods.Ub(z);x=C.offsetLeft+x+H.x;!m.a.tM(this.$)&&this.$.isChromeRtl?J.style.right=t.HelperMethods.Ub(y?this.Zp.j6b:A.offsetLeft+A.offsetWidth-x-B):J.style.left=t.HelperMethods.Ub(x)}};a.prototype.CQa=function(A){this.Zp&&(A&&!this.sQ?(this.Zp.L8(Object(d.a)(this,this.Sjf,"onAutoCompleteListBoxGotFocus")),this.Zp.vVb(Object(d.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Zp.Gkb(Object(d.a)(this,this.fxa,"onSetCell")),this.sQ=!0):this.sQ&&(this.Zp.kca(Object(d.a)(this,
this.Sjf,"onAutoCompleteListBoxGotFocus")),this.Zp.enc(Object(d.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Zp.IEb(Object(d.a)(this,this.fxa,"onSetCell")),this.sQ=!1))};a.prototype.Evc=function(A){switch(A){case -798660877:case 137938150:case 2091832999:case 742457698:this.KGa=!0;break;case 125627505:this.JGa=!0;break;case 267796030:r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HGa=!0)}};a.prototype.MJa=function(){this.qb.textBox.BJ=
!0};a.prototype.fxa=function(){this.pt(!0)};a.prototype.Sjf=function(){this.qb.textBox.focus()};a.prototype.uh=function(){u.g(this.$).inRangePicker||(this.isListVisible=!1)};Jl.Object.defineProperties(a.prototype,{uC:{configurable:!0,enumerable:!0,get:function(){return this.Zp.uC}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Zp.isListVisible},set:function(A){this.Zp.isListVisible=A}},qb:{configurable:!0,enumerable:!0,get:function(){return this.lD},set:function(A){this.lD=
A;r.EwaSettings.isChangeGateEnabled("OfficeVSO:5096691_VisibilityDependentControlsAsList")?A&&!this.lD.vAa.contains(this)&&this.lD.vAa.add(this):A&&Array.add(this.lD.q5f,this)}},iph:{configurable:!0,enumerable:!0,get:function(){return m.a.tM(this.$)?-5:-40}}});a.j6b=0;a.vMh=1;Object(D.a)(a,"AutoCompleteControl",F.a,[361])},1171:function(D,F,b){function a(J,B){J=z.call(this,J,B,new x.a(r.a.listItem,r.a.dyb,r.a.hyb,r.a.iyb))||this;J.v9b=!1;J.Fr=null;J.yib=null;J.tza(!0);return J}b.d(F,"a",function(){return a});
D=b(0);var d=b(15),c=b(24),m=b(37);F=b(961);var r=b(913),t=b(4),k=b(79),u=b(43),w=b(11),v=b(1),A=b(121),y=b(20),x=b(1028),z=F.a;Cm(a,z);a.prototype.uwa=function(){var J=460,B=y.g(this.$),C=B.domElement,H=this.aRa.style,W=this.og.offsetTop+this.lk.offsetHeight*this.lk.sectionRowIndex-this.og.scrollTop;H.width="auto";H.whiteSpace="nowrap";H.position=c.a.ecc?"relative":"absolute";var S=C.offsetLeft+C.offsetWidth-(this.domElement.offsetLeft+this.og.offsetLeft+this.og.offsetWidth+3);C=this.domElement.offsetLeft-
3-(C.offsetLeft+this.j6b);J=Math.min(this.aRa.offsetWidth,J,Math.max(S,C));w.DOMElementExtensions.vq(this.aRa,J);H.whiteSpace="";H.position="absolute";W+3>this.og.offsetTop+this.og.offsetHeight||W<this.og.offsetTop||(J=this.og.offsetLeft-3-this.aRa.offsetWidth,H=this.og.offsetLeft+this.og.offsetWidth+3,w.DOMElementExtensions.updatePosition(this.aRa,C>S!==B.rtl?J:H,W,!1))};a.prototype.Pu=function(J){z.prototype.Pu.call(this,J);this.uwa()};a.prototype.qq=function(){this.uwa()};a.prototype.sqa=function(){var J=
this.nn,B=this.og,C=3===k.a.Yb||c.a.Sq,H=C?this.Ryb:this.uC;this.isListVisible=!0;B.style.height="auto";this.Oqa.set_visible(!0);this.hkb(J,C);this.Fr.length>H?(w.DOMElementExtensions.wF(B,Math.floor(B.offsetHeight*H/this.Fr.length)),B.style.overflowY="auto"):(B.style.height="auto",B.style.overflowY="hidden");w.DOMElementExtensions.vq(B,J.offsetWidth+(this.Fr.length>H?A.a.Lp:0))};Jl.Object.defineProperties(a.prototype,{j6b:{configurable:!0,enumerable:!0,get:function(){if(u.a.tM(this.$)){var J=document.getElementById(this.$.Mb+
t.a.jMe);return w.DOMElementExtensions.getBoundingClientRect(J).x}J=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(t.a.lqd):document.getElementById(this.$.Mb+t.a.lqd+"-"+t.a.Ogf);d.ULS.shipAssertTag(38594631,0,!!J||this.$.p4,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return J?J.offsetWidth:0}},me:{configurable:!0,enumerable:!0,get:function(){return this.yib},set:function(J){this.yib=J}},isListVisible:{configurable:!0,
enumerable:!0,get:function(){return w.DOMElementExtensions.isVisible(this.og)&&0<this.Fr.length},set:function(J){w.DOMElementExtensions.setVisible(this.og,J);w.DOMElementExtensions.setVisible(this.aRa,J);var B=y.g(this.$).view;J?this.v9b||(B.nt(Object(m.a)(this.Oqa,this.Oqa.qq,"onGridScroll")),this.v9b=!0):(Array.clear(this.Fr),this.v9b&&(B.Tr(Object(m.a)(this.Oqa,this.Oqa.qq,"onGridScroll")),this.v9b=!1))}}});Object(D.a)(a,"AutoCompleteListBox",F.a,[])},1172:function(D,F,b){function a(c,m,r,t){m=
void 0===m?0:m;r=void 0===r?"":r;t=void 0===t?"":t;var k=d.call(this)||this;k.length=c;k.selectedIndex=m;k.KH=r;k.description=t;return k}b.d(F,"a",function(){return a});D=b(0);var d=Sys.EventArgs;Cm(a,d);Object(D.a)(a,"ListEventArgs",Sys.EventArgs,[])},1224:function(D,F,b){function a(xa,Oa){var ib=na.call(this,xa)||this;ib.qBa=null;ib.KUc=[];ib.BXd=null;ib.DJa=!1;ib.D$b=!1;ib.Pp=null;ib.X2d=null;ib.Xe=xa;ib.tableManager=Oa;ib.domElement.className=A.a.bEe;ib.domElement.innerHTML="<div id='suggested_cells_list_box' class='ewa-lb ewa-scrollbars' ></div>";
Y.DOMElementExtensions.setVisible(ib.domElement,!1);ma.c(ib.style,ib.Xe.isChromeRtl);ib.yoe=$get(r.Hmj,ib.domElement);ib.cY=new d(ib.Xe,ib.yoe);ib.CQa(!0);ib.Xe.domElement.appendChild(ib.domElement);ib.Dlb(xa,ba.a(xa));ib.Dlb(xa,N.g(xa).Hc);ib.Xe.ea.La(1,ib);return ib}function d(xa,Oa){xa=X.call(this,xa,Oa)||this;xa.cellAutoCompleteControl=null;xa.kfa=null;xa.Fr=[];return xa}function c(xa,Oa){xa=T.call(this,xa,Oa)||this;xa.TVd=null;xa.Kld=0;xa.g5a=null;xa.qb.pVb(Object(u.a)(xa,xa.qAb,"onCommitEdit"));
return xa}function m(xa,Oa){this.V9f=xa;this.U9f=Oa}function r(){}b.r(F);D=b(0);var t=b(15),k=b(86),u=b(37),w=b(1170),v=b(10),A=b(913);r.Hmj="suggested_cells_list_box";Object(D.a)(r,"CssElementIds",null,[]);var y=b(4),x=b(1172);Jl.Object.defineProperties(m.prototype,{hga:{configurable:!0,enumerable:!0,get:function(){return this.V9f}},LRc:{configurable:!0,enumerable:!0,get:function(){return this.U9f}}});Object(D.a)(m,"CellAutoCompleteItem",null,[398]);var z=b(5),J=b(82),B=b(1029),C=b(379),H=b(46),
W=b(1),S=b(7),N=b(20),T=B.a;Cm(c,T);c.prototype.dispose=function(){this.qb.SBd(Object(u.a)(this,this.qAb,"onCommitEdit"));T.prototype.dispose.call(this)};c.prototype.lT=function(xa){xa&&!this.cellAutoCompleteControl.isListVisible||T.prototype.lT.call(this,xa)};c.prototype.Xh=function(xa,Oa){this.cellAutoCompleteControl.qb=this.qb;this.Kld=xa.keyCode;if(this.qb.isEditing){var ib=this.qb.text;S.a.equals(this.g5a,ib,!1)||(this.g5a=ib)}else this.g5a=null;if(237279923===Oa)return this.cellAutoCompleteControl.isListVisible=
!1;W.EwaSettings.ka(138)&&17===this.Kld&&this.cellAutoCompleteControl.DJa&&(this.cellAutoCompleteControl.D$b=!0);return T.prototype.Xh.call(this,xa,Oa)};c.prototype.qAb=function(xa,Oa){if(xa=this.cellAutoCompleteControl.items)if(1===xa.length&&this.cellAutoCompleteControl.iZa.length<xa[0].hga.length&&this.cellAutoCompleteControl.DJa&&S.a.UH(xa[0].hga,this.cellAutoCompleteControl.iZa)&&(Oa.newValue=xa[0].hga),this.qb&&W.EwaSettings.ka(138)){var ib=-1;1<xa.length?ib=this.cellAutoCompleteControl.C1a(this.qb.text,
!0):1===xa.length&&(this.cellAutoCompleteControl.DJa||this.cellAutoCompleteControl.D$b)&&(ib=0);if(0<=ib&&xa.length>ib&&xa[ib].LRc){var sb=H.C(xa[ib].LRc);sb&&N.g(this.$).kc.SKa(sb)&&(Oa.s3e=!0,Oa.zoe=xa[ib].LRc)}}};c.prototype.nsd=function(){W.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")&&z.AFrameworkApplication.Ng||(this.cellAutoCompleteControl.qb=this.qb,this.cellAutoCompleteControl.DJa=!1,this.qb.isEditing?S.a.equals(this.g5a,this.qb.text,
!0)||this.cellAutoCompleteControl.Yyg(this.Kld):this.g5a=null)};c.prototype.tk=function(){};c.prototype.Zk=function(){this.QU=!1;this.cellAutoCompleteControl.set_visible(!1);this.g5a=null;this.cellAutoCompleteControl.DJa=!1;this.cellAutoCompleteControl.D$b=!1;this.cellAutoCompleteControl.n5a&&this.cellAutoCompleteControl.n5a.cancel()};c.prototype.xyd=function(xa,Oa){return this.cellAutoCompleteControl.Xh(xa,Oa)};Jl.Object.defineProperties(c.prototype,{Cvb:{configurable:!0,enumerable:!0,get:function(){return!1}},
QU:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(xa){this.cellAutoCompleteControl.isListVisible=xa}},Fub:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return C.a.LUc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){var xa=b(1224).CellAutoCompleteControl;return this.TVd||(this.TVd=Object(J.a)(xa,this.$.ea.Ea(1,void 0)))}}});Object(D.a)(c,"CellAutoCompleteListAutoCompleteBehavior",
B.a,[]);var fa=b(30);B=b(1171);var Y=b(11),L=b(9),P=b(121),ea=b(65),X=B.a;Cm(d,X);d.prototype.dispose=function(){X.prototype.dispose.call(this);this.kfa=null};d.prototype.Mtc=function(xa){this.K6(!1);var Oa=new Sys.StringBuilder;Oa.append(String.format("<table class='{0}' aria-live='polite'><tbody>",this.Yaa));for(var ib=0,sb=this.Fr.length;ib<sb;ib++){var nb=fa.a.gg(xa[this.Fr[ib]].hga);nb=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.EZ,d.MUc,y.a.hhe,
nb,fa.a.C3b(nb));Oa.append(nb)}Oa.append("</tbody></table>");this.og.innerHTML=Oa.toString();this.nn=Y.DOMElementExtensions.uj(this.domElement,this.Yaa);this.K6(!0);this.sqa()};d.prototype.IHa=function(xa,Oa){if(xa&&xa.length){var ib=[];if(!S.a.na(Oa))for(var sb=0,nb=xa.length;sb<nb;sb++)S.a.UH(xa[sb].hga,Oa)&&Array.add(ib,sb);this.Fr=ib;this.Mtc(xa)}else this.isListVisible=!1,this.kfa=null};d.prototype.uwa=function(){};d.prototype.yGg=function(xa,Oa,ib){var sb=Math.min(xa,Math.max(200,ib));Oa&&xa<
ib&&(sb+=P.a.Lp);Y.DOMElementExtensions.vq(this.og,sb);Oa&&(sb-=P.a.Lp);return sb};d.prototype.sqa=function(){X.prototype.sqa.call(this);var xa=Y.DOMElementExtensions.uj(this.get_element(),this.Yaa),Oa=this.Fr.length>this.uC,ib=N.g(this.$);if(ib=ib.Cc(ib.ga.ya.activeCell))for(xa=this.yGg(xa.offsetWidth,Oa,ib.width),Oa=this.og.getElementsByClassName(d.MUc),ib=0;ib<Oa.length;ib++)Oa[ib].style.maxWidth=L.HelperMethods.Ub(xa);else t.ULS.sendTraceTag(39986010,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
d.prototype.OAb=function(xa){if(xa=X.prototype.OAb.call(this,xa)){var Oa=N.g(this.$);Oa.Zo(!1);Oa.focus()}return xa};Jl.Object.defineProperties(d.prototype,{lk:{configurable:!0,enumerable:!0,get:function(){return this.kfa},set:function(xa){this.Iza(this.lk);this.kfa=xa;var Oa=this.Iza(this.lk);this.me=xa?Oa.innerText:null;this.epc(xa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(ea.a)(d.prototype,this,"isListVisible")},set:function(xa){Object(ea.b)(d.prototype,this,
"isListVisible",xa);xa||(this.lk=null)}},aRa:{configurable:!0,enumerable:!0,get:function(){return null}},Oqa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.ea.Ea(1,void 0))}}});d.MUc="ewa-suggested-cell-name";Object(D.a)(d,"CellAutoCompleteListBox",B.a,[]);var ja=b(25),R=b(63),ba=b(122),ha=b(174),oa=b(42),Sa=b(32),ma=b(256);b.d(F,"CellAutoCompleteControl",function(){return a});var na=w.a;Cm(a,na);a.prototype.uPc=function(xa){this.addHandler("ACLBUpdated",
xa)};a.prototype.fCd=function(xa){this.removeHandler("ACLBUpdated",xa)};a.prototype.E1=function(xa){this.addHandler("ACLBSelectionChanged",xa)};a.prototype.mca=function(xa){this.removeHandler("ACLBSelectionChanged",xa)};a.prototype.Psg=function(xa){this.addHandler("ACLBMatchedItem",xa)};a.prototype.fUi=function(xa){this.removeHandler("ACLBMatchedItem",xa)};a.prototype.sWf=function(xa){for(var Oa=0;Oa<xa.length;Oa++){var ib=xa.charCodeAt(Oa);if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
S.a.isLetter(ib):S.a.lid(ib))return!0}return!1};a.prototype.lva=function(){return!this.items};a.prototype.dispose=function(){if(this.Xe){this.CQa(!1);var xa=N.g(this.Xe);xa&&xa.view.Tr(Object(u.a)(this,this.qq,"onGridScroll"))}k.a.rc([this.cY,this.n5a]);k.a.rc(this.KUc);this.KUc=this.yoe=this.cY=this.qb=this.Xe=null;na.prototype.dispose.call(this)};a.prototype.Xh=function(xa,Oa){var ib=!1;if(!S.a.na(this.iZa)&&!this.lva()&&this.get_visible()&&this.isListVisible||W.EwaSettings.isChangeGateEnabled("OfficeVSO:5729891_CellAutoCompletePreserveCase")&&
!S.a.na(this.iZa)&&!this.lva()&&267796030===Oa)if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5555740_AutoCompletePreserveCapitalization"))switch(Oa){case -798660877:if(1===this.items.length&&this.me)break;this.Zp.Pu(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.C1a(this.me),this.me));ib=this.pt(!1);break;case 137938150:if(1===this.items.length&&this.me)break;this.Zp.Pu(-1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.C1a(this.me),this.me));ib=
this.pt(!1);break;case 2091832999:this.Zp.Pu(this.uC-1);ib=this.pt(!1);break;case 742457698:this.Zp.Pu(-(this.uC-1));ib=this.pt(!1);break;case 125627505:this.qb.textBox.caretPosition=this.qb.text.length;this.isListVisible=!1;ib=!0;break;case 267796030:1===this.items.length?this.eac(!0):this.pt(!0);break;default:ib=na.prototype.Xh.call(this,xa,Oa)}else switch(Oa){case -798660877:if(1===this.items.length)break;this.Zp.Pu(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.C1a(this.me),
this.me));ib=this.pt(!1);break;case 137938150:if(1===this.items.length)break;this.Zp.Pu(-1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.C1a(this.me),this.me));ib=this.pt(!1);break;case 2091832999:this.Zp.Pu(this.uC-1);ib=this.pt(!1);break;case 742457698:this.Zp.Pu(-(this.uC-1));ib=this.pt(!1);break;case 125627505:this.qb.textBox.caretPosition=this.qb.text.length;this.isListVisible=!1;ib=!0;break;default:ib=na.prototype.Xh.call(this,xa,Oa)}return ib};a.prototype.show=function(){this.items&&
this.items.length&&(this.cY.lk=this.me?this.Zp.nn.rows[this.C1a(this.me)]:null,this.isListVisible=0<this.cY.Fr.length,this.aAa(!0),this.cY.uwa())};a.prototype.Yyg=function(xa){var Oa=!!this.qb&&!R.f(this.Xe.sa);this.D$b=this.DJa=!1;this.qb&&!this.qb.isEditing?this.set_visible(!1):Oa&&!this.f_g(this.activeCell)&&this.xgj(xa)};a.prototype.f_g=function(xa){return!!this.dataValidationControl&&this.dataValidationControl.v1c(xa)};a.prototype.pt=function(xa){if(!this.qb||!this.isListVisible)return!1;var Oa=
this.qBa;if(this.me){var ib=Y.DOMElementExtensions.QY(Y.DOMElementExtensions.uj(this.cY.lk,d.MUc),y.a.hhe,""),sb=ib.substring(Oa.length,ib.length);W.EwaSettings.isChangeGateEnabled("OfficeVSO:5555740_AutoCompletePreserveCapitalization")&&xa?this.qb.text=ib:this.qb.insertTextAt(sb,Oa.length,this.qb.text.length)}ib=N.g(this.Xe);ib.Zi&&(ib=ib.Hc,ib.text=this.qb.text,ib.setCaretPosition(this.qb.textBox.caretPosition));xa?this.isListVisible=!1:this.qb.textBox.selectRange(Oa.length,this.qb.text.length);
return!0};a.prototype.C1a=function(xa,Oa){Oa=void 0===Oa?!1:Oa;if(!this.cY.nn)return-1;for(var ib=this.cY.nn.children[0],sb=ib.children.length,nb,Gb=0;Gb<sb;++Gb)if(nb=ib.children[Gb],S.a.equals(nb.innerText.trim(),xa,Oa))return Gb;return-1};a.prototype.Zng=function(xa,Oa,ib,sb,nb,Gb,Ha){var ca=ib.originalText.replace(a.Ghf,String.fromCharCode(32)),Ra=new ja.Range(xa.top-1,xa.left,xa.bottom-1,xa.right,!1,!1),ua=Ha?Ha.fo(ib.range):null;(!ib.sM||ib.range.left===xa.left)&&1<ca.length&&!sb.tb(ca.toUpperCase())&&
S.a.UH(ca,Oa)&&!S.a.equals(ca,Oa,!0)&&!a.RKe(Oa)&&this.sWf(ca)&&(!nb&&!ua||!nb&&ua.equals(Ha.fo(Ra))||nb&&ib.range.oe(Gb)&&ib.range.top!==Gb.top)&&(xa=ib.formulaBarText,S.a.equals(xa,ib.text,!1)||S.a.na(xa))&&(xa={},xa.FirstRow=ib.range.top-1,xa.FirstColumn=ib.range.left-1,ib=new m(ca,xa),sb.add(ca.toUpperCase(),ib))};a.prototype.xgj=function(xa){this.Pp=this.GIh();this.n5a&&this.n5a.cancel();0<this.qb.text.length&&229!==xa&&xa?this.items&&((1<this.items.length||this.isListVisible)&&this.L5g(),8!==
xa&&127!==xa&&46!==xa&&(1===this.items.length?this.eac(!1):this.cY.lk&&this.pt(!1))):this.isListVisible=!1};a.prototype.L5g=function(){this.isListVisible?this.cBe():this.X2d=ha.AsyncMethodContext.kx(Object(u.a)(this,this.cBe,"dropDownListAutoCompleteUpdate"),500,oa.a.MIg,this.n5a)};a.prototype.eac=function(xa){t.ULS.shipAssertTag(18458260,0,!this.lva()&&1===this.items.length,"Invalid Items");if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5555740_AutoCompletePreserveCapitalization")){var Oa=this.items[0].hga,
ib=this.qb.text,sb=Oa.substring(ib.length,Oa.length);if(xa&&!sb.length)this.qb.text=Oa;else if(!xa&&0<sb.length)this.qb.appendText(sb),this.qb.textBox.selectRange(ib.length,this.qb.text.length);else return;this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,0,Oa))}else{xa=this.items[0].hga;Oa=this.qb.text;ib=xa.substring(Oa.length,xa.length);if(!ib.length)return;this.qb.appendText(ib);this.qb.textBox.selectRange(Oa.length,this.qb.text.length);this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,
0,xa))}this.DJa=!0};a.prototype.GIh=function(){this.Pp=null;var xa=new Sa.a(!1),Oa=this.activeCell;this.qBa=this.qb.text.replace(a.Ghf,String.fromCharCode(32));var ib=this.tableManager.fo(Oa),sb=Oa.oe(ib);if(a.RKe(this.qBa)||!this.sWf(this.qBa))return this.items;var nb=new ja.Range(1,Oa.left,Oa.top-1,Oa.left,!1,!1),Gb=new ja.Range(Oa.top+1,Oa.left,v.a.Gh,Oa.left,!1,!1),Ha=N.g(this.Xe);Gb=Ha.$m("CellAutoCompleteControl.GetSuggestedCells",Gb);try{var ca=Ha.$m("CellAutoCompleteControl.GetSuggestedCells2",
nb);try{for(var Ra=Ml([ca,Gb]),ua=Ra.next();!ua.done;ua=Ra.next())for(var ta=ua.value;ta.$$mn();){var db=ta.$$cu();this.Zng(Oa,this.qBa,db,xa,sb,ib,this.tableManager)}}finally{ca&&ca.dispose()}}finally{Gb&&Gb.dispose()}this.Pp=Array(xa.values.length);for(Oa=0;Oa<this.items.length;Oa++)this.items[Oa]=xa.values[Oa];this.items.sort(function(Ta,qb){return Ta.hga.localeCompare(qb.hga)});return this.items};a.prototype.cBe=function(){this.cY.IHa(this.items,this.qBa);this.raiseEvent("ACLBUpdated",new x.a(this.items.length));
this.show()};a.prototype.Dlb=function(xa,Oa){xa&&Oa&&Array.add(this.KUc,new c(xa,Oa))};a.RKe=function(xa){xa=0<xa.length?xa.charCodeAt(0):-1;return 35===xa||61===xa||43===xa||45===xa||64===xa};Jl.Object.defineProperties(a.prototype,{Zp:{configurable:!0,enumerable:!0,get:function(){return this.cY}},iZa:{configurable:!0,enumerable:!0,get:function(){return this.qBa}},me:{configurable:!0,enumerable:!0,get:function(){return this.cY.me}},items:{configurable:!0,enumerable:!0,get:function(){return this.Pp}},
n5a:{configurable:!0,enumerable:!0,get:function(){return this.X2d}},activeCell:{configurable:!0,enumerable:!0,get:function(){return N.g(this.Xe).ga.ya.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.BXd||(this.BXd=this.Xe.ea.Ea(14,void 0))}}});Jl.Object.defineProperties(a,{Ghf:{configurable:!0,enumerable:!0,get:function(){return a.E4d||(a.E4d=new RegExp(String.fromCharCode(160),"g"))}}});a.E4d=null;Object(D.a)(a,"CellAutoCompleteControl",w.a,[364,361,365,
7])},1237:function(D,F,b){function a(Ha,ca,Ra,ua){ca=Gb.call(this,Ha,"PopulateGridContextMenu",1247109494,-2064931494,a.iMh,!0,!1,a.uFb,ca,Ra,!0,ua)||this;ca.gza=!1;ca.Bua=!1;ca.IY=!1;ca.refresh=!1;ca.expandCollapse=!1;ca.zdc=!1;ca.vve=!0;ca.grid=ib.g(Ha);ca.dgc=!0;ca.zhd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5558478_disableHideUnHideRowColumnForMobileWhenEntireGridSelected")&&Ha.isMobileMode;return ca}function d(Ha){this.ranges=null;this.ranges=Ha}function c(Ha,ca,Ra,ua,ta,db,Ta,qb){this.$=
ca;this.Va=Ra;this.nm=ua;this.selectedRanges=ta;this.grid=db;this.ZA=qb;this.iaa=Ta;this.xqa=u.a.all(ta,function(za){return za.isRow});this.wqa=u.a.all(ta,function(za){return za.Yh});this.Gzb=u.a.all(ta,function(za){return!za.isRow&&!za.Yh});ca=db.kc.Mad(ta);this.y0b=!!ca;this.PGf=!!ca&&ca.hasActiveFilter;this.menuSection=Ra.Vc();Array.add(Ha.Fc,this.menuSection);this.hja=this.xqa||this.wqa?this.menuSection:Ra.Vc();this.jsa=this.xqa||this.wqa?this.menuSection:Ra.Vc()}b.r(F);D=b(0);var m=b(15),r=b(269),
t=b(97),k=b(49),u=b(371),w=b(454),v=b(5),A=b(82),y=b(404),x=b(824),z=b(10),J=b(28),B=b(18),C=b(59),H=b(4),W=b(903),S=b(1153),N=b(960),T=b(16);c.prototype.v7c=function(){this.erh();this.Kqh();var Ha=this.ZA.p4a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Va.zb(Ha?149:148))};c.prototype.jrh=function(){var Ha=0;this.y0b?this.iaa.ko(942362098)?Ha=this.ZA.ko(this.nm,942362098,this.selectedRanges,this.grid)?161:169:this.PGf&&(Ha=this.ZA.ko(this.nm,-1113896058,this.selectedRanges,
this.grid)?177:181):this.iaa.ko(-1113896058)&&(Ha=this.xqa?this.ZA.ko(this.nm,-1113896058,this.selectedRanges,this.grid)?49:116:this.ZA.ko(this.nm,-1113896058,this.selectedRanges,this.grid)?177:181);Ha&&Array.add(this.hja.buttons,this.Va.zb(Ha))};c.prototype.frh=function(){var Ha=0;this.y0b?this.iaa.ko(622604322)&&(Ha=this.grid.rtl?this.ZA.ko(this.nm,622604322,this.selectedRanges,this.grid)?191:192:this.ZA.ko(this.nm,622604322,this.selectedRanges,this.grid)?162:170):this.iaa.ko(1415868706)&&(Ha=this.wqa?
this.ZA.ko(this.nm,1415868706,this.selectedRanges,this.grid)?50:117:this.ZA.ko(this.nm,1415868706,this.selectedRanges,this.grid)?178:182);Ha&&Array.add(this.hja.buttons,this.Va.zb(Ha))};c.prototype.drh=function(){this.iaa.ko(1035996630)&&(this.ZA.ko(this.nm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.hja.buttons,this.Va.zb(this.grid.rtl?187:165)),Array.add(this.hja.buttons,this.Va.zb(166))):(Array.add(this.hja.buttons,this.Va.zb(this.grid.rtl?188:173)),Array.add(this.hja.buttons,this.Va.zb(174))))};
c.prototype.erh=function(){var Ha=b(1237).GridContextMenu,ca=null;this.Gzb&&(ca=this.Va.bA("ContextMenu.InsertCells",null,T.a.instance.da(331),1896159024),Array.add(ca.menu.Fc,this.hja));Ha.grh(this.hja,this.Va,this.$);this.jrh();this.frh();this.drh();ca&&0<this.hja.buttons.length&&Array.add(this.menuSection.buttons,ca)};c.prototype.Mqh=function(){var Ha=0;this.y0b?this.iaa.ko(1405456548)?Ha=this.ZA.ko(this.nm,1405456548,this.selectedRanges,this.grid)?163:171:this.PGf&&(Ha=this.ZA.ko(this.nm,1554436520,
this.selectedRanges,this.grid)?179:183):this.iaa.ko(1554436520)&&(Ha=this.xqa?this.ZA.ko(this.nm,1554436520,this.selectedRanges,this.grid)?51:118:this.ZA.ko(this.nm,1554436520,this.selectedRanges,this.grid)?179:183);Ha&&Array.add(this.jsa.buttons,this.Va.zb(Ha))};c.prototype.Lqh=function(){var Ha=0;this.y0b?this.iaa.ko(284490184)&&(Ha=this.ZA.ko(this.nm,284490184,this.selectedRanges,this.grid)?164:172):this.iaa.ko(674605324)&&(Ha=this.wqa?this.ZA.ko(this.nm,674605324,this.selectedRanges,this.grid)?
52:119:this.ZA.ko(this.nm,674605324,this.selectedRanges,this.grid)?180:184);Ha&&Array.add(this.jsa.buttons,this.Va.zb(Ha))};c.prototype.Jqh=function(){this.iaa.ko(1035996630)&&(this.ZA.ko(this.nm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.jsa.buttons,this.Va.zb(this.grid.rtl?189:167)),Array.add(this.jsa.buttons,this.Va.zb(168))):(Array.add(this.jsa.buttons,this.Va.zb(this.grid.rtl?190:175)),Array.add(this.jsa.buttons,this.Va.zb(176))))};c.prototype.Kqh=function(){var Ha=null;this.Gzb&&
(Ha=this.Va.bA("ContextMenu.DeleteCells",null,T.a.instance.da(391),-1554384558),Array.add(Ha.menu.Fc,this.jsa));this.Mqh();this.Lqh();this.Jqh();Ha&&0<this.jsa.buttons.length&&Array.add(this.menuSection.buttons,Ha)};Object(D.a)(c,"CellsContextMenuGenerator",null,[]);Object(D.a)(d,"MacroRecorderRangeHyperlinkRemovedPayload",null,[115]);var fa=b(553),Y=b(25),L=b(96),P=b(79),ea=b(72),X=b(46),ja=b(160),R=b(81),ba=b(641),ha=b(43),oa=b(141),Sa=b(35),ma=b(572),na=b(575),xa=b(1),Oa=b(172),ib=b(20),sb=b(367),
nb=b(34);b.d(F,"GridContextMenu",function(){return a});var Gb=x.a;Cm(a,Gb);a.prototype.dispose=function(){Gb.prototype.dispose.call(this);this.grid=null};a.prototype.executeCommand=function(Ha,ca,Ra){var ua=ca.command;Ha=null;switch(ua){case -1396319072:if(ca=this.grid.Cc(null))r.a.instance.eUc(!0),t.EventHandlerManager.instance.M6c(),a.ZBi(ca);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ga.ya.selectedRanges,ca);break;case 324156914:Ha=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Ra);
break;default:Ha=Oa.a(ua)}return Ha||Sa.TaskExtensions.P3()};a.prototype.Jc=function(Ha,ca,Ra){Ha=!1;switch(ca.command){case -1396319072:case -1253126584:case 324156914:Ha=!0;break;case 1441131127:Ha=!!Ra}return Ha};a.prototype.nY=function(Ha){Ha=void 0===Ha?!1:Ha;var ca=!1,Ra=!1,ua=0;xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ua=k.a.hf());var ta=this.Va.sp(this.menuId),db=this.grid.ga.ya,Ta=db.Eh,qb=Ta&&db.Xd.Yh,za=Ta&&db.Xd.isRow;db=db.selectedRanges;
var Ia=u.a.all(db,function(ia){return ia.Yh}),va=u.a.all(db,function(ia){return ia.isRow}),Ua=X.O(db),Kb=X.P(db);this.X6e(qb,za)?(ca=!0,this.Nrh(ta)):this.$.isEditMode?sb.a(this.$)?this.Orh(ta,qb,za):(this.Nqh(ta,!(za||qb||!this.zdc)),this.hrh(ta,db,Ha),this.Yqh(ta,Ia,va,Ua,Kb),this.nNe(ta,Ta,qb,za),this.esh(ta),this.PMe(ta,qb,za),this.Crh(ta,Ta,qb,za,db),this.Qqh(ta),this.Oqh(ta,db),this.orh(ta),this.$rh(ta,Ta),xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.brh(ta)):
(Ra=!0,sb.a(this.$)?this.gNe(ta):this.vsh(ta,Ta,qb,za,db));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ha=k.a.hf()-ua,m.ULS.sendTraceTag(555771231,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",Ha,ca,Ra,this.vve));this.vve=!1;return ta};a.prototype.wIa=function(Ha){var ca=[];if(sb.a(this.$))return ca;if(3===Ha){Ha=this.grid.ga.ya;var Ra=Ha.Eh,ua=Ra&&Ha.Xd.Yh,ta=Ra&&Ha.Xd.isRow,
db=!1,Ta=!1,qb=!1;this.zhd&&(Ta=Ha.selectedRanges,db=X.O(Ta),Ta=X.P(Ta));if(Ra){var za=ib.e(this.grid);za&&za.range.contains(Ha.Xd)&&this.MU(za)&&(qb=!0)}this.$.isEditMode?this.X6e(ua,ta)?Array.addRange(ca,[N.a.wwf,N.a.ywf]):ua||ta?(Array.add(ca,N.a.clipboard),ta?Array.add(ca,N.a.a0i):ua&&Array.add(ca,N.a.$Mg)):(Array.addRange(ca,[N.a.edit,N.a.clipboard]),qb?Array.add(ca,N.a.hyperlink):Array.add(ca,N.a.color),Ra&&Array.add(ca,N.a.kAg)):(Array.add(ca,N.a.copy),qb&&Array.add(ca,N.a.openHyperlink),!ta||
this.zhd&&Ta?!ua||this.zhd&&db||Array.add(ca,N.a.yBj):Array.add(ca,N.a.zBj));Array.add(ca,N.a.ZLh)}else 2===Ha&&Array.add(ca,N.a.Doe);return ca};a.prototype.X6e=function(Ha,ca){return(this.gza||this.Bua||this.IY||this.refresh||this.expandCollapse)&&!(Ha||ca)};a.prototype.showGridContextMenu=function(Ha){this.expandCollapse=this.refresh=this.IY=this.Bua=this.gza=!1;var ca=this.$,Ra=ma.a(ca).PIa(),ua=this.grid.ga.ya,ta=ua.Eh,db=ta&&ua.Xd.Yh;ua=ta&&ua.Xd.isRow;!Ra||db||ua||((db=na.a(ca))&&db.mJd&&(this.gza=
db=L.f(ca.sg),this.Bua=!db),db=ca.mc,this.IY=Ra.supportsBIExplore&&!!W.a(ca)&&db.N1(32768),db.allowInteractivity&&((ca=this.grid.Cc(null))&&ca.cell&&(ca.cell.STc||ca.cell.rSf)&&(this.expandCollapse=!0),db.allowManualDataRefresh&&(this.refresh=!0)));ca=null;Ra=1;db=Object(A.a)(w.a,Ha.eventArgs);Ha=Object(A.a)(S.a,Ha.creationParams);ua=this.Awh();Ha?(ca=Ha.clientPoint,Ra=Ha.inputMethod):db&&1!==db.Cb?(ca=new Sys.UI.Point(db.clientPoint.x,db.clientPoint.y),Ra=db.Cb):ua&&(ca=new Sys.UI.Point(ua.x+(this.$.isChromeRtl?
0:ua.width),ua.y+ua.height));P.a.Yb=Ra;this.zdc=3===Ra;Ha=J.a.vqb;this.Ln(ca,!db||db.Ga.target.className!==Ha,Ra)};a.prototype.removeHyperlinksFromRange=function(Ha,ca){var Ra=this;if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.qt(Ha,!0)){var ua=X.r(Ha,this.$),ta=this.$.ra.xa.dc();this.$.userOperationManager.oc(new ja.a(125,0,function(db,Ta,qb){Ra.$.Ss();return R.c(Ra.$.ra.xa,ua,"","",!0,!1,127,db,Ta,qb,null,ta)},void 0,function(){return new d(ua)}),
ca);this.grid.Vi.fG(!1)}};a.prototype.Awh=function(){var Ha=this.grid.Cc(null);if(Ha&&Ha.cell.Fj&&this.h6e(Ha))return this.grid.getCellBounds(Ha.cell);Ha=this.grid.ga.ya.activeCell;return(Ha=this.u5b(new Y.Range(Ha.top,Ha.left,z.a.Gh,Ha.left,!1,!1),2,!0)||this.u5b(new Y.Range(1,Ha.left,Ha.top,Ha.left,!1,!1),2,!1)||this.u5b(new Y.Range(Ha.top,Ha.right,Ha.top,z.a.Qh,!1,!1),1,!0)||this.u5b(new Y.Range(Ha.top,1,Ha.top,Ha.right,!1,!1),1,!1)||null)&&Ha.Fj?this.grid.getCellBounds(Ha):Sys.UI.DomElement.getBounds(this.grid.Utb.Nb)};
a.prototype.h6e=function(Ha){var ca=this.grid.rtl,Ra=this.$.isChromeRtl;Ha=Ha.cell;var ua=ib.g(this.$).nJ(Ha);return ua?(ua=ua.topLeft,ca=ua.x+=ca===Ra?Ha.offsetWidth:0,Ra=ua.y+=Ha.offsetHeight,this.grid.view.visibleArea.contains(new C.a(ca,Ra,0,0))):!1};a.prototype.u5b=function(Ha,ca,Ra){Ha=this.grid.$m("GridContextMenu.FindFirstCellInViewportArea",Ha,ca,Ra);try{for(Ha.$$rst();Ha.$$mn();){var ua=Ha.$$cu();if(ua&&this.h6e(ua))return ua.cell}}finally{Ha&&Ha.dispose()}return null};a.prototype.Nrh=function(Ha){var ca=
this.Va,Ra=ca.Vc();this.refresh&&Array.add(Ra.buttons,ca.zb(100));this.IY&&Array.add(Ra.buttons,ca.zb(99));this.gza?Array.add(Ra.buttons,ca.zb(59)):this.Bua&&Array.add(Ra.buttons,ca.zb(58));if(this.expandCollapse){var ua=ca.bA("ContextMenu.PivotExpandCollapse",null,T.a.instance.da(1098),589118293);var ta=ca.Vc();Array.add(ta.buttons,ca.zb(240));Array.add(ta.buttons,ca.zb(241));Array.add(ta.buttons,ca.zb(242));Array.add(ta.buttons,ca.zb(243));Array.add(ua.menu.Fc,ta);ua&&0<ta.buttons.length&&Array.add(Ra.buttons,
ua)}Array.add(Ha.Fc,Ra)};a.prototype.nNe=function(Ha,ca,Ra,ua){if(ca&&!Ra&&!ua){ca=this.Va.Vc();this.E7c(ca);this.ish(ca);if(xa.EwaSettings.ka(509)&&ib.g(this.$).ga.ya.cQ()&&ib.g(this.$).ga.ya.TU)switch(xa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Array.add(ca.buttons,this.Va.zb(234));break;case 2:Array.add(ca.buttons,this.Va.zb(235));break;default:Array.add(ca.buttons,this.Va.zb(233))}Array.add(Ha.Fc,ca)}};a.prototype.E7c=
function(Ha){if(!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new oa.a(this.$.Aa)).Ke(2048)){var ca=this.Va.Vc();Array.add(ca.buttons,this.Va.zb(223));Array.add(ca.buttons,this.Va.zb(224));this.$.isMobileMode||Array.add(ca.buttons,this.Va.zb(225));var Ra=this.Va.bA("ContextMenu.sort",null,T.a.instance.da(216),-864298118);Array.add(Ra.menu.Fc,ca);Array.add(Ha.buttons,Ra)}};a.prototype.ish=function(Ha){if(ib.g(this.$).ga.ya.cQ()){var ca=
this.Va.Vc();Array.add(ca.buttons,this.Va.zb(232));var Ra=this.Va.bA("ContextMenu.table",null,T.a.instance.da(1876),-697806646);Array.add(Ra.menu.Fc,ca);Array.add(Ha.buttons,Ra)}};a.prototype.aNe=function(Ha,ca,Ra,ua,ta){if(ca){var db=X.K(ta),Ta=ib.e(this.grid);if(Ta&&!Ra&&!ua){Ra=new oa.a(this.$.Aa);if(Ta.range.contains(db)&&this.MU(Ta)){(ca=!Ta.CKa&&!Ra.vj)&&this.$.isEditMode&&Array.add(Ha.buttons,this.Va.zb(45));Ta.U$&&Array.add(Ha.buttons,this.Va.zb(53));ca&&this.$.isEditMode&&Array.add(Ha.buttons,
this.Va.zb(47));return}!Ta.CKa&&this.$.isEditMode&&(Ta=Ra.Ke(128),Array.add(Ha.buttons,this.Va.zb(Ta?46:121)))}}this.rMi(ta)&&Array.add(Ha.buttons,this.Va.zb(48));ca&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode&&(this.qMi(ta[0])?Array.add(Ha.buttons,this.Va.zb(273)):Array.add(Ha.buttons,this.Va.zb(272)))};a.prototype.rMi=function(Ha){Ha=Ml(Ha);for(var ca=Ha.next();!ca.done;ca=Ha.next()){ca=this.grid.getRangeInformation(ca.value);
for(var Ra=0;Ra<ca.length;Ra++)if(Object(y.a)(fa.HyperlinkRange,ca[Ra])){var ua=this.grid.Cc(ca[Ra]);if(ua&&this.MU(ua)&&!ua.CKa)return!0}}return!1};a.prototype.qMi=function(Ha){if(ib.g(this.$).ga.ya.cQ()){var ca=ib.g(this.$).kc.Rk(Ha);if(ca&&ca.usedRange.equals(Ha))return!0}return!1};a.prototype.PMe=function(Ha,ca,Ra){if(1===ib.g(this.$).ga.Ze&&!ca&&!Ra){ca=sb.a(this.$);Ra=this.Va;var ua=Ra.Vc(),ta=this.$.ea.Ea(65,void 0);ta&&ta.Jl&&ta.Jl.mC&&!ca&&Array.add(ua.buttons,Ra.zb(227));ta&&ta.isCommentOperationEnabled(3)&&
Array.add(ua.buttons,Ra.zb(221));ta&&ta.Jl&&ta.Jl.dZe&&!ca&&Array.add(ua.buttons,Ra.zb(228));ta&&ta.hasCommentAtActiveCell?ta.OB.isResolved||Array.add(ua.buttons,Ra.zb(159)):ta&&ta.hasCommentAtActiveCell||(ta&&ta.Jl&&ta.Jl.mC?ca||(Array.add(ua.buttons,Ra.zb(229)),Array.add(ua.buttons,Ra.zb(230))):(Array.add(ua.buttons,Ra.zb(160)),ca||Array.add(ua.buttons,Ra.zb(226))));Array.add(Ha.Fc,ua)}};a.prototype.esh=function(Ha){if(xa.EwaSettings.ka(137)){var ca=this.Va,Ra=ca.Vc();Array.add(Ra.buttons,ca.zb(247));
Array.add(Ha.Fc,Ra)}};a.prototype.hrh=function(Ha,ca,Ra){if(!Ra){Ra=this.$.Na.AG();var ua=new oa.a(this.$.Aa),ta=new ba.a(Ra,ca,this.grid);(new c(Ha,this.$,this.Va,Ra,ca,this.grid,ta,ua)).v7c()}};a.prototype.Yqh=function(Ha,ca,Ra,ua,ta){var db=(new oa.a(this.$.Aa)).Ke(8),Ta=this.Va,qb=Ta.Vc();ca&&Array.add(qb.buttons,Ta.zb(db?152:153));Ra&&Array.add(qb.buttons,Ta.zb(db?150:151));ca&&(ua||Array.add(qb.buttons,Ta.zb(db?109:155)),Array.add(qb.buttons,Ta.zb(db?111:157)));Ra&&(ta||Array.add(qb.buttons,
Ta.zb(db?108:154)),Array.add(qb.buttons,Ta.zb(db?110:156)));Array.add(Ha.Fc,qb)};a.prototype.Nqh=function(Ha,ca){var Ra=this.Va,ua=Ra.Vc();Array.add(Ha.Fc,ua);ca&&Array.add(ua.buttons,Ra.zb(102));Array.add(ua.buttons,Ra.zb(42));Array.add(ua.buttons,Ra.zb(43));ca=this.Krh(Ra);Array.add(Ha.Fc,ca)};a.prototype.Krh=function(Ha){var ca=Ha.Vc();ca.title=T.a.instance.da(1078);ca.jUf=!1;ca.iUf=!1;ca.kZf=!1;var Ra=5,ua=ha.a.Vkd(this.$);ua&&(Ra=6);Ha=Ha.cA("PasteOptionsGallery",Ra,"Size24by24",ca.title);Array.add(ca.buttons,
Ha);Ha.jt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1079,void 0,"Paste_24",1,B.a.Teh);Ha.jt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1080,void 0,"PasteValues_24",1,B.a.Yeh);Ha.jt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1081,void 0,"PasteFormulas_24",1,B.a.Veh);Ha.jt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1082,void 0,"PasteTranspose_24",1,B.a.Xeh);
Ha.jt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1083,void 0,"PasteFormatting_24",1,B.a.Ueh);ua&&Ha.jt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1084,void 0,"PasteLink_24",1,B.a.Weh);return ca};a.prototype.vsh=function(Ha,ca,Ra,ua,ta){var db=this.Va,Ta=db.Vc();Array.add(Ta.buttons,db.zb(43));Array.add(Ha.Fc,Ta);xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.fa.mc.isMobileMode&&
this.$.fa.mc.isReadOnlyEditMode&&!this.$.Ba.IsMeetingLiveSession||(Ta=this.Va.Vc(),this.E7c(Ta),Array.add(Ha.Fc,Ta),m.ULS.sendTraceTag(538043477,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));(Ta=this.$.ea.Ea(65,void 0))&&Ta.Jl&&Ta.Jl.mC&&(Ta=this.Va.Vc(),Array.add(Ta.buttons,db.zb(229)),Array.add(Ha.Fc,Ta));Ta=this.Va.Vc();this.aNe(Ta,ca,Ra,ua,ta);Array.add(Ha.Fc,Ta);v.AFrameworkApplication.isMobileMode&&
!ea.a(this.$.Ba,30)&&(ca=db.Vc(),Array.add(ca.buttons,db.zb(269)),Array.add(Ha.Fc,ca))};a.prototype.Crh=function(Ha,ca,Ra,ua,ta){var db=this.Va.Vc();this.Drh(db);this.aNe(db,ca,Ra,ua,ta);0<db.buttons.length&&Array.add(Ha.Fc,db)};a.prototype.Drh=function(Ha){Array.add(Ha.buttons,this.Va.zb(135))};a.prototype.brh=function(Ha){var ca=this.Va.Vc();Array.add(ca.buttons,this.Va.zb(185));Array.add(Ha.Fc,ca)};a.prototype.$rh=function(Ha,ca){xa.EwaSettings.ka(510)&&ca&&(ca=this.Va.Vc(),Array.add(ca.buttons,
this.Va.zb(259)),Array.add(Ha.Fc,ca))};a.prototype.orh=function(Ha){var ca=this.grid.ga.ya.selectedRanges;if(ca&&ca.length){for(var Ra=!1,ua=0;ua<ca.length;ua++)if(this.grid.kc.SKa(ca[ua])){Ra=!0;break}if(Ra){var ta=this.Va;Ra=ta.Vc();ua=ta.Vc();for(var db=1===ca.length&&(ca[0].isSingle||this.grid.kc.Jwb(ca[0])),Ta=!1,qb=!1,za=!1,Ia=!1,va=0;va<ca.length&&!(Ta&&za&&qb&&Ia);va++)!Ta&&this.grid.kc.I3h(ca[va])&&(Ta=!0),!za&&this.grid.kc.$5e(ca[va],!1)&&(za=!0),!qb&&this.grid.kc.tjd(ca[va])&&(qb=!0),!Ia&&
this.grid.kc.z_h(ca[va])&&(Ia=!0);xa.EwaSettings.ka(106)&&db&&!this.grid.kc.Vac(ca[0])&&(Ia?Array.add(Ra.buttons,ta.zb(217)):Array.add(Ra.buttons,ta.zb(216)));Ia=Ta;Ia=!(new oa.a(this.$.Aa)).vj&&Ia;za&&(xa.EwaSettings.ka(132)&&L.l(this.$.sg)&&(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(ua.buttons,ta.zb(220)):Array.add(ua.buttons,ta.zb(Ia?220:268))),
qb&&Array.add(ua.buttons,ta.zb(Ia?218:266)),db&&(this.grid.kc.tjd(ca[0])||this.grid.kc.Vac(ca[0]))&&Array.add(ua.buttons,ta.zb(Ia?219:267))),Array.add(ua.buttons,ta.zb(Ia?215:265)));0<ua.buttons.length&&(ca=ta.bA(Ta?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,T.a.instance.da(1705),798637440),Array.add(ca.menu.Fc,ua),Array.add(Ra.buttons,ca));0<Ra.buttons.length&&Array.add(Ha.Fc,Ra)}}};a.prototype.Oqh=function(Ha,ca){this.grid.kc.y4e(ca)&&
(ca=this.Va.Vc(),this.grid.ga.ya.Gva()?(Array.add(ca.buttons,this.Va.zb(238)),Array.add(ca.buttons,this.Va.zb(236))):Array.add(ca.buttons,this.Va.zb(237)),Array.add(Ha.Fc,ca))};a.prototype.MU=function(Ha){return Ha.cell.hasHyperlink};a.prototype.gNe=function(Ha){this.Prh(Ha);var ca=this.Va.Vc();this.E7c(ca);Array.add(Ha.Fc,ca)};a.prototype.Orh=function(Ha,ca,Ra){this.gNe(Ha);this.PMe(Ha,ca,Ra)};a.prototype.Prh=function(Ha){if(this.grid.ga.ya.Eh&&!this.grid.$a.lj){var ca=this.Va,Ra=ca.Vc();nb.a(this.$).PJd()?
Array.add(Ra.buttons,ca.zb(262)):Array.add(Ra.buttons,ca.zb(261));Array.add(Ha.Fc,Ra)}};a.ZBi=function(Ha){var ca=Ha.EIa(a.Qdd);ca&&ca.Gfd&a.Qdd&&Ha.invoke(a.Qdd,null)};a.grh=function(Ha,ca,Ra){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(Ra=Ra.ea.Ea(254,!1),!Ra){m.ULS.sendTraceTag(540612248,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(Ra=Ra.ea.Ea(254,!0),
!Ra)return;Ra.Xhd()&&Ra.P$e()&&Array.add(Ha.buttons,ca.zb(212));Ra.Xhd()&&Ra.qec()&&Array.add(Ha.buttons,ca.zb(213))};Jl.Object.defineProperties(a.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return H.a.uBf}}});a.uFb="GridContextMenuRootName";a.iMh="gridMenuId";a.Qdd=192;Object(D.a)(a,"GridContextMenu",x.a,[])},1354:function(D,F,b){function a(){this.pb=null;this.Fw=!1}function d(n,O){var da=Kk.call(this)||
this;da.Foa=Nk.a.ysh;da.eJc=!!window.PointerEvent;da.gae=window.hasOwnProperty("ontouchstart");da.rhb=null;da.GTa=null;da.R7=!1;da.lS=new Ij.a;da.Khb=new Ij.a;da.Tcg=new Aa.a;da.aoa=null;da.ojb=!1;da.dWd=!1;da.H7d=!1;da.VGc=!1;da.oAc=!1;da.ZVd=!1;da.rDc=!1;da.LSa=!1;da.Sgb=-1;da.KLc=null;da.session=null;da.handlers=null;da.element=null;da.curRecognizer=null;da.Zd=ye.EventHandlerManager.instance;da.eJc?(Rc.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),da.rhb=Object(Kc.a)(da,da.Wic,"onPointerEvent"),
da.GTa=Ve.a.Ash):da.gae?(Rc.ULS.sendTraceTag(593893140,310,50,"Using touch events"),da.rhb=Object(Kc.a)(da,da.jxa,"onTouchEvent"),da.GTa=Ve.a.touchEvents):(Rc.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),da.rhb=Object(Kc.a)(da,da.Iic,"onMouseEvent"),da.GTa=Ve.a.zsh);da.rh=O;da.kea=n;Ee.AFrameworkApplication.ha&&(da.ojb=Ee.AFrameworkApplication.ha.ta("UsePointerCaptureIsEnabled"),da.dWd=Ee.AFrameworkApplication.ha.ta("ClearCacheOnPrimaryPointerIsEnabled"),da.H7d=Ee.AFrameworkApplication.ha.ta("ResetHandledBeforeInputHandlerIsEnabled"),
da.VGc=Ee.AFrameworkApplication.ha.ta("LogCoalescedEventsIsEnabled"),da.oAc=Ee.AFrameworkApplication.ha.ta("CheckExistenceOfGetCoalescedEventsIsEnabled"),da.ZVd=Ee.AFrameworkApplication.ha.ta("CheckIfHammerExistsAfterDownloadIsEnabled"),da.rDc=Ee.AFrameworkApplication.ha.ta("HammerJsPerformanceTimersIsEnabled"),da.LSa=da.ojb&&Ee.AFrameworkApplication.ha.ta("CancelDragFromGestureInputManagerIsEnabled")&&Ee.AFrameworkApplication.ha.ta("UseGestureInputManagerPointerCacheIsEnabled"));return da}function c(){}
function m(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function r(n,O,da,l,K,ka,$a,Lb,bc){n=Tj.call(this,n,da,l,ka)||this;n.deb=O;n.nfa=$a;n.ZW=Lb;n.eEj=bc;n.Scg=
K;return n}function t(){this.EBc=null}function k(){this.aca=this.uNe=null}function u(n){var O=xk.call(this)||this;O.$=n;O.fc();return O}function w(n,O,da,l,K){var ka=Mk.call(this)||this;ka.UN=null;ka.u_=null;ka.RDa=null;ka.kpc=null;ka.VHc=null;ka.dVa=null;ka.Oyc=!1;ka.$=n;ka.tableManager=da;ka.contextMenuManager=l;ka.Gg=new v(n,Object(Kc.a)(ka,ka.Yc,"onClick"),O,K);ka.dm=O.ave(n,da);ka.hTc=!1;ka.$4b=!1;ka.Kbd=fd.EwaSettings.ka(138);ka.LFc=!0;ka.gridView=te.g(ka.$);ka.gridView.Hc.Cm(Object(Kc.a)(ka,
ka.tk,"onEditStarted"));ka.gridView.Eq(Object(Kc.a)(ka,ka.KQ,"onGridContentReady"));ka.$.Nk(Object(Kc.a)(ka,ka.sd,"onWorkbookOpened"));ka.$.yn(Object(Kc.a)(ka,ka.Yd,"onWorkbookClosing"));ka.$.zD(Object(Kc.a)(ka,ka.kk,"onContentAreaResized"));ka.gridView.view.nt(Object(Kc.a)(ka,ka.qq,"onGridScroll"));ka.gridView.ga.I1(Object(Kc.a)(ka,ka.Ih,"onSelectionEnded"));ka.ylb=Ec.a.instance.create(Object(Kc.a)(ka,ka.nW,"showOrHideButtonOnGrid"),250,Xc.a.cKi);Rc.ULS.sendTraceTag(38887756,0,50,"Feature TableWidget enabled");
ka.dm.iPc(Object(Kc.a)(ka,ka.FAb,"onFieldInfoListContextLoaded"));ka.nW();n.ea.La(261,ka);return ka}function v(n,O,da,l){var K=jk.call(this)||this;K.isMac=Tg.a.isMac;K.$=n;K.ariaLiveNotifier=l;K.ck=da.qob(n,null,O,Df.a.efh,Jg.a.Ee(9),Sd.a.instance.da(1663),"PulloutPointerDown");return K}function A(n){var O=Bi.call(this)||this;O.zZc=null;O.$=n;O.fc();return O}function y(n){var O=Sj.call(this)||this;O.$=n;return O}function x(){}function z(n,O,da,l,K){da=void 0===da?null:da;l=void 0===l?null:l;K=void 0===
K?0:K;n=B.call(this,n,O)||this;n.HLa=null;n.dac=da||Jg.a.current.En(84);n.Fbf=K;n.Ywe=l;n.Zog();return n}function J(n,O,da,l){n=B.call(this,n,O)||this;n.nyb=null;n.qbg=da;n.OQh=l;n.$og();return n}function B(n,O){n=ck.call(this,n)||this;n.oyb=null;n.wTh=Math.max(1,O);return n}function C(n,O,da,l,K,ka,$a,Lb){Lb=void 0===Lb?"":Lb;var bc=Fj.call(this)||this;bc.Oua=null;bc.N_e=!1;bc.zgc=null;bc.ygc=null;bc.buttons={};bc.SDe={};bc.$=n;bc.svgIconProvider=O;bc.upi=da;bc.ied=l;bc.hed=K;bc.altText=ka;bc.GCb=
$a;bc.buttonText=Lb;return bc}function H(n,O,da,l,K,ka,$a,Lb){function bc(wd){Sh.g(wd)}var Dc=jj.call(this,document.createElement("div"))||this;Dc.O$e=null;Dc.TKd=!1;Dc.eQa=null;Dc.pJb=null;Dc.yY=Dc.Ud.Ora();Dc.set_visible(!1);Dc.pdc=K;Dc.GCb=ka;Dc.ahc=n;Dc.AZb=O;Dc.pdc&&(Dc.eQa=Ec.a.instance.create(Object(Kc.a)(Dc,Dc.Zhj,"shyTimerFired"),3E4,"OnObjectButton.ShyTimerFired",!1,!1));mf.a.na(n)||Sys.UI.DomElement.addCssClass(Dc.domElement,n);Dc.GXa=document.createElement("div");Dc.domElement.appendChild(Dc.GXa);
mf.a.na(da)||Sys.UI.DomElement.addCssClass(Dc.GXa,da);mf.a.na(l)||(Dc.GXa.innerHTML=l);mf.a.na($a)||(Dc.pJb=document.createElement("div"),Dc.domElement.appendChild(Dc.pJb),Sys.UI.DomElement.addCssClass(Dc.pJb,Lb),Dc.pJb.innerText=$a,Dc.domElement.style.padding="3px",Yj.a.instance.qa(Ve.a.pointerDown,Dc.domElement,Object(Kc.a)(Dc,Dc.MM,"onElementPointerDown")));Dc.yXa=new Ni.a(Dc.domElement,7);Jf.a.instance.qa(Ve.a.click,Dc.domElement,Object(Kc.a)(Dc,Dc.Yc,"onClick"));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
Yj.a.instance.qa(Ve.a.pointerDown,Dc.domElement,Object(Kc.a)(Dc,Dc.MM,"onElementPointerDown"));Dc.tc.la("mouseup",bc);Dc.tc.la("click",bc);Dc.tc.la("dblclick",bc);return Dc}function W(){}function S(n,O,da,l){n=N.call(this,n,O)||this;n.c_a=null;n.W9f=da;n.contextMenuManager=l;return n}function N(n,O){var da=wi.call(this)||this;da.Q0=null;da.lsb=null;da.kFb=null;da.PGc=!1;da.DPb=!1;da.wb=n;da.tableManager=O;return da}function T(n){var O=Ih.call(this)||this;O.firstElement=null;O.lo=null;O.xKa=!1;O.$r=
null;O.Ybj=Tg.a.Pf||Tg.a.sA;O.$=n;(n=O.$.fa.mc)&&Rc.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",n.C9,n.inWebPart?"Classic":"Non Classic",n.inEmbedView?"True (+Modern)":"False (not Modern)");n&&(n.inWebPart||n.inEmbedView)?Rc.ULS.sendTraceTag(40121935,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",n.inWebPart?
"Classic":"Non Classic",n.inEmbedView?"True (+Modern)":"False (not Modern)"):(O.XTg(),O.VUg(),Qj.KeyInputManager.instance.qa(Ve.a.Rb,O.$.domElement,Object(Kc.a)(O,O.juf,"onWorkbookKeyDown")));O.$.ea.La(238,O);return O}function fa(n,O,da,l,K){K=void 0===K?null:K;var ka=ij.call(this)||this;ka.Skb=null;ka.TMa=null;ka.lTc=0;ka.Gjc=null;ka.Omg=n;ka.Pmg=O;ka.documentVisibilityObserver=da;ka.cka=l;ka.HN=K;da&&ka.documentVisibilityObserver.tkb(Object(Kc.a)(ka,ka.Pwa,"onDocumentUnhidden"));ka.kTc=!!da&&fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",
!1);ka.Gme=fd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);O=fd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);ka.Hme=n.Grb(O);n=fd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);ka.OFg=Math.max(ka.Hme-O,0)+n;return ka}function Y(){this.startTime=cg.a.Ta.Lb;this.Yw=new ik.a}function L(n){var O=Dh.call(this)||this;O.$=n;O.fc();
return O}function P(n,O,da,l,K){this.G4=!1;this.QPa=!0;this.qLa=null;this.pLa=-1;this.$=n;this.functionInfoManager=O;this.formulaAssistanceUIControl=K;this.pluginScheduler=l;Gc.instance.$=n;this.naa=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.Kzb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.UBa=new ja(this.$,this.formulaAssistanceUIControl);this.P7=new X(this.$,this.formulaAssistanceUIControl);this.functionInfoManager.xkb(Object(Kc.a)(this,
this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));n.ea.La(464,this);this.calcManager=da;Xg.a.jva()&&this.jfd();this.naa&&(te.g(this.$).zc.mt(Object(Kc.a)(this,this.Zk,"onEditEnded")),this.UBa.Urg(Object(Kc.a)(this,this.Ijf,"onArgumentAssistanceDismissClick")));this.c3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function ea(){this.argumentAssistance=this.functionSuggestion=null}function X(n,O){var da=Xh.call(this,X.hIa())||this;da.qb=null;da.Oq=
null;da.KGa=!1;da.LGa=!1;da.JGa=!1;da.HGa=!1;da.IGa=!1;da.Tw=null;da.D_=0;da.Ur=null;da.visible=!1;da.W0=!1;da.zab=!1;da.tIb=!1;da.sIb=!1;da.visible=da.get_visible;da.visible=da.set_visible;da.$=n;da.formulaAssistanceUIControl=O;da.nja=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");da.nja&&(da.Oq=new va(da.$,da.formulaAssistanceUIControl,1,dd.a.V6c,Object(Kc.a)(da,da.Obd,"handleAutoCompleteFocusGained")));te.g(da.$).view.nt(Object(Kc.a)(da,da.qq,"onGridScroll"));
te.g(da.$).ga.$F(Object(Kc.a)(da,da.nd,"onSelectionChanged"));da.$.Aa.Vf(Object(Kc.a)(da,da.Ii,"onActiveSheetChanged"));da.SZh=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);da.Fhd=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");da.jhd=da.SZh&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");da.y3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609490_FormulaAssistanceUiUpdateContext_V2");
da.oaa=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");da.hgd=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638561_BlockPreviewWhenCellTextHasLines");da.yhd=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5667956_FixFocusStaysInFormulaBarAfterDismissPreview");da.Jva=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5649734_UpdateColoredReferencesAfterDismissPreview");da.yKa=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");
return da}function ja(n,O){var da=Qi.call(this,ja.hIa())||this;da.US=0;da.Oq=null;da.Ur=null;da.Tja=null;da.visible=!1;da.$=n;da.formulaAssistanceUIControl=O;da.hl=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);da.tE=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5321589_NewEditingAccessibilityMode_1");da.naa=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);da.qHd();da.tE&&(da.Oq=new va(da.$,da.formulaAssistanceUIControl,
0,dd.a.T6c));da.A9e=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5328968_FormulaAssistanceZoom");da.mvb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5500438_ArgumentAssistanceReadout");da.y3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609490_FormulaAssistanceUiUpdateContext_V2");da.f4a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5734156_ReadoutNoParamsFix");te.g(da.$).view.nt(Object(Kc.a)(da,da.qq,"onGridScroll"));te.g(da.$).ga.$F(Object(Kc.a)(da,da.nd,"onSelectionChanged"));return da}function R(n,
O,da,l,K,ka,$a,Lb){var bc=ri.call(this,n)||this;bc.g$b=!1;bc.Oq=null;bc.IEa=null;bc.Nj=null;bc.XU=null;bc.bld=null;bc.y4=null;bc.t0a=0;bc.s6b=0;bc.W2=0;bc.zAe=0;bc.xpb=0;bc.Wab=0;bc.b1b=0;bc.Nrc=!1;bc.Hha=null;bc.ikc=null;bc.columnName="";bc.t0c=!1;bc.Vne=!1;bc.YHa=[];bc.ML=null;bc.mQa=[];bc.G4=!1;bc.Ur=null;bc.r7c=null;bc.q7=null;bc.W0=!1;bc.zab=!1;bc.tIb=!1;bc.sIb=!1;bc.qLa=null;bc.pLa=0;bc.KUd=null;bc.Xe=n;bc.functionInfoManager=O;bc.domElement.className=yc.a.bEe;bc.dm=ka.ave(n,da);bc.fye=new E(n);
bc.Jkg=da;bc.formulaAssistanceUIControl=$a;bc.pluginScheduler=Lb;Gc.instance.$=n;bc.hl=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);mf.a.na(R.Mdd)&&(R.Mdd=R.hIa());bc.domElement.innerHTML=R.Mdd;bc.Ord=RegExp("\\d+");wk.c(bc.style,bc.Xe.isChromeRtl);bc.Uha=new db(bc.Xe,bc.domElement,bc.functionInfoManager,bc.formulaAssistanceUIControl,bc.pluginScheduler);O=$get(Ub.o7c,bc.domElement);da=$get(Ub.k7c,bc.domElement);ka=$get(Ub.q7c,bc.domElement);bc.Icg=
new sb(bc.Xe,O,ka,da,bc);bc.dm.iPc(Object(Kc.a)(bc,bc.FAb,"onFieldInfoListContextLoaded"));bc.functionInfoManager.xkb(Object(Kc.a)(bc,bc.onFunctionInfoLoaded,"onFunctionInfoLoaded"));bc.functionInfoManager.rsg(Object(Kc.a)(bc,bc.inf,"onFunctionInfoReset"));bc.hl&&(bc.Xe.Aa.Vf(Object(Kc.a)(bc,bc.Ii,"onActiveSheetChanged")),bc.Ef.Rfe(Object(Kc.a)(bc,bc.csf,"onSelectedAutoCompleteItemChanged")));bc.CQa(!0);bc.UWf(!0);bc.Xe.domElement.appendChild(bc.domElement);bc.JKc=0;(da=Fi.a(n))&&Array.add(bc.YHa,
new ua(n,da,bc));Array.add(bc.YHa,new ua(n,te.g(n).Hc,bc));bc.nrb=bc.YHa[0];bc.Kmb=bc.YHa[bc.YHa.length-1];n.ea.La(221,bc);bc.calcManager=l;bc.instantaneousSupportInformationManager=K;bc.instantaneousSupportInformationManager||bc.Xe.ea.ub(268,function(Dc){bc.instantaneousSupportInformationManager=Dc});bc.fJe=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);bc.yab=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled",
!1);bc.rwb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5544050_PluginSchedulerDependency");bc.Kzb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");Xg.a.jva()&&bc.jfd();Xg.a.tM(bc.Xe)&&Sys.UI.DomElement.addCssClass(O,"ewa-fb-refactor");bc.hl?te.g(bc.Xe).ga.$F(Object(Kc.a)(bc,bc.nd,"onSelectionChanged")):te.g(bc.Xe).ga.I1(Object(Kc.a)(bc,bc.nd,"onSelectionChanged"));bc.nja=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");bc.nja&&
(bc.Oq=new va(bc.Xe,bc.formulaAssistanceUIControl,1,dd.a.V6c,Object(Kc.a)(bc,bc.Obd,"handleAutoCompleteFocusGained")));bc.y3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609490_FormulaAssistanceUiUpdateContext_V2");bc.O3h=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5610524_FACOnGridScroll");bc.r4e=bc.hl&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5623187_SelectSmartSuggestionsByDefault")&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5629748_EnableRangePickingInSmartSuggestionsOnly");bc.hgd=
bc.hl&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638561_BlockPreviewWhenCellTextHasLines");bc.v1h=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5642964_FixAutoCompleteBehaviorForDefinedNames");bc.yhd=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5667956_FixFocusStaysInFormulaBarAfterDismissPreview");bc.Jva=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5649734_UpdateColoredReferencesAfterDismissPreview");bc.yKa=bc.hl&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");
return bc}function ba(){}function ha(){this.caretPosition=this.content=null}function oa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function Sa(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function ma(){this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function na(){this.yS=this._name=null}function xa(){this._name=null}function Oa(){this._name=null}function ib(){this.yS=
this._name=null}function sb(n,O,da,l,K){n=bi.call(this,n,O)||this;n.kfa=null;n.xpc=0;n.nQa=0;n.pXc=null;n.BMe=da;n.trb=l;n.formulaAssistanceControl=K;n.Fr=[];n.GV=[];n.hl=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);n.Mjd=n.hl&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5623187_SelectSmartSuggestionsByDefault");return n}function nb(){this.textEdit=this.label=null;this.kind=0;this.detail=this.type=null}function Gb(n,O){this.$=n;this.items=O}function Ha(n,
O){this.pIi=n;this.mhf=O}function ca(){}function Ra(n){this.index=n}function ua(n,O,da){n=di.call(this,n,O)||this;n.tuf=!1;n.UPa=null;n.ued=0;n.dAc=null;n.nGa=null;n.nP=0;n.formulaAssistanceControl=da;n.aXa=O.textBox;n.c3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");n.hl=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);n.cSi=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemovedGetFieldInfoOptimizationsFromOnEditStarted",
!1)&&fd.EwaSettings.YG();return n}function ta(){this.Pga=this.ura=this.vra=!1;this.Fuf=40;this.are=41;this.sYa=this.lvd=this.mvd=this.jCb=0;this.Clf=!0;this.Ytd=!1;this.SKe=this.HFd=-1}function db(n,O,da,l,K){var ka=hi.call(this,db.hIa(fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1)))||this;ka.$Za=null;ka.US=0;ka.Oq=null;ka.bRc=!1;ka.Ur=null;ka.Tja=null;ka.QPa=!0;ka.$=n;ka.Pi=O;ka.functionInfoManager=da;ka.formulaAssistanceUIControl=l;ka.pluginScheduler=
K;ka.hl=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1);ka.tE=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5321589_NewEditingAccessibilityMode_1");ka.naa=ka.hl&&fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);ka.hl?(ka.qHd(),ka.tE&&(ka.Oq=new va(ka.$,ka.formulaAssistanceUIControl,0,dd.a.T6c)),ka.naa&&te.g(ka.$).zc.mt(Object(Kc.a)(ka,ka.Zk,"onEditEnded"))):(ka.$Za=new Ia(ka.domElement,ka.$.Xz,void 0,Xg.a.tM(ka.$)),
ka.tc.la("mousedown",Object(Kc.a)(ka,ka.dsi,"onFunctionBoxMouseDown")),n=$get(Ub.o7c,ka.Pi),ka.Pi.insertBefore(ka.domElement,n));ka.A9e=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5328968_FormulaAssistanceZoom");ka.mvb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5500438_ArgumentAssistanceReadout");ka.y3a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609490_FormulaAssistanceUiUpdateContext_V2");ka.f4a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5734156_ReadoutNoParamsFix");ka.rwb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5544050_PluginSchedulerDependency");
te.g(ka.$).view.nt(Object(Kc.a)(ka,ka.qq,"onGridScroll"));return ka}function Ta(){this.content=null;this.caretPosition=0}function qb(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function za(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function Ia(n,O,da,l){l=void 0===l?!1:l;O=rh.call(this,n,O,!1,void 0===da?null:da)||this;O.BPa(l);O.fj=mf.a.equals("rtl",n.dir,!0);return O}function va(n,O,da,l,K){this.VTc=!1;this.$=n;this.formulaAssistanceUIControl=
O;this.eMe=da;this.W2i=l;this.EXe=void 0===K?null:K}function Ua(n,O,da){var l=Af.call(this)||this;l.p7c=n;l.UFd=O;l.HDi=da;return l}function Kb(n){var O=$e.call(this)||this;O.UFd=n;return O}function ia(n,O){var da=se.call(this)||this;da.functionName=n;da.p7c=O;return da}function E(n){this.gye={};this.$=n}function fb(){this.rDa=this.FDa=this.yS=this._name=null}function Za(){this.hS=0;this.G0d=!1;this.FTa=this.Z1d=null;this.H1d=!1;this.textEdit=null}function ec(n){this.Cob=this.xga=this.calcManager=
this.qb=null;this.$=n;this.mrb=new Ab(n);this.g6b=new kc(n);this.h6b=new zc(this);te.g(n).Hc.mt(Object(Kc.a)(this,this.Twa,"onEditCellEnded"));this.$.ea.La(317,this)}function zc(n){this.Q6=0;this.U6c=n}function Ab(n){this.Toa=this.EQa=this.x_a=this.eP=this.G9=this.qb=null;this.Bcd=!1;this.Qc=n}function vb(){}function kc(n){this.ygi=30;this.calcManager=null;this.Ld=!1;this.UMa=this.uCb=this.E7a=null;this.$=n;this.zga=new Oc;this.RHf=-1;this.$.fa.BD(Object(Kc.a)(this,this.MA,"onStateIdChanged"))}function td(n,
O,da,l,K,ka,$a){$a=n.Ra(1,void 0===$a?null:$a);$a.getPartialCalcResultsParameters=O;return nf.i(n,"GetPartialCalcResults",$a,da,l,K,ka,4)}function Oc(){this.zOa={}}function tc(n){var O=ni.call(this)||this;O.$=n;O.fc();return O}function sc(n,O){this.dIa=this.WHa=this.Vha=null;this.$=O;this.ariaLiveNotifier=n;this.$.ea.La(219,this);this.f4a=(this.lwb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5500438_ArgumentAssistanceReadout")&&fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",
!1))&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5734156_ReadoutNoParamsFix");this.yKa=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1)&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout")}function ic(n){return Ek.call(this,n)||this}function Ga(n,O,da){this.$ph="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;
this.$=n;this.functionInfoManager=da;this.Va=O;this.wL={};this.frame=this.$.frame;this.functionInfoManager.xkb(Object(Kc.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"))}function cb(n,O){var da=hk.call(this,n,Sd.a.instance.da(981),void 0,void 0,void 0,fd.EwaSettings.ka(413))||this;da.cIa=null;da.Yha=null;da.bIa=null;da.vrb=null;da.yMe=null;da.Xha=null;da.zMe=null;da.CMe=null;da.Hbf=null;da.urb=null;da.Mcd=!1;da.NYb=null;da.Z4=null;da.aub=null;da.functionInfoManager=n.ea.Ea(19,void 0);da.formulaAssistanceControl=
n.ea.Ea(221,void 0);da.bHa=O;da.DUc=O.textBox.caretPosition;return da}function Tb(n){var O=xh.a.mV,da=n.ea.Ea(368,void 0);da&&!te.g(n).Zi&&(O=da.zoom);return O}function Bb(n,O,da){if(n)if(Gc.instance.Wha.argumentAssistanceLearnMoreCounter++,da){if(!mf.a.na(O)&&(!O||O.startsWith("http://")||O.startsWith("https://"))){if(n.ka(159)&&(n=n.ea.Ea(269,void 0))&&n.Tza(O))return;Z.HelperMethods.wf(O,"_blank",qk.a)}}else if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5696885_ArgumentAssistanceHelpTaskPane")){da=
new ig.a(-859308420,Kg.a.Yb,n.jd,0,null);var l={};O=(l.MenuItemId=ub.a.bZ,l.CommandValueId="HelpID="+O,l);n.Na.Xb(da,O)}else Z.HelperMethods.y5(n.uF,nc.cFh(O),n.yR)}function nc(n,O){var da=Dk.call(this)||this;da.Ncg=[];da.s7c={};da.EMe={};da.eS=null;da.Q7=[];da.eIa={};da.hFc=!1;da.fFc=!1;da.wb=n;da.pluginScheduler=O;da.rwb=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5544050_PluginSchedulerDependency");da.$.ea.La(19,da);return da}function Gc(){this.Wha=new Mb;this.k6b=new Hb;this.P1=new Jb;this.Llb=
new Va;this.wb=null;this.Vpc=new Da;this.F7a=new Ij.a}function La(){this.Zy=new wa;this.AY=[];this.bgc=-1;this.uGd=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5819461_separateFormulaTelemetryFirstAction");this.uGd||(this.Zy.includingFirstAction=new Wa)}function Wa(){this.P95=this.P75=this.median=this.max=this.average=0}function wa(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=null}function Da(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=
this.argumentAssistanceFlight=null}function Va(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function Jb(){this.commitByMouseClickCounter=this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=0}function Hb(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=0}function Mb(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceDismissCounter=
this.argumentAssistanceLearnMoreCounter=this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function Ub(){}function pb(n){var O=Pg.call(this)||this;O.$=n;O.fc();return O}function gb(n){var O=Ak.call(this,document.createElement("div"))||this;O.sQ=!1;O.ZP=!1;O.cYb=!1;O.Fh=null;O.Oh=null;O.pid=!1;O.ljd=!1;O.lgd=!1;O.x1b=[];O.$=n;O.gridView=te.g(O.$);O.lD=O.gridView.Hc;var da="<div id='dv_reader_description' class='"+xj.a.VEe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+
Pc.dbh+" "+Df.a.zu+"'></div>\r\n<div id='dv_list_box' class='"+Pc.jah+" "+Df.a.Er+" "+Df.a.zu+"'></div>\r\n<div id='dv_prompt_box' class='"+Pc.bbh+" "+Df.a.zu+"'></div>";O.domElement.className=Pc.cbh;O.domElement.innerHTML=da;wk.c(O.style,O.isGridRtl);O.og=$get("dv_list_box",O.domElement);O.g_=$get("dv_prompt_box",O.domElement);O.Zqa=$get("dv_list_button",O.domElement);O.gyb=$get("dv_reader_description",O.domElement);(da=Fi.a(n))&&Array.add(O.x1b,new xb(n,da,O));Array.add(O.x1b,new xb(n,O.gridView.Hc,
O));O.gridView.ga.WF(Object(Kc.a)(O,O.uh,"onActiveCellChanged"));O.gridView.Eq(Object(Kc.a)(O,O.onContentReady,"onContentReady"));O.gridView.zc.Zrg(Object(Kc.a)(O,O.kmf,"onEditBoxDimensionsChanged"));O.$.yn(Object(Kc.a)(O,O.Yd,"onWorkbookClosing"));da=O.gridView.Pi;da.insertBefore(O.domElement,da.firstChild);O.onContentReady(null,null);n.ea.La(14,O);return O}function Qa(n,O,da,l,K,ka,$a,Lb,bc,Dc){var wd=pk.call(this,document.createElement("a"))||this;wd.rl=!1;wd.k8g=Lb;wd.h3g=bc;wd.nI=Qa.zb(wd.domElement,
O,da,l,K,ka,$a,Dc);wd.tc.la("contextmenu",function(ke){Sh.g(ke)});wd.enable();wd.hovered=!1;wd.focused=!1;n.appendChild(wd.domElement);return wd}function eb(n,O,da){n=Aj.call(this,n,O,new vk.a(Pc.listItem,Pc.dyb,Pc.hyb,Pc.iyb))||this;n.zib=null;n.me=null;n.Dca=null;n.bV=null;n.tGa=null;n.CLa=0;n.ZBb=[];n.gyb=da;return n}function xb(n,O,da){n=hj.call(this,n,O)||this;n.dataValidationControl=da;return n}function dc(n,O,da){var l=Ej.call(this,n)||this;l.U9=null;l.ZT=null;l.N7e=!1;l.errorMessage=null;
l.JZe=null;l.Dm=null;l.ada=null;l.FDe=da;l.sqmManager=gk.a(l.$);l.error=dc.QP(O,n,da);l.Db.vp=l;n=n.ea.Ea(14,void 0);l.vu=n.P0a(l.FDe);l.mHa=l.vu&&l.vu.mHa?l.vu.mHa:Sd.a.instance.da(1659);l.P6i();l.initializeAndShow(l.mHa,Object(Kc.a)(l,l.oxe,"dataValidationErrorDialogHandler"),l.U9);return l}function Nc(n,O,da){O=Xj.call(this,n,Nc.QP(O,n,da))||this;te.g(O.$).ga.$F(Object(Kc.a)(O,O.nd,"onSelectionChanged"));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&(n=n.ea.Ea(14,
void 0).P0a(da))&&n.options&1&&Rc.ULS.sendTraceTag(538817693,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return O}function Pc(){}function Fd(n){var O=Wi.call(this)||this;O.$=n;O.fc();return O}function Ea(n,O){this.gXa=null;this.ariaLiveNotifier=n;O.La(213,this)}function Xa(n){var O=zk.call(this)||this;O.$=n;O.fc();return O}function hc(n){var O=uk.call(this)||this;O.$=n;O.fc();return O}function Xb(n,O){var da=this;this.rLa=
1;this.Dfa=[];this.active=!1;this.tableManager=n;this.gridView=O;this.$=O.$;n.Gfe(Object(Kc.a)(this,this.Jqf,"onRangeListUpdated"));O.xsg(Object(Kc.a)(this,this.Xnf,"onHeaderViewBlockCreated"));O.ysg(Object(Kc.a)(this,this.Ynf,"onHeaderViewBlockDisposed"));this.$.Aa.Vf(Object(Kc.a)(this,this.vf,"onActiveItemChanged"));this.$.Ab.Vf(Object(Kc.a)(this,this.vf,"onActiveItemChanged"));this.Yie(function(l){l.VPc(Object(Kc.a)(da,da.rJa,"headerBlockOnUpdatedBlockHtml"))});this.Ke()&&(this.activate(),this.jw(this,
null));this.$.ea.La(68,this)}function Ic(n){return tk.call(this,n)||this}function Qc(n,O,da,l,K,ka){this.FD=null;this.NXa=1461300262;this.xB=this.JXa=this.Yyb=this.f6b=null;this.$=n;this.gridView=O;this.Fi=da;this.OA=l;this.borderFormatManager=K;this.moreColorsHelper=ka;this.Boh=new Zc(this.$);this.Fg=fd.EwaSettings.Fg();this.kgc=new Cb(this.$,da);this.eH=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}function Cb(n,O){this.$=n;this.Fi=O;this.WX=new Wc(te.g(this.$).Ha,
this.$);this.q7e=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.tbc=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.yid=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL")}function $c(){this.scenario=0;this.MHa=null}function ae(){this.EOa=this.QEa=this.yLa=this.cRa=0}function Mc(n,O,da,l){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=
this.fillRangeType=0;this.sourceSheetRange=n;this.targetSheetRange=O;this.fillRangeType=da;this.fillRangeDirection=l}function Hd(n,O,da){n=sj.call(this,n)||this;n.$n=null;n.P0c=0;n.Yo=O;n.selectedRanges=da;O=Object(pf.a)(fg.a,n.$.Aa.sa);n.isRtl=O.displayRtl;return n}function Nd(n,O,da,l,K,ka){this.mTd=!1;this.nTd=null;this.Sxc=0;this.ej=null;this._state=0;this.Cf=n;this.IAa=O;this.HAa=this.aTd=K;this.DLb=ka;this.lu=this.TK;this.moveNext()}function ge(n,O,da,l,K,ka,$a,Lb){this.Pxc=0;this.pTd=this.Txc=
!1;this.ej=this.rTd=null;this._state=0;this.Cf=n;this.IAa=O;this.E6f=K;this.HAa=this.aTd=ka;this.DLb=$a;this.$Sd=Lb;this.lu=this.TK;this.moveNext()}function Ed(n,O,da,l){this.Gcg=n;this.Hcg=O;this.ukg=da;this.ZSb=l}function Zc(n){this.$=n;this.m_h=!!String.fromCodePoint&&!Tg.a.tf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.c7e=!1}function he(n){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=n}function Ke(n){var O=Rf.call(this)||
this;O.$=n;O.fc();return O}function Ue(n){return Qe.call(this,n)||this}function Pb(n,O){this.n6b=this.uyd=null;this.$=n;this.gridView=te.g(n);this.JE=O.aZa(this.$.domElement,500,null,null);this.iJa=this.hJa=-1}function kb(n){this.freezeOptions=null;this.freezeOptions=n}function yb(){}function Ma(n){var O=M.call(this)||this;O.h2i="formulaAssistance";O.$=n;O.fc();return O}function jd(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Zd(n){var O=Lh.call(this)||this;O.$=n;O.fc();return O}function Zb(n){var O=
this;this.WX=this.calcManager=this.gm=this.hQa=null;this.$=n;this.$.ea.ub(268,function(da){O.gm=da});this.Moh=new id(te.g(this.$).Ha,this.$);this.b2=new Yd(this.$,te.g(this.$),this);this.$.ea.ub(266,function(da){O.calcManager=da});this.hbc=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CSEPlainTextOptimization",!1);this.Fg=fd.EwaSettings.phd()}function wb(n,O){this.success=n;this.LP=O}function gc(){this.Q4f=this.hCj=!1;this.source=0;this.WJa=this.Ucc=!1}function uc(n,O,da,l,K){da=void 0===
da?null:da;l=void 0===l?null:l;K=void 0===K?null:K;Rc.ULS.shipAssertTag(555032865,0,!!(!!(null!=da^!(void 0===l||null===l))^!(void 0===K||null===K))&&!(null!=da&&void 0!==l&&null!==l&&void 0!==K&&null!==K),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=da&&0>da&&(Rc.ULS.sendTraceTag(555032864,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),da=null);this.gm=n;this.oq=O;this.Fcg=da;this.k6a=l;this.jpa=K}function id(n,O){this.WX=null;this.Ha=n;
this.JY=O}function Wc(n,O){this.Ha=n;this.JY=O}function pd(n,O,da){this.success=n;this.nhc=void 0===O?null:O;this.reason=void 0===da?"":da}function Yd(n,O,da){var l=this;this.Zba=[];this.calcManager=this.Ftc=this.lastSetCellInstantaneousOperation=null;this.$=n;this.grid=O;this.Fi=da;this.Rba=Yd.Vxe;this.$.ea.ub(268,function(K){l.Ftc=K});this.$.ea.ub(266,function(K){l.calcManager=K})}function be(n,O,da,l){this.rangeDelta=n;this.stateId=O;this.isFinished=da;this.priorityGroup=l}function me(n,O,da,l,
K,ka,$a,Lb,bc,Dc,wd,ke,jf,Xf,Sf,xg,xi,Oi,pj,dk,Yi,Jj,Gk,Hk,Ok){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=
this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===n?0:n;this.numberOfNonUpdatedCells=
void 0===O?0:O;this.numberOfUpdatedCells=void 0===da?0:da;this.numberOfCellsUpdatedAlreadyByServer=void 0===l?0:l;this.numberOfCellsSkippedDueToTimeout=void 0===K?0:K;this.numberOfCellsWithNoFormattedCell=void 0===ka?0:ka;this.numberOfUnsupportedErrorCellTypes=void 0===$a?0:$a;this.numberOfUnsupportedBlankCellTypes=void 0===Lb?0:Lb;this.numberOfUnsupportedRichCellTypes=void 0===bc?0:bc;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===Dc?0:Dc;this.totalExecutionTime=void 0===wd?0:wd;this.originalProcessingTimeLimit=
void 0===ke?0:ke;this.newProcessingTimeLimit=void 0===jf?0:jf;this.numberOfEditedRecalcedCellsInBatch=void 0===Xf?0:Xf;this.numberOfDependentRecalcedCellsInBatch=void 0===Sf?0:Sf;this.isNewTask=void 0===xg?!1:xg;this.lastSetCellInstantaneousOperation=void 0===xi?"":xi;this.taskId=void 0===Oi?0:Oi;this.isNewNumberFormatter=void 0===pj?null:pj;this.numberOfRecalcedCellsWithFormattedValue=void 0===dk?null:dk;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===Yi?null:Yi;this.totalNumberFormatterTime=
void 0===Jj?null:Jj;this.newNumberFormatterFinalizeFailures=void 0===Gk?null:Gk;this.numberOfMeasureTextWidthCalls=void 0===Hk?null:Hk;this.numberOfHashFormattedValues=void 0===Ok?null:Ok}function Gd(n,O,da,l,K,ka,$a,Lb,bc){this.Dkg=n;this.Zhb=void 0===$a?"":$a;this.ny=void 0===O?"":O;this.Pfb=void 0===da?null:da;this.Bcg=void 0===l?null:l;this.Bgg=void 0===K?0:K;this.$lg=void 0===ka?0:ka;this.Dgg=void 0===Lb?0:Lb;this.Agg=void 0===bc?null:bc}function Rd(){}function Yf(n,O,da,l,K){this.g2=void 0===
n?0:n;this.cellValue=void 0===O?"":O;this.ifmt=void 0===da?0:da;this.priorityGroup=void 0===l?"":l;this.LP=void 0===K?"":K}function mg(n){if(n.priorityGroup===$b.editCell)return 0;if(n.priorityGroup===$b.dependentCell)return 1;Rc.ULS.sendTraceTag(559957214,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function zf(n,O){var da=mg(O),l=!(void 0===O.rangeDelta.data.format||null===O.rangeDelta.data.format);Rc.ULS.shipAssertTag(559957218,0,!da||!l,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",
O.priorityGroup);n=Math.max(n.cell.numberFormatIndex,0);l&&(l=excelOnlineCalc.calc.getCellFormatKind(O.rangeDelta.data.format.format),"number"===l?n=O.rangeDelta.data.format.format:"string"===l?Rc.ULS.sendTraceTag(559957217,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===l?Rc.ULS.sendTraceTag(559957216,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Rc.ULS.shipAssertTag(559957215,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return n}function Ce(n){var O=n.value;switch(n.type){case 2:return void 0===O||null===O?"":O;case 1:return n=parseFloat(O),isNaN(n)?null:n;case 3:return n=parseFloat(O),isNaN(n)?null:1===n;case 4:return n=parseFloat(O),isNaN(n)?null:excelOnlineCalc.calc.errorValue(n);default:return excelOnlineCalc.calc.blankValue}}function ne(n){n=excelOnlineCalc.calc.getCellValueKind(n.rangeDelta.data.value);var O=0;switch(n){case "number":O=1;break;case "string":O=2;break;case "boolean":O=3;break;case "Error":O=
4;break;case "Blank":O=0;break;default:Rc.ULS.shipAssertTag(559957250,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",n)}return O}function Bf(n,O){n=excelOnlineCalc.calc.getCellValueKind(n.rangeDelta.data.value);switch(n){case "number":case "string":case "boolean":return!0;case "Blank":if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;O.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",
!1))return!0;O.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return O.numberOfUnsupportedRichCellTypes++,!1;default:return Rc.ULS.shipAssertTag(559957251,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",n),!1}}function Le(n){if(n=n.color){if("String"===Object.getType(n).getName())return Mi.a.Bp(n);if("Number"===Object.getType(n).getName())return null}else return null;Rc.ULS.sendTraceTag(559957252,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");
return null}function gd(n){n=n.alignment;if(n===Fc.center)return 2;if(n===Fc.left)return 1;if(n===Fc.right)return 3;Rc.ULS.sendTraceTag(559957253,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!");return 0}function $b(){}function Fc(){}function Vc(n,O,da,l,K,ka,$a,Lb,bc,Dc,wd,ke,jf){ke=void 0===ke?null:ke;jf=void 0===jf?null:jf;Lb=Nj.call(this,11,0,Lb,wd)||this;Lb.Loh=n;Lb.R6c=O;Lb.format=l;Lb.activeCell=da;Lb.Sie=K;Lb.Cwf=ka;Lb.xwf=$a;Lb.HDa=bc;Lb.clientCorrelationId=
Dc;Lb.Wib=ke;Lb.ifb=jf;return Lb}function ud(){}function Ge(n){var O=Ci.call(this)||this;O.JOb=null;O.$=n;O.fc();return O}function ce(n){var O=wj.call(this)||this;O.nyf=0;O.pG=null;O.$=n;return O}function Ae(n){var O=Mj.call(this,!1,!1,Ae.cy)||this;O.uod=!1;O.kef=!0;O.Hdf=0;O.lc=1;O.Dc(1,CommonUIStrings.l_Send);O.Dc(0,CommonUIStrings.l_NoThanks);O.Mf=Ob.G7f;O.Ddf=n;O.We=Ae.YFg;return O}function Ob(){}function ac(n){return Uj.call(this,n)||this}function fc(){}function Uc(n,O,da,l){n=Lj.call(this,n)||
this;n.qzb=null;n.ogc=null;n.Dac=null;n.v2=null;n.pja=!1;n.disposed=!1;n.hLa=!1;n.Ji=null;n.selectedRanges=O;n.hOb=da;n.command=l;3===l&&(n.pja=!0);n.lc=2;n.ku=!1;n.Mf=cc.Mf;return n}function Vd(n,O){this.options=this.cellRange=null;this.cellRange=n;this.options=O}function ld(n,O){n=qj.call(this,n)||this;n.Q8=null;n.mga=null;n.WRa=null;n.T8=null;n.S8=null;n.get_visible=n.Iia;n.set_visible=n.jma;n.uk=O;n.cja();return n}function Od(n,O){n=wg.call(this,n)||this;n.eaa=null;n.P1e=null;n.gaa=null;n.faa=
null;n.get_visible=n.Iia;n.set_visible=n.jma;n.uk=O;n.cja();return n}function De(){}function Yb(n,O,da,l){n=Ti.call(this,n)||this;n.Pqb=null;n.JFd=null;n.pja=!1;n.disposed=!1;n.hLa=!1;n.Ji=null;n.selectedRanges=O;n.hOb=da;n.command=l;3===l&&(n.pja=!0);n.lc=2;n.ku=!1;return n}function sa(n,O,da,l,K,ka,$a,Lb){Lb=n.Ra(9,void 0===Lb?null:Lb);Lb.selectedRanges=O;Lb.ruleOptions=da;return nf.i(n,"CreateOrEditDataValidation",Lb,l,K,ka,$a,0)}function hb(n,O,da){O=vj.call(this,O)||this;O.Jua=null;O.fac=null;
O.SS=null;O.fK=null;O.oxa=null;O.pxa=null;O.K2a=null;O.BLa=null;O.k7a=null;O.$Ma=null;O.Jjc=null;O.hvd=null;O.inh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];O.M2i=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];O.get_visible=O.Iia;O.set_visible=O.jma;O.qQ=new Aa.a;O.qQ.add(Sd.a.instance.da(1599));O.qQ.add(Sd.a.instance.da(1600));O.qQ.add(Sd.a.instance.da(1603));O.qQ.add(Sd.a.instance.da(1601));
O.qQ.add(Sd.a.instance.da(1602));O.qQ.add(Sd.a.instance.da(1604));O.qQ.add(Sd.a.instance.da(1605));O.qQ.add(Sd.a.instance.da(1606));O.qQ.add(Sd.a.instance.da(1607));O.qQ.add(Sd.a.instance.da(1608));O.qQ.add(Sd.a.instance.da(1609));O.qQ.add(Sd.a.instance.da(1610));O.qQ.add("");O.$=n;O.uk=da;O.cja();return O}function cc(){}function xc(n,O){this.gB=this.xZa=this.selectedRanges=null;this.kBe=!1;this.Ji=null;this.$=n;this.K_c=O}function vd(n){this.l4=(n=void 0===n?null:n)?n.IsIgnoreBlank:!0;this.m4=n?
n.IsInCellDropDown:!0;this.eK=n?n.LowerBoundary:"";this.RQ=n?n.UpperBoundary:"";this.VA=n?n.ConditionType:0;this.ruleType=n?n.RuleType:0;this.iZ=n?n.IsAlertBlocking:!0;this.QS=n?n.AlertTitle:"";this.PS=n?n.AlertMessage:"";this.IU=n?n.InputMessage:"";this.oE=n?n.InputTitle:"";this.t4=n?n.IsShowErrorAlert:!0;this.u4=n?n.IsShowInputMessage:!0}function Xd(n){switch(n){case 0:n="AnyValue";break;case 1:n="WholeNumber";break;case 2:n="Decimal";break;case 3:n="List";break;case 4:n="Date";break;case 5:n="Time";
break;case 6:n="TextLength";break;case 7:n="Custom";break;default:n="Unknown"}return n}function Je(n){switch(n){case 0:n="Between";break;case 1:n="NotBetween";break;case 2:n="Equal";break;case 3:n="NotEqual";break;case 4:n="GreaterThan";break;case 5:n="LessThan";break;case 6:n="GreaterThanOrEqual";break;case 7:n="LessThanOrEqual";break;default:n="Unknown"}return n}function ff(n){var O=Ei.call(this)||this;O.$=n;O.fc();return O}function Ye(n,O,da){this.Hsc={};this.Ld=!1;this.$=n;this.contextMenuController=
da;this.lZd=new Pe(this.$);n.ea.La(8,this);for(da=0;da<O.length;da++)this.Hsc[Ye.ZPg[da]]=O[da];this.ga=te.g(n).ga;this.ga.rVb(Object(Kc.a)(this,this.Yk,"onContextMenu"));this.$.Na.hEa(Object(Kc.a)(this,this.ylf,"onContextMenuClosed"));pe.a.instance.h$i();fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Na.rkb(Object(Kc.a)(this,this.Mwa,"onCommandExecutionStarting"));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||
this.$.fa.B1(Object(Kc.a)(this,this.i5,"onApplicationModeChanged"))}function Pe(n){this.$Je=null;this.$=n;this.rwa=new kg;fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1)&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.$Je=new wf(this.$))}function wf(n){this.hXa=null;this.BJd=!1;this.Sxb=0;this.l3c=1;this.VDe=0;this.$=n;this.gridView=te.g(this.$);this.OTh();this.e$g=this.$.Ba.AutoFilterEventRegistrationTimeLimit}function lf(){this.Od=
this.xke=this.cell=null}function kg(){this.c$b={}}function Bg(){this.menuModel=null;this.Dwe=0}function Qf(){this.dictionary=this.je=null}function Ug(n){var O=sd.call(this)||this;O.h1e=!1;O.$=n;O.fc();return O}function Kf(n,O){this.Unb=O;this.$=n}function Of(n){return Qb.call(this,n)||this}function hh(n,O,da,l){n=ai.call(this,n,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,hh.vpj,!0,!1,hh.uFb,O,da,!1,l)||this;n.mZa=0;n.kra=null;n.GIa=null;n.CBe=null;return n}function Eg(n,O,da){this.type=n;
this.YPg=O;this.Yo=da}function ng(n,O,da,l){return $i.call(this,n,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",O,da,!0,l)||this}function eg(n,O,da,l){n=Si.call(this,n,"PopulateSheetOpsContextMenu",274207288,-1497523576,"SheetOpsContextMenu",!0,!1,"SheetTabContextMenuRootName",O,da,!1,l)||this;n.Xbc=!1;n.qdc=!1;return n}function Yg(n,O,da,l){O=li.call(this,n,"PopulateRichTextContextMenu",679816325,1151222423,"RichTextContextMenu",!0,!1,"RichTextContextMenu",
O,da,!0,l)||this;O.grid=te.g(n);return O}function Ud(n,O,da,l){O=zd.call(this,n,"PopulateTableFieldListContextMenu",-751848458,-1085236154,"TableFieldListContextMenu",!0,!1,"TableFieldListContextMenuRoot",O,da,!1,l)||this;O.$0b=null;O.Hrd=0;O.ARb=null;O.grid=te.g(n);return O}function Tc(n,O,da,l){O=Mh.call(this,n,"PopulatePivotTableContextMenu",-1475408662,1114549926,"PivotTableContextMenu",!0,!1,"PivotTableContextMenuRootName",O,da,!0,l)||this;O.Zc=null;O.activeCell=null;O.nxc=null;O.zdc=!1;O.uhd=
!1;O.expandCollapse=!1;O.refresh=!1;O.IY=!1;O.ag=null;O.rz=null;O.PYa=null;O.Bb=null;O.X7a=null;O.waa=!1;O.f5g=new DOMParser;O.pcj=!0;O.grid=te.g(n);O.dgc=!0;return O}function qg(n,O,da,l){return Se.call(this,n,"PopulatePivotContextMenu",2123758504,912277356,O,da,l)||this}function Lg(n,O,da,l){n=ag.call(this,n,"PopulateFieldWellContextMenu",1374696078,495005930,"FieldWellContextMenu",!0,!1,"FieldWellContextMenu",O,da,!1,l)||this;n.cell=null;n.kl=null;n.to=null;n.externalSourceIndex=-1;n.QSd=-1;n.qQa=
0;n.Xsc=-1;n.NK=null;n.isOlap=!1;n.uE=!1;n.Q_a=!1;return n}function de(n,O,da,l,K,ka,$a,Lb,bc){K=Tf.call(this,K,Sd.a.instance.Eb(60),!0,2,!0)||this;K.HSf=!0;K.Tae=null;K.dQa=null;K.Kea=null;K.Pob=null;K.E_c=null;K.VLc=null;K.cell=n;K.to=O;K.externalSourceIndex=da;K.M4f=l;K.je=ka;K.I9=$a;K.isOlap=Lb;K.uE=bc;return K}function tg(n,O,da){da=void 0===da?null:da;this.$ib=this.ijb=null;this.y0=-1;this.Ai=n;this.zX=(void 0===O?null:O)||new Aa.a;this.Ikg=da||new lg;this.xDa=new Aa.a;n=0;O=Ml(this.zX);for(da=
O.next();!da.done;da=O.next()){da=da.value;this.Okd(this.y0)||(this.y0=n);var l=n++;this.xDa.add(new ve(document.createElement("li"),da.title,this.MTg(l)))}}function ve(n,O,da){this.Ai=n;this.jp=O;this.wAc=da;this.Aea=document.createElement("a");xe.a.tqc(this.Aea,this.jp);Sys.UI.DomElement.addCssClass(this.Aea,tf.Cnj);Sys.UI.DomElement.addCssClass(this.Ai,tf.Bnj);this.Ai.appendChild(this.Aea);this.Aea.tabIndex=0;this.Dvc();Bd.a.addHandler(this.Ai,"click",this.wAc);Bd.a.addHandler(this.Ai,"keyup",
Object(Kc.a)(this,this.$6a,"onTitleKeyUp"))}function tf(){}function lg(){}function Og(n){n=Ib.call(this,n)||this;n.q6d=null;n.get_visible=n.Iia;n.set_visible=n.jma;n.cja();return n}function Fa(){}function lb(n,O,da,l,K,ka,$a,Lb){n=Pa.call(this,n)||this;n.JE=null;n.v1b=null;n.vXb=null;n.XUd=null;n.YUd=null;n.yXd=null;n.get_visible=n.Iia;n.set_visible=n.jma;n.$=O;n.cell=da;n.to=l;n.externalSourceIndex=K;n.je=ka;n.I9=$a;n.D3h=Lb;n.Hxj=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");
n.cja();return n}function pc(){}function qc(n,O,da,l,K){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=n;this.activeCell=O;this.pivotFieldTitle=da;this.summarizeBy=l;this.showAsValueParameters=K}function Md(n,O,da){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=n;this.baseFieldIndex=O;this.baseItemIndex=da}function Pd(){}function ee(){}function xf(n,O,da,l){return Se.call(this,
n,"PopulateFieldListPivotMenu",-1793121409,1378457149,O,da,l,"FieldListPivotFilterContextMenu")||this}function Se(n,O,da,l,K,ka,$a,Lb){n=gh.call(this,n,O,da,l,void 0===Lb?"PivotFilterContextMenu":Lb,!0,!1,"PivotFilterMenuRootName",K,ka,!1,$a)||this;n.V0b=null;n.y$e=null;n.ujb=null;n.pivotData=null;n.Qrd=null;n.thc=null;n.nZa=null;n.Yba=null;n.Rrd=n.uhc=-1;n.bpe=n.$Uc=-1;n.lhe=n.L1=0;n.Yv=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1);Se.DM||(Se.DM=new dh(n.$),te.g(n.$).Ha.Dq(Object(Kc.a)(n,
n.Le,"onBlockCacheItemChanged")),te.g(n.$).Ha.XF(Object(Kc.a)(n,n.jm,"onBlockCacheItemEvicted")),te.g(n.$).Ha.nqa(Object(Kc.a)(n,n.Le,"onBlockCacheItemChanged")));return n}function cf(){this.cell=null;this.dataSourceIndex=0;this.to=this.pivotName=null}function dh(n){this.$=n;this.DM={}}function df(n,O,da,l){n=qf.call(this,n,"PopulateFieldListContextMenu",-1045020714,-170383950,"FieldListContextMenu",!0,!1,"FieldListContextMenu",O,da,!1,l)||this;n.kl=null;n.NK=null;n.sE=!1;n.uE=!1;n.isOlap=!1;n.JMd=
!1;return n}function Uf(n,O,da,l){n=bf.call(this,n,O,da,l,"PopulateChartContextMenu",-498523270,1640762262,"ChartContextMenu")||this;n.gza=!1;n.Bua=!1;n.IY=!1;n.refresh=!1;n.isPivotChart=!1;return n}function bf(n,O,da,l,K,ka,$a,Lb,bc,Dc){Lb=void 0===Lb?ub.a.VPg:Lb;n=Vb.call(this,n,void 0===K?"PopulateFloatingObjectContextMenu":K,void 0===ka?-2017893763:ka,void 0===$a?1350204367:$a,Lb,void 0===bc?!0:bc,void 0===Dc?!1:Dc,Lb,O,da,!0,l)||this;n.floatingObject=null;n.Cb=0;n.dgc=!0;return n}function If(n,
O,da,l){n=og.call(this,n,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,If.Dkh,!0,!1,If.uFb,O,da,!1,l)||this;n.fm=null;return n}function vf(){}function Dg(){}function Pf(n,O){n=gg.call(this,n,2,0,null)||this;n.wke=O;return n}function gg(n,O,da,l){this.bgg=n;this.Nag=O;this.Rag=da;this.Akg=l}function Sb(){}function Hc(n,O,da,l){n=Me.call(this,n,"PopulateAutoFilterContextMenu",1675506831,1651433993,"AutoFilterContextMenu",!0,!1,"AutoFilterContextMenuRoot",O,da,!1,l)||this;n.nZa=null;n.sheetName=
null;n.tbb=null;n.OQc=null;n.Bbf=!1;n.T_a=!1;n.Uwd=null;n.vIb=null;n.w4c=null;n.A8b=null;n.kNa=null;n.Twe=null;n.y7a=null;n.c_c=null;n.Aja=rb.a.c3e();n.Yv=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1);return n}function ed(){this.top=this.left=0}function Id(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function hf(){this.autoFilterMenu=this.targetPoint=
null}function Hf(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Cg(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function uf(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function ih(){this.isSuccess=!1}function qa(){this.Icon=this.IconSet=0}function tb(){this.Title=this.MenuItems=this.Id=null;
this.DisplayType=0}function rc(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function kd(){this.Sections=this.Id=null}function Td(){}function qe(n,O,da,l){var K=this;this.tVd=this.C0=this.Oi=this.oD=this.t7=null;this.XSb=n;this.Gjg=l;this.XSb.hKa&&(this.Oi=new We.a(3,2,5E3,Object(Kc.a)(this,this.cAg,"authenticationCheckTask"),2),Ee.AFrameworkApplication.$j.sh(this.Oi),this.Rg(O,
da));this.XSb.lkb(function(){K.Pjf()});this.XSb.gWa(function(){K.Qjf()})}function Ne(){}function Ja(n){return ab.call(this,n)||this}function ob(n,O,da){var l=aa.call(this)||this;l.$=n;l.tableManager=O;l.Fi=da;return l}function Nb(n,O){this.command=0;this.selectedRanges=null;this.command=n;this.selectedRanges=O}function Jc(n){return Hg.call(this,n)||this}function bd(n){var O=ki.call(this)||this;O.$=n;return O}function Yc(n,O){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=n;this.type=
O}function Db(n,O,da,l,K,ka){if(O){var $a=n.textBox;n.isEditing||n.startEdit(O,!0);n.kjd=!0;n.text=da;$a.caretPosition=K;K<ka&&(l&&n.oza(),$a.selectRange(0,ka+1),$a.selectRange(K,ka))}}function mc(n,O,da,l,K,ka,$a,Lb,bc,Dc){Dc=n.Ra(9,Dc);Dc.selectedRange=O;Dc.activeCell=da;Dc.autoSumType=l;Dc.topLeftCell=K;return nf.i(n,"AutoSum",Dc,ka,$a,Lb,bc,0)}b.r(F);var le=b(514),hd=b(0),of=b(800),Rc=b(15),Kc=b(37),yg=b(187),nf=b(81),Kg=b(79);Yc.prototype.y1a=function(){return this.sharedSheetRange};Object(hd.a)(Yc,
"MacroRecorderAutoSumPayload",null,[115]);var jg=b(46),zg=b(519),hg=b(365),bh=b(160),Nf=b(58),fe=b(35),ch=b(148),Wg=b(335),qd=b(27),fd=b(1),kh=b(172),Lf=b(273),te=b(20),Wd=b(155),mh=b(593),ug=b(52),ki=yg.a;Cm(bd,ki);bd.prototype.$c=function(){return!1};bd.prototype.executeCommand=function(n,O,da){n=O.command;switch(n){case 1220954656:O=this.hAe(0,O);break;case -1537138325:O=this.hAe(parseInt(da[Kg.a.Vd].toString()),O);break;default:O=kh.a(n)}return O};bd.prototype.Jc=function(n,O){if(n=1===n)switch(O.command){case 1220954656:case -1537138325:break;
default:n=!1}return n};bd.prototype.gd=function(){return!1};bd.prototype.hAe=function(n,O){function da(){return new Yc($a,n)}var l=this,K=te.g(this.$);K.Vi.fG(!1);if(!te.g(this.$).ga.ya.Eh)return Rc.ULS.sendTraceTag(590173017,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",n,te.g(this.$).ga.ya.gw),this.Fxa(),ug.Task.Ua(!1);var ka=K.wJ();if(!ka)return null;var $a=jg.v(K.ga.ya.Xd,this.$),Lb=jg.o(K.ga.ya.activeCell,
this.$),bc=jg.o(ka,this.$),Dc=this.$.ra.xa.dc();return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5691267_AllowAutoSumOnProtectedSheet")&&!this.$.qt(K.ga.ya.selectedRanges,!0)?ug.Task.Ua(!1):fd.EwaSettings.wc()?hg.a(this.$.userOperationManager,function(wd,ke,jf){return mc(l.$.ra.xa,$a,Lb,n,bc,Lf.b(wd,Object(Kc.a)(l,l.Tjf,"onAutoSumSuccessCallback")),ke,jf,n,Dc)},function(wd){return new bh.a(502,0,wd,64,da)},O):hg.a(this.$.userOperationManager,function(wd,ke,jf){return mc(l.$.ra.xa,$a,Lb,n,bc,Lf.b(wd,
Object(Kc.a)(l,l.Tjf,"onAutoSumSuccessCallback")),ke,jf,n,Dc)},function(wd){return new zg.a(502,0,wd,void 0,da)},O)};bd.prototype.Tjf=function(n){var O=te.g(this.$);if(n=n.Result){var da=jg.D(n.NewSelection),l=jg.D(n.NewActiveCell);if(da&&l)if(!n.Committed&&n.AutoSumFormula){var K=O.Cc(l);K&&(O.ga.updateSelection(da,l,60),da=l=jg.D(n.MarkedArea),O.fC=2,Db(O.zc,K,n.AutoSumFormula,!!da,n.FormulaMarkStart,n.FormulaMarkEnd),da&&l&&O.ga.updateSelection(da,l,0),O.zc.kjd=!1,fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.create(this.$.ea,
153,this.ma,0,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager"),function(ka){ka.result.$pb(null)},this.ma,3))}else O.ga.updateSelection(da,l,60)}};bd.prototype.Fxa=function(){fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")&&mh.a(Wd.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var n=qd.a.Ad(1,1,721,2091,0,371863010,"DiscontinuousSelectionBlocking");fd.EwaSettings.rC()?new Wg.a(this.$,n):(n=new ch.ErrorDialog(this.$,
n),n.initialize(),n.Bf())};Object(hd.a)(bd,"AutoSumCommandHandler",yg.a,[159]);var Hg=of.a;Cm(Jc,Hg);Jc.prototype.Rd=function(){this.Hd([new bd(this.$)])};Jc.la=function(n){of.a.ie(96,new Jc(n))};Object(hd.a)(Jc,"AutoSumCommandHandlerFactory",of.a,[]);var Mg=b(12),Eh=b(194),Gh=b(371),qi=b(36),Bh=b(316);Nb.prototype.As=function(){return this.command};Object(hd.a)(Nb,"MacroRecorderRangeOperationAppliedPayload",null,[115]);var Cf=b(303),Yh=b(70),aa=qi.a;Cm(ob,aa);ob.prototype.xrg=function(n){this.addHandler("ekcvc",
n)};ob.prototype.bTi=function(n){this.removeHandler("ekcvc",n)};ob.prototype.$c=function(){return!1};ob.prototype.executeCommand=function(n,O){n=O.command;switch(n){case -730106152:O=this.Rbd(O,3);break;case -1228228458:O=this.Rbd(O,4);break;case -848953656:case 2045211913:if(this.s4h()){O=ug.Task.Ua(!0);break}O=this.Rbd(O,1);break;default:O=kh.a(n)}return O};ob.prototype.Jc=function(n,O){if(n=1===n)switch(O.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:n=
!1}return n};ob.prototype.gd=function(){return!1};ob.prototype.npi=function(n,O){if(!Cf.a(n)&&O){var da=!!n&&!!n.RequestTelemetryData;te.g(this.$).Ui.fka(O.toString(),n.StateId,da?n.RequestTelemetryData.EcsOperationDuration:0,da?n.RequestTelemetryData.EcsRequestDuration:0,da?n.RequestTelemetryData.WfeRequestDuration:0)}};ob.prototype.Rbd=function(n,O){function da(){return new Nb(O,Dc)}function l(ke,jf,Xf){K.$.Ss();return nf.f(K.$.ra.xa,O,Dc,!1,Lf.b(ke,Object(Kc.a)(K,K.npi,"onClearCellFormatOperationWebMethodSuccess")),
jf,Xf,bc,wd)}var K=this,ka=te.g(this.$),$a=ka.ga.ya.selectedRanges,Lb=n.command,bc=Eh.a.create().toString();if(!this.$.qt($a,!0)&&-730106152!==Lb)return ug.Task.Ua(!0);var Dc=jg.r($a,this.$);this.pgj(Lb,ka,$a,bc);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.eLi();var wd=this.$.ra.xa.dc(!0);return fd.EwaSettings.wc()?hg.a(this.$.userOperationManager,l,function(ke){return new bh.a(508,0,ke,67,da)},n):hg.a(this.$.userOperationManager,l,function(ke){return new zg.a(508,
0,ke,3,da)},n)};ob.prototype.pgj=function(n,O,da,l){var K=this;if(-848953656!==n&&2045211913!==n&&-730106152!==n&&-1228228458!==n)Rc.ULS.sendTraceTag(575447498,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",n);else if(!Gh.a.any(da,function($a){return 0<O.getRangeInformation($a).length})){var ka=Gh.a.any(da,function($a){return K.tableManager.skd($a)});if(-730106152!==n&&-1228228458!==n||!ka)this.tkj(O,n,l,da),-730106152!==n&&-1228228458!==n||this.Fi.wma(O,-730106152,{}),
-1228228458!==n&&2045211913!==n&&-848953656!==n||this.Fi.zLg(da,l),O.Ui.S_(l,Yh.BasicTelemetryCalculator.bQ)}};ob.prototype.tkj=function(n,O,da,l){var K="";switch(O){case -1228228458:K="ClearAll";break;case 2045211913:case -848953656:K="ClearContent";break;case -730106152:K="ClearFormat";break;default:Rc.ULS.sendTraceTag(573933196,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",O)}O=l.length;l=jg.b(l);n.Ui.Xca(15,da,K+(", ranges to clear: "+O+", cells to clear: "+
l))};ob.prototype.eLi=function(){this.raiseEvent("ekcvc",new Bh.a)};ob.prototype.s4h=function(){if(te.g(this.$).Oy){var n=this.$.ea.Ea(296,void 0);return!!n&&n.RT.tA}return!1};Object(hd.a)(ob,"ClearCommandHandler",qi.a,[159,370]);var ab=of.a;Cm(Ja,ab);Ja.prototype.Rd=function(){var n=this,O=Nf.GetServiceTaskFactory.create(this.$.ea,134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),da=Nf.GetServiceTaskFactory.create(this.$.ea,18,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction");
fe.TaskExtensions.Da(fe.TaskExtensions.Fe([O,da],this.ma),function(){var l=new ob(n.$,O.result,da.result);n.Hd([l]);n.$.ea.La(313,l)},this.ma,3)};Ja.la=function(n){of.a.ie(101,new Ja(n))};Object(hd.a)(Ja,"ClearCommandHandlerFactory",of.a,[]);var Rb=b(896),Cc=b(876),Bc=b(846),Dd=b(1130);Ne.prototype.GWg=function(n,O){if(n&&!(1>n.length)&&O){var da=Object.assign(new Bc.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.aUg(n,da.ControlList);O.push(da)}};Ne.prototype.aUg=function(n,O){var da=Object.assign(new Rb.a,
{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Cc.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(O,da);O=Object.assign(new Bc.a,{Title:"",ControlList:[]});Array.add(da.Menu.MenuSectionList,O);this.mWg(n,O.ControlList)};Ne.prototype.mWg=function(n,O){for(var da=0;da<n.length;da++){var l=Object.assign(new Dd.a,{ExternalId:String.format("CoauthorPersona_{0}",da),Command:"336231556",DisplayName:n[da].userName,
LabelText:n[da].userName,ImageBackColor:n[da].color,PersonaId:n[da].email,IsAnonymous:n[da].isAnonymous});Array.add(O,l)}};Object(hd.a)(Ne,"PresenceContextMenuSectionBuilder",null,[373]);var Ee=b(5),we=b(185),Be=b(578),We=b(112),bg=b(128),Ff=b(86),Ng=b(88),Sg=b(111),vg=b(29);qe.prototype.Rg=function(n,O){var da=Ee.AFrameworkApplication.Hb;da.Jf(vg.a.authenticationLost,Sg.a.frame,n,96);da.Jf(vg.a.rke,Sg.a.frame,O,96);da.$b(vg.a.eoe,Sg.a.frame,we.ActionManager.m1c);da.$b(vg.a.foe,Sg.a.frame,we.ActionManager.m1c);
da.$b(vg.a.nmd,Sg.a.frame,we.ActionManager.m1c)};qe.prototype.Pjf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Ee.AFrameworkApplication.Hb.processAction(vg.a.authenticationLost,2)};qe.prototype.Qjf=function(){this.goj();Ee.AFrameworkApplication.Hb.processAction(vg.a.rke,2)};qe.prototype.cAg=function(){this.XSb.authenticationCheck()};qe.prototype.goj=function(){this.oD&&(this.oD.hide(),this.oD.dispose(),this.oD=null);this.t7&&this.businessBar&&(Ee.AFrameworkApplication.Ng||
this.businessBar.removeEntry(this.t7),this.t7.dispose(),this.t7=null)};qe.prototype.showDialog=function(n){Ff.a.Ia(this.oD);this.oD=new bg.StandardDialog;this.Gjg||(this.oD.Fu=!1,this.oD.lc=0);this.oD.Dc(1,CommonUIStrings.l_SignIn);this.oD.qW(CommonUIStrings.l_DefaultDialogTitle,n,Object(Kc.a)(this,this.Mv,"dialogHandler"))};qe.prototype.Mv=function(n){1===n?(Be.a.E5(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),Ee.AFrameworkApplication.Hb.processAction(vg.a.nmd,2)):
(this.aKd(),Ee.AFrameworkApplication.Hb.processAction(vg.a.foe,2))};qe.prototype.aKd=function(){this.businessBar&&this.vme&&(this.t7=this.vme.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.t7.closeable=!0,this.t7.addButton(CommonUIStrings.l_SignIn,qe.sFg,""),this.t7.r9=Object(Kc.a)(this,this.uFg,"businessBarEntryCloseHandler"),this.businessBar.CI(this.t7,!1))};qe.prototype.uFg=function(){this.e3g();Ee.AFrameworkApplication.Hb.processAction(vg.a.eoe,
2)};qe.prototype.e3g=function(){this.Oi&&(Ee.AFrameworkApplication.$j.xp(this.Oi),this.Oi=null)};qe.prototype.dispose=function(){this.Oi=this.oD=this.t7=null};qe.sFg=function(){Be.a.E5();Ee.AFrameworkApplication.Hb.processAction(vg.a.nmd,2)};Jl.Object.defineProperties(qe.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.C0||(this.C0=Ng.a.instance.Uh("CommonUI.IBusinessBar"))}},vme:{configurable:!0,enumerable:!0,get:function(){return this.tVd||(this.tVd=Ng.a.instance.Uh("CommonUI.IBusinessBarEntryFactory"))}}});
Object(hd.a)(qe,"SignOutResponseUI",null,[7]);var vh=b(274);Td.prototype.$h=function(n){n.register(Ne,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ac()};Td.prototype.init=function(){};Td.prototype.dispose=function(){Ff.a.Ia(Td.g1);Td.g1=null};Td.main=function(){vh.a.instance.oj(new Td)};Jl.Object.defineProperties(Td.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Td.g1=null;Object(hd.a)(Td,"CommonAppUIPackage",
null,[8,9]);var Ag=b(143),Aa=b(210),pa=b(824),ub=b(4),xd=b(462),oe=b(585),sf=b(55),ef=b(1167),fh=b(110),jh=b(859),oh=b(141),Ph=b(127),Zg=b(195),ig=b(92),Sh=b(68),Ch=b(32),mf=b(7),Sd=b(16),Gf=b(62),Wf=b(108),f=b(258),rb=b(910),oc=b(911),cd=b(133),$d=b(50),ze=b(34),He=b(411);Object(hd.a)(kd,"AutoFilterMenu",null,[]);Object(hd.a)(rc,"MenuItem",null,[]);Object(hd.a)(tb,"MenuSection",null,[]);Object(hd.a)(qa,"SharedFormattingIconInfo",null,[]);Object(hd.a)(ih,"ApplyFilterByValueResponse",null,[]);Object(hd.a)(uf,
"FilterByValueItem",null,[]);Object(hd.a)(Cg,"GetColorsAndIconsResponse",null,[]);Object(hd.a)(Hf,"GetFilterByValueItemsResponse",null,[]);Object(hd.a)(hf,"ShowSortFilterMenuParams",null,[]);Object(hd.a)(Id,"SortFilterControllerFactoryParams",null,[]);Object(hd.a)(ed,"TargetPoint",null,[]);var Ie=b(333),Me=pa.a;Cm(Hc,Me);Hc.prototype.executeCommand=function(n,O,da){var l=this;n=O.command;switch(n){case 1701016594:pa.a.Sih(da);break;case 966232027:var K=da.domEvent;if(Sh.e(K.rawEvent)&&Sh.e(K.rawEvent)&&
(Sh.g(K),K.target&&(n=new oh.a(this.$.Aa),n.Ke(4096)||n.Ke(2048)))){var ka=sf.a.gi(da[Kg.a.Mj]);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.Bbf?(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680883_trackInteractivityFilterMenuOnlySync")&&f.a(this.$).Vma(K.rawEvent,"open_menu_auto_filter"),this.Anc(K,K.target,ka,O)):(this.Uwd=function(){l.vWh();l.Anc(K,K.target,ka,O);l.T_a=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1);
l.Bbf=!0},this.Tsc()):this.AN(K,K.target,ka,O,!0)}break;default:return kh.a(n)}return ug.Task.Ua(!0)};Hc.prototype.Jc=function(n,O,da){if(n=!!da)switch(O.command){case 1701016594:case 966232027:xd.a(this.$)||(n=!1,Rc.ULS.sendTraceTag(575956299,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",$d.b().ji(O.command)));break;default:n=!1}return n};Hc.prototype.AN=function(n,O,da){Rc.ULS.shipAssertTag(51519703,0,!!da,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");
this.nZa=this.$th(da);this.Yv&&!da.IsHeaderSnapped?this.Ln(pa.a.o7b(this.$,da.Cell,!0),!0):Me.prototype.AN.call(this,n,O,da,null,!0)};Hc.prototype.Cwd=function(n){Array.addRange(n.MenuSectionList,this.nZa)};Hc.prototype.vWh=function(){var n=this;He.a(function(){n.vIb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Id,{getFilterByValueItemsRequest:Object(Kc.a)(n,n.Ksi,"onGetFilterByValueItems"),applyFilterByValueRequest:Object(Kc.a)(n,n.Zni,"onApplyFilterByValue"),
onMenuItemClick:Object(Kc.a)(n,n.onMenuItemClick,"onMenuItemClick"),autoFilterMenuWidth:Hc.vke,applySortByColorOrIconRequest:Object(Kc.a)(n,n.Zxg,"applySortByColorOrIcon")}))});this.w4c=Ng.a.instance.Uh("Common.IExternalUICommandDefinitionMapping")||new oe.a(this.$.Mb,this.$)};Hc.prototype.Anc=function(n,O,da){Wf.b(this.$).Jd(fh.a.Anc,this.Dn(),void 0,!0);fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",!1)&&this.Wvh(da.Cell);Rc.ULS.shipAssertTag(578081474,0,!!da,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");
n=this.Zth(da);var l=Sys.UI.DomElement.getBounds(O),K=l.x+l.width;l=l.y;this.Yv&&!da.IsHeaderSnapped&&(da=pa.a.o7b(this.$,da.Cell,!0),K=da.x,l=da.y);da=te.g(this.$).rtl?new Sys.UI.Point(K-ze.a(this.$).pEa(Hc.vke),l):new Sys.UI.Point(K,l);this.vRa(da,O);da=ze.a(this.$).NIa(da);O=Object.assign(new hf,{targetPoint:Object.assign(new ed,{left:da.x,top:da.y}),autoFilterMenu:n});this.vIb.showSortFilterMenu(O);this.$.Re(-544117314,-1,0,null)};Hc.prototype.Zth=function(n){return(n=this.bOe(n))?this.Yyf(n):
null};Hc.prototype.Yyf=function(n){for(var O=[],da=Ml(n.Sections),l=da.next();!l.done;l=da.next())l=this.bJi(l.value),Array.add(O,l);return Object.assign(new kd,{Id:n.Id,Sections:O})};Hc.prototype.bJi=function(n){for(var O=[],da=Ml(n.MenuItems),l=da.next();!l.done;l=da.next())if(l=l.value,2===l.Identifier)this.OQc=l.CommandData;else switch(l.Type){case 3:case 2:Array.add(O,this.$Ii(l,2===l.Type));break;case 1:Array.add(O,this.aJi(l))}return Object.assign(new tb,{MenuItems:O,DisplayType:n.DisplayType,
Id:this.xrh(n)})};Hc.prototype.aJi=function(n){var O=this.hNe(n);var da=O.label;var l=O.KJa;O=this.Yyf(n.SubMenu);var K=this.WMe(n);l=this.w4c.J7b(l);da=da||n.Label;return Object.assign(new rc,{Disabled:n.Disabled,Type:n.Type,Identifier:n.Identifier,Id:K,CommandData:n.CommandData,Label:da,SubMenu:O,IsChecked:n.IsChecked,IconName:"MissingIcon_20"===l?null:l})};Hc.prototype.$Ii=function(n,O){var da=this.z6b(n,O&&n.IsChecked);O=da.label;var l=da.KJa;da=da.Yo;var K=this.z7c(n,O);l=this.w4c.J7b(l);return Object.assign(new rc,
{Disabled:n.Disabled,Type:n.Type,Identifier:n.Identifier,Id:K,RibbonCommand:da,CommandData:n.CommandData,Label:O||n.Label,SubMenu:null,IsChecked:n.IsChecked,IconName:"MissingIcon_20"===l?null:l})};Hc.prototype.bOe=function(n){var O;this.tbb=O=jg.C(n.Cell);this.sheetName=this.$.sa.sheetName;if(n.IsHeaderSnapped)O=xd.a(this.$).k5b.SAh(O);else{var da=te.g(this.$).Ha.p8b(O);if(!da)return this.Aja?rb.a.pca(oc.a.w8a,Wd.a.jMh,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag(51663842,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",
O,te.g(this.$).view.visibleArea),null;O=da.autoFilterMenu}if(!O)return this.Aja?rb.a.pca(oc.a.w8a,Wd.a.shi,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag(51519704,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.opb=n.Cell.FirstRow+"_"+n.Cell.FirstColumn;return O};Hc.prototype.$th=function(n){return(n=this.bOe(n))?this.wpd(n.Sections):null};Hc.prototype.Tsc=function(){var n=this;if(this.$.fa.fi){var O=Nf.GetServiceTaskFactory.Xa(this.$.ea,
283,284,1,"Common.IDynamicScriptLoaderProvider");fe.TaskExtensions.Da(O,function(){n.Aja?O.result.xq.loadScript("sortFilter").then(function(){n.Uwd()},function(da){Gf.a.om(da,"AutoFilterContextMenu.SortFilterScriptLoad");rb.a.pca(oc.a.Tsc,Wd.a.wjj,cd.a.e9,!1,!1)}):fe.TaskExtensions.Da(Ie.c(O.result.xq.loadScript("sortFilter")),function(){n.Uwd()},n.$.ma,3)},this.$.ma,3)}else this.$.fa.Do(Object(Kc.a)(this,this.JM,"onAppInteractive"))};Hc.prototype.JM=function(){this.Tsc();this.$.fa.Sr(Object(Kc.a)(this,
this.JM,"onAppInteractive"))};Hc.prototype.Ksi=function(n){function O(Dc,wd,ke){da.c_c=nf.t(da.$.ra.xa,l,Lf.b(Dc,$a),da.T_a?Lf.a(wd,Lb):wd,ke,null,bc);return da.c_c}var da=this;this.T_a||Wf.b(this.$).Jd(fh.a.pnf,this.Dn(),void 0,!0);var l=sf.a.gi(this.OQc);l.SheetName=this.sheetName;l.NamedObjectView=this.$.fa.isNamedObjectViewMode;var K=!mf.a.na(n.searchText),ka=586;this.T_a&&(K&&(l.ItemListOptions=this.uSg(n.searchText),ka=597),n={},Wf.b(this.$).Jd(fh.a.pnf,(n.UserOperation=ka.toString(),n),void 0,
!0));var $a=this.ntd(K),Lb=this.Lsi(),bc=this.$.ra.xa.dc();this.Twe=bc.RequestId;this.T_a&&this.A8b&&!this.A8b.dequeueUtcTime&&(this.$.userOperationManager.FZa(this.A8b),this.WHg());K=fd.EwaSettings.wc()?new bh.a(ka,0,O,80):new zg.a(ka,0,O,16);this.A8b=this.$.userOperationManager.oc(K,null);this.y7a=this.c_c;this.kNa=this.Twe};Hc.prototype.uSg=function(n){var O={};O.SearchText=n;O.Page=1;O.DateNodeType=-1;return O};Hc.prototype.WHg=function(){this.kNa&&(Rc.ULS.sendTraceTag(545300504,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",
this.kNa),nf.j(this.$.ra.xa,this.kNa,null,null,null),this.kNa=null);this.y7a&&(Ee.AFrameworkApplication.Md.gv(this.y7a.ou),this.y7a=null)};Hc.prototype.onMenuItemClick=function(n,O,da){Wf.b(this.$).Jd(fh.a.uxi,this.Dn(),void 0,!0);var l={};O=(l.CommandValueId=O,l.MenuItemId=O,l.InputMethod=da,l.TopCellAddress=this.tbb,l);l=new ig.a(n,da,this.$.isEditMode?2:1,19,null);this.$.Na.Xb(l,O);Rc.ULS.sendTraceTag(578081472,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",n,da)};Hc.prototype.Zni=function(n){var O=
this;if(n.checkedItems&&n.checkedItems.length){Wf.b(this.$).Jd(fh.a.$ni,this.Dn(),void 0,!0);var da=sf.a.gi(this.OQc),l={};this.$.gk(l);l.FirstRow=0;l.FirstColumn=da.Column;var K=this.$.fa.isNamedObjectViewMode;da.NamedObjectView=K;da.SheetName=K?l.NamedObjectName:l.SheetName;var ka=function(bc){if(rb.a.DJd(bc)){var Dc=rb.a.$7c(bc);O.Aja?rb.a.pca(oc.a.applyItemFilter,Dc.MessageIdName,cd.a.JEa,!0,rb.a.isSessionEndingError(Dc.MessageId)):Rc.ULS.sendTraceTag(558179912,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",
Dc.MessageIdName)}Cf.a(bc)||(Rc.ULS.sendTraceTag(578081441,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),Wf.b(O.$).Jd(fh.a.msi,O.Dn(),void 0,!0),bc=Object.assign(new ih,{isSuccess:!0}),O.vIb.onApplyFilterByValueFinish(bc),O.uR(O.tbb))},$a=this.vSg(da,l),Lb=new bh.a(208,0,function(bc,Dc,wd){return nf.a(O.$.ra.xa,$a,n.checkedItems,Lf.b(bc,ka),Dc,wd,null,null)},6,function(){return new ef.a(n.checkedItems,$a)});fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,309,
310,3,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic"),function(bc){bc.result.bQa().continueWith(function(Dc){Dc.result&&O.$.userOperationManager.oc(Lb,null)})},this.$.ma,3)}else Rc.ULS.sendTraceTag(578081443,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Hc.prototype.ntd=function(n){var O=this;return function(da){O.kNa=null;O.y7a=null;if(rb.a.DJd(da)){var l=rb.a.$7c(da);O.Aja?rb.a.pca(n?oc.a.searchAutoFilterItemList:
oc.a.getAutoFilterItemList,l.MessageIdName,cd.a.e9,!0,!0):Rc.ULS.sendTraceTag(558179911,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",l.MessageIdName)}if(!Cf.a(da)){Rc.ULS.sendTraceTag(558179910,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");da=da.Result;l=new Ch.a(!0);var K=da.AutoFilterDateNodes?!0:!1;da.AutoFilterItems&&l.add("AutoFilterItemsCount",da.AutoFilterItems.length);K&&l.add("AutoFilterDateItemsCount",
da.AutoFilterDateNodes.length);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")&&l.add("Location","contextMenu");Wf.b(O.$).Jd(fh.a.ntd,l.Lu,void 0,!0);da=O.T_a?Object.assign(new Hf,{filterByValueItems:O.yte(da),hasMoreRecords:da.ItemListMaxExceeded,searchText:da.SearchText}):Object.assign(new Hf,{filterByValueItems:O.yte(da),hasMoreRecords:da.ItemListMaxExceeded});O.vIb.onGetFilterByValueItemsFinish(da)}}};Hc.prototype.Lsi=function(){var n=this;return function(O){n.kNa=
null;n.y7a=null;O=Ph.a.Eg(O.data);Rc.ULS.sendTraceTag(545300503,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",qd.a.fd(O))}};Hc.prototype.yte=function(n){var O=this.nQg(n),da=this.tQg(n.AutoFilterItems),l=[],K=0;n.HasBlanks&&(n=Hc.VYc(Sd.a.instance.da(748),n.IsBlanksSelected?1:0,ub.a.uke),l[K++]=n);O=Ml(O);for(n=O.next();!n.done;n=O.next())n=n.value,l[K++]=n;da=Ml(da);for(n=da.next();!n.done;n=da.next())O=n.value,l[K++]=O;return l};Hc.prototype.nQg=function(n){var O=
[];if(!n.AutoFilterDateNodes||!n.AutoFilterDateNodes.length)return O;for(var da=[this.e1a(n.YearKeys,n.YearValues),this.e1a(n.MonthKeys,n.MonthValues),this.e1a(n.DayKeys,n.DayValues),this.e1a(n.HourKeys,n.HourValues),this.e1a(n.MinuteKeys,n.MinuteValues),this.e1a(n.SecondKeys,n.SecondValues)],l=!1,K=!1,ka=0,$a=null,Lb=Array(6),bc=null,Dc=Ml(n.AutoFilterDateNodes),wd=Dc.next();!wd.done;wd=Dc.next()){wd=wd.value;Lb[0]&&(bc.Year!==wd.Year?(l=!0,ka=0,$a=null):bc.Month!==wd.Month?(K=!0,ka=1,$a=Lb[0]):
bc.Day!==wd.Day?(ka=2,$a=Lb[1]):n.ShowTime&&(bc.Hour!==wd.Hour?(ka=3,$a=Lb[2]):bc.Minute!==wd.Minute?(ka=4,$a=Lb[3]):(ka=5,$a=Lb[4])));for(;6>ka;){switch(ka){case 0:var ke=wd.Year;bc=da[0].getItem(ke.toString());break;case 1:ke=wd.Month;bc=da[1].getItem(ke.toString());break;case 2:ke=wd.Day;bc=da[2].getItem(ke.toString());break;case 3:ke=wd.Hour;bc=da[3].getItem(ke.toString());break;case 4:ke=wd.Minute;bc=da[4].getItem(ke.toString());break;case 5:ke=wd.Second;bc=da[5].getItem(ke.toString());break;
default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}bc=Hc.VYc(bc,-1!==wd.NodeType&&ka>=wd.NodeType?1:0,$a?$a.key+";"+ke:ub.a.PRc+ke,!1,[]);$a=$a?$a.children:O;$a=$a[$a.length]=bc;Lb[ka]=bc;switch(ka){case 5:ka=6;break;case 2:ka=n.ShowTime?ka+1:6;break;default:ka++}}bc=wd}l||(Lb[0].expanded=!0,K||(Lb[1].expanded=!0));return O};Hc.prototype.tQg=function(n){var O=[];if(!n)return O;var da=0;n=Ml(n);for(var l=n.next();!l.done;l=n.next())l=l.value,O[da++]=Hc.VYc(l.DisplayString,l.Selected?
1:0,ub.a.QRc+l.DisplayString);return O};Hc.prototype.e1a=function(n,O){var da=new Ch.a(!0);if(!n||!O)return da;for(var l=n.length<O.length?n.length:O.length,K=0;K<l;K++)da.add(n[K].toString(),O[K]);return da};Hc.prototype.vSg=function(n,O){var da={};da.Location=O;da.FieldId=n.Id.toString();da.DataSourceIndex=-1;da.FilterType=n.AutoFilterType;da.AnchorType=0;da.ChartId=null;da.AnchorValue1=-1;da.AnchorValue2=-1;da.Property=n.RichProperty;return da};Hc.prototype.uR=function(n){fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",
!1)&&fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),function(O){O.result.gRa(n);Rc.ULS.sendTraceTag(541131089,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ma,3)};Hc.prototype.Dn=function(){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var n={};return n.Location="contextMenu",n}return{}};
Hc.prototype.a8c=function(n){var O=this.$.ea.Ea(66,void 0).fo(jg.C(n));O||(O=this.$.Aa.getItemByName(this.$.sa.sheetName).$ya);Rc.ULS.shipAssertTag(539084800,0,!!O&&O.contains(jg.C(n)),"AutoFilterContextMenu.GetAutoFilterRange: The AutoFilterRange wasn't found or didn't contain the top cell, range: {0}",O);return jg.m(O,this.$.sa)};Hc.prototype.getColorName=function(n){return jh.a.HIa(Zg.a.wG(n))};Hc.prototype.Wvh=function(n){var O=this,da=this.a8c(n);da.FirstColumn=da.LastColumn=n.FirstColumn;da.FirstRow=
n.FirstRow+1;var l=Object.assign(new Cg,{getColorName:Object(Kc.a)(this,this.getColorName,"getColorName")}),K=new Aa.a;K.add(this.jGd(1,da,l));K.add(this.jGd(2,da,l));K.add(this.jGd(3,da,l));K.add(this.l4i(n,l));var ka=this.$.Zb.yi("UserAction","GetColorsAndIconsRequest stopwatch");ka.start();ug.Task.WAE(K).continueWith(function(){ka.stop();Rc.ULS.sendTraceTag(539084771,0,50,"AutoFilterContextMenu.GetColorsAndIconsRequest: The request took {0} ms",ka.Gc);O.vIb.onGetColorsAndIconsFinish(l)})};Hc.prototype.jGd=
function(n,O,da){var l={SortTopToBottom:!0};l.ConditionType=n;l.Range=O;return nf.F(this.$.ra.xa,l,this.B7c(n,da),this.Frh(),null,0)};Hc.prototype.B7c=function(n,O){var da=this;return function(l){if(!l||Cf.a(l))da.Aja?rb.a.pca(oc.a.w8a,Wd.a.h7b,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag.apply(null,[539084770,0,10,"AutoFilterContextMenu.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}"].concat(l.Errors));else switch(l=l.Result,n){case 1:O.cellColors=l.ColumnInfo.CellColors;break;
case 2:O.fontColors=l.ColumnInfo.TextColors;break;case 3:O.icons=l.ColumnInfo.Icons}}};Hc.prototype.Frh=function(){var n=this;return function(){n.Aja?rb.a.pca(oc.a.w8a,Wd.a.h7b,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag(539084769,0,10,"AutoFilterContextMenu.GenerateOnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed")}};Hc.prototype.Zxg=function(n){var O=jg.o(this.tbb,this.$),da=this.a8c(O),l={};l.SortConditionType=n.type;l.RowColOffset=O.FirstColumn-da.FirstColumn;
l.SortColor=n.color;l.SortIconSet=n.icon.IconSet;l.SortIcon=n.icon.Icon;l.IsAscending=!0;O={SortOptions:{OperationType:1,ActiveCell:O,SelectedRange:da,SortConditions:[l],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1},SelectedRange:da,OriginalActiveCell:O,ShouldRestoreSelection:!1};Rc.ULS.sendTraceTag(537764680,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",n.type);n={};this.$.Re(1659552324,Kg.a.Yb,19,(n.CustomSortCommandData=O,n))};Hc.prototype.l4i=function(n,
O){var da=this.a8c(n),l={SortInfoMode:0};l.ActiveCell=n;l.SelectedRange=da;return nf.G(this.$.ra.xa,l,this.Hrh(O,n.FirstColumn-da.FirstColumn),this.Grh(),null,null)};Hc.prototype.Hrh=function(n,O){var da=this;return function(l){!l||Cf.a(l)?da.Aja?rb.a.pca(oc.a.w8a,Wd.a.h7b,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag.apply(null,[537764679,0,10,"AutoFilterContextMenu.GenerateOnGetSortInfoRequestSuccess: Unexpected error: {0}"].concat(l.Errors)):(l=l.Result,l.SortConditions&&(da.POc(l.SortConditions,O,1,n),da.POc(l.SortConditions,
O,2,n),da.POc(l.SortConditions,O,3,n)))}};Hc.prototype.POc=function(n,O,da,l){n=Ml(n);for(var K=n.next();!K.done;K=n.next())if(K=K.value,K.RowColOffset===O&&K.SortConditionType===da)switch(da){case 1:l.selectedSortCellColor=K.SortColor;return;case 2:l.selectedSortFontColor=K.SortColor;return;case 3:O=new qa;O.IconSet=K.SortIconSet;O.Icon=K.SortIcon;l.selectedSortIcon=O;return}};Hc.prototype.Grh=function(){var n=this;return function(){n.Aja?rb.a.pca(oc.a.w8a,Wd.a.h7b,cd.a.e9,!0,!1):Rc.ULS.sendTraceTag(537764678,
0,10,"AutoFilterContextMenu.GenerateOnGetSortInfoRequestFailure: GetSortInfo request failed")}};Hc.VYc=function(n,O,da,l,K){n=void 0===n?null:n;O=void 0===O?0:O;da=void 0===da?null:da;l=void 0===l?!1:l;K=void 0===K?null:K;return Object.assign(new uf,{displayText:mf.a.na(n)?n:pa.a.Lq(n),state:O,key:da,parent:null,children:K,indentationLevel:0,expanded:l})};Jl.Object.defineProperties(Hc.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},RA:{configurable:!0,
enumerable:!0,get:function(){return ub.a.kBf}}});Hc.vke=268;Object(hd.a)(Hc,"AutoFilterContextMenu",pa.a,[]);var rg=b(833),pf=b(82),$g=b(67),Df=b(18);Sb.VJe=26;Sb.G5c=[217,218,0,96,0,92,91];Object(hd.a)(Sb,"Constants",null,[]);Jl.Object.defineProperties(gg.prototype,{k3h:{configurable:!0,enumerable:!0,get:function(){return 3===this.J0b}},B6h:{configurable:!0,enumerable:!0,get:function(){return 4===this.J0b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Akg}},Gff:{configurable:!0,
enumerable:!0,get:function(){return this.bgg}},J0b:{configurable:!0,enumerable:!0,get:function(){return this.Nag}},q_c:{configurable:!0,enumerable:!0,get:function(){return this.Rag}}});Object(hd.a)(gg,"FiltersMenuData",null,[]);Cm(Pf,gg);Object(hd.a)(Pf,"AutoFilterFiltersMenuData",gg,[]);Dg.woj=[new gg(97,2,0,null),new gg(98,2,1,null),new gg(0,3,0,null),new gg(169,2,2,null),new gg(171,2,4,null),new gg(0,3,0,null),new gg(173,2,6,null),new gg(174,2,7,null),new gg(0,3,0,null),new gg(105,0,0,null)];Dg.qmi=
[new gg(97,2,0,null),new gg(98,2,1,null),new gg(0,3,0,null),new gg(99,2,8,null),new gg(100,2,10,null),new gg(101,2,12,null),new gg(0,3,0,null),new gg(102,1,0,null),new Pf(103,1),new Pf(104,2),new gg(0,3,0,null),new gg(105,0,0,null)];Dg.k_g=[new gg(97,2,0,null),new gg(0,3,0,null),new gg(109,2,10,null),new gg(110,2,8,null),new gg(101,2,12,null),new gg(0,3,0,null),new Pf(107,8),new Pf(106,9),new Pf(108,10),new gg(0,3,0,null),new Pf(112,11),new Pf(111,12),new Pf(113,13),new gg(0,3,0,null),new Pf(114,
14),new Pf(115,15),new Pf(116,16),new gg(0,3,0,null),new Pf(117,17),new Pf(118,18),new Pf(119,19),new gg(0,3,0,null),new Pf(120,20),new Pf(121,21),new Pf(122,22),new gg(0,3,0,null),new Pf(123,23),new gg(124,2,12,[new Pf(125,24),new Pf(126,25),new Pf(127,26),new Pf(128,27),new gg(0,3,0,null),new Pf(129,28),new Pf(130,29),new Pf(131,30),new Pf(132,31),new Pf(133,32),new Pf(134,33),new Pf(135,34),new Pf(136,35),new Pf(137,36),new Pf(138,37),new Pf(139,38),new Pf(140,39)]),new gg(0,3,0,null),new gg(105,
0,0,null)];Object(hd.a)(Dg,"Constants",null,[]);vf.prototype.compare=function(n,O){return mf.a.compare(n,O,!0)};Object(hd.a)(vf,"IgnoreCaseComparer",null,[390]);var Vf=b(73),og=pa.a;Cm(If,og);If.prototype.executeCommand=function(n,O,da){n=O.command;switch(n){case -699941697:this.applyAutoFilterFieldList(O,da);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return kh.a(n)}return ug.Task.Ua(!0)};If.prototype.v8c=
function(n,O){return!n||n.length<=O?(Rc.ULS.sendTraceTag(41756258,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(n[O])};If.prototype.iyd=function(n,O,da,l,K,ka){var $a=this.v8c(K,ka);0>$a&&Rc.ULS.sendTraceTag(41756259,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Sb.G5c[$a]){case 96:n=new ig.a(-2058042992,O.method,O.mode,O.qf,O.tabName);this.fm.bG.Aqb(this.$,l,0,n);break;case 217:n=new ig.a(504133448,O.method,O.mode,O.qf,
O.tabName);this.fm.bG.Aqb(this.$,l,0,n);break;case 218:n=new ig.a(-798968736,O.method,O.mode,O.qf,O.tabName);this.fm.bG.Aqb(this.$,l,0,n);break;case 219:n=new ig.a(-1677817820,O.method,O.mode,O.qf,O.tabName);this.fm.bG.Aqb(this.$,l,0,n);break;case 92:this.lzf(n,O,l,da,K,ka+1);break;case 91:this.fm.bG.h$h(this.$,l)}};If.prototype.lzf=function(n,O,da,l,K,ka){var $a=this.v8c(K,ka);0>$a&&Rc.ULS.sendTraceTag(41756288,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!l||
$a>=l.length)Rc.ULS.sendTraceTag(41756289,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(l=l[$a],l.J0b){case 1:this.fm.bG.z$h(this.$,da);break;case 2:(K=Object(pf.a)(Pf,l))?(n=new ig.a(-2058042992,O.method,O.mode,O.qf,O.tabName),this.fm.bG.Aqb(this.$,da,K.wke,n)):this.fm.bG.raf(this.$,n,da,l.q_c);break;case 0:this.fm.bG.raf(this.$,n,da,l.q_c);break;case 4:this.lzf(n,O,da,l.subMenu,K,ka+1)}};If.prototype.applyAutoFilterFieldList=function(n,O){var da=O[rg.a.PH];
if(da)if(da=da.split($g.a.QT),3>da.length)Rc.ULS.sendTraceTag(41756291,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var l=this.v8c(da,1),K=this.vIa(l),ka=this.Aff(l).returnValue;ka?this.iyd(O,n,ka,K,da,2):Rc.ULS.sendTraceTag(41756292,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+l.toString()+$g.a.QT)}else Rc.ULS.sendTraceTag(41756290,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};
If.prototype.Jc=function(n,O){if(n=this.$.isEditMode)switch(O.command){case 216058793:break;case -699941697:break;case -1494291901:n=!0;break;default:n=!1}return n};If.prototype.AN=function(n,O,da){this.$.isEditMode&&((this.fm=Object(pf.a)(416,da))||Rc.ULS.sendTraceTag(41756293,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.nY(),og.prototype.AN.call(this,n,O,null,null,!0))};If.prototype.OYc=function(){if(!this.fm||!this.fm.Al||1!==this.fm.Al.length)return Rc.ULS.sendTraceTag(41756294,
0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var n=this.fm.Al[0],O=new Aa.a;O.add(Sd.a.instance.da(235));O=Vf.OBc(Vf.concat(O,Vf.select(Vf.asEnumerable(n.FieldInfoDataList),function(da){return da.Name})),function(da){return da},new vf);return Vf.toArray(O)};If.prototype.fieldIndex=function(n){if(!this.fm||!this.fm.Al||1!==this.fm.Al.length||!this.fm.Al[0].FieldInfoDataList)return-1;for(var O=0;O<this.fm.Al[0].FieldInfoDataList.length;++O)if(this.fm.Al[0].FieldInfoDataList[O].Name===
n)return O;return-1};If.prototype.vIa=function(n){return 0>n||!this.fm||!this.fm.Al||1!==this.fm.Al.length||!this.fm.Al[0].FieldInfoDataList||this.fm.Al[0].FieldInfoDataList.length<n?null:this.fm.Al[0].FieldInfoDataList[n].Name};If.prototype.nY=function(){var n=this,O=this.OYc();if(!O||!O.length)return null;for(var da=this.Va,l=da.Vc(),K={},ka=0;ka<O.length;K={Ycb:K.Ycb},++ka){var $a=O[ka];K.Ycb=0<ka?this.fieldIndex($a):-1;for(var Lb=If.YUf+K.Ycb.toString()+$g.a.QT,bc=null,Dc=this.fm.bG.JPh(0<ka?
$a:null),wd=this.YYc(da,Dc,If.YUf+K.Ycb.toString(),$a),ke={},jf=0;jf<Sb.G5c.length;ke={MLb:ke.MLb,Xcb:ke.Xcb},++jf){var Xf=Sb.G5c[jf],Sf=Lb+jf.toString();bc||(bc=da.Vc());switch(Xf){case 217:Array.add(bc.buttons,da.Cd(223,Sf,-699941697,this.fm.bG.n6h(0<ka?$a:null)?Df.a.Xsa:Df.a.l3,8,217,!1,null));break;case 218:Array.add(bc.buttons,da.Cd(224,Sf,-699941697,this.fm.bG.o6h(0<ka?$a:null)?Df.a.Ysa:Df.a.m3,8,218,!1,null));break;case 219:Array.add(bc.buttons,da.Cd(225,Sf,-699941697,Df.a.n4b,1,219,!1,null));
break;case 96:Xf=this.tEg($a);Sf=da.TFa(Sf+(Dc?".enabled":".disabled"),Xf,-699941697,null,"None",null,!Dc,void 0,!0);Sf.mR("Image16by16",8,Df.a.F_a);Array.add(bc.buttons,Sf);break;case 92:ke.MLb=void 0;ke.Xcb=void 0;var xg=function(xi,Oi){return function(){var pj=n.Aff(xi.Ycb);Oi.MLb=pj.dKe;Oi.Xcb=pj.isChecked;return pj}}(K,ke)().returnValue;if(!xg)return null;Xf=this.YYc(da,ke.Xcb&&Dc,Sf,ke.MLb);Sf=this.oNe(Xf.menu,da,Sf+$g.a.QT,xg,ke.Xcb&&Dc);Array.add(Xf.menu.Fc,Sf);Array.add(bc.buttons,Xf);break;
case 0:bc&&(Array.add(wd.menu.Fc,bc),bc=null);break;default:Sf=da.TFa(Sf,Sd.a.instance.da(Xf),-699941697,null,"None",null,!1,void 0,!0),this.wNf(Sf,Dc&&91===Xf&&this.fm.bG.filter(),Sd.a.instance.da(Xf)),Array.add(bc.buttons,Sf)}}Array.add(wd.menu.Fc,bc);Array.add(l.buttons,wd)}O=da.sp(this.menuId);Array.add(O.Fc,l);return O};If.prototype.oNe=function(n,O,da,l,K){for(var ka=null,$a=0;$a<l.length;++$a){var Lb=l[$a],bc=da+$a.toString(),Dc=!1;switch(Lb.J0b){case 1:Dc=K&&this.fm.bG.Mh.IsTop10;break;case 2:Dc=
Object(pf.a)(Pf,Lb);Dc=K&&this.fm.bG.j0h(Dc?Dc.wke:0,Lb.q_c);break;case 0:Dc=K&&this.fm.bG.Mh.IsCustomSupportedAndNotPresent}ka||(ka=O.Vc());if(Lb.k3h)ka&&(Array.add(n.Fc,ka),ka=null);else if(Lb.B6h){var wd=Sd.a.instance.da(Lb.Gff);wd=this.YYc(O,Dc,bc,wd);Array.add(wd.menu.Fc,this.oNe(wd.menu,O,bc+$g.a.QT,Lb.subMenu,Dc));Array.add(ka.buttons,wd)}else Lb=Sd.a.instance.da(Lb.Gff),bc=O.TFa(bc,Lb,-699941697,null,"None",null,!1,void 0,!0),this.wNf(bc,Dc,Lb),Array.add(ka.buttons,bc)}return ka};If.prototype.wNf=
function(n,O,da){O?n.mR("Image16by16",8,Df.a.zha):n.mR("None",0,null);n.kR(da);n.label=da};If.prototype.YYc=function(n,O,da,l){return O?n.QYc(da,this.menuId,l,798637440,8,Df.a.zha):n.bA(da,this.menuId,l,798637440)};If.prototype.na=function(n){return!n||!n.length};If.prototype.Aff=function(n){var O=0>n?0:this.fm.Al[0].FieldInfoDataList[n].MajorityDataTypeForField;var da=null;n=this.fm.bG.IPh(O);switch(O){case 0:da=93;O=Dg.woj;break;case 1:da=92;O=Dg.qmi;break;case 2:da=94;O=Dg.k_g;break;default:return Rc.ULS.sendTraceTag(41756295,
0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,dKe:da,isChecked:n}}da=Sd.a.instance.da(da);return{returnValue:O,dKe:da,isChecked:n}};If.prototype.tEg=function(n){!n||this.na(n.trim())?n=Sd.a.instance.da(95):n.length>Sb.VJe?(n=n.substring(0,Sb.VJe),n=String.format(Sd.a.instance.Eb(154),n)):n=String.format(Sd.a.instance.Eb(155),n);return n};Jl.Object.defineProperties(If.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},
RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.lBf}}});If.Dkh="AutoFilterFieldsContextMenu";If.uFb="AutoFilterFieldListContextMenuRoot";If.YUf="ApplyAutoFilterFieldList.";Object(hd.a)(If,"AutoFilterFieldListContextMenu",pa.a,[]);var h=b(454),e=b(574),I=b(960),Z=b(9),Ca=b(116),Na=b(367),Vb=pa.a;Cm(bf,Vb);bf.prototype.executeCommand=function(n,O,da){n=Object(pf.a)(h.a,da.eventArgs);switch(O.command){case -1372040782:da=te.g(this.$).ga.Sa.nc;Rc.ULS.shipAssertTag(18670023,0,!!da);da&&(this.floatingObject=
da.floatingObject,this.Cb=O.method,O=this.n7b(n),this.Ln(O,!0,n.Cb));break;case 848910589:n&&(O=[I.a.FQf],n=new Sys.UI.Point(n.Ga.clientX,n.Ga.clientY),this.showFloatie(O,new Sys.UI.Bounds(n.x,n.y,0,0),2))}return ug.Task.Ua(!0)};bf.prototype.Jc=function(n,O,da){switch(O.command){case -1372040782:return!!da&&this.G8e(n);case 848910589:return n=te.g(this.$).ga.Sa.nc,!!da&&!!n&&n.isEditing;default:return!1}};bf.prototype.G8e=function(n){switch(n){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};
bf.prototype.mOc=function(n,O,da){Na.a(this.$)?te.g(this.$).$a.lj||(ze.a(this.$).PJd()?Array.add(da.buttons,n.zb(262)):Array.add(da.buttons,n.zb(261))):(this.$.isEditMode&&3===this.Cb&&!this.N5b()&&Array.add(da.buttons,n.zb(101)),!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5579554_ShapeTextEditing")||5!==this.floatingObject.type||Ca.a.WG(this.floatingObject.Ib)||this.floatingObject.Ib.IsGroup||(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Njd()?Array.add(da.buttons,
n.zb(186)):Array.add(da.buttons,n.zb(147))),this.N5b()||this.Njd()||Array.add(da.buttons,n.zb(146)),fd.EwaSettings.ka(169)&&!this.floatingObject.type&&Array.add(da.buttons,n.zb(246)),fd.EwaSettings.getBooleanFeatureGate(e.a.Iwa,!1)&&5===this.floatingObject.type&&te.g(this.$).ga.Sa.nc.r4()&&this.$.zja&&this.$.Hqa&&Array.add(da.buttons,n.zb(270)))};bf.prototype.wIa=function(n){var O=[];if(Na.a(this.$))return O;3===n?(n=!!this.$.lg.get(5)&&this.floatingObject.HMd(),this.N5b()||(this.$.isEditMode?(n&&
Array.add(O,I.a.Fnh),5===te.g(this.$).ga.Sa.XB.floatingObject.type&&Array.add(O,I.a.Yaj)):n&&Array.add(O,I.a.copy)),Array.add(O,I.a.Gnh)):2===n&&(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?te.g(this.$).ga.Sa.nc&&this.cSe(te.g(this.$).ga.Sa.nc,O):this.cSe(te.g(this.$).ga.Sa.XB,O));return O};bf.prototype.nY=function(){var n=this.Va,O=n.sp(this.menuId),da=Na.a(this.$);if(this.$.isEditMode){var l=n.Vc();this.mOc(n,O,l);Array.add(O.Fc,l)}this.$.lg.get(5)&&
this.floatingObject.HMd()&&!this.N5b()&&!da&&(l=n.Vc(),this.nog(n,l),Array.add(O.Fc,l));!fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.floatingObject.type||this.$.fa.isNamedObjectViewMode||da||(da=n.Vc(),this.gqg(n,da),Array.add(O.Fc,da));return O};bf.prototype.n7b=function(n){var O=te.g(this.$).ga.Sa.nc;n=n&&1!==n.Cb&&n.clientPoint?n.clientPoint:Sys.UI.DomElement.getLocation(O.domElement);var da=this.$.domElement,l=te.g(this.$).rtl;(O=Z.HelperMethods.mA(O.Ig.domElement,
da,l))?(n.y=Math.max(n.y,O.y),n.x=Math.max(n.x,O.x)):Rc.ULS.sendTraceTag(573907585,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Ee.AFrameworkApplication.Ng);return n};bf.prototype.Njd=function(){var n=te.g(this.$).ga.Sa.nc;return!!n&&n.isEditing};bf.prototype.nog=function(n,O){if(this.$.isEditMode){Array.add(O.buttons,n.zb(42));Array.add(O.buttons,n.zb(43));var da=this.$.ea.Ea(254,!0);(da&&2===da.Fxb()||
fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Njd())&&Array.add(O.buttons,n.zb(44))}else Array.add(O.buttons,n.zb(43))};bf.prototype.gqg=function(n,O){Array.add(O.buttons,n.zb(271))};bf.prototype.N5b=function(){return fd.EwaSettings.ka(494)&&!!te.g(this.$).ga.Sa.fr};bf.prototype.cSe=function(n,O){5===n.floatingObject.type?fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&n.isEditing?Array.add(O,I.a.FQf):Array.add(O,I.a.Uaj):
Array.add(O,pa.a.hLe)};Jl.Object.defineProperties(bf.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.sBf}}});Object(hd.a)(bf,"FloatingObjectContextMenu",pa.a,[]);var vc=b(903),md=b(96),Ld=b(575),Jd=b(521);Cm(Uf,bf);Uf.prototype.executeCommand=function(n,O,da){var l=this.$;this.Cb=O.method;O=da[Uf.bVc];if(!(n&68)){if(!O){if(8===n)O=Jd.a(l).hd;else{var K=te.g(l).ga.Sa.nc;K&&K.floatingObject&&
(O=K.floatingObject.hd)}if(!O)return ug.Task.Ua(!0)}this.isPivotChart=!!(O.Attributes&4)}if(this.isPivotChart||l.isEditMode)this.refresh=this.IY=this.Bua=this.gza=!1,K=te.g(this.$).ga.Sa.nc,Rc.ULS.shipAssertTag(18670022,0,!!K),K&&(this.floatingObject=K.floatingObject,(K=Ld.a(l))&&K.mJd&&(this.gza=K=md.f(l.sg),this.Bua=!K),K=l.mc,this.IY=!!vc.a(l)&&!!O&&!!(O.Attributes&512)&&!(n&8)&&K.N1(32768),K.allowManualDataRefresh&&K.allowInteractivity&&(this.refresh=!0),n=this.n7b(Object(pf.a)(h.a,da.eventArgs)),
this.Ln(n,!0));return ug.Task.Ua(!0)};Uf.prototype.Jc=function(n,O,da){return-149612405===O.command&&!!da&&this.G8e(n)};Uf.prototype.mOc=function(n,O,da){this.isPivotChart&&(this.refresh&&Array.add(da.buttons,n.zb(100)),this.IY&&Array.add(da.buttons,n.zb(99)),this.gza?Array.add(da.buttons,n.zb(59)):this.Bua&&Array.add(da.buttons,n.zb(58)));bf.prototype.mOc.call(this,n,O,da)};Jl.Object.defineProperties(Uf.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},
RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.mBf}}});Jl.Object.defineProperties(Uf,{bVc:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(hd.a)(Uf,"ChartContextMenu",bf,[]);var je=b(11),qf=pa.a;Cm(df,qf);df.prototype.executeCommand=function(n,O,da){n=O.command;switch(n){case 330754562:fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableReactFieldList",!1)?(O=da.domElement,this.isOlap=da.isOlap):O=(new Sys.UI.DomEvent(da.rawEvent)).target;
this.NK=da.versionkey;this.kl=da.fieldItem;this.sE=da.isChart;this.uE=da.isPpm;this.JMd="supportsImplicitMeasures"in da?da.supportsImplicitMeasures:!1;te.g(this.$).Zo(!0);n=je.DOMElementExtensions.getBounds(O);n=new Sys.UI.Point(n.x+n.width,n.y+n.height/2);this.vRa(n,O);"isKeyboardInput"in da&&da.isKeyboardInput?this.Ln(n,!1,1):this.Ln(n,!1);break;case 926905850:this.JMd&&this.kl&&5===this.kl.TypeTag&&!this.kl.IsCollapsible&&Rc.ULS.sendTraceTag(556340816,0,50,"Add implicit measurement from field list.");
Ld.a(this.$).lG(this.kl,8,-1,this.NK,O);break;case -67292059:Ld.a(this.$).lG(this.kl,1,-1,this.NK,O);break;case 745182485:Ld.a(this.$).lG(this.kl,2,-1,this.NK,O);break;case 359279088:Ld.a(this.$).lG(this.kl,4,-1,this.NK,O);break;case 547535945:Ld.a(this.$).KMi(this.kl);break;default:return kh.a(n)}return ug.Task.Ua(!0)};df.prototype.Jc=function(n,O,da){n=!1;switch(O.command){case 330754562:n=!!da;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:n=!0}return n};df.prototype.nY=
function(){var n=this.Va.sp(this.menuId);fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableReactFieldList",!1)?(this.HGi(n),this.sE||this.isOlap||this.GGi(n)):this.dGi(n);return n};df.prototype.dGi=function(n){var O=this.Va,da=O.Vc();17===this.kl.TypeTag||this.uE?(Array.add(da.buttons,O.zb(79)),Array.add(da.buttons,O.zb(this.sE?91:80)),Array.add(da.buttons,O.zb(this.sE?92:81)),Array.add(da.buttons,O.zb(82))):3!==this.kl.TypeTag&&37!==this.kl.TypeTag||this.kl.IsSet?(13===this.kl.TypeTag||
this.kl.IsSet?Array.add(da.buttons,O.zb(83)):Array.add(da.buttons,O.zb(79)),Array.add(da.buttons,O.zb(this.sE?91:80)),Array.add(da.buttons,O.zb(this.sE?92:81)),Array.add(da.buttons,O.zb(86))):(Array.add(da.buttons,O.zb(83)),Array.add(da.buttons,O.zb(this.sE?93:84)),Array.add(da.buttons,O.zb(this.sE?94:85)),Array.add(da.buttons,O.zb(82)));Array.add(n.Fc,da)};df.prototype.HGi=function(n){var O=this.Va,da=O.Vc(),l=!1;fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",
!1)&&(l=this.isOlap&&!this.uE&&this.JMd&&5===this.kl.TypeTag&&!this.kl.IsCollapsible);3!==this.kl.TypeTag&&37!==this.kl.TypeTag||this.kl.IsSet?17===this.kl.TypeTag||this.uE?(Array.add(da.buttons,O.zb(79)),Array.add(da.buttons,O.zb(this.sE?91:80)),Array.add(da.buttons,O.zb(this.sE?92:81)),Array.add(da.buttons,O.zb(82))):13===this.kl.TypeTag||this.kl.IsSet?(Array.add(da.buttons,O.zb(83)),Array.add(da.buttons,O.zb(this.sE?91:80)),Array.add(da.buttons,O.zb(this.sE?92:81)),Array.add(da.buttons,O.zb(86))):
(Array.add(da.buttons,O.zb(79)),Array.add(da.buttons,O.zb(this.sE?91:80)),Array.add(da.buttons,O.zb(this.sE?92:81)),Array.add(da.buttons,O.zb(l?82:86))):(Array.add(da.buttons,O.zb(83)),Array.add(da.buttons,O.zb(this.sE?93:84)),Array.add(da.buttons,O.zb(this.sE?94:85)),Array.add(da.buttons,O.zb(82)));Array.add(n.Fc,da)};df.prototype.GGi=function(n){var O=this.Va.Vc();Array.add(O.buttons,this.Va.zb(78));Array.add(n.Fc,O)};Jl.Object.defineProperties(df.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},
RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.pzd}}});Object(hd.a)(df,"FieldListContextMenu",pa.a,[]);var rf=b(404),Zf=b(63);dh.prototype.get=function(n,O,da){var l=this.U_f(n,"PivotFilterContextMenuCache.Get");return l&&this.DM[l]?this.DM[l][dh.l$c(O,this.$,n,da)]:null};dh.prototype.set=function(n,O,da,l){var K=this.U_f(n,"PivotFilterContextMenuCache.Set");K&&(this.DM[K]||(this.DM[K]={}),this.DM[K][dh.l$c(O,this.$,n,l)]=da)};dh.prototype.Gpb=function(n){n in this.DM&&this.DM[n]&&(this.DM[n]=
null)};dh.prototype.U_f=function(n,O){return Zf.f(this.$.sa)?this.$.activeItemName:(n=this.xsj(n,O))?n.Od:null};dh.prototype.xsj=function(n,O){n=jg.C(n);n=te.g(this.$).Ha.BIa(n,this.$.activeItemName);Rc.ULS.shipAssertTag(593851032,0,!!n,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",O);return n};dh.l$c=function(n,O,da,l){return fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",
!1)&&!l?O.sa.index+"_"+n.id+"_"+da.FirstRow.toString()+"_"+da.FirstColumn.toString():O.sa.index+"_"+n.id};Object(hd.a)(dh,"PivotFilterContextMenuCache",null,[]);Object(hd.a)(cf,"ShowPivotFilterData",null,[]);var Ef=b(572),sh=b(1256),Jg=b(48),gh=pa.a;Cm(Se,gh);Se.prototype.F4c=function(n,O){var da=this,l=n.rawEvent,K=n.cell,ka=n.requiresConfirmation;Ef.a(this.$).Hv(ka,function($a){if($a){$a=l?new Sys.UI.DomEvent(l):null;da.pivotData=new cf;da.pivotData.pivotName=n.pivotName;da.pivotData.dataSourceIndex=
n.dataSourceIndex;da.pivotData.cell=K;da.pivotData.to=n.optionalPivotMenuAnchorParameter;if(da.pivotData.to&&0<da.pivotData.to.AnchorType){da.thc=n.objectId;da.uhc=n.objectVersion;var Lb=da.pivotData.to.AnchorType;if(4===Lb||5===Lb||6===Lb||11===Lb||9===Lb||10===Lb||8===Lb)da.ujb=n.location}else da.Qrd=da.thc=null,da.Rrd=da.uhc=-1;te.g(da.$).Zo(!0);da.$.gk(K);da.AN($a,$a?$a.target:n.domElement,da.pivotData,O,da.qKa())}});return!0};Se.prototype.AN=function(n,O,da,l){var K=this;if(Object(rf.a)(cf,da)){this.pivotData=
da;this.V0b=O;this.y$e=n;this.$Uc=this.pivotData.to?this.pivotData.to.AnchorValue1:-1;this.L1=this.pivotData.to?this.pivotData.to.AnchorType:0;var ka=!1,$a=null;$a=Se.DM.get(this.pivotData.cell,O,this.L1);ka=!!$a;var Lb=!0;switch(this.L1){case 4:case 5:case 6:this.Yba=new Sys.UI.Point(this.ujb.x,this.ujb.y);Lb=!1;break;case 7:var bc=Sys.UI.DomElement.getBounds(O);Lb=bc.x+(0<=bc.x?0:bc.width);bc=bc.y+(0<=bc.y?0:bc.height);this.Yba=new Sys.UI.Point(0<=Lb?Lb:0,0<=bc?bc:0);Lb=!1;break;case 8:case 10:case 9:case 11:this.Yba=
new Sys.UI.Point(this.ujb.x,this.ujb.y);break;default:this.Yba=null}ka&&this.thc===this.Qrd&&this.uhc===this.Rrd&&this.$Uc===this.bpe&&this.L1===this.lhe?(Rc.ULS.sendTraceTag(590726106,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.nZa=$a,this.Yba?(this.vRa(this.Yba,O),this.Ln(this.Yba,this.qKa())):this.Yv?this.Ln(pa.a.o7b(this.$,this.pivotData.cell,!1),this.qKa()):gh.prototype.AN.call(this,n,O,da,l,this.qKa())):1!==Se.fzh(O)&&(Lb&&(O.parentNode.menuFetchStates=
1,this.z6i(O),this.fNf(!0)),this.$.userOperationManager.oc(new bh.a(126,0,function(Dc,wd,ke){var jf=K.$;return nf.z(jf.ra.xa,K.pivotData.cell,K.pivotData.dataSourceIndex,K.pivotData.pivotName,jf.domElement.id,jf.isChromeRtl,jf.workbookContext.NovMode,Lf.b(Dc,Object(Kc.a)(K,K.Ysi,"onGetMenuSucceeded")),Lf.a(wd,Object(Kc.a)(K,K.Xsi,"onGetMenuFailed")),ke,O,K.pivotData.to)},16),l))}};Se.prototype.Ysi=function(n,O){if(O)if(Cf.a(n))this.Uod(O,!1);else if(n=n.Result){this.opb=dh.l$c(O,this.$,this.pivotData.cell,
this.L1);var da=this.wpd(n.MenuModel.Sections);this.nZa=da;Se.DM.set(this.pivotData.cell,O,da,this.L1);sh.a(this.$).Ulj(n);this.Uod(O,!0)}};Se.prototype.Xsi=function(n,O){this.Uod(O,!1)};Se.prototype.Cwd=function(n){Array.addRange(n.MenuSectionList,this.nZa)};Se.prototype.Uod=function(n,O){n.parentNode.menuFetchStates=2;this.fNf(!1);O&&(this.V0b!==n||this.thi()?(this.vRa(this.Yba,n),this.Ln(this.Yba,this.qKa())):this.Yv&&!this.Yba?this.Ln(pa.a.o7b(this.$,this.pivotData.cell,!1),this.qKa()):gh.prototype.AN.call(this,
this.y$e,n,null,null,this.qKa()),this.Qrd=this.thc,this.Rrd=this.uhc,this.lhe=this.L1,this.bpe=this.$Uc)};Se.prototype.qKa=function(){return 8!==this.L1&&9!==this.L1&&10!==this.L1&&11!==this.L1};Se.prototype.Le=function(n,O){Se.DM.Gpb(O.Qd.hash)};Se.prototype.jm=function(n,O){Se.DM.Gpb(O.Qd.hash)};Se.prototype.thi=function(){switch(this.pivotData.to?this.pivotData.to.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};Se.prototype.fNf=function(n){var O=this.V0b;
if(O){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var da=je.DOMElementExtensions.QY(O,"ewaprevsrc","");da=!mf.a.na(da)&&"null"!==da}else da=!mf.a.na(je.DOMElementExtensions.QY(O,"ewaprevsrc",""));n&&da||!n&&!da||(n?(O.setAttribute("ewaprevsrc",O.src),O.src=Jg.a.current.En(79)):(n=je.DOMElementExtensions.QY(O,"ewaprevsrc",""),O.src=n,O.setAttribute("ewaprevsrc",null)))}};Se.prototype.z6i=function(n){this.V0b=n};Se.fzh=function(n){var O=n.parentNode.menuFetchStates;
void 0===O&&(n.parentNode.menuFetchStates=0);return O};Se.DM=null;Object(hd.a)(Se,"PivotFilterContextMenuBase",pa.a,[]);Cm(xf,Se);xf.prototype.executeCommand=function(n,O,da){return this.F4c(da,O)?ug.Task.Ua(!0):kh.a(O.command)};xf.prototype.Jc=function(n,O,da){return-1065117584===O.command&&!!da};Jl.Object.defineProperties(xf.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.qBf}}});Object(hd.a)(xf,
"FieldListPivotContextMenu",Se,[]);var ah=b(30),Wh=b(835);Object(hd.a)(ee,"PivotValueFieldSettingsApplyData",null,[]);Pd.QZg="dataFieldCustomLabel";Pd.gxe="dataFieldSourceLabel";Pd.Uhj="showValueAsSelect";Pd.Shj="showValueAsBaseFieldSelect";Pd.Thj="showValueAsBaseItemSelect";Pd.LRd="valueFieldsSettingsFieldName";Pd.N4f="valueFieldSettingTabs";Object(hd.a)(Pd,"CssElementIds",null,[]);var zh=b(118);Object(hd.a)(Md,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);qc.prototype.getActiveCell=function(){return this.activeCell};
Object(hd.a)(qc,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[115]);var Te=b(227);Object(hd.a)(pc,"PivotValueFieldShowValueAsApplyData",null,[]);var Th=b(836),V=b(39),Pa=Te.a;Cm(lb,Pa);lb.prototype.Iia=function(){return this.isVisible};lb.prototype.jma=function(n){return this.isVisible=n};lb.prototype.setFocus=function(){je.DOMElementExtensions.setFocus(this.K2.Kn)};lb.prototype.render=function(n){n.appendChild(this.domElement)};lb.prototype.dispose=function(){Ff.a.rc([this.K2,this.YS,
this.OO,this.v1b,this.vXb]);Pa.prototype.dispose.call(this)};lb.prototype.a9i=function(n){Ff.a.rc([this.v1b,this.vXb]);this.K2.clear();for(var O=Ml(n.DataFormatTypes),da=O.next();!da.done;da=O.next())da=da.value,this.K2.oL(lb.txh(da),da.toString(),da===n.SelectedDataFormat);this.v1b=this.Ud.Kd(this.K2.domElement);this.v1b.la("change",Object(Kc.a)(this,this.Elf,"onDataFormatChanged"));this.YS.clear();O=Ml(n.BaseFieldList);for(da=O.next();!da.done;da=O.next())da=da.value,this.YS.oL(da.DisplayString,
da.Id.toString(),da.Id===n.SelectedBaseField);this.vXb=this.Ud.Kd(this.K2.domElement);this.vXb.la("change",Object(Kc.a)(this,this.loi,"onBaseFieldChanged"));this.JE=this.I9.aZa(this.OO.Kn.parentNode,1E3,null,"",708);this.Elf(null)};lb.prototype.$P=function(n){this.K2.$P(n);this.YS.$P(n);this.OO.$P(n)};lb.prototype.Elf=function(){var n=parseInt(this.K2.me.value);this.LHg(n)?(this.YS.Kn.disabled=!0,this.OO.Kn.disabled=!0,this.OO.clear(),lb.f3e(n)?(this.YS.Kn.disabled=!1,this.lKb(!0)):lb.g3e(n)?(this.YS.Kn.disabled=
!1,this.OO.Kn.disabled=!1,this.lKb(!0),this.ebf()):this.lKb(!1)):(n=qd.a.Ad(1,0,0,1062,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),V.a(this.$).Yt([n]),this.K2.LZi())};lb.prototype.cja=function(){this.domElement.innerHTML=String.format("<div id='showValueAsControlBody'><label for='showValueAsSelect' class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='showValueAsSelect' class='ewa-dlg-body-fullLine'></select></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseFieldSelect'>{1}</label><div><select size=6 id='showValueAsBaseFieldSelect' class='ewa-dlg-body-fullLine'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseItemSelect'>{2}</label><div><select size=6 id='showValueAsBaseItemSelect' class='ewa-dlg-body-fullLine'></select></div></div></div>",
Sd.a.instance.da(1051),Sd.a.instance.da(1052),Sd.a.instance.da(1053));this.yXd=new Th.a(je.DOMElementExtensions.getElementById(this.domElement,Pd.Uhj),!1);this.XUd=new Th.a(je.DOMElementExtensions.getElementById(this.domElement,Pd.Shj),!1);this.YUd=new Th.a(je.DOMElementExtensions.getElementById(this.domElement,Pd.Thj),!1)};lb.prototype.LHg=function(n){return this.D3h||!lb.f3e(n)&&!lb.g3e(n)?!0:!!this.YS.count};lb.prototype.loi=function(){0>this.YS.selectedIndex||this.OO.Kn.disabled||(this.lKb(!0),
this.ebf())};lb.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var n=this;this.$.userOperationManager.oc(new bh.a(108,0,function(O,da,l){var K=n.$.ra.xa,ka=parseInt(n.YS.me.value);O=Lf.b.call(null,O,Object(Kc.a)(n,n.Uti,"onGetValueFieldSettingsShowValueAsBaseItemsSuccess"));var $a=nf.lb(K,n.cell,n.externalSourceIndex,n.to);$a.selectedBaseField=ka;return nf.i(K,"GetPivotValueFieldSettingsShowValueAsBaseItems",$a,O,da,l,null,4)},16),this.je)};lb.prototype.Uti=function(n){this.JE.zQa();
this.OO.Kn.style.overflowY="scroll";if(n&&!Cf.a(n)){n=n.Result;this.OO.clear();for(var O=Ml(n.BaseItems),da=O.next();!da.done;da=O.next())da=da.value,this.OO.oL(da.DisplayString,da.Id.toString(),da.Id===n.SelectedBaseItem);this.lKb(!1)}};lb.prototype.ebf=function(){this.OO.clear();this.YS.me&&(this.JE.nza(),this.OO.Kn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};lb.prototype.lKb=function(n){var O=document.getElementById("WACDialogActionButton");this.Hxj&&O&&(O.disabled=
n)};lb.txh=function(n){switch(n){case 0:return Sd.a.instance.da(1054);case 1:return Sd.a.instance.da(1055);case 2:return Sd.a.instance.da(1056);case 3:return Sd.a.instance.da(1057);case 4:return Sd.a.instance.da(1058);case 5:return Sd.a.instance.da(1059);case 6:return Sd.a.instance.da(1060);case 7:return Sd.a.instance.da(1061);case 8:return Sd.a.instance.da(1063);case 9:return Sd.a.instance.da(1064);case 10:return Sd.a.instance.da(1065);case 11:return Sd.a.instance.da(1066);case 12:return Sd.a.instance.da(1067);
case 13:return Sd.a.instance.da(1068);case 14:return Sd.a.instance.da(1069);default:return""}};lb.f3e=function(n){return 11===n||12===n||14===n||13===n||4===n};lb.g3e=function(n){return 1===n||3===n||2===n};Jl.Object.defineProperties(lb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Sd.a.instance.da(1050)}},Nsb:{configurable:!0,enumerable:!0,get:function(){var n=this.K2.me?parseInt(this.K2.me.value):-1,O=this.YS.me?parseInt(this.YS.me.value):-1,da=this.OO.me?parseInt(this.OO.me.value):
-1;return Object.assign(new pc,{SelectedDataFormat:0<=n?n:-1,SelectedBaseField:O,SelectedBaseItem:da})}},YS:{configurable:!0,enumerable:!0,get:function(){return this.XUd}},OO:{configurable:!0,enumerable:!0,get:function(){return this.YUd}},K2:{configurable:!0,enumerable:!0,get:function(){return this.yXd}}});Object(hd.a)(lb,"ShowValueAsControl",Te.a,[402,7]);Object(hd.a)(Fa,"PivotValueFieldSummarizeValueByApplyData",null,[]);var Ib=Te.a;Cm(Og,Ib);Og.prototype.Iia=function(){return this.isVisible};Og.prototype.jma=
function(n){return this.isVisible=n};Og.prototype.setFocus=function(){je.DOMElementExtensions.setFocus(this.$k.Kn)};Og.prototype.render=function(n){n.appendChild(this.domElement)};Og.prototype.dispose=function(){Ff.a.Ia(this.$k);Ib.prototype.dispose.call(this)};Og.prototype.focus=function(){je.DOMElementExtensions.setFocus(this.$k.Kn)};Og.prototype.$8i=function(n){this.$k.KLd();for(var O=Ml(n.AggregationTypes),da=O.next();!da.done;da=O.next()){da=da.value;var l=da===n.SelectedAggregation;this.$k.kOc(Og.jth(da),
da.toString(),l,"")}this.$k.q2c();this.$k.Kn.disabled=n.AggregationsDisabled};Og.prototype.HZi=function(){this.$k.IZi()};Og.prototype.cja=function(){this.domElement.innerHTML=String.format("<div id='summarizeValuesByControlBody'><label class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='ewa-dlg-body-sectionlabel summarizeValuesByControlDescription'>{1}</div><div><select class='ewa-dlg-body-fullLine' size=6 id='pivotDataFieldSelect' style='width: 100%' aria-describedby='pivotDataFieldSelectDescription'></select></div></div>",
Sd.a.instance.da(1034),Sd.a.instance.da(1035));this.q6d=new Th.a(je.DOMElementExtensions.getElementById(this.domElement,Og.swf),!1)};Og.jth=function(n){switch(n){case 0:return Sd.a.instance.da(1037);case 1:return Sd.a.instance.da(1038);case 2:return Sd.a.instance.da(1039);case 3:return Sd.a.instance.da(1040);case 4:return Sd.a.instance.da(1041);case 5:return Sd.a.instance.da(1042);case 6:return Sd.a.instance.da(1043);case 7:return Sd.a.instance.da(1044);case 8:return Sd.a.instance.da(1045);case 9:return Sd.a.instance.da(1046);
case 10:return Sd.a.instance.da(1047);case 11:return Sd.a.instance.da(1048);default:return""}};Jl.Object.defineProperties(Og.prototype,{Nsb:{configurable:!0,enumerable:!0,get:function(){var n=this.$k.me?parseInt(this.$k.me.value):-1;return Object.assign(new Fa,{Aggregation:0<=n?n:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return Sd.a.instance.da(1049)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.$k.Kn.disabled},set:function(n){this.$k.Kn.disabled=!n}},$k:{configurable:!0,
enumerable:!0,get:function(){return this.q6d}}});Og.swf="pivotDataFieldSelect";Object(hd.a)(Og,"SummarizeValuesByControl",Te.a,[402,7]);var wc=b(196),nd=b(459);lg.prototype.hnj=function(n,O){n.set_visible(!1);O.set_visible(!0)};Object(hd.a)(lg,"DefaultTabSwitchBehaviour",null,[425]);tf.Tnj="TabsContainer";tf.Dnj="TabTitlesContainer";tf.Bnj="TabTitle";tf.Cnj="TabTitleText";tf.eNd="TabTitleActive";Object(hd.a)(tf,"MultitabControlStyles",null,[]);var Bd=b(40),yd=b(90),re=b(87),xe=b(85);ve.prototype.dispose=
function(){Bd.a.removeHandler(this.Ai,"keyup",Object(Kc.a)(this,this.$6a,"onTitleKeyUp"));Bd.a.removeHandler(this.Ai,"click",this.wAc);this.Ai=this.Aea=null};ve.prototype.setActive=function(n){n?Sys.UI.DomElement.addCssClass(this.Ai,tf.eNd):Sys.UI.DomElement.removeCssClass(this.Ai,tf.eNd);this.Aea&&this.Aea.setAttribute(re.a.cga,n)};ve.prototype.$6a=function(n){n.keyCode!==yd.a.Vh&&n.keyCode!==yd.a.mna||this.wAc(n)};ve.prototype.Dvc=function(){this.Ai.setAttribute(re.a.Wd,re.a.ns);this.Aea.setAttribute(re.a.Av,
this.jp);this.Aea.setAttribute(re.a.Wd,re.a.slb)};Jl.Object.defineProperties(ve.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return this.Ai}},title:{configurable:!0,enumerable:!0,get:function(){return this.jp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Ai,tf.eNd)},set:function(n){this.setActive(n)}}});Object(hd.a)(ve,"TabTitleControl",null,[7]);var Re=b(49);tg.prototype.nGf=function(){this.ijb=document.createElement("ul");
this.ijb.className=tf.Dnj;this.$ib=document.createElement("div");this.$ib.className=tf.Tnj;for(var n=0;n<this.Otc;++n){var O=this.zX.oa(n),da=this.xDa.oa(n);O.set_visible(!1);da.isActive=!1;var l=document.createElement("div");O.render(l);this.$ib.appendChild(l);this.ijb.appendChild(da.Nb)}this.Nb.appendChild(this.ijb);this.Nb.appendChild(this.$ib);this.Okd(this.y0)&&(this.xDa.oa(this.y0).isActive=!0,this.zX.oa(this.y0).set_visible(!0))};tg.prototype.dispose=function(){for(var n=0;n<this.Otc;++n)this.zX.oa(n).dispose(),
this.xDa.oa(n).dispose();this.xDa=this.zX=this.Ai=this.$ib=this.ijb=null};tg.prototype.setFocus=function(){this.zX.oa(this.y0).setFocus()};tg.prototype.Okd=function(n){return 0<=n&&n<this.Otc};tg.prototype.BXf=function(n){this.y0!==n&&this.Okd(n)&&(this.Ikg.hnj(this.zX.oa(this.y0),this.zX.oa(n)),this.xDa.oa(this.y0).isActive=!1,this.xDa.oa(n).isActive=!0,this.y0=n,this.setFocus())};tg.prototype.MTg=function(n){var O=this;return function(){O.BXf(n)}};Jl.Object.defineProperties(tg.prototype,{Otc:{configurable:!0,
enumerable:!0,get:function(){return this.zX.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.y0},set:function(n){this.BXf(n)}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.Ai}},visible:{configurable:!0,enumerable:!0,get:function(){return Re.a.isVisible(this.Ai)},set:function(n){this.Ai.style.visibility=n?"visible":"hidden"}}});Object(hd.a)(tg,"MultitabControl",null,[401,7]);var Tf=Wh.a;Cm(de,Tf);de.prototype.dispose=function(){this.E_c=this.Pob=this.dQa=
this.VLc=null;Ff.a.Ia(this.Kea);this.Kea=null;Tf.prototype.dispose.call(this)};de.prototype.initialize=function(){var n="<div id='"+Pd.gxe+"' class='"+zh.a.Ey+"'></div><div id='"+Pd.QZg+"' class='"+zh.a.Ey+"'><label for='"+Pd.LRd+"'>{0}</label><input type='text' id='"+Pd.LRd+"' value='{1}' class='"+zh.a.bU+" UIFont' /></div><div id='"+Pd.N4f+"'></div>";n=String.format(n,Sd.a.instance.da(1033),ah.a.gg(this.M4f));this.Qb.innerHTML=n;this.Ne||(this.z1(),this.Tk());this.Tae=[-103190598];this.CKh();Tf.prototype.initialize.call(this)};
de.prototype.close=function(n){1===n&&(this.HSf=!1);Tf.prototype.close.call(this,n)};de.prototype.nze=function(n){this.fQ=n;this.domElement.disabled=n;for(var O=["input","option","select"],da=0,l=O.length;da<l;++da)for(var K=this.domElement.getElementsByTagName(O[da]),ka=0;ka<K.length;++ka)K[ka].disabled=n};de.prototype.Tk=function(){this.Pob=document.getElementById(Pd.LRd);this.E_c=je.DOMElementExtensions.getElementById(this.Qb,Pd.gxe);var n=je.DOMElementExtensions.getElementById(this.Qb,Pd.N4f);
this.VLc=new Og(document.createElement("div"));this.dQa=new lb(document.createElement("div"),this.$,this.cell,this.to,this.externalSourceIndex,this.je,this.I9,!this.isOlap);var O;this.Kea=new tg(n,(O=new Aa.a,O.add(this.GQa),O.add(this.dQa),O));this.Kea.nGf()};de.prototype.Mkc=function(){var n=new de(this.cell,this.to,this.externalSourceIndex,this.M4f,this.$,this.je,this.I9,this.isOlap,this.uE);n.initialize();n.Bf()};de.prototype.LRa=function(){var n=new nd.a;if(!this.HSf)return n.isValid=!0,n;this.Pob.value.length?
n.isValid=!0:(this.nze(!0),n.error=qd.a.Ad(1,0,721,736,0,1783218700,"PivotTableValueFieldNoBlank"),this.fQ=!0,this.Ne||(this.ax.disabled=!0),n.isValid=!1);return n};de.prototype.tXe=function(){this.fQ=!1;this.Ne||(this.ax.disabled=!1);this.nze(!1)};de.prototype.Nwa=function(n){var O=new ig.a(2105621672,0,this.$.jd,30,null);this.$.Na.Xb(O);this.YV(5,n.Cb,"Number Format");return!0};de.prototype.rm=function(){this.Hza=String.format(Sd.a.instance.Eb(60),null);Tf.prototype.rm.call(this)};de.prototype.setFocus=
function(){if(this.Ne){var n=je.DOMElementExtensions.getElementById(this.Qb,Og.swf);wc.a.dvc(n)}else this.Kea.setFocus()};de.prototype.Yl=function(){var n=this,O=this.dQa.Nsb,da=new Md(O.SelectedDataFormat,O.SelectedBaseField,O.SelectedBaseItem);return function(){return new qc(n.externalSourceIndex,n.cell,n.Pob.value,n.GQa.Nsb.Aggregation,da)}};de.prototype.Ww=function(){var n=this,O=Object.assign(new ee,{PivotValueFieldSummarizeValueByApplyData:this.GQa.Nsb,PivotValueFieldShowValueAsApplyData:this.dQa.Nsb,
PivotValueFieldTitle:this.Pob.value});return function(da,l,K){var ka=n.$.ra.xa;da=Lf.b(da,Object(Kc.a)(n,n.doi,"onApplyPivotValueFieldSettingsSuccess"));var $a=nf.lb(ka,n.cell,n.externalSourceIndex,n.to);$a.pivotValueFieldSettingsApplyData=O;return nf.i(ka,"ApplyPivotValueFieldSettings",$a,da,l,K,null,0)}};de.prototype.$P=function(n){var O=this;this.$.ea.ub(40,function(){O.dQa.$P(n)})};de.prototype.CKh=function(){var n=this;this.$.userOperationManager.oc(new bh.a(123,0,function(O,da,l){var K=n.$.ra.xa;
O=Lf.b.call(null,O,Object(Kc.a)(n,n.Tti,"onGetValueFieldSettingsInitialSuccess"));var ka=nf.lb(K,n.cell,n.externalSourceIndex,n.to);return nf.i(K,"GetPivotValueFieldSettingsInitial",ka,O,da,l,null,4)},16),this.je)};de.prototype.doi=function(n){Gh.a.any(n.Errors,function(O){return-103190598===O.MessageId})&&this.GQa.HZi()};de.prototype.Tti=function(n){n&&!Cf.a(n)&&(n=n.Result,this.E_c.innerHTML=Sd.a.instance.da(1032)+ah.a.gg(n.ValueFieldSourceName),this.isOlap&&!this.uE?(this.GQa.enabled=!1,this.Kea.activeTab=
this.Kea.Otc-1):(this.GQa.enabled=!0,this.Kea.activeTab=0),this.GQa.$8i(n.PivotValueFieldSettingsSummarizeValueByInfo),this.dQa.a9i(n.PivotValueFieldShowValueAsInitialInfo),this.Bf())};Jl.Object.defineProperties(de.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Bda:{configurable:!0,enumerable:!0,get:function(){return this.Tae}},qzb:{configurable:!0,enumerable:!0,get:function(){return this.Kea}},GQa:{configurable:!0,enumerable:!0,get:function(){return this.VLc}},
Aw:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(hd.a)(de,"ValueFieldSettingsDialog",Wh.a,[]);var ag=pa.a;Cm(Lg,ag);Lg.prototype.executeCommand=function(n,O,da,l){var K=this;n=O.command;switch(n){case -1453503574:l=da.domElement;this.kl=da.fieldItem;this.QSd=da.zoneCount;this.qQa=da.sourceAxis;this.Xsc=da.sourceAxisPos;this.to=da.optionalPivotMenuAnchorParameter;this.NK=da.versionkey;this.isOlap=da.isOlap;this.uE=da.isPpm;this.Q_a="fieldItemsupportsImplicitMeasures"in da?da.fieldItemsupportsImplicitMeasures:
!1;this.cell=da.cell;this.externalSourceIndex=da.externalSourceIndex;te.g(this.$).Zo(!0);n=je.DOMElementExtensions.getBounds(l);var ka=new Sys.UI.Point(n.x,n.y+n.height);this.$.isChromeRtl&&(ka.x+=n.width);this.vRa(ka,l);"isKeyboardInput"in da&&da.isKeyboardInput?this.Ln(ka,!1,1):this.Ln(ka,!1);break;case 495005930:Ld.a(this.$).V2g();break;case -1170196828:Ld.a(this.$).lG(this.kl,this.qQa,this.Xsc-1,this.NK,O);break;case -889576107:Ld.a(this.$).lG(this.kl,this.qQa,this.Xsc+2,this.NK,O);break;case 2033235475:Ld.a(this.$).lG(this.kl,
this.qQa,this.QSd,this.NK,O);break;case 389774337:Ld.a(this.$).lG(this.kl,this.qQa,0,this.NK,O);break;case -96230454:Ld.a(this.$).lG(this.kl,4,-1,this.NK,O);break;case 74086617:Ld.a(this.$).lG(this.kl,1,-1,this.NK,O);break;case 1529312473:Ld.a(this.$).lG(this.kl,2,-1,this.NK,O);break;case 563292088:this.Q_a&&Rc.ULS.sendTraceTag(556340815,0,50,"Move a field into values area as implicit measurement.");Ld.a(this.$).lG(this.kl,8,-1,this.NK,O);break;case -1092351914:Ld.a(this.$).lG(this.kl,0,-1,this.NK,
O);break;case -2141589616:var $a=Nf.GetServiceTaskFactory.Xa(this.$.ea,12,477,l.yia(),"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");return fe.TaskExtensions.Da($a,function(){(new de(K.cell,K.to,K.externalSourceIndex,K.kl.Name,K.$,O,$a.result,K.isOlap,K.uE)).initialize()},this.ma);default:return kh.a(n)}return ug.Task.Ua(!0)};Lg.prototype.Jc=function(n,O,da){n=!1;switch(O.command){case -1453503574:n=!!da;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:n=
!0}return n};Lg.prototype.nY=function(){var n=this.Va.sp(this.menuId);this.MGi(n,this.Xsc,this.QSd);this.NGi(n,this.qQa);this.OGi(n);8===this.qQa&&this.KGi(n);return n};Lg.prototype.MGi=function(n,O,da){var l=this.Va,K=l.Vc();O||O!==da-1?!O&&O<da-1?(Array.add(K.buttons,l.zb(64)),Array.add(K.buttons,l.zb(61)),Array.add(K.buttons,l.zb(66)),Array.add(K.buttons,l.zb(63))):0<O&&O<da-1?(Array.add(K.buttons,l.zb(60)),Array.add(K.buttons,l.zb(61)),Array.add(K.buttons,l.zb(62)),Array.add(K.buttons,l.zb(63))):
0<O&&O===da-1&&(Array.add(K.buttons,l.zb(60)),Array.add(K.buttons,l.zb(65)),Array.add(K.buttons,l.zb(62)),Array.add(K.buttons,l.zb(67))):(Array.add(K.buttons,l.zb(64)),Array.add(K.buttons,l.zb(65)),Array.add(K.buttons,l.zb(66)),Array.add(K.buttons,l.zb(67)));Array.add(n.Fc,K)};Lg.prototype.NGi=function(n,O){var da=this.Va,l=da.Vc(),K=1!==O&&(!this.isOlap||this.uE||8!==O||this.Q_a),ka=2!==O&&(!this.isOlap||this.uE||8!==O||this.Q_a),$a=8!==O&&-2!==this.kl.PivotTableIndex&&(!this.isOlap||this.uE||this.Q_a);
Array.add(l.buttons,da.zb(4===O||this.kl.IsSet||-2===this.kl.PivotTableIndex||this.isOlap&&!this.uE&&8===O&&!this.Q_a?72:68));8===this.to.AnchorType||10===this.to.AnchorType?(Array.add(l.buttons,da.zb(K?95:97)),Array.add(l.buttons,da.zb(ka?96:98))):(Array.add(l.buttons,da.zb(K?69:73)),Array.add(l.buttons,da.zb(ka?70:74)));Array.add(l.buttons,da.zb($a?71:75));Array.add(n.Fc,l)};Lg.prototype.OGi=function(n){var O=this.Va.Vc();Array.add(O.buttons,this.Va.zb(76));Array.add(n.Fc,O)};Lg.prototype.KGi=function(n){var O=
this.Va.Vc();Array.add(O.buttons,this.Va.zb(77));Array.add(n.Fc,O)};Jl.Object.defineProperties(Lg.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.qzd}}});Object(hd.a)(Lg,"FieldWellContextMenu",pa.a,[]);var Qg=b(1237);Cm(qg,Se);qg.prototype.executeCommand=function(n,O,da){var l=!1,K=O.command;switch(K){case 37023044:l=this.F4c(da,O);break;case 541421805:case -569786022:l=this.ncd(n,O)}return l?
ug.Task.Ua(!0):kh.a(K)};qg.prototype.Jc=function(n,O,da){n=!1;switch(O.command){case 37023044:n=!!da;break;case 541421805:case -569786022:n=!0}return n};qg.prototype.ncd=function(n,O){var da=8===n,l=this.$,K=Jd.a(l),ka=te.g(l).ga.Sa.nc,$a=n=null;da&&K?(n=K.chartId,$a=K.hd):!da&&ka&&(n=ka.floatingObject.id,$a=ka.floatingObject.hd);return qg.hje($a,260)?(da={},l.gk(da),da.FirstColumn=da.FirstRow=-1,l={},$a=(l.rawEvent=null,l.pivotName=null,l.cell=da,l.requiresConfirmation=qg.hje($a,64),l.dataSourceIndex=
$a.ExternalSourceIndex,l),ka?(K=ka.floatingObject,$a.domElement=ka.domElement,$a.objectId=K.id,$a.objectVersion=K.version):K&&($a.domElement=K.Sj,$a.objectId=K.chartId,$a.objectVersion=K.dpe),ka={AnchorType:7},ka.ChartId=n,ka.AnchorValue1=-1,ka.AnchorValue2=-1,$a.optionalPivotMenuAnchorParameter=ka,this.F4c($a,O)):!1};qg.hje=function(n,O){return(n.Attributes&O)===O};Jl.Object.defineProperties(qg.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},RA:{configurable:!0,
enumerable:!0,get:function(){return ub.a.wBf}}});Object(hd.a)(qg,"PivotFilterContextMenu",Se,[]);var Rg=b(1255),Hh=b(959),Fg=b(149),Xg=b(43),cg=b(26),Mh=pa.a;Cm(Tc,Mh);Tc.prototype.executeCommand=function(n,O,da){O=O.command;n=null;this.grid=te.g(this.$);this.activeCell=jg.o(this.grid.ga.ya.activeCell,this.$);if(this.$.isEditMode&&(this.Zc=this.grid.kc.hq(this.grid.ga.ya.activeCell),!this.Zc))return Rc.ULS.sendTraceTag(593609111,0,10,"No PivotTable range found."),fe.TaskExtensions.P3();this.nxc=this.$.ra.xa;
this.PYa=Object(pf.a)(h.a,da.eventArgs);switch(O){case 671488277:!this.$.isEditMode||this.Zc.Hbc||this.Zc.Qid()&&!this.DRf(!1)?(this.v9a(),this.showPivotTableContextMenu()):this.HEh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.EPa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.EPa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.EPa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.EPa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.EPa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.EPa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:da=Number.parseInvariant(da.MenuItemId.split(".")[2]);this.EPa(11,da);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Re(-1556797033,Kg.a.Yb,8,null);break;case 1514686611:this.n$h();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:da=Number.parseInvariant(da.MenuItemId);this.wLg(da);break;case 1778578888:da=Number.parseInvariant(da.MenuItemId);this.Kxg(da);break;case 1771091375:break;default:n=kh.a(O)}return n||fe.TaskExtensions.P3()};Tc.prototype.Jc=function(n,O){n=
!1;switch(O.command){case 671488277:n=Hh.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:n=!0;break;case 1600778266:n=!0;break;case -556893687:n=!0;break;case -1966978671:n=!0;break;case -1951357930:n=!0;break;case -1390365353:case -1457478532:n=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:n=!0;break;
case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:n=!0;break;case -1007663920:case 234234584:case 1194992911:n=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:n=!0;break;case 1771091375:n=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return n};Tc.prototype.$c=function(n,O){var da=!1;switch(O){case -1007663920:case 234234584:da=
this.Dcj();break;case 1194992911:da=this.Ecj();break;case 1217404289:da=!Rg.j(this.Bb.LabelOrDateFilterType);break;case -743135194:da=!Rg.m(this.Bb.ValueFilterType)&&!Rg.l(this.Bb.ValueFilterType);break;case 771421327:da=!this.Bb.LabelOrDateFilterType&&!this.Bb.ValueFilterType&&!this.Bb.HasManualFilter;break;case 1015867427:da=!Rg.i(this.Bb.LabelOrDateFilterType);break;case 1105960559:da=!Rg.k(this.Bb.LabelOrDateFilterType)}return da||Mh.prototype.$c.call(this,n,O)};Tc.prototype.v9a=function(){this.X7a=
this.Bb=this.ag=null};Tc.prototype.rMd=function(){this.grid.LX(Object(Kc.a)(this,this.Ks,"onAfterAllBlocksUpdated"));this.$.Na.hEa(Object(Kc.a)(this,this.Ot,"onMenuClosed"))};Tc.prototype.VPd=function(){this.grid.$Q(Object(Kc.a)(this,this.Ks,"onAfterAllBlocksUpdated"));this.$.Na.c9a(Object(Kc.a)(this,this.Ot,"onMenuClosed"))};Tc.prototype.GGb=function(){if(this.Zc&&this.Zc.Go){this.ag=this.Zc.Go;this.Bb=this.Zc.t7b();if(this.tSf()){var n=this.Zc.vK[4===this.ag.CellType?this.Zc.H_c-1:this.ag.CurrentFieldIndex-
1];n&&(this.X7a=-2===n.Index?this.Zc.lxe:n.Caption)}this.HUh();this.Bb&&8===this.ag.CellArea&&(this.rz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Bb.DataFieldAggregationType,this.rz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Bb.DataFieldFormatType,this.rz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Bb.BaseFieldIndex,this.rz.PivotValueFieldTitle=this.Bb.Caption)}};Tc.prototype.DRf=function(n){if(!this.Zc)return!1;n=this.Zc.isOlap&&!this.Zc.H4a(!n);return fd.EwaSettings.ka(618)&&
n};Tc.prototype.Kcj=function(){var n=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?1!==this.Bb.MeasureType&&(!this.Zc.ujd||n&&2===this.Bb.MeasureType):!this.Zc.ujd||n&&this.Bb.IsImplicitMeasure};Tc.prototype.nY=function(){var n=this.Va.sp(this.menuId),O=this.Va.Vc();if(this.Zc)this.ag&&this.Zc.Go&&this.ag!==this.Zc.Go&&Rc.ULS.shipAssertTag(592545477,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),
this.Bb&&this.Bb!==this.Zc.t7b()&&Rc.ULS.shipAssertTag(592545476,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return n;this.Dqh(n);if(this.$.isEditMode){this.refresh&&this.Srh(n);if(this.ag&&this.Bb){var da=this.Va.Vc();this.fsh(da);this.Sqh(da);Array.add(n.Fc,da)}this.IY&&Array.add(O.buttons,this.Va.zb(99));this.ag&&this.Bb&&this.nrh(n);if(this.expandCollapse){da=this.Va.bA("ContextMenu.PivotExpandCollapse",null,Sd.a.instance.da(1098),589118293);var l=this.Va.Vc();Array.add(l.buttons,
this.Va.zb(240));Array.add(l.buttons,this.Va.zb(241));Array.add(l.buttons,this.Va.zb(242));Array.add(l.buttons,this.Va.zb(243));Array.add(da.menu.Fc,l);da&&0<l.buttons.length&&Array.add(O.buttons,da)}this.ag&&!this.ag.CellType&&fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.bsh(n);this.ag&&this.Trh(n);this.ag&&this.Bb&&8===this.ag.CellArea&&8!==this.ag.CellType&&(da=this.Va.Vc(),this.Kcj()&&this.hsh(da),3!==this.ag.CellType&&this.csh(da),Array.add(n.Fc,
da));fd.EwaSettings.ka(329)&&(this.m4h()?Array.add(O.buttons,this.Va.zb(254)):Array.add(O.buttons,this.Va.zb(255)));this.uhd?Array.add(O.buttons,this.Va.zb(59)):Array.add(O.buttons,this.Va.zb(58))}Array.add(n.Fc,O);return n};Tc.prototype.TJd=function(){return!this.Bb||mf.a.na(this.Bb.Caption)?!1:20<this.Bb.Caption.length};Tc.prototype.m9c=function(n){return!this.Bb||mf.a.na(this.Bb.Caption)?"":n?this.Bb.Caption.substring(0,20)+"...":this.Bb.Caption};Tc.prototype.Tta=function(n){return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?
mf.a.hashCode(n).toString():n};Tc.prototype.fsh=function(n){if(this.ag&&this.Bb&&4!==this.ag.CellArea){var O=this.yta(this.zG("PivotTableContextMenu.Sort",this.Tta(this.Bb.Caption)),-1777747317,0,!!this.Bb.SortInfo,Sd.a.instance.da(216)),da=this.Va.Vc();Array.add(da.buttons,this.ee("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Bb.SortInfo,Sd.a.instance.da(217)));Array.add(da.buttons,this.ee("PivotTableContextMenu.SortDescending",234234584,0,2===this.Bb.SortInfo,Sd.a.instance.da(218)));
1!==this.ag.CellArea&&2!==this.ag.CellArea||Array.add(da.buttons,this.ee("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Bb.SortInfo||4===this.Bb.SortInfo,Sd.a.instance.da(153)));Array.add(O.menu.Fc,da);O&&0<da.buttons.length&&Array.add(n.buttons,O)}};Tc.prototype.Sqh=function(n){if(this.ag&&this.Bb&&(1===this.ag.CellArea||2===this.ag.CellArea)){var O=this.Ydj(),da=this.yta(this.zG("PivotTableContextMenu.Filter",this.Tta(this.Bb.Caption)),-1777747317,0,O,Sd.a.instance.da(629)),l=this.Va.Vc(),
K="",ka=this.TJd(),$a=String.format(Sd.a.instance.Eb(155),this.m9c(ka));ka&&(K=String.format(Sd.a.instance.Eb(155),this.Bb.Caption));O=this.Tta(this.Bb.Caption)+"."+(O?"enabled":"disabled");K=this.ee(this.zG("PivotTableContextMenu.ClearFilter",O),771421327,0,!1,$a,"0",K,8,Df.a.F_a);O=this.Tta(this.Bb.Caption)+"."+this.Bb.LabelOrDateFilterType.toString();this.Bb.IsDateField?($a=this.yta(this.zG("PivotTableContextMenu.DateFilter",O),-1777747317,0,!!this.Bb.LabelOrDateFilterType,Sd.a.instance.da(94)),
this.Gqh($a.menu)):($a=this.yta(this.zG("PivotTableContextMenu.LabelFilter",O),-1777747317,0,!!this.Bb.LabelOrDateFilterType,Sd.a.instance.da(627)),this.mrh($a.menu));O=this.Tta(this.Bb.Caption)+"."+this.Bb.ValueFilterType.toString();O=this.yta(this.zG("PivotTableContextMenu.ValueFilter",O),-1777747317,0,!!this.Bb.ValueFilterType,Sd.a.instance.da(628));this.ush(O.menu);ka=this.Va.Vc();Array.add(ka.buttons,this.ee("PivotTableContextMenu.ManualFilter",1514686611,0,this.Bb.HasManualFilter,Sd.a.instance.da(91)));
Array.add(l.buttons,K);Array.add(l.buttons,$a);Array.add(l.buttons,O);Array.add(da.menu.Fc,l);Array.add(da.menu.Fc,ka);da&&0<l.buttons.length&&Array.add(n.buttons,da)}};Tc.prototype.Gqh=function(n){Array.add(n.Fc,this.Q7b(!0,!1));Array.add(n.Fc,this.xxh());Array.add(n.Fc,this.wxh());Array.add(n.Fc,this.kzh());Array.add(n.Fc,this.nzh());Array.add(n.Fc,this.lzh());Array.add(n.Fc,this.mzh());Array.add(n.Fc,this.ozh());Array.add(n.Fc,this.pzh());Array.add(n.Fc,this.lxh())};Tc.prototype.yqh=function(n){Array.add(n.Fc,
this.Q7b(!0,!0));Array.add(n.Fc,this.CFh());Array.add(n.Fc,this.bDh())};Tc.prototype.mrh=function(n){Array.add(n.Fc,this.Q7b(!0,!1));Array.add(n.Fc,this.aQe(!0));Array.add(n.Fc,this.fuh());Array.add(n.Fc,this.wwh());Array.add(n.Fc,this.aPe(!0));Array.add(n.Fc,this.jOe(!0))};Tc.prototype.ush=function(n){Array.add(n.Fc,this.Q7b(!1,!1));Array.add(n.Fc,this.aQe(!1));Array.add(n.Fc,this.aPe(!1));Array.add(n.Fc,this.jOe(!1));Array.add(n.Fc,this.EJh())};Tc.prototype.EJh=function(){var n=this.Va.Vc();Array.add(n.buttons,
this.ee("PivotTableContextMenu.Top10",-1611233597,0,Rg.l(this.Bb.ValueFilterType),Sd.a.instance.da(102)));return n};Tc.prototype.wwh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.Contains",786260386,0,10===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(630),"10")),Array.add(n.buttons,this.ee("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(631),"11")));return n};Tc.prototype.fuh=function(){var n=this.Va.Vc();
this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(632),"6")),Array.add(n.buttons,this.ee("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(633),"7")),Array.add(n.buttons,this.ee("PivotTableContextMenu.EndsWith",786260386,0,8===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(634),"8")),Array.add(n.buttons,this.ee("PivotTableContextMenu.DoesNotEndWith",786260386,
0,9===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(635),"9")));return n};Tc.prototype.aQe=function(n){var O=this.Va.Vc();if(this.Bb){var da=n?Rg.c:Rg.f;Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.Equals",da),786260386,0,n?4===this.Bb.LabelOrDateFilterType:18===this.Bb.ValueFilterType,Sd.a.instance.da(97),n?"4":"18"));Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.DoesNotEqual",da),786260386,0,n?5===this.Bb.LabelOrDateFilterType:19===this.Bb.ValueFilterType,Sd.a.instance.da(98),
n?"5":"19"))}return O};Tc.prototype.aPe=function(n){var O=this.Va.Vc();if(this.Bb){var da=n?Rg.c:Rg.f;Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.GreaterThan",da),786260386,0,n?12===this.Bb.LabelOrDateFilterType:20===this.Bb.ValueFilterType,Sd.a.instance.da(99),n?"12":"20"));Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.GreaterThanOrEqualTo",da),786260386,0,n?13===this.Bb.LabelOrDateFilterType:21===this.Bb.ValueFilterType,Sd.a.instance.da(636),n?"13":"21"));Array.add(O.buttons,
this.ee(this.zG("PivotTableContextMenu.LessThan",da),786260386,0,n?14===this.Bb.LabelOrDateFilterType:22===this.Bb.ValueFilterType,Sd.a.instance.da(100),n?"14":"22"));Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.LessThanOrEqualTo",da),786260386,0,n?15===this.Bb.LabelOrDateFilterType:23===this.Bb.ValueFilterType,Sd.a.instance.da(637),n?"15":"23"))}return O};Tc.prototype.jOe=function(n){var O=this.Va.Vc();if(this.Bb){var da=n?Rg.c:Rg.f;Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.Between",
da),786260386,0,n?16===this.Bb.LabelOrDateFilterType:24===this.Bb.ValueFilterType,Sd.a.instance.da(101),n?"16":"24"));Array.add(O.buttons,this.ee(this.zG("PivotTableContextMenu.NotBetween",da),786260386,0,n?17===this.Bb.LabelOrDateFilterType:25===this.Bb.ValueFilterType,Sd.a.instance.da(638),n?"17":"25"))}return O};Tc.prototype.Q7b=function(n,O){var da=this.Va.Vc();if(this.Bb){var l=Sd.a.instance.da(95),K=n?this.Bb.LabelOrDateFilterType.toString():this.Bb.ValueFilterType.toString(),ka=["PivotTableContextMenu.ClearFilter",
this.Tta(this.Bb.Caption),K];n=n?this.Bb.IsDateField?O?1015867427:1105960559:1217404289:-743135194;ka.push(n.toString());l=this.ee(ka.join("."),n,0,!1,l,K,l,8,Df.a.F_a);Array.add(da.buttons,l)}return da};Tc.prototype.xxh=function(){var n=this.Va.Vc();this.Bb&&Array.add(n.buttons,this.ee(this.zG("PivotTableContextMenu.Equals",Rg.d),786260386,0,26===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(97),"26"));return n};Tc.prototype.wxh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.Before",
786260386,0,27===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(109),"27")),Array.add(n.buttons,this.ee("PivotTableContextMenu.After",786260386,0,28===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(110),"28")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Between",786260386,0,29===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(101),"29")));return n};Tc.prototype.kzh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Bb.LabelOrDateFilterType,
Sd.a.instance.da(107),"30")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Today",1778578888,0,31===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(106),"31")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(108),"32")));return n};Tc.prototype.nzh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(112),
"33")),Array.add(n.buttons,this.ee("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(111),"34")),Array.add(n.buttons,this.ee("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(113),"35")));return n};Tc.prototype.lzh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(114),"36")),Array.add(n.buttons,
this.ee("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(115),"37")),Array.add(n.buttons,this.ee("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(116),"38")));return n};Tc.prototype.mzh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(117),"39")),Array.add(n.buttons,this.ee("PivotTableContextMenu.ThisQuarter",
1778578888,0,40===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(118),"40")),Array.add(n.buttons,this.ee("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(119),"41")));return n};Tc.prototype.ozh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.NextYear",1778578888,0,42===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(120),"42")),Array.add(n.buttons,this.ee("PivotTableContextMenu.ThisYear",1778578888,0,43===
this.Bb.LabelOrDateFilterType,Sd.a.instance.da(121),"43")),Array.add(n.buttons,this.ee("PivotTableContextMenu.LastYear",1778578888,0,44===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(122),"44")));return n};Tc.prototype.pzh=function(){var n=this.Va.Vc();if(this.Bb){Array.add(n.buttons,this.ee("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(123),"45"));var O=this.yta("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Rg.i(this.Bb.LabelOrDateFilterType),
Sd.a.instance.da(124));this.yqh(O.menu);Array.add(n.buttons,O)}return n};Tc.prototype.lxh=function(){var n=this.Va.Vc();this.Bb&&Array.add(n.buttons,this.ee("PivotTableContextMenu.CustomFilter",786260386,0,this.Vdj(this.Bb.LabelOrDateFilterType),Sd.a.instance.da(105),"26"));return n};Tc.prototype.CFh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(125),"46")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(126),"47")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(127),"48")),Array.add(n.buttons,this.ee("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(128),"49")));return n};Tc.prototype.bDh=function(){var n=this.Va.Vc();this.Bb&&(Array.add(n.buttons,this.ee("PivotTableContextMenu.January",1778578888,0,50===this.Bb.LabelOrDateFilterType,
Sd.a.instance.da(129),"50")),Array.add(n.buttons,this.ee("PivotTableContextMenu.February",1778578888,0,51===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(130),"51")),Array.add(n.buttons,this.ee("PivotTableContextMenu.March",1778578888,0,52===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(131),"52")),Array.add(n.buttons,this.ee("PivotTableContextMenu.April",1778578888,0,53===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(132),"53")),Array.add(n.buttons,this.ee("PivotTableContextMenu.May",1778578888,
0,54===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(133),"54")),Array.add(n.buttons,this.ee("PivotTableContextMenu.June",1778578888,0,55===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(134),"55")),Array.add(n.buttons,this.ee("PivotTableContextMenu.July",1778578888,0,56===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(135),"56")),Array.add(n.buttons,this.ee("PivotTableContextMenu.August",1778578888,0,57===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(136),"57")),Array.add(n.buttons,this.ee("PivotTableContextMenu.September",
1778578888,0,58===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(137),"58")),Array.add(n.buttons,this.ee("PivotTableContextMenu.October",1778578888,0,59===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(138),"59")),Array.add(n.buttons,this.ee("PivotTableContextMenu.November",1778578888,0,60===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(139),"60")),Array.add(n.buttons,this.ee("PivotTableContextMenu.December",1778578888,0,61===this.Bb.LabelOrDateFilterType,Sd.a.instance.da(140),"61")));return n};
Tc.prototype.nrh=function(n){var O=this.Va.Vc();if(this.tSf()){var da=this.Zc.vK[4===this.ag.CellType?this.Zc.H_c-1:this.ag.CurrentFieldIndex-1];if(da&&!mf.a.na(this.X7a)){var l=this.Va.bA("ContextMenu.PivotTableLayout",null,Sd.a.instance.da(625),-1777747317);var K=this.Va.Vc(),ka=String.format(Sd.a.instance.Eb(159),this.X7a),$a=String.format(Sd.a.instance.Eb(160),this.X7a);Array.add(K.buttons,this.ee("PivotTableContextMenu.LayoutNextColumn",-1457478532,0,!da.IsCompactLayout,ka));Array.add(K.buttons,
this.ee("PivotTableContextMenu.LayoutSameColumn",-1390365353,0,da.IsCompactLayout,$a));Array.add(l.menu.Fc,K);l&&Array.add(O.buttons,l)}}if(1===this.ag.CellArea||2===this.ag.CellArea)mf.a.na(this.Bb.Caption)||(da="",K=this.TJd(),l=String.format(Sd.a.instance.Eb(157),this.m9c(K)),K&&(da=String.format(Sd.a.instance.Eb(157),this.Bb.Caption)),1===this.ag.CellArea?(da=this.yta("ContextMenu.PivotTableSubtotal",1801458190,0,this.Bb.ShowSubtotal,l),l=this.Va.Vc(),Array.add(l.buttons,this.Va.zb(256)),Array.add(l.buttons,
this.ee("ContextMenu.PivotTableSubtotalOnTop",671485366,617,this.Bb.ShowSubtotal&&this.Bb.ShowSubtotalAtTop)),Array.add(l.buttons,this.ee("ContextMenu.PivotTableSubtotalOnBottom",772221736,618,this.Bb.ShowSubtotal&&!this.Bb.ShowSubtotalAtTop)),Array.add(da.menu.Fc,l),da&&0<l.buttons.length&&Array.add(O.buttons,da)):(K=K?this.zG("PivotTableContextMenu.Subtotal",this.Tta(l)):"PivotTableContextMenu.Subtotal",Array.add(O.buttons,this.ee(K,1801458190,0,this.Bb.ShowSubtotal,l,null,da)))),Array.add(O.buttons,
this.ee("ContextMenu.RepeatItemLabels",-556893687,620,this.Bb.RepeatItemLabels));1===this.ag.CellArea&&Array.add(O.buttons,this.ee("ContextMenu.PivotBlankLineAfterEachItem",1600778266,619,this.Bb.ShowBlankLineAfterEachItem));Array.add(n.Fc,O)};Tc.prototype.bsh=function(n){var O=this.Va.Vc();Array.add(O.buttons,this.Va.zb(244));Array.add(n.Fc,O)};Tc.prototype.Trh=function(n){var O="",da="",l=!1;3===this.ag.CellType?O=Sd.a.instance.da(622):8===this.ag.CellType?this.Zc&&(O=String.format(Sd.a.instance.Eb(158),
this.Zc.lxe)):this.Bb&&((l=this.TJd())&&(da=String.format(Sd.a.instance.Eb(158),this.Bb.Caption)),O=String.format(Sd.a.instance.Eb(158),this.m9c(l)));if(!mf.a.na(O)){var K=this.Va.Vc();l=l?this.zG("PivotTableContextMenu.RemoveField",this.Tta(O)):"PivotTableContextMenu.RemoveField";O=this.ee(l,-1951357930,0,!1,O,null,da,8,Df.a.a4c);Array.add(K.buttons,O);Array.add(n.Fc,K)}};Tc.prototype.Dqh=function(n){var O=this.Va.Vc();fd.EwaSettings.ka(491)&&Array.add(O.buttons,this.Va.zb(43));this.Bb&&this.ag&&
this.$.isEditMode&&(!this.ag.CellType||4===this.ag.CellType)&&Array.add(O.buttons,this.Va.zb(136));Array.add(n.Fc,O)};Tc.prototype.Srh=function(n){var O=this.Va.Vc();Array.add(O.buttons,this.Va.zb(100));Array.add(n.Fc,O)};Tc.prototype.hsh=function(n){var O=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?2===this.Bb.MeasureType&&!this.Bb.IsNumeric:this.Bb.IsImplicitMeasure&&!this.Bb.IsNumeric,da=this.Va.bA("ContextMenu.SummarizeValuesBy",null,Sd.a.instance.da(623),
-249874296),l=this.Va.Vc();Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesBySum",-1255320719,1037,!this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,O));Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByCount",1746132849,1038,1===this.Bb.DataFieldAggregationType));Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByAverage",-771066011,1039,2===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,O));Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByMax",
835007294,1040,3===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,O));Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByMin",929115636,1041,4===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,O));Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByProduct",1935475057,1042,5===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.DRf(!0)||O));(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?
2===this.Bb.MeasureType:this.Bb.IsImplicitMeasure)||(Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1043,6===this.Bb.DataFieldAggregationType)),Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByStdDeviation",588680636,1044,7===this.Bb.DataFieldAggregationType)),Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1045,8===this.Bb.DataFieldAggregationType)),Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByVariant",
1668427539,1046,9===this.Bb.DataFieldAggregationType)),Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1047,10===this.Bb.DataFieldAggregationType)));this.Zc&&this.Zc.Qid()&&Array.add(l.buttons,this.ee("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1048,11===this.Bb.DataFieldAggregationType));Array.add(da.menu.Fc,l);Array.add(n.buttons,da)};Tc.prototype.csh=function(n){var O=this.Va.bA("ContextMenu.ShowValuesAs",null,Sd.a.instance.da(624),-1128612833),
da=this.Va.Vc();Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsNoCalculation",-841863025,1054,!this.Bb.DataFieldFormatType));Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1061,7===this.Bb.DataFieldFormatType));Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1060,6===this.Bb.DataFieldFormatType));Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1059,5===this.Bb.DataFieldFormatType));
Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1064,9===this.Bb.DataFieldFormatType));Array.add(da.buttons,this.ee("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1065,10===this.Bb.DataFieldFormatType));if(this.Zc&&this.Zc.vK&&0<this.Zc.vK.length||this.Zc.v9&&0<this.Zc.v9.length){for(var l=this.yta("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1066,11===this.Bb.DataFieldFormatType),K=this.Va.Vc(),ka=this.gsh(),$a=0;$a<ka.length;$a++){var Lb=
ka[$a];Array.add(K.buttons,this.ee("ContextMenu.ShowValuesAsPercentOfParentTotal."+Lb.Caption,-2031744961,1066,11===this.Bb.DataFieldFormatType&&this.Bb.BaseFieldIndex===Lb.Index,Lb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Lb.Index))}Array.add(l.menu.Fc,K);Array.add(da.buttons,l)}Array.add(O.menu.Fc,da);Array.add(n.buttons,O)};Tc.prototype.showPivotTableContextMenu=function(){this.uhd=!0;this.expandCollapse=this.IY=this.refresh=!1;var n=this.$,O=te.g(n),da=Ef.a(n).PIa();if(da){var l=
Ld.a(n);l&&l.mJd&&(this.uhd=md.f(n.sg));l=n.mc;this.IY=da.supportsBIExplore&&!!vc.a(n)&&l.N1(32768);l.allowInteractivity&&((n=O.Cc(null))&&n.cell&&(n.cell.STc||n.cell.rSf)&&(this.expandCollapse=!0),l.allowManualDataRefresh&&(this.refresh=!0))}n=null;da=1;this.PYa&&1!==this.PYa.Cb?(n=new Sys.UI.Point(this.PYa.clientPoint.x,this.PYa.clientPoint.y),da=this.PYa.Cb):(O=Hh.e(O,this.$))&&(n=new Sys.UI.Point(O.x+(this.$.isChromeRtl?0:O.width),O.y+O.height));Kg.a.Yb=da;this.zdc=3===da;this.Ln(n,!0,da);this.waa=
!0;this.rMd()};Tc.prototype.dRh=function(){var n=new ig.a(1114549926,0,this.$.jd,19,null);this.$.Na.Xb(n)};Tc.prototype.HEh=function(){var n=this;if(this.Zc&&this.Zc.Go){var O=this.Zc.Go.CurrentCol;if(this.Zc.Go.CurrentRow===this.activeCell.FirstRow&&O===this.activeCell.FirstColumn){this.GGb();this.showPivotTableContextMenu();return}}O=new bh.a(228,0,function(da,l,K){return nf.B(n.$.ra.xa,n.activeCell,Lf.b(da,Object(Kc.a)(n,n.jti,"onGetPivotTableCellInfoSuccessCallback")),Lf.a(l,Object(Kc.a)(n,n.iti,
"onGetPivotTableCellInfoFailedCallback")),K,null)},16);this.$.userOperationManager.oc(O,null)};Tc.prototype.jti=function(n){n&&!qd.a.eh(n.Errors)&&this.Zc&&(this.Zc.Go=n.Result,this.GGb());this.showPivotTableContextMenu()};Tc.prototype.iti=function(){};Tc.prototype.m4h=function(){if(Xg.a.Sd(this.$)){var n=this.$.ea.Ea(441,void 0);if(n)return n.Dr}else if(n=this.$.ea.Ea(346,void 0))return n.Dr;return!1};Tc.prototype.zG=function(n,O){return n+"."+O};Tc.prototype.performPivotTableOperation=function(n,
O){var da=this,l=cg.a.Ta.Lb;if(!this.Zc||!this.Bb&&this.ag&&3!==this.ag.CellType)this.ki();else{var K=this.Zc.isOlap;Ef.a(this.$).Hv(K,function(ka){ka&&da.$.oc(n,function($a,Lb,bc){if(fd.EwaSettings.ka(534)){var Dc=da.nxc,wd=da.activeCell,ke=da.Bb?da.Bb.Caption:null,jf=da.X7a;$a=Lf.b($a,Object(Kc.a)(da,da.Uwi,"onPerformPivotTableOperationSuccessCallback"));Lb=Lf.a(Lb,Object(Kc.a)(da,da.Twi,"onPerformPivotTableOperationFailedCallback"));var Xf=da.$.ra.xa.dc();Xf=Dc.Ra(41,void 0===Xf?null:Xf);Xf.activeCell=
wd;Xf.operationType=O;Xf.fieldCaption=ke;Xf.prevFieldCaption=jf;bc=nf.i(Dc,"ExecutePivotTableOperation",Xf,$a,Lb,bc,null,0)}else Dc=da.nxc,wd=da.activeCell,ke=da.$.ra.xa.dc(),ke=Dc.Ra(41,void 0===ke?null:ke),ke.activeCell=wd,ke.operationType=O,bc=nf.i(Dc,"PerformPivotTableOperation",ke,$a,Lb,bc,null,0);return bc},l,0,4,229)})}};Tc.prototype.Uwi=function(){this.v9a()};Tc.prototype.Twi=function(){this.v9a()};Tc.prototype.applyValueFieldSettingsToPivotTable=function(n,O){var da=this;O=void 0===O?!1:
O;var l=cg.a.Ta.Lb;this.Zc&&this.Bb?(O&&(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5596739_AddMeasureTypeToPivotTableFieldInfo")?2===this.Bb.MeasureType:this.Bb.IsImplicitMeasure)&&Rc.ULS.sendTraceTag(556340814,0,50,"change aggregation type for an implicit measure from right click context menu."),O=this.Zc.isOlap,Ef.a(this.$).Hv(O,function(K){K&&da.$.oc(n,function(ka,$a,Lb){var bc=da.nxc,Dc=da.activeCell,wd=da.rz;ka=Lf.b(ka,Object(Kc.a)(da,da.joi,"onApplyValueFieldSettingsToPivotTableSuccessCallback"));
$a=Lf.a($a,Object(Kc.a)(da,da.ioi,"onApplyValueFieldSettingsToPivotTableFailedCallback"));var ke=da.$.ra.xa.dc();ke=bc.Ra(41,void 0===ke?null:ke);ke.activeCell=Dc;ke.pivotValueFieldSettingsApplyData=wd;return nf.i(bc,"ApplyValueFieldSettingsToPivotTable",ke,ka,$a,Lb,null,0)},l,0,4,231)})):this.ki()};Tc.prototype.joi=function(){this.v9a()};Tc.prototype.ioi=function(){this.v9a()};Tc.prototype.ee=function(n,O,da,l,K,ka,$a,Lb,bc,Dc){K=void 0===K?null:K;ka=void 0===ka?null:ka;$a=void 0===$a?null:$a;Lb=
void 0===Lb?8:Lb;bc=void 0===bc?null:bc;Dc=void 0===Dc?!1:Dc;l&&(n+=".Checked");Dc&&(n+=".Disabled");this.Va.kgd(n)&&this.Va.iBd(n);da=mf.a.na(K)?Sd.a.instance.da(da):K;n=this.Va.TFa(n,da,O,null,"None",ka,Dc,null);n.oqc(null);mf.a.na($a)||n.kR($a);l?n.mR("Image16by16",3,Df.a.i$):bc?n.mR("Image16by16",Lb,bc):n.uZb();return n};Tc.prototype.yta=function(n,O,da,l,K){K=void 0===K?null:K;da=mf.a.na(K)?Sd.a.instance.da(da):K;this.Va.kgd(n)?this.Va.iBd(n):this.Va.iBd(n+".Checked");l&&(n+=".Checked");this.pcj&&
(da=this.f5g.parseFromString(da,"text/html").body.innerText);n=this.Va.QYc(n,null,da,O,3,Df.a.i$);n.w0e=l;!l&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&n.uZb();return n};Tc.prototype.HUh=function(){this.rz=Object.assign(new ee,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new Fa,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object.assign(new pc,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};
Tc.prototype.EPa=function(n,O){this.rz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=n;this.rz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=O;this.rz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Tc.prototype.gsh=function(){var n=[];if(this.Zc&&this.Zc.v9&&0<this.Zc.v9.length)for(var O=Ml(this.Zc.v9),da=O.next();!da.done;da=O.next())(da=da.value)&&Array.add(n,da);if(this.Zc&&this.Zc.vK&&0<this.Zc.vK.length)for(O=Ml(this.Zc.vK),da=O.next();!da.done;da=O.next())(da=da.value)&&
Array.add(n,da);n.sort(function(l,K){return l.Index-K.Index});return n};Tc.prototype.tSf=function(){if(!this.ag||!this.Zc||!this.Zc.vK)return!1;var n=1===this.ag.CellArea||4===this.ag.CellType&&this.ag.IsRowAxis,O=4===this.ag.CellType?0<this.Zc.H_c:0<this.ag.CurrentFieldIndex;return 1<this.Zc.vK.length&&n&&O};Tc.prototype.wIa=function(n){var O=[];3===n?this.$.isEditMode?Array.addRange(O,[I.a.wwf,I.a.ywf,I.a.zFi]):Array.addRange(O,[I.a.copy]):2===n&&Array.add(O,I.a.Doe);return O};Tc.prototype.ki=function(){var n=
qd.a.Ad(1,0,0,626,0,104573951,"PivotTableContextMenuOperationFailure");V.a(this.$).ki(n)};Tc.prototype.Ot=function(){this.VPd();this.waa=!1};Tc.prototype.Ks=function(){if(this.waa){Rc.ULS.sendTraceTag(592048344,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var n=this.Zc;this.grid.kc.hq(this.grid.ga.ya.activeCell)!==n&&(this.v9a(),this.dRh())}};Tc.prototype.Ydj=function(){return this.Bb?!!this.Bb.LabelOrDateFilterType||!!this.Bb.ValueFilterType||
this.Bb.HasManualFilter:!1};Tc.prototype.Vdj=function(n){return 62<=n&&65>=n};Tc.prototype.n$h=function(){if(this.activeCell&&this.Bb&&this.Zc){var n={};n.cell=this.activeCell;n.dataSourceIndex=this.Zc.externalSourceIndex;n.fieldId=this.Bb.Index.toString();n.isOlap=this.Zc.isOlap;n.confirmationRequired=this.Zc.confirmationRequiredForDataOps;this.$.Re(492140419,Kg.a.Yb,19,{showPivotFilterDialogCommandData:n})}};Tc.prototype.wLg=function(n){var O=this;this.activeCell&&this.Bb&&this.Zc&&this.$.userOperationManager.oc(new bh.a(153,
0,function(da,l,K){return nf.W(O.$.ra.xa,O.activeCell,O.Zc.externalSourceIndex,O.Bb.Index.toString(),n,da,l,K,null,null)}),null)};Tc.prototype.Kxg=function(n){var O=this;!(30>n||61<n)&&this.activeCell&&this.Bb&&this.Zc&&this.$.userOperationManager.oc(new bh.a(152,0,function(da,l,K){return nf.g(O.$.ra.xa,O.activeCell,O.Zc.externalSourceIndex,O.Bb.Index.toString(),n,da,l,K,null,null)}),null)};Tc.prototype.applyPivotSort=function(n){var O=this;if(this.Zc&&this.Bb&&this.activeCell&&this.ag){var da=1===
this.ag.CellArea||2===this.ag.CellArea;8===this.ag.CellArea?hg.a(this.$.userOperationManager,function(l,K,ka){return nf.e(O.$.ra.xa,O.activeCell,n,O.Bb.Caption,l,K,ka,null)},function(l){return new bh.a(1015,0,l,void 0,null)},null):da&&(da=1===this.ag.CellArea?1:2,this.$.ka(750)?Fg.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Zc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Zc.isOlap?"":this.Bb.Caption,da,1===n):Fg.a.aps(this.$.domElement,this.activeCell.FirstRow,
this.activeCell.FirstColumn,this.Zc.externalSourceIndex,this.Bb.Index.toString(),1===n))}};Tc.prototype.Dcj=function(){return(this.ag||this.Zc)&&4!==this.ag.CellType&&(this.ag.CellType||8!==this.ag.CellArea||this.Zc.v9&&this.Zc.v9.length||this.Zc.vK&&this.Zc.vK.length)?!1:!0};Tc.prototype.Ecj=function(){return this.ag&&this.Zc&&(1===this.ag.CellArea||2===this.ag.CellArea)&&this.Zc.eLb&&this.Zc.eLb.length?!1:!0};Jl.Object.defineProperties(Tc.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},
RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.xBf}}});Object(hd.a)(Tc,"PivotTableContextMenu",pa.a,[]);var Nh=b(255),zd=pa.a;Cm(Ud,zd);Ud.prototype.executeCommand=function(n,O,da){n=O.command;switch(n){case 639960842:this.applyTableFieldList(da);this.JV.vca();break;case -1085236154:da=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Hrd);Rc.ULS.sendTraceTag(38887747,0,50,da);this.JV.vca();break;case 1833782813:this.JV.showCallout();
break;default:return kh.a(n)}return ug.Task.Ua(!0)};Ud.prototype.applyTableFieldList=function(n){var O=n.MenuItemId.toString();fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(O=O.replace("'","''"),O=O.replace("[","'["),O=O.replace("]","']"));var da=Object(pf.a)(String,n.SourceControlId),l={};l.PulloutField=O;l.PulloutCardPath=n.SourceCardKeyPath;l.PulloutCardSourceRow=n.SourceCardRow;l.PulloutCardSourceColumn=n.SourceCardColumn;if(this.JV.vM){Rc.ULS.sendTraceTag(38887748,
0,50,"Table Pullout operation started");l.ParameterType=2;n=n.ColumnIndex;if(void 0===n||null===n){if(void 0===da||null===da){Rc.ULS.shipAssertTag(41756296,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}n=parseInt(da.substring(20+O.length+1,da.length));if(isNaN(n)){O=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",da);Rc.ULS.shipAssertTag(38887750,0,!1,O);return}}l.PulloutRichColumnSourceIndex=
n;if(this.ARb.tvg){this.jwg(O,l);return}}else Rc.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),l.ParameterType=4,da=this.JV.selectedRange.right,void 0!==l.PulloutCardSourceColumn&&null!==l.PulloutCardSourceColumn&&(da=l.PulloutCardSourceColumn+1),l.PulloutRichColumnSourceIndex=da;this.gHd(O,l)};Ud.prototype.gHd=function(n,O,da){da=void 0===da?0:da;var l=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Hrd,O.PulloutRichColumnSourceIndex);
Rc.ULS.sendTraceTag(38887751,0,50,l);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",O.ParameterType,O.PulloutRichColumnSourceIndex);n=Object.assign(new Nh.a,{Text:n});this.grid.setCell(n,this.JV.Bwa,0,127,O,da);this.grid.focus();this.$0b=null;this.JV.vca();this.JV.RYi()};Ud.prototype.Jc=function(n,O,da){if(n=this.$.isEditMode&&fd.EwaSettings.ka(138)&&!!this.JV)switch(O.command){case -1085236154:break;case 639960842:n=!!da;
break;case 1833782813:n=this.JV.Yua&&this.JV.Rxb;break;default:n=!1}return n};Ud.prototype.AN=function(n,O,da){this.$.isEditMode&&(this.$0b=this.vrh(Object(pf.a)(375,da)),zd.prototype.AN.call(this,n,O,null,null,!1))};Ud.prototype.nY=function(){return this.$0b};Ud.prototype.OYc=function(n){if(!this.JV||!n||!n.Al)return Rc.ULS.shipAssertTag(38887753,0,!!this.JV,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Rc.ULS.shipAssertTag(38887754,0,!!n,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),
n&&Rc.ULS.shipAssertTag(38887755,0,!!n.Al,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var O=new Aa.a;n=Ml(n.Al);for(var da=n.next();!da.done;da=n.next()){var l=da.value;da=new Aa.a;da.add(l.ColumnName);da.add(l.ColumnIndex.toString());var K=new Aa.a;K=Vf.OBc(Vf.concat(K,Vf.select(Vf.asEnumerable(l.FieldInfoDataList),function(ka){return ka.Name})),function(ka){return ka},new vf);l=new Aa.a;l.add(Vf.toArray(Vf.concat(da,K)));O=Vf.toList(Vf.concat(O,
l))}return Vf.toArray(O)};Ud.prototype.vrh=function(n){var O=this.OYc(n);if(!O||!O.length)return this.$0b=null;var da=this.Va;n=da.Vc();var l=1<O.length;this.Hrd=O.length;O=Ml(O);for(var K=O.next();!K.done;K=O.next()){var ka=K.value;l||(n.title=ka[0]);K=da.Vc();for(var $a=2,Lb=ka.length;$a<Lb;++$a)Array.add(l?K.buttons:n.buttons,da.TFa("ApplyTableFieldList."+ka[$a]+"."+ka[1],ka[$a],639960842,null,"None",ka[$a],!1,void 0,!0));l&&(ka=da.bA("ApplyTableFieldList."+ka[0],this.menuId,ka[0],798637440),Array.add(ka.menu.Fc,
K),Array.add(n.buttons,ka))}da=da.sp(this.menuId);Array.add(da.Fc,n);return da};Ud.prototype.jwg=function(n,O){var da=this,l=qd.a.Ad(12,1,0,859,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(fd.EwaSettings.rC()){var K=new Wg.a(this.$,l);K.BO(function(){2===K.returnValue&&da.gHd(n,O,8)})}else{var ka=new ch.ErrorDialog(this.$,l);ka.BO(function(){2===ka.returnValue&&da.gHd(n,O,8)});ka.Bf()}};Jl.Object.defineProperties(Ud.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},
RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.zBf}},JV:{configurable:!0,enumerable:!0,get:function(){this.ARb||(this.ARb=this.$.ea.Ea(261,void 0));return this.ARb}}});Object(hd.a)(Ud,"PulloutFieldListContextMenu",pa.a,[]);var li=pa.a;Cm(Yg,li);Yg.prototype.Jc=function(n,O,da){return-1687037502===O.command&&!!da&&this.grid.isEditing};Yg.prototype.executeCommand=function(n,O,da){this.showRichTextFloatie(da);return ug.Task.Ua(!0)};Yg.prototype.wIa=function(){return[I.a.aJg]};Yg.prototype.showRichTextFloatie=
function(n){var O=Object(pf.a)(h.a,n.eventArgs);O&&(n=this.wIa(O.Cb),O=new Sys.UI.Point(O.Ga.clientX,O.Ga.clientY),this.showFloatie(n,new Sys.UI.Bounds(O.x,O.y,0,0),2))};Jl.Object.defineProperties(Yg.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.kNi}}});Object(hd.a)(Yg,"RichTextContextMenu",pa.a,[]);var fg=b(95),Si=pa.a;Cm(eg,Si);eg.prototype.executeCommand=function(n,O,da){if(Na.a(this.$))return ug.Task.Ua(!0);
this.$.isEditMode&&(n=da[ub.a.Cbj],n=n.x&&n.y?new Sys.UI.Point(n.x+(this.$.isChromeRtl?10:-10),n.y):je.DOMElementExtensions.getLocation(da[ub.a.Dbj]),this.Ln(n,!1));return ug.Task.Ua(!0)};eg.prototype.Jc=function(n,O,da){return-1075099431===O.command&&!!da};eg.prototype.nY=function(){var n=this.Va.sp(this.menuId),O=this.$.isEditMode;this.Byj();this.irh(n,O);this.Zqh(n);this.ash(n);return n};eg.prototype.aVb=function(n,O,da,l){Array.add(n,this.Va.zb(O?da:l))};eg.prototype.irh=function(n,O){var da=
this.Va,l=da.Vc();Array.add(l.buttons,da.zb(54));this.aVb(l.buttons,this.qdc,127,56);Array.add(l.buttons,da.zb(55));O&&this.aVb(l.buttons,this.qdc,126,125);Array.add(l.buttons,da.zb(158));this.$.fa.rHb&&(O=Object(pf.a)(fg.a,this.$.sa))&&Zf.q(O)&&(Array.add(l.buttons,da.zb(274)),O.isLockPausedInSession?Array.add(l.buttons,da.zb(276)):O.vj&&Array.add(l.buttons,da.zb(275)));O=da.bA("ContextMenu.TabColor",null,Sd.a.instance.da(496),1841703919);da=da.KYc(467002767,1549407384,519,-221093529,this.RA);Array.add(O.menu.Fc,
da);Array.add(l.buttons,O);Array.add(n.Fc,l)};eg.prototype.Zqh=function(n){var O=this.Va.Vc();this.aVb(O.buttons,this.qdc,114,112);this.aVb(O.buttons,!this.Xbc,115,113);Array.add(n.Fc,O)};eg.prototype.ash=function(n){if(fd.EwaSettings.ka(510)&&!Zf.e(this.$.Aa.sa)){var O=this.Va,da=O.Vc();Array.add(da.buttons,O.zb(260));Array.add(n.Fc,da)}};eg.prototype.Byj=function(){var n=this.$.rYc();var O=n.sYc;n=n.fue;this.qdc=1===O;this.Xbc=0<n};Jl.Object.defineProperties(eg.prototype,{Rt:{configurable:!0,enumerable:!0,
get:function(){return"PopulateSheetOpsContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.BBf}}});Object(hd.a)(eg,"SheetOpsContextMenu",pa.a,[]);var uj=b(524),$i=pa.a;Cm(ng,$i);ng.prototype.$c=function(n,O){var da=!0;switch(O){case -231711729:da=!1;break;case -1909381757:da=this.O8b();da=!!da&&da.q1h;break;case 1312363469:da=fd.EwaSettings.ka(474)}return!da||$i.prototype.$c.call(this,n,O)};ng.prototype.executeCommand=function(n,O,da){if(!this.$.isEditMode)return fe.TaskExtensions.P3();
n=O.command;O=this.O8b();var l=null;switch(n){case 2108047455:O&&O.Cqe();break;case -231711729:Rc.ULS.shipAssertTag(51689612,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:O&&O.BZb();break;case 1312363469:this.showSlicerContextMenu(da);break;default:l=kh.a(n)}return l||fe.TaskExtensions.P3()};ng.prototype.Jc=function(n,O,da){n=!1;switch(O.command){case -231711729:case 2108047455:case -1909381757:n=!0;break;case 1312363469:n=fd.EwaSettings.ka(474)&&!!da}return n};ng.prototype.nY=
function(){var n=this.Va.sp(this.menuId),O=this.Va.Vc();Array.add(O.buttons,this.Va.zb(249));fd.EwaSettings.ka(513)&&Array.add(O.buttons,this.Va.zb(250));Array.add(O.buttons,this.Va.zb(251));Array.add(n.Fc,O);O=this.Va.Vc();this.l6h()?Array.add(O.buttons,this.Va.zb(263)):Array.add(O.buttons,this.Va.zb(264));Array.add(n.Fc,O);return n};ng.prototype.l6h=function(){if(Xg.a.Sd(this.$)){var n=this.$.ea.Ea(439,void 0);if(n)return n.Dr}else if(n=this.$.ea.Ea(371,void 0))return n.Dr;return!1};ng.prototype.showSlicerContextMenu=
function(n){var O=Object(pf.a)(h.a,n.eventArgs);n=this.n7b(Object(pf.a)(h.a,n.eventArgs));O=O.Cb;Kg.a.Yb=O;this.Ln(n,!1,O)};ng.prototype.nNe=function(n){var O=this.Va.Vc(),da=this.Va.Vc();Array.add(da.buttons,this.Va.zb(252));Array.add(da.buttons,this.Va.zb(253));var l=this.Va.QYc("ContextMenu.SlicerSort",null,Sd.a.instance.da(2078),-814639094,0,Df.a.oGe);Array.add(l.menu.Fc,da);Array.add(O.buttons,l);Array.add(n.Fc,O)};ng.prototype.nej=function(n){return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
n.Wb.className===Df.a.PFe||fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===n.Cb};ng.prototype.n7b=function(n){var O=te.g(this.$).ga.Sa.nc,da=n&&1!==n.Cb&&n.clientPoint?n.clientPoint:Sys.UI.DomElement.getLocation(O.domElement);if(this.nej(n)){var l=this.O8b();l&&(n.Wb.className===Df.a.PFe&&(da=Z.HelperMethods.Xrb(n.Ga)),1===n.Cb&&(da=ze.a(this.$).NIa(je.DOMElementExtensions.getLocation(l.frame))))}else if(n=this.O8b())n=this.hAh(n.frame),(l=Z.HelperMethods.mA(this.$.gf,
this.$.domElement,te.g(this.$).rtl,!1))?(n.x=ze.a(this.$).Ci(n.x-l.x)+l.x,n.y=ze.a(this.$).Ci(n.y-l.y)+l.y):Rc.ULS.sendTraceTag(591160085,0,15,"Cannot get constant pane size."),da.y+=n.y,da.x+=n.x;n=this.$.domElement;l=te.g(this.$).rtl;O=Z.HelperMethods.mA(O.Ig.domElement,n,l);da.y=Math.max(da.y,O.y);da.x=Math.max(da.x,O.x);return da};ng.prototype.O8b=function(){var n=te.g(this.$).ga.Sa.nc;Rc.ULS.shipAssertTag(51689613,0,!!n);return uj.a(this.$).jC(n.floatingObject.id)};ng.prototype.hAh=function(n){var O=
new Sys.UI.Point(n.offsetParent.offsetLeft,n.offsetParent.offsetTop),da=te.g(this.$);if(!da)return O;var l=te.g(this.$).rtl;O=Z.HelperMethods.mA(n,this.$.sr.ownerDocument.body,l);da.Wte(O);O.x=l?this.$.sr.clientWidth-O.x-n.clientWidth:O.x;n=da.view.Zlb;da=l?-da.oN.iba(n.x):n.x;O.x-=da;O.y-=n.y;return O};Jl.Object.defineProperties(ng.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},RA:{configurable:!0,enumerable:!0,get:function(){return ub.a.CBf}}});Object(hd.a)(ng,
"SlicerContextMenu",pa.a,[]);Object(hd.a)(Eg,"TimeSlicerRibbonButtonParameter",null,[]);var ai=pa.a;Cm(hh,ai);hh.prototype.executeCommand=function(n,O,da){n=O.command;switch(n){case 2000085697:n=da.DOMElement;this.kra=da.ChangeLevelCallback;this.GIa=da.GetLevelLabelCallback;this.mZa=da.CurrentLevel;var l=da.DomEvent;Sh.g(l);var K=da.location;da=da.levelLabelText;this.CBe=je.DOMElementExtensions.Py(document.activeElement,"iframe")&&da?da.parentNode:null;da=Sys.UI.DomElement.getBounds(da);da.x=K.x;
da.y=K.y;this.AN(l,n,da,O,!0);break;case -649826274:this.kra(0);break;case 149600865:this.kra(1);break;case -2012435159:this.kra(2);break;case -1979934975:this.kra(3);break;case 1634477200:je.DOMElementExtensions.setFocus(this.CBe);break;default:return kh.a(n)}return ug.Task.Ua(!0)};hh.prototype.Jc=function(n,O,da){n=!1;switch(O.command){case 2000085697:n=!!da;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:n=!0}return n};hh.prototype.AN=function(n,O,da){n=Sys.UI.DomElement.getBounds(O);
da.x=ze.a(this.$).Ci(da.x);da.y=ze.a(this.$).Ci(da.y);n.x=ze.a(this.$).Ci(n.x);n.y=ze.a(this.$).Ci(n.y);n=new Sys.UI.Point(n.x+da.x,n.y+da.y);this.vRa(n,O);this.showContextMenu(new Sys.UI.Bounds(n.x,n.y-da.height,da.width,da.height))};hh.prototype.nY=function(){for(var n=this.Va,O=n.sp(this.menuId),da=n.Vc(),l=0;3>=l;l++){var K=this.GIa(l),ka=hh.Luh(l);ka=n.QRg(ka.YPg,ka.Yo,this.mZa===l,hh.Hpe);ka.label=K;ka.kR(K);this.mZa===l?ka.mR("Image16by16",8,hh.Hpe):ka.uZb();Array.add(da.buttons,ka)}Array.add(O.Fc,
da);return O};hh.Luh=function(n){var O=null;switch(n){case 0:O=new Eg(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:O=new Eg(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:O=new Eg(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:O=new Eg(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return O};Jl.Object.defineProperties(hh.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},RA:{configurable:!0,enumerable:!0,
get:function(){return ub.a.FBf}}});hh.vpj="TimeSlicerLevelMenu";hh.uFb="TimeSlicerLevelMenuRootName";hh.Hpe="ewamenu_CheckmarkApplied";Object(hd.a)(hh,"TimeSlicerLevelMenu",pa.a,[]);var Q=b(307),ra=b(218),mb=b(3),Qb=of.a;Cm(Of,Qb);Of.prototype.Rd=function(){var n=this,O=this.$,da=ra.a.dZa($d.b(),this.ma,"Task","IRootUser"),l=Ag.a(O),K=null;K=function(Lb,bc){l.LFf(K);da.setResult(bc.K_b)};l.vfe(K);l.QSe();var ka=Nf.GetServiceTaskFactory.create(O.ea,102,O.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),
$a=Nf.GetServiceTaskFactory.Xa(O.ea,342,338,this.vb,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([da.task,ka,$a],this.ma),function(){var Lb=ka.result,bc=da.task.result,Dc=$a.result;n.Hd([new Hc(O,bc,Lb,Dc),new Uf(O,bc,Lb,Dc),new df(O,bc,Lb,Dc),new xf(O,bc,Lb,Dc),new Lg(O,bc,Lb,Dc),new bf(O,bc,Lb,Dc),new Qg.GridContextMenu(O,bc,Lb,Dc),new qg(O,bc,Lb,Dc),new eg(O,bc,Lb,Dc),new hh(O,bc,Lb,Dc),new Ud(O,bc,Lb,Dc),new If(O,bc,Lb,Dc),
new Tc(O,bc,Lb,Dc),new ng(O,bc,Lb,Dc),new Yg(O,bc,Lb,Dc)])},O.ma,3)};Of.initData=function(){var n=Q.a.IX;n(2000085697,20479,0,0);n(-227942804,mb.a.Nc|24576,0,0);n(1634477200,mb.a.Nc|131072,0,0);n(-649826274,4095,0,0);n(149600865,4095,0,0);n(-2012435159,4095,0,0);n(-1979934975,4095,0,0);n(1247109494,mb.a.Nc|24576,0,0);n(-2064931494,mb.a.Nc|131072,0,0);n(-1396319072,mb.a.Ma,128,0);n(-425234874,mb.a.Ma,128,0);n(-1253126584,mb.a.Ma,0,0);n(274207288,mb.a.Nc|24576,0,0);n(-1497523576,mb.a.Nc|131072,0,0);
n(-498523270,mb.a.Nc|24576,64,0);n(1640762262,mb.a.Nc|131072,64,0);n(-2017893763,mb.a.Nc|24576,0,0);n(1350204367,mb.a.Nc|131072,0,0);n(-889576107,mb.a.Ev,128,0);n(-1170196828,mb.a.Ev,128,0);n(389774337,mb.a.Ev,128,0);n(1529312473,mb.a.Ev,128,0);n(2033235475,mb.a.Ev,128,0);n(-96230454,mb.a.Ev,128,0);n(74086617,mb.a.Ev,128,0);n(563292088,mb.a.Ev,128,0);n(-1092351914,mb.a.Ev,128,0);n(-2141589616,mb.a.Ev|16384,128,0);n(745182485,mb.a.Ev,0,0);n(359279088,mb.a.Ev,128,0);n(-67292059,mb.a.Ev,128,0);n(926905850,
mb.a.Ev,128,0);n(547535945,mb.a.Ev,128,0);n(1374696078,mb.a.Nc|24576,0,0);n(495005930,mb.a.Nc|212992,0,0);n(-1045020714,mb.a.Nc|24576,0,0);n(-170383950,mb.a.Nc|212992,0,0);n(324156914,mb.a.Ma,0,0);n(-1085236154,mb.a.qu,0,0);n(-751848458,mb.a.gl|16384,0,0);n(216058793,mb.a.qu,0,0);n(474690375,mb.a.gl|16384,0,0);n(-1920954846,mb.a.Nc|24576,0,0);n(723126814,mb.a.Nc|131072,0,0);n(2108047455,128,128,0);n(-231711729,128,128,0);n(-1909381757,128,128,0);n(-814639094,128,128,0);n(1701016594,mb.a.Nc|3072,128,
0);n(-1475408662,mb.a.Nc|24576,0,0);n(1114549926,mb.a.Nc|131072,32,0)};Of.la=function(n){of.a.ie(10,new Of(n))};Object(hd.a)(Of,"ContextMenuCommandHandlerFactory",of.a,[]);var Sc=b(211),Ad=b(1349),ye=b(97),Ze=b(248);Kf.prototype.dispose=function(){};Kf.prototype.V9=function(){this.Unb.P2()};Kf.prototype.aC=function(){this.Unb.aC()};Kf.prototype.hKd=function(n,O,da){Hh.h(this.$,Hh.b);this.Unb.showContextMenu(Object.assign(new Ad.a,{x:O.x,y:O.y}),da,n);ye.EventHandlerManager.instance.M6c()};Kf.prototype.lsc=
function(n,O,da){Hh.h(this.$,Hh.b);this.Unb.showFloatie(Object.assign(new Ad.a,{x:O.x,y:O.y}),n,da);Ze.a(function(){ye.EventHandlerManager.instance.M6c()},this.$.ma)};Kf.prototype.gKd=function(n,O,da,l){Hh.h(this.$,Hh.b);this.Unb.gKd(Object.assign(new Ad.a,{x:O.x,y:O.y}),n,da,l)};Object(hd.a)(Kf,"ReactContextMenuController",null,[371,7]);var sd=Sc.a;Cm(Ug,sd);Ug.prototype.dispose=function(){this.h1e&&this.$&&this.$.fa.Sr(Object(Kc.a)(this,this.Oed,"initReactControllerAndInfrastructure"));sd.prototype.dispose.call(this)};
Ug.prototype.create=function(){this.$.fa.fi?(Rc.ULS.sendTraceTag(571278486,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.fa.fi),this.Oed(null,null)):(this.h1e=!0,this.$.fa.Do(Object(Kc.a)(this,this.Oed,"initReactControllerAndInfrastructure")))};Ug.prototype.Oed=function(){var n=this,O;(O=this.$.ea.Ea(342,void 0))?this.Jb(O):this.$.HG(function(da){da.Ned().then(function(l){(O=n.$.ea.Ea(342,void 0))?n.Jb(O):(O=new Kf(n.$,l),n.Jb(n.$.ea.La(342,
O)))})})};Ug.la=function(n){n.ea.La(338,new Ug(n))};Object(hd.a)(Ug,"ContextMenuControllerFactory",Sc.a,[]);var pe=b(156);Object(hd.a)(Qf,"RibbonCommandParams",null,[]);Object(hd.a)(Bg,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);kg.prototype.Wuh=function(n){return(n=this.c$b[n.toString()])?n.menuModel:null};kg.prototype.Nme=function(n,O){this.c$b[O.toString()]=Object.assign(new Bg,{menuModel:n,Dwe:Z.HelperMethods.Kc()})};kg.prototype.Gpb=function(n){this.c$b[n.toString()]=null};kg.prototype.sJh=
function(n){return(n=this.c$b[n.toString()])?n.Dwe:-1};Object(hd.a)(kg,"FilterMenuCache",null,[]);var Ve=b(13),Li=b(197),Jf=b(276);Object(hd.a)(lf,"AutoFilterEventRegistrationArgs",null,[]);var ui=b(25);wf.prototype.dispose=function(){window.cancelAnimationFrame(this.Sxb);this.gridView&&this.gridView.dnc(Object(Kc.a)(this,this.KAb,"onGridViewBlockRendered"));this.gridView=null};wf.prototype.OTh=function(){if(this.BJd=Z.HelperMethods.W3a)this.hXa=[];this.Gpg();this.gridView.uVb(Object(Kc.a)(this,this.KAb,
"onGridViewBlockRendered"))};wf.prototype.Gpg=function(){for(var n=Ml(this.gridView.uo),O=n.next();!O.done;O=n.next()){O=O.value.rAa;for(var da in O){var l=O[da];this.aAf(l.domElement,l.hashCode)}}};wf.prototype.KAb=function(n){this.aAf(n.domElement,n.hashCode)};wf.prototype.aAf=function(n,O){if(te.g(this.$).Ha.Ml.TZa(O))if(n){n=n.querySelectorAll('[id^="'+ub.a.F5c+'"]');for(var da=0;da<n.length;da++){var l=n[da],K=l.getAttribute(ub.a.Hlh),ka=l.getAttribute(ub.a.Alh);Rc.ULS.shipAssertTag(593249425,
0,!mf.a.na(K)&&!mf.a.na(ka),"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",l.id,O);K=ui.Range.xd(parseInt(K),parseInt(ka));l=Object.assign(new lf,{cell:K,xke:l,Od:O});this.BJd?(this.hXa.push(l),this.Sxb||(this.VDe=window.performance.now(),this.Sxb=window.requestAnimationFrame(Object(Kc.a)(this,this.xDf,"registerQueuedAutoFilterEventHandler")))):this.Rde(l)}}else Rc.ULS.sendTraceTag(593249426,
0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",O);else Rc.ULS.sendTraceTag(592738048,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",O)};wf.prototype.xDf=function(n){for(var O=0;window.performance.now()-n<this.e$g&&0<this.hXa.length;)this.Rde(this.hXa.shift()),O++;Rc.ULS.sendTraceTag(593249424,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",
this.l3c,O,this.hXa.length);0<this.hXa.length?this.Sxb=window.requestAnimationFrame(Object(Kc.a)(this,this.xDf,"registerQueuedAutoFilterEventHandler")):(Rc.ULS.sendTraceTag(593249423,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",this.l3c,window.performance.now()-this.VDe),this.l3c++,this.Sxb=0)};wf.prototype.Rde=function(n){var O=this.gridView.Ha.p8b(n.cell,n.Od);O?this.Fpg(n.xke,O):Rc.ULS.sendTraceTag(593249422,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",
n.Od,n.cell)};wf.prototype.Fpg=function(n,O){O.hasAutoFilter?this.Ing(n,O.E5c):O.V3?this.Dpg(n,O.E5c,O.W6e):Rc.ULS.sendTraceTag(593249421,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");pe.a.instance.qa(Ve.a.Hf,n,Object(Kc.a)(this,this.onPointerDown,"onPointerDown"));Li.a.instance.qa(Ve.a.wwa,n,Object(Kc.a)(this,this.onPointerDown,"onPointerDown"))};wf.prototype.Ing=function(n,O){Jf.a.instance.qa(Ve.a.click,n,function(da){mf.a.na(O)||
Fg.a.hrc(da.Ga.rawEvent,966232027,O,null);return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?!0:!1})};wf.prototype.Dpg=function(n,O,da){var l=sf.a.gi(O);Jf.a.instance.qa(Ve.a.click,n,function(K){da?Fg.a.spf(document.getElementById(l.EwaElementId),l.Cell,l.DataSourceIndex,l.FieldId,l.IsOlap,l.RequiresConfirmation,K.Ga.rawEvent,l.OptionalPivotMenuAnchor):Fg.a.spfm(K.Ga.rawEvent,l.RequiresConfirmation,l.Cell,l.DataSourceIndex,l.PivotName,l.OptionalPivotMenuAnchor);
return!1})};wf.prototype.onPointerDown=function(n){Fg.a.slim(n.Ga.rawEvent);return!1};Object(hd.a)(wf,"FilterMenuPointerEventsManager",null,[7]);Pe.prototype.dispose=function(){fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1)&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.$Je.dispose();this.$=null};Pe.prototype.SAh=function(n){var O=te.g(this.$).Ha.Tqa(n,this.$.activeItemName);return O&&O.blockPresentInViewportTimeStamp>this.rwa.sJh(n.left)?
O.zs(n,void 0,!0).autoFilterMenu:this.rwa.Wuh(n.left)};Pe.prototype.aui=function(n,O,da){this.rwa&&(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.rwa.Nme(n.menuModel[O],da):this.rwa.Nme(n.menuModel[O],n.left+O))};Pe.prototype.bui=function(n,O,da){this.rwa&&(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.rwa.Gpb(da):this.rwa.Gpb(n.left+
O))};Object(hd.a)(Pe,"FilterMenuManager",null,[372,7]);var bj=b(220),ji=b(170);Ye.prototype.G8c=function(n){return Ch.a.Ec(this.Hsc,n)};Ye.prototype.dispose=function(){this.Ld?Rc.ULS.sendTraceTag(572384067,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ld=!0,this.$&&(this.$.nl(Ye.sd),this.$.ea.qP(8),this.ga&&this.ga.Ymc(Object(Kc.a)(this,this.Yk,"onContextMenu")),this.$.Na.c9a(Object(Kc.a)(this,this.ylf,"onContextMenuClosed")),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&
this.$.Na&&this.$.Na.Y8a(Object(Kc.a)(this,this.Mwa,"onCommandExecutionStarting")),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.g6(Object(Kc.a)(this,this.i5,"onApplicationModeChanged"))),this.$=this.ga=null,this.k5b.dispose(),this.Hsc=this.lZd=null)};Ye.prototype.showContextMenu=function(n,O,da){O=void 0===O?null:O;da=void 0===da?null:da;this.Udj(n)&&(Hh.h(this.$,Hh.i),n=this.bTg(n,O,da),this.$.Na.Xb(n.je,n.dictionary))};Ye.prototype.P2=
function(){this.contextMenuController?this.contextMenuController.V9():Rc.ULS.sendTraceTag(571278485,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Ye.prototype.Yk=function(n,O){this.showContextMenu(void 0===O?null:O)};Ye.prototype.ylf=function(n,O){O.xhi===Ye.$Lh&&te.g(this.$).focus()};Ye.prototype.Mwa=function(n,O){(n=this.$.Na.F$(O.je.command))&&n.dismissesContextualUI&&this.P2()};Ye.prototype.Udj=function(n){return V.a(this.$).Rq()?(Rc.ULS.sendTraceTag(36313220,
1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),V.a(this.$).j_(ji.a.grid,bj.a.showContextMenu),!1):!this.$.Na.gjh&&(!n||n.Wb!==te.g(this.$).domElement&&!mf.a.equals(n.Wb.tagName,"INPUT",!0))};Ye.prototype.bTg=function(n,O,da){O=void 0===O?null:O;var l={};da=(l.eventArgs=n,l.creationParams=void 0===da?null:da,l);n=n?n.Cb:-1;l=this.ga.Sa.nc;var K=1441131127;l?(O=l.floatingObject,Rc.ULS.shipAssertTag(18219405,0,!!O,"floatingObj shouldn't be null."),
Ye.gkd(O)?K=1312363469:Ye.isPivotChart(O)?(da[Uf.bVc]=O?O.hd:null,K=-149612405):K=-1372040782):Ye.V6e(O)?(da[Uf.bVc]=O,K=-149612405):!Hh.g(this.$)&&Hh.f(te.g(this.$))&&(K=671488277);O=new ig.a(K,n,this.$.jd,30,null);return Object.assign(new Qf,{je:O,dictionary:da})};Ye.prototype.i5=function(){var n=this;this.$.ea.qP(342);fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.create(this.$.ea,338,this.$.ma,3,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController"),function(O){O=O.result;for(var da=
Ml(n.Hsc),l=da.next();!l.done;l=da.next())l.value.kDf(O)},this.$.ma)};Ye.la=function(n){n.Nk(Ye.sd)};Ye.sd=function(n){(n=Object(pf.a)(11,n))&&Nf.GetServiceTaskFactory.create(n.ea,9,n.ma,0,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager")};Ye.isPivotChart=function(n){return!!n&&!n.type&&Ye.V6e(n.hd)};Ye.gkd=function(n){return!!n&&2===n.type};Ye.V6e=function(n){return!!n&&!!(n.Attributes&4)};Jl.Object.defineProperties(Ye.prototype,{k5b:{configurable:!0,enumerable:!0,get:function(){return this.lZd}}});
Ye.ZPg="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");Ye.$Lh="GridContextMenu";Object(hd.a)(Ye,"ContextMenuManager",null,[341,7]);var Ei=Sc.a;Cm(ff,Ei);ff.prototype.create=function(){var n=this,O=this.$,da=O.mc;if(da.allowSelection||da.allowEdits||da.allowFiltering||da.allowSorting||da.allowPivotSpecificOperations){var l=Nf.GetServiceTaskFactory.create(O.ea,10,O.ma,
this.vb,"System.SpecificArray<Microsoft.Office.Excel.WebUI.Client.ICommandHandler>"),K=Nf.GetServiceTaskFactory.Xa(O.ea,342,338,this.vb,"Microsoft.Office.Excel.WebUI.Client.ContextMenu.IContextMenuController");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([l,K],this.ma),function(){n.Jb(xd.a(O)||new Ye(O,l.result,K.result))},this.$.ma,3)}else Rc.ULS.sendTraceTag(34719499,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),O.ea.qP(8),this.Jb(null)};
ff.la=function(n){n.ea.La(9,new ff(n))};Object(hd.a)(ff,"ContextMenuManagerFactory",Sc.a,[]);vd.prototype.isEqual=function(n){return n?this.l4===n.l4&&this.m4===n.m4&&this.eK===n.eK&&this.RQ===n.RQ&&this.VA===n.VA&&this.ruleType===n.ruleType&&this.iZ===n.iZ&&this.QS===n.QS&&this.PS===n.PS&&this.IU===n.IU&&this.oE===n.oE&&this.t4===n.t4&&this.u4===n.u4:(Rc.ULS.shipAssertTag(36569613,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(hd.a)(vd,"DataValidationEditDialogState",
null,[]);xc.prototype.$c=function(){return!1};xc.prototype.executeCommand=function(n,O){-1728432249!==O.command&&kh.a(O.command);this.selectedRanges=jg.r(te.g(this.$).ga.ya.selectedRanges,this.$);te.g(this.$).P_(!0);this.getDataValidationInitialState();this.Ji=this.$.Zb.Ic("UserAction","DataValidationEditTimeToDialogOpen");this.kBe?Rc.ULS.sendTraceTag(37777815,0,50,"Open data validation edit dialog - NOT first time in session"):(Rc.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),
this.kBe=!0);return ug.Task.Ua(!0)};xc.prototype.Jc=function(n,O){return-1728432249===O.command};xc.prototype.gd=function(){return!1};xc.prototype.getDataValidationInitialState=function(){var n=this,O=this.$.ra.xa.dc();hg.a(this.$.userOperationManager,function(da,l,K){return nf.u(n.$.ra.xa,n.selectedRanges,Lf.b(da,Object(Kc.a)(n,n.wsi,"onGetDataValidationInitialStateSuccessCallback")),Lf.a(l),K,O)},function(da){return new bh.a(120,0,da,16)},null)};xc.prototype.wsi=function(n){Rc.ULS.sendTraceTag(24666139,
0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!n||Cf.a(n)?Rc.ULS.sendTraceTag(24666140,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.xZa=n.Result,this.bIi())};xc.prototype.bIi=function(){var n=this.gB={};switch(this.xZa.Command){case 0:var O="CreateNew";break;case 1:O="CreateNewFromRule";break;case 2:O="ExpandExisitng";break;case 3:O="OverrideExisitng";break;default:O="Unknown"}n.a=
O;this.Ji&&(this.Ji.stop(),this.gB.r=this.Ji.id);switch(this.xZa.Command){case 0:this.gB.b=!1;this.gB.c="None";this.UFa(new vd);break;case 1:this.gB.b=!1;this.gB.c="None";this.UFa(new vd(this.xZa));break;case 2:this.gB.b=!0;this.K_c.ZRg(this.$,Object(Kc.a)(this,this.ojh,"expandExisitngDialogHandler"));break;case 3:this.gB.b=!0;this.K_c.bSg(this.$,Object(Kc.a)(this,this.nDi,"overrideExisitngDialogHandler"));break;default:Rc.ULS.sendTraceTag(24666141,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};
xc.prototype.UFa=function(n){this.K_c.UFa(this.$,this.selectedRanges,n,this.xZa.Command);this.dei(n)};xc.prototype.dei=function(n){xc.gpb(n,this.gB);this.gB.d=!0;$d.b().Se(48,this.gB,!0)};xc.prototype.Wcf=function(){this.gB.d=!1;$d.b().Se(48,this.gB,!0)};xc.prototype.ojh=function(n){this.YV("DataValidationEdit.ExpandExisitngDialog",n);this.gB.c=xc.MT(n);1===n?this.UFa(new vd(this.xZa)):2===n?this.UFa(new vd):this.Wcf()};xc.prototype.nDi=function(n){this.YV("DataValidationEdit.OverrideExisitngDialog",
n);this.gB.c=xc.MT(n);1===n?this.UFa(new vd):this.Wcf()};xc.prototype.YV=function(n,O){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var da={};n=(da.ButtonType=xc.MT(O),da.DialogName=n,da.Location="dialog",da.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,da)}else da={},n=(da.ButtonType=xc.MT(O),da.DialogName=n,da.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,da);Wf.b(this.$).Jd(fh.a.a2b,n)};xc.gpb=function(n,O){O.e=Xd(n.ruleType);O.f=Je(n.VA);O.g=!mf.a.na(n.eK);
O.h=!mf.a.na(n.RQ);O.i=n.l4;O.j=n.m4;O.k=n.u4;O.l=!mf.a.na(n.oE);O.m=!mf.a.na(n.IU);O.n=n.t4;O.o=n.iZ;O.p=!mf.a.na(n.QS);O.q=!mf.a.na(n.PS)};xc.MT=function(n){switch(n){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Rc.ULS.shipAssertTag(36975693,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(hd.a)(xc,"DataValidationEditCommandHandler",null,[159]);var mi=b(955),Zh=b(140),gi=b(142);Jl.Object.defineProperties(cc,{Mf:{configurable:!0,
enumerable:!0,get:function(){return Zh.a.jj(cc.Oj,"")}},j2g:{configurable:!0,enumerable:!0,get:function(){return Zh.a.jj(cc.n2g,gi.a.da(1597),gi.a.da(1612),gi.a.da(1613),gi.a.da(1614),gi.a.da(1615),gi.a.da(1616),gi.a.da(1617),gi.a.da(1618),gi.a.da(1619),gi.a.da(1598),gi.a.da(1622),gi.a.da(1623),gi.a.da(1624),gi.a.da(1625),gi.a.da(1626),gi.a.da(1627),gi.a.da(1628),gi.a.da(1629),gi.a.da(1599),gi.a.da(1600),gi.a.da(1620),gi.a.da(1621),gi.a.da(1611),"255")}},q2g:{configurable:!0,enumerable:!0,get:function(){return Zh.a.jj(cc.o2g,
gi.a.da(1634),gi.a.da(1638),gi.a.da(1639),"255","32")}},u2g:{configurable:!0,enumerable:!0,get:function(){return Zh.a.jj(cc.p2g,gi.a.da(1633),gi.a.da(1636),gi.a.da(1635),gi.a.da(1637),gi.a.da(1638),gi.a.da(1639),"255","32")}}});cc.xYf=255;cc.Oj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";cc.n2g="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
cc.o2g="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
cc.p2g="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(hd.a)(cc,"DataValidationEditDialogHtml",null,[]);var gf=b(573),vj=Te.a;Cm(hb,vj);hb.prototype.Tya=function(n){this.SS.selectedIndex=n.ruleType;this.fK.selectedIndex=n.VA;this.fac.checked=n.m4;this.Jua.checked=n.l4;this.oxa.value=n.eK;this.pxa.value=n.RQ;this.rba(null)};hb.prototype.qmb=function(n){n.l4=this.Jua.checked;n.m4=this.fac.checked;n.VA=this.fK.selectedIndex;n.ruleType=this.SS.selectedIndex;n.eK=this.oxa.value;n.RQ=this.pxa.value};hb.prototype.dispose=function(){this.sm();this.uk=
this.hvd=this.Jjc=this.$Ma=this.k7a=this.BLa=this.K2a=this.fac=this.pxa=this.oxa=this.fK=this.SS=this.Jua=null;vj.prototype.dispose.call(this)};hb.prototype.render=function(n){n.appendChild(this.domElement)};hb.prototype.Iia=function(){return this.isVisible};hb.prototype.jma=function(n){return this.isVisible=n};hb.prototype.setFocus=function(){};hb.prototype.msb=function(n,O){return this.LSe(n,O,this.inh)};hb.prototype.nad=function(n,O){return O&&1!==O?"":this.LSe(n,O,this.M2i)};hb.prototype.cja=
function(){this.domElement.innerHTML=cc.j2g;this.Jua=je.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.SS=je.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.fK=je.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.oxa=je.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.pxa=je.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Jjc=je.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.hvd=je.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.K2a=je.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.BLa=je.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.k7a=je.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.$Ma=je.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.fac=je.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Xj()};hb.prototype.LSe=function(n,O,da){return da.length<n||da[n].length<O?(Rc.ULS.sendTraceTag(24492002,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",n,O),""):this.qQ.oa(da[n][O])};hb.prototype.qic=function(n){var O=!1;n&&n.Ga&&(n.Ga.keyCode===yd.a.mna||n.Ga.keyCode===yd.a.Vh)&&(O=this.rba(n),this.SS.blur(),this.fK.blur());return O};hb.prototype.rba=function(){var n=this.SS.selectedIndex,
O=this.fK.selectedIndex;this.Jjc.innerText=this.msb(n,O);this.hvd.innerText=this.nad(n,O);switch(n){case 0:return this.fK.disabled=!0,je.DOMElementExtensions.setVisible(this.k7a,!1),je.DOMElementExtensions.setVisible(this.$Ma,!1),je.DOMElementExtensions.setVisible(this.K2a,!1),je.DOMElementExtensions.setVisible(this.BLa,!1),this.Jua.disabled=!0,!1;case 3:return this.fK.disabled=!0,je.DOMElementExtensions.setVisible(this.k7a,!0),je.DOMElementExtensions.setVisible(this.$Ma,!1),je.DOMElementExtensions.setVisible(this.K2a,
!0),je.DOMElementExtensions.setVisible(this.BLa,!0),this.Jua.disabled=!1;case 7:return this.fK.disabled=!0,je.DOMElementExtensions.setVisible(this.k7a,!0),je.DOMElementExtensions.setVisible(this.$Ma,!1),je.DOMElementExtensions.setVisible(this.K2a,!1),je.DOMElementExtensions.setVisible(this.BLa,!1),this.Jua.disabled=!1;default:this.Jua.disabled=!1,je.DOMElementExtensions.setVisible(this.k7a,!0),je.DOMElementExtensions.setVisible(this.BLa,!1)}switch(O){case 0:case 1:je.DOMElementExtensions.setVisible(this.$Ma,
!0);break;default:je.DOMElementExtensions.setVisible(this.$Ma,!1)}this.fK.disabled=!1;this.Jjc.disabled=!1;je.DOMElementExtensions.setVisible(this.K2a,!1);je.DOMElementExtensions.setVisible(this.BLa,!1);return!1};hb.prototype.Xj=function(){gf.a.instance.qa(Ve.a.Rb,this.SS,Object(Kc.a)(this,this.qic,"onInteractWithControlElementsKeyDown"));gf.a.instance.qa(Ve.a.Rb,this.fK,Object(Kc.a)(this,this.qic,"onInteractWithControlElementsKeyDown"));gf.a.instance.qa(Ve.a.change,this.SS,Object(Kc.a)(this,this.rba,
"onInteractWithControlElements"));gf.a.instance.qa(Ve.a.change,this.fK,Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));gf.a.instance.qa(Ve.a.change,this.fK,this.uk);gf.a.instance.qa(Ve.a.change,this.SS,this.uk);gf.a.instance.qa(Ve.a.change,this.oxa,this.uk);gf.a.instance.qa(Ve.a.Rb,this.oxa,this.uk);gf.a.instance.qa(Ve.a.change,this.pxa,this.uk);gf.a.instance.qa(Ve.a.Rb,this.pxa,this.uk)};hb.prototype.sm=function(){gf.a.instance.Ca(Ve.a.Rb,this.SS,Object(Kc.a)(this,this.qic,"onInteractWithControlElementsKeyDown"));
gf.a.instance.Ca(Ve.a.Rb,this.fK,Object(Kc.a)(this,this.qic,"onInteractWithControlElementsKeyDown"));gf.a.instance.Ca(Ve.a.change,this.SS,Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));gf.a.instance.Ca(Ve.a.change,this.fK,Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));gf.a.instance.Ca(Ve.a.change,this.fK,this.uk);gf.a.instance.Ca(Ve.a.change,this.SS,this.uk);gf.a.instance.Ca(Ve.a.change,this.oxa,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.oxa,this.uk);gf.a.instance.Ca(Ve.a.change,
this.pxa,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.pxa,this.uk)};hb.RY=function(){var n;return n=new Aa.a,n.add("operatorInputId1"),n.add("operatorInputId2"),n};Jl.Object.defineProperties(hb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Sd.a.instance.da(1630)}},JOg:{configurable:!0,enumerable:!0,get:function(){return this.SS.selectedIndex}}});Object(hd.a)(hb,"DataValidationEditConditionsControl",Te.a,[402,7,403]);var ej=b(199),Ti=mi.a;Cm(Yb,Ti);Yb.prototype.RKd=function(){var n=
{};n=(n.RuleType=this.Fd.ruleType,n.RuleOperatorType=this.Fd.VA,n.OperatorInput1=this.Fd.eK,n.OperatorInput2=this.Fd.RQ,n.IsIgnoreBlank=this.Fd.l4,n.IsInCellDropDown=this.Fd.m4,n.IsAlertBlocking=this.Fd.iZ,n.AlertTitle=this.Fd.QS,n.AlertMessage=this.Fd.PS,n.InputTitle=this.Fd.oE,n.InputMessage=this.Fd.IU,n.IsShowErrorAlert=this.Fd.t4,n.IsShowInputMessage=this.Fd.u4,n);this.Dc(2,Sd.a.instance.da(1596));var O={};n=(O.id=this.xc,O.validateDialogValues=Object(Kc.a)(this,this.FAj,"validateDialogValues"),
O.bodyProps=n,O);this.initializeAndShow(Sd.a.instance.da(1595),Object(Kc.a)(this,this.J_c,"dataValidationDialogHandler"),n);Rc.ULS.sendTraceTag(23667779,0,50,"DataValidationEditDialog dialog opened.")};Yb.prototype.dispose=function(){this.disposed||(Ti.prototype.dispose.call(this),this.disposed=!0)};Yb.prototype.FAj=function(n,O){this.y7b(n);var da=this.JRd();n=da.errorString;var l=da.aq;if(da.returnValue)return this.Y2a(121,this.uxh(this.$,O),0,this.xaa,!1),"";this.$ja("OkInvalidByClient",l);return n};
Yb.prototype.RY=function(){return hb.RY()};Yb.prototype.uxh=function(n,O){var da=this;return function(l,K,ka){var $a=n.ra.xa.dc();return sa(da.$.ra.xa,da.selectedRanges,da.lEg(),da.dYa(l,da.Qsd(O)),Lf.a(K),ka,$a)}};Yb.prototype.Qsd=function(n){var O=this;return function(da){Rc.ULS.sendTraceTag(23667780,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var l;Cf.a(da)?(Rc.ULS.sendTraceTag(24492032,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
da?qd.a.fd(da.Errors):null),da.Errors&&1===da.Errors.length&&((l=O.S8c(da.Errors[0].MessageId))?O.$ja("OkInvalidByServer",da.Errors[0].MessageIdName):(O.$ja("OkValid","None"),O.hide()),n(l)),Rc.ULS.sendTraceTag(25759878,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",qd.a.fd(da.Errors))):O.hide()}};Yb.prototype.lEg=function(){var n={};n.Command=this.command;n.RuleType=this.Fd.ruleType;n.ConditionType=this.Fd.VA;n.IsIgnoreBlank=this.Fd.l4;n.IsInCellDropDown=
this.Fd.m4;n.LowerBoundary=this.Fd.eK;n.UpperBoundary=this.Fd.RQ;n.IsAlertBlocking=this.Fd.iZ;n.IsShowErrorAlert=this.Fd.t4;n.IsShowInputMessage=this.Fd.u4;n.AlertTitle=this.Fd.QS;n.AlertMessage=this.Fd.PS;n.InputTitle=this.Fd.oE;n.InputMessage=this.Fd.IU;n.ShouldIgnoreFormulaError=this.hLa;return n};Yb.prototype.S8c=function(n){switch(n){case 1173235830:return Sd.a.instance.da(1645);case 43935303:return Sd.a.instance.da(1646);case -1323438439:return Sd.a.instance.da(1648);case 2112020473:return Sd.a.instance.da(1642);
case -219503282:return Sd.a.instance.da(1643);case 1689335445:return Sd.a.instance.da(1644);case 2146493810:return Sd.a.instance.da(1647);case -2104909922:return String.format(Sd.a.instance.Eb(104),this.Pqb,this.JFd);case -869372599:return String.format(Sd.a.instance.Eb(103),this.Pqb);case -1181828368:return Sd.a.instance.da(1650);case -758480861:return Sd.a.instance.da(1651);case -13729088:return Sd.a.instance.da(1652);case -846654055:return Sd.a.instance.da(1653);case 751854001:return Sd.a.instance.da(1654);
case -453846397:return Sd.a.instance.da(1655);case 1102013489:return Sd.a.instance.da(1656);case 835813260:return Sd.a.instance.da(1657);case 1577787509:return Sd.a.instance.da(1658);case 2083564019:return Sd.a.instance.da(1649);default:Rc.ULS.sendTraceTag(25759879,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",n.toString())}return null};Yb.prototype.J_c=function(n){this.YV(n);this.Ji=this.$.Zb.Ic("UserAction","DataValidationEditTimeToDialogTryClose");
n||this.Cka()};Yb.prototype.Cka=function(){this.$ja("Cancel","None")};Yb.prototype.YV=function(n){Rc.ULS.sendTraceTag(23667781,0,50,"DataValidationEditDialog {0} was clicked.",1===n?"Ok":"Cancel");if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var O={};n=(O.ButtonType=Yb.MT(n),O.DialogName=this.xc,O.Location="dialog",O.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,O)}else O={},n=(O.ButtonType=Yb.MT(n),O.DialogName=this.xc,O.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,
O);Wf.b(this.$).Jd(fh.a.a2b,n)};Yb.prototype.$ja=function(n,O){var da={};Yb.gpb(this.Fd,da);da.o=n;da.p=O;da.n=this.pja;this.Ji&&(this.Ji.stop(),da.q=this.Ji.id);$d.b().Se(49,da,!0)};Yb.prototype.y7b=function(n){this.Fd.ruleType=n.RuleType;this.Fd.VA=n.RuleOperatorType;this.Fd.eK=n.OperatorInput1;this.Fd.RQ=n.OperatorInput2;this.Fd.iZ=n.IsAlertBlocking;this.Fd.t4=n.IsShowErrorAlert;this.Fd.QS=n.AlertTitle;this.Fd.PS=n.AlertMessage;this.Fd.u4=n.IsShowInputMessage;this.Fd.oE=n.InputTitle;this.Fd.IU=
n.InputMessage;this.Fd.l4=n.IsIgnoreBlank;this.Fd.m4=n.IsInCellDropDown;this.Pqb=n.firstOperatorLabel;this.JFd=n.secondOperatorLabel};Yb.prototype.bLb=function(n,O,da){var l;var K=l=null;if(mf.a.na(n))return da?(l=String.format(Sd.a.instance.Eb(104),this.Pqb,this.JFd),K="DataValidationEditNoMinMaxError"):(l=String.format(Sd.a.instance.Eb(103),this.Pqb),K="DataValidationEditNoValueError"),{returnValue:!1,errorString:l,aq:K};if(n.length>cc.xYf)return l=Sd.a.instance.da(1649),{returnValue:!1,errorString:l,
aq:K};if(ej.d(n))return{returnValue:!0,errorString:l,aq:K};if(1===O||2===O||6===O){if(!mf.a.OU(n))return l=Sd.a.instance.da(1642),{returnValue:!1,errorString:l,aq:K};if(1===O&&!mf.a.isInteger(n))return l=Sd.a.instance.da(1643),{returnValue:!1,errorString:l,aq:K};if(6===O){if(!mf.a.isInteger(n))return l=Sd.a.instance.da(1643),{returnValue:!1,errorString:l,aq:K};if(0>parseInt(n))return l=Sd.a.instance.da(1644),{returnValue:!1,errorString:l,aq:K}}}return{returnValue:!0,errorString:l,aq:K}};Yb.prototype.JRd=
function(){var n=this,O;var da=O=null;var l=this.Fd.eK,K=this.Fd.eK,ka=this.Fd.ruleType,$a=this.Fd.VA;if(!ka)return{returnValue:!0,errorString:O,aq:da};var Lb=(!$a||1===$a)&&3!==ka&&7!==ka;return!function(){var bc=n.bLb(l,ka,Lb);O=bc.errorString;da=bc.aq;return bc}().returnValue||Lb&&!function(){var bc=n.bLb(K,ka,Lb);O=bc.errorString;da=bc.aq;return bc}().returnValue?{returnValue:!1,errorString:O,aq:da}:Lb&&(1===ka||2===ka||6===ka)&&!ej.d(l)&&!ej.d(K)&&parseFloat(l)>parseFloat(K)?(O=Sd.a.instance.da(1647),
da="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:O,aq:da}):{returnValue:!0,errorString:O,aq:da}};Yb.MT=function(n){switch(n){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Rc.ULS.shipAssertTag(36975694,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Yb.gpb=function(n,O){O.a=Xd(n.ruleType);O.b=Je(n.VA);O.c=!mf.a.na(n.eK);O.d=!mf.a.na(n.RQ);O.e=n.l4;O.f=n.m4;O.g=n.u4;O.h=!mf.a.na(n.oE);O.i=!mf.a.na(n.IU);
O.j=n.t4;O.k=n.iZ;O.l=!mf.a.na(n.QS);O.m=!mf.a.na(n.PS)};Jl.Object.defineProperties(Yb.prototype,{Fd:{configurable:!0,enumerable:!0,get:function(){return this.hOb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},RYb:{configurable:!0,enumerable:!0,get:function(){return 3===this.Fd.ruleType}}});Object(hd.a)(Yb,"DataValidationEditDialog",mi.a,[]);var oj=b(368);De.e_g="DataValidationDialogPanel";De.d_g="DataValidationButtonPanel";De.c_g="DataValidationButtonClearAll";
Object(hd.a)(De,"CssClassNames",null,[]);var wg=Te.a;Cm(Od,wg);Od.prototype.render=function(n){n.appendChild(this.domElement)};Od.prototype.Iia=function(){return this.isVisible};Od.prototype.jma=function(n){return this.isVisible=n};Od.prototype.setFocus=function(){};Od.prototype.dispose=function(){this.sm();this.uk=this.gaa=this.faa=this.P1e=this.eaa=null;wg.prototype.dispose.call(this)};Od.prototype.cja=function(){this.domElement.innerHTML=cc.q2g;this.eaa=je.DOMElementExtensions.getElementById(this.domElement,
"showInputCheckBoxId");this.P1e=je.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.gaa=je.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.faa=je.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.eaa.checked=!0;this.Xj();this.sic(null)};Od.prototype.Tya=function(n){this.gaa.value=void 0===n.oE||null===n.oE?"":n.oE;this.faa.value=void 0===n.IU||null===n.IU?"":n.IU;this.eaa.checked=n.u4;this.sic(null)};Od.prototype.qmb=
function(n){n.oE=this.gaa.value;n.IU=this.faa.value;n.u4=this.eaa.checked};Od.prototype.Xj=function(){gf.a.instance.qa(Ve.a.change,this.eaa,Object(Kc.a)(this,this.sic,"onInteractWithShowInputCheckbox"));gf.a.instance.qa(Ve.a.change,this.eaa,this.uk);gf.a.instance.qa(Ve.a.change,this.gaa,this.uk);gf.a.instance.qa(Ve.a.Rb,this.gaa,this.uk);gf.a.instance.qa(Ve.a.change,this.faa,this.uk);gf.a.instance.qa(Ve.a.Rb,this.faa,this.uk)};Od.prototype.sm=function(){gf.a.instance.Ca(Ve.a.change,this.eaa,Object(Kc.a)(this,
this.sic,"onInteractWithShowInputCheckbox"));gf.a.instance.Ca(Ve.a.change,this.eaa,this.uk);gf.a.instance.Ca(Ve.a.change,this.gaa,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.gaa,this.uk);gf.a.instance.Ca(Ve.a.change,this.faa,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.faa,this.uk)};Od.prototype.sic=function(){this.eaa.checked?(this.gaa.disabled=!1,this.faa.disabled=!1):(this.gaa.disabled=!0,this.faa.disabled=!0);return!1};Jl.Object.defineProperties(Od.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Sd.a.instance.da(1632)}}});
Object(hd.a)(Od,"DataValidationEditInputControl",Te.a,[402,7,405]);var qj=Te.a;Cm(ld,qj);ld.prototype.render=function(n){n.appendChild(this.domElement)};ld.prototype.Iia=function(){return this.isVisible};ld.prototype.jma=function(n){return this.isVisible=n};ld.prototype.setFocus=function(){};ld.prototype.dispose=function(){this.sm();this.uk=this.T8=this.S8=this.WRa=this.mga=this.Q8=null;qj.prototype.dispose.call(this)};ld.prototype.cja=function(){this.domElement.innerHTML=cc.u2g;this.Q8=je.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.mga=je.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.WRa=je.DOMElementExtensions.getElementById(this.domElement,"warningId");this.T8=je.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.S8=je.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.Q8.checked=!0;this.mga.checked=!0;this.Xj();this.ric(null)};ld.prototype.Tya=function(n){this.mga.checked=n.iZ;this.WRa.checked=!n.iZ;this.T8.value=
void 0===n.QS||null===n.QS?"":n.QS;this.S8.value=void 0===n.PS||null===n.PS?"":n.PS;this.Q8.checked=n.t4;this.ric(null)};ld.prototype.qmb=function(n){n.QS=this.T8.value;n.PS=this.S8.value;n.iZ=this.mga.checked;n.t4=this.Q8.checked};ld.prototype.Xj=function(){gf.a.instance.qa(Ve.a.change,this.Q8,Object(Kc.a)(this,this.ric,"onInteractWithShowAlertCheckbox"));gf.a.instance.qa(Ve.a.change,this.Q8,this.uk);gf.a.instance.qa(Ve.a.change,this.mga,this.uk);gf.a.instance.qa(Ve.a.change,this.WRa,this.uk);gf.a.instance.qa(Ve.a.change,
this.T8,this.uk);gf.a.instance.qa(Ve.a.Rb,this.T8,this.uk);gf.a.instance.qa(Ve.a.change,this.S8,this.uk);gf.a.instance.qa(Ve.a.Rb,this.S8,this.uk)};ld.prototype.sm=function(){gf.a.instance.Ca(Ve.a.change,this.Q8,Object(Kc.a)(this,this.ric,"onInteractWithShowAlertCheckbox"));gf.a.instance.Ca(Ve.a.change,this.Q8,this.uk);gf.a.instance.qa(Ve.a.change,this.mga,this.uk);gf.a.instance.qa(Ve.a.change,this.WRa,this.uk);gf.a.instance.Ca(Ve.a.change,this.T8,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.T8,this.uk);
gf.a.instance.Ca(Ve.a.change,this.S8,this.uk);gf.a.instance.Ca(Ve.a.Rb,this.S8,this.uk)};ld.prototype.ric=function(){this.Q8.checked?(this.mga.disabled=!1,this.WRa.disabled=!1,this.T8.disabled=!1,this.S8.disabled=!1):(this.mga.disabled=!0,this.WRa.disabled=!0,this.T8.disabled=!0,this.S8.disabled=!0);return!1};Jl.Object.defineProperties(ld.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return Sd.a.instance.da(1631)}}});Object(hd.a)(ld,"DataValidationEditMessagesControl",Te.a,[402,7,
404]);Vd.prototype.K0a=function(){return this.cellRange};Object(hd.a)(Vd,"MacroRecorderRangeDataValidationChangedPayload",null,[115]);var Qh=b(65),Lj=oj.a;Cm(Uc,Lj);Uc.prototype.RKd=function(){var n={};n=(n.key=this.Fd,n);this.initializeAndShow(Sd.a.instance.da(1595),Object(Kc.a)(this,this.J_c,"dataValidationDialogHandler"),n);Rc.ULS.sendTraceTag(537772051,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Uc.prototype.dispose=function(){this.disposed||(this.Dac=this.ogc=this.v2=null,Ff.a.Ia(this.qzb),
this.qzb=null,Wf.b(this.$)&&Wf.b(this.$).fMd("DataValidationDialogCorellation"),Lj.prototype.dispose.call(this),this.disposed=!0)};Uc.prototype.Yu=function(n){Lj.prototype.Yu.call(this,n);this.Dc(2,Sd.a.instance.da(1596));n=this.jU(2);var O=this.jU(1),da=this.jU(0),l=O.parentNode;l.appendChild(n);l.appendChild(O);l.appendChild(da);Sys.UI.DomElement.addCssClass(n.parentNode,De.d_g);Sys.UI.DomElement.addCssClass(n,De.c_g);n=document.getElementById("dataValidationTabsId");O=new hb(this.$,document.createElement("div"),
Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));da=new Od(document.createElement("div"),Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));l=new ld(document.createElement("div"),Object(Kc.a)(this,this.rba,"onInteractWithControlElements"));this.DWh(O,da,l);var K;this.qzb=new tg(n,(K=new Aa.a,K.add(O),K.add(da),K.add(l),K));this.qzb.nGf();this.$T=document.getElementById("validationErrorMessageId");this.Tya();Wf.b(this.$)&&Wf.b(this.$).TLd("DataValidationDialogCorellation")};Uc.prototype.CN=
function(){Lj.prototype.CN.call(this);var n=document.getElementById(this.hi("WACDialogPanel"));Sys.UI.DomElement.addCssClass(n,De.e_g)};Uc.prototype.RY=function(){return hb.RY()};Uc.prototype.F7b=function(){return"validationErrorMessageId"};Uc.prototype.DWh=function(n,O,da){this.v2=n;this.Dac=O;this.ogc=da};Uc.prototype.T3i=function(){function n(){return new Vd(O.selectedRanges,da)}var O=this,da={};da.IsClearAll=this.pja;da.Command=this.command;da.RuleType=this.Fd.ruleType;da.ConditionType=this.Fd.VA;
da.IsIgnoreBlank=this.Fd.l4;da.IsInCellDropDown=this.Fd.m4;da.LowerBoundary=this.Fd.eK;da.UpperBoundary=this.Fd.RQ;da.IsAlertBlocking=this.Fd.iZ;da.IsShowErrorAlert=this.Fd.t4;da.IsShowInputMessage=this.Fd.u4;da.AlertTitle=this.Fd.QS;da.AlertMessage=this.Fd.PS;da.InputTitle=this.Fd.oE;da.InputMessage=this.Fd.IU;da.ShouldIgnoreFormulaError=this.hLa;var l=this.$.ra.xa.dc();hg.a(this.$.userOperationManager,function(K,ka,$a){return sa(O.$.ra.xa,O.selectedRanges,da,Lf.b(K,Object(Kc.a)(O,O.Qsd,"onDataValidationEditSuccessCallback")),
Lf.a(ka),$a,l)},function(K){return new bh.a(121,0,K,void 0,n)},null)};Uc.prototype.Qsd=function(n){Rc.ULS.sendTraceTag(537772049,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)Rc.ULS.sendTraceTag(537772048,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Cf.a(n)){Rc.ULS.sendTraceTag(537772047,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
n?qd.a.fd(n.Errors):null);if(n.Errors&&1===n.Errors.length){var O=n.Errors[0].MessageId,da=this.S8c(O);if(da){this.Aej(O)?this.R$i(da):this.Yt(da);this.$ja("OkInvalidByServer",n.Errors[0].MessageIdName);return}}Rc.ULS.sendTraceTag(537772046,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",qd.a.fd(n.Errors))}this.$ja("OkValid","None");this.hide()}};Uc.prototype.Aej=function(n){return 1577787509===n};Uc.prototype.R$i=function(n){this.$T.innerText=
n;this.iz(this.jU(0));this.hLa=!0};Uc.prototype.vqe=function(){this.hLa=!1;this.$T.innerText=""};Uc.prototype.S8c=function(n){switch(n){case 1173235830:return Sd.a.instance.da(1645);case 43935303:return Sd.a.instance.da(1646);case -1323438439:return Sd.a.instance.da(1648);case 2112020473:return Sd.a.instance.da(1642);case -219503282:return Sd.a.instance.da(1643);case 1689335445:return Sd.a.instance.da(1644);case 2146493810:return Sd.a.instance.da(1647);case -2104909922:return String.format(Sd.a.instance.Eb(104),
this.v2.msb(this.Fd.ruleType,this.Fd.VA),this.v2.nad(this.Fd.ruleType,this.Fd.VA));case -869372599:return String.format(Sd.a.instance.Eb(103),this.v2.msb(this.Fd.ruleType,this.Fd.VA));case -1181828368:return Sd.a.instance.da(1650);case -758480861:return Sd.a.instance.da(1651);case -13729088:return Sd.a.instance.da(1652);case -846654055:return Sd.a.instance.da(1653);case 751854001:return Sd.a.instance.da(1654);case -453846397:return Sd.a.instance.da(1655);case 1102013489:return Sd.a.instance.da(1656);
case 835813260:return Sd.a.instance.da(1657);case 1577787509:return Sd.a.instance.da(1658);case 2083564019:return Sd.a.instance.da(1649);default:Rc.ULS.sendTraceTag(537772045,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",n.toString())}return null};Uc.prototype.q5=function(){Rc.ULS.sendTraceTag(537772044,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.y7b();var n=this.JRd();var O=n.errorString;var da=n.aq;if(!n.returnValue)return this.Yt(O),
this.$ja("OkInvalidByClient",da),!1;this.T3i();return!0};Uc.prototype.Cka=function(){this.y7b();this.$ja("Cancel","None");this.hide()};Uc.prototype.Nwa=function(){Rc.ULS.sendTraceTag(537772043,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.hLa?this.vqe():this.DVc();this.AYi();this.pja=!0};Uc.prototype.J_c=function(n){this.YV(n);2!==n&&(this.Ji=this.$.Zb.Ic("UserAction","DataValidationEditTimeToDialogTryClose"));1===n?this.q5():2===n?this.Nwa():this.Cka()};Uc.prototype.YV=
function(n){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var O={};n=(O.ButtonType=Uc.MT(n),O.DialogName=this.xc,O.Location="dialog",O.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,O)}else O={},n=(O.ButtonType=Uc.MT(n),O.DialogName=this.xc,O.NumberOfSelectedRanges=te.g(this.$).ga.ya.gw,O);Wf.b(this.$).Jd(fh.a.a2b,n)};Uc.prototype.rba=function(){this.Vvj();this.hLa?this.vqe():this.DVc();return this.pja=!1};Uc.prototype.AYi=function(){this.hOb=new vd;this.Tya()};
Uc.prototype.Tya=function(){this.ogc.Tya(this.Fd);this.Dac.Tya(this.Fd);this.v2.Tya(this.Fd)};Uc.prototype.y7b=function(){this.v2.qmb(this.Fd);this.ogc.qmb(this.Fd);this.Dac.qmb(this.Fd)};Uc.prototype.$ja=function(n,O){var da={};Uc.gpb(this.Fd,da);da.o=n;da.p=O;da.n=this.pja;this.Ji&&(this.Ji.stop(),da.q=this.Ji.id);$d.b().Se(49,da,!0)};Uc.prototype.bLb=function(n,O){var da;var l=da=null;if(mf.a.na(n))return O?(da=String.format(Sd.a.instance.Eb(104),this.v2.msb(this.Fd.ruleType,this.Fd.VA),this.v2.nad(this.Fd.ruleType,
this.Fd.VA)),l="DataValidationEditNoMinMaxError"):(da=String.format(Sd.a.instance.Eb(103),this.v2.msb(this.Fd.ruleType,this.Fd.VA)),l="DataValidationEditNoValueError"),{returnValue:!1,errorString:da,aq:l};if(n.length>cc.xYf)return da=Sd.a.instance.da(1649),{returnValue:!1,errorString:da,aq:l};if(ej.d(n))return{returnValue:!0,errorString:da,aq:l};if(1===this.Fd.ruleType||2===this.Fd.ruleType||6===this.Fd.ruleType){if(!mf.a.OU(n))return da=Sd.a.instance.da(1642),{returnValue:!1,errorString:da,aq:l};
if(1===this.Fd.ruleType&&!mf.a.isInteger(n))return da=Sd.a.instance.da(1643),{returnValue:!1,errorString:da,aq:l};if(6===this.Fd.ruleType){if(!mf.a.isInteger(n))return da=Sd.a.instance.da(1643),{returnValue:!1,errorString:da,aq:l};if(0>parseInt(n))return da=Sd.a.instance.da(1644),{returnValue:!1,errorString:da,aq:l}}}return{returnValue:!0,errorString:da,aq:l}};Uc.prototype.JRd=function(){var n=this,O;var da=O=null;if(this.pja||!this.Fd.ruleType)return{returnValue:!0,errorString:O,aq:da};var l=(!this.Fd.VA||
1===this.Fd.VA)&&3!==this.Fd.ruleType&&7!==this.Fd.ruleType;return!function(){var K=n.bLb(n.Fd.eK,l);O=K.errorString;da=K.aq;return K}().returnValue||l&&!function(){var K=n.bLb(n.Fd.RQ,l);O=K.errorString;da=K.aq;return K}().returnValue?{returnValue:!1,errorString:O,aq:da}:l&&(1===this.Fd.ruleType||2===this.Fd.ruleType||6===this.Fd.ruleType)&&!ej.d(this.Fd.eK)&&!ej.d(this.Fd.RQ)&&parseFloat(this.Fd.eK)>parseFloat(this.Fd.RQ)?(O=Sd.a.instance.da(1647),da="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:O,aq:da}):{returnValue:!0,errorString:O,aq:da}};Uc.MT=function(n){switch(n){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Rc.ULS.shipAssertTag(537772042,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Uc.gpb=function(n,O){O.a=Xd(n.ruleType);O.b=Je(n.VA);O.c=!mf.a.na(n.eK);O.d=!mf.a.na(n.RQ);O.e=n.l4;O.f=n.m4;O.g=n.u4;O.h=!mf.a.na(n.oE);O.i=!mf.a.na(n.IU);O.j=n.t4;O.k=n.iZ;O.l=!mf.a.na(n.QS);
O.m=!mf.a.na(n.PS)};Jl.Object.defineProperties(Uc.prototype,{Fd:{configurable:!0,enumerable:!0,get:function(){return this.hOb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var n=this;return function(){n.YV(1);n.q5()}},set:function(n){Object(Qh.b)(Uc.prototype,this,"onCommitDialogHandler",n)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},RYb:{configurable:!0,enumerable:!0,
get:function(){return 3===this.v2.JOg}}});Object(hd.a)(Uc,"DataValidationEditDialogDeprecated",oj.a,[]);fc.prototype.UFa=function(n,O,da,l){fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new Yb(n,O,da,l)).RKd():(new Uc(n,O,da,l)).RKd()};fc.prototype.ZRg=function(n,O){var da=new bg.StandardDialog;da.lc=3;da.hza(n.Db.aia,Sd.a.instance.da(1640),O)};fc.prototype.bSg=function(n,O){var da=new bg.StandardDialog;da.lc=1;da.qW(n.Db.aia,Sd.a.instance.da(1641),O)};
Object(hd.a)(fc,"DataValidationEditDialogFactory",null,[369]);var Uj=of.a;Cm(ac,Uj);ac.prototype.Rd=function(){this.Hd([new xc(this.$,new fc)])};ac.la=function(n){of.a.ie(245,new ac(n))};Object(hd.a)(ac,"DataValidationEditCommandHandlerFactory",of.a,[]);Ob.G7f='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(hd.a)(Ob,"FileUploadDialogHTML",null,[]);var dg=b(366),Mj=Zh.a;Cm(Ae,Mj);Ae.prototype.ki=function(n,O,da,l,K){K=void 0===K?!0:K;this.uod=void 0===l?!1:l;this.Bfj(O);this.Hdf=n;K&&Ee.AFrameworkApplication.dF(n)};Ae.prototype.Bfj=function(n){if(Ae.cy)this.nhj(n);else{var O={};O[Ae.UFg]=n;O[Ae.$Fg]=CommonUIStrings.l_SendFileErrorReportMessage;O[Ae.aGg]=CommonUIStrings.l_SendFileErrorReportTextCaption;O[Ae.uTc]="";O[Ae.XFg]=CommonUIStrings.l_UserReportLinkText;O[Ae.iYb]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(Kc.a)(this,this.N$h,"legacyDialogHandler"),O);this.kW(Ae.fGg)}};Ae.prototype.nhj=function(n){var O={},da={},l={},K={},ka={};n=(ka.id=this.We,ka.bodyControls=(K.reportErrorCheckboxProps=this.uod?(O.label=CommonUIStrings.l_UserReportLinkText,O):null,K.textAreaProps=this.kef?{}:null,K.privacyStatementLinkProps=(l.text=CommonUIStrings.l_PrivacyStatement,l.handler=(da.href=Ee.AFrameworkApplication.hla,da.target="_blank",da),l),K),ka.errorMessage=n,ka.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
ka.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,ka);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Kc.a)(this,this.ozd,"reactDialogHandler"),n)};Ae.prototype.D6a=function(){if(!Ae.cy){var n=document.getElementById(Ae.cGg);n&&(n.className=Ae.bGg,n.appendChild(dg.createClusteredImage(32,32,Ae.ZFg,null,!0,CommonUIStrings.l_DialogError)));if(n=document.getElementById(Ae.dGg))n.innerText=CommonUIStrings.l_PrivacyStatement,n.href=Ee.AFrameworkApplication.hla,Bd.a.addHandler(n,
"click",Object(Kc.a)(this,this.ixi,"onPrivacyClickHandler"));this.kef||(n=document.getElementById(Ae.uTc))&&n.parentNode&&n.parentNode.removeChild(n);this.uod||(n=document.getElementById(Ae.WFg))&&n.parentNode&&n.parentNode.removeChild(n)}};Ae.prototype.CN=function(){Ae.cy||(Mj.prototype.CN.call(this),document.getElementById(this.hi("WACDialogPanel")).style.width=String.format("{0}px",400))};Ae.prototype.N$h=function(n,O){var da=O[Ae.uTc]||"",l=!0;void 0!==O[Ae.iYb]&&null!==O[Ae.iYb]&&(l=O[Ae.iYb]);
this.Mv(n,da,l)};Ae.prototype.ozd=function(n,O){this.Mv(n,O.text||"",O.reportErrorChecked)};Ae.prototype.Mv=function(n,O,da){this.Ddf&&(da&&Rc.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Hdf),this.Ddf(n,O,da))};Ae.prototype.ixi=function(n){Ee.AFrameworkApplication.Hb.Pe(vg.a.Nxa,2,n)};Jl.Object.defineProperties(Ae.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Jl.Object.defineProperties(Ae,{cy:{configurable:!0,enumerable:!0,get:function(){return Ee.AFrameworkApplication.za.Za.Ju&&
Ee.AFrameworkApplication.za.Za.Q4h}}});Ae.UFg="WACDialogErrorMessage";Ae.$Fg="WACDialogErrorReportMessage";Ae.aGg="WACDialogErrorTextPrompt";Ae.uTc="WACDialogInput";Ae.dGg="WACDialogPrivacyText";Ae.cGg="WACDialogIconPanel";Ae.ZFg="CancelRequest_32x32x32";Ae.bGg="WACDialogIcon";Ae.fGg="WACDialogTextPanel";Ae.iYb="WACDialogSendFileCheckbox";Ae.WFg="WACDialogSendFileCheckboxContainer";Ae.XFg="WACDialogSendFileCheckboxText";Ae.YFg="FileUploadErrorDialog";Object(hd.a)(Ae,"FileUploadErrorDialog",Zh.a,[]);
var wj=qi.a;Cm(ce,wj);ce.prototype.Hrg=function(n){this.addHandler("fileCollectionComplete",n)};ce.prototype.kTi=function(n){this.removeHandler("fileCollectionComplete",n)};ce.prototype.QMg=function(n,O,da){this.nyf=O;this.pG=n;this.Hrg(da);Ee.AFrameworkApplication.hla=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;n=new Ae(Object(Kc.a)(this,this.RMg,"collectFileInternal"));Ee.AFrameworkApplication.Hb.$b(vg.a.Nxa,Sg.a.frame,ce.XIi);n.ki(0,"",null,!1,!1)};ce.prototype.ZRi=function(n){this.kTi(n)};
ce.prototype.RMg=function(n,O){if(1===n&&!mf.a.na(this.pG.FileCollectionErrorStateId)){n=this.$.ra.xa;var da=this.pG.MessageId,l=this.pG.OriginalEcsServerId,K=this.pG.FileCollectionErrorStateId,ka=n.Ra(0);ka.errorMessageId=da;ka.ecsServerId=l;ka.fileCollectionErrorStateId=K;ka.userComment=O;n.NTc("CollectFile",ka,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};ce.XIi=function(n,O,da,l,K){Bd.a.rt(K);Ee.AFrameworkApplication.hla&&Z.HelperMethods.wf(Ee.AFrameworkApplication.hla,
void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(hd.a)(ce,"FileCollectionOperation",qi.a,[368,7]);var Ci=Sc.a;Cm(Ge,Ci);Ge.prototype.create=function(){var n=this;fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){n.Jb(n.Nkh)},this.ma,3)};Ge.prototype.dispose=function(){Ff.a.Ia(this.JOb);this.JOb=null;Ci.prototype.dispose.call(this)};Ge.la=function(n){n.ea.La(125,new Ge(n))};Jl.Object.defineProperties(Ge.prototype,
{Nkh:{configurable:!0,enumerable:!0,get:function(){return this.JOb||(this.JOb=new ce(this.$))}}});Object(hd.a)(Ge,"FileCollectionCommandHandlerFactory",Sc.a,[]);var Ig=b(912),rj=b(175),fk=b(260),Kj=b(1007);ud.nqh="GalleryGeneral";ud.pqh="GalleryNumber";ud.lqh="GalleryCurrency";ud.jqh="GalleryAccounting";ud.sqh="GalleryShortDate";ud.oqh="GalleryLongDate";ud.uqh="GalleryTime";ud.qqh="GalleryPercentage";ud.mqh="GalleryFraction";ud.rqh="GalleryScientific";ud.tqh="GalleryText";ud.yFg="ButtonComma";ud.buttonPercentage=
"ButtonPercentage";ud.keyboardNumber="KeyboardNumber";ud.keyboardCurrency="KeyboardCurrency";ud.keyboardDate="KeyboardDate";ud.keyboardTime="KeyboardTime";ud.keyboardPercentage="KeyboardPercentage";Object(hd.a)(ud,"RibbonFormatKind",null,[]);var ak=b(288),Ui=b(655),fj=b(654),sk=b(653),Nj=ak.a;Cm(Vc,Nj);Vc.prototype.X1=function(n){return Nj.prototype.X1.call(this,n)||this.Loh.X1(this.R6c,this.activeCell,this.format,this.Sie,this.Cwf,this.xwf,this.hWb,this.HDa,this.clientCorrelationId,this.Wib,this.ifb)};
Vc.prototype.Yl=function(){var n=[];if(this.u9b)for(var O=Ml(this.u9b),da=O.next();!da.done;da=O.next())n.push(sk.a(da.value));else n.push(new fj.a(this.format,this.R6c,this.activeCell));return function(){return new Ui.a(n)}};Vc.prototype.obb=function(){var n={OperationType:0};n.FormatCellsMultiRange=this.R6c;n.ActiveCell=this.activeCell;n.Format=this.format;n.ApplyFormatOnPivotTableValueField=this.Sie;n.PivotTableXluid=this.Cwf;n.PivotTableFieldCaption=this.xwf;return n};Jl.Object.defineProperties(Vc.prototype,
{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return fd.EwaSettings.wc()?Object(Qh.a)(Vc.prototype,this,"operationWorkingState"):0}},gr:{configurable:!0,enumerable:!0,get:function(){return this.Wib}},p3:{configurable:!0,enumerable:!0,get:function(){return this.ifb}},Dwc:{configurable:!0,enumerable:!0,get:function(){return this.HDa}}});Object(hd.a)(Vc,"FormatCellsBatchOperation",ak.a,[]);var Hi=b(193);Fc.left="Left";Fc.center="Center";Fc.right="Right";Object(hd.a)(Fc,"AlignmentType",
null,[]);$b.editCell="Edited";$b.dependentCell="Dependents";Object(hd.a)($b,"RecalcPriorityGroupType",null,[]);var Mi=b(212),xh=b(10);Object(hd.a)(Yf,"RecalcAccuracyObject",null,[]);Rd.string="String";Rd.blank="Blank";Rd.general="General";Rd.znh="Flexible";Object(hd.a)(Rd,"FormattedUnitKind",null,[]);Jl.Object.defineProperties(Gd.prototype,{success:{configurable:!0,enumerable:!0,get:function(){return this.Dkg}},reason:{configurable:!0,enumerable:!0,get:function(){return this.Zhb}},text:{configurable:!0,
enumerable:!0,get:function(){return this.ny}},valueType:{configurable:!0,enumerable:!0,get:function(){return this.$lg}},horizontalAlignment:{configurable:!0,enumerable:!0,get:function(){return this.Pfb}},fontColor:{configurable:!0,enumerable:!0,get:function(){return this.Bcg}},numberFormatIndex:{configurable:!0,enumerable:!0,get:function(){return this.Bgg}},Ird:{configurable:!0,enumerable:!0,get:function(){return this.Agg}},numberOfMeasureTextWidthCalls:{configurable:!0,enumerable:!0,get:function(){return this.Dgg}}});
Object(hd.a)(Gd,"ProcessedFormattedValue",null,[385]);Object(hd.a)(me,"RecalcResultProcessingStatistics",null,[]);Object(hd.a)(be,"RecalcedCellInfo",null,[]);var lj=b(109),zj=b(60);Yd.prototype.dispose=function(){this.calcManager=this.Ftc=this.Fi=this.grid=this.$=null};Yd.prototype.jzf=function(n){if(n&&n.rangeDeltas){for(var O=this.Zba.length,da=0;da<n.rangeDeltas.length;da++)n.rangeDeltas[da]&&n.rangeDeltas[da].data&&void 0!==n.rangeDeltas[da].data.value&&null!==n.rangeDeltas[da].data.value&&void 0!==
n.rangeDeltas[da].range&&null!==n.rangeDeltas[da].range&&Array.add(this.Zba,new be(n.rangeDeltas[da],n.stateId,n.isFinished,n.priorityGroup));Rc.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",n.stateId,n.priorityGroup,n.isFinished,n.rangeDeltas.length,O,this.Zba.length,this.lastSetCellInstantaneousOperation);!O&&this.Zba.length&&
this.Xqf(!1,0)}};Yd.prototype.jyd=function(n,O,da,l,K,ka){if(!O)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"Null");var $a=0,Lb=excelOnlineCalc.numfmt.renderCallback(l,function(Dc){$a++;return gridRenderer.CanvasRendererGlobals.measureTextWidth(Dc,K,!0,fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))}),bc=n.renderValue(O,Lb);if(!excelOnlineCalc.util.isSuccess(bc))return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"Finalize",$a);l=null;if(excelOnlineCalc.numfmt.isHashesValue(bc.value)){if(bc=
n.renderHashesValue(bc.value,Lb),!excelOnlineCalc.util.isSuccess(bc))return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"Hashes",$a)}else l=Yd.Woh(O,bc.value);Lb=bc.value;n=excelOnlineCalc.numfmt.renderedValueToString(Lb);O=gd(Lb);Lb=Le(Lb);return new Gd(!0,n,O,Lb,ka,da,void 0,$a,l)};Yd.prototype.Xqf=function(n,O){var da=this;this.$&&this.grid&&this.calcManager&&this.Ftc&&this.calcManager.oq?(n&&(this.Rba=this.Ftc.b2e),this.zJi(this.grid,this.calcManager.oq,n,O),!this.Rba&&this.Zba.length?ug.Task.delay(0).CWRCT(function(l){da.Xqf(!0,
l.id);return!0},null,0,zj.a.current):ug.Task.Ua(!0)):(Rc.ULS.sendTraceTag(574993421,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),ug.Task.Ua(!1))};Yd.prototype.zJi=function(n,O,da,l){var K=Z.HelperMethods.Kc();for(da=new me(this.Zba.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.Rba,void 0,void 0,void 0,da,void 0,l,!0,0,0,0,0,0,0);0<this.Zba.length;){l=Z.HelperMethods.Kc()-K;if(!this.Rba||l>this.Rba){da.numberOfCellsSkippedDueToTimeout=
this.Zba.length;break}l=Array.dequeue(this.Zba);if(Bf(l,da)){var ka=ui.Range.xd(l.rangeDelta.range.row+1,l.rangeDelta.range.column+1);(ka=n.Cc(ka))?Yd.uHg(l.stateId,ka.cell)?(Yd.hhc(n,ka,l,da),this.Wxg(O,ka,l,da)):da.numberOfCellsUpdatedAlreadyByServer++:da.numberOfCellsWithNoFormattedCell++}}l=Math.round(Z.HelperMethods.Kc()-K);this.Zyj(l);this.Imj(da,l);this.JXi(da)};Yd.prototype.Wxg=function(n,O,da,l){var K=zf(O,da),ka=da.rangeDelta.data.formatted,$a=ne(da);n=this.jyd(n,ka,$a,O.cell.fbb,O.cell.hZa,
K);if(n.success)O.text!==n.text&&(this.Fi.jlb(O,n),(K=mg(da))?1===K?K=2:(Rc.ULS.sendTraceTag(559957213,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),K=0):K=1,this.Fi.xCe(O,this.lastSetCellInstantaneousOperation,2,K,!0,!0),l.numberOfUpdatedCells++);else switch(n.reason){case "Null":l.numberOfRecalcedCellsWithoutFormattedValue=null==l.numberOfRecalcedCellsWithoutFormattedValue?0:l.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":l.numberOfHashFormattedValues=
null==l.numberOfHashFormattedValues?0:l.numberOfHashFormattedValues+1;break;case "Finalize":l.newNumberFormatterFinalizeFailures=null==l.newNumberFormatterFinalizeFailures?0:l.newNumberFormatterFinalizeFailures+1}"Null"!==n.reason&&(l.numberOfRecalcedCellsWithFormattedValue=null==l.numberOfRecalcedCellsWithFormattedValue?0:l.numberOfRecalcedCellsWithFormattedValue+1);l.numberOfMeasureTextWidthCalls=null==l.numberOfMeasureTextWidthCalls?0:l.numberOfMeasureTextWidthCalls+n.numberOfMeasureTextWidthCalls;
l=(da=mg(da))?O.formulaBarText:O.cell.userInput;K=n.text;Rc.ULS.sendTraceTag(558129553,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",O.range.top,O.range.left,n.success,n.reason,da,O.cell.numberFormatIndex,l?mf.a.GI(l):"null",K?mf.a.GI(K):"null")};Yd.prototype.Zyj=function(n){this.Rba=Math.max(this.Rba-Math.max(n,1),0)};Yd.prototype.Imj=function(n,O){n.numberOfNonUpdatedCells=
this.Zba.length;n.totalExecutionTime=O;n.newProcessingTimeLimit=this.Rba;n.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};Yd.prototype.JXi=function(n){n=Sys.Serialization.JavaScriptSerializer.serialize(n);Rc.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",n)};Yd.Woh=function(n,O){n=n.units;var da=O.units;if(n.length!==da.length)return Rc.ULS.sendTraceTag(557446483,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;O=[];for(var l=-1,K=0;K<n.length;K++)switch(n[K].kind){case Rd.blank:O.push.apply(O,lj.h(" ",da[K].str.length));break;case Rd.string:O.push(n[K].str);break;case Rd.znh:O.push("");l=K;break;case Rd.general:O.push(da[K].str);break;default:Rc.ULS.sendTraceTag(557446482,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=l||""===da[l].str)return null;da={};da.Start=O.slice(0,l).join("");da.Separator=n[l].str;da.End=O.slice(l+1,O.length).join("");return da};Yd.kvh=
function(n){return n&&n&&n.Sv?n.Sv.Vw:xh.a.Ve};Yd.uHg=function(n,O){if(!O)return!1;O=Yd.kvh(O);return O===xh.a.Ve||O===n};Yd.hhc=function(n,O,da,l){var K=da.rangeDelta.data.value.toString(),ka=ne(da),$a=zf(O,da);K=new Yf(ka,K,$a,da.priorityGroup);O.cell.hhc(K,n.Ha.CE);1===mg(da)?l.numberOfDependentRecalcedCellsInBatch++:l.numberOfEditedRecalcedCellsInBatch++};Yd.Vxe=20;Object(hd.a)(Yd,"CalcResultProcessor",null,[389,7]);Object(hd.a)(pd,"GetRibbonNumberFormatResult",null,[]);Wc.prototype.EGb=function(n,
O,da){var l=O.Border;O=O.BorderFormat;var K=0,ka=!1;if(l){for(var $a=0;3>=$a;$a++)Wc.gcj(n,da,$a,l)&&(K|=Z.HelperMethods.Prb($a),this.fQd(n.cell.getRange(),$a,O),ka=!0);Z.HelperMethods.hQ(l,16)&&!ej.c(n,0,da)&&(K|=2,this.fQd(n.cell.getRange(),0,O),ka=!0);Z.HelperMethods.hQ(l,32)&&!ej.c(n,2,da)&&(K|=4,this.fQd(n.cell.getRange(),2,O),ka=!0);ka&&(da=n.cell.Sv.mg,Z.HelperMethods.hQ(K,2)&&this.fSf(n,da,0)&&(K&=-3),Z.HelperMethods.hQ(K,1)&&this.eSf(n,da,1)&&(K&=-2),Z.HelperMethods.hQ(K,4)&&this.fSf(n,da,
2)&&(K&=-5),Z.HelperMethods.hQ(K,8)&&this.eSf(n,da,3)&&(K&=-9),n.cell.setBorders(O,K,!1))}else n.cell.XDf(),this.DRi(n.cell.getRange())};Wc.prototype.Dta=function(n,O){n=Wc.GNe(n,O);return n.isValidRange?(n=this.Ha.D0a(n))&&n.length?n:null:null};Wc.prototype.DRi=function(n){for(var O=0;3>=O;O++){var da=Wc.GNe(n,O);if(da.isValidRange&&(da=this.Ha.D0a(da))&&da.length)for(var l=Wc.MSe(O),K=0;K<da.length;K++)da[K].dBd(l)}};Wc.prototype.fQd=function(n,O,da){if(n=this.Dta(n,O))for(var l=Wc.MSe(O),K=Z.HelperMethods.Prb(l),
ka=0;ka<n.length;ka++){var $a=n[ka];this.j_h($a,l)&&Wc.setBorders($a,da,K,O,l)}};Wc.prototype.j_h=function(n,O){var da=n.Sv.mg,l=n.getRange();l=this.Dta(l,O);var K=!1,ka=!1,$a=!1,Lb=!1;l&&(K=Wc.L3a(l,!0),ka=Wc.L3a(l,!1),Lb=Wc.zid(l),$a=1===l.length?!0:!1);switch(O){case 0:return Wc.zZh(n,da,Lb,ka,$a);case 1:return Wc.wZh(n,da,Lb,K,$a);case 2:return Wc.xZh(n,da,Lb,K,$a);case 3:return Wc.yZh(n,da,Lb,ka,$a)}return!1};Wc.prototype.fSf=function(n,O,da){if(!n.cell.rZ)return!1;var l=n.range,K=this.Dta(l,
da),ka=ej.c(n,da,O),$a=!1;O=da?l.left<O.left:l.top<O.top;!Wc.iwb(n.cell)&&K&&1!==K.length&&($a=(da?Wc.L3a(K,!1):Wc.L3a(K,!0))?!1:!0);return!ka&&$a||O?!0:!1};Wc.prototype.eSf=function(n,O,da){var l=n.cell,K=this.Dta(l.getRange(),da);n=ej.c(n,da,O);O=!1;if(K){var ka=Wc.L3a(K,!0),$a=Wc.L3a(K,!1),Lb=ka&&!$a;$a=$a&&!ka;1!==da||Wc.Xwb(l)?3!==da||Wc.Xvb(l)||Wc.ncj(l,K,$a,Lb)&&(O=!0):Wc.mcj(l,K,ka,$a)&&(O=!0)}return!n&&O||Wc.iwb(l)?!0:!1};Wc.$Cg=function(n,O,da){var l={};l.LineStyle=Array(4);l.LineStyle[da]=
n.LineStyle[O];l.Color=Array(4);l.Color[da]=n.Color[O];return l};Wc.j3e=function(n,O,da,l,K){return Z.HelperMethods.hQ(n,K)&&ej.c(O,da,l)};Wc.gcj=function(n,O,da,l){return Wc.j3e(l,n,da,O,Z.HelperMethods.Prb(da))||Wc.j3e(l,n,da,O,64)||112===l};Wc.setBorders=function(n,O,da,l,K){O=Wc.$Cg(O,l,K);n.setBorders(O,da,!1)};Wc.GNe=function(n,O){switch(O){case 0:return new ui.Range(n.top-1,n.left,n.top-1,n.right,!1,!1);case 2:return new ui.Range(n.top,n.left-1,n.bottom,n.left-1,!1,!1);case 1:return new ui.Range(n.bottom+
1,n.left,n.bottom+1,n.right,!1,!1);case 3:return new ui.Range(n.top,n.right+1,n.bottom,n.right+1,!1,!1)}return n};Wc.MSe=function(n){switch(n){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Wc.L3a=function(n,O){for(var da=0;da<n.length;da++){var l=n[da];if(l.rZ)return O?Wc.Xvb(l):Wc.Xwb(l)}return!1};Wc.iwb=function(n){var O=n.Sv.mg,da=n.getRange();return n.rZ&&(da.top<O.top||da.bottom>O.bottom||da.left<O.left||da.right>O.right)?!0:!1};Wc.zid=function(n){for(var O=0;O<n.length;O++)if(Wc.iwb(n[O]))return!0;
return!1};Wc.mcj=function(n,O,da,l){if(!n.rZ){if(!da||Wc.zid(O))return!0}else if(Wc.Xvb(n)&&(1===O.length&&Wc.pyg(n,O[0])||!da))return!0;return l};Wc.ncj=function(n,O,da,l){if(!n.rZ){if(!da||Wc.zid(O))return!0}else if(Wc.Xwb(n)&&(1===O.length&&Wc.qyg(n,O[0])||!da))return!0;return n.Ija||l};Wc.zZh=function(n,O,da,l,K){var ka=n.getRange();return Wc.Xvb(n)?Wc.iwb(n)||K:O.top===ka.top||!l||da};Wc.wZh=function(n,O,da,l,K){var ka=n.getRange();return Wc.Xvb(n)?O.bottom===ka.bottom&&K:l&&!da||O.bottom===
ka.bottom};Wc.xZh=function(n,O,da,l,K){var ka=n.getRange();return Wc.Xwb(n)?Wc.iwb(n)||K:O.left===ka.left||!l||da};Wc.yZh=function(n,O,da,l,K){var ka=n.getRange();return n.Ija?!1:Wc.Xwb(n)?O.right===ka.right&&K:l&&!da||O.right===ka.right};Wc.Xvb=function(n){return 0<n.getRange().right-n.getRange().left};Wc.Xwb=function(n){return 0<n.getRange().bottom-n.getRange().top};Wc.qyg=function(n,O){n=n.getRange();O=O.getRange();return n.top===O.top&&n.bottom===O.bottom};Wc.pyg=function(n,O){n=n.getRange();
O=O.getRange();return n.left===O.left&&n.right===O.right};Object(hd.a)(Wc,"BorderModelAccessorHelper",null,[]);id.prototype.t$a=function(n,O,da,l,K,ka){n&&(n.Vya(O,da,void 0===K?!1:K,void 0===ka?!1:ka),n.verticalAlignment=l)};id.prototype.EGb=function(n,O,da){this.WX||(this.WX=new Wc(this.Ha,this.JY));this.WX.EGb(n,O,da)};Object(hd.a)(id,"FormatCellsActionModelAccessor",null,[388]);uc.prototype.isValid=function(){return this.gm&&this.oq?!(void 0===this.formatString||null===this.formatString):!1};
uc.prototype.fBh=function(){return null!=this.fE?this.fE:this.formatString};Jl.Object.defineProperties(uc.prototype,{fE:{configurable:!0,enumerable:!0,get:function(){return this.Fcg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.k6a)return this.k6a;if(this.jpa)return this.jpa.formatString;if(!this.gm)return null;if(null!=this.fE){var n=this.fE;return 0>n?(Rc.ULS.shipAssertTag(555032863,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(n=this.gm.lba[n])?this.k6a=
n.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.jpa?this.jpa:this.oq&&this.formatString?this.jpa=this.oq.createFormat(this.formatString,this.rFg).value:null}},rFg:{configurable:!0,enumerable:!0,get:function(){if(!this.gm||null==this.fE||0>this.fE)return!1;var n=this.gm.lba[this.fE];return n?n.Builtin:!1}}});Object(hd.a)(uc,"NumberFormatHolder",null,[387]);Object(hd.a)(gc,"FormatCellInstantaneousResult",null,[]);Object(hd.a)(wb,"FormatStringResult",
null,[]);var kf=b(1168),rd=b(526),ie=b(186);Zb.prototype.dispose=function(){Ff.a.rc([this.hQa,this.b2]);this.$=this.b2=this.hQa=null};Zb.prototype.$Pa=function(n,O,da,l,K,ka,$a,Lb,bc){return this.qgj(n,O,da,void 0===K?!1:K,void 0===Lb?0:Lb,void 0===ka?"":ka,void 0===bc?null:bc)};Zb.prototype.xCe=function(n,O,da,l,K,ka){var $a;($a=n.cell.Sv).kP=$a.kP|l;Zb.yOg(te.g(this.$),n,da,K);this.b2.lastSetCellInstantaneousOperation=O;ka&&te.g(this.$).Ui.S_(O,Yh.BasicTelemetryCalculator.bQ)};Zb.prototype.wma=
function(n,O,da,l,K,ka){l=void 0===l?!1:l;K=void 0===K?null:K;ka=void 0===ka?null:ka;var $a=void 0===$a?null:$a;ka=ka?ka:n.ga.ya.selectedRanges;if(!(-1690267012===O&&1<ka.length)){-1690267012===O&&Rc.ULS.shipAssertTag(595076181,0,1===ka.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",ka.length);var Lb=n.L9("FormatCellsAction.ShowInstantaneousFormatting",ka);try{Lb.$$rst();for(var bc=!1;Lb.$$mn();){var Dc=void 0,wd=Lb.$$cu().sM?n.rpc(Lb.$$cu().range):(Dc=new Aa.a,
Dc.add(Lb.$$cu()),Dc);Dc={};for(var ke=Ml(wd),jf=ke.next();!jf.done;Dc={Rcb:Dc.Rcb},jf=ke.next()){var Xf=jf.value;if(te.g(this.$).Oy&&Xf&&$a&&-1690267012===O&&(Dc.Rcb=Xf.range,Dc.Rcb&&$a.contains(Dc.Rcb)&&Gh.a.all(ka,function(Sf){return function(xg){return!jg.c(xg,Sf.Rcb)}}(Dc))))continue;if(!Xf||Lb.kd.contains(Xf.range))if(this.rgj(O,Xf,da,l,K,Lb.$$cu().sM),bc||(n.Ha.LU(),bc=!0),K)break}}}finally{Lb&&Lb.dispose()}}};Zb.prototype.jlb=function(n,O,da){if(da=void 0===da?null:da)da.WJa=!0;da=mf.a.na(O.text);
var l=mf.a.H6e(O.text),K,ka=n.sM?te.g(this.$).rpc(n.range):(K=new Aa.a,K.add(n),K);K=Ml(ka);for(ka=K.next();!ka.done;ka=K.next())this.Uxg(this.$,ka.value,O.text,O.horizontalAlignment,O.fontColor,O.numberFormatIndex,n.cell.numberFormatIndex,da,l,O.valueType,O.Ird);n.cell.VQd()};Zb.prototype.GEi=function(n,O,da,l,K){K=void 0===K?null:K;try{var ka=jg.D(O),$a=jg.D(da);if(n.kc.M3a(ka)||n.kc.M3a($a))return 8;if(-185374993!==l&&this.p6h(n,ka,$a))return 9;if(-185374993!==l&&(n.kc.c4a($a)||n.kc.wwb(ka)))return 10;
if(1804571062!==l&&n.kc.Caa($a))return 11;if(this.b5g($a))return 12;if(this.d7h(ka,$a))return 13;var Lb=this.$.Zb.Ic("UserAction","PasteInstantaneous");Lb.start();rd.a(Lb);K&&$d.b().AB(Lb.id,K.id,"actions","actions");!ka.isSingle&&$a.isSingle&&($a=Zb.pjh(ka,$a),n.ga.updateSelection($a,$a,0));switch(l){case 237279923:case 808159687:if(!this.$Ei(ka,$a))return 14;this.gYc(n,ka,$a,!0,!1);break;case 1804571062:this.gYc(n,ka,$a,!0,!1);break;case -185374993:this.gYc(n,ka,$a,!1,!0);break;default:return 2}Rc.ULS.sendTraceTag(22856009,
0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(bc){return Rc.ULS.sendTraceTag(25265219,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(bc)),15}};Zb.prototype.zLg=function(n,O){n=Ml(n);for(var da=n.next();!da.done;da=n.next())this.MVc(da.value,!0,O)};Zb.prototype.MVc=function(n,O,da){da=void 0===da?"":da;if(n){var l=te.g(this.$);if(O){if(O=l.$m("FormatCellsAction.ClearRangeInstantaneous",n),n=n.isSingle?null:n,O.$$mn()&&
void 0!==O.$$cu()&&null!==O.$$cu())for(l=Object.assign(new Nh.a,{Text:""}),this.$Pa(O.$$cu(),l,!1,void 0,Xg.a.$hd(this.$),da,void 0,void 0,n);O.$$mn();)void 0!==O.$$cu()&&null!==O.$$cu()&&this.$Pa(O.$$cu(),l,!1,void 0,!1,da)}else this.wma(l,-1228228458,{},void 0,void 0,[n])}else Rc.ULS.shipAssertTag(25241173,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};Zb.prototype.XOi=function(n,O){if(!O){O=Z.HelperMethods.Kc();var da=te.g(this.$),l=da.L9("FormatCellsAction.ReformatCells",
n);try{l.$$rst();for(var K=!1;l.$$mn();){var ka=l.$$cu().cell;ka.g2&&2!==ka.g2||(this.Jyj(ka,n),K||(da.Ha.LU(),K=!0))}}finally{l&&l.dispose()}Rc.ULS.sendTraceTag(554201370,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",Z.HelperMethods.Kc()-O)}};Zb.prototype.FYe=function(n,O){return this.Fg?n.formulaBarText?!mf.a.equals(O.Text,n.formulaBarText,!1):!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(n.cell.formattedText,O).isEqual:!mf.a.equals(O.Text,
n.text,!1)};Zb.prototype.Oxg=function(n){if(void 0===n||null===n)return new wb(!1,"1234.56");n=new uc(this.gm,this.oq,void 0,n);if(!n.isValid())return new wb(!1,"1234.56");n=this.jrb({value:"1234.56",type:1},n,244,"12px sans-serif");return n.success?new wb(!0,n.text):new wb(!1,"1234.56")};Zb.prototype.Jyj=function(n,O){var da=n.getRange(),l=!1;O=Ml(O);for(var K=O.next();!K.done;K=O.next())if(da.left===K.value.left){l=!0;break}n.Uvj(l)};Zb.prototype.qgj=function(n,O,da,l,K,ka,$a){var Lb=void 0;ka=
void 0===ka?"":ka;Lb=void 0===Lb?1:Lb;$a=void 0===$a?null:$a;var bc=new gc;bc.source=0;bc.WJa=!1;n.cell.originalIfmt=n.cell.numberFormatIndex;var Dc=O.Text,wd=mf.a.na(Dc),ke=mf.a.H6e(Dc);mf.a.io(Dc)&&(Rc.ULS.shipAssertTag(588350990,0,!((void 0===Dc||null===Dc)&&void 0!==O.TextRuns&&null!==O.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),O=Object.assign(new Nh.a,{Text:""}),Dc="");n.cell.userInput=Dc;if(!this.FYe(n,O))return this.cJg(n,K,wd,
ke,bc);da?this.WIg(n,Dc,this.$.workbookContext.DefaultHyperlinkStyle,bc):this.QIg(n,O,Dc,wd,ke,l,bc,$a);this.xCe(n,ka,K,Lb,bc.Ucc,bc.WJa);return bc};Zb.prototype.cJg=function(n,O,da,l,K){K.Q4f=!0;K.Ucc=!0;K.WJa=!1;O||te.g(this.$).Ha.LU();n.cell.rxa||(da?n.cell.Vya(0,!1):l&&n.cell.Vya(1,!1));return K};Zb.prototype.WIg=function(n,O,da,l){l.WJa=!0;n.insertHyperlink(O,Hi.a.k6c(O),da)};Zb.prototype.QIg=function(n,O,da,l,K,ka,$a,Lb){Lb=void 0===Lb?null:Lb;$a.WJa=!1;this.gm||(this.gm=this.$.ea.Ea(268,void 0));
this.Yrj(this.gm,n.cell.numberFormatIndex);l||K?this.SIg(n,l,K,$a):(l=new uc(this.gm,this.oq,n.cell.numberFormatIndex),l=this.Uoh(da,l,n.cell.fbb,n.cell.hZa),l.success?(this.qdj(O.TextRuns,O.Fonts)&&this.UIg(n,O,l),this.jlb(n,l,$a)):this.$Ig(n,O.Text),Rc.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",n.range.top,n.range.left,l.success,l.reason,n.cell.numberFormatIndex,mf.a.alb(n.cell.userInput),
mf.a.alb(l.text)));n.cell.formulaBarText=da;ka&&this.Erj(this.gm,n,da,Lb);$a.Ucc=!0};Zb.prototype.SIg=function(n,O,da,l){l.WJa=!0;n.text="";n.formulaBarText="";n.cell.userInput="";this.JUc(n,null,null,O,da)};Zb.prototype.UIg=function(n,O,da){this.hbc&&1===O.TextRuns.length&&n.cell.Gxg(O.Fonts[O.TextRuns[0].FontID]);O.Text===da.text&&2===da.valueType&&(this.hbc&&1===O.TextRuns.length?n.cell.text=O.Text:n.cell.formattedText=O)};Zb.prototype.$Ig=function(n,O){n.text=O;n.formulaBarText=O;this.JUc(n,1)};
Zb.prototype.JUc=function(n,O,da,l,K,ka){da=void 0===da?null:da;l=void 0===l?!1:l;K=void 0===K?!1:K;ka=void 0===ka?!1:ka;var $a=n.horizontalAlignment;da=null!=da?da:n.verticalAlignment;!n.cell.rxa&&(null!=O||l||K||ka)&&(l?$a=0:K||ka?$a=1:null!=O&&($a=O),this.rta.t$a(n,$a,!1,da,!0))};Zb.prototype.Yrj=function(n,O){n&&n.lba&&O>=Zb.fnh&&O>n.lba.length-1&&(Rc.ULS.sendTraceTag(574174605,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",
O),n.TLe())};Zb.prototype.Erj=function(n,O,da,l){l=void 0===l?null:l;if(void 0!==n&&null!==n)if(this.gm.Dfd)Rc.ULS.sendTraceTag(51709709,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var K=this.$.ea.Ea(266,void 0);K&&(this.b2.Rba=Yd.Vxe,n&&(this.b2.Rba=n.b2e),K.IGg(O,da,Object(Kc.a)(this.b2,this.b2.jzf,"processResults"),l))}};Zb.prototype.jrb=function(n,O,da,l){var K=this.$.ea.Ea(266,void 0);if(void 0===K||null===K)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"calcManager is null");
if(void 0===K.oq||null===K.oq)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"calcManager.NumberFormatter is null");if(void 0===this.gm||null===this.gm)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"instantaneousManager is null");if(void 0===O||null===O||!O.isValid())return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"numberFormatHolder is invalid or null");var ka=K.u$c(O);if(void 0===ka||null===ka)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"cellFormat is null");var $a=K.oq,Lb=
Ce(n);if(void 0===Lb||null===Lb)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"cellValue is null");K=excelOnlineCalc.calc.cellValueToReadOper(K.config.mathpack,Lb);if(void 0===K||null===K)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"readOper is null");ka=$a.applyFormat(ka,K);return excelOnlineCalc.util.isSuccess(ka)?this.b2.jyd($a,ka.value,n.type,da,l,null!=O.fE?O.fE:-1):new Gd(!1,void 0,void 0,void 0,void 0,void 0,"NumberFormatter.ApplyFormat: "+JSON.stringify(ka.reason.kind))};Zb.prototype.Uoh=
function(n,O,da,l){var K=this.$.ea.Ea(266,void 0);if(void 0===K||null===K)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"calcManager is null");if(void 0===K.oq||null===K.oq)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"calcManager.NumberFormatter is null");if(void 0===this.gm||null===this.gm)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"instantaneousManager is null");if(void 0===O||null===O||!O.isValid())return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"numberFormatHolder is invalid or null");
var ka=K.u$c(O);if(void 0===ka||null===ka)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"cellFormat is null");var $a=K.oq;n=$a.parseEdit(n,ka);if(!excelOnlineCalc.util.isSuccess(n))return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"ParseEdit failure: "+JSON.stringify(n.reason.kind));if(n.value.kind===Kj.a.formula)return new Gd(!1,void 0,void 0,void 0,void 0,void 0,"Main thread - skipping formula edit");K=excelOnlineCalc.numfmt.applyValueEdit($a,K.localeInfo,ka,n.value);if(!excelOnlineCalc.util.isSuccess(K))return new Gd(!1,
void 0,void 0,void 0,void 0,void 0,"NumberFormatter.FormatValueEdit: "+JSON.stringify(K.reason.kind));ka=n.value;Rc.ULS.shipAssertTag(559957249,0,ka.kind!==Kj.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ka=excelOnlineCalc.numfmt.getValueEditOperKind(ka);n=0;switch(ka){case 0:case 128:n=0;break;case 1:n=1;break;case 2:n=2;break;case 4:n=3;break;case 8:n=4;break;case 16:case 32:case 64:case 256:Rc.ULS.sendTraceTag(559957248,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",
ka);break;default:Rc.ULS.shipAssertTag(559957219,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",ka)}return this.b2.jyd($a,K.value,n,da,l,null!=O.fE?O.fE:-1)};Zb.prototype.p6h=function(n,O,da){if(O.width<da.width)for(var l=n.$m("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new ui.Range(O.top,O.left,O.bottom,O.left,!0,!0));l.$$mn();){var K=l.$$cu();if(K&&K.f2a())return Rc.ULS.sendTraceTag(22947533,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(O.height<da.height)for(n=n.$m("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new ui.Range(O.top,O.left,O.top,O.right,!0,!0));n.$$mn();)if((O=n.$$cu())&&O.l2a())return Rc.ULS.sendTraceTag(22947534,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};Zb.prototype.gYc=function(n,O,da,l,K){for(var ka=O.yW().FirstRow,$a=O.yW().LastRow,Lb=da.yW().LastRow,bc=ka,Dc=da.yW().FirstRow;Dc<=Lb;Dc++,bc++){bc>$a&&(bc=ka);var wd=O.yW();wd.FirstRow=wd.LastRow=
bc;var ke=da.yW();ke.FirstRow=ke.LastRow=Dc;this.bRg(n,rj.a.MP(wd),rj.a.MP(ke),l,K)}};Zb.prototype.$Ei=function(n,O){var da=this.$.ea.Ea(266,void 0);return void 0!==da&&null!==da?(da.CGg(n,O.topLeft,Object(Kc.a)(this.b2,this.b2.jzf,"processResults")),!0):!1};Zb.prototype.d7h=function(n,O){var da=n.right-n.left+1;n=n.bottom-n.top+1;var l=O.right-O.left+1;O=O.bottom-O.top+1;if(l>da&&O>n){if(!(l%da&&O%n))return!0}else if(l===da&&O>n){if(!(O%n))return!0}else if(l>da&&O===n&&!(l%da))return!0;return!1};
Zb.prototype.b5g=function(n){if(fd.EwaSettings.ka(104)){n=te.g(this.$).q0(n).gridView.getRangeInformation(n);n=Ml(n);for(var O=n.next();!O.done;O=n.next())if(O=O.value,Object(rf.a)(fk.DynamicArrayRange,O)&&!Object(pf.a)(fk.DynamicArrayRange,O).Zgc)return!0}return!1};Zb.prototype.bRg=function(n,O,da,l,K){if(da){this.hQa&&da.equals(this.hQa.range)||(Ff.a.Ia(this.hQa),this.hQa=n.$m("FormatCellsAction.CopyBetweenRows",da));O=n.$m("FormatCellsAction.CopyBetweenRows2",O);da=this.hQa;da.$$rst();for(var ka=
!1;da.$$mn();){O.$$mn()||(O.$$rst(),O.$$mn());var $a=O.$$cu(),Lb=void 0,bc=da.$$cu().sM?n.rpc(da.$$cu().range):(Lb=new Aa.a,Lb.add(da.$$cu()),Lb);Lb=Ml(bc);for(var Dc=Lb.next();!Dc.done;Dc=Lb.next())Dc=Dc.value,$a&&(l&&(this.fRg(Dc,$a),Dc.setCell(!0)),K&&(ka=this.dOh($a,Dc)),ka||(n.Ha.LU(),ka=!0));Vf.lastOrDefault(bc)}}else Rc.ULS.sendTraceTag(22856010,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};Zb.prototype.MTf=function(){var n=qd.a.Ad(1,0,0,626,0,104573951,"PivotTableContextMenuOperationFailure");
V.a(this.$).ki(n)};Zb.prototype.Ofi=function(n,O){var da={ValidMembers:32},l=O.NumberFormat;switch(n){case 1890566896:if(1001===l||1002===l||1003===l){da.NumberFormat=14;da.NumberFormatOptions={};switch(l){case 1001:da.NumberFormatOptions.TimeType=2;break;case 1002:da.NumberFormatOptions.DateType=7;break;case 1003:da.NumberFormatOptions.DecimalPlaces=0}da.NumberFormatOptions.NumberFormatCategory=this.Ixg(l)}else da.NumberFormat=l;break;case 1886928607:da.NumberFormat=13;break;case -992833457:da.NumberFormat=
11;break;case 218524921:da.NumberFormat=12;break;case 996232352:da.NumberFormat=14;da.NumberFormatOptions=Object.assign(new Ig.a,{DecimalPlaces:0});da.NumberFormatOptions.NumberFormatCategory=6;break;default:return O}return da};Zb.prototype.formatCells=function(n,O,da,l,K,ka,$a){l=void 0===l?null:l;K=void 0===K?null:K;ka=void 0===ka?null:ka;$a=void 0===$a?null:$a;var Lb=this.$.Zb.Ic("UserAction","FormatCellsInstantaneous, command = "+$d.b().ji(n)),bc=this.$.Zb.yi("UserAction","FormatCellsInstantaneousFrame");
bc.start();rd.a(bc);var Dc=$d.b().ji(n),wd=this.$,ke=te.g(wd),jf=ke.ga.ya,Xf=K?K:jf.selectedRanges,Sf=lj.g(Xf,function(dk){return dk.XO});Dc=String.format("{0}, cellCount={1}",Dc,Sf);te.g(this.$).Ui.Xca(1,Lb.id,Dc);Xf=jg.r(Xf,this.$);jf=jf.activeCell;Dc=-168056295===da.command;var xg=Sf=null;if(Dc){xg=ke.kc.hq(jf);if(!xg){this.MTf();return}Sf=xg.Gba.substring(1,xg.Gba.length-1);xg=xg.t7b();if(!xg){this.MTf();return}xg=xg.Caption}ke.Vi.fG(!1,!0);var xi=jg.o(jf,wd),Oi=wd.ra.xa.dc(!0),pj=this.Ofi(da.command,
O);Dc||this.wma(ke,n,O,!1,l,K);Lb.stop();te.g(this.$).Ui.S_(Lb.id,Yh.BasicTelemetryCalculator.bQ);da.DXh=cg.a.Ta.Lb;l=this.$.Zb.Ic("UserAction","FormatCellsUserAction");this.wci(n,da.taskId,O,Xf,jf,l.id);$d.b().AB(Lb.id,l.id,"actions","actions");$d.b().AB(bc.id,l.id,"actions","actions");fd.EwaSettings.wc()?wd.userOperationManager.oc(new Vc(this,Xf,xi,pj,Dc,Sf,xg,Oi,l,Lb.id,64,ka,$a),da):wd.userOperationManager.oc(new Vc(this,Xf,xi,pj,Dc,Sf,xg,Oi,l,Lb.id,0,ka,$a),da)};Zb.prototype.Yri=function(n,O){if(n&&
!Cf.a(n)&&O){var da=!!n&&!!n.RequestTelemetryData;te.g(this.$).Ui.fka(O.toString(),n.StateId,da?n.RequestTelemetryData.EcsOperationDuration:0,da?n.RequestTelemetryData.EcsRequestDuration:0,da?n.RequestTelemetryData.WfeRequestDuration:0)}};Zb.prototype.X1=function(n,O,da,l,K,ka,$a,Lb,bc,Dc,wd){var ke=this,jf=this.$;return function(Xf,Sf,xg){jf.Ss();Xf=[Xf,Object(Kc.a)(ke,ke.Yri,"onFormatCellOperationWebMethodSuccess")];Sf=[Sf];Dc&&Xf.push(Dc);wd&&Sf.push(wd);return nf.q(jf.ra.xa,n,O,da,l,K,ka,Lf.b.apply(null,
Xf),Lf.a.apply(null,Sf),xg,bc,$a,Lb)}};Zb.prototype.rgj=function(n,O,da,l,K,ka){if(O&&da){var $a=da.Font,Lb=da.HorizontalAlignment,bc=da.VerticalAlignment;da.ValidMembers&2||(Lb=O.horizontalAlignment);da.ValidMembers&1||(bc=O.verticalAlignment);var Dc=!!Lb;Zb.EZh(n)&&!Lb&&(Lb=this.dRe(O));var wd=!1;switch(n){case -394785302:this.rta.t$a(O,Lb,Dc,0);break;case 1041132226:this.rta.t$a(O,Lb,Dc,1);break;case -571165336:this.rta.t$a(O,Lb,Dc,2);break;case -1150205178:case -1142465846:case -286432209:this.rta.t$a(O,
Lb,Dc,bc,!1,!1);break;case 1650812936:this.setFillColor(O,da,ka);break;case -287251124:O.bold=$a.Bold;break;case -1690267012:te.g(this.$).ga.ya.Eh&&($a=te.g(this.$).ga.ya.Xd,this.rta.EGb(O,da,$a));break;case 1970784898:da=Mi.a.Bp(O.color,O.backgroundColor);if(Zg.a.compare(da,Zg.a.red)&&(mf.a.OU(O.text)||mf.a.LYe(O.text)))break;$a=Zg.a.wG($a.FontColor);O.color=ie.c(Mi.a.qF($a));break;case -1925065947:O.italic=$a.Italic;break;case -1293291468:da=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
O.lHd($a.FontName,da,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:O.fontSize=$a.FontSize;this.$.If();break;case -1077965542:O.fontSize=$a.FontSize;break;case 1764140053:O.underline=$a.Underline;break;case -1685033574:O.doubleUnderline=$a.DoubleUnderline;break;case -1590502662:O.fontStrikethrough=$a.Strikethrough;break;case -848953656:case 2045211913:wd=O.$mb();break;case 2105621672:$a=Object(pf.a)(kf.a,K);if(!$a)break;da=Zg.a.Pph($a.color);O.color=ie.c(Mi.a.qF(da));this.Zie(O,
$a.k6a);break;case -1409276245:this.Zie(O,da.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.Txg(O,da);break;case -1228228458:O.$mb();O.clearFormat();this.QQc(O,0);wd=!0;break;case -730106152:O.clearFormat();this.QQc(O,0);break;case 932244020:this.g6i(O,da,ka);break;case -1942512156:case -1920201820:this.Y7i(O,da)}l||(wd?O.S8a(!0):O.setCell(!0))}else Rc.ULS.shipAssertTag(22856011,0,!O,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Rc.ULS.shipAssertTag(22856012,
0,!da,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};Zb.prototype.fRg=function(n,O){n&&O?(n.GZb(O),n.fWc(O),this.QQc(n,O.cell.numberFormatIndex)):Rc.ULS.sendTraceTag(22856013,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};Zb.prototype.QQc=function(n,O){if(0>O)this.IZ("ApplyNumberFormatIndexOnCell",n,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(O=new uc(this.gm,this.oq,O),O.isValid()){var da=
this.jrb(n.pAa,O,n.cell.fbb,n.cell.hZa);da.success?(this.jlb(n,da),this.IZ("ApplyNumberFormatIndexOnCell",n,!0,void 0,da,O)):this.IZ("ApplyNumberFormatIndexOnCell",n,!1,da.reason)}else this.IZ("ApplyNumberFormatIndexOnCell",n,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};Zb.prototype.Zie=function(n,O){if(void 0===O||null===O)this.IZ("ApplyNumberFormatStringOnCell",n,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(O=new uc(this.gm,this.oq,void 0,O),O.isValid()){var da=
this.jrb(n.pAa,O,n.cell.fbb,n.cell.hZa);da.success?(this.jlb(n,da),this.IZ("ApplyNumberFormatStringOnCell",n,!0,void 0,da,O)):this.IZ("ApplyNumberFormatStringOnCell",n,!1,da.reason)}else this.IZ("ApplyNumberFormatStringOnCell",n,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};Zb.prototype.Txg=function(n,O){if(O=void 0===O?null:O)if(O=this.MGh(n,O),O.success){var da=this.jrb(n.pAa,O.nhc,n.cell.fbb,n.cell.hZa);da.success?(this.jlb(n,da),this.IZ("ApplyNumberFormatCategoryOnCell",n,
!0,void 0,da,O.nhc)):this.IZ("ApplyNumberFormatCategoryOnCell",n,!1,da.reason,void 0,O.nhc)}else this.IZ("ApplyNumberFormatCategoryOnCell",n,!1,O.reason,void 0,O.nhc);else this.IZ("ApplyNumberFormatCategoryOnCell",n,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};Zb.prototype.Ixg=function(n){switch(n){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<n?-1:n};Zb.prototype.MGh=
function(n,O){if(!this.gm||!this.localeInfo||!O)return n=this.gm?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new pd(!1,void 0,"GetRibbonNumberFormat: "+n);O=O.NumberFormat;switch(O){case 0:n=ud.nqh;break;case 1:n=ud.pqh;break;case 2:n=ud.lqh;break;case 3:n=ud.jqh;break;case 4:n=ud.sqh;break;case 5:n=ud.oqh;break;case 6:n=ud.uqh;break;case 7:n=ud.qqh;break;case 8:n=ud.mqh;break;case 9:n=ud.rqh;break;case 10:n=ud.tqh;break;case 11:case 12:return this.gm.TLe(),
this.Axh(n,O);case 13:n=ud.yFg;break;case 1006:n=ud.buttonPercentage;break;case 1004:n=ud.keyboardNumber;break;case 1005:n=ud.keyboardCurrency;break;case 1002:n=ud.keyboardDate;break;case 1001:n=ud.keyboardTime;break;case 1003:n=ud.keyboardPercentage;break;case 14:return n="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",Rc.ULS.shipAssertTag(555032900,0,!1,n),new pd(!1,void 0,n);default:return n="GetRibbonNumberFormat: unknown NumberFormatType!",Rc.ULS.shipAssertTag(555032899,
0,!1,n),new pd(!1,void 0,n)}if(!n)return new pd(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");n=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,n);if(!n)return new pd(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");n=new uc(this.gm,this.oq,void 0,n);return new pd(!0,n)};Zb.prototype.Axh=function(n,O){if(!this.calcManager||!this.oq)return O=this.calcManager?"numberFormatter is null":"calcManager is null",
new pd(!1,void 0,"GetDecimalChangeNumberFormat: "+O);n=this.calcManager.u$c(new uc(this.gm,this.oq,n.cell.numberFormatIndex));if(!n)return new pd(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");O=this.oq.changeFormatDecimals(n,11===O?1:-1);if(!excelOnlineCalc.util.isSuccess(O))return new pd(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");if(void 0===O.value||null===O.value)return new pd(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");
O=new uc(this.gm,this.oq,void 0,void 0,O.value);return new pd(!0,O)};Zb.prototype.IZ=function(n,O,da,l,K,ka){l=void 0===l?"":l;K=void 0===K?null:K;ka=(ka=void 0===ka?null:ka)?ka.fE?ka.fE.toString():mf.a.alb(ka.formatString):"null";var $a=mf.a.alb(O.pAa.value)||"null";K=K?mf.a.alb(K.text)||"null":"null";n=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",n,O.range.top,
O.range.left,da,l,$a,O.pAa.type,ka,K);Rc.ULS.sendTraceTag(555032898,0,50,n)};Zb.prototype.Uxg=function(n,O,da,l,K,ka,$a,Lb,bc,Dc,wd){Lb=void 0===Lb?!1:Lb;bc=void 0===bc?!1:bc;var ke=O.cell;ke.g2=void 0===Dc?0:Dc;Dc=O.text;Dc!==da&&(ke.text=da);ke.Ird=void 0===wd?null:wd;ej.e(Dc)?O.formulaBarText=Dc:O.formulaBarText="";n=te.g(n).kc.G4h(O.range);this.JUc(O,l,null,Lb,bc,n);K&&(O.color=ie.c(Mi.a.qF(K)));O.cell.numberFormatIndex=ka;O.cell.originalIfmt=$a;O.cell.nVf=ka};Zb.prototype.wci=function(n,O,da,
l,K,ka){var $a={};$a.a=this.$.Ba.UserSessionId;$a.b=O;$a.c=l.Ranges.length;$a.d=this.fVg(l.Ranges);$a.e=K.toString();$a.f=n;$a.h=ka;1890566896===n?$a.g=da.NumberFormat.toString():2105621672===n&&($a.g=da.NumberFormatOptions.NumberFormatCategory.toString());$d.b().Se(3,$a,!0)};Zb.prototype.fVg=function(n){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656060_logRangesAccomulativeDataForFormatCellInvestigation")){for(var O=0,da=0,l=0,K=0;K<n.length;K++){var ka=jg.B(n[K]).XO;O+=ka;ka>l&&(l=ka,da=
K)}n=jg.B(n[da]).toString();return"TotalCellCount:"+O+"; Max range:"+n+"; MaxRangeSize:"+l+";"}O=Math.min(Zb.Wef,n.length);l="";for(da=0;da<O;da++)l+=jg.B(n[da]).toString()+" ; ";n.length>Zb.Wef&&(l+="and more");return l};Zb.prototype.g6i=function(n,O,da){64===(O.ValidMembers&64)&&this.setFillColor(n,O,da);16===(O.ValidMembers&16)&&Zb.E7i(n,O);128===(O.ValidMembers&128)&&this.rta.EGb(n,O,n.range);if(2===(O.ValidMembers&2)||1===(O.ValidMembers&1)){da=O.VerticalAlignment;O=O.HorizontalAlignment;var l=
!!O;fd.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!l&&this.dRe(n);this.rta.t$a(n,O,l,da)}};Zb.prototype.setFillColor=function(n,O,da){(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?n.T$:n.T$&&n.R9b&&!n.Etb&&!n.V9b)||(O=-1===O.FillColor?da?Mi.a.qF(Zg.a.white):null:Mi.a.qF(Zg.a.wG(O.FillColor)),n.backgroundColor=O?ie.c(O):null)};Zb.prototype.Y7i=function(n,O){n.horizontalAlignment&&2!==n.horizontalAlignment||
n.Vya(1,!1);0<=n.indentation+O.IndentationIncrease&&(n.indentation+=O.IndentationIncrease)};Zb.prototype.dRe=function(n){var O=new uc(this.gm,this.oq,n.cell.numberFormatIndex);if(!O.isValid())return 0;n=this.jrb(n.pAa,O,n.cell.fbb,n.cell.hZa);return n.success?null!=n.horizontalAlignment?n.horizontalAlignment:0:0};Zb.prototype.f9i=function(n,O,da){this.WX||(this.WX=new Wc(te.g(this.$).Ha,this.$));this.WX.EGb(n,O,da)};Zb.prototype.dOh=function(n,O){var da=new Nh.a;if(n.cell.formulaBarText&&n.cell.formulaBarText.startsWith("'"))da.Text=
n.cell.formulaBarText;else{var l=n.cellValue;l&&4!==n.cell.g2||(l=n.text);da.Text=l}this.$Pa(O,da,!1,void 0,Xg.a.$hd(this.$));return!0};Zb.prototype.qdj=function(n,O){return this.Fg&&!!n&&!!O};Zb.yOg=function(n,O,da,l){l&&O.setCell(!0);da||n.Ha.LU()};Zb.pjh=function(n,O){O=O.clone();O.height<n.height&&(O.bottom=O.top+n.height-1);O.width<n.width&&(O.right=O.left+n.width-1);return O};Zb.EZh=function(n){switch(n){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}};Zb.E7i=function(n,O){O=O.Font;var da=!!(O.ValidMembers&16),l=!!(O.ValidMembers&16),K=!!(O.ValidMembers&16);n.bold=!!(O.ValidMembers&4);n.italic=!!(O.ValidMembers&8);da&&(n.underline=da);l&&(n.doubleUnderline=l);K&&(n.fontStrikethrough=K);da=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");n.lHd(O.FontName,da,"SetFont");n.fontSize=O.FontSize;da=Mi.a.Bp(n.color,n.backgroundColor);Zg.a.compare(da,Zg.a.red)&&(mf.a.OU(n.text)||mf.a.LYe(n.text))||(O=
Zg.a.wG(O.FontColor),n.color=ie.c(Mi.a.qF(O)))};Jl.Object.defineProperties(Zb.prototype,{rta:{configurable:!0,enumerable:!0,get:function(){return this.Moh}},oq:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.oq}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});Zb.Wef=10;Zb.fnh=36;Object(hd.a)(Zb,"FormatCellsAction",null,
[367,7]);var Lh=Sc.a;Cm(Zd,Lh);Zd.prototype.create=function(){this.Jb(new Zb(this.$))};Zd.la=function(n){n.ea.La(18,new Zd(n))};Object(hd.a)(Zd,"FormatCellsActionFactory",Sc.a,[]);Object(hd.a)(jd,"FormulaAssistanceUIContext",null,[]);var M=Sc.a;Cm(Ma,M);Ma.prototype.create=function(){var n=this,O=this.$.ea.Ea(448,void 0);if(O)this.Jb(O);else{var da=Nf.GetServiceTaskFactory.Xa(this.$.ea,283,284,this.vb,"Common.IDynamicScriptLoaderProvider");fe.TaskExtensions.Da(da,function(){fe.TaskExtensions.Da(Ie.c(da.result.xq.loadScript(n.h2i)),
function(){O=n.$.ea.Ea(448,void 0);if(!O){var l=Object.assign(new jd,{isFeedbackAllowed:n.$.isFeedbackEnabled});O=n.$.ea.La(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(l));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609490_FormulaAssistanceUiUpdateContext_V2")&&n.$.upe(function(){var K={};K.isFeedbackAllowed=n.$.isFeedbackEnabled;O.updateContext(K)})}n.Jb(O)},n.$.ma,3)},this.$.ma,3)}};Ma.la=function(n){n.ea.La(449,new Ma(n))};Object(hd.a)(Ma,"FormulaAssistanceUIControlFactory",
Sc.a,[]);var ya=b(679);Object(hd.a)(yb,"FreezePanesCommandParameters",null,[]);var Eb=b(171),jc=b(384),od=b(263),Fe=b(285),Oe=b(121);kb.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(hd.a)(kb,"MacroRecorderSheetPaneFrozenPayload",null,[115]);Pb.prototype.$c=function(n,O){var da=!1;switch(O){case 1844679312:da=1!==n&&!this.gridView.$a.U3}return da};Pb.prototype.executeCommand=function(n,O){n=this.gridView.$a;var da=this.gridView.qbd();Ee.AFrameworkApplication.za.Za.sC&&
this.$.XKa&&(1844679312===O.command||340334732===O.command||-806625837===O.command)&&ya.ShyRibbon.iT(1,2);switch(O.command){case 1844679312:return this.setFreezePanes(O,da,n.lj);case 340334732:return n.C5b?ug.Task.Ua(!1):this.H7i(O,da);case -806625837:return n.Mza?ug.Task.Ua(!1):this.I7i(O,da)}return ug.Task.Ua(!1)};Pb.prototype.Jc=function(n,O){n=!1;switch(O.command){case 1844679312:case 340334732:case -806625837:case 1745254833:n=!0}return n};Pb.prototype.gd=function(){return!1};Pb.prototype.setFreezePanes=
function(n,O,da){if(da)return this.Ipc(n,!1,0,0,0,0,O,null);var l=this.gridView.ga.ya;da=l.activeCell.clone();l=l.activeRange;l.Yh&&(Rc.ULS.sendTraceTag(571758297,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",da.top,da.bottom,O.top),da.top=da.bottom=O.top);l.isRow&&(Rc.ULS.sendTraceTag(571758296,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",
da.left,da.right,O.left),da.left=da.right=O.left);da.top===O.top&&da.left===O.left&&(da=ui.Range.xd(da.top+1,da.left));l=da.top-1;var K=da.left-1,ka=l-(O.top-1),$a=K-(O.left-1);return this.HAj(da,ka,$a)?this.Ipc(n,!0,l,K,ka,$a,O,da):(this.$.If(),this.Juf(),ug.Task.Ua(!0))};Pb.prototype.H7i=function(n,O){return this.Ipc(n,!0,0,O.left,0,1,O,null)};Pb.prototype.I7i=function(n,O){return this.Ipc(n,!0,O.top,0,1,0,O,null)};Pb.prototype.HAj=function(n,O,da){var l=this.gridView.Mg(n),K=this.gridView.view.visibleArea;
return!l||K.topLeft.y>l.bottomRight.y||K.topLeft.x>l.bottomRight.x||K.bottomRight.y<l.bottomRight.y||K.bottomRight.x<l.bottomRight.x?(Rc.ULS.sendTraceTag(17683602,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",n,l?l.toString():"null",K.toString()),n=qd.a.Ad(1,0,26,1418,0,2105967339,"FreezePaneSelectionNotInViewErr"),fd.EwaSettings.rC()?new Wg.a(this.$,n):(n=new ch.ErrorDialog(this.$,
n),n.initialize(),n.Bf()),!1):0>=O&&0>=da?(Rc.ULS.sendTraceTag(17683601,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),n=te.g(this.$).rtl?1420:1419,O=te.g(this.$).rtl?-2131054257:-1953454131,n=qd.a.Ad(1,0,26,n,0,O,"FreezePaneA1SelectedErr"),fd.EwaSettings.rC()?new Wg.a(this.$,n):(n=new ch.ErrorDialog(this.$,n),n.initialize(),n.Bf()),!1):!0};Pb.prototype.Ipc=function(n,O,da,l,K,ka,$a,Lb){function bc(){return new kb(wd)}var Dc=this;this.uyd=V.a(this.$).K8(5,
"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.LX(Object(Kc.a)(this,this.dnf,"onFreezePanesUpdateCompleted"));this.JE.nza();this.gridView.Vkj(O?"":"UnsetFreezePane");this.Y9i(n,O,this.gridView.$a);var wd=Object.assign(new yb,{SheetName:this.$.sa.name,Freeze:O,FrozenRows:K,FrozenColumns:ka,FirstRow:da,FirstColumn:l});Rc.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",
O,K,ka,da,l);this.n6b=cg.a.Ta.we;return hg.a(this.$.userOperationManager,function(ke,jf,Xf){if(fd.EwaSettings.ka(61)){var Sf=window.performance;Sf.clearMarks();Sf.mark("FreezePanes request sent")}Sf=Dc.gridView.hs;Dc.$.ka(744)&&Sf?(Sf=Dc.S9g(wd,Sf,$a,Lb),Dc.Frj(Sf)):Dc.$.Ss();Sf=Dc.$.ra.xa;var xg=Sf.Ra(9,null);xg.freezeSettings=wd;return nf.i(Sf,"FreezeOrUnfreezePanes",xg,ke,jf,Xf,O,0)},function(ke){return new bh.a(151,0,ke,void 0,bc)},n)};Pb.prototype.S9g=function(n,O,da,l){Rc.ULS.shipAssertTag(562319369,
1,!!O,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!n.Freeze)return null;var K=Fe.a();K.State=1;K.IsEstimated=!0;var ka=!1,$a=!1,Lb=O.kU(ui.Range.xd(da.top,da.left)),bc=n.FrozenRows,Dc=n.FrozenColumns;1!==n.FrozenRows||n.FrozenColumns?n.FrozenRows||1!==n.FrozenColumns?(Dc=O.kU(ui.Range.xd(n.FirstRow+1,n.FirstColumn+1)),O=O.kU(ui.Range.xd(da.top,da.left)),K.Width=Dc.Zl-Lb.Zl,K.Height=Dc.Pm-Lb.Pm,0<n.FrozenRows&&(K.AbsoluteTop=Dc.Pm,$a=!0),
0<n.FrozenColumns&&(K.AbsoluteLeft=Dc.Zl,ka=!0),bc=Dc.mN-O.mN,Dc=Dc.HL-O.HL):(K.Width=O.SFh(Eb.a.xd(da.top,da.left)),l=ui.Range.xd(da.top,da.left+1),K.AbsoluteLeft=Lb.Zl+K.Width,ka=!0):(K.Height=O.QFh(Eb.a.xd(da.top,da.left)),l=ui.Range.xd(da.top+1,da.left),K.AbsoluteTop=Lb.Pm+K.Height,$a=!0);$a&&(K.FirstFrozenRow=da.top,K.FirstScrollableRow=l.top);ka&&(K.FirstFrozenColumn=da.left,K.FirstScrollableColumn=l.left);K.VisibleRows=bc;K.VisibleColumns=Dc;return K};Pb.prototype.Frj=function(n){var O=this;
ug.Task.delay(this.$.Ba.GetRangeContentPrefetchDelayInMs).continueWith(function(){O.$.sa&&O.$.fa&&(O.$.fa.FW(xh.a.Ve,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),jc.b(O.$.sa,n,-1,void 0,!0))})};Pb.prototype.Y9i=function(n,O,da){if(!fd.EwaSettings.ka(714))switch(n.command){case 1844679312:if(O||-1===this.hJa&&-1===this.iJa)this.hJa=da.Ow-da.width+this.gridView.scrollLeft,this.iJa=da.Pw-da.height+this.gridView.scrollTop;break;case 340334732:if(O||-1===this.hJa)this.hJa=da.Ow-da.width+
this.gridView.scrollLeft;break;case -806625837:if(O||-1===this.iJa)this.iJa=da.Pw-da.height+this.gridView.scrollTop}};Pb.prototype.doc=function(){var n=this.gridView.$a;0<n.width?this.gridView.scrollLeft=Oe.a.QXb(this.gridView.domElement,te.g(this.$).rtl,0):-1!==this.hJa&&(this.gridView.scrollLeft=this.hJa,this.hJa=-1);0<n.height?this.gridView.scrollTop=0:-1!==this.iJa&&(this.gridView.scrollTop=this.iJa,this.iJa=-1)};Pb.prototype.Juf=function(){this.JE.zQa();Ff.a.Ia(this.uyd);this.uyd=null;this.gridView.$Q(Object(Kc.a)(this,
this.dnf,"onFreezePanesUpdateCompleted"))};Pb.prototype.dnf=function(){fd.EwaSettings.ka(714)||this.doc();if(this.n6b){var n=od.a(cg.a.Ta.we,this.n6b);Rc.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",n);this.n6b=null}this.Juf()};Object(hd.a)(Pb,"FreezePanesCommandHandler",null,[159]);var Qe=of.a;Cm(Ue,Qe);Ue.prototype.Rd=function(){var n=this;fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,
12,477,this.vb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),function(O){n.Hd([new Pb(n.$,O.result)])},this.$.ma)};Ue.la=function(n){n.ea.La(116,new Ue(n))};Object(hd.a)(Ue,"FreezePanesCommandHandlerFactory",of.a,[]);var $f=b(921),Rf=Sc.a;Cm(Ke,Rf);Ke.prototype.create=function(){var n=this,O=Nf.GetServiceTaskFactory.create(this.$.ea,18,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),da=Nf.GetServiceTaskFactory.create(this.$.ea,102,
this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([O,da],this.ma),function(){n.Jb(n.$.ea.Ea(296,void 0)||n.$.ea.La(296,new $f.BorderFormatManager(n.$,O.result,da.result)))},this.ma,3)};Ke.la=function(n){fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&n.ea.La(468,new Ke(n))};Object(hd.a)(Ke,"BorderFormatManagerFactory",Sc.a,[]);var uh=b(942),Tg=b(24),yh=b(100),Ah=b(275),aj=b(349),
ei=b(346),mj=b(93),tj;(function(n){n[n.insert=1]="insert";n[n.delete=2]="delete";n[n.rows=4]="rows";n[n.columns=8]="columns";n[n.cellsShiftHorizontal=16]="cellsShiftHorizontal";n[n.cellsShiftVertical=32]="cellsShiftVertical";n[n.insertRows=5]="insertRows";n[n.insertColumns=9]="insertColumns";n[n.insertCellsShiftRight=17]="insertCellsShiftRight";n[n.insertCellsShiftDown=33]="insertCellsShiftDown";n[n.deleteRows=6]="deleteRows";n[n.deleteColumns=10]="deleteColumns";n[n.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";
n[n.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(tj||(tj={}));Object(hd.b)("InsertDeleteCellFlags",tj);var nh=b(412);Object(hd.a)(he,"MacroRecorderRangeInsertedOrDeletedPayload",null,[115]);var Fi=b(122),eh=b(250),gj=b(1127);b(806);Zc.prototype.XMe=function(n,O,da){var l=Object.assign(new Cc.a,{Id:"FontDropdownMenu"});l.MenuSectionList=[];var K=Object.assign(new Bc.a,{ControlsId:"FontsMenuSectionControl"});K.ControlList=this.Tzh(n,O,da);Array.add(l.MenuSectionList,K);return l};Zc.prototype.Tzh=function(n,
O,da){var l=[],K=this.m_h&&!this.c7e;Zc.G6c||Zc.xVh();var ka=Zc.G6c,$a;for($a in ka){var Lb=$a,bc=ka[$a],Dc=ah.a.Sf(Lb),wd=ah.a.Sf(Z.HelperMethods.GMd[Lb]);Lb=ah.a.Sf(Lb);K||(bc=0);Dc=Object.assign(new gj.a,{MenuItemId:Dc,CommandValueId:Dc,LabelText:K&&0<bc?ah.a.Sf(String.fromCodePoint(bc)):wd,LabelCss:String.format("font-size:12pt;font-family:{0};",K&&0<bc?"msofp":Lb),Styles:Zc.y8b(K&&0<bc?"msofp":Lb),AriaLabel:wd,Alt:wd,Command:n.toString(),CommandPreviewId:O.toString(),CommandRevertId:da.toString()});
Array.add(l,Dc)}K&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(Object(Kc.a)(this,this.gxi,"onPreviewFontLoadFailed"));return l};Zc.prototype.gxi=function(n){this.c7e=!0;this.$.HG(function(O){O.uNa("FontName_New")});Rc.ULS.sendTraceTag(575956067,1,15,String.format("PreviewFont Status is {0}",n))};Zc.xVh=function(){var n={};Zc.G6c=(n["Angsana New"]=983046,n["Arial Black"]=983051,n.Arial=983050,n.Batang=983061,n["Book Antiqua"]=983077,n["Browallia New"]=983082,n.Calibri=983085,n.Cambria=983089,
n.Candara=983091,n.Century=983095,n["Comic Sans MS"]=983100,n.Consolas=983101,n.Constantia=983102,n.Corbel=983106,n["Cordia New"]=983107,n["Courier New"]=983109,n.DilleniaUPC=983121,n.Dotum=983123,n.FangSong=983138,n.Garamond=983154,n.Georgia=983156,n.Gulim=983182,n.GungSuh=983186,n.KaiTi=983222,n.JasmineUPC=983218,n["Malgun Gothic"]=983258,n.Mangal=983262,n.Meiryo=983264,n["Microsoft JhengHei"]=983272,n["Microsoft YaHei"]=983284,n.MingLiU=983292,n.MingLiU_HKSCS=983296,n["MS Gothic"]=983245,n["MS Mincho"]=
983247,n["MS PGothic"]=983249,n["MS PMincho"]=983251,n.PMingliU=983322,n["PMingLiU-ExtB"]=983324,n.SimHei=983382,n.SimSun=983384,n["SimSun-ExtB"]=983386,n["Source Sans Pro"]=983396,n.Tahoma=983405,n.THSarabunPSK=983404,n["Times New Roman"]=983415,n["Trebuchet MS"]=983419,n.Verdana=983443,n["Yu Gothic"]=983464,n["Yu Mincho"]=983474,n)};Zc.y8b=function(n){var O={};O["font-family"]=n;O["font-size"]="12pt";return{optionText:O}};Zc.G6c=null;Object(hd.a)(Zc,"FontDropdownHelper",null,[]);Ed.qEg=function(n,
O){return new Ed(n,O,null,null)};Ed.cTc=function(n,O){return new Ed(n,null,O,null)};Ed.rEg=function(n,O){return new Ed(n,null,null,O)};Jl.Object.defineProperties(Ed.prototype,{j0a:{configurable:!0,enumerable:!0,get:function(){return this.Gcg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.Hcg}},style:{configurable:!0,enumerable:!0,get:function(){return this.ukg}},size:{configurable:!0,enumerable:!0,get:function(){return this.ZSb}}});Object(hd.a)(Ed,"CachedPreviewCellGroup",
null,[]);var Vj=b(64);ge.prototype.TK=function(){var n=this;this.Txc=!1;if(Cf.b(this.IAa,514846606)){this.Txc=!0;Rc.ULS.sendTraceTag(540386509,0,50,"Merge cells with multiple values");Vj.a(this.Cf.$).ld.AO(514846606);if(this.DLb&&this.$Sd)window.setTimeout(function(){n.Cf.d$(n.Cf.gridView,n.HAa,!0,!0)},0);else return this.pTd=te.g(this.Cf.$).rtl,this.rTd=qd.a.Ad(3,2,0,this.pTd?613:612,0,514846606,"MergeCellsLoseData"),this.ej=V.a(this.Cf.$).ki(this.rTd).G(),this.ej.isCompleted||(this._state=2,this.ej.LM(Object(Kc.a)(this,
this.moveNext,"moveNext"))),this.Mxc;return this.Kcb}return this.v0};ge.prototype.v0=function(){this.Cf.acf(this.Txc,this.$Sd,this.E6f.scenario,this.DLb);this._state=3};ge.prototype.Kcb=function(){return this.v0};ge.prototype.Mxc=function(){if(this.Pxc=this.ej.Ky())1===this.Pxc&&Rc.ULS.sendTraceTag(540386507,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Rc.ULS.sendTraceTag(540386508,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.ej=this.Cf.d$(this.Cf.gridView,this.HAa,!0,!1).g(),
this.ej.isCompleted||(this._state=2,this.ej.LM(Object(Kc.a)(this,this.moveNext,"moveNext"))),this.Nxc;return this.Mcb};ge.prototype.Mcb=function(){return this.Kcb};ge.prototype.Nxc=function(){this.ej.Ky();return this.Mcb};ge.prototype.dispose=function(){};ge.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.lu=this.lu()}catch(n){this.dispose(),this._state=3}};Object(hd.a)(ge,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,
[7]);Nd.prototype.TK=function(){return Cf.b(this.IAa,514846606)?(Rc.ULS.sendTraceTag(554997637,0,50,"Merge cells with multiple values"),Vj.a(this.Cf.$).ld.AO(514846606),this.mTd=te.g(this.Cf.$).rtl,this.nTd=qd.a.Ad(3,2,0,this.mTd?613:612,0,514846606,"MergeCellsLoseData"),this.ej=V.a(this.Cf.$).ki(this.nTd).G(),this.ej.isCompleted||(this._state=2,this.ej.LM(Object(Kc.a)(this,this.moveNext,"moveNext"))),this.Jcb):this.v0};Nd.prototype.v0=function(){this._state=3};Nd.prototype.Jcb=function(){if(this.Sxc=
this.ej.Ky())1===this.Sxc&&Rc.ULS.sendTraceTag(554997635,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Rc.ULS.sendTraceTag(554997636,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.ej=this.Cf.d$(this.Cf.gridView,this.HAa,!0,this.DLb).g(),this.ej.isCompleted||(this._state=2,this.ej.LM(Object(Kc.a)(this,this.moveNext,"moveNext"))),this.P6f;return this.Lcb};Nd.prototype.Lcb=function(){return this.v0};Nd.prototype.P6f=function(){this.ej.Ky();return this.Lcb};Nd.prototype.dispose=function(){};
Nd.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.lu=this.lu()}catch(n){this.dispose(),this._state=3}};Object(hd.a)(Nd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[7]);var si=b(522),sj=si.a;Cm(Hd,sj);Hd.prototype.Nh=function(){1896159024===this.Yo?(this.$n=Sd.a.instance.da(23),this.P0c=0):(this.$n=Sd.a.instance.da(22),this.P0c=1);var n=this.selectedRanges[0].v4&&!this.selectedRanges[0].Haa?0:1;this.lc=
1;var O={};n=(O.id=this.xc,O.dialogToDisplay=this.P0c,O.defaultSelectedKey=n,O.isRtl=this.isRtl,O);this.initializeAndShow(this.$n,Object(Kc.a)(this,this.iXh,"insertDeleteCellsDialogHandler"),n)};Hd.prototype.iXh=function(n,O){if(n){n={};var da="";switch(O.selectedKey){case 0:da=1896159024===this.Yo?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:da=1896159024===this.Yo?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:da=1896159024===this.Yo?"InsertRows":"DeleteRows";break;case 3:da=
1896159024===this.Yo?"InsertColumns":"DeleteColumns"}Rc.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",da);O=new ig.a(1035996630,1,2,8,null);n[Kg.a.Vd]=da;this.$.Na.Xb(O,n)}else Rc.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel")};Jl.Object.defineProperties(Hd.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});
Object(hd.a)(Hd,"InsertDeleteCellsDialog",si.a,[]);Object(hd.a)(Mc,"MacroRecorderRangeFilledPayload",null,[115]);Object(hd.a)(ae,"RangeBorders",null,[]);Object(hd.a)($c,"ScenarioInfo",null,[]);Cb.prototype.dispose=function(){this.$=null};Cb.prototype.r0h=function(n,O){return!(void 0===O||null===O)&&!!(O.scenario&16384)&&this.l3e(O,n)};Cb.prototype.VRe=function(){var n=Re.a.hf(),O=te.g(this.$),da=O.ga.ya.selectedRanges,l=0,K=0,ka=da.length,$a=new $c;if(1<ka)return $a.scenario=4,$a;this.yid&&te.g(this.$).rtl&&
(l|=65536);if(!O.Bja(da[0]))if(this.tbc)l|=32;else return $a.scenario=32,$a;if(O=O.Ha.$0a(da[0],this.$.activeItemName))for(O=Ml(O),ka=O.next();!ka.done;ka=O.next())if(K+=1,1<K)return this.tbc?(l|=256,$a.scenario=l):$a.scenario=256,$a;K=te.g(this.$).Ha.D0a(da[0]);if(!K)return $a.scenario=32768,$a;O=K.length;da=da[0];ka=da.bottom-da.top+1;for(var Lb=da.right-da.left+1,bc=new ae,Dc=0;Dc<O;Dc++)if(this.q7e&&this.KFh(K[Dc],da,bc),l=l|(void 0!==K[Dc].text&&null!==K[Dc].text&&""!==K[Dc].text?1:0)|(K[Dc].rZ?
2:0)|(K[Dc].mJa?8:0)|(K[Dc].Btb?16:0)|(K[Dc].NG?64:0)|(K[Dc].T$?128:0),void 0!==K[Dc].text&&null!==K[Dc].text&&""!==K[Dc].text||K[Dc].mJa)void 0===$a.MHa||null===$a.MHa?$a.MHa=te.g(this.$).Cc(K[Dc].getRange()):l|=16384;this.q7e&&(bc.cRa===Lb&&(l|=512),bc.QEa===Lb&&(l|=2048),bc.yLa===ka&&(l|=4096),bc.EOa===ka&&(l|=1024),0<bc.cRa&&bc.cRa<Lb||0<bc.QEa&&bc.QEa<Lb||0<bc.yLa&&bc.yLa<ka||0<bc.EOa&&bc.EOa<ka)&&(l|=8192);n=Re.a.hf()-n;Rc.ULS.sendTraceTag(544482595,0,50,"Execution time of GetMergeCellScenrio is : {0}",
n);$a.scenario=l;return $a};Cb.prototype.Iff=function(n,O){n=n.command;if(void 0===O||null===O)O=this.VRe();if(!this.l3e(O,n))return!1;var da=te.g(this.$).ga.ya.selectedRanges;if(!te.g(this.$).Ha.D0a(da[0]))return!1;var l=te.g(this.$).Ha.Tqa(da[0],this.$.activeItemName),K=te.g(this.$).ga.ya.pA,ka=this.$.sa.sheetName;switch(n){case -167499203:this.zhi(O,da);break;case 1097660126:this.Jff(O,da);break;default:return!1}l.yxj(da[0],n);te.g(this.$).sU(da,K,ka,null,da[0],null,null,0,"MergeCellCommandAction");
return!0};Cb.prototype.l3e=function(n,O){if(-167499203!==O&&1097660126!==O||this.yid&&65536===(n.scenario&65536))return!1;this.tbc&&32===(n.scenario&32)&&(n.scenario&=-33);return 32768===n.scenario||16===(n.scenario&16)||4===n.scenario||256===n.scenario||2===(n.scenario&2)||128===(n.scenario&128)||!this.tbc&&32===n.scenario||void 0!==n.MHa&&null!==n.MHa&&n.MHa.Eda?!1:n.scenario?16384===(n.scenario&16384)?fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):
1!==(n.scenario&1)&&8!==(n.scenario&8)||!fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:!0};Cb.prototype.KFh=function(n,O,da){var l=n.getRange();if(l.top===O.top)if(n.l2a)da.cRa+=l.right-l.left+1;else{var K=this.WX.Dta(l,0);if(K){var ka=Ml(K);for(K=ka.next();!K.done;K=ka.next())K=K.value,K.Ctb&&(da.cRa+=K.getRange().right-K.getRange().left+1)}}if(l.left===O.left)if(n.f2a)da.yLa+=l.bottom-l.top+1;else if(K=this.WX.Dta(l,2))for(ka=Ml(K),K=ka.next();!K.done;K=
ka.next())K=K.value,K.Ktb&&(da.yLa+=K.getRange().bottom-K.getRange().top+1);if(l.bottom===O.bottom)if(n.Ctb)da.QEa+=l.right-l.left+1;else if(K=this.WX.Dta(l,1))for(ka=Ml(K),K=ka.next();!K.done;K=ka.next())K=K.value,K.l2a&&(da.QEa+=K.getRange().right-K.getRange().left+1);if(l.right===O.right)if(n.Ktb)da.EOa+=l.bottom-l.top+1;else if(n=this.WX.Dta(l,3))for(n=Ml(n),K=n.next();!K.done;K=n.next())O=K.value,O.f2a&&(da.EOa+=O.getRange().bottom-O.getRange().top+1)};Cb.prototype.IRi=function(n){n=te.g(this.$).Ha.D0a(n);
for(var O=n.length,da=1;da<O;da++){var l=te.g(this.$).Cc(n[da].getRange());l.$mb();l.clearFormat();l.cell.KRi();l.S8a(!0)}};Cb.prototype.Xyj=function(n,O){n.backgroundColor=O.backgroundColor;n.color=O.color};Cb.prototype.EGh=function(n,O,da){O.cell.v8i(da.bottom-da.top,da.right-da.left);if(void 0!==n&&null!==n){var l=n.cell.formattedText,K=Object.assign(new Nh.a,{TextRuns:l.TextRuns,Fonts:l.Fonts});K.Text=void 0!==n.cell.originalText&&null!==n.cell.originalText?n.cell.originalText:void 0!==n.cell.userInput&&
null!==n.cell.userInput?n.cell.userInput:l.Text;this.Fi.$Pa(O,K,!1,null,!0,"MergeCells",void 0,2);this.yid?O.GZb(n):this.Xyj(O,n);O.cell.dRg(n.cell)}this.IRi(da);O.cell.VQd(!1);return O};Cb.prototype.zhi=function(n,O){this.Jff(n,O).Vya(2,!0)};Cb.prototype.Jff=function(n,O){n=n.MHa;var da=te.g(this.$).Cc(O[0]);return da=this.EGh(n,da,O[0])};Object(hd.a)(Cb,"MergeCellCommandAction",null,[]);var Oj=b(106),Vi=b(458),ci=b(373),Ik=b(801);Qc.prototype.E2h=function(n){return 1896159024===n||-1554384558===
n||-1113896058===n||1554436520===n||1415868706===n||674605324===n||1035996630===n};Qc.prototype.$c=function(n,O){return 2054778433===O&&n&1?!Ef.a(this.$).Xcc:600686207===O?!1:this.E2h(O)&&Gh.a.any(this.gridView.ga.ya.selectedRanges,function(da){return da.Yh||da.isRow})&&!this.g8e&&!this.d8e?!0:this.ndc(n,O)};Qc.prototype.executeCommand=function(n,O,da){return this.Xb(O,da)};Qc.prototype.Jc=function(n,O,da){if(n=1===n)switch(O.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:n=
!!da;break;case 862825906:case 1532790410:case 46555851:case -1522760979:n=!0;break;default:n=!1}return n};Qc.prototype.gd=function(n,O,da){switch(O){case "PopulateFontColor":da.MenuItems=this.OA.g7b(1970784898,-803000997,520,null,null,-128950598,2036397036,1688184685,862825906,da.MenuId);break;case "PopulateFillColor":da.MenuItems=this.OA.g7b(1650812936,null,null,87208751,518,673562736,1457172838,-446735083,1532790410,da.MenuId);break;case "PopulateBorderColor":da.MenuItems=this.OA.g7b(-236759591,
-1803452024,520,void 0,void 0,void 0,void 0,void 0,46555851,da.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.gOh(da);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":da.MenuItems=this.Boh.XMe(-1293291468,324978188,-1428968098);break;default:return!1}return!0};Qc.prototype.ndc=function(n,O){var da=te.g(this.$).ga.ya.selectedRanges;return!(new oh.a(this.$.Aa)).ko(n,O,da,this.gridView)};Qc.prototype.Xb=function(n,O){var da=this,l=this.gridView,K=n.command,ka=fe.TaskExtensions.um(),
$a=!0;switch(K){case -1077965542:$a=this.HXe(O,n,!1);break;case 909774670:this.rmb(K);$a=this.HXe(O,n,!0);break;case -1293291468:$a=this.FXe(O,n,!1);break;case 324978188:fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Rc.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.rmb(K);$a=this.FXe(O,n,!0);break;case 862890474:case 963349338:$a=this.DNh(n);break;case -1832800737:$a=this.A9b(K,O,!1,n);break;case 1970784898:$a=
this.A9b(K,O,!1,n);break;case -803000997:$a=this.A9b(K,O,!1,n);break;case -128950598:case 1688184685:this.rmb(K);$a=this.A9b(K,O,!0,n);break;case 1597684571:$a=this.ntb(K,O,!1,n);break;case 87208751:O.Color="-1";O.IntColor=!0;$a=this.ntb(K,O,!1,n);break;case -446735083:this.rmb(K);O.Color="-1";O.IntColor=!0;$a=this.ntb(K,O,!0,n);break;case 1650812936:$a=this.ntb(K,O,!1,n);break;case 673562736:this.rmb(K);$a=this.ntb(K,O,!0,n);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(n=$d.b().ji(K),Rc.ULS.sendTraceTag(574650247,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",n));this.PIf(K);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:$a=this.oNh(K,n);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:$a=this.FMh(K,n);break;case -1803452024:case -236759591:$a=this.Pbd(K,O,n);break;case -2118943501:$a=this.borderFormatManager.MMh(O,n);break;case 1012765228:$a=
this.borderFormatManager.uOh(O,n);break;case 1256700402:$a=this.borderFormatManager.Ubd(n);break;case -1756763834:$a=this.borderFormatManager.Vbd(n);break;case -1418159950:$a=this.borderFormatManager.sXe(n);break;case -1920201820:case -1942512156:$a=this.ENh(K,n);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:$a=this.borderFormatManager.eXe(O,n);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:$a=this.$Nh(K,O,n);break;case -693675336:case 322710748:break;
case 1696566924:$a=this.pNh(n);break;case -167499203:case -255094134:case 1097660126:case 155820588:ka=this.handleMergeCellsCommand(this.gridView,n);break;case 1896159024:case -1554384558:O=this.gridView.ga.ya.selectedRanges;if(this.aej(n,O))Rc.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Hd(this.$,K,O)).Nh(),$a=!0;else if(Gh.a.any(O,function(bc){return da.gridView.kc.b4a(bc)})){l="";ka=1461300262;var Lb=-1554384558===K&&this.gridView.kc.C4h(O[0]);
O=O[0].height>O[0].width&&!Lb;switch(K){case 1896159024:l=O?"InsertColumnsTable":"InsertRowsTable";ka=O?622604322:942362098;break;case -1554384558:l=O?"DeleteColumnsTable":"DeleteRowsTable",ka=O?284490184:1405456548}O=Ch.a.Nn(Qc.ufd,l,1);new ig.a(ka,1,2,6,null);ka=this.insertOrDeleteCells(O,n,!0)}else ka=this.insertOrDeleteCells(1896159024===K?1:2,n,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:ka=this.insertOrDeleteCells(Ch.a.Nn(Qc.ufd,O[Kg.a.Vd],1),n,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:ka=
this.insertOrDeleteCells(Ch.a.Nn(Qc.ufd,O[Kg.a.Vd],1),n,!1);break;case 504848446:ka=l.startEdit(!1,1,O[ub.a.event],void 0,void 0,!0);break;case 1504715724:if(te.g(this.$).Oy&&this.borderFormatManager.RT.tA)break;ka=l.startEdit(!0,0,O[ub.a.event],void 0,void 0,!0);break;case 1872288872:this.enb();break;case 41465729:ka=this.fill(l.ga.ya.Xd,null,0,1,n);break;case -1451655532:case 1972143101:ka=this.fillDownAbsoluteValueAndStartEdit(l,O[ub.a.event],-1451655532===K);break;case -475861485:ka=this.fill(l.ga.ya.Xd,
null,l.rtl?1:2,1,n);break;case -978843926:ka=this.fill(l.ga.ya.Xd,null,3,1,n);break;case 2098035706:ka=this.fill(l.ga.ya.Xd,null,l.rtl?2:1,1,n);break;case -2142700828:ka=this.fill(l.ga.sourceRange,l.ga.ya.Xd,Qc.mQe(l.ga.ya.Xd,l.ga.sourceRange),2,n);break;case 1405660955:ka=this.fill(l.ga.sourceRange,l.ga.ya.Xd,Qc.mQe(l.ga.ya.Xd,l.ga.sourceRange),4,n);break;case 1983983164:ka=this.fill(l.ga.ya.Xd,null,0,0,n);break;case 478842689:(n=this.$.ea.Ea(376,void 0))?(n.qLi(),$a=!0):Rc.ULS.sendTraceTag(593494044,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:$a=l.ga.Xb(null,K);break;case -208772570:this.VNh();$a=!0;break;case -987339782:this.TMh();$a=!0;break;case -1770246794:l.ga.UMh();$a=!0;break;case 748067091:case -381232414:this.WMh(K);$a=!0;break;case -1522760979:this.gridView.toggleFormulaView();$a=!0;break;case 886009118:ka=this.BNh();break;case 894341014:this.GNh();
$a=!0;break;case 862825906:ka=this.TXe(1970784898,n);break;case 1532790410:ka=this.TXe(1650812936,n);break;case 46555851:ka=this.RNh(n);break;default:$a=!1}$a||(ka=kh.a(K));return ka};Qc.prototype.aej=function(n,O){var da=this,l=Gh.a.all(O,function($a){return!da.gridView.kc.b4a($a)}),K=1<O.length&&!!this.gridView.kc.Mad(O),ka=Gh.a.all(O,function($a){return!da.gridView.kc.Caa($a)});O=!Gh.a.any(O,function($a){return $a.isRow||$a.Yh});return 1===n.method&&6===n.qf&&(l||K)&&ka&&O};Qc.prototype.fillDownAbsoluteValueAndStartEdit=
function(n,O,da){var l=this,K=n.ga.ya.activeCell,ka=jg.E(K,this.gridView.hs);return n.startEdit(!0,0,O).CWR(function(){var $a=n.Cc(ka),Lb=n.Cc(K);if(!$a||!Lb)return Rc.ULS.shipAssertTag(590484882,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",K.toString(),ka.toString()),ug.Task.Ua(!1);l.gridView.Hc.text=da?$a.h0:$a.text;l.gridView.Hc.textBox.setCaretPositionToEnd();return ug.Task.Ua(!0)})};Qc.prototype.insertOrDeleteCells=function(n,
O,da){function l(){return new he(Dc)}var K=this,ka=Eh.a.create().toString(),$a=Enum.toString(tj,n);this.gridView.Ui.Xca(17,ka,$a);$a=this.gridView.ga.ya.selectedRanges;var Lb=this.g8e,bc=this.d8e;if(!this.$.qt(null,!1,void 0,O.qf)&&!bc&&!Lb&&5!==n&&9!==n)return ug.Task.Ua(!0);2===n?n=bc?10:Lb?6:$a[0].height>$a[0].width?18:34:1===n?n=bc?9:Lb?5:$a[0].height>$a[0].width?17:33:18===n&&Lb?n=34:34===n&&bc&&(n=18);$a=this.Lvg($a,n);if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&
(10===n||6===n)&&!this.$.qt($a,!0))return ug.Task.Ua(!0);var Dc={};Dc.InsertDeleteRangeItems=Array($a.length);Dc.SheetName=this.$.sa.sheetName;Dc.IsTableCommand=da;for(da=0;da<$a.length;da++){Lb=$a[da];var wd={},ke=bc=void 0;n&4?(wd.FirstRow=Lb.top-1,wd.LastRow=xh.a.Ty,wd.FirstColumn=0,wd.LastColumn=xh.a.dw,bc=Lb.bottom-Lb.top+1,ke=0,6===n&&(Lb.Yh||(wd.FirstRow=Lb.bottom),bc=-bc)):n&8?(wd.FirstRow=0,wd.LastRow=xh.a.Ty,wd.FirstColumn=Lb.left-1,wd.LastColumn=xh.a.dw,bc=0,ke=Lb.right-Lb.left+1,10===
n&&(Lb.isRow||(wd.FirstColumn=Lb.right),ke=-ke)):n&16?(wd.FirstRow=Lb.top-1,wd.LastRow=Lb.bottom-1,wd.FirstColumn=Lb.left-1,wd.LastColumn=xh.a.dw,bc=0,ke=Lb.right-Lb.left+1,18===n&&(wd.FirstColumn=Lb.right,ke=-ke)):(wd.FirstRow=Lb.top-1,wd.LastRow=xh.a.Ty,wd.FirstColumn=Lb.left-1,wd.LastColumn=Lb.right-1,bc=Lb.bottom-Lb.top+1,ke=0,34===n&&(wd.FirstRow=Lb.bottom,bc=-bc));wd={InsertDeleteRange:wd};wd.DeltaRow=bc;wd.DeltaColumn=ke;wd.AdjustedSelectedRange=jg.j(Lb);Dc.InsertDeleteRangeItems[da]=wd}this.gridView.Vi.fG(!1);
var jf=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Dc.IsDecoupleRecalc=jf;var Xf=this.$.ra.xa.dc();return hg.a(this.$.userOperationManager,function(Sf,xg,xi){jf&&!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||K.$.Ss();var Oi=K.$.ra.xa;Sf=Lf.b(Sf,Object(Kc.a)(K,K.Bui,"onInsertOrDeleteOperationWebMethodSuccess"));var pj=Oi.Ra(41,void 0===Xf?null:Xf);pj.insertDeleteMultiRangeParameters=Dc;return nf.i(Oi,"InsertDeleteCells",pj,Sf,xg,
xi,ka,0)},function(Sf){return new bh.a(237,0,Sf,void 0,l)},O)};Qc.prototype.Bui=function(n,O){if(!Cf.a(n)&&O){var da=!!n&&!!n.RequestTelemetryData;te.g(this.$).Ui.fka(O,n.StateId,da?n.RequestTelemetryData.EcsOperationDuration:0,da?n.RequestTelemetryData.EcsRequestDuration:0,da?n.RequestTelemetryData.WfeRequestDuration:0)}};Qc.prototype.Lvg=function(n,O){return O&32?this.yWa(n,function(da){return da.bottom},function(da){return da.top},function(da,l){da.bottom=l},!1,!0):O&16?this.gridView.rtl?this.yWa(n,
function(da){return da.left},function(da){return da.right},function(da,l){da.left=l},!1,!1):this.yWa(n,function(da){return da.right},function(da){return da.left},function(da,l){da.right=l},!1,!1):O&4?this.yWa(n,function(da){return da.bottom},function(da){return da.top},function(da,l){da.bottom=l},!0,!0):O&8?this.gridView.rtl?this.yWa(n,function(da){return da.left},function(da){return da.right},function(da,l){da.left=l},!0,!1):this.yWa(n,function(da){return da.right},function(da){return da.left},function(da,
l){da.right=l},!0,!1):n};Qc.prototype.yWa=function(n,O,da,l,K,ka){n=jg.d(n);n.sort(function(bc,Dc){return O(Dc)-O(bc)});if(K){K=[];ka=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?ka?xh.a.Gh+1:xh.a.Qh+1:ka?xh.a.Ty:xh.a.dw;for(var $a=0;$a<n.length;$a++){var Lb=n[$a];da(Lb)<ka&&(l(Lb,Math.min(O(Lb),ka-1)),Array.add(K,Lb),ka=da(Lb))}n=K}return n};Qc.prototype.fill=function(n,O,da,l,K){function ka(){return new Mc(bc,Dc,l,da)}var $a=this,Lb=this.$;if(!Lb.qt([O],!0))return ug.Task.Ua(!0);
var bc=jg.v(n,Lb),Dc=O?jg.v(O,Lb):bc,wd=this.$.ra.xa.dc();return hg.a(this.$.userOperationManager,function(ke,jf,Xf){$a.$.Ss();var Sf=$a.$.ra.xa,xg=Sf.Ra(9,wd);xg.sourceRange=bc;xg.targetRange=Dc;xg.fillDirection=da;xg.fillType=l;return nf.i(Sf,"FillRange",xg,ke,jf,Xf,null,0)},function(ke){return new bh.a(155,0,ke,void 0,ka)},K)};Qc.prototype.$Nh=function(n,O,da){var l={ValidMembers:32};switch(n){case 1890566896:n=parseInt(O[Kg.a.Vd].toString());if(14===n)return da=new ig.a(2105621672,da.method,da.mode,
da.qf,da.tabName),O[Kg.a.Vd]=null,this.$.Na.Xb(da,O),Rc.ULS.sendTraceTag(41537816,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;l.NumberFormat=n;break;case 1886928607:l.NumberFormat=13;break;case -992833457:l.NumberFormat=11;break;case 218524921:l.NumberFormat=12;break;case 996232352:l.NumberFormat=1006;break;default:return Rc.ULS.shipAssertTag(41537817,0,!1,"Unexpected number formatting command "+$d.b().ji(da.command)),!1}Rc.ULS.sendTraceTag(41537818,
0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",$d.b().ji(da.command),O[Kg.a.Vd]);this.Fi.formatCells(1890566896,l,da);this.$.If();return!0};Qc.prototype.DNh=function(n){var O=this.gridView.Cc(this.gridView.ga.ya.activeCell);if(this.Fg&&this.gridView.isEditing){O=this.gridView.Ej.Z0a(O?ej.a(O).Font:null);if(!O)return Rc.ULS.shipAssertTag(578159513,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",
this.gridView.ga.ya.activeCell.toString()),!1;var da=O.FontSize}else if(O)da=O.fontSize;else return!1;O=n.command;var l=0;if(862890474===O)for(;l<Qc.VHa.length-1&&Qc.VHa[l]<=da;)l++;else if(963349338===O)for(l=Qc.VHa.length-1;0<l&&Qc.VHa[l]>=da;)l--;Rc.ULS.sendTraceTag(20841047,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",da,Qc.VHa[l]);if(da===Qc.VHa[l])return!0;da=Qc.gqc(2);da.Font.FontSize=Qc.VHa[l];this.Fg&&this.gridView.isEditing?(this.hlb(n,
!1,da),this.$.If()):this.Fi.formatCells(O,da,n);return!0};Qc.prototype.HXe=function(n,O,da){n=n[n[uh.a.IsFreeForm]?uh.a.Value:Kg.a.Mj].toString();if(!Qc.YGi.test(n))return Rc.ULS.sendTraceTag(560566815,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",n),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;n=parseFloat(n);if(8>n||72<n)return Rc.ULS.sendTraceTag(560566814,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",
n,8,72),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var l=Math.round(2*n)/2,K=Qc.gqc(2);K.Font.FontSize=l;this.Fg&&this.gridView.isEditing?(this.hlb(O,da,K,!0),l===n||da||this.$.If()):da?this.Fi.wma(this.gridView,-1077965542,K,da):(this.Fi.formatCells(-1077965542,K,O),this.nYa());return!0};Qc.prototype.FXe=function(n,O,da){n=Z.HelperMethods.GMd[n[Kg.a.Mj]];if(!n)return!0;var l=Qc.gqc(1);l.Font.FontName=n;this.Fg&&this.gridView.isEditing?
(this.hlb(O,da,l),this.$.If()):da?this.Fi.wma(this.gridView,-1293291468,l,da):(this.Fi.formatCells(-1293291468,l,O),this.nYa());return!0};Qc.prototype.A9b=function(n,O,da,l){var K=-803000997===n||1688184685===n?"black":O.Color;this.moreColorsHelper&&(-1832800737===n?K=mf.a.compare(K,"WindowText",!0)?this.moreColorsHelper.GDb:"black":da||(this.moreColorsHelper.GDb=K,this.moreColorsHelper.$ba(O,K,l)));n=Qc.gqc(32);n.Font.FontColor=Mi.a.xG(K,Ch.a.yg(O,"IntColor"));this.Fg&&this.gridView.isEditing?this.hlb(l,
da,n,17===l.qf):da?this.Fi.wma(this.gridView,1970784898,n,da):(this.eH&&(da=this.getThemeColor(O),O=da.themeColor,da.returnValue&&(n.Font.ThemeFontColor=O,n.Font.ColorTypeOption=1)),this.Fi.formatCells(1970784898,n,l),this.nYa());return!0};Qc.prototype.WMh=function(n){var O=(new Date).format(748067091===n?this.$.Ba.ShortDateFormat:this.$.Ba.ShortTimeFormat),da=this.gridView.Zi?Fi.a(this.gridView.$):this.gridView.Hc;n=da.textBox;this.gridView.isEditing?da.insertText(O):(this.gridView.startEdit(!0,
1),da.text=O,O=O.length,n.jPa(O),n.caretPosition=O)};Qc.prototype.VNh=function(){this.gridView.Bja(this.gridView.ga.ya.activeCell)||this.gridView.Bpc||this.gridView.MKa()||this.gridView.Dt(this.gridView.ga.ya.activeCell,3,Oj.a.NWe)};Qc.prototype.TMh=function(){if(!(this.gridView.Bpc||this.gridView.MKa()||this.gridView.isEditing&&Tg.a.isMac)){var n=this.gridView.ga.ya.z3;this.gridView.ui(jg.v(n,this.$),n,null,null,60,Oj.a.NWe)}};Qc.prototype.pNh=function(n){var O=this;this.f6b=Zf.d(this.$.Aa.sa);var da=
this.$.ea.Ea(254,!0);if(this.gridView.x3a)return this.gridView.Vi.fG(!1),!!da;if(!da)return Rc.ULS.sendTraceTag(560566812,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ga.G1(Object(Kc.a)(this,this.S6c,"formatPainterOnSelectionChanged"));var l=String.format(ub.a.csa,Jg.a.current.En(86));this.gridView.Vi.YA(l);n=new ig.a(-911352779,n.method,n.mode,n.qf,n.tabName);l={};this.$.Na.Xb(n,(l.SilentClipboardAccessFailures=!0,l.IsFormatPainter=!0,l)).continueWith(function(K){(6>
K.status||6===K.status&&!K.result)&&O.enb()});this.gridView.x3a=!0;da.Ftg(Object(Kc.a)(this,this.enb,"clearFormatPainter"));return!0};Qc.prototype.enb=function(){if(this.gridView.x3a){var n=this.$.ea.Ea(254,!0);n&&n.NUi(Object(Kc.a)(this,this.enb,"clearFormatPainter"));this.gridView.x3a=!1;this.gridView.Vi.YA(ub.a.kua);this.gridView.ga.q_(Object(Kc.a)(this,this.S6c,"formatPainterOnSelectionChanged"));te.g(this.$).$.If()}};Qc.prototype.S6c=function(){var n=this,O=this.f6b;this.f6b=Zf.d(this.$.Aa.sa);
if(O===this.f6b)if(this.gridView.ga.q_(Object(Kc.a)(this,this.S6c,"formatPainterOnSelectionChanged")),(O=this.$.ea.Ea(254,!0))&&O.UTc(36,te.g(this.$).ga.ya.selectedRanges)){O=new ig.a(1804571062,2,2,0,null);var da={};this.$.Na.Xb(O,(da.SkipClipboardAccess=!0,da.ClearCopyStateOnFinish=!0,da.IsFormatPainter=!0,da)).continueWith(function(){n.enb()})}else this.gridView.Vi.fG(!1)};Qc.prototype.ntb=function(n,O,da,l){var K=87208751===n?"-1":O.Color;this.moreColorsHelper&&(1597684571===n?K=this.moreColorsHelper.C8a:
da||(this.moreColorsHelper.C8a=K===Qc.notSet?Qc.OOd:K,this.moreColorsHelper.$ba(O,K,l)));n={ValidMembers:64};n.FillColor=Mi.a.xG(K,Ch.a.yg(O,"IntColor"));da?this.Fi.wma(this.gridView,1650812936,n,!0):(this.eH&&(da=this.getThemeColor(O),O=da.themeColor,da.returnValue&&(n.ThemeFillColor=O,n.ColorTypeOption=1)),this.Fi.formatCells(1650812936,n,l),this.nYa());return!0};Qc.prototype.GNh=function(){Rc.ULS.sendTraceTag(579350623,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");
var n=this.$.ea.Ea(221,void 0);if(n){var O=this.gridView.Ej;if(O){var da=n.kXh(O.text,O.textBox.caretPosition);var l=da.ihf;var K=da.TKe;(da=da.returnValue)?(n.isListVisible=!1,O.text=da,O.textBox.selectRange(l,l+K),Rc.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):Rc.ULS.sendTraceTag(579350622,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Rc.ULS.shipAssertTag(590128197,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Rc.ULS.sendTraceTag(587534608,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};Qc.prototype.oNh=function(n,O){var da=0,l=this.gridView,K=ej.a(l.Cc(null));this.Fg&&l.isEditing&&(K.Font=l.Ej.Z0a(K.Font));var ka=K.Font;ka||(ka={ValidMembers:0});switch(n){case -287251124:da|=4;eh.e(ka,4)?ka.Bold=!ka.Bold:ka.Bold=!0;break;case -1925065947:da|=8;eh.e(ka,8)?ka.Italic=!ka.Italic:
ka.Italic=!0;break;case 1764140053:da|=16;eh.e(ka,16)?ka.Underline=!ka.Underline:ka.Underline=!0;break;case -1685033574:da|=64;eh.e(ka,64)?ka.DoubleUnderline=!ka.DoubleUnderline:ka.DoubleUnderline=!0;break;case -1590502662:da|=128,eh.e(ka,128)?ka.Strikethrough=!ka.Strikethrough:ka.Strikethrough=!0}if(!da)return!1;ka.ValidMembers=da;K.Font=ka;K.ValidMembers=16;this.Fg&&this.gridView.isEditing?this.hlb(O,!1,K):(fd.EwaSettings.ka(710)||l.Vi.fG(!1),this.Fi.formatCells(n,K,O));this.$.If();return!0};Qc.prototype.FMh=
function(n,O){var da=0,l=this.gridView,K=ej.a(l.Cc(null));-571165336===n||1041132226===n||-394785302===n?(da|=1,K.VerticalAlignment=Ch.a.Nn(Qc.DWa,n.toString(),2)):Qc.p2h(n)?(da|=2,this.yNh(K,n)):-1116189897===n&&(da|=8,K.Wrap=K.ValidMembers&8?!K.Wrap:!0);if(!da)return!1;K.ValidMembers=da;fd.EwaSettings.ka(710)||l.Vi.fG(!1);this.Fi.formatCells(n,K,O);this.$.If();return!0};Qc.prototype.yNh=function(n,O){!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==O&&(O=-1150205178===O?-286432209:-1150205178);O=Ch.a.Nn(Qc.DWa,O.toString(),0);n.HorizontalAlignment=O===n.HorizontalAlignment?0:O};Qc.prototype.gzf=function(n,O,da,l){var K=this,ka=!1;fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(ka=this.kgc.Iff(O,da))&&te.g(this.$).Ui.S_(this.Yyb,Yh.BasicTelemetryCalculator.bQ);return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.d$(n,O,!1,ka,function($a){K.Kvi($a,da,O,ka,l)}):this.d$(n,O,!1,ka,function($a,Lb,bc){K.Mvi($a,Lb,bc,da,O,ka,l)})};Qc.prototype.handleMergeCellsCommand=function(n,O){var da=this;this.Yyb=Eh.a.create().toString();var l=null;l=this.kgc.VRe();var K=nh.a(O.command);te.g(this.$).Ui.Xca(4,this.Yyb,K+", Scenario = "+l.scenario.toString());K=n.ga.ya.selectedRanges;Rc.ULS.sendTraceTag(22374144,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",$d.b().ji(O.command),
K.length,jg.i(K,",",this.$,!1));K=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);n.Vi.fG(!1,K);if(10===Ch.a.Nn(Qc.Kff,O.command.toString(),10))return ug.Task.Ua(!1);var ka=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(K&&ka)return this.kgc.r0h(O.command,l)?(this.aTf(l,O,!0),ug.Task.Ua(!0)):this.gzf(n,O,l,!1);var $a=!1;K&&($a=this.kgc.Iff(O,l))&&te.g(this.$).Ui.S_(this.Yyb,Yh.BasicTelemetryCalculator.bQ);
return fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.d$(n,O,!1,$a,function(Lb){da.Lvi(Lb,O,$a)}):this.d$(n,O,!1,$a,function(Lb,bc,Dc){da.Nvi(Lb,bc,Dc,O,$a)})};Qc.prototype.d$=function(n,O,da,l,K){function ka(jf,Xf,Sf){bc.$.Ss();jf=K?Lf.b(jf,K):jf;jf=Lf.b(jf,$a);return nf.f(bc.$.ra.xa,wd,ke,da,jf,Xf,Sf,null,Dc)}function $a(jf){var Xf=!!jf&&!!jf.RequestTelemetryData;te.g(bc.$).Ui.fka(bc.Yyb,jf.StateId,Xf?jf.RequestTelemetryData.EcsOperationDuration:
0,Xf?jf.RequestTelemetryData.EcsRequestDuration:0,Xf?jf.RequestTelemetryData.WfeRequestDuration:0)}function Lb(){return new Nb(wd,ke)}var bc=this;K=void 0===K?null:K;var Dc=this.$.ra.xa.dc(),wd=Ch.a.Nn(Qc.Kff,O.command.toString(),10),ke=jg.r(n.ga.ya.selectedRanges,n.$);return l?fd.EwaSettings.wc()?hg.a(this.$.userOperationManager,ka,function(jf){return new bh.a(156,0,jf,64,Lb)},O):hg.a(this.$.userOperationManager,ka,function(jf){return new zg.a(156,0,jf,void 0,Lb)},O):hg.a(this.$.userOperationManager,
ka,function(jf){return new bh.a(156,0,jf,void 0,Lb)},O)};Qc.prototype.aTf=function(n,O,da){var l=this;Rc.ULS.sendTraceTag(540386513,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",da);var K=te.g(this.$).rtl;K=qd.a.Ad(3,2,0,K?613:612,0,514846606,"MergeCellsLoseData");fe.TaskExtensions.Da(V.a(this.$).ki(K),function(ka){(ka=ka.result)?1===ka&&Rc.ULS.sendTraceTag(540386511,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Rc.ULS.sendTraceTag(540386512,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
da?l.gzf(te.g(l.$),O,n,!0):l.d$(l.gridView,O,!0,!1))},this.$.ma,11)};Qc.prototype.acf=function(n,O,da,l){O!==n&&Rc.ULS.sendTraceTag(540386510,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",O,n,da,l)};Qc.prototype.Lvi=function(n,O,da){var l=this;Cf.b(n,514846606)&&(Rc.ULS.sendTraceTag(594580999,0,50,"Merge cells with multiple values"),Vj.a(this.$).ld.AO(514846606),
n=te.g(this.$).rtl,n=qd.a.Ad(3,2,0,n?613:612,0,514846606,"MergeCellsLoseData"),fe.TaskExtensions.Da(V.a(this.$).ki(n),function(K){(K=K.result)?1===K&&Rc.ULS.sendTraceTag(594580997,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Rc.ULS.sendTraceTag(594580998,0,50,"MergeCellsLoseData Dialog: Ok pressed"),l.d$(l.gridView,O,!0,da))},this.$.ma,11))};Qc.prototype.Nvi=function(n,O,da,l,K){new Nd(this,n,O,da,l,K)};Qc.prototype.Kvi=function(n,O,da,l,K){var ka=this,$a=!1;Cf.b(n,514846606)&&($a=!0,Vj.a(this.$).ld.AO(514846606),
l&&K?window.setTimeout(function(){ka.d$(ka.gridView,da,!0,!0)},0):this.aTf(O,da,!1));this.acf($a,K,O.scenario,l)};Qc.prototype.Mvi=function(n,O,da,l,K,ka,$a){new ge(this,n,O,da,l,K,ka,$a)};Qc.prototype.rmb=function(n){var O=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(O&&this.NXa!==n&&1461300262!==this.NXa){this.PIf(this.NXa);var da=$d.b().ji(n),l=$d.b().ji(this.NXa);Rc.ULS.sendTraceTag(570695872,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",
l,da)}O&&(this.NXa=n);if(this.Fg&&this.gridView.isEditing)this.JXa||(this.JXa=this.gridView.Ej.formattedText);else if(!this.FD){this.FD=[];O=this.gridView.L9("GridCommandHandler.CacheFontStyles",this.gridView.ga.ya.selectedRanges);try{for(O.$$rst();O.$$mn();){var K=O.$$cu(),ka=K.cell.hasRichText;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var $a=$d.b().ji(n);Rc.ULS.sendTraceTag(575157702,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",
$a,ka,this.FD.length)}if(ka)Array.add(this.FD,Ed.qEg(K,K.cell.formattedText));else switch(n){case 673562736:case -446735083:Array.add(this.FD,Ed.cTc(K,K.backgroundColor));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&mf.a.na(K.backgroundColor)&&Rc.ULS.sendTraceTag(575157701,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!K.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.FD,Ed.cTc(K,K.color));
fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&mf.a.na(K.color)&&Rc.ULS.sendTraceTag(575157700,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!K.color);break;case 909774670:Array.add(this.FD,Ed.rEg(K,K.fontSize));if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Lb=Ik.c(K.fontSize)?"null or undefined":K.fontSize.toString();Rc.ULS.sendTraceTag(575157699,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",
Lb)}break;case 324978188:Array.add(this.FD,Ed.cTc(K,K.fontName)),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(mf.a.na(K.fontName)?Rc.ULS.sendTraceTag(575157698,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!K.fontName):Rc.ULS.sendTraceTag(574650246,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(K.fontName),K.fontName.length))}}}finally{O&&
O.dispose()}}};Qc.prototype.rij=function(){return this.Fg&&this.gridView.isEditing?!this.JXa:!this.FD};Qc.prototype.u_h=function(n){return!!this.FD&&this.FD.length>n&&!!this.FD[n].formattedText};Qc.prototype.i8c=function(n){return this.FD[n].style};Qc.prototype.Yuh=function(n){return this.FD[n].size};Qc.prototype.PIf=function(n){if(this.rij())fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Rc.ULS.sendTraceTag(575157697,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",
n);else{if(this.Fg&&this.gridView.isEditing)fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(n=$d.b().ji(n),Rc.ULS.sendTraceTag(574367560,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",n)),this.JXa&&(this.gridView.Hc.formattedText=this.JXa);else for(var O=this.FD.length,da=0;da<O;da++){var l,K=this.FD[da].j0a.cell.getRange();if(l=this.gridView.Cc(K)){K=void 0;var ka=l.sM?this.gridView.rpc(l.range):
(K=new Aa.a,K.add(l),K);K=Ml(ka);for(ka=K.next();!ka.done;ka=K.next()){ka=ka.value;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var $a=$d.b().ji(n);Rc.ULS.sendTraceTag(575157696,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",$a,ka.cell.hasRichText,da,l.sM,O)}if(ka.cell.hasRichText&&1457172838!==n)this.u_h(da)&&(ka.cell.formattedText=
this.FD[da].formattedText,fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ka.cell.formattedText&&Rc.ULS.sendTraceTag(575157667,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(n){case 1457172838:ka.backgroundColor=this.i8c(da);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&mf.a.na(ka.backgroundColor)&&Rc.ULS.sendTraceTag(575157666,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",
!ka.backgroundColor);break;case 2036397036:ka.color=this.i8c(da);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&mf.a.na(ka.color)&&Rc.ULS.sendTraceTag(575157665,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!ka.color);break;case -1904244080:ka.fontSize=this.Yuh(da);fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(ka=Ik.c(ka.fontSize)?"null or undefined":ka.fontSize.toString(),
Rc.ULS.sendTraceTag(575157664,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",ka));break;case -1428968098:$a=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),ka.lHd(this.i8c(da),$a,"RestoreCachedStyles")}}}else Rc.ULS.sendTraceTag(51451604,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",K.GG(!1))}fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.NXa=
1461300262);this.nYa()}};Qc.prototype.nYa=function(){this.Fg&&this.gridView.isEditing?this.JXa=null:this.FD=null;fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Rc.ULS.sendTraceTag(575157662,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};Qc.prototype.ENh=function(n,O){var da={IndentationIncrease:0};if(-1942512156===n)da.IndentationIncrease=1;else if(-1920201820===n)da.IndentationIncrease=-1;else return!0;da.ValidMembers=256;this.Fi.formatCells(n,
da,O);return!0};Qc.prototype.BNh=function(){var n=this,O=te.g(this.$),da=jg.r(O.ga.ya.selectedRanges,this.$),l=jg.o(O.ga.ya.activeCell,this.$);Rc.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return hg.a(this.$.userOperationManager,function(K,ka,$a){return nf.K(n.$.ra.xa,l,da,K,ka,$a,null)},function(K){return new bh.a(201,0,K)},null)};Qc.prototype.TXe=function(n,O){var da=null,l=te.g(this.$).ga.ya.selectedRanges;l=this.gridView.L9("MoreColors",l,1,!0);try{for(l.$$rst();l.$$mn();){var K=
l.$$cu().cell;if(K){var ka=Qc.black;if(1970784898===n)ka=K.color;else if(1650812936===n){var $a=K.backgroundColor;ka=mf.a.compare($a,Qc.OOd,!0)&&mf.a.compare($a,Qc.empty,!0)?K.backgroundColor:Qc.white}if(!da)da=ka;else if(da!==ka){da=Qc.black;break}}}}finally{l&&l.dispose()}this.Fg&&this.gridView.isEditing&&1970784898===n&&this.gridView.Ej.textBox.ole();return this.moreColorsHelper.Wva(n,O,da)};Qc.prototype.RNh=function(n){var O=ah.a.r1a(this.borderFormatManager.B2);return this.moreColorsHelper.Wva(-236759591,
n,O)};Qc.prototype.hlb=function(n,O,da,l){var K=this;l=void 0===l?!1:l;O?this.gridView.Ej.hyf(da.Font):(this.Udi(n),l?window.requestAnimationFrame(function(){yh.FocusManager.instance().Zj(Ah.AFrame.W9);K.gridView.Ej.aMe(da.Font)}):(yh.FocusManager.instance().Zj(Ah.AFrame.W9),this.gridView.Ej.aMe(da.Font)),this.nYa())};Qc.prototype.Udi=function(n){var O=nh.a(n.command);n=aj.a[n.qf]+"_"+ei.a[n.method];var da=this.gridView.zc.Moe.toString(),l=new Map;l.set("Command",O);l.set("Source",n);l.set("Ribbon",
"React");l.set("CellTextRuns",da);mj.Health.instance.recordKpiUsage(ci.a.Ooh,0,Vi.a.kJf,l)};Qc.prototype.Pbd=function(n,O,da){n=this.borderFormatManager.Pbd(n,O,da);this.moreColorsHelper&&this.moreColorsHelper.$ba(O,this.borderFormatManager.B2,da);return n};Qc.prototype.getThemeColor=function(n){var O={};var da=!1;if(mf.a.contains(n.SqmControlId,"ThemeColorPicker",!1)){if(!this.themesManager)return Rc.ULS.sendTraceTag(540414496,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,
themeColor:O};da=this.themesManager.getThemeColor(n.Color);n=da.themeIndex;var l=da.Cza;if(da=da.returnValue)O.ThemeColorIndex=n,O.ThemeColorRow=l}return{returnValue:da,themeColor:O}};Qc.p2h=function(n){return-1150205178===n||-1142465846===n||-286432209===n};Qc.gqc=function(n){var O={},da={};O.ValidMembers=16;O.Font=da;da.ValidMembers=n;return O};Qc.mQe=function(n,O){var da=n.top<O.top?3:n.bottom>O.bottom?0:-1;return da=n.left<O.left?1:n.right>O.right?2:da};Jl.Object.defineProperties(Qc.prototype,
{g8e:{configurable:!0,enumerable:!0,get:function(){return Gh.a.all(this.gridView.ga.ya.selectedRanges,function(n){return n.isRow})}},d8e:{configurable:!0,enumerable:!0,get:function(){return Gh.a.all(this.gridView.ga.ya.selectedRanges,function(n){return n.Yh})}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.xB||(this.xB=this.$.ea.Ea(422,void 0));return this.xB}}});Jl.Object.defineProperties(Qc,{YGi:{configurable:!0,enumerable:!0,get:function(){return Qc.z6d||(Qc.z6d=RegExp("^[0-9]+[.]?[0-9]*$"))}},
ufd:{configurable:!0,enumerable:!0,get:function(){var n={};return Qc.h0d||(Qc.h0d=(n.InsertRows=5,n.InsertColumns=9,n.InsertCellsShiftRight=17,n.InsertCellsShiftDown=33,n.DeleteRows=6,n.DeleteColumns=10,n.DeleteCellsShiftLeft=18,n.DeleteCellsShiftUp=34,n.DeleteRowsTable=6,n.DeleteColumnsTable=10,n.InsertRowsTable=5,n.InsertColumnsTable=9,n))}},DWa:{configurable:!0,enumerable:!0,get:function(){var n={};return Qc.ydb||(Qc.ydb=(n["-394785302"]=0,n["-571165336"]=2,n["1041132226"]=1,n["-1150205178"]=1,
n["-1142465846"]=2,n["-286432209"]=3,n))}},Kff:{configurable:!0,enumerable:!0,get:function(){var n={};return Qc.O3d||(Qc.O3d=(n["-167499203"]=2,n["-255094134"]=5,n["1097660126"]=6,n["155820588"]=7,n))}}});Qc.OOd="transparent";Qc.notSet="-1";Qc.black="#000000";Qc.empty="";Qc.white="#FFFFFF";Qc.h0d=null;Qc.ydb=null;Qc.O3d=null;Qc.z6d=null;Qc.VHa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(hd.a)(Qc,"GridCommandHandler",null,[159]);var tk=of.a;Cm(Ic,tk);Ic.prototype.Rd=function(){var n=this;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var O=
Nf.GetServiceTaskFactory.create(this.$.ea,111,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.PopulateDynamicHelper.IPopulateDynamicHelper"),da=Nf.GetServiceTaskFactory.create(this.$.ea,18,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),l=Nf.GetServiceTaskFactory.create(this.$.ea,397,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.MoreColors.IMoreColorsHelper"),K=Nf.GetServiceTaskFactory.Xa(this.$.ea,296,468,this.vb,"Microsoft.Office.Excel.WebUI.Client.IBorderFormatManager");
fe.TaskExtensions.Da(fe.TaskExtensions.Fe([O,da,l,K],this.ma),function(){n.Hd([new Qc(n.$,te.g(n.$),da.result,O.result,K.result,l.result)])},this.ma,3)}else{var ka=Nf.GetServiceTaskFactory.create(this.$.ea,111,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.PopulateDynamicHelper.IPopulateDynamicHelper"),$a=Nf.GetServiceTaskFactory.create(this.$.ea,18,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction"),Lb=Nf.GetServiceTaskFactory.create(this.$.ea,102,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),
bc=Nf.GetServiceTaskFactory.create(this.$.ea,397,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.MoreColors.IMoreColorsHelper");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([ka,$a,Lb,bc],this.ma),function(){n.Hd([new Qc(n.$,te.g(n.$),$a.result,ka.result,new $f.BorderFormatManager(n.$,$a.result,Lb.result),bc.result)])},this.ma,3)}};Ic.la=function(n){of.a.ie(80,new Ic(n))};Object(hd.a)(Ic,"GridCommandHandlerFactory",of.a,[]);var xj=b(28),bk=b(198),yk=b(1169);Xb.prototype.dispose=function(){var n=
this;this.deactivate();this.gridView&&(this.tableManager.OFf(Object(Kc.a)(this,this.Jqf,"onRangeListUpdated")),this.gridView.UTi(Object(Kc.a)(this,this.Xnf,"onHeaderViewBlockCreated")),this.gridView.VTi(Object(Kc.a)(this,this.Ynf,"onHeaderViewBlockDisposed")),this.$.Aa.wg(Object(Kc.a)(this,this.vf,"onActiveItemChanged")),this.$.Ab.wg(Object(Kc.a)(this,this.vf,"onActiveItemChanged")),this.Yie(function(O){O.BCd(Object(Kc.a)(n,n.rJa,"headerBlockOnUpdatedBlockHtml"))}));this.gridView=this.tableManager=
this.Dfa=null};Xb.prototype.Duc=function(n,O,da,l){if(!Zf.b(this.$.sa)||this.$.fa.isNamedObjectViewMode||this.gridView.$a.Mza)return!0;if(!da.length)return!1;var K=l.length;if(l[K-1]<n.left)return!1;var ka=Z.HelperMethods.Uw(new bk.a(l),0,K,n.left,Z.HelperMethods.xC);if(0>ka)return!1;var $a=n.mZf,Lb=!!n.dYb&&0<n.dYb.length,bc=!!n.menuModel&&0<n.menuModel.length,Dc=ka,wd=0;for(K=Math.min($a.length+ka,K);Dc<K;Dc++,wd++)if(ka=da[Dc],!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||
ka){var ke=null,jf=ka.getElementsByClassName(xj.a.n4c);jf&&(ke=jf[0]);if(ke&&ke.innerText){if(jf=ka.getElementsByClassName(xj.a.Kge))for(var Xf=jf.length-1;0<=Xf;Xf--)ka.removeChild(jf[Xf]);jf=l[Dc];O?(ke.innerText=$a[wd],Sys.UI.DomElement.addCssClass(ka,xj.a.IHe),Lb&&n.dYb[wd]&&(ke=document.createElement("div"),ke.innerHTML=n.dYb[wd],bc&&n.menuModel[wd]&&this.hpg(n,wd,jf),ka.appendChild(ke.firstChild))):(Sys.UI.DomElement.removeCssClass(ka,xj.a.IHe),ke.textContent=ui.Range.p2(jf),this.O5g(n,wd,jf))}}n.oQa=
O;return!0};Xb.prototype.hpg=function(n,O,da){this.$.ea.ub(8,function(l){l.k5b.aui(n,O,da)})};Xb.prototype.O5g=function(n,O,da){this.$.ea.ub(8,function(l){l.k5b.bui(n,O,da)})};Xb.prototype.jw=function(){var n=this.gridView.Zad();if(!(0>=n||n===this.rLa||this.gridView.dr)){for(var O=!1,da=[],l=[],K=this.Dfa.length-1;0<=K;K--){var ka=this.Dfa[K];if(this.Yad(ka)>n||ka.bottom<n)Array.add(da,ka),Array.removeAt(this.Dfa,K),O=!0}for(K=this.tableManager.rangeList.length-1;0<=K;K--){ka=this.tableManager.rangeList[K];
var $a=this.Yad(ka);$a<=n&&ka.bottom>=n&&!($a<=this.rLa&&ka.bottom>=this.rLa)&&ka.xua&&(Array.add(l,ka),O=!0)}if(O)for(K=Ml(this.gridView.o2),ka=K.next();!ka.done;ka=K.next())for($a=Ml(ka.value),ka=$a.next();!ka.done;ka=$a.next()){for(var Lb=ka.value,bc=Lb.ho,Dc=yk.a(Lb.X3),wd=da.length-1;0<=wd;wd--)ka=da[wd],this.Duc(ka,!1,Dc,bc)&&Array.removeAt(da,wd);for(wd=l.length-1;0<=wd;wd--)ka=l[wd],this.Duc(ka,!0,Dc,bc)&&Array.add(this.Dfa,ka);O&&Lb.pHd(Dc)}else Rc.ULS.sendTraceTag(576073815,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.rLa=n}};Xb.prototype.UUf=function(n,O,da,l){for(var K=!1,ka=this.bKh(n,O),$a=this.Dfa.length-1;0<=$a;$a--){var Lb=this.Dfa[$a];O>=Lb.left&&n<=Lb.right&&(this.Duc(Lb,!1,da,l),Array.removeAt(this.Dfa,$a),K=!0)}n=0;for(O=ka.length;n<O;n++)this.Duc(ka[n],!0,da,l)&&(Array.add(this.Dfa,ka[n]),K=!0);return K};Xb.prototype.activate=function(){this.Ke()&&!this.active&&(this.gridView.view.nt(Object(Kc.a)(this,this.jw,"onVisibleAreaChanged")),this.active=!0)};Xb.prototype.deactivate=function(){this.active&&
(this.gridView.view.Tr(Object(Kc.a)(this,this.jw,"onVisibleAreaChanged")),this.active=!1)};Xb.prototype.Ke=function(){return Zf.b(this.$.sa)&&!this.$.fa.isNamedObjectViewMode&&0>=this.gridView.$a.YN&&0<this.tableManager.rangeList.length};Xb.prototype.Yie=function(n){for(var O=Ml(this.gridView.o2),da=O.next();!da.done;da=O.next()){da=Ml(da.value);for(var l=da.next();!l.done;l=da.next())n(l.value)}};Xb.prototype.bKh=function(n,O){var da=[];if(!this.active)return da;this.rLa=this.gridView.Zad();for(var l=
this.tableManager.rangeList.length-1;0<=l;l--){var K=this.tableManager.rangeList[l];K.bottom>=this.rLa&&this.Yad(K)<=this.rLa&&K.left>=n&&K.right<=O&&K.xua&&Array.add(da,K)}return da};Xb.prototype.Xnf=function(n,O){O.isRow||O.VPc(Object(Kc.a)(this,this.rJa,"headerBlockOnUpdatedBlockHtml"))};Xb.prototype.Ynf=function(n,O){O.isRow||(this.tableManager.rangeList.length||this.deactivate(),O.BCd(Object(Kc.a)(this,this.rJa,"headerBlockOnUpdatedBlockHtml")))};Xb.prototype.rJa=function(n,O){if(this.Ke())this.activate();
else if(n=this.active,this.deactivate(),!n){Rc.ULS.sendTraceTag(576073814,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(O=O.Ytb)&&this.UUf(O.ho[0],O.ho[O.ho.length-1],O.X3,O.ho)};Xb.prototype.Jqf=function(n,O){!this.gridView.dr&&(this.Ke()?this.activate():(n=this.active,this.deactivate(),n||Rc.ULS.sendTraceTag(576073813,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),O=O.Ytb)&&(n=yk.a(O.X3),this.UUf(O.ho[0],
O.ho[O.ho.length-1],n,O.ho)&&O.pHd(n))};Xb.prototype.vf=function(){this.gridView.$a.U3?this.deactivate():this.activate()};Xb.prototype.Yad=function(n){var O=this.gridView.kc.Rk(n);return O&&this.tableManager.k5e(n,O.usedRange.topLeft)?n.top+1:n.top};Object(hd.a)(Xb,"HeaderSnappingFeature",null,[7]);var uk=Sc.a;Cm(hc,uk);hc.prototype.create=function(){var n=this,O=Nf.GetServiceTaskFactory.create(this.$.ea,134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([O],
this.ma),function(){n.Jb(n.$.ea.Ea(68,void 0)||new Xb(O.result,te.g(n.$)))},this.ma,11)};hc.la=function(n){n.ea.La(67,new hc(n))};Object(hd.a)(hc,"HeaderSnappingFactory",Sc.a,[]);var dj=b(1224),zk=Sc.a;Cm(Xa,zk);Xa.prototype.create=function(){var n=this,O=this.$.ea,da=Nf.GetServiceTaskFactory.create(O,134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),l=Nf.GetServiceTaskFactory.Xa(O,213,214,this.vb,"Microsoft.Office.Excel.WebUI.Client.CellAutoComplete.ICellAutoCompleteReadoutHandler");
fe.TaskExtensions.Da(fe.TaskExtensions.Fe([da,l],this.ma),function(){var K=O.Ea(1,void 0);K||(K=new dj.CellAutoCompleteControl(n.$,da.result),l.result.la(K));n.Jb(K)},this.ma,3)};Xa.la=function(n){n.ea.La(151,new Xa(n))};Object(hd.a)(Xa,"CellAutoCompleteControlFactory",Sc.a,[]);Ea.prototype.dispose=function(){this.MPd();this.gXa=null};Ea.prototype.la=function(n){n&&(this.gXa=n,n.uPc(Object(Kc.a)(this,this.Pqf,"onReadCellAutoCompleteListBoxDescription")),n.E1(Object(Kc.a)(this,this.Qqf,"onReadCellAutoCompleteListBoxItem")),
n.Psg(Object(Kc.a)(this,this.Rqf,"onReadCellAutoCompleteMatchItem")))};Ea.prototype.MPd=function(){this.gXa&&(this.gXa.fCd(Object(Kc.a)(this,this.Pqf,"onReadCellAutoCompleteListBoxDescription")),this.gXa.mca(Object(Kc.a)(this,this.Qqf,"onReadCellAutoCompleteListBoxItem")),this.gXa.fUi(Object(Kc.a)(this,this.Rqf,"onReadCellAutoCompleteMatchItem")))};Ea.prototype.Pqf=function(n,O){1<O.length&&(n=Sd.a.instance.da(819),this.ariaLiveNotifier.KBf(n,O.length))};Ea.prototype.Qqf=function(n,O){Rc.ULS.shipAssertTag(18458262,
0,0<=O.selectedIndex&&0<=O.length&&O.selectedIndex<O.length,"Invalid ListEventArgs: SelectedIndex/Length");Rc.ULS.shipAssertTag(18458263,0,!mf.a.na(O.KH),"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.xNi(O.KH,O.selectedIndex+1,O.length)};Ea.prototype.Rqf=function(n,O){this.ariaLiveNotifier.PNa(O.KH)};Object(hd.a)(Ea,"CellAutoCompleteReadoutHandler",null,[376,7]);var Wi=Sc.a;Cm(Fd,Wi);Fd.prototype.create=function(){var n=this,O=this.$.ea;fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(O,
211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(da){da=O.Ea(213,void 0)||new Ea(da.result,O);n.Jb(da)},this.ma,3)};Fd.la=function(n){n.ea.La(214,new Fd(n))};Object(hd.a)(Fd,"CellAutoCompleteReadoutHandlerFactory",Sc.a,[]);Pc.cbh="ewa-dv";Pc.dbh="ewa-dv-buttonarea";Pc.jah="ewa-dlb";Pc.hyb="list-table";Pc.listItem="list-item";Pc.dyb="list-item-selected";Pc.iyb="list-table-touch";Pc.bbh="ewa-dpb";Object(hd.a)(Pc,"CssClassNames",null,[]);var Xi=b(520),nk=
b(45),ti=b(423),Jk=b(943),Xj=ch.ErrorDialog;Cm(Nc,Xj);Nc.prototype.dispose=function(){te.g(this.$).ga.bF(Object(Kc.a)(this,this.nd,"onSelectionChanged"));Xj.prototype.dispose.call(this)};Nc.prototype.setFocus=function(){switch(this.error.Severity){case 0:var n=4;break;case 1:n=3;break;case 2:n=0;break;default:n=this.closeAction}(n=this.getButton(n))?n.get_element().focus():Xj.prototype.setFocus.call(this)};Nc.prototype.Anb=function(){var n=te.g(this.$);n.isEditing&&n.Hc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",
0);4===this.returnValue&&this.OLd(1);if(2===this.returnValue||!this.returnValue){var O=n.Cc(null);if(O){n.Ha.LU();var da=Object.assign(new Nh.a,{Text:O.originalText});n.setCell(da,O.range,0,63,null)}this.$.Re(-798660877,Kg.a.Yb,8,null)}Xj.prototype.Anb.call(this)};Nc.prototype.aFa=function(){var n=te.g(this.$);n.isEditing&&n.Hc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.OLd(0);Xj.prototype.aFa.call(this)};Nc.prototype.nd=function(){this.setFocus()};
Nc.prototype.OLd=function(n){var O=te.g(this.$);fe.TaskExtensions.Da(O.startEdit(!1,n),function(){var da=O.Hc.textBox;da.text&&da.selectRange(0,da.text.length)},this.ma,11,zj.a.current)};Nc.QP=function(n,O,da){da=O.ea.Ea(14,void 0).P0a(da);n.MessageId=-1083021405;n.MessageIdName="DataValidationError";n.MessageIdHash=ah.a.Dv(n.MessageIdName);n.Severity=da?da.a3c:1;O=da&&da.mHa?ah.a.gg(da.mHa):null;da=da&&da.error?ah.a.gg(da.error):String.format("<p>{0}</p><p>{1}</p>",Sd.a.instance.da(855),Sd.a.instance.da(856));
switch(n.Severity){case 0:n.Appearance=18;break;case 1:n.Appearance=12;da+=String.format("<p>{0}</p>",Sd.a.instance.da(857));break;default:n.Appearance=3}n.Caption=O;n.Description=da;n.HelpDescription=Sd.a.instance.da(1254);n.HelpTopicId=Jk.a.nxe;return n};Object(hd.a)(Nc,"DataValidationErrorDeprecatedDialog",ch.ErrorDialog,[]);var ok=b(178),gk=b(164),Ej=si.a;Cm(dc,Ej);dc.prototype.dispose=function(){this===this.Db.vp&&(this.Db.vp=null);Ff.a.Ia(this.Dm);this.Dm=null;Ej.prototype.dispose.call(this)};
dc.prototype.P6i=function(){this.vu&&this.vu.error?this.errorMessage=this.vu.error:this.vu&&this.vu.options&1?(Rc.ULS.sendTraceTag(538817691,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=Sd.a.instance.da(1661),this.JZe=Jg.a.current.En(98)):(this.errorMessage=Sd.a.instance.da(1660),this.vxh(this.FDe));var n=this.vu?this.vu.a3c:1,O={};this.U9=(O.id=this.xc,O.errorDescription=this.errorMessage,O.helpImageUri=this.JZe,O);switch(n){case 0:this.lc=
1;this.Dc(1,"Retry");this.U9.dialogIcon=2;this.N7e=!0;break;case 1:this.lc=4;this.U9.dialogIcon=1;this.U9.additionalInformation=Sd.a.instance.da(857);break;default:this.lc=1,this.U9.dialogIcon=3}n={};this.U9.helpLink=(n.type="AppLinkProps",n.id=this.error.HelpTopicId,n.text=Sd.a.instance.da(1254),n.handler=Object(Kc.a)(this,this.A6a,"onHelpClicked"),n);n=qd.a.WQc([this.error]);O={};this.ZT=(O.fbError=!0,O.fbCrash=n,O.fbErrorId=gk.a(this.$).eqb(this.error.MessageIdHash),O.fbOrigin=this.xc,O.DismissHandler=
Object(Kc.a)(this,this.dtd,"onFeedbackUIClosed"),O);n={};this.U9.giveFeedbackLink=(n.type="AppLinkProps",n.id=ub.a.zbd,n.text=Sd.a.instance.da(1697),n.handler=Object(Kc.a)(this,this.Vti,"onGiveFeedbackClicked"),n)};dc.prototype.oxe=function(n){var O=this.$,da=this.N7e;this.hide();var l=te.g(O);l.isEditing&&l.Hc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===n&&da&&fe.TaskExtensions.Da(l.startEdit(!1,1),function(){var ka=l.Hc.textBox;ka.text&&ka.selectRange(0,ka.text.length)},
this.ma,11,zj.a.current);if(1===n&&!da){if(da=l.Cc(null)){l.Ha.LU();var K=Object.assign(new Nh.a,{Text:fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?da.cell.userInput:da.originalText});l.setCell(K,da.range,0,63,null)}O.Re(-798660877,Kg.a.Yb,8,null)}2===n&&fe.TaskExtensions.Da(l.startEdit(!1,0),function(){var ka=l.Hc.textBox;ka.text&&ka.selectRange(0,ka.text.length)},this.ma,11,zj.a.current)};dc.prototype.vxh=function(n){var O=this.$.ra.xa.dc();nf.u(this.$.ra.xa,
jg.q(n,this.$),Lf.b(Object(Kc.a)(this,this.ysi,"onGetDataValidationRuleInformationSuccessCallback")),Lf.a(Object(Kc.a)(this,this.xsi,"onGetDataValidationRuleInformationFailureCallback")),null,O)};dc.prototype.A6a=function(){Z.HelperMethods.y5(this.$.uF,this.error.HelpTopicId,this.$.yR)};dc.prototype.Vti=function(){this.kub();this.$.Re(802602464,2,8,this.ZT)};dc.prototype.xsi=function(){Rc.ULS.sendTraceTag(538817690,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};
dc.prototype.ysi=function(n){!n||Cf.a(n)?Rc.ULS.sendTraceTag(538817689,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(n=this.WGh(n.Result),this.U9.errorInformation=n,this.Qvc(this.mHa,this.iad(Object(Kc.a)(this,this.oxe,"dataValidationErrorDialogHandler")),this.U9))};dc.prototype.WGh=function(n){switch(n.RuleType){case 1:switch(n.ConditionType){case 0:var O=Sd.a.instance.Eb(107);return String.format(O,n.LowerBoundary,n.UpperBoundary);
case 1:return O=Sd.a.instance.Eb(108),String.format(O,n.LowerBoundary,n.UpperBoundary);case 2:return O=Sd.a.instance.Eb(109),String.format(O,n.LowerBoundary);case 3:return O=Sd.a.instance.Eb(110),String.format(O,n.LowerBoundary);case 4:return O=Sd.a.instance.Eb(111),String.format(O,n.LowerBoundary);case 5:return O=Sd.a.instance.Eb(112),String.format(O,n.UpperBoundary);case 6:return O=Sd.a.instance.Eb(113),String.format(O,n.LowerBoundary);case 7:return O=Sd.a.instance.Eb(114),String.format(O,n.UpperBoundary);
default:return"we couldn't get the details"}case 2:switch(n.ConditionType){case 0:return O=Sd.a.instance.Eb(115),String.format(O,n.LowerBoundary,n.UpperBoundary);case 1:return O=Sd.a.instance.Eb(116),String.format(O,n.LowerBoundary,n.UpperBoundary);case 2:return O=Sd.a.instance.Eb(117),String.format(O,n.LowerBoundary);case 3:return O=Sd.a.instance.Eb(118),String.format(O,n.LowerBoundary);case 4:return O=Sd.a.instance.Eb(119),String.format(O,n.LowerBoundary);case 5:return O=Sd.a.instance.Eb(120),String.format(O,
n.UpperBoundary);case 6:return O=Sd.a.instance.Eb(121),String.format(O,n.LowerBoundary);case 7:return O=Sd.a.instance.Eb(122),String.format(O,n.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(n.ConditionType){case 0:return O=Sd.a.instance.Eb(123),String.format(O,n.LowerBoundary,n.UpperBoundary);case 1:return O=Sd.a.instance.Eb(124),String.format(O,n.LowerBoundary,n.UpperBoundary);case 2:return O=Sd.a.instance.Eb(125),String.format(O,n.LowerBoundary);case 3:return O=Sd.a.instance.Eb(126),
String.format(O,n.LowerBoundary);case 4:return O=Sd.a.instance.Eb(127),String.format(O,n.LowerBoundary);case 5:return O=Sd.a.instance.Eb(128),String.format(O,n.UpperBoundary);case 6:return O=Sd.a.instance.Eb(129),String.format(O,n.LowerBoundary);case 7:return O=Sd.a.instance.Eb(130),String.format(O,n.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(n.ConditionType){case 0:return O=Sd.a.instance.Eb(131),String.format(O,n.LowerBoundary,n.UpperBoundary);case 1:return O=Sd.a.instance.Eb(132),
String.format(O,n.LowerBoundary,n.UpperBoundary);case 2:return O=Sd.a.instance.Eb(133),String.format(O,n.LowerBoundary);case 3:return O=Sd.a.instance.Eb(134),String.format(O,n.LowerBoundary);case 4:return O=Sd.a.instance.Eb(135),String.format(O,n.LowerBoundary);case 5:return O=Sd.a.instance.Eb(136),String.format(O,n.UpperBoundary);case 6:return O=Sd.a.instance.Eb(137),String.format(O,n.LowerBoundary);case 7:return O=Sd.a.instance.Eb(138),String.format(O,n.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(n.ConditionType){case 0:return O=
Sd.a.instance.Eb(139),String.format(O,n.LowerBoundary,n.UpperBoundary);case 1:return O=Sd.a.instance.Eb(140),String.format(O,n.LowerBoundary,n.UpperBoundary);case 2:return O=Sd.a.instance.Eb(141),String.format(O,n.LowerBoundary);case 3:return O=Sd.a.instance.Eb(142),String.format(O,n.LowerBoundary);case 4:return O=Sd.a.instance.Eb(143),String.format(O,n.LowerBoundary);case 5:return O=Sd.a.instance.Eb(144),String.format(O,n.UpperBoundary);case 6:return O=Sd.a.instance.Eb(145),String.format(O,n.LowerBoundary);
case 7:return O=Sd.a.instance.Eb(146),String.format(O,n.UpperBoundary);default:return"we couldn't get the details"}case 3:return O=Sd.a.instance.Eb(105),String.format(O,n.LowerBoundary);case 7:return O=Sd.a.instance.Eb(106),String.format(O,n.LowerBoundary);default:return"we couldn't get the details"}};dc.prototype.OLd=function(n){var O=te.g(this.$);fe.TaskExtensions.Da(O.startEdit(!1,n),function(){var da=O.Hc.textBox;da.text&&da.selectRange(0,da.text.length)},this.ma,11,zj.a.current)};dc.prototype.dtd=
function(){this.show(this.iOb)};dc.QP=function(n,O,da){O=O.ea.Ea(14,void 0).P0a(da);n.MessageId=-1083021405;n.MessageIdName="DataValidationError";n.MessageIdHash=ah.a.Dv(n.MessageIdName);n.Severity=O?O.a3c:1;n.HelpDescription=Sd.a.instance.da(1254);n.HelpTopicId=Jk.a.nxe;return n};Jl.Object.defineProperties(dc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},ma:{configurable:!0,enumerable:!0,get:function(){this.Dm=this.Dm||new ok.a;return this.Dm.token}}});
Object(hd.a)(dc,"DataValidationErrorDialog",si.a,[106,107,7,90]);var yj=b(1029),Pj=b(379),hj=yj.a;Cm(xb,hj);xb.prototype.dispose=function(){this.dataValidationControl=null;hj.prototype.dispose.call(this)};xb.prototype.Xh=function(n,O){this.dataValidationControl.qb=this.qb;var da=n.keyCode;return 1461300262!==O||16!==da&&17!==da&&18!==da?hj.prototype.Xh.call(this,n,O):!1};xb.prototype.nsd=function(){this.QU&&(this.dataValidationControl.qb=this.qb,this.dataValidationControl.show(this.dataValidationControl.uZ,
!0,!0,Tg.a.Sq||3===Kg.a.Yb))};xb.prototype.Zk=function(){};xb.prototype.tk=function(){this.dataValidationControl.show(this.dataValidationControl.uZ,!0,!0,Tg.a.Sq||3===Kg.a.Yb)};xb.prototype.xyd=function(n,O){return this.dataValidationControl.Xh(O)};Jl.Object.defineProperties(xb.prototype,{Cvb:{configurable:!0,enumerable:!0,get:function(){return Object(rf.a)(dc,this.$.Db.oh)}},QU:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(n){this.dataValidationControl.isListVisible=
n}},Fub:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Pj.a.L_c}}});Object(hd.a)(xb,"DataValidationListAutoCompleteBehavior",yj.a,[]);var Ai=b(961),vk=b(1028),Aj=Ai.a;Cm(eb,Aj);eb.prototype.dispose=function(){Aj.prototype.dispose.call(this);this.gyb=this.zib=null};eb.prototype.sda=function(n,O,da,l){if(n&&(!n||n.length)){this.K6(!1);this.tGa=n;this.bV=[];for(var K=0;K<n.length;K++)this.bV[K]=n[K]?n[K].Name:null;K=new Sys.StringBuilder;
K.append(String.format("<table class='{0}' aria-live='polite'><tbody>",this.Yaa));var ka=new Sys.StringBuilder,$a=new Sys.StringBuilder;n=0;var Lb=te.g(this.$).Cc(null);l=this.isEditing?l?l.text:this.editText:Lb?Lb.originalText:null;Lb=mf.a.na(l);var bc=0;Array.clear(this.ZBb);var Dc=[],wd=[],ke=[],jf=mf.a.na(l)?[""]:l.split(" ");l=l.trim();for(var Xf={},Sf=0;Sf<this.bV.length;Xf={byc:Xf.byc},Sf++){var xg=this.bV[Sf],xi=void 0;Xf.byc=xg.split(" ");xi=Gh.a.all(jf,function(dk){return function(Yi){return Gh.a.any(dk.byc,
function(Jj){return mf.a.UH(Jj,Yi)})}}(Xf));var Oi=mf.a.na(xg),pj=Array.contains(ke,xg);Oi||pj||this.isEditing&&!xi||(xi=xg?ah.a.gg(ah.a.C3b(xg)):"",xi=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.EZ,xi),Array.add(ke,xg),this.isEditing&&mf.a.UH(xg,l)?(ka.append(xi),Array.add(Dc,Sf)):($a.append(xi),Array.add(wd,Sf)),!Lb&&mf.a.equals(l,xg,!0)&&(n=this.isEditing?Dc.length-1:bc,Lb=!0),bc++)}this.CLa=bc;Array.addRange(this.ZBb,Dc);Array.addRange(this.ZBb,wd);K.append(ka);K.append($a);
K.append("</tbody></table>");this.og.innerHTML=K.toString();K=this.nn=je.DOMElementExtensions.uj(this.domElement,this.Yaa);this.hkb(K,O);this.K6(!0);this.sqa(O,da);this.lk=0<this.CLa?K.rows[n]:null}};eb.prototype.kPa=function(n){var O=!1;this.isEditing&&n&&(O=!this.CLa,n.endEdit(O,"DataValidationListBox.SetCellContent",0));if(!O&&(n=te.g(this.$),O=n.Cc(null))){var da=null;this.Dca&&-1!==this.Dca.SheetId&&-1!==this.Dca.Row&&-1!==this.Dca.Column&&(da={},da.SheetName=this.Dca.SheetId.toString(),da.FirstRow=
this.Dca.Row,da.FirstColumn=this.Dca.Column,da={ParameterType:6,SourceRange:da});var l=Object.assign(new Nh.a,{Text:this.me});n.setCell(l,O.range,0,63,da)}return!0};eb.prototype.sqa=function(n,O){var da=n?this.Ryb:this.uC;0>=this.CLa?this.og.style.height=n?Z.HelperMethods.Ub(this.Lec):Z.HelperMethods.Ub(this.Mec):(this.og.style.height="auto",this.CLa>da?(je.DOMElementExtensions.wF(this.og,Math.floor(this.og.offsetHeight*da/this.CLa)),this.og.style.overflowY="auto"):(this.og.style.height="auto",this.og.style.overflowY=
"hidden"));je.DOMElementExtensions.vq(this.og,O);je.DOMElementExtensions.vq(this.nn,O-(this.CLa>da?Oe.a.Lp:0))};Jl.Object.defineProperties(eb.prototype,{lk:{configurable:!0,enumerable:!0,get:function(){return this.zib},set:function(n){this.Iza(this.zib);if(n){this.zib=n;this.gyb.innerText="";this.Iza(this.zib);var O=this.ZBb[n.rowIndex];this.me=this.bV[O];this.tGa&&(this.Dca=this.tGa[O],Rc.ULS.shipAssertTag(593254471,0,!this.ZBb.length||!!this.Dca,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.gyb.innerText=this.me;this.epc(n)}else this.Dca=this.me=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return te.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return te.g(this.$).Hc.text}}});Object(hd.a)(eb,"DataValidationListBox",Ai.a,[]);var wk=b(256),Vg=b(235),Qj=b(120),Yj=b(167),pk=Te.a;Cm(Qa,pk);Qa.prototype.cPc=function(n){this.get_events().addHandler("ClickButton",n)};Qa.prototype.RBd=function(n){this.get_events().removeHandler("ClickButton",
n)};Qa.prototype.sPc=function(n){this.get_events().addHandler("KeyDown",n)};Qa.prototype.eCd=function(n){this.get_events().removeHandler("KeyDown",n)};Qa.prototype.EVb=function(n){this.get_events().addHandler("PointerOver",n)};Qa.prototype.qCd=function(n){this.get_events().removeHandler("PointerOver",n)};Qa.prototype.DVb=function(n){this.get_events().addHandler("PointerOut",n)};Qa.prototype.pCd=function(n){this.get_events().removeHandler("PointerOut",n)};Qa.prototype.nkb=function(n){this.get_events().addHandler("Blur",
n)};Qa.prototype.tEb=function(n){this.get_events().removeHandler("Blur",n)};Qa.prototype.L8=function(n){this.get_events().addHandler("Focus",n)};Qa.prototype.kca=function(n){this.get_events().removeHandler("Focus",n)};Qa.prototype.enable=function(){this.domElement&&(Sys.UI.DomElement.removeCssClass(this.domElement,Xi.a.pY),this.domElement.style.cursor="",Jf.a.instance.qa(Ve.a.click,this.domElement,Object(Kc.a)(this,this.Yc,"onClick")),Qj.KeyInputManager.instance.qa(Ve.a.Rb,this.domElement,Object(Kc.a)(this,
this.onKeyDown,"onKeyDown")),Yj.a.instance.qa(Ve.a.pointerOver,this.domElement,Object(Kc.a)(this,this.iw,"onPointerOver")),Yj.a.instance.qa(Ve.a.pointerOut,this.domElement,Object(Kc.a)(this,this.TM,"onPointerOut")),this.tc.qA("blur")||this.tc.la("blur",Object(Kc.a)(this,this.onBlur,"onBlur")),this.tc.qA("focus")||this.tc.la("focus",Object(Kc.a)(this,this.onFocus,"onFocus")),this.domElement.title=this.k8g,this.rl=!0)};Qa.prototype.disable=function(){this.domElement&&(Sys.UI.DomElement.addCssClass(this.domElement,
Xi.a.pY),this.domElement.style.cursor="",this.isEnabled&&(Jf.a.instance.Ca(Ve.a.click,this.domElement,Object(Kc.a)(this,this.Yc,"onClick")),Qj.KeyInputManager.instance.Ca(Ve.a.Rb,this.domElement,Object(Kc.a)(this,this.onKeyDown,"onKeyDown")),Yj.a.instance.Ca(Ve.a.pointerOver,this.domElement,Object(Kc.a)(this,this.iw,"onPointerOver")),Yj.a.instance.Ca(Ve.a.pointerOut,this.domElement,Object(Kc.a)(this,this.TM,"onPointerOut"))),this.domElement.title=this.h3g,this.rl=!1)};Qa.prototype.dispose=function(){this.isEnabled&&
(Jf.a.instance.Ca(Ve.a.click,this.domElement,Object(Kc.a)(this,this.Yc,"onClick")),Qj.KeyInputManager.instance.Ca(Ve.a.Rb,this.domElement,Object(Kc.a)(this,this.onKeyDown,"onKeyDown")),Yj.a.instance.Ca(Ve.a.pointerOver,this.domElement,Object(Kc.a)(this,this.iw,"onPointerOver")),Yj.a.instance.Ca(Ve.a.pointerOut,this.domElement,Object(Kc.a)(this,this.TM,"onPointerOut")),this.rl=!1);je.DOMElementExtensions.setVisible(this.domElement,!1);pk.prototype.dispose.call(this)};Qa.prototype.Yc=function(n){this.raiseEvent("ClickButton",
n);return!0};Qa.prototype.onKeyDown=function(n){this.raiseEvent("KeyDown",n);return!1};Qa.prototype.iw=function(){this.hovered=!0;this.raiseEvent("PointerOver");return!1};Qa.prototype.TM=function(){this.hovered=!1;this.raiseEvent("PointerOut");return!1};Qa.prototype.onBlur=function(n){Sh.g(n);this.focused=!1;this.raiseEvent("Blur")};Qa.prototype.onFocus=function(n){Sh.g(n);this.focused=!0;this.raiseEvent("Focus")};Qa.zb=function(n,O,da,l,K,ka,$a,Lb){n.removeAttribute("Href");n.setAttribute(ub.a.Wd,
ub.a.Gq);n.className=O;n.tabIndex=Lb;O=document.createElement("span");O.className=$a;Sys.UI.DomElement.addCssClass(O,da);O.tabIndex=-1;n.appendChild(O);n=document.createElement("img");n.src=Jg.a.Ee(l);n.className=K;n.alt=ka;n.tabIndex=-1;O.appendChild(n);return n};Jl.Object.defineProperties(Qa.prototype,{Sj:{configurable:!0,enumerable:!0,get:function(){return this.nI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.rl}}});Object(hd.a)(Qa,"ListButton",Te.a,[378,7]);var Ak=Te.a;
Cm(gb,Ak);gb.prototype.dispose=function(){this.$&&(this.MIb(!1),this.gridView.ga.gN(Object(Kc.a)(this,this.uh,"onActiveCellChanged")),this.gridView.Ps(Object(Kc.a)(this,this.onContentReady,"onContentReady")),this.gridView.zc.BTi(Object(Kc.a)(this,this.kmf,"onEditBoxDimensionsChanged")),this.$.Xo(Object(Kc.a)(this,this.Yd,"onWorkbookClosing")));this.Lve(!1);this.Mve(!1);Ff.a.rc(this.x1b);this.x1b=this.Zqa=this.og=this.g_=this.lD=this.gridView=this.$=null;Ak.prototype.dispose.call(this)};gb.prototype.v1c=
function(n){return!!this.P0a(n)};gb.prototype.iob=function(n,O){return fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactDataValidationErrorDialog",!1)?new dc(this.$,n,O):new Nc(this.$,n,O)};gb.prototype.P0a=function(n){n=this.gridView.getRangeInformation(n);for(var O=0;O<n.length;O++){var da=n[O];if(Object(rf.a)(ti.DataValidationRange,da))return da}return null};gb.prototype.Lth=function(){if(!this.Z1a)return"";var n=this.gZe?String.format("{0} {1}",this.vu.vzf,this.vu.prompt):"",
O=this.Htb?Sd.a.instance.da(804):"";return String.format(Sd.a.instance.Eb(17),n,O)};gb.prototype.Xh=function(n){var O=!1;if(this.isListVisible||(-569786022===n||541421805===n)&&this.Htb||1872288872===n&&this.uZ)switch(n){case -569786022:case 541421805:this.show(this.uZ,!this.isListVisible,!0,Tg.a.Sq||3===Kg.a.Yb);O=!0;break;case 1872288872:this.isListVisible?(this.show(this.uZ,!1,!0,!1),O=!0):this.uZ?(this.show(!1,!1,!0,!1),O=!0):this.qb&&(this.qb.endEdit(!1,"DataValidationControl.HandleKeyDown",
0),O=!0);break;case -798660877:this.Oh.Pu(1);O=!0;break;case 137938150:this.Oh.Pu(-1);O=!0;break;case 2091832999:this.Oh.Pu(this.Oh.uC-1);O=!0;break;case 742457698:this.Oh.Pu(-(this.Oh.uC-1));O=!0;break;case 125627505:case 267796030:O=this.kPa()}return O};gb.prototype.show=function(n,O,da,l){this.Tv();if(this.Uwb&&this.Z1a){var K=this.uMa;if(K){if(n||O||da)this.isVisible=!0;wk.c(this.style,this.isGridRtl);da&&this.Htb&&(this.Mve(!0),this.S2f(K,!1));O&&this.Htb&&this.aQa(l,K);n&&this.gZe&&this.lhj(K);
this.o7h||(this.isVisible=!1)}}};gb.prototype.Xta=function(n,O){if(!O||!O.cell.Fj)return null;var da=this.gridView.zc.textBox.domElement;var l=0<je.DOMElementExtensions.getHeight(da)&&0<je.DOMElementExtensions.getWidth(da)&&0<=da.offsetTop&&0<=da.offsetLeft;if(l)da=je.DOMElementExtensions.Xta(da,n.Pi);else{da=n.getCellBounds(O.cell);var K=je.DOMElementExtensions.getBoundingClientRect(n.Pi);da=new Sys.UI.Bounds(da.x-K.x,da.y-K.y,da.width,da.height)}if(da)if(l)2<da.height&&2<da.height&&(da.x+=1,da.y+=
1,da.height-=2,da.width-=2);else if(l=te.g(this.$).nJ(O.cell))l=l.width+1,K=mf.a.equals(Vg.a.O0a(O.cell,n.rtl),"right",!0),n.rtl&&K&&(da.x=da.x+da.width-l),O.Ija&&n.rtl===K&&(da.width=l);else return null;return da};gb.prototype.bTf=function(n){var O=this.Z1a;this.MIb(O);O?this.show(!0,n,!0,!1):this.Tv()};gb.prototype.kPa=function(){var n=!1;this.isListVisible&&(n=this.Oh.kPa(this.qb),this.show(this.uZ,!1,!0,!1));return n};gb.prototype.Tv=function(){this.pid=this.lgd=this.ljd=this.isListVisible=this.nvb=
this.uZ=this.isVisible=!1};gb.prototype.aQa=function(n,O){this.Htb&&!this.vu.tGa?this.nvb&&this.Fh.disable():(this.Lve(!0),this.Oh.sda(this.vu.tGa,n,this.qCh(O),this.qb),this.aAa(O,!1))};gb.prototype.lhj=function(n){this.vu.prompt&&(this.uZ=!0,this.iyj(this.vu.vzf,this.vu.prompt),this.i3f(n,!1))};gb.prototype.S2f=function(n,O){var da=n.y;this.Zqa.style.top=Z.HelperMethods.Ub(da);n=this.isGridRtl?n.x-this.Zqa.offsetWidth+1:n.x+n.width+1;this.Zqa.style.left=Z.HelperMethods.Ub(n);O?this.nvb=this.gridView.Ndc(new nk.a(n,
da))&&this.lgd:this.lgd=!0};gb.prototype.aAa=function(n,O){var da=n.y+n.height;n=this.isGridRtl?n.x+n.width-this.og.offsetWidth:n.x;this.og.style.top=Z.HelperMethods.Ub(da);this.og.style.left=Z.HelperMethods.Ub(n);O?this.isListVisible=this.gridView.Ndc(new nk.a(n,da))&&this.pid:this.pid=!0};gb.prototype.i3f=function(n,O){var da=n.y+n.height+5,l=this.activeCell;l=l?l.width/2:32;n=this.isGridRtl?n.x-this.g_.offsetWidth+l:n.x+n.width-l;this.g_.style.top=Z.HelperMethods.Ub(da);this.g_.style.left=Z.HelperMethods.Ub(n);
O?this.uZ=this.gridView.Ndc(new nk.a(n,da))&&this.ljd:this.ljd=!0};gb.prototype.iyj=function(n,O){if(O){var da=new Sys.StringBuilder;n&&da.append(String.format("<p class='dv-prompt-title'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",ah.a.gg(n)));da.append(String.format("<p class='dv-prompt-message'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",ah.a.gg(O)));this.g_.innerHTML=da.toString();n=je.DOMElementExtensions.uj(this.g_,"dv-prompt-titletext");if(O=je.DOMElementExtensions.uj(this.g_,
"dv-prompt-messagetext"))for(n=n?parseInt(String(Math.max(n.offsetWidth,O.offsetWidth))):O.offsetWidth,n+=6,je.DOMElementExtensions.vq(this.g_,n),O=0,da=this.g_.children.length;O<da;O++)je.DOMElementExtensions.vq(this.g_.children[O],n)}};gb.prototype.qCh=function(n){return n.width+this.Zqa.clientWidth-2+1};gb.prototype.Mve=function(n){this.$&&!this.Uwb||!n?(this.TWf(!1),Ff.a.Ia(this.Fh),this.Fh=null):(this.Fh||(this.Fh=new Qa(this.Zqa,"ewa-dv-listbutton",Xi.a.eha,1,"ewa-dv-listbutton",Sd.a.instance.da(854),
Df.a.XLg,Sd.a.instance.da(853),"",-1),this.TWf(!0)),this.nvb=!0,this.vu.tGa?this.Fh.isEnabled||this.Fh.enable():this.Fh.disable())};gb.prototype.Lve=function(n){this.$&&!this.Uwb||!n?(this.CQa(!1),Ff.a.Ia(this.Oh),this.Oh=null):(this.Oh||(this.Oh=new eb(this.$,this.og,this.gyb),this.CQa(!0)),this.isListVisible=!0)};gb.prototype.CQa=function(n){this.Oh&&(n&&!this.sQ?(this.Oh.L8(Object(Kc.a)(this,this.Rsd,"onDataValidationListBoxGotFocus")),this.Oh.vVb(Object(Kc.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),
this.Oh.Gkb(Object(Kc.a)(this,this.fxa,"onSetCell")),this.sQ=!0):!n&&this.sQ&&(this.Oh.kca(Object(Kc.a)(this,this.Rsd,"onDataValidationListBoxGotFocus")),this.Oh.enc(Object(Kc.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.Oh.IEb(Object(Kc.a)(this,this.fxa,"onSetCell")),this.sQ=!1))};gb.prototype.MIb=function(n){n&&!this.ZP?(this.gridView.view.nt(Object(Kc.a)(this,this.qq,"onGridScroll")),this.ZP=!0):!n&&this.ZP&&(this.gridView.view.Tr(Object(Kc.a)(this,this.qq,"onGridScroll")),this.ZP=
!1)};gb.prototype.TWf=function(n){this.Fh&&(n&&!this.cYb?(this.Fh.cPc(Object(Kc.a)(this,this.IMa,"onListButtonClicked")),this.Fh.sPc(Object(Kc.a)(this,this.IMa,"onListButtonClicked")),this.Fh.nkb(Object(Kc.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.cYb=!0):!n&&this.cYb&&(this.Fh.RBd(Object(Kc.a)(this,this.IMa,"onListButtonClicked")),this.Fh.eCd(Object(Kc.a)(this,this.IMa,"onListButtonClicked")),this.Fh.tEb(Object(Kc.a)(this,this.MJa,"ignoreOnBlurOnAutoCompleteEditBox")),this.cYb=
!1))};gb.prototype.Z2f=function(){if(this.Z1a){var n=this.uMa;n&&(this.S2f(n,!0),this.aAa(n,!0),this.i3f(n,!0))}};gb.prototype.uh=function(){this.bTf(!1)};gb.prototype.IMa=function(n,O){this.show(this.uZ,!this.isListVisible,!0,Tg.a.Sq||3===O.Cb||3===Kg.a.Yb);this.Rsd(null,null)};gb.prototype.Rsd=function(){this.gridView.setFocus()};gb.prototype.MJa=function(){this.qb.textBox.BJ=!0};gb.prototype.qq=function(){this.Z2f()};gb.prototype.onContentReady=function(){this.bTf(this.isListVisible)};gb.prototype.Yd=
function(){this.Tv()};gb.prototype.fxa=function(){this.kPa()};gb.prototype.kmf=function(){this.Z2f()};Jl.Object.defineProperties(gb.prototype,{Uwb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Gd&16)}},o7h:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.uZ||this.nvb}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return je.DOMElementExtensions.isVisible(this.og)},set:function(n){je.DOMElementExtensions.setVisible(this.og,n)}},uZ:{configurable:!0,
enumerable:!0,get:function(){return je.DOMElementExtensions.isVisible(this.g_)},set:function(n){je.DOMElementExtensions.setVisible(this.g_,n)}},nvb:{configurable:!0,enumerable:!0,get:function(){return je.DOMElementExtensions.isVisible(this.Zqa)&&!!this.Fh&&je.DOMElementExtensions.isVisible(this.Fh.domElement)},set:function(n){je.DOMElementExtensions.setVisible(this.Zqa,n);this.Fh&&je.DOMElementExtensions.setVisible(this.Fh.domElement,n)}},qb:{configurable:!0,enumerable:!0,get:function(){return this.lD},
set:function(n){this.lD=n}},Z1a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.v1c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Cc(null)}},gZe:{configurable:!0,enumerable:!0,get:function(){return this.Z1a&&!!this.vu&&!!(this.vu.options&2)&&!!this.vu.prompt}},Htb:{configurable:!0,enumerable:!0,get:function(){return this.Z1a&&!!this.vu&&!!(this.vu.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},
vu:{configurable:!0,enumerable:!0,get:function(){return this.P0a(this.activeCell.range)}},uMa:{configurable:!0,enumerable:!0,get:function(){var n=this.activeCell;return n?this.Xta(this.gridView,n):null}}});Object(hd.a)(gb,"DataValidationControl",Te.a,[355,7]);var Pg=Sc.a;Cm(pb,Pg);pb.prototype.create=function(){this.Jb(this.$.ea.Ea(14,void 0)||new gb(this.$))};Object(hd.a)(pb,"DataValidationControlFactory",Sc.a,[]);Ub.z4c="!";Ub.Puf="[";Ub.Ouf="]";Ub.openParen="(";Ub.closeParen=")";Ub.e6f=" /.(*\\".split("");
Ub.t3b="...";Ub.iCb="param_help_link";Ub.Evd="param_help_udf";Ub.o7c="function_list_box";Ub.eqh="function_param_box";Ub.q7c="function_reader_description";Ub.k7c="function_description_box";Ub.AMe="function_param_table";Ub.GDi="param_row_";Ub.Fvd="param_set";Ub.wvf="param_row_0";Ub.xvf="param_row_1";Ub.fqh="<div id='{0}' class='{1}'></div>";Ub.dqh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";Ub.yvf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
Ub.aqh="<div id='{0}' class='{1} {2} {3}'></div>";Ub.Yph="<div id='{0}' class='{1} {2} {3} {4}'></div>";Ub.Caf="[@";Ub.sRg=1;Ub.rRg=3;Ub.B0g=500;Ub.nff=50;Object(hd.a)(Ub,"FormulaAssistanceConstants",null,[]);var Rj=b(78),Bk=b(214);Object(hd.a)(Mb,"FormulaAuthoringUsageDetails",null,[]);Object(hd.a)(Hb,"FormulaSuggestionsUsageDetails",null,[]);Object(hd.a)(Jb,"AutocompleteCardInteractionUsageDetails",null,[]);Object(hd.a)(Va,"AutocompleteRenderOptimizationDetails",null,[]);Object(hd.a)(Da,"SessionDetails",
null,[]);Object(hd.a)(wa,"PerfMetrics",null,[]);Object(hd.a)(Wa,"AggregatedPerfMetrics",null,[]);La.prototype.mF=function(){this.bgc=cg.a.Ta.we.m};La.prototype.hA=function(n){-1!==this.bgc&&(n?(this.fkb(cg.a.Ta.we.m-this.bgc),this.bgc=-1):this.Zy.failedCount++)};La.prototype.Nlh=function(){this.uGd?(this.Zy.excludingFirstAction=La.eKe(this.AY),Array.add(this.AY,this.Zy.firstAction),this.Zy.includingFirstAction=La.eKe(this.AY)):(lj.i(this.AY),this.Zy.includingFirstAction.median=this.AY[Math.floor(.5*
this.AY.length)],this.Zy.includingFirstAction.P75=this.AY[Math.floor(.75*this.AY.length)],this.Zy.includingFirstAction.P95=this.AY[Math.floor(.95*this.AY.length)])};La.prototype.fkb=function(n){this.uGd?(this.Zy.count?1E3>this.Zy.count&&Array.add(this.AY,n):this.Zy.firstAction=n,this.Zy.count++):(1E3>this.Zy.count&&Array.add(this.AY,n),this.Zy.count++,this.Zy.includingFirstAction.average=Math.round((this.Zy.includingFirstAction.average*(this.Zy.count-1)+n)/this.Zy.count),this.Zy.includingFirstAction.max=
Math.max(this.Zy.includingFirstAction.max,n))};La.eKe=function(n){var O=new Wa;0<n.length&&(lj.i(n),O.median=n[Math.floor(.5*n.length)],O.P75=n[Math.floor(.75*n.length)],O.P95=n[Math.floor(.95*n.length)],O.max=n[n.length-1],O.average=lj.g(n,function(da){return da})/n.length);return O};Object(hd.a)(La,"PerformanceMeasurement",null,[]);var cj=b(41),Ij=b(107);Gc.prototype.mF=function(n){this.F7a.tb(n)||this.F7a.ja(n,new La);this.F7a.oa(n).mF()};Gc.prototype.hA=function(n,O){O=void 0===O?!0:O;this.F7a.tb(n)&&
this.F7a.oa(n).hA(O)};Gc.prototype.dNf=function(n){var O="Undefined";switch(n){case 1:O="Collapsed";break;case 0:O="Expanded";break;case 2:O="Hidden"}this.Wha.argumentAssistanceCardInitialMode=O};Gc.prototype.Yd=function(){this.c$i();this.wb.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging())};Gc.prototype.getJsonForLogging=function(){return"{"+this.w2("SessionDetails",this.Vpc)+","+this.w2("FormulaAuthoringUsage",this.Wha)+","+this.w2("FormulaSuggestionsUsage",this.k6b)+","+this.w2("AutocompleteCardInteraction",
this.P1)+","+this.w2("AutocompleteRenderOptimization",this.Llb)+","+this.vHh()+"}"};Gc.prototype.c$i=function(){this.Vpc.argumentAssistanceFlight=this.u9c("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Vpc.autoCompleteUIFlight=this.u9c("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Vpc.smartFormulaBarAutoCompleteFlight=this.u9c("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled")};Gc.prototype.vHh=function(){for(var n=new Aa.a,O=Ml(this.F7a),da=O.next();!da.done;da=
O.next())da=da.value,da.value.Nlh(),n.add(String.format('"{0}":{1}',da.key,sf.a.Oc(da.value.Zy)));return String.format('"PerfMeasurements": {{{0}}}',n.toArray().join(","))};Gc.prototype.u9c=function(n,O){return mf.a.contains(this.wb.Ba.FlightHolder.FlightId,O,!0)?fd.EwaSettings.getBooleanFeatureGate(n+O,!1)?"T":"C":"None"};Gc.prototype.w2=function(n,O){return String.format('"{0}":{1}',n.toString(),cj.c(O))};Jl.Object.defineProperties(Gc.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb},
set:function(n){this.wb||(this.wb=n,this.wb.yn(Object(Kc.a)(this,this.Yd,"onWorkbookClosing")))}}});Jl.Object.defineProperties(Gc,{instance:{configurable:!0,enumerable:!0,get:function(){Gc.Pa||(Gc.Pa=new Gc);return Gc.Pa}}});Gc.Pa=null;Object(hd.a)(Gc,"FormulaAssistanceTelemetryManager",null,[]);var Ck=b(1030),Dk=qi.a;Cm(nc,Dk);nc.prototype.xkb=function(n){this.addHandler("FunctionInfoLoaded",n)};nc.prototype.cnc=function(n){this.removeHandler("FunctionInfoLoaded",n)};nc.prototype.rsg=function(n){this.addHandler("FunctionInfoReset",
n)};nc.prototype.QTi=function(n){this.removeHandler("FunctionInfoReset",n)};nc.prototype.dispose=function(){var n=this.$.ea.Ea(268,void 0);n&&n.ZBd(Object(Kc.a)(this,this.gnf,"onFullFunctionListLoaded"));this.wb=null;Dk.prototype.dispose.call(this)};nc.prototype.hIf=function(){this.raiseEvent("FunctionInfoReset")};nc.prototype.tDd=function(){this.hIf();this.hFc=!1;this.eS=null;this.fFc=!0};nc.prototype.$pb=function(n,O){var da=this;O=void 0===O?!1:O;if(this.k4)this.tAf();else{Rc.ULS.sendTraceTag(143947,
0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.Ba.UICultureTag);var l=null;(l=this.$.ea.Ea(268,void 0))||Rc.ULS.sendTraceTag(37855393,0,50,"instantaneousSupportInformationManager == null");if(l&&l.Zha&&0<l.Zha.length)fd.EwaSettings.ka(123)?l.Foh(Object(Kc.a)(this,this.tnf,"onGetFunctionListFullSucceeded")):this.iAd(l.Zha,!0,!1);else{var K=this.$.ra.xa.dc();n&&(this.$.fa.pc||O)&&!this.L1h&&(O?hg.a(this.$.userOperationManager,function(ka,$a,Lb){return nf.w(da.$.ra.xa,
n,Lf.b(ka,Object(Kc.a)(da,da.vnf,"onGetFunctionListPartialSucceeded")),Lf.a($a,Object(Kc.a)(da,da.unf,"onGetFunctionListPartialFailed")),Lb,n,K)},function(ka){return new bh.a(130,0,ka,16)},null):nf.w(this.$.ra.xa,n,Object(Kc.a)(this,this.vnf,"onGetFunctionListPartialSucceeded"),Object(Kc.a)(this,this.unf,"onGetFunctionListPartialFailed"),null,n,K));!this.k4&&this.$.fa.pc&&(l?(Rc.ULS.sendTraceTag(37855394,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.k4,this.$.fa.pc),l.Yee(Object(Kc.a)(this,this.gnf,"onFullFunctionListLoaded"))):(Rc.ULS.sendTraceTag(37855395,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),nf.w(this.$.ra.xa,{FilterType:0},Object(Kc.a)(this,this.tnf,"onGetFunctionListFullSucceeded"),null,null,null,K),this.fFc=!1))}}};nc.prototype.oAh=function(n){return 0>n||n>=this.eS.length?null:this.eS[n]};nc.prototype.I9c=function(n){return Ch.a.Ec(this.s7c,n.toUpperCase())};nc.prototype.IQe=
function(n){return Ch.a.Ec(this.eIa,n)};nc.prototype.Ihd=function(n){return!n.GroupUI};nc.prototype.vnf=function(n,O){Rc.ULS.sendTraceTag(37855424,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.jnf(n,!!O&&1!==O.FilterType,!0)};nc.prototype.unf=function(){Rc.ULS.sendTraceTag(37855425,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.eS=null};nc.prototype.gnf=function(n){Rc.ULS.sendTraceTag(37855426,0,
50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.iAd(n.Zha,!0,!1)};nc.prototype.tnf=function(n){Rc.ULS.sendTraceTag(37855427,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.jnf(n,!0,!1)};nc.prototype.jnf=function(n,O,da){var l=Cf.a(n);Rc.ULS.sendTraceTag(37855428,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",l);l?(te.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.fa.Wo(n.Errors)):
(this.iAd(n.Result,O,da),Xg.a.jva()&&!Xg.a.oZ(this.$)&&this.pyj())};nc.prototype.iAd=function(n,O,da){Rc.ULS.sendTraceTag(34719503,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",n.length,O,da,this.k4);this.k4||(this.eS=n,this.kDg(O),this.hFc=!da,this.tAf())};nc.prototype.tAf=function(){this.raiseEvent("FunctionInfoLoaded")};nc.prototype.pyj=function(){var n=this;this.rwb?this.pluginScheduler.notifier().setFunctionsInfo(this.r6b):
fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,413,414,1,"Microsoft.Office.Excel.WebUI.Client.IPluginScheduler"),function(O){O.result.notifier().setFunctionsInfo(n.r6b)},this.$.ma,3)};nc.prototype.kDg=function(n){function O(ke,jf){return ke.NameUI.localeCompare(jf.NameUI)}var da=Sd.a.instance.da(979),l=[];this.eIa={};this.Q7=[];this.eIa[da]=l;var K=Sd.a.instance.da(980),ka=[];Array.add(this.Q7,da);Array.add(this.Q7,K);da=0;for(var $a=this.eS.length;da<$a;da++){var Lb=this.eS[da];Lb.IsCompatibility||
Array.add(ka,Lb);var bc=Lb.NameUI,Dc=Lb.NameDataStrings;this.s7c[Dc.toUpperCase()]||(this.s7c[Dc.toUpperCase()]=Lb);this.EMe[bc.toUpperCase()]||(this.EMe[bc.toUpperCase()]=Lb);if(!this.Ihd(Lb)){if(n){bc=Lb.GroupUI;var wd=Ch.a.Ec(this.eIa,bc);wd||(wd=[],this.eIa[bc]=wd,Array.add(this.Q7,bc));Array.add(wd,Lb)}Lb.IsCommonlyUsed&&Array.add(l,Lb);Lb.IsCompatibility||Array.add(this.Ncg,Dc)}}this.eIa[K]=ka;n&&(nc.QDf(l,[2,3,0,5,4,9,1,7,8,6]),l=Array(14),l[0]=0,l[1]=1,l[2]=7,l[3]=11,l[4]=5,l[5]=2,l[6]=6,
l[7]=10,l[8]=9,l[9]=3,l[10]=4,l[11]=13,l[12]=12,l[13]=8,nc.QDf(this.Q7,l),l=[],Array.addRange(l,this.Q7),Array.removeAt(l,13),this.Q7=l);this.eS=Array.clone(this.eS);this.eS.sort(function(ke,jf){return ke.NameDataStrings.localeCompare(jf.NameDataStrings)});l=1;for(K=this.Q7.length;l<K&&n;l++)this.eIa[this.Q7[l]].sort(O);n=0;for(l=this.eS.length;n<l;n++)this.eS[n].FunctionIndex=n};nc.cFh=function(n){return"XLWAEndUser_"+n};nc.QDf=function(n,O){for(var da=Array.clone(n),l=0;l<da.length&&l<O.length;l++)n[l]=
da[O[l]]};Jl.Object.defineProperties(nc.prototype,{k4:{configurable:!0,enumerable:!0,get:function(){return this.hFc}},L1h:{configurable:!0,enumerable:!0,get:function(){return this.fFc}},r6b:{configurable:!0,enumerable:!0,get:function(){var n=this.eS,O=Ck.a(this.$);if(!O)return n;O=O.Ezh();var da=O.length;if(0>=da)return n;var l=[];Array.addRange(l,n);for(n=0;n<da;n++){var K=O[n],ka={};ka.FunctionIndex=l.length;ka.HelpId=ka.GroupUI=null;ka.Help=K.description;ka.IsCommonlyUsed=ka.IsCompatibility=!1;
ka.NameDataStrings=K.name;ka.NameUI=K.name;ka.Params=null;ka.ParamsHelp=null;Array.add(l,ka)}return l}},tMe:{configurable:!0,enumerable:!0,get:function(){return this.Q7}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(hd.a)(nc,"FunctionInfoManager",qi.a,[357,358,7]);var qk=b(347),hk=wc.a;Cm(cb,hk);cb.prototype.initialize=function(){Sys.UI.DomElement.addCssClass(this.Qb,Rj.a.Mah);this.Qb.innerHTML=cb.dA();this.Ne||(this.Tk(),this.z1());hk.prototype.initialize.call(this);
var n=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-link-container");this.rtl&&(n.align="right",this.urb.style.marginLeft="5px");this.Ne&&(n.style.padding="1px");this.functionInfoManager.$pb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};cb.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.cnc(Object(Kc.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded")),this.functionInfoManager.$.fa.xk(Object(Kc.a)(this,this.ed,"onSessionIdChanged")));Ff.a.rc([this.NYb,
this.Z4,this.aub,this.bIa,this.vrb]);hk.prototype.dispose.call(this)};cb.prototype.Tk=function(){this.cIa=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-category-select");this.Yha=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-select");this.cIa.setAttribute(ub.a.Wd,ub.a.EEa);this.bIa=new Th.a(this.cIa,!0);this.vrb=new Th.a(this.Yha,!0);this.yMe=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-loading");this.urb=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-help-link");this.CMe=je.DOMElementExtensions.uj(this.Qb,
"ewa-dlg-udf-name");this.Hbf=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-icon");this.zMe=$get(cb.l7c,this.Qb);this.Xha=je.DOMElementExtensions.uj(this.Qb,"ewa-dlg-function-help-string");this.Ne&&(this.Xha.style.paddingLeft="1px");this.functionInfoManager.xkb(Object(Kc.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));this.functionInfoManager.$.fa.ak(Object(Kc.a)(this,this.ed,"onSessionIdChanged"))};cb.prototype.$P=function(n){var O=this;this.$.ea.ub(40,function(){O.bIa.$P(n)})};
cb.prototype.rm=function(){this.formulaAssistanceControl.set_visible(!1);hk.prototype.rm.call(this);this.Mcd||(this.getButton(0).get_element().disabled=!0)};cb.prototype.setFocus=function(){!this.cIa.disabled&&this.Mcd&&je.DOMElementExtensions.setFocus(this.cIa)};cb.prototype.commit=function(){return!0};cb.prototype.Anb=function(){var n=this,O=this.O9.NameDataStrings;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var da=new ig.a(-433697611,0,this.$.jd,8,null),
l={};l=(l.MenuItemId=O,l);this.$.Na.Xb(da,l)}else{O+=Ub.openParen;da=te.g(this.$);da.view.visibleArea.contains(da.Mg(null))||da.Dt(da.ga.ya.activeCell,3,Oj.a.Zph);var K=this.bHa.textBox;if(this.bHa.isEditing&&!mf.a.na(this.bHa.text)){l=this.bHa.text;var ka=this.DUc?l.substring(0,this.DUc):"=";this.bHa.text=ka+O+l.substring(this.DUc+(K.Xu?K.Xu.length:0),l.length);K.caretPosition=ka.length+O.length}else fe.TaskExtensions.Da(da.startEdit(!0,1),function(){n.bHa.text="="+O;var $a=O.length+1;K.jPa($a);
K.caretPosition=$a},this.ma,11,zj.a.current);da.Zi&&(da=da.Hc,da.text=K.text,da.setCaretPosition(K.caretPosition));(da=this.bHa.MO.get(Pj.a.xta))&&da.lT(!1)}};cb.prototype.aFa=function(){this.formulaAssistanceControl.xlb()};cb.prototype.zta=function(n){this.vrb.clear();for(var O=cb.l7c+" "+cb.uMe,da=0,l=n.length;da<l;++da){var K=this.vrb.oL(n[da].NameUI,n[da].FunctionIndex.toString(),!1);Tg.a.Iu&&K.classList.add("ewa-dlg-select-option-explorer-edge");K.setAttribute(ub.a.DD,cb.vMe);K.setAttribute(ub.a.uL,
O)}this.vrb.selectedIndex=0};cb.prototype.onFunctionInfoLoaded=function(){if(!this.bIa.count){for(var n=this.functionInfoManager.tMe,O=0,da=n.length;O<da;++O)this.bIa.oL(n[O],n[O],!1).className=Rj.a.Oah;this.bIa.selectedIndex=0;Ff.a.rc([this.NYb,this.Z4,this.aub]);this.NYb=this.Ud.Kd(this.cIa);this.Z4=this.Ud.Kd(this.Yha);this.aub=this.Ud.Kd(this.urb);this.NYb.la("change",Object(Kc.a)(this,this.hnf,"onFunctionCategorySelectionChanged"));this.Z4.la("change",Object(Kc.a)(this,this.esi,"onFunctionListSelectionChanged"));
this.Z4.la("dblclick",Object(Kc.a)(this,this.fsi,"onFunctionListSelectionDblClick"));this.aub.la("click",Object(Kc.a)(this,this.qba,"onHelpLinkClick"));this.aub.la("keyup",Object(Kc.a)(this,this.cui,"onHelpLinkKeyUp"));je.DOMElementExtensions.setVisible(this.Yha,!0);je.DOMElementExtensions.setVisible(this.yMe,!1);this.$.I_c&&je.DOMElementExtensions.setVisible(this.Hbf,!0)}this.hnf(null);this.getButton(0).get_element().disabled=!1;this.cIa.disabled=!1;this.SGb();this.Mcd=!0};cb.prototype.qba=function(){this.O9&&
Bb(this.$,this.O9.HelpId,this.O9.IsDynamicUdf)};cb.prototype.cui=function(n){13!==n.keyCode&&32!==n.keyCode||this.qba(n)};cb.prototype.hnf=function(){var n=this.functionInfoManager.IQe(this.bIa.me.value);this.zta(n);this.Yha.scrollTop=0;this.LNf()};cb.prototype.LNf=function(){if(this.O9){this.urb.parentNode.className=Rj.a.Sah+(this.functionInfoManager.Ihd(this.O9)?"-udf":"");var n=this.O9.NameDataStrings;this.CMe.innerText=n;this.urb.innerText=n;this.Xha.innerText=this.O9.Help;n=this.O9.Params.split(Ub.z4c);
this.zMe.innerText=Ub.openParen+(1<n.length?Ub.t3b:n[0])+Ub.closeParen}};cb.prototype.esi=function(){this.LNf()};cb.prototype.fsi=function(n){this.O9&&(Sh.g(n),this.close(0))};cb.prototype.ed=function(n,O){Bk.b(O)&&this.su()};cb.dA=function(){return String.format("<div class='"+Rj.a.Nah+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+zh.a.Ey+"'>{1}</div>\r\n<div class='"+Rj.a.uEe+"'>\r\n\t<select id='{16}' class='{17} "+
Df.a.zu+" "+Df.a.Er+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Rj.a.Qah+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+Df.a.zu+"'>\r\n\t\t\t<span class='"+Df.a.MB+" "+Rj.a.Rah+"'>\r\n\t\t\t\t<img title='{3}' class='"+Df.a.Jfh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
Sd.a.instance.da(983),Sd.a.instance.da(984),Sd.a.instance.da(708),Sd.a.instance.Eb(3),Jg.a.Ee(13),Sd.a.instance.da(985),cb.Xph,cb.l7c,7,"ewa-dlg-function-category-select","ewa-dlg-function-help-link","ewa-dlg-function-loading","ewa-dlg-function-help-string","ewa-dlg-udf-name","ewa-dlg-function-icon","ewa-dlg-function-link-container",cb.bqh,"ewa-dlg-select"+(Tg.a.Iu?" ewa-dlg-select-explorer-edge":""),cb.uMe,cb.vMe)};Jl.Object.defineProperties(cb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},
O9:{configurable:!0,enumerable:!0,get:function(){if(!this.Yha||!this.Yha.firstChild)return null;var n=Number.parseInvariant(this.Yha.children[this.Yha.selectedIndex].value);return this.functionInfoManager.oAh(n)}}});cb.l7c="function_dialog_param_string";cb.uMe="function_dialog_function_description";cb.vMe="function_dialog_function_name";cb.bqh="function_list";cb.Xph="function_category";Object(hd.a)(cb,"FunctionDialog",wc.a,[]);Ga.prototype.onFunctionInfoLoaded=function(){!mf.a.na(this.menuId)&&Array.contains(this.$ph,
this.menuId)&&this.frame.yw(this.menuId)};Ga.prototype.$c=function(n,O){if(!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(O){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return n=te.g(this.$).Ej,(O=n.MO.get(Pj.a.xta))&&(O.Fub||!n.isEditing||0>=n.text.length)?!1:!0;default:return!1}};
Ga.prototype.executeCommand=function(n,O,da){O=O.command;n=te.g(this.$);switch(O){case 753860909:case -2060563418:fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(da=n.Ej,n.inRangePicker&&da.HD(!1),this.create(da)):n.Cc(null)&&(da=n.Ej,(O=da.MO.get(Pj.a.xta))&&(O.Fub||!da.isEditing||0>=da.text.length)&&(n.inRangePicker&&da.HD(!1),this.create(da)));break;case -433697611:var l=da[Kg.a.Vd]+Ub.openParen;da.UILocation&&this.$.Re(-1075437823,-1,0,null);n.view.visibleArea.contains(n.Mg(null))||
n.Dt(n.ga.ya.activeCell,3,Oj.a.aph);var K=n.Ej,ka=K.textBox;da=K.textBox.caretPosition;if(K.isEditing&&!mf.a.na(K.text)){O=K.text;var $a=da?O.substring(0,da):"=";K.text=$a+l+O.substring(da+(ka.Xu?ka.Xu.length:0),O.length);ka.caretPosition=$a.length+l.length}else fe.TaskExtensions.Da(n.startEdit(!0,1),function(){K.text="="+l;var Lb=l.length+1;ka.jPa(Lb);ka.caretPosition=Lb},this.$.ma,11,zj.a.current);n.Zi&&(n=n.Hc,n.text=ka.text,n.setCaretPosition(ka.caretPosition));(n=K.MO.get(Pj.a.xta))&&n.lT(!1)}return ug.Task.Ua(!0)};
Ga.prototype.Jc=function(n,O){switch(O.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};Ga.prototype.Uqh=function(n,O){O=this.Va.sp(O);var da=this.Va.Vc(),l=this.functionInfoManager.IQe(n);if(!l)return Rc.ULS.sendTraceTag(556045786,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),O.JB();for(var K=0;K<l.length;++K){var ka=l[K].NameUI,$a=this.Va.fP(277,"Formulas."+n+"MenuItem_"+l[K].FunctionIndex.toString(),-433697611,null,1,"None",
0,0,ka,!1,0);$a.label=ka;var Lb=l[K].Params.split(Ub.z4c);$a.kR(ka+" "+(Ub.openParen+(1<Lb.length?Ub.t3b:Lb[0])+Ub.closeParen)+"\n"+l[K].Help);Array.add(da.buttons,$a)}n=this.Va.Vc();l=this.Va.fP(277,"Formulas.MoreFunctionsMenuItem",-2060563418,Df.a.GHe,3,"Image16by16",982,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(n.buttons,l);Array.add(O.Fc,da);Array.add(O.Fc,n);return O.JB()};Ga.prototype.gd=function(n,O,da){n=this.nAh(O);if(-1===n)return!1;this.menuId=da.MenuId;if(!this.functionInfoManager.k4)return this.functionInfoManager.$pb({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;n=this.functionInfoManager.tMe[n];this.wL[n]=this.wL[n]||this.Uqh(n,da.MenuId);da.MenuItems=this.wL[n];return!0};Ga.prototype.create=function(n){(new cb(this.$,n)).Bf()};Ga.prototype.nAh=function(n){switch(n){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;
case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(hd.a)(Ga,"FormulaAssistanceCommandHandler",null,[159]);var Ek=of.a;Cm(ic,Ek);ic.prototype.Rd=function(){var n=this,O=Nf.GetServiceTaskFactory.create(this.$.ea,102,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),da=Nf.GetServiceTaskFactory.create(this.$.ea,153,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFunctionInfoManager");
fe.TaskExtensions.Da(fe.TaskExtensions.Fe([O,da],this.ma),function(){n.Hd([new Ga(n.$,O.result,da.result)])},this.ma,3)};ic.la=function(n){of.a.ie(92,new ic(n))};Object(hd.a)(ic,"FormulaAssistanceCommandHandlerFactory",of.a,[]);sc.prototype.dispose=function(){this.MPd();this.dIa=this.WHa=this.Vha=null};sc.prototype.BRc=function(n){n&&(this.Vha=n,this.Vha.Zee(Object(Kc.a)(this,this.Sqf,"onReadFormulaAssistanceFunctionName")),this.Vha.Qfe(Object(Kc.a)(this,this.Uqf,"onReadFormulaAssistanceParameterOld")),
this.lwb&&this.Vha.Pfe(Object(Kc.a)(this,this.Tqf,"onReadFormulaAssistanceParameter")))};sc.prototype.CRc=function(n){this.yKa&&n&&(this.WHa=n,this.WHa.Xee(Object(Kc.a)(this,this.cnf,"onFormulaSuggestionsCardOpened")),this.WHa.Wee(Object(Kc.a)(this,this.Xmf,"onFocusSetOnFormulaSuggestionsCard")))};sc.prototype.$je=function(n){n&&(this.dIa=n,this.dIa.Rfe(Object(Kc.a)(this,this.Vqf,"onReadListItemWithDescription")),this.dIa.uPc(Object(Kc.a)(this,this.Oqf,"onReadAutoCompleteListBoxDescription")))};sc.prototype.MPd=
function(){this.Vha&&(this.Vha.tFf(Object(Kc.a)(this,this.Sqf,"onReadFormulaAssistanceFunctionName")),this.Vha.UFf(Object(Kc.a)(this,this.Uqf,"onReadFormulaAssistanceParameterOld")),this.lwb&&this.Vha.TFf(Object(Kc.a)(this,this.Tqf,"onReadFormulaAssistanceParameter")));this.dIa&&(this.dIa.VFf(Object(Kc.a)(this,this.Vqf,"onReadListItemWithDescription")),this.dIa.fCd(Object(Kc.a)(this,this.Oqf,"onReadAutoCompleteListBoxDescription")));this.yKa&&this.WHa&&(this.WHa.sFf(Object(Kc.a)(this,this.cnf,"onFormulaSuggestionsCardOpened")),
this.WHa.rFf(Object(Kc.a)(this,this.Xmf,"onFocusSetOnFormulaSuggestionsCard")))};sc.prototype.Sqf=function(n,O){this.wNi(O.functionName,O.p7c)};sc.prototype.Uqf=function(n,O){this.vNi(O.p7c,O.UFd,O.HDi)};sc.prototype.Tqf=function(n,O){n=[];O=Ml(O.UFd);for(var da=O.next();!da.done;da=O.next())if(da=da.value,!this.f4a||void 0!==da&&null!==da)da=da.trim(),mf.a.na(da)||Array.add(n,da);if(!this.f4a||n.length){O=new Sys.StringBuilder;for(da=0;da<n.length;da++){var l=this.bTc(n[da]),K=sc.Owd(da,n.length);
O.append(l);O.append(K);mf.a.na(K)||O.append(this.ariaLiveNotifier.cwa)}this.ariaLiveNotifier.readText(O.toString())}};sc.prototype.Vqf=function(n,O){this.ariaLiveNotifier.yNi(O.KH,O.description,O.selectedIndex.toString(),O.length.toString())};sc.prototype.Oqf=function(n,O){this.ariaLiveNotifier.KBf(O.description,O.length)};sc.prototype.cnf=function(){this.ariaLiveNotifier.BDb(Sd.a.instance.da(844),ub.a.UWa)};sc.prototype.Xmf=function(){this.ariaLiveNotifier.readText(Sd.a.instance.da(845))};sc.prototype.wNi=
function(n,O){if(O){var da=new Sys.StringBuilder;this.lwb||(da.append(Sd.a.instance.Eb(56)),da.append(this.ariaLiveNotifier.cwa));for(var l=0;l<O.length;l++)da.append(n),da.append(this.ariaLiveNotifier.cwa),da.append(this.bTc(O[l])),da.append(sc.Owd(l,O.length));this.lwb&&(da.append(Sd.a.instance.da(843)),da.append(this.ariaLiveNotifier.cwa));this.ariaLiveNotifier.readText(da.toString())}};sc.prototype.vNi=function(n,O,da){if(n){var l=new Sys.StringBuilder,K=0;if(O){for(var ka=0;ka<O.length;ka++)if(da>=
n[ka].split(this.$.listSeparator).length)K++;else{var $a=O[ka].trim();if(mf.a.na($a))return;$a=this.bTc($a);var Lb=sc.Owd(ka-K,O.length-K);l.append($a);l.append(Lb);mf.a.na(Lb)||l.append(this.ariaLiveNotifier.cwa)}this.ariaLiveNotifier.readText(l.toString())}}};sc.prototype.bTc=function(n){if(mf.a.na(n))return"";var O=n.split(this.$.listSeparator);n=new Sys.StringBuilder;O=Ml(O);for(var da=O.next();!da.done;da=O.next()){var l=da.value;sc.ghd(l)?n.append(l):(l=(da=sc.U3h(l))?l.replace("[","").replace("]",
""):l,n.append(String.format(da?Sd.a.instance.Eb(58):Sd.a.instance.Eb(57),l)));n.append(this.ariaLiveNotifier.cwa)}return n.toString()};sc.Owd=function(n,O){if(n>=O||1===O)return Rc.ULS.shipAssertTag(19013776,0,n<O,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),"";var da=new Sys.StringBuilder;da.appendLine(String.format(Sd.a.instance.Eb(54),n+1,O));return da.toString()};sc.ghd=function(n){return mf.a.contains(n,Ub.t3b,!0)};sc.U3h=function(n){return n.trimStart().startsWith(Ub.Puf)||
n.trimEnd().endsWith(Ub.Ouf)};Object(hd.a)(sc,"FormulaAssistanceReadoutHandler",null,[377,7]);var ni=Sc.a;Cm(tc,ni);tc.prototype.create=function(){var n=this,O=this.$.ea;fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(O,211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(da){da=O.Ea(219,void 0)||new sc(da.result,n.$);n.Jb(da)},this.ma,3)};tc.la=function(n){n.ea.La(220,new tc(n))};Object(hd.a)(tc,"FormulaAssistanceReadoutHandlerFactory",Sc.a,[]);var ik=b(676),
U=b(113),Ba=b(1115);Oc.prototype.Had=function(n){return this.zOa&&n in this.zOa?this.zOa[n]:null};Oc.prototype.qWf=function(n,O){this.zOa||(this.zOa={});this.zOa[n]=O};Oc.prototype.gZ=function(){this.zOa=null};Object(hd.a)(Oc,"FormulaAssistanceContextualPreviewCache",null,[]);kc.prototype.dispose=function(){this.Ld||(this.$&&(this.$.fa.VC(Object(Kc.a)(this,this.MA,"onStateIdChanged")),this.$=null),this.zga=this.uCb=null,this.Ld=!0)};kc.prototype.H8c=function(n,O,da,l){var K=this;if(O&&0>=O.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!n)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.ea.Ea(266,void 0);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var ka="="+O.substring(da.start,da.end);fd.EwaSettings.ka(634)&&(ka=this.calcManager.CIh(te.g(this.$).ga.ya.activeCell,n,da));var $a=this.Cwh(ka,da);if(fd.EwaSettings.ka(634)){if($a&&!this.calcManager.isFormulaSubExpressionVolatile(n))return Promise.resolve($a)}else if($a)return Promise.resolve($a);
return this.Ewh(ka,da).then(function(Lb){if(K.nVc(l))throw Error.create("OperationCanceledException");if(!Lb||Lb.RZi||Lb.Gla.startsWith("##UNSUPPORTED:"))return K.fPe(O,ka,da,l);K.zga.qWf(ka,Lb.Gla);return Promise.resolve(Lb)})};kc.prototype.Cwh=function(n,O){return(n=this.zga.Had(n))?new Ba.a(n,O.start,O.end,0):null};kc.prototype.Ewh=function(n,O){if(!n||0>=n.length||!O)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.xGg(te.g(this.$).ga.ya.activeCell,
n,this.ygi,O)};kc.prototype.fPe=function(n,O,da,l){var K=this;if(!n||0>=n.length||!O||0>=O.length||!da)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.UMa)return this.Dwh(n,O,da,l);var ka={};ka.PartialFormula=O;ka.Formula=n;ka.SourceRange=jg.v(te.g(this.$).ga.ya.activeCell,this.$);return this.UMa=new Promise(function($a,Lb){K.uCb=new ik.a;K.RHf=K.$.fa.zf;K.E7a=td(K.$.ra.xa,ka,function(bc){K.xBi(O,da,l,bc,$a,Lb)},
function(bc){K.UMa=null;K.E7a=null;Lb(bc)},null,null,null);K.uCb.token.R(function(){K.aIg(Lb)})})};kc.prototype.xBi=function(n,O,da,l,K,ka){this.E7a=this.UMa=null;if(this.RHf!==this.$.fa.zf)ka(Error.create("OperationCanceledException"));else if(l.Result)if(l=sf.a.gi(l.Result),!l||U.a.isEmpty(l))K(null);else{for(var $a in l)this.zga.qWf($a,l[$a]);this.nVc(da)?ka(Error.create("OperationCanceledException")):(n=this.zga.Had(n))?(""===n&&(n=" "),K(new Ba.a(n,O.start,O.end,0))):ka(Error.create("SubexpressionNotFoundException"))}else K(null)};
kc.prototype.Dwh=function(n,O,da,l){var K=this;return new Promise(function(ka,$a){K.UMa.then(function(){K.CIf(n,O,da,l,ka,$a)}).catch(function(){K.CIf(n,O,da,l,ka,$a)})})};kc.prototype.CIf=function(n,O,da,l,K,ka){if(this.nVc(l))ka(Error.create("OperationCanceledException"));else{var $a=this.zga.Had(O);$a?K(new Ba.a($a,da.start,da.end,0)):this.fPe(n,O,da,l).then(function(Lb){K(Lb)}).catch(function(Lb){ka(Lb)})}};kc.prototype.aIg=function(n){this.E7a&&(Ph.a.gv(this.E7a.ou)?(this.UMa=this.E7a=null,n(Error.create("PendingWebReqeuestCancelled"))):
Rc.ULS.sendTraceTag(50434914,0,10,"Failed to cancel the pending web request!"))};kc.prototype.gZ=function(){this.bIg();this.zga&&this.zga.gZ()};kc.prototype.bIg=function(){this.uCb&&this.uCb.C()};kc.prototype.nVc=function(n){return this.Ld||n.EJ};kc.prototype.MA=function(){this.zga.gZ()};Object(hd.a)(kc,"FormulaAssistanceContextualPreviewCalculator",null,[7]);var jb=b(139),Wb=b(204);vb.xbh="ewa-facp-text-box";Object(hd.a)(vb,"CssClassNames",null,[]);Ab.prototype.dispose=function(){(this.G9||this.eP)&&
this.TZe();this.qb=this.Toa=null};Ab.prototype.fwj=function(n,O,da,l){n&&O&&l&&O.Gla&&!(1>O.Gla.length)&&(this.qb=n,this.yEf(),this.x_a=O,this.EQa=l,this.ufj(O,da,l))};Ab.prototype.TZe=function(){this.TQh();this.yEf();this.EQa=this.x_a=null};Ab.prototype.ufj=function(n,O,da){var l=this;if(n.Gla&&!(1>n.Gla.length)){var K=this.Qc.ea.Ea(266,void 0);if(K){var ka=K.rCh();ka&&fe.TaskExtensions.Da(this.myb,function(){if(O)if(fd.EwaSettings.ka(634)&&l.qb.isEditing&&0<da.length){l.lub(n.$Ha,da[0].start,null);
var $a=l.YUe(da[0],ka),Lb=l.qb.text.substring(da[0].start,da[0].end).trim();Lb=l.qb.text.indexOf(Lb);Lb=l.qb.text.substring(0,Lb).lastIndexOf("\n");l.lub(0>Lb||1>=da.length?da[0].start:Lb+1,da[0].end,$a?String.format($a,.3):null);for(var bc=1;bc<da.length;bc++)$a=l.YUe(da[bc],ka),Lb=l.qb.text.substring(da[bc].start,da[bc].end).trim(),Lb=l.qb.text.indexOf(Lb),Lb=l.qb.text.substring(da[bc-1].end,Lb).lastIndexOf("\n"),l.lub(0>Lb?da[bc-1].end:Lb+1+da[bc-1].end,da[bc].end,$a?String.format($a,.3):null);
Lb=l.qb.text.substring(da[da.length-1].end,n.uta).indexOf("\n");l.lub(0>Lb?da[da.length-1].end:Lb+1+da[da.length-1].end,n.uta,null);Rc.ULS.sendTraceTag(587559245,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else l.lub(n.$Ha,n.uta,null),Rc.ULS.sendTraceTag(587559244,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");
l.G9||(l.G9=document.createElement(Wb.a.div),l.qb.textBox.domElement.appendChild(l.G9));l.eP||(l.eP=document.createElement(Wb.a.div),l.eP.className=vb.xbh,l.Qc.domElement.appendChild(l.eP));$a=n.uta;fd.EwaSettings.ka(634)&&l.qb.isEditing&&da&&0<da.length&&da[0].start<$a&&da[0].start!==n.$Ha&&!l.qb.textBox.Xu.length&&($a=da[0].start);bc=mf.a.contains(l.qb.textBox.lf.id,"FormulaBar",!0)&&mf.a.contains(l.qb.text.substring(n.$Ha,n.uta),"\n",!0);Lb=l.qb.isEditing?l.qb.textBox.caretPosition:0;$a=excelOnline.utils.getBoundingRectForText(l.qb.textBox.lf,
bc?Lb:n.$Ha,bc?Lb:$a,fd.EwaSettings.ka(634));l.eP.style.left=Z.HelperMethods.Ub($a.left);l.eP.style.top=Z.HelperMethods.Ub($a.top);l.eP.style.width=Z.HelperMethods.Ub($a.width);l.eP.style.height=Z.HelperMethods.Ub($a.height);$a=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",n.uta,n.uta);dialogControls.renderToolTip(l.G9,$a,n.Gla,l.eP,0,!1,!1,1)},this.Qc.ma,3)}}};Ab.prototype.YUe=function(n,O){var da=this.qb.text,l=da.substring(n.start,n.end);l=l.trim();n=da.indexOf(l,n.start);O=da.indexOf(O,
n);l=da.substring(n,O);l=l.trim();return this.qb.colors.getItem(n+"-"+(n+l.length))};Ab.prototype.TQh=function(){var n=this;this.qb&&this.G9&&this.eP&&fe.TaskExtensions.Da(this.myb,function(){n.qb.textBox.domElement.contains(n.G9)&&(dialogControls.clearToolTip(n.G9),n.qb.textBox.domElement.removeChild(n.G9),n.G9=null);n.Qc.domElement.contains(n.eP)&&(n.Qc.domElement.removeChild(n.eP),n.eP=null)},this.Qc.ma,3)};Ab.prototype.lub=function(n,O,da){if(this.qb&&!(n>=O)){var l={};this.qb.textBox.formatText(n,
O-n,(l.background=da||"#E3DDCC",l));this.Bcd=!0}};Ab.prototype.yEf=function(){if(this.qb&&this.x_a&&this.Bcd){var n=this.x_a.uta;fd.EwaSettings.ka(634)&&0<this.EQa.length&&this.EQa[this.EQa.length-1].end>n&&(n=this.EQa[this.EQa.length-1].end);var O={};this.qb.textBox.formatText(this.x_a.$Ha,n-this.x_a.$Ha,(O.background=!1,O));this.Bcd=!1}};Jl.Object.defineProperties(Ab.prototype,{myb:{configurable:!0,enumerable:!0,get:function(){var n=this;if(this.Toa)return this.Toa;var O=new jb.a;this.Qc.HG(function(da){fe.TaskExtensions.Da(da.Umd(),
function(){O.setResult(!0)},n.Qc.ma,3)});return this.Toa=O.task}}});Object(hd.a)(Ab,"FormulaAssistanceContextualPreviewControl",null,[7]);var Ec=b(44),Xc=b(42);zc.prototype.YSf=function(n,O,da){da?this.qTg(n,O,da):this.kXe(n,O,da,!0)};zc.prototype.HYi=function(){this.Q6=0};zc.prototype.qTg=function(n,O,da){var l=this;this.Q6++;var K=this.Q6;Ec.a.instance.create(function(){l.kXe(n,O,da,K===l.Q6)},500,Xc.a.bph,!0,!0)};zc.prototype.kXe=function(n,O,da,l){var K=this,ka=this.U6c.H8c(n,O);ka&&ka.then(function($a){l&&
K.U6c.Thd(O)&&K.U6c.ewj(n,$a,da)}).catch(function($a){$a=Object(pf.a)(Error,$a);"OperationCanceledException"===$a.message?Rc.ULS.sendTraceTag(50595487,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",$a):Rc.ULS.sendTraceTag(50595488,0,10,"GetContextualFormulaPreviewResults - caught exception: {0}",$a)})};Object(hd.a)(zc,"FormulaAssistanceContextualPreviewHoverManager",null,[]);ec.prototype.dispose=function(){this.kUc();Ff.a.rc([this.mrb,this.g6b]);this.h6b=this.g6b=this.mrb=null;
this.$&&te.g(this.$).Hc.Qs(Object(Kc.a)(this,this.Twa,"onEditCellEnded"));this.xga=this.qb=this.$=null};ec.prototype.vfj=function(n,O){O&&ej.e(O.text)&&!O.eva&&mf.a.na(O.textBox.Xu)&&(!this.qb||mf.a.na(this.qb.textBox.Xu))&&(this.qb=O,this.calcManager=this.$.ea.Ea(266,void 0))&&(Rc.ULS.sendTraceTag(587559243,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),n=Z.HelperMethods.Xrb(n),n=this.calcManager.zIh(te.g(this.$).ga.ya.activeCell,
this.qb.text,n.x,n.y),O=this.calcManager.getSubExpressionSpan(n),!O||O.end<=O.start||this.Thd(O)||(this.xga=O,this.h6b.YSf(n,O,!0)))};ec.prototype.jKd=function(n){if(n&&ej.e(n.text))if(mf.a.na(n.textBox.Xu)||mf.a.na(n.textBox.Xu.trim()))this.r2a(!1,!0);else if(this.qb=n,this.calcManager=this.$.ea.Ea(266,void 0)){Rc.ULS.sendTraceTag(587559242,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");n={};var O=this.qb.textBox.Xu.trim();
n.start=this.qb.text.indexOf(O,this.qb.textBox.caretPosition);n.end=n.start+O.length;(O=this.calcManager.getFormulaSubExpressionObject(te.g(this.$).ga.ya.activeCell,this.qb.text,this.qb.textBox.Xu))&&!this.Thd(n)&&(this.xga=n,this.h6b.YSf(O,n,!1))}};ec.prototype.r2a=function(n,O){!this.qb||O&&!mf.a.na(this.qb.textBox.Xu)||(this.xga=null,n&&(this.kUc(),this.g6b.gZ(),this.h6b.HYi()),this.mrb&&this.mrb.TZe(),this.qb.eva||(this.qb.eva=!1,this.qb=null))};ec.prototype.H8c=function(n,O){if(!this.qb||this.qb.eva)return null;
this.kUc();this.Cob=new ik.a;return this.g6b.H8c(n,this.qb.text,O,this.Cob.token)};ec.prototype.ewj=function(n,O,da){this.Cob=null;!n||!O||!O.Gla||0>=O.Gla.length?this.r2a(!1,!1):(n=this.calcManager.AIh(te.g(this.$).ga.ya.activeCell,n,this.qb.text),this.mrb.fwj(this.qb,O,da,n))};ec.prototype.Thd=function(n){return this.xga?n.start===this.xga.start&&n.end===this.xga.end&&n.pre===this.xga.pre&&n.post===this.xga.post:!1};ec.prototype.kUc=function(){this.Cob&&this.Cob.C()};ec.prototype.Twa=function(){this.r2a(!1,
!1)};Object(hd.a)(ec,"FormulaAssistanceContextualPreviewManager",null,[418,7,419]);var Ac=b(1170),yc=b(913),dd=b(241),Qd=b(154);Za.prototype.tOf=function(n){this.hS=0;this.G0d=n.IsCompatibility;this.set_name(n.NameDataStrings);this.FTa=n.Help};Za.prototype.l7i=function(n){this.hS=1;this.set_name(n.Name)};Za.prototype.L6i=function(n){this.hS=2;this.set_name(n.name);this.FTa=n.toolTip};Za.prototype.i8i=function(n){this.hS=3;this.set_name(n.name);this.FTa=n.toolTip};Za.prototype.PPf=function(n){this.hS=
4;this.set_name(n.name)};Za.prototype.x$i=function(n){this.hS=5;this.set_name(n.name);this.FTa=n.toolTip};Za.prototype.w$i=function(n){this.hS=7;this.set_name(n.name)};Za.prototype.W8i=function(){this.hS=6;this.set_name(Sd.a.instance.Eb(181));this.FTa=Sd.a.instance.Eb(182)};Za.prototype.set_name=function(n){return this.Z1d=n};Za.OXg=function(){return Object.assign(new Za,{H1d:!0})};Jl.Object.defineProperties(Za.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.hS}},Y_h:{configurable:!0,
enumerable:!0,get:function(){return this.G0d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.Z1d}},Xha:{configurable:!0,enumerable:!0,get:function(){return this.FTa}},Mwb:{configurable:!0,enumerable:!0,get:function(){return this.H1d}}});Object(hd.a)(Za,"AutoCompleteItem",null,[414]);Jl.Object.defineProperties(fb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,
enumerable:!0,get:function(){return this.yS}},usedRange:{configurable:!0,enumerable:!0,get:function(){return this.FDa}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.rDa}}});Object(hd.a)(fb,"DefinedNameInfo",null,[]);E.prototype.Asj=function(n){return(n=this.gye[n.toUpperCase()])?{returnValue:!0,sheetName:n.sheetName,range:n.usedRange}:{returnValue:!1,sheetName:"",range:null}};Jl.Object.defineProperties(E.prototype,{x0g:{configurable:!0,enumerable:!0,get:function(){var n=[];
if(!this.$.Ab||!this.$.Ab.items)return n;for(var O=0,da=Ml(this.$.Ab.items),l=da.next();!l.done;l=da.next())if((l=l.value)&&3===l.type&&l.usedRange){var K=new fb;K.yS=l.sheetName+$g.a.exclamation+l.usedRange.toString();K._name=l.name;K.FDa=l.usedRange;K.rDa=l.sheetName;Array.add(n,K);this.gye[l.name.toUpperCase()]=K;++O;if(O===Ub.nff){Rc.ULS.sendTraceTag(25290050,0,15,"Maximum number of defined names reached for formula assistance: {0}",Ub.nff);break}}return n}}});Object(hd.a)(E,"DefinedNameInfoManager",
null,[]);var Cd=b(135),se=Sys.EventArgs;Cm(ia,se);Object(hd.a)(ia,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var $e=Sys.EventArgs;Cm(Kb,$e);Object(hd.a)(Kb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Af=Sys.EventArgs;Cm(Ua,Af);Object(hd.a)(Ua,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var yf=b(254);va.prototype.Ye=function(n,O){n=!1;O||(te.g(this.$).Ej.textBox.BJ=!0,n=this.formulaAssistanceUIControl.focus(this.eMe));return n};
va.prototype.Lh=function(n){var O=this.Nb;return!(void 0===O||null===O)&&je.DOMElementExtensions.jf(O,n)};va.prototype.vi=function(){this.EXe&&this.EXe()};va.prototype.ei=function(){};va.prototype.dispose=function(){yf.a(this.$).UA(this)};Jl.Object.defineProperties(va.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.VTc},set:function(n){this.VTc!==n&&(n?yf.a(this.$).$g(this):yf.a(this.$).UA(this),this.VTc=n)}},he:{configurable:!0,enumerable:!0,get:function(){return this.W2i}},
Nb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.eMe)}}});Object(hd.a)(va,"FormulaAssistanceFocusManager",null,[135,7]);var Gg=b(1112),rh=Gg.a;Cm(Ia,rh);Ia.prototype.setVisible=function(n){je.DOMElementExtensions.setVisible(this.domElement,n);n||(this.domElement.style.top="auto",this.domElement.style.left="auto")};Ia.prototype.isRtl=function(){return this.fj};Ia.prototype.aTe=function(){return this.domElement.parentNode};Ia.prototype.BPa=
function(n){var O=this.domElement.style;O.cursor="move";O.position=n?"relative":"absolute"};Object(hd.a)(Ia,"FunctionParamBoxDraggableItem",Gg.a,[]);Object(hd.a)(za,"FormulaArgumentAssistanceCallbacks",null,[]);Object(hd.a)(qb,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(hd.a)(Ta,"ArgumentAssistanceRequest",null,[]);var hi=Te.a;Cm(db,hi);db.prototype.Zee=function(n){this.addHandler("FAFunctionNameUpdated",n)};db.prototype.tFf=function(n){this.removeHandler("FAFunctionNameUpdated",n)};
db.prototype.Qfe=function(n){this.addHandler("FAParameterSelectionChangedOld",n)};db.prototype.UFf=function(n){this.removeHandler("FAParameterSelectionChangedOld",n)};db.prototype.Pfe=function(n){this.addHandler("FAParameterSelectionChanged",n)};db.prototype.TFf=function(n){this.removeHandler("FAParameterSelectionChanged",n)};db.prototype.set_visible=function(n){this.hl?n||this.kpb():Sys.UI.Control.prototype.set_visible.call(this,n);return n};db.prototype.kpb=function(){this.formulaAssistanceUIControl&&
(this.Ur=null,this.formulaAssistanceUIControl.dismiss(this.domElement),this.mvb&&(this.Tja=null),this.tE&&(this.Oq.canReceiveFocus=!1))};db.prototype.show=function(n){this.hl||(Gc.instance.mF("argumentAssistanceRender"),this.$Za.setVisible(!!n),Gc.instance.hA("argumentAssistanceRender"),this.bRc&&(this.bRc=!1,this.CCe()))};db.prototype.ZXi=function(){var n=this;if(!this.naa||this.QPa){var O=function(da){Gc.instance.mF("argumentAssistanceComputation");Gc.instance.mF("argumentAssistanceOverall");var l=
te.g(n.$).Ej;da.requester().argumentAssistance(Object.assign(new Ta,{content:l.text,caretPosition:l.textBox.caretPosition})).then(function(K){K.kind?Gc.instance.hA("argumentAssistanceComputation",!1):K.payload?(Gc.instance.hA("argumentAssistanceComputation"),n.$ej(n.hxd(K.payload),l.textBox.domElement)):n.kpb();return null})};this.rwb?O(this.pluginScheduler):fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,413,414,1,"Microsoft.Office.Excel.WebUI.Client.IPluginScheduler"),function(da){O(da.result)},
this.$.ma,3)}};db.prototype.update=function(n,O,da,l){if(!this.hl&&n){Gc.instance.mF("argumentAssistanceComputation");Gc.instance.mF("argumentAssistanceOverall");this.bRc=!0;var K=this.$.listSeparator;try{var ka=$get(Ub.q7c,this.Pi),$a=$get(Ub.k7c,this.Pi);ka.innerText="";$a.innerText="";var Lb=$get(Ub.AMe,this.Pi),bc=n.Params.split(Ub.z4c);ka=[];$a=0;for(var Dc=Lb.rows.length;$a<Dc;$a++){var wd=Lb.rows[$a];je.DOMElementExtensions.setVisible(wd,$a<bc.length);var ke=bc[$a],jf=Ub.GDi+$a+"_",Xf=n.NameDataStrings;
$get(jf+Ub.iCb,wd).innerText=Xf;$get(jf+Ub.Evd,wd).innerText=Xf;if(!mf.a.na(ke)){var Sf=bc[$a].split(K),xg=db.ghd(Sf[Sf.length-1]),xi=db.X3h(n);xg&&(xi&&(2<Sf.length?(Sf[Sf.length-2]+="1",Sf[Sf.length-3]+="1"):Rc.ULS.sendTraceTag(539551E3,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Xf,Sf.length.toString(),O)),db.sxg(Sf,xi,O,n));ke=Sf.join(K.toString()+" ");bc[$a]=ke;da<Sf.length?(ka[$a]=Sf[da],Rc.ULS.shipAssertTag(539550999,
0,!!Sf[da]&&1<=Sf[da].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",da,Sf.length,Xf,$a),Sf[da]=String.format("{0}{1}{2}","<b>",Sf[da],"</b>"),ke=Sf.join(K.toString()+" ")):Rc.ULS.shipAssertTag(539550998,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+da+"currRowParamsArray.Length = "+Sf.length+", current row = "+$a);l&&Rc.ULS.sendTraceTag(558474578,
0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Xf,Sf.length,xg,xi,O)}$get(jf+Ub.Fvd,wd).innerHTML="("+(ke||"")+")"}l?this.raiseEvent("FAFunctionNameUpdated",new ia(n.NameDataStrings,bc)):this.raiseEvent("FAParameterSelectionChangedOld",new Ua(bc,ka,da));Lb.className=yc.a.fch+(this.functionInfoManager.Ihd(n)?"-udf":"")}catch(Oi){throw Rc.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
n.NameDataStrings,O,Oi),Oi;}Gc.instance.hA("argumentAssistanceComputation")}};db.prototype.dispose=function(){this.hl||(this.tc.ZB(),Ff.a.Ia(this.tc),te.g(this.$).view.Tr(Object(Kc.a)(this,this.qq,"onGridScroll")),Ff.a.Ia(this.$Za),this.$Za=null);this.hl&&this.tE&&Ff.a.Ia(this.Oq);this.naa&&te.g(this.$).zc.Qs(Object(Kc.a)(this,this.Zk,"onEditEnded"));this.functionInfoManager=this.$=null;hi.prototype.dispose.call(this)};db.prototype.hxd=function(n){var O=new qb;O.functionRenderingInfo=n;O.cardMode=
this.US;this.PAd(O);return O};db.prototype.PAd=function(n){n.callbacks=new za;n.callbacks.onHelpLink=this.O9c(n.functionRenderingInfo);n.callbacks.onCardModeChange=Object(Kc.a)(this,this.onCardModeChange,"onCardModeChange");n.callbacks.onFeedback=Object(Kc.a)(this,this.aPa,"sendCardFeedback");this.naa&&(n.callbacks.onDismissClick=Object(Kc.a)(this,this.onDismissClick,"onDismissClick"))};db.prototype.$ej=function(n,O){var da=this;if(this.formulaAssistanceUIControl){Gc.instance.mF("argumentAssistanceRender");
if(this.y3a){var l={};l.zoomLevel=Tb(this.$);this.formulaAssistanceUIControl.updateContext(l)}else this.formulaAssistanceUIControl.setZoomLevel(Tb(this.$));this.Ur=function(){da.formulaAssistanceUIControl.renderArgumentAssistanceCard(da.domElement,O,n)};this.Ur();this.gwd(n);this.tE&&(this.Oq.canReceiveFocus=!0);Gc.instance.hA("argumentAssistanceRender");this.CCe()}};db.prototype.O9c=function(n){var O=this;return function(){Bb(O.$,n.helpID,n.isUDF)}};db.prototype.onCardModeChange=function(n){this.nKb(n);
1===n?Gc.instance.Wha.argumentAssistanceCollapseCounter++:Gc.instance.Wha.argumentAssistanceExpandCounter++};db.prototype.aPa=function(n){var O={};O[ub.a.Fha]="ArgumentAssistanceCard";var da={};da.FunctionName=n.functionName;O[ub.a.e5c]=da;this.$.Re(802602464,0,8,O)};db.prototype.onDismissClick=function(){Gc.instance.Wha.argumentAssistanceDismissCounter++;this.QPa=!1;this.kpb();fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!this.US&&
this.nKb(1)};db.prototype.Zk=function(){this.QPa=!0};db.prototype.qHd=function(){var n=Cd.a.get(ub.a.QWb);mf.a.na(n)?this.US=db.j0c:this.US=parseInt(n);Gc.instance.dNf(this.US)};db.prototype.dsi=function(n){!n.button&&n.target&&(Sh.g(n),this.$Za&&this.$Za.Dma(n))};db.prototype.qq=function(){void 0!==this.Ur&&null!==this.Ur&&this.Ur()};db.prototype.gwd=function(n){var O=this;if(this.mvb){var da=n.functionRenderingInfo.functionName;mf.a.na(this.Tja)||!mf.a.equals(this.Tja,da,!0)?(this.Tja=da,n=Gh.a.map(n.functionRenderingInfo.signatures,
function(l){return l.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ia(da,n))):(da=Gh.a.map(n.functionRenderingInfo.signatures,function(l){var K="";if(!O.f4a||0<=l.signatureParams.activeParam&&l.signatureParams.activeParam<l.signatureParams.params.length)K=l.signatureParams.params[l.signatureParams.activeParam];return K}),this.raiseEvent("FAParameterSelectionChanged",new Kb(da)))}};db.prototype.CCe=function(){window.requestAnimationFrame(function(){Gc.instance.hA("argumentAssistanceOverall")})};
db.prototype.nKb=function(n){this.US=n;try{Cd.a.tw(ub.a.QWb,n.toString(),Ah.AFrame.pda)}catch(O){Rc.ULS.sendTraceTag(538048030,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",O.message)}};db.ghd=function(n){return mf.a.contains(n,Ub.t3b,!0)};db.X3h=function(n){return!!n&&mf.a.j_a(n.NameDataStrings,"IFS")};db.sxg=function(n,O,da,l){try{if(!n||2>n.length)Rc.ULS.shipAssertTag(539550997,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
l.NameDataStrings,n?n.length.toString():"currRowParamsArray == null",O,da);else{for(var K=n.pop().toString(),ka=n.length-1;ka<da;ka++){var $a=n[ka].trim();if(O){var Lb=n[ka-1].trim();n.push(db.Jrh(Lb,$a))}else{var bc=db.J0e($a);n.push(db.eNe(bc))}}n.push(K)}}catch(Dc){throw Rc.ULS.shipAssertTag(539550996,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",l.NameDataStrings,n?n.length.toString():"currRowParamsArray == null",
O,da,Dc),Dc;}};db.Jrh=function(n,O){n=db.J0e(n);var da=db.$Se(n);O=db.$Se(O);return db.eNe(n,!0,!!da&&!!O&&da!==O)};db.J0e=function(n){var O=n.match(db.Ord);n=mf.a.trimEnd(mf.a.trimStart(n,Ub.Puf),Ub.Ouf);if(O&&O.length){O=O[O.length-1];var da=Number.parseLocale(O)+1;n=n.replace(O,da.toString())}else n=String.format("{0}{1}",n,1);return n};db.eNe=function(n,O,da){var l="[{0}]";(void 0===O?0:O)&&(l=(void 0===da?0:da)?"[{0}":"{0}]");return String.format(l,n)};db.$Se=function(n){return(n=n.match(db.Ord))&&
n.length?n[0]:null};db.hIa=function(n){if(n)return document.createElement("div");n=String.format(Ub.yvf,Ub.wvf,Ub.Evd,yc.a.QEe,Ub.iCb,yc.a.PEe,Ub.Fvd);var O=String.format(Ub.yvf,Ub.xvf,Ub.Evd,yc.a.QEe,Ub.iCb,yc.a.PEe,Ub.Fvd);n=String.format(Ub.dqh,Ub.eqh,yc.a.HFe,yc.a.j$g,Df.a.zu,Ub.AMe,n,O);O=document.createElement("div");O.innerHTML=n;return O.firstChild};db.Ord=RegExp("\\d+");db.j0c=0;Object(hd.a)(db,"FormulaArgumentAssistanceControlDeprecated",Te.a,[413]);Object(hd.a)(ta,"ParseContext",null,[]);
var fi=b(311),di=yj.a;Cm(ua,di);ua.prototype.Xh=function(n,O){this.formulaAssistanceControl.qb=this.qb;-1470715894!==O&&-1231471547!==O||this.c3a&&!this.dze()||(this.QU=!1);return di.prototype.Xh.call(this,n,O)};ua.prototype.nsd=function(){var n=this.Fub;if(n||this.MJd){this.formulaAssistanceControl.qb=this.qb;if(this.c3a&&(Gc.instance.Llb.formulaAssistanceRequestAttemptedCounter++,!this.dze())){Gc.instance.Llb.formulaAssistanceRequestOptimizedCounter++;return}if(!n&&this.MJd)this.formulaAssistanceControl.Ije();
else if(fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.aTh){if(n=this.$.Zb.Ic("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Kje(),n.stop(),this.aXa.text.endsWith("[")&&"["!==this.aXa.text.charAt(this.aXa.text.length-2)){var O=""===this.nGa?this.formulaAssistanceControl.tableManager.Nj:Object(pf.a)(fi.a,this.$.Ab.getItemByName(this.nGa));Rc.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
O.qj,n.Gc,this.ued,this.QU)}}else this.formulaAssistanceControl.xlb(),this.tuf&&(this.tuf=this.QU=!1)}else this.QU=!1};ua.prototype.tk=function(){this.cSi||(this.UPa=null,this.MJd&&this.formulaAssistanceControl.D3())};ua.prototype.Zk=function(){this.QU=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.$nc();this.hl&&this.xci()};ua.prototype.xyd=function(n,O){return this.formulaAssistanceControl.Xh(n,O)};ua.prototype.xci=function(){this.formulaAssistanceControl.zab&&(Gc.instance.k6b.smartSuggestionShownCounter++,
this.formulaAssistanceControl.zab=!1);this.formulaAssistanceControl.tIb&&(Gc.instance.k6b.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.tIb=!1);this.formulaAssistanceControl.sIb&&(Gc.instance.k6b.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.sIb=!1)};ua.prototype.wIg=function(n,O){for(var da=0,l;-1!==da;)if(da=n.indexOf("[",da+1),-1!==da&&da<O&&(l=n.indexOf("]",da+1),-1===l||l>=O))return da;return-1};ua.prototype.dze=function(){var n=this.qb.text,O=this.qb.textBox.caretPosition,
da=this.formulaAssistanceControl.qLa,l=this.formulaAssistanceControl.pLa;if(this.QU&&mf.a.equals(n,da,!0)&&O===l)return!1;this.formulaAssistanceControl.qLa=n;this.formulaAssistanceControl.pLa=O;return!0};Jl.Object.defineProperties(ua.prototype,{Cvb:{configurable:!0,enumerable:!0,get:function(){return Object(rf.a)(cb,this.$.Db.oh)}},QU:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(n){this.formulaAssistanceControl.isListVisible=n}},Fub:{configurable:!0,
enumerable:!0,get:function(){var n=this.aXa.text;n=0<n.length?n.charCodeAt(0):-1;return 61===n||43===n||45===n||64===n}},aTh:{configurable:!0,enumerable:!0,get:function(){var n=this.aXa.text,O=!1;if(0>=n.length)return O;var da=this.$.Zb.Ic("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),l=te.g(this.$).ga.ya.activeCell.clone(),K=n.charCodeAt(0);this.nGa="";this.nP=this.wIg(n,this.aXa.caretPosition);K=61===K&&-1!==this.nP;if(!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))K&&
(O=!0);else if(K){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){K=0;for(var ka=this.nP-1;1<=ka&&!(this.nP-ka>ua.jff);ka--)if(Array.contains(ua.Ele,n.charAt(ka))){K=ka;break}K=n.substring(K+1,this.nP);n=""!==K?this.$.Ab.getItemByName(K):null;ka=this.nP;for(var $a=this.nP+1;$a<=this.qb.textBox.caretPosition;$a++)if("["===this.qb.text.charAt($a))ka=$a;else break;this.nP=ka}else{K=n.lastIndexOf("[");ka=0;for($a=K-1;1<=$a&&!(K-$a>ua.jff);$a--)if(Array.contains(ua.Ele,
n.charAt($a))){ka=$a;break}K=n.substring(ka+1,K);n=""!==K?this.$.Ab.getItemByName(K):null}n&&2===n.type?(O=!0,this.nGa=K):te.g(this.$).kc.Rk(l)&&(O=!0,this.nGa="")}da.stop();this.ued=da.Gc;Rc.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.ued);return O}},key:{configurable:!0,enumerable:!0,get:function(){return Pj.a.xta}},calcManager:{configurable:!0,enumerable:!0,
get:function(){this.dAc||(this.dAc=this.$.ea.Ea(266,!1));return this.dAc}},MJd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.UPa)return this.UPa;if(!fd.EwaSettings.ka(138))return this.UPa=!1;var n=te.g(this.$).ga.ya.activeCell.clone();if(1!==n.Sef||!n.left||te.g(this.$).ga.ya.qcc())return!1;var O=this.formulaAssistanceControl.tableManager.fo(n);if(O)return this.UPa=!1;--n.left;--n.right;if(!n.isValidRange)return!1;O=this.formulaAssistanceControl.tableManager.fo(n);return this.UPa=!!O&&
n.top===O.top&&this.formulaAssistanceControl.tableManager.pRg(O,te.g(this.$))}}});ua.Ele=" !%&'()*+,-/:;<=>@[]^{|}~".split("");ua.jff=255;Object(hd.a)(ua,"FormulaAutoCompleteListAutoCompleteBehavior",yj.a,[]);var Rh;(function(n){n[n.function=0]="function";n[n.field=1]="field";n[n.definedName=2]="definedName";n[n.letVariable=3]="letVariable";n[n.tableColHeaderName=4]="tableColHeaderName";n[n.tableSpecialStructRef=5]="tableSpecialStructRef";n[n.pendingData=6]="pendingData";n[n.tableNamedObject=7]="tableNamedObject"})(Rh||
(Rh={}));Object(hd.b)("ItemType",Rh);var Fh=b(1171),ph=b(1172);Ra.prototype.execute=function(n){Array.add(n,this.index)};Object(hd.a)(Ra,"AppendIndexOperation",null,[437]);ca.prototype.execute=function(){};Object(hd.a)(ca,"NopIndexOperation",null,[437]);Ha.prototype.execute=function(n){for(var O=0;O<n.length;O++)n[O]===this.pIi&&(n[O]=this.mhf)};Object(hd.a)(Ha,"ReplaceIndexOperation",null,[437]);Gb.prototype.Ive=function(n,O){var da=new Ra(O);if(!fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled",
!1))return da;n=this.p8h(n,O);return null!=n?this.items[n].Mwb?new Ha(n,O):new ca:da};Gb.prototype.p8h=function(n,O){var da=this,l=this.items[O];Rc.ULS.shipAssertTag(574174406,0,!!l,"Internal error: invalid item index");n=Vf.where(Vf.asEnumerable(n),function(K){return da.items[K].name===l.name});return Vf.Ct(n)?Vf.first(n):null};Object(hd.a)(Gb,"FilterItemOperationFactory",null,[]);Object(hd.a)(nb,"CompletionItem",null,[]);var bi=Fh.a;Cm(sb,bi);sb.prototype.Rfe=function(n){this.addHandler("FLBSelectedRowChanged",
n)};sb.prototype.VFf=function(n){this.removeHandler("FLBSelectedRowChanged",n)};sb.prototype.uPc=function(n){this.addHandler("ACLBUpdated",n)};sb.prototype.fCd=function(n){this.removeHandler("ACLBUpdated",n)};sb.prototype.dispose=function(){bi.prototype.dispose.call(this);this.kfa=this.BMe=this.trb=null};sb.prototype.Mtc=function(n,O,da,l){l=void 0===l?0:l;this.K6(!1);var K=new Sys.StringBuilder;mf.a.na(da)||K.append(String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>",
"list_column_header",yc.a.ZMg,da));K.append(String.format("<table class='{0}' aria-live='off'><tbody>",this.Yaa));for(var ka=new Aa.a,$a=0,Lb=this.GV.length;$a<Lb;$a++)K.append(this.dVe(n[this.GV[$a]],$a+1,O,l)),this.hl&&ka.add(this.bPe(n[this.GV[$a]]));$a=this.GV.length;Lb=0;for(var bc=this.Fr.length;Lb<bc;Lb++)Array.contains(this.GV,this.Fr[Lb])||($a++,K.append(this.dVe(n[this.Fr[Lb]],$a,O,l)),this.hl&&ka.add(this.bPe(n[this.Fr[Lb]])));K.append("</tbody></table>");this.og.innerHTML=K.toString();
this.nn=je.DOMElementExtensions.uj(this.domElement,this.Yaa);this.hl&&(this.pXc=ka.toArray());this.K6(!0);this.Cvg(!mf.a.na(da))};sb.prototype.IHa=function(n,O,da,l,K,ka){l=void 0===l?"":l;K=void 0===K?0:K;ka=void 0===ka?!1:ka;if(n){var $a=[],Lb=[];this.nQa=0;var bc=new Gb(this.$,n);if(mf.a.na(O))for(da=0;da<n.length;++da){if(n[da].Mwb||ka){var Dc=bc.Ive($a,da);Dc.execute($a);Dc.execute(Lb);n[da].Mwb&&this.nQa++}}else{var wd=!!O&&0<K,ke=wd&&91===O.charCodeAt(K+1)?K+2:K+1;ka=wd?O.length===ke:!1;wd&&
O.length===K&&fd.EwaSettings.ka(138)&&(ka=!0);Dc=null;!ka&&wd&&O.length>K+1&&(Dc=O.substring(ke,O.length));if(!mf.a.na(O))for(wd=0,ke=n.length;wd<ke;wd++){var jf=n[wd].name;if(!n[wd].Y_h){var Xf=bc.Ive($a,wd);n[wd].Mwb&&this.nQa++;(Dc||ka)&&n[wd].itemType||(Lb=this.ZJe(O,jf,da,Xf,$a,Lb),$a=Lb.R0e,Lb=Lb.Fxf);Dc&&1===n[wd].itemType&&(Lb=this.ZJe(Dc,jf,!0,Xf,$a,Lb),$a=Lb.R0e,Lb=Lb.Fxf);ka&&1===n[wd].itemType&&Xf.execute($a)}}}this.GV=Lb;this.Fr=$a;this.Mtc(n,O,l,K)}};sb.prototype.txj=function(n){if(n&&
!(1<n.length)){var O=[],da=[];O.push(0);da.push(0);this.GV=O;this.Fr=da;this.Mtc(n,"","",0)}};sb.prototype.uwa=function(){this.lk&&bi.prototype.uwa.call(this)};sb.prototype.CLi=function(n,O){this.raiseEvent("ACLBUpdated",new ph.a(n,void 0,void 0,O))};sb.prototype.nwc=function(n){var O=this.nn.rows[n];return(!this.lk||this.lk!==O)&&n<this.nn.rows.length?(this.lk=O,!0):!1};sb.prototype.b$i=function(){if(this.hl)return this.Mjd||!this.nQa?this.nwc(0):this.odc?(this.kfa=null,!1):this.nwc(this.nQa);this.lk=
this.nn.rows[0];return!1};sb.prototype.OAb=function(n){Sh.g(n.Ga);this.rw&&2!==this.rw&&3!==this.rw&&4!==this.rw&&5!==this.rw&&7!==this.rw?1===this.rw?this.Oqa.pt(!1):(this.Oqa.pt(!1),n=te.g(this.$),n.Zo(!1),n.focus()):(this.raiseEvent(Ai.a.K1a),this.uwa());return!0};sb.prototype.Cvg=function(n){this.sqa();if(n){var O=this.nn.offsetWidth+(this.Fr.length>this.uC?Oe.a.Lp:0);n=$get("list_column_header");n.offsetWidth>O&&je.DOMElementExtensions.vq(this.og,n.offsetWidth);O=this.og.getElementsByClassName(this.EZ);
for(var da=0;da<O.length;da++)O[da].style.width=Z.HelperMethods.Ub(n.offsetWidth)}};sb.prototype.dVe=function(n,O,da,l){if(1===n.itemType){var K=ah.a.gg(n.name),ka=ah.a.gg(l?da.substring(l+1,da.length):da),$a=0;K.substring(0,ka.length).toLowerCase()!==ka.toLowerCase()&&($a=sb.Tkj(K,Ub.e6f,ka));da=new Sys.StringBuilder;0<=$a?(da.append(K.substring(0,$a)),da.append("<b>"),da.append(K.substring($a,$a+ka.length)),da.append("</b>"),da.append(K.substring($a+ka.length,K.length))):da.append(K);l=l?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",
Df.a.mGe,ah.a.BU(Jg.a.Ee(0)),Sd.a.instance.da(684)):"";return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'></td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",l,O,Rh[n.itemType],this.EZ,da.toString())}if(5===n.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
"",O,Rh[n.itemType],this.EZ,ah.a.gg(n.name),ah.a.gg(n.Xha));if(4===n.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>","(...)",O,Rh[n.itemType],this.EZ,ah.a.gg(n.name));if(6===n.itemType)return l=l?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",
Df.a.mGe,ah.a.BU(Jg.a.Ee(0)),Sd.a.instance.da(684)):"",String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",l,this.EZ,ah.a.gg(n.name),ah.a.gg(n.Xha),O,Rh[n.itemType]);l=String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",2===n.itemType||3===n.itemType?Df.a.Seh:Df.a.Qeh,ah.a.BU(Jg.a.Ee(0)),
Sd.a.instance.da(681));return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",l,this.EZ,ah.a.gg(n.name),ah.a.gg(n.Xha),O,Rh[n.itemType])};sb.prototype.bPe=function(n){var O=new nb;O.label=n.label;O.textEdit=n.textEdit;O.kind=sb.nwh(n.itemType);O.type=n.Mwb?1:0;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&
3===O.kind){var da=this.formulaAssistanceControl.pAh(n.label);O.detail=da?da:n.Xha}else O.detail=n.Xha;return O};sb.prototype.ZJe=function(n,O,da,l,K,ka){mf.a.equals(O,"Pretend this is the line.",!1)&&0<K.length||mf.a.UH(O,n)?(l.execute(K),l.execute(ka)):da&&n.length>=Ub.sRg&&sb.f1g(O,Ub.e6f,n)?l.execute(K):!da&&n.length>=Ub.rRg&&mf.a.contains(O,n,!0)&&l.execute(K);return{R0e:K,Fxf:ka}};sb.nwh=function(n){switch(n){case 0:return 3;case 2:return 100;case 1:return 103;case 3:return 102;case 4:return 101;
case 5:return 107;case 7:return 106;default:return 3}};sb.f1g=function(n,O,da){O=Ml(O);for(var l=O.next();!l.done;l=O.next())if(l=n.split(l.value),!(2>l.length)){l=Ml(l);for(var K=l.next();!K.done;K=l.next())if(mf.a.UH(K.value,da))return!0}return!1};sb.Tkj=function(n,O,da){O=Ml(O);for(var l=O.next();!l.done;l=O.next())if(l=n.toLowerCase().indexOf((l.value+da).toLowerCase()),0<l)return l+1;return-1};Jl.Object.defineProperties(sb.prototype,{odc:{configurable:!0,enumerable:!0,get:function(){return 0<
this.nQa&&this.nQa===this.Fr.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Qh.a)(sb.prototype,this,"isListVisible")},set:function(n){Object(Qh.b)(sb.prototype,this,"isListVisible",n);n||(this.xpc=0,this.me=null);this.xpc?je.DOMElementExtensions.setVisible(this.trb,!1):je.DOMElementExtensions.setVisible(this.trb,n&&!this.hl)}},lk:{configurable:!0,enumerable:!0,get:function(){return this.kfa},set:function(n){this.Iza(this.lk);if(n){this.BMe.innerText="";this.kfa=
n;var O=this.Iza(this.lk),da=n.rowIndex+1,l=$get("description_cell"+da,n);this.trb.innerText=l.innerText;var K=$get("item_type_cell",n);this.me=O=O.innerText;this.xpc="field"===K.innerText?1:"definedName"===K.innerText?2:"letVariable"===K.innerText?3:"tableColHeaderName"===K.innerText?4:"tableSpecialStructRef"===K.innerText?5:"pendingData"===K.innerText?6:"tableNamedObject"===K.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ph.a(this.Fr.length,da,O,l.innerText));this.epc(n)}}},aRa:{configurable:!0,
enumerable:!0,get:function(){return this.trb}},Oqa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},rw:{configurable:!0,enumerable:!0,get:function(){return this.xpc}}});Object(hd.a)(sb,"FormulaAutoCompleteListBox",Fh.a,[409]);Jl.Object.defineProperties(ib.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.yS}}});Object(hd.a)(ib,"LETVariableInfo",null,[]);Jl.Object.defineProperties(Oa.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(hd.a)(Oa,"TableColHeaderNameInfo",null,[]);Jl.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(hd.a)(xa,"TableNamedObjectInfo",null,[]);Jl.Object.defineProperties(na.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.yS}}});Object(hd.a)(na,"TableSpecialStructRefInfo",
null,[]);var wh=b(174),$h=b(173);Object(hd.a)(ma,"FormulaAutoCompleteCallbacks",null,[]);Object(hd.a)(Sa,"FormulaAutoCompleteRenderingInfo",null,[]);Object(hd.a)(oa,"CellMessage",null,[]);Object(hd.a)(ha,"FunctionSuggestionRequest",null,[]);Object(hd.a)(ba,"RunExperimentRequest",null,[]);var ri=Ac.a;Cm(R,ri);R.prototype.Xee=function(n){this.addHandler(R.a7c,n)};R.prototype.sFf=function(n){this.removeHandler(R.a7c,n)};R.prototype.Wee=function(n){this.addHandler(R.D6c,n)};R.prototype.rFf=function(n){this.removeHandler(R.D6c,
n)};R.prototype.set_visible=function(n){this.Uha.set_visible(n);this.hl&&!n&&this.PZa();Sys.UI.Control.prototype.set_visible.call(this,n);return n};R.prototype.DHg=function(n,O){this.isListVisible&&(n+=Ub.openParen,O++,this.Kvd(n,O));var da=0<O&&n.charAt(O-1)===Ub.openParen,l=O===n.length||n.charAt(O)===Ub.closeParen;if(!da||!l)return Rc.ULS.sendTraceTag(577905557,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",
O,!n.length,!!this.ML),!1;da=n.substring(0,O).lastIndexOf(this.Xe.listSeparator);l=n.substring(0,O-1).lastIndexOf(Ub.openParen);n=n.substring(-1===da&&-1===l?1:Math.max(da,l)+1,O-1).trim();return this.functionInfoManager.I9c(n)?!0:(Rc.ULS.sendTraceTag(577905556,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.ML),!1)};R.prototype.kXh=function(n,O){var da=this.DHg(n,O);if(!da||!this.ML)return Rc.ULS.shipAssertTag(590128196,
0,!da||da&&!!this.ML,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,ihf:0,TKe:0};da=this.ML.Params;da=da.replace(RegExp("[\\[\\]]","g"),"");var l=n.charAt(O-1)===Ub.openParen,K=l?"":"(",ka=O===n.length?")":"";var $a=this.Xe.listSeparator;$a=-1===da.indexOf($a)?da.length:da.indexOf($a);return{returnValue:n.substring(0,O)+K+da+ka+n.substring(O,n.length),ihf:l?O:O+1,TKe:$a}};R.prototype.qq=function(n,O){this.hl&&void 0!==this.Ur&&null!==
this.Ur&&this.Ur();this.O3h&&this.hl||ri.prototype.qq.call(this,n,O)};R.prototype.dispose=function(){if(this.Xe){this.CQa(!1);var n=te.g(this.Xe);n&&(n.ga&&(this.hl?n.ga.bF(Object(Kc.a)(this,this.nd,"onSelectionChanged")):n.ga.nca(Object(Kc.a)(this,this.nd,"onSelectionChanged")),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&n.ga.gya(Object(Kc.a)(this,this.dsd,"onActiveCellChanged$4"))),n.view.Tr(Object(Kc.a)(this,this.qq,"onGridScroll")));this.hl&&this.Xe.Aa&&this.Xe.Aa.wg(Object(Kc.a)(this,
this.Ii,"onActiveSheetChanged"))}this.functionInfoManager&&(this.functionInfoManager.cnc(Object(Kc.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded")),this.functionInfoManager.QTi(Object(Kc.a)(this,this.inf,"onFunctionInfoReset")));this.dm&&this.dm.WBd(Object(Kc.a)(this,this.FAb,"onFieldInfoListContextLoaded"));this.hl&&this.Ef&&this.Ef.VFf(Object(Kc.a)(this,this.csf,"onSelectedAutoCompleteItemChanged"));this.UWf(!1);Ff.a.Ia(this.Ef);Ff.a.Ia(this.ZWb);Ff.a.Ia(this.Uha);this.nja&&Ff.a.Ia(this.Oq);
this.qb=this.functionInfoManager=this.dm=this.Xe=null;Ff.a.rc(this.YHa);this.Nj=this.q7=this.Uha=this.YHa=null;ri.prototype.dispose.call(this)};R.prototype.lva=function(){return!this.Tw};R.prototype.M2h=function(){return!this.IEa};R.prototype.Xh=function(n,O){if(!this.lva()){if(!this.r4e&&this.hl&&!this.Ef.lk&&this.Ef.odc)return 125627505===O?(this.Ef.nwc(0),!0):1872288872===O?(this.isListVisible=!1,!0):!1;if(this.hl&&this.qM){if(125627505===O||267796030===O)return this.oaa&&this.Evc(O),this.gse(),
!1;if(1872288872===O)return this.hca(),this.isListVisible=!1,!0;if(this.r4e&&this.Ef.odc&&(-798660877===O||137938150===O))return!1}if(1!==this.Ef.rw||125627505!==O&&267796030!==O)if(6===this.Ef.rw){var da=n.keyCode;13!==da&&9!==da||this.pt(!1)}else{if(4===this.Ef.rw||5===this.Ef.rw)return ri.prototype.Xh.call(this,n,O,!0);1===this.Ef.GV.length&&(da=n.keyCode,this.Vne=8===da||127===da||46===da?!0:!1)}else{if(this.pt(!1)&&!this.Zia)return te.g(this.Xe).ga.Xh(n,O);if(125627505===O&&this.Zia)return!0}}return ri.prototype.Xh.call(this,
n,O)};R.prototype.$nc=function(){this.dm.aoc();this.q7=null;null==this.Hha||this.Hha||this.$ec("NoFieldChosen",1,2,1);this.Hha=null;this.V2=0;this.y4=this.bld=this.ikc=null};R.prototype.xlb=function(){var n=this,O=!!this.qb&&!Zf.f(this.Xe.sa);this.yab&&O?this.iwd(function(da){da.requester().functionSuggestion(Object.assign(new ha,{content:n.qb.text})).then(function(l){l.kind||(Rc.ULS.shipAssertTag(556147927,0,!!l&&!!l.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),
n.mQa=Vf.toArray(Vf.select(Vf.asEnumerable(l.payload.items),function(K){return R.oQg(K)})),Ee.AFrameworkApplication.Ng||n.Jje(O,!0));return null})}):this.Jje(O,!1)};R.prototype.cVe=function(){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var n=te.g(this.Xe).Zi?this.nrb.nP:this.Kmb.nP;"@"===this.qb.text.charAt(n+1)&&this.qb.textBox.caretPosition>n+1?this.Wab=n+2:this.Wab=n+1}else{n=this.qb.text.lastIndexOf(Ub.Caf);var O=this.qb.text.lastIndexOf("[");
this.Wab=n+1>=O?n+2:O+1}return this.qb.text.substring(this.Wab,this.qb.textBox.caretPosition)};R.prototype.Kje=function(){this.cUf()&&(this.fYg(),this.Tw&&(this.Hha=!1,this.XU=this.cVe(),this.Ef.IHa(this.Tw,this.XU,!0,void 0,void 0,!0),this.show(),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Uha.kpb()))};R.prototype.Ije=function(){this.cUf()&&(this.ZWb&&this.ZWb.cancel(),this.dm.Lbc?(this.lva()&&this.zue(!0),this.get_visible()?this.UJe():
this.KUd=wh.AsyncMethodContext.kx(Object(Kc.a)(this,this.UJe,"filterAndShowListBox"),Ub.B0g,Xc.a.cph,this.ZWb)):this.D3())};R.prototype.cUf=function(){return this.qb?0<this.Xe.Db.PQ||mf.a.na(this.qb.text)||!this.qb.isEditing?(this.set_visible(!1),!1):Zf.f(this.Xe.sa)?!1:!0:!1};R.prototype.GYa=function(n){this.qb&&this.isListVisible&&(this.yfd(this.qb.text,n),this.qb.textBox.caretPosition=n.range.start.character+n.newText.length,this.set_visible(!1))};R.prototype.pt=function(){if(!this.qb||!this.isListVisible)return!1;
var n=new Sys.StringBuilder,O=0,da=te.g(this.Xe),l=this.qb.text,K=0,ka=this.Ef.me,$a=!1;if(this.Ef.rw&&2!==this.Ef.rw&&3!==this.Ef.rw&&7!==this.Ef.rw)if(1===this.Ef.rw)if(this.Hha=!0,this.Zia){n.append(l.substr(0,this.V2+2));!n.toString().endsWith($g.a.QT)&&fd.EwaSettings.ka(138)&&n.append($g.a.QT);K=this.Ef.me;K=K.replace("'","''");K=K.replace("[","'[");K=K.replace("]","']");if(this.t0c||this.Lkh(K))K=$g.a.K$h+K+$g.a.P_i,$a=!0;n.append(K);O=n.toString().length;K=3;$h.a("PulloutFieldAccepted")}else return this.qb.text=
this.Ef.me,this.set_visible(!1),da.Zo(!1),da.focus(),this.$ec("FieldName",1,1,1),$h.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Ef.rw)Rc.ULS.sendTraceTag(543027683,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),n.append(l.substr(0,this.Wab)),mf.a.equals(this.Ef.me,"@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString,!1)?n.append("@"):(n.append(this.Ef.me),$a=!0,this.set_visible(!1)),O=n.toString().length;
else if(4===this.Ef.rw){Rc.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");n.append(l.substr(0,this.Wab));$a="";O=!1;for(var Lb=[39,91,93,64,35],bc=0;bc<this.Ef.me.length;bc++){var Dc=this.Ef.me.charCodeAt(bc);Array.contains(Lb,Dc)&&($a+="'");$a+=this.Ef.me.charAt(bc).toString();O||mf.a.isNumeral(Dc)||mf.a.T5e(Dc)||(O=!0)}Lb=te.g(this.Xe).Zi?this.nrb.nP:this.Kmb.nP;(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
"@"===l.charAt(Lb+1)&&O:l.lastIndexOf(Ub.Caf)+1>=l.lastIndexOf("[")&&O)?(n.append("["),n.append($a),n.append("]")):n.append($a);$a=!0;this.set_visible(!1);O=n.toString().length}else if(6===this.Ef.rw)n.append(l.substr(0,this.xpb));else return Rc.ULS.sendTraceTag(23730176,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;else n.append(l.substr(0,this.t0a)),n.append(this.Ef.me),this.Ef.rw||this.Ef.me.endsWith(")")||n.append("("),O=n.toString().length,n.append(l.substr(this.s6b)),
2===this.Ef.rw&&(K=4,ka="DefinedName",this.v1h&&($a=!0,this.set_visible(!1)));this.qb.text=n.toString();this.qb.textBox.caretPosition=O;this.qb.aLa()&&da.Jv&&da.Jv.tta&&da.Jv.oGb(this.qb.text,this.qb.textBox.caretPosition,this.qb.textBox.caretPosition,this.qb.textBox.Xu.length);da.Zi&&(n=da.Hc,n.text=this.qb.text,n.setCaretPosition(this.qb.textBox.caretPosition));ka=(null==this.Hha?0:this.Hha)?"FieldName":ka;this.Ef.lk.sectionRowIndex>=this.Ef.GV.length?this.$ec(ka,4,K,0):this.$ec(ka,1,K,0);$a||(5===
this.Ef.rw||4===this.Ef.rw?this.Kje():this.xlb());return!0};R.prototype.D3=function(n,O){n=void 0===n?null:n;O=void 0===O?null:O;n?(this.dm.aoc(),this.dm.D3(n,!1,!1,O)):(n=te.g(this.Xe),n.ga.ya.Eh&&(n=jg.v(n.ga.ya.Xd,this.Xe),this.dm.D3(n,!0,!0,O)))};R.prototype.hca=function(){this.Jva&&(this.W0=!1);this.qb.s2b();this.Jva||(this.W0=!1)};R.prototype.pAh=function(n){n=this.calcManager.getWorksheetFuncId(n);return this.FMe?this.FMe.descriptionsMap.get(n):null};R.prototype.zue=function(n){if(this.M2h()){if(this.dm.Lbc&&
this.dm.Al&&(!this.dm.Al.length||!this.dm.Al[0].FieldInfoDataList))return;this.Avj(n)}n=Vf.asEnumerable(this.IEa);n=Vf.concat(n,this.iCh(this.qb.text));fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.hl&&(n=Vf.concat(n,this.oDh()));Vf.OBc(n,function(O){return O.name},new vf);this.yab&&(n=Vf.concat(Vf.asEnumerable(this.mQa),n),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.mQa.length&&(this.zab=!0),this.mQa=
[]));this.q7=Vf.toArray(n)};R.prototype.fYg=function(){var n=this.qb.text;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var O=te.g(this.Xe).Zi?this.nrb.nGa:this.Kmb.nGa;this.Nj=Object(pf.a)(fi.a,this.Xe.Ab.getItemByName(O));O=!0;this.Nj||(this.Nj=this.tableManager.Nj,O=!1);this.Nj.Y_&&this.Nj.Y_.IsFullTableHeaders?this.axf(O):Qd.d(this.Nj)?(Rc.ULS.sendTraceTag(542758430,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",
this.Nj.qj),nf.H(this.Xe.ra.xa,this.Nj.qj,Object(Kc.a)(this,this.Jti,"onGetTableColHeadersSuccess"),Object(Kc.a)(this,this.Iti,"onGetTableColHeadersFailure"),null,null)):Rc.ULS.sendTraceTag(542758431,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Nj.qj)}else if(this.calcManager&&this.tableManager.Nj)if(O=this.calcManager.ctb(this.tableManager.Nj))if(this.calcManager.nwg(this.tableManager.Nj,O)){n=Vf.empty();if(91===this.qb.text.charCodeAt(this.qb.text.length-
1)){var da=this.cZa("@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString),l;n=Vf.concat(n,(l=new Aa.a,l.add(da),l))}n=Vf.concat(n,Vf.select(Vf.asEnumerable(O.toArray()),function(K){var ka=new Za,$a=new Oa;$a._name=K.toString();ka.PPf($a);return ka}));this.q7=Vf.toArray(n)}else n.endsWith("[")&&"["!==n.charAt(n.length-2)&&Rc.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
O.count,this.tableManager.Nj.qj,this.tableManager.Nj.usedRange.right-this.tableManager.Nj.usedRange.left+1);else n.endsWith("[")&&"["!==n.charAt(n.length-2)&&Rc.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};R.prototype.Lkh=function(n){if(!n)return!1;var O=n.charCodeAt(0);if(46===O||48<=O&&57>=O||63===O)return!0;for(var da=0;da<n.length;da++,
O=n.charCodeAt(da))if(!((fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?mf.a.isLetter(O):mf.a.lid(O))||92===O||95===O||63===O||48<=O&&57>=O))return!0;return!1};R.prototype.Kvd=function(n,O){var da=!1,l=!1,K=!1,ka=0,$a=0;this.t0a=0;this.s6b=O;this.b1b=1;for(var Lb=O-1;0<=Lb;--Lb)switch(n.charCodeAt(Lb)){case 39:l=!l;break;case 34:da=!da;break;case 91:++ka;K=ka>$a;break;case 93:++$a}K=Object.assign(new ta,{ura:!da,vra:!l,Pga:!K,jCb:1});
ka=this.aEi(n,O,K);O=this.bEi(n,O,K.ura,K.vra,K.Pga);this.b1b=ka+O;if(this.JKc=ka-1)this.Nrc=!1;this.ylh(n,da,l,K.lvd,K.mvd)};R.prototype.jfd=function(){var n=this;this.iwd(function(O){fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?te.g(n.Xe).ga.mqa(Object(Kc.a)(n,n.dsd,"onActiveCellChanged$4")):te.g(n.Xe).ga.WF(Object(Kc.a)(n,n.dsd,"onActiveCellChanged$4"));n.Jzb();R.QEd(O);n.yab&&n.VJg()})};R.prototype.Obd=function(){this.yKa&&this.raiseEvent(R.D6c,null)};R.prototype.Zjh=
function(){return this.yab||this.fJe};R.prototype.UJe=function(){this.Hha=!1;this.XU=this.qb.text;this.Ef.IHa(this.Tw,this.XU,!0,this.columnName,void 0,!1);1===this.Ef.Fr.length&&1===this.Ef.GV.length?(this.set_visible(!1),this.Vne||this.eac()):this.show()};R.prototype.cEi=function(){var n=this.y4;if(!this.ndj||mf.a.na(n))return this.V2=0,this.IEa=this.q7=null,!1;n=n.endsWith($g.a.QT);var O;if(O=fd.EwaSettings.ka(138)){O=this.Zsj(this.y4.substring(0,this.W2));var da=O.sheetRange;O=O.returnValue}return O&&
(O=this.y4.substring(0,this.V2),n&&O!==this.bld)?(this.bld=O,this.V2=this.y4.length-(n?1:0),this.D3(da,this.y4),this.Hha=!1,Rc.ULS.sendTraceTag(590193557,0,50,"Begin dot notation autocomplete"),!0):!1};R.prototype.iCh=function(n){var O=new Aa.a;this.calcManager&&fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Rc.ULS.shipAssertTag(562394560,0,!!this.calcManager.Gra(ui.Range.xd(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&
this.fJe&&(n=this.calcManager.extractLetVariables(n,this.qb.textBox.caretPosition))){n=Ml(n);for(var da=n.next();!da.done;da=n.next()){var l=da.value;da=new ib;da._name=l;da.yS=Sd.a.instance.da(2109);l=new Za;l.i8i(da);O.add(l)}}return O};R.prototype.oDh=function(){for(var n=new Aa.a,O=this.Xe.Ab.items,da=0,l=O.length;da<l;da++){var K=O[da];if(Zf.o(K)){var ka=new xa;ka._name=K.name;K=new Za;K.w$i(ka);n.add(K)}}return n};R.prototype.cZa=function(n){var O=new Za,da=new na;da._name=n;O.x$i(da);return O};
R.prototype.Jti=function(n){if(Cf.a(n))-315732528!==n.Errors[0].MessageId&&Rc.ULS.sendTraceTag(542758429,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",qd.a.fd(n.Errors));else if((n=n.Result)&&n.length){this.Nj.Y_||(this.Nj.Y_={},this.Nj.Y_.HeadersList=[]);this.Nj.Y_.IsFullTableHeaders=!0;for(var O=0;O<n.length;++O)this.Nj.Y_.HeadersList[O]={},this.Nj.Y_.HeadersList[O].Index=O,this.Nj.Y_.HeadersList[O].Name=n[O];this.axf(!0);this.XU=
this.cVe();this.Ef.IHa(this.Tw,this.XU,!0,void 0,void 0,!0);this.show()}else Rc.ULS.sendTraceTag(542758428,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};R.prototype.Iti=function(n){n=Ph.a.Eg(n.data);Rc.ULS.sendTraceTag(542758427,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",qd.a.fd(n))};R.prototype.axf=function(n){var O=new Aa.a,da=this.qb.text.charCodeAt(this.qb.text.length-1),l=this.qb.textBox.caretPosition-
1;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.qb.text.charCodeAt(l):91===da){var K=this.cZa("@ - "+this.instantaneousSupportInformationManager.Oe.ThisRowStructRefString);O.add(K)}K=Ml(this.Nj.Y_.HeadersList);for(var ka=K.next();!ka.done;ka=K.next()){ka=ka.value;var $a=new Za,Lb=new Oa;Lb._name=ka.Name;$a.PPf(Lb);O.add($a)}K=te.g(this.Xe).Zi?this.nrb.nP:this.Kmb.nP;ka=this.qb.text.charCodeAt(K+1);(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
!n||l!==K&&35!==ka:!n||91!==da&&35!==da)||(n=this.cZa("#"+this.instantaneousSupportInformationManager.Oe.AllStructRefString),O.add(n),n=this.cZa("#"+this.instantaneousSupportInformationManager.Oe.DataStructRefString),O.add(n),n=this.cZa("#"+this.instantaneousSupportInformationManager.Oe.HeadersStructRefString),O.add(n),n=this.cZa("#"+this.instantaneousSupportInformationManager.Oe.TotalsStructRefString),O.add(n));O&&(this.q7=O.toArray())};R.prototype.Avj=function(n){var O=Vf.empty();!n&&this.functionInfoManager.k4&&
(O=Vf.concat(O,Vf.select(Vf.asEnumerable(this.functionInfoManager.r6b),function(da){var l=new Za;l.tOf(da);return l})),n=this.fye.x0g,0<n.length&&(O=Vf.OBc(Vf.concat(O,Vf.select(Vf.asEnumerable(n),function(da){var l=new Za;l.L6i(da);return l})),function(da){return da.name},new vf)));if(this.dm.Lbc&&this.dm.Al){if(!this.dm.Al.length||!this.dm.Al[0].FieldInfoDataList)return;O=Vf.OBc(Vf.concat(O,Vf.select(Vf.asEnumerable(this.dm.Al[0].FieldInfoDataList),function(da){var l=new Za;l.l7i(da);return l})),
function(da){return da.name},new vf);this.columnName=this.dm.Al[0].ColumnName}this.IEa=Vf.toArray(O)};R.prototype.Jzb=function(){var n=this,O=te.g(this.Xe).ga.ya.activeCell;if(O){var da=this.calcManager.Gra(O);if(da){var l=this.Xe.Aa,K=da.sheet.index;if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5726798_FixNotifyActiveCellChangedSheetIDAccess")&&(0>=l.count||0>K||K>=l.count))Rc.ULS.sendTraceTag(538808593,0,15,"FormulaAssistanceControl.NotifyActiveCellChanged InvalidSheetIndex. sheetCount: {0} sheetIndex: {1}.",
l.count,K),this.G4=!0;else{this.G4=!1;var ka=null,$a=null;this.Kzb&&void 0!==this.calcManager&&null!==this.calcManager&&(O=te.g(this.Xe).Ha.Hr(O))&&(O=this.calcManager.v$c(O.numberFormatIndex),void 0!==O&&null!==O&&(ka=O.FormatString,$a=O.Builtin));this.iwd(function(Lb){Lb.notifier().setActiveCell(Object.assign(new oa,{colIndex:da.range.col,rowIndex:da.range.row,sheetIndex:n.Xe.Aa.getItem(da.sheet.index).sheetId,docName:da.sheet.document.name,docPath:da.sheet.document.path,formatString:ka,builtIn:$a}))})}}else Rc.ULS.sendTraceTag(538808594,
0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null"),this.G4=!0}else Rc.ULS.sendTraceTag(538808595,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged active cell range is null"),this.G4=!0};R.prototype.dsd=function(){te.g(this.Xe).isEditing||te.g(this.Xe).wi||this.Jzb()};R.prototype.nd=function(){(fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||this.hl)&&this.set_visible(!1)};R.prototype.VJg=function(){te.g(this.Xe).Zi?
this.nrb.lT(!1):this.Kmb.lT(!1)};R.prototype.n9e=function(n){var O=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?mf.a.isLetter(n):mf.a.lid(n);return 48<=n&&57>=n||46===n||95===n||O};R.prototype.show=function(){if(this.Tw){var n=this.Ef.b$i();this.hl?0<this.Ef.Fr.length?n||this.RTf():this.PZa():((n=0<this.Ef.Fr.length)&&Gc.instance.mF("autoCompleteRender"),this.isListVisible||mf.a.na(this.columnName)||!n||this.Ef.CLi(this.Ef.Fr.length,
this.columnName),this.isListVisible=n,this.Uha.show(this.ML),this.aAa(!0),this.Ef.uwa(),n&&Gc.instance.hA("autoCompleteRender"))}};R.prototype.bEi=function(n,O,da,l,K){for(da=Object.assign(new ta,{Fuf:41,are:40,ura:da,vra:l,Pga:K});O<n.length&&!this.Cvf(n,O,da);++O);return da.jCb};R.prototype.aEi=function(n,O,da){for(--O;0<=O&&!this.Cvf(n,O,da);--O);return da.jCb};R.prototype.Cvf=function(n,O,da){var l=n.charCodeAt(O);0>=this.W2&&(this.W2=n.substring(0,O).lastIndexOf($g.a.QT));46===l&&(O<this.W2?
this.W2=O:O>this.xpb&&(this.V2=this.xpb=O));if(!this.n9e(l)&&!R.L7h(l)&&(!this.Zia||O<=this.W2||!R.DSh(l,da))){da.Clf&&(da.Clf=!1,this.t0a=O+1);if(da.Ytd){da.mvd=O+1;if(this.functionInfoManager.I9c(n.substring(da.mvd,da.lvd)))return!0;da.Ytd=!1}switch(l){case 39:da.vra=!da.vra;break;case 34:da.ura=!da.ura;break;case 91:da.Pga=!1;break;case 93:da.Pga=!0}l===this.Xe.listSeparator.toString().charCodeAt(0)&&da.vra&&da.ura&&!da.sYa&&(!this.Zia||da.Pga)&&(O<da.HFd||-1===da.HFd)&&(da.jCb+=1,this.b1b++);
l===da.are&&da.ura&&da.vra&&(!this.Zia||da.Pga)?da.sYa+=1:l===da.Fuf&&da.ura&&da.vra&&(!this.Zia||da.Pga)?0<da.sYa?--da.sYa:(da.HFd=da.SKe,da.SKe=O,0<O&&this.n9e(n.charCodeAt(O-1))&&(da.Ytd=!0,da.lvd=O)):this.Zia&&46===l&&O>this.W2&&(O<this.W2?this.W2=O:O>this.xpb&&(this.V2=this.xpb=O))}return!1};R.prototype.ylh=function(n,O,da,l,K){this.s6b>this.t0a&&0<=this.t0a?O||da||(this.XU=n.substring(this.t0a,this.s6b)):this.XU=null;l!==K?(n=n.substring(K,l),this.ML&&(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5106093_FormulaArgumentsAssistanceReadoutFix")?
mf.a.equals(this.ML.NameDataStrings,n,!0):this.ML.NameDataStrings===n)||(this.Nrc=!0),this.ML=this.functionInfoManager.I9c(n)):(this.Nrc=!1,this.ML=null)};R.prototype.UWf=function(n){var O=$get(Ub.wvf+"_"+Ub.iCb,this.domElement),da=$get(Ub.xvf+"_"+Ub.iCb,this.domElement);n&&!this.g$b?(O&&Jf.a.instance.qa(Ve.a.click,O,Object(Kc.a)(this,this.qba,"onHelpLinkClick")),da&&Jf.a.instance.qa(Ve.a.click,da,Object(Kc.a)(this,this.qba,"onHelpLinkClick")),this.g$b=!0):this.g$b&&(O&&Jf.a.instance.Ca(Ve.a.click,
O,Object(Kc.a)(this,this.qba,"onHelpLinkClick")),da&&Jf.a.instance.Ca(Ve.a.click,da,Object(Kc.a)(this,this.qba,"onHelpLinkClick")),this.g$b=!1)};R.prototype.inf=function(){this.q7=this.IEa=null};R.prototype.Ii=function(){this.hl&&this.PZa()};R.prototype.Zsj=function(n){var O=this;var da=null;var l;if(function(){var Lb=jg.Y(n,O.Xe.fa.Aa);ka=Lb.sheetName;l=Lb.range;return Lb}().returnValue&&l){if(!ka){var K=Object(pf.a)(fg.a,this.Xe.sa);if(!K)return{returnValue:!1,sheetRange:da};var ka=K.name}da=jg.v(l,
this.Xe);da.SheetName=ka;this.t0c=!1;return{returnValue:!0,sheetRange:da}}var $a=null;return function(){var Lb=O.fye.Asj(n);ka=Lb.sheetName;$a=Lb.range;return Lb}().returnValue?(da=jg.v($a,this.Xe),da.SheetName=ka,this.t0c=!0,{returnValue:!0,sheetRange:da}):{returnValue:!1,sheetRange:da}};R.prototype.eac=function(){if(1===this.Ef.GV.length&&this.Tw.length){var n=this.Tw[this.Ef.GV[0]];if(1===n.itemType){var O=n.name;n=this.qb.text;O=O.substring(n.length,O.length);O.length&&(this.qb.text=n+O,this.qb.textBox.selectRange(n.length,
this.qb.text.length))}}else Rc.ULS.shipAssertTag(37552162,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Ef.GV.length)};R.prototype.onFunctionInfoLoaded=function(){this.xlb()};R.prototype.FAb=function(){this.Zia?(this.IEa=this.q7=null,this.xlb()):this.dm.Al&&this.Ije()};R.prototype.qba=function(){this.ML&&Bb(this.Xe,this.ML.HelpId,this.ML.IsDynamicUdf);return!0};R.prototype.$ec=function(n,O,da,l){var K={};K.a=n;K.b=O;K.c=da;K.d=l;$d.b().Se(38,K,!0)};
R.prototype.Jje=function(n,O){if(!this.functionInfoManager.k4){if(n)if(this.Kvd(this.qb.text,this.qb.textBox.caretPosition),this.yab||!mf.a.na(this.XU)){var da={};da.Filter=this.XU?this.XU.charAt(0).toString():"";da.FilterType=1;da.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.$pb(da)}else fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!O)return}0<this.Xe.Db.PQ||this.qb&&!this.qb.isEditing?this.set_visible(!1):
n&&(this.Kvd(this.qb.text,this.qb.textBox.caretPosition),this.Uha.update(this.ML,this.b1b,this.JKc,this.Nrc),this.y4=this.qb.text.substring(1,this.qb.textBox.caretPosition),this.W2=this.y4.indexOf($g.a.QT),this.V2=this.y4.lastIndexOf($g.a.QT),this.cEi()?(n=new Za,n.W8i(),this.IEa=this.q7=n=[n],this.Ef.txj(n),this.show()):((this.Zjh()||this.lva())&&this.zue(!1),0<this.V2?this.Ef.IHa(this.Tw,this.y4,!1,void 0,this.y4.lastIndexOf($g.a.QT),!1):this.Ef.IHa(this.Tw,this.XU,!1,void 0,this.V2,!1),this.show(),
this.hl&&(this.Ef.Fr.length||te.g(this.Xe).Ej.dN?this.Uha.kpb():(this.Kzb&&this.G4&&Rc.ULS.sendTraceTag(538808592,0,15,"FormulaAssistanceControl.AssistFormulaDraw RequestArgumentAssistance called after lastNotifyActiveCellChangedFailed"),this.Uha.ZXi(),this.hl&&this.PZa()))))};R.prototype.iwd=function(n){this.rwb?n(this.pluginScheduler):fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.Xe.ea,413,414,1,"Microsoft.Office.Excel.WebUI.Client.IPluginScheduler"),function(O){n(O.result)},this.Xe.ma,
3)};R.prototype.RTf=function(){var n=this;if(0<this.Ef.Fr.length){Gc.instance.mF("autoCompleteRender");if(this.formulaAssistanceUIControl){if(this.y3a){var O={};O.zoomLevel=Tb(this.Xe);this.formulaAssistanceUIControl.updateContext(O)}else this.formulaAssistanceUIControl.setZoomLevel(Tb(this.Xe));this.Ur=function(){n.formulaAssistanceUIControl.renderAutoCompleteMenu(n.domElement,te.g(n.Xe).Ej.textBox.domElement,n.F9c())};this.Ur();this.yKa&&this.Ef.odc&&this.raiseEvent(R.a7c,null);this.nja&&(this.Oq.canReceiveFocus=
!0)}Gc.instance.hA("autoCompleteRender");!fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.mQa&&null!==this.mQa&&0<this.mQa.length&&(this.zab=!0)}};R.prototype.PZa=function(){this.oaa&&this.lnd();!this.qM||this.yhd&&!this.qb.isEditing||this.hca();this.Ur=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.nja&&(this.Oq.canReceiveFocus=!1))};R.prototype.lnd=function(){this.KGa&&(Gc.instance.P1.selectByArrowKeyCounter++,
this.KGa=!1);this.LGa&&(Gc.instance.P1.selectByMouseHoverCounter++,this.LGa=!1);this.JGa&&(Gc.instance.P1.commitByTabKeyCounter++,this.JGa=!1);this.HGa&&(Gc.instance.P1.commitByEnterKeyCounter++,this.HGa=!1);this.IGa&&(Gc.instance.P1.commitByMouseClickCounter++,this.IGa=!1)};R.prototype.csf=function(){this.qM&&this.hca();this.RTf();1!==this.RLf.type||!fd.EwaSettings.bdc()||this.hgd&&mf.a.contains(this.qb.text,"\n",!1)||(this.yxd(this.RLf),this.tIb=!0)};R.prototype.F9c=function(){var n=new Sa;n.completionItems=
this.Ef.pXc;n.activeItemIndex=this.Ef.lk?this.Ef.lk.rowIndex:-1;this.NAd(n);return n};R.prototype.NAd=function(n){n.callbacks=new ma;n.callbacks.onCompletionItemSelected=Object(Kc.a)(this,this.Nsd,"onCompletionItemHovered");n.callbacks.onCompletionItemCommitted=Object(Kc.a)(this,this.Msd,"onCompletionItemClicked");n.callbacks.onFeedback=Object(Kc.a)(this,this.aPa,"sendCardFeedback");fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(n.callbacks.onDismiss=
Object(Kc.a)(this,this.PZa,"dismissReactAutoCompleteUI"))};R.prototype.aPa=function(){var n={};n[ub.a.Fha]="FunctionSuggestions";this.Xe.Re(802602464,0,8,n)};R.prototype.Nsd=function(n,O){this.Ef.nwc(O);this.oaa&&(this.LGa=!0)};R.prototype.Msd=function(n){this.oaa&&(this.IGa=!0);this.qM?(this.gse(),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5697098_EndEditInFormulaBarAfterItemClicked")?te.g(this.Xe).Ej.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0):te.g(this.Xe).Zo(!1)):n.textEdit?
this.GYa(n.textEdit):this.pt(!0)};R.prototype.yxd=function(n){this.W0=!0;var O=n.textEdit.newText;this.qb.lab(O.substring(this.qb.text.length-n.textEdit.range.start.character,O.length))};R.prototype.gse=function(){this.pt(!0);this.W0=this.isListVisible=!1;this.sIb=!0};R.prototype.yfd=function(n,O){this.qb.text=n.substring(0,O.range.start.character)+O.newText+n.substring(O.range.end.character,n.length);te.g(this.Xe).Zi&&(te.g(this.Xe).Hc.text=this.qb.text)};R.QEd=function(n){n.requester().runExperiment(new ba)};
R.oQg=function(n){var O=Za.OXg(),da={IsCompatibility:!1};da.NameDataStrings=n.label;da.Help=n.detail;O.tOf(da);O.textEdit=n.textEdit;return O};R.hIa=function(){var n=String.format(Ub.fqh,Ub.q7c,xj.a.VEe),O=String.format(Ub.aqh,Ub.o7c,yc.a.UEe,Df.a.Er,Df.a.zu),da=String.format(Ub.Yph,Ub.k7c,yc.a.UEe,Df.a.Er,yc.a.HFe,Df.a.zu);return String.format("{0}\r\n{1}\r\n{2}",n,O,da)};R.L7h=function(n){return 36===n||58===n||33===n||39===n||32===n};R.DSh=function(n,O){return 32===n||91===n||!O.Pga};Jl.Object.defineProperties(R.prototype,
{Zp:{configurable:!0,enumerable:!0,get:function(){return this.Ef}},Tw:{configurable:!0,enumerable:!0,get:function(){return this.q7}},hGb:{configurable:!0,enumerable:!0,get:function(){return this.Ef.me}},xMe:{configurable:!0,enumerable:!0,get:function(){return this.Ef}},dMe:{configurable:!0,enumerable:!0,get:function(){return this.Uha}},Ef:{configurable:!0,enumerable:!0,get:function(){return this.Icg}},iZa:{configurable:!0,enumerable:!0,get:function(){return this.yab?this.qb?this.qb.text:null:this.XU}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Zp.isListVisible},set:function(n){this.hl&&!n&&this.PZa();this.Zp.isListVisible=n}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Jkg}},Zia:{configurable:!0,enumerable:!0,get:function(){return 0<this.V2}},qM:{configurable:!0,enumerable:!0,get:function(){return this.W0}},ZWb:{configurable:!0,enumerable:!0,get:function(){return this.KUd}},V2:{configurable:!0,enumerable:!0,get:function(){return this.zAe},
set:function(n){this.zAe=n;n||(this.W2=0)}},ndj:{configurable:!0,enumerable:!0,get:function(){if(null==this.ikc){var n=this.Xe.mc;this.ikc=!!n&&!n.inEmbedView}return this.ikc}},RLf:{configurable:!0,enumerable:!0,get:function(){return this.Ef.pXc[this.Ef.lk.rowIndex]}},FMe:{configurable:!0,enumerable:!0,get:function(){!this.r7c&&this.pluginScheduler&&(this.r7c=this.pluginScheduler.getFunctionsShortDescriptions());return this.r7c}}});R.a7c="FACardOpened";R.D6c="FAFocusOnSmartSuggestionsCard";R.Mdd=
null;Object(hd.a)(R,"FormulaAssistanceControl",Ac.a,[360,361,7,362,363]);var Qi=Te.a;Cm(ja,Qi);ja.prototype.Zee=function(n){this.addHandler("FAFunctionNameUpdated",n)};ja.prototype.tFf=function(n){this.removeHandler("FAFunctionNameUpdated",n)};ja.prototype.Qfe=function(n){this.addHandler("FAParameterSelectionChangedOld",n)};ja.prototype.UFf=function(n){this.removeHandler("FAParameterSelectionChangedOld",n)};ja.prototype.Pfe=function(n){this.addHandler("FAParameterSelectionChanged",n)};ja.prototype.TFf=
function(n){this.removeHandler("FAParameterSelectionChanged",n)};ja.prototype.Urg=function(n){this.addHandler("DC",n)};ja.prototype.xTi=function(n){this.removeHandler("DC",n)};ja.prototype.get_visible=function(){return this.visible};ja.prototype.set_visible=function(n){n||this.dismiss();return this.visible=n};ja.prototype.dismiss=function(){this.visible=!1;this.formulaAssistanceUIControl&&(this.Ur=null,this.formulaAssistanceUIControl.dismiss(this.domElement),this.mvb&&(this.Tja=null),this.tE&&(this.Oq.canReceiveFocus=
!1))};ja.prototype.show=function(n,O){var da=this;this.visible=!0;this.TOc();var l=this.hxd(n);this.formulaAssistanceUIControl&&(Gc.instance.mF("argumentAssistanceRender"),this.A9e&&this.formulaAssistanceUIControl.setZoomLevel(Tb(this.$)),fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Ur=function(){da.formulaAssistanceUIControl.renderArgumentAssistanceCard(da.domElement,O,l)},this.Ur()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
O,l),this.gwd(l),this.tE&&(this.Oq.canReceiveFocus=!0),Gc.instance.hA("argumentAssistanceRender"))};ja.prototype.dispose=function(){if(this.$){var n=te.g(this.$);n&&(n.ga&&n.ga.bF(Object(Kc.a)(this,this.nd,"onSelectionChanged")),n.view.Tr(Object(Kc.a)(this,this.qq,"onGridScroll")))}Ff.a.Ia(this.Oq);this.$=null};ja.prototype.TOc=function(){var n=te.g(this.$).Ej;n.vAa.contains(this)||n.vAa.add(this)};ja.prototype.nd=function(){this.set_visible(!1)};ja.prototype.hxd=function(n){var O=new qb;O.functionRenderingInfo=
n;O.cardMode=this.US;this.PAd(O);return O};ja.prototype.PAd=function(n){n.callbacks=new za;n.callbacks.onHelpLink=this.O9c(n.functionRenderingInfo);n.callbacks.onCardModeChange=Object(Kc.a)(this,this.onCardModeChange,"onCardModeChange");n.callbacks.onFeedback=Object(Kc.a)(this,this.aPa,"sendCardFeedback");this.naa&&(n.callbacks.onDismissClick=Object(Kc.a)(this,this.onDismissClick,"onDismissClick"))};ja.prototype.O9c=function(n){var O=this;return function(){Bb(O.$,n.helpID,n.isUDF)}};ja.prototype.onCardModeChange=
function(n){this.nKb(n);1===n?Gc.instance.Wha.argumentAssistanceCollapseCounter++:Gc.instance.Wha.argumentAssistanceExpandCounter++};ja.prototype.aPa=function(n){var O={};O[ub.a.Fha]="ArgumentAssistanceCard";var da={};da.FunctionName=n.functionName;O[ub.a.e5c]=da;this.$.Re(802602464,0,8,O)};ja.prototype.qHd=function(){var n=Cd.a.get(ub.a.QWb);mf.a.na(n)?this.US=ja.j0c:this.US=parseInt(n);Gc.instance.dNf(this.US)};ja.prototype.qq=function(){void 0!==this.Ur&&null!==this.Ur&&this.Ur()};ja.prototype.gwd=
function(n){var O=this;if(this.mvb){var da=n.functionRenderingInfo.functionName;mf.a.na(this.Tja)||!mf.a.equals(this.Tja,da,!0)?(this.Tja=da,n=Gh.a.map(n.functionRenderingInfo.signatures,function(l){return l.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ia(da,n))):(da=Gh.a.map(n.functionRenderingInfo.signatures,function(l){var K="";if(!O.f4a||0<=l.signatureParams.activeParam&&l.signatureParams.activeParam<l.signatureParams.params.length)K=l.signatureParams.params[l.signatureParams.activeParam];
return K}),this.raiseEvent("FAParameterSelectionChanged",new Kb(da)))}};ja.prototype.onDismissClick=function(){Gc.instance.Wha.argumentAssistanceDismissCounter++;this.dismiss();this.raiseEvent("DC");fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!this.US&&this.nKb(1)};ja.prototype.nKb=function(n){this.US=n;try{Cd.a.tw(ub.a.QWb,n.toString(),Ah.AFrame.pda)}catch(O){Rc.ULS.sendTraceTag(555360993,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",
O.message)}};ja.hIa=function(){return document.createElement("div")};ja.j0c=0;Object(hd.a)(ja,"FormulaArgumentAssistanceControl",Te.a,[413]);var Xh=Te.a;Cm(X,Xh);X.prototype.Xee=function(n){this.addHandler("FACardOpened",n)};X.prototype.sFf=function(n){this.removeHandler("FACardOpened",n)};X.prototype.Wee=function(n){this.addHandler("FAFocusOnSmartSuggestionsCard",n)};X.prototype.rFf=function(n){this.removeHandler("FAFocusOnSmartSuggestionsCard",n)};X.prototype.dispose=function(){if(this.$){var n=
te.g(this.$);n&&(n.ga&&n.ga.bF(Object(Kc.a)(this,this.nd,"onSelectionChanged")),n.view.Tr(Object(Kc.a)(this,this.qq,"onGridScroll")));this.$.Aa&&this.$.Aa.wg(Object(Kc.a)(this,this.Ii,"onActiveSheetChanged"))}this.nja&&Ff.a.Ia(this.Oq);this.$=null};X.prototype.Grg=function(n){this.addHandler("CVIC",n)};X.prototype.jTi=function(n){this.removeHandler("CVIC",n)};X.prototype.get_visible=function(){return this.visible};X.prototype.set_visible=function(n){n||this.dismiss();return this.visible=n};X.prototype.Xh=
function(n,O){if(!this.get_visible())return!1;this.oaa&&this.Evc(O);if(this.qM){if(125627505===O||this.jhd&&267796030===O)return this.GYa(this.Tw.items[this.D_].textEdit),!this.jhd;if(1872288872===O)return this.hca(),this.set_visible(!1),!0;if(!this.jhd&&267796030===O)this.hca();else if(this.WBi&&(-798660877===O||137938150===O))return!1}n=!1;switch(O){case 1872288872:this.set_visible(!1);n=!0;break;case -798660877:this.fcb(this.Ysb(this.D_+1));n=!0;break;case 137938150:this.fcb(this.Ysb(this.D_-1));
n=!0;break;case 2091832999:this.fcb(this.Ysb(this.D_+8));n=!0;break;case 742457698:this.fcb(this.Ysb(this.D_-8));n=!0;break;case 125627505:this.GYa(this.Tw.items[this.D_].textEdit);n=!0;break;case 267796030:fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.GYa(this.Tw.items[this.D_].textEdit),n=!0)}return n};X.prototype.show=function(n){this.qb=te.g(this.$).Ej;this.visible=!0;this.TOc();this.D_=0;this.Tw=n;0<this.Tw.items.length&&(this.render(),
this.fcb(this.Ysb(this.D_)),1===this.Tw.items[0].type&&this.Fhd&&(this.zab=!0))};X.prototype.dismiss=function(){this.visible=!1;this.oaa&&this.lnd();!this.qM||this.yhd&&!this.qb.isEditing||this.hca();this.Ur=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.nja&&(this.Oq.canReceiveFocus=!1))};X.prototype.hca=function(){this.Jva&&(this.W0=!1);this.qb.s2b();this.Jva||(this.W0=!1)};X.prototype.render=function(){var n=this;Gc.instance.mF("autoCompleteRender");
if(this.formulaAssistanceUIControl){if(this.y3a){var O={};O.zoomLevel=Tb(this.$);this.formulaAssistanceUIControl.updateContext(O)}else this.formulaAssistanceUIControl.setZoomLevel(Tb(this.$));this.Ur=function(){n.formulaAssistanceUIControl.renderAutoCompleteMenu(n.domElement,n.qb.textBox.domElement,n.F9c())};this.Ur();this.nja&&(this.Oq.canReceiveFocus=!0);Gc.instance.hA("autoCompleteRender")}};X.prototype.Obd=function(){this.yKa&&this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};X.prototype.TOc=
function(){this.qb.vAa.contains(this)||this.qb.vAa.add(this)};X.prototype.GYa=function(n){this.qb&&this.get_visible()&&(this.yfd(this.qb.text,n),this.qb.textBox.caretPosition=n.range.start.character+n.newText.length,this.qM&&(this.W0=!1,this.Fhd&&(this.sIb=!0),this.qb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0)),this.set_visible(!1),this.raiseEvent("CVIC"))};X.prototype.F9c=function(){var n=new Sa;n.completionItems=this.Tw.items;n.activeItemIndex=this.D_;this.NAd(n);return n};
X.prototype.NAd=function(n){n.callbacks=new ma;n.callbacks.onCompletionItemSelected=Object(Kc.a)(this,this.Nsd,"onCompletionItemHovered");n.callbacks.onCompletionItemCommitted=Object(Kc.a)(this,this.Msd,"onCompletionItemClicked");n.callbacks.onFeedback=Object(Kc.a)(this,this.aPa,"sendCardFeedback");fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(n.callbacks.onDismiss=Object(Kc.a)(this,this.dismiss,"dismiss"))};X.prototype.aPa=function(){var n={};n[ub.a.Fha]=
"FunctionSuggestions";this.$.Re(802602464,0,8,n)};X.prototype.yxd=function(n){this.W0=!0;var O=n.textEdit.newText;this.qb.lab(O.substring(this.qb.text.length-n.textEdit.range.start.character,O.length))};X.prototype.fcb=function(n){var O=this.D_;this.D_=n;var da=this.Tw.items[n];this.qM&&this.hca();O!==n&&this.render();1!==da.type||!fd.EwaSettings.bdc()||this.hgd&&mf.a.contains(te.g(this.$).Ej.text,"\n",!1)||(this.yxd(da),this.Fhd&&(this.tIb=!0))};X.prototype.Nsd=function(n,O){this.fcb(O);this.oaa&&
(this.LGa=!0)};X.prototype.Ysb=function(n){return 0>n?0:Math.min(n,this.Tw.items.length-1)};X.prototype.nd=function(){this.set_visible(!1)};X.prototype.Msd=function(n){this.oaa&&(this.IGa=!0);this.GYa(n.textEdit)};X.prototype.yfd=function(n,O){this.qb.text=n.substring(0,O.range.start.character)+O.newText+n.substring(O.range.end.character,n.length);te.g(this.$).Zi&&(te.g(this.$).Hc.text=this.qb.text)};X.prototype.Ii=function(){this.dismiss()};X.prototype.qq=function(){void 0!==this.Ur&&null!==this.Ur&&
this.Ur()};X.prototype.lnd=function(){this.KGa&&(Gc.instance.P1.selectByArrowKeyCounter++,this.KGa=!1);this.LGa&&(Gc.instance.P1.selectByMouseHoverCounter++,this.LGa=!1);this.JGa&&(Gc.instance.P1.commitByTabKeyCounter++,this.JGa=!1);this.HGa&&(Gc.instance.P1.commitByEnterKeyCounter++,this.HGa=!1);this.IGa&&(Gc.instance.P1.commitByMouseClickCounter++,this.IGa=!1)};X.prototype.Evc=function(n){switch(n){case -798660877:case 137938150:case 2091832999:case 742457698:this.KGa=!0;break;case 125627505:this.JGa=
!0;break;case 267796030:fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HGa=!0)}};X.hIa=function(){return document.createElement("div")};Jl.Object.defineProperties(X.prototype,{qM:{configurable:!0,enumerable:!0,get:function(){return this.W0}},WBi:{configurable:!0,enumerable:!0,get:function(){return 1===this.Tw.items.length&&1===this.Tw.items[0].type}}});Object(hd.a)(X,"FormulaAutoCompleteControl",Te.a,[415,7,362]);Object(hd.a)(ea,"FunctionSuggestionAndArgumentAssistanceRequest",
null,[]);P.prototype.dispose=function(){if(this.$){var n=te.g(this.$);n&&n.ga&&Xg.a.jva()&&n.ga.gya(Object(Kc.a)(this,this.uh,"onActiveCellChanged"))}this.naa&&(te.g(this.$).zc.Qs(Object(Kc.a)(this,this.Zk,"onEditEnded")),this.UBa.xTi(Object(Kc.a)(this,this.Ijf,"onArgumentAssistanceDismissClick")));this.P7.jTi(Object(Kc.a)(this,this.Rjf,"onAutoCompleteCommitValueIntoCell"));this.functionInfoManager&&this.functionInfoManager.cnc(Object(Kc.a)(this,this.onFunctionInfoLoaded,"onFunctionInfoLoaded"));
Ff.a.Ia(this.UBa);Ff.a.Ia(this.P7);this.P7=this.UBa=this.functionInfoManager=this.$=null};P.prototype.tYi=function(){this.pLa=-1;this.qLa=null};P.prototype.zla=function(n){var O=this;if(27!==(void 0===n?0:n)){if(this.c3a&&(Gc.instance.Llb.formulaAssistanceRequestAttemptedCounter++,!this.Fdj())){Gc.instance.Llb.formulaAssistanceRequestOptimizedCounter++;return}this.functionInfoManager.k4||this.functionInfoManager.$pb({});var da=te.g(this.$).Ej;n=da.text;da=da.textBox.caretPosition;!this.naa||this.QPa?
this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance(Object.assign(new ea,{functionSuggestion:Object.assign(new ha,{content:n,caretPosition:da}),argumentAssistance:Object.assign(new Ta,{content:n,caretPosition:da})})).then(function(l){l.kind||(l.payload.argumentAssistance&&te.g(O.$).Ej.isEditing?(O.Kzb&&O.G4&&Rc.ULS.sendTraceTag(537518999,0,15,"FormulaAssistanceControl.AssistFormulaDraw RequestArgumentAssistance called after lastNotifyActiveCellChangedFailed"),O.UBa.show(l.payload.argumentAssistance,
te.g(O.$).Ej.textBox.domElement)):O.UBa.dismiss(),l.payload.functionSuggestion&&te.g(O.$).Ej.isEditing?O.P7.show(l.payload.functionSuggestion):O.P7.dismiss());return null}):this.pluginScheduler.requester().functionSuggestion(Object.assign(new ha,{content:n,caretPosition:da})).then(function(l){l.kind||(l.payload&&0<l.payload.items.length?O.P7.show(l.payload):O.P7.dismiss());return null})}};P.prototype.Xh=function(){this.zla();return!1};P.prototype.Fdj=function(){var n=te.g(this.$).Ej,O=n.text;n=n.textBox.caretPosition;
if(this.P7.get_visible()&&mf.a.equals(O,this.qLa,!0)&&n===this.pLa)return!1;this.qLa=O;this.pLa=n;return!0};P.prototype.QEd=function(){this.pluginScheduler.requester().runExperiment(new ba)};P.prototype.uh=function(){te.g(this.$).isEditing||te.g(this.$).wi||this.Jzb()};P.prototype.Jzb=function(){var n=te.g(this.$).ga.ya.activeCell;if(n){var O=this.calcManager.Gra(n);if(O){var da=this.$.Aa,l=O.sheet.index;fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5726798_FixNotifyActiveCellChangedSheetIDAccess")&&
(0>=da.count||0>l||l>=da.count)?(Rc.ULS.sendTraceTag(537518996,0,15,"FormulaAssistanceManager.NotifyActiveCellChanged InvalidSheetIndex. sheetCount: {0} sheetIndex: {1}.",da.count,l),this.G4=!0):(this.G4=!1,l=da=null,this.Kzb&&void 0!==this.calcManager&&null!==this.calcManager&&(n=te.g(this.$).Ha.Hr(n))&&(n=this.calcManager.v$c(n.numberFormatIndex),void 0!==n&&null!==n&&(da=n.FormatString,l=n.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new oa,{colIndex:O.range.col,rowIndex:O.range.row,
sheetIndex:this.$.Aa.getItem(O.sheet.index).sheetId,docName:O.sheet.document.name,docPath:O.sheet.document.path,formatString:da,builtIn:l})))}else Rc.ULS.sendTraceTag(537518997,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null"),this.G4=!0}else Rc.ULS.sendTraceTag(537518998,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged active cell range is null"),this.G4=!0};P.prototype.onFunctionInfoLoaded=function(){this.qyj();this.zla()};P.prototype.qyj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.r6b)};
P.prototype.jfd=function(){te.g(this.$).ga.mqa(Object(Kc.a)(this,this.uh,"onActiveCellChanged"));this.Jzb();this.QEd();this.P7.Grg(Object(Kc.a)(this,this.Rjf,"onAutoCompleteCommitValueIntoCell"));this.zla()};P.prototype.Ijf=function(){this.QPa=!1};P.prototype.Rjf=function(){this.zla()};P.prototype.Zk=function(){this.QPa=!0};Jl.Object.defineProperties(P.prototype,{XHa:{configurable:!0,enumerable:!0,get:function(){return this.P7}},cMe:{configurable:!0,enumerable:!0,get:function(){return this.UBa}}});
Object(hd.a)(P,"FormulaAssistanceManager",null,[359,7]);var Dh=Sc.a;Cm(L,Dh);L.prototype.create=function(){var n=this,O=Xg.a.jva(),da=fd.EwaSettings.ka(389),l=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),K=Xg.a.oZ(this.$),ka=this.$.ea,$a=K?ug.Task.Ua(null):Nf.GetServiceTaskFactory.create(ka,134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),Lb=K?ug.Task.Ua(null):Nf.GetServiceTaskFactory.Xa(this.$.ea,12,477,this.vb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");
var bc=fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin",!1)?Nf.GetServiceTaskFactory.create(this.$.ea,449,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceUIControl"):ug.Task.Ua(null);var Dc=fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5544050_PluginSchedulerDependency")&&Xg.a.jva()?Nf.GetServiceTaskFactory.create(this.$.ea,414,this.$.ma,1,"Microsoft.Office.Excel.WebUI.Client.IPluginScheduler"):ug.Task.Ua(null);if(l||
O){var wd=Nf.GetServiceTaskFactory.Xa(ka,266,265,this.vb,"Microsoft.Office.Excel.WebUI.Client.Calc.ICalcManager"),ke=Nf.GetServiceTaskFactory.Xa(ka,219,220,this.vb,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceReadoutHandler");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([wd,Dc,bc,ke],this.ma),function(){var Xf=ka.Ea(19,void 0)||new nc(n.$,Dc.result),Sf=ke.result;if(K){var xg=ka.Ea(464,void 0);xg||(xg=new P(n.$,Xf,wd.result,Dc.result,bc.result),Sf.BRc(xg.cMe),Sf.CRc(xg.XHa))}else xg=
ka.Ea(221,void 0),xg||(xg=new R(n.$,Xf,$a.result,wd.result,null,Lb.result,bc.result,Dc.result),Sf.BRc(xg.dMe),Sf.$je(xg.xMe),Sf.CRc(xg)),da&&(ka.Ea(317,void 0)||new ec(n.$));n.Jb(Xf)},this.ma,3)}else{var jf=Nf.GetServiceTaskFactory.Xa(ka,219,220,this.vb,"Microsoft.Office.Excel.WebUI.Client.FormulaAssistance.IFormulaAssistanceReadoutHandler");fe.TaskExtensions.Da(fe.TaskExtensions.Fe([jf,bc,Dc],this.ma),function(){var Xf=ka.Ea(19,void 0)||new nc(n.$,Dc.result),Sf=jf.result,xg=ka.Ea(221,void 0);xg||
(xg=new R(n.$,Xf,$a.result,null,null,Lb.result,bc.result,Dc.result),Sf.BRc(xg.dMe),Sf.$je(xg.xMe),Sf.CRc(xg));da&&(ka.Ea(317,void 0)||new ec(n.$));n.Jb(Xf)},this.ma,3)}};L.la=function(n){n.ea.La(153,new L(n))};Object(hd.a)(L,"FunctionInfoManagerFactory",Sc.a,[]);var vi=b(192),Gi=b(74),zi=b(117);Y.prototype.VPe=function(){return zi.a(cg.a.Ta,this.startTime)};Object(hd.a)(Y,"OngoingAction",null,[]);var ij=Gi.a;Cm(fa,ij);fa.prototype.yCb=function(n){Rc.ULS.sendTraceTag(39913249,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
this.cka,this.Xua,this.Z2a);this.Skb=this.Pmg.Qkb(n,this.Skb);this.Jfd()};fa.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.wEb(Object(Kc.a)(this,this.Pwa,"onDocumentUnhidden"));this.goe();ij.prototype.dispose.call(this)};fa.prototype.gPf=function(n){this.kTc?(this.TMa=n?new Y:null,n?this.startTimer():this.goe()):this.TMa=n?{}:null};fa.prototype.IKe=function(n){n=void 0===n?null:n;this.kTc&&n&&n.EJ?Rc.ULS.sendTraceTag(554971843,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",
this.cka):(Rc.ULS.sendTraceTag(39913250,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.cka,this.Xua,this.Z2a),this.gPf(!1),this.Jfd())};fa.prototype.kyi=function(){var n=this.TMa.VPe();Rc.ULS.sendTraceTag(554971842,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",this.cka,n);n=Math.max(this.Hme-n,0);this.Gjc=Ec.a.instance.create(Object(Kc.a)(this,this.Nka,"onTimeout"),n,Xc.a.Jbe)};fa.prototype.Nka=
function(){Rc.ULS.sendTraceTag(554971841,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",this.cka,this.TMa.VPe(),this.Z2a);this.lTc++;this.lTc>this.Gme&&Rc.ULS.sendTraceTag(554971840,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",this.cka);this.TMa.Yw.C();this.IKe()};fa.prototype.Pwa=function(){this.Z2a&&Rc.ULS.sendTraceTag(593376847,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
this.cka,this.Xua,this.Z2a);this.Jfd()};fa.prototype.Jfd=function(){var n=this;if(!this.WPa()){var O=this.Skb;this.Skb=null;this.gPf(!0);Rc.ULS.sendTraceTag(39913251,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.cka);var da=this.kTc?this.TMa.Yw.token:vi.a.none;fe.TaskExtensions.Da(this.Omg.xCb(O),function(){n.IKe(da)},da,0,this.HN)}};fa.prototype.WPa=function(){return!this.Z2a||this.Xua?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.mj?(Rc.ULS.sendTraceTag(593376846,
0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.cka),!0):!1};fa.prototype.goe=function(){this.Gjc&&this.Gjc.cancel()};fa.prototype.startTimer=function(){this.lTc<=this.Gme&&(this.Gjc=Ec.a.instance.create(Object(Kc.a)(this,this.kyi,"onRunningLong"),this.OFg,Xc.a.Jbe))};Jl.Object.defineProperties(fa.prototype,{Xua:{configurable:!0,enumerable:!0,get:function(){return!!this.TMa}},Z2a:{configurable:!0,enumerable:!0,get:function(){return!!this.Skb}}});
Object(hd.a)(fa,"ActionAggregator",Gi.a,[417,7]);var ii=b(124),Ih=qi.a;Cm(T,Ih);T.prototype.Tsg=function(n){this.addHandler("KBIS",n)};T.prototype.jUi=function(n){this.removeHandler("KBIS",n)};T.prototype.dispose=function(){this.firstElement&&Bd.a.removeHandler(this.firstElement,Ve.a.focus,Object(Kc.a)(this,this.Omf,"onFirstElementFocused"));this.$r&&this.$r.detach("focus");this.lo&&(Bd.a.removeHandler(this.lo,Ve.a.focus,Object(Kc.a)(this,this.Eof,"onLastElementFocused")),Bd.a.removeHandler(this.lo,
Ve.a.blur,T.onBlur),Qj.KeyInputManager.instance.Ca(Ve.a.Rb,this.lo,Object(Kc.a)(this,this.Fof,"onLastElementKeyDown")));Qj.KeyInputManager.instance.Ca(Ve.a.Rb,this.$.domElement,Object(Kc.a)(this,this.juf,"onWorkbookKeyDown"));this.$r=this.lo=this.firstElement=this.$=null;Ih.prototype.dispose.call(this)};T.prototype.XTg=function(){this.Ybj?(this.firstElement=document.documentElement,this.$r=ii.a.instance.VB(document.parentWindow),this.$r.la("focus",Object(Kc.a)(this,this.EBi,"onWindowFocused"))):(this.firstElement=
T.cve(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Bd.a.addHandler(this.firstElement,Ve.a.focus,Object(Kc.a)(this,this.Omf,"onFirstElementFocused")))};T.prototype.VUg=function(){this.lo=T.cve();this.lo.id=ub.a.dCe;this.lo.setAttribute(ub.a.Av,Sd.a.instance.da(824));document.body.appendChild(this.lo);Bd.a.addHandler(this.lo,Ve.a.focus,Object(Kc.a)(this,this.Eof,"onLastElementFocused"));Bd.a.addHandler(this.lo,Ve.a.blur,T.onBlur);Qj.KeyInputManager.instance.qa(Ve.a.Rb,
this.lo,Object(Kc.a)(this,this.Fof,"onLastElementKeyDown"))};T.prototype.Fof=function(n){var O=n.Ga.keyCode;return O===yd.a.Vh?this.jri():O===yd.a.hB&&n.Ga.shiftKey?this.kjh(this.firstElement):!1};T.prototype.kjh=function(n){this.a_f(n);return!1};T.prototype.jri=function(){this.xKa=!0;te.g(this.$).focus();te.g(this.$).ga.BXe();this.raiseEvent("KBIS");return!0};T.prototype.juf=function(n){var O=this;if(!this.xKa||n.Ga.keyCode!==yd.a.LK)return!1;T.k_e();ug.Task.delay(1).CWRCC(function(){O.lo.focus();
return!0},this.ma);return!0};T.prototype.EBi=function(){var n=this;document.activeElement&&document.activeElement.id===this.lo.id||(T.k_e(),ug.Task.delay(1).CWRCC(function(){n.lo.focus();return!0},this.ma))};T.prototype.Omf=function(){this.a_f(this.lo)};T.prototype.Eof=function(n){n.stopPropagation();n.preventDefault();this.xKa&&(this.xKa=!1)};T.prototype.a_f=function(n){this.xKa?this.xKa=!1:(this.xKa=!0,n&&n.focus())};T.cve=function(){var n=document.createElement("div");n.tabIndex=0;return n};T.k_e=
function(){Sys.UI.DomElement.addCssClass(document.body,Df.a.BEe)};T.onBlur=function(){Sys.UI.DomElement.removeCssClass(document.body,Df.a.BEe)};Object(hd.a)(T,"EmbedViewFocusControl",qi.a,[420,7]);var Uh=b(59),oi=b(528),wi=qi.a;Cm(N,wi);N.prototype.iPc=function(n){this.addHandler("FieldInfoListContextLoaded",n)};N.prototype.WBd=function(n){this.removeHandler("FieldInfoListContextLoaded",n)};N.prototype.dispose=function(){this.wb=null;this.aoc();wi.prototype.dispose.call(this)};N.prototype.D3=function(n,
O,da,l){l=void 0===l?null:l;if(n){this.hUc();var K=null,ka=!1,$a;if($a=!l)$a=this.Bsj(n,O,da),ka=$a.nCb,K=$a.Al,$a=$a.returnValue;if($a&&(K&&Rc.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",K.length),this.PGc=!0,(this.Q0=K)&&0<this.Q0.length&&(this.DPb=!0,this.rAf()),!ka))return;this.M2f(n,l,O,da,!1)}};N.prototype.M2f=function(n,O,da,l,K){if(this.$.fa.pc){this.$.Zb&&(this.kFb=this.$.Zb.Ic("WebServiceCall","GetRichValueFieldInfoListContext"));this.lsb=null;
var ka=this.$.ra.xa.dc(),$a=this.$.ra.xa,Lb=Object(Kc.a)(this,this.Esi,"onGetFieldListContextListSucceeded"),bc=Object(Kc.a)(this,this.Dsi,"onGetFieldListContextListFailed"),Dc=$a.Ra(1,null);Dc.selectedRange=n;Dc.richValueKeyPath=O;Dc.singleColumn=da;Dc.searchForRange=l;Dc.calculateMajorityDataType=K;this.lsb=nf.i($a,"GetRichValueFieldListContextList",Dc,Lb,bc,null,ka,4)}else this.Q0=null};N.prototype.aoc=function(){this.Q0=null;this.DPb=!1;this.hUc();this.lsb=null};N.prototype.hUc=function(){N.IYb(this.lsb)};
N.prototype.rAf=function(){this.raiseEvent("FieldInfoListContextLoaded")};N.prototype.fo=function(n){n=jg.D(n);--n.left;--n.right;return this.tableManager.fo(n)};N.prototype.Bsj=function(n,O,da){var l=null;var K=!1;if(n.SheetName!==this.$.fa.sa.sheetName)return{returnValue:!1,nCb:K,Al:l};if(da){var ka=this.fo(n);if(!ka||!ka.xua)return{returnValue:!1,nCb:K,Al:l};ka.top+=1;ka.right=jg.D(n).right-1}else ka=new oi.AutofilterRange(n.FirstRow+1,n.FirstColumn+1,n.LastRow+1,n.LastColumn+1,null,null,null,
0,!1);if(ka.top>ka.bottom||ka.left>ka.right)return{returnValue:!0,nCb:K,Al:l};n=te.g(this.$);var $a=n.$a.width,Lb=n.$a.height,bc=n.view.visibleArea;$a=new Uh.a(bc.x-$a,bc.y-Lb,bc.width+$a,bc.height+Lb);Lb=n.Mg(ka);if(!bc||!Lb||!n.Wcc(ka))return{returnValue:!1,nCb:K,Al:l};$a.contains(Lb)||(K=!0);n=ka.clone();if(da)for(da=ka.right,bc=0;da>=ka.left;--da){if(n.left=da,n.right=da,$a=this.jQe(n,!0,ka.left)){l||(l=[]);l[bc]=$a;if(O)break;++bc}}else if(O=this.jQe(n,!1))l=[],l[0]=O;return{returnValue:!0,nCb:K,
Al:l}};N.prototype.jQe=function(n,O,da){da=void 0===da?0:da;var l=te.g(this.$).kc.OGh(n),K=null;if(l&&0<l.count){var ka=Array(l.count);K=0;l=Ml(l);for(var $a=l.next();!$a.done;$a=l.next()){var Lb={};Lb.Name=$a.value;ka[K]=Lb;++K}l="";$a=-1;0<n.top&&O&&(n=new ui.Range(n.top-1,n.left,n.top-1,n.left,!1,!1),l=te.g(this.$).Cc(n).originalText,$a=n.left-da);K={};K.ColumnName=l;K.ColumnIndex=$a;K.FieldInfoDataList=ka}return K};N.prototype.Dsi=function(n,O,da){Rc.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
da);this.kFb&&this.kFb.stop();this.Q0=null};N.prototype.Esi=function(n){Cf.a(n)||(this.kFb&&this.kFb.stop(),this.PGc=!1,(this.Q0=n.Result)&&0<this.Q0.length&&Rc.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",this.Q0.length),this.DPb=!0,this.rAf())};N.IYb=function(n){n&&Ee.AFrameworkApplication.Md.gv(n.ou)};Jl.Object.defineProperties(N.prototype,{Lbc:{configurable:!0,enumerable:!0,get:function(){return this.DPb}},hbi:{configurable:!0,enumerable:!0,get:function(){return this.PGc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Al:{configurable:!0,enumerable:!0,get:function(){return this.Q0}},gzh:{configurable:!0,enumerable:!0,get:function(){return!!this.lsb}}});Object(hd.a)(N,"FieldInfoManager",qi.a,[375,7]);Cm(S,N);S.prototype.qzh=function(n,O){this.c_a=O;Rc.ULS.sendTraceTag(41756254,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",n.FirstRow,n.FirstColumn,
n.LastRow,n.LastColumn);this.M2f(n,null,!0,!1,!0)};S.prototype.Hmf=function(){this.WBd(Object(Kc.a)(this,this.Hmf,"onFilterFieldInfoListContextLoaded"));if(this.Al&&this.Al.length&&this.contextMenuManager){var n=this.contextMenuManager.G8c("autoFilterRichFieldList"),O=window.document.getElementById(this.c_a);n.AN(null,O,this,null,!0)}};Jl.Object.defineProperties(S.prototype,{bG:{configurable:!0,enumerable:!0,get:function(){return this.W9f}}});Object(hd.a)(S,"FilterInfoManager",N,[416,375,7]);W.Cdh=
"ewa-sharedUi-launchButton";W.Edh="ewa-sharedUi-launchButtonWithText";W.Ddh="ewa-sharedUi-launchButtonClick";W.Fdh="ewa-sharedUi-launchButtonWithTextClick";Object(hd.a)(W,"CssClassNames",null,[]);var Ni=b(279),jj=Te.a;Cm(H,jj);H.prototype.C1=function(n){this.addHandler(this.GCb,n)};H.prototype.jca=function(n){this.get_events().removeHandler(this.GCb,n)};H.prototype.jtg=function(n){this.addHandler("OnObjectButtonMouseOver",n)};H.prototype.zUi=function(n){this.get_events().removeHandler("OnObjectButtonMouseOver",
n)};H.prototype.itg=function(n){this.addHandler("OnObjectButtonMouseOut",n)};H.prototype.yUi=function(n){this.get_events().removeHandler("OnObjectButtonMouseOut",n)};H.prototype.W1f=function(n){mf.a.na(n)||(this.GXa.innerHTML=n)};H.prototype.Jvj=function(n,O,da){this.GXa.innerHTML="";n?n.haa(O,16,16,this.GXa,16,16,void 0,da):Rc.ULS.sendTraceTag(574681090,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};H.prototype.Kvj=function(n,O){mf.a.na(n)||(this.pJb.innerText=n);this.domElement.title=
O};H.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.tc.ZB(),Ff.a.rc([this.yY,this.yXa]),Jf.a.instance.Ca(Ve.a.click,this.domElement,Object(Kc.a)(this,this.Yc,"onClick")),Yj.a.instance.Ca(Ve.a.pointerDown,this.domElement,Object(Kc.a)(this,this.MM,"onElementPointerDown")),this.eQa&&this.eQa.dispose(),jj.prototype.dispose.call(this))};H.prototype.u9a=function(){mf.a.na(this.AZb)||Sys.UI.DomElement.removeCssClass(this.domElement,this.AZb);mf.a.na(this.ahc)||Sys.UI.DomElement.addCssClass(this.domElement,
this.ahc)};H.prototype.FCb=function(){mf.a.na(this.ahc)||Sys.UI.DomElement.removeCssClass(this.domElement,this.ahc);mf.a.na(this.AZb)||Sys.UI.DomElement.addCssClass(this.domElement,this.AZb);this.q_a()};H.prototype.q_a=function(){this.pdc&&(this.eQa.cancel(),this.fWf(),this.setOpacity(1));this.set_visible(!0)};H.prototype.Ln=function(n,O,da,l,K){K=void 0===K?!1:K;n=ze.a(l).Ci(n);O=ze.a(l).Ci(O);ze.a(l).Mqc(this.domElement);this.domElement.style.top=Z.HelperMethods.Ub(O);this.domElement.style.left=
this.domElement.style.right="";O=n;K&&(O=n-this.domElement.offsetWidth);wk.b(this.domElement.style,da,Z.HelperMethods.Ub(O));this.set_visible(!0);this.setOpacity(1);this.pdc&&(this.TKd=!1,this.Rkj(),this.eQa.Zq())};H.prototype.hide=function(){this.u9a();this.set_visible(!1);this.pdc&&(this.fWf(),this.eQa.cancel())};H.prototype.Wpb=function(){this.tc.la("mouseover",Object(Kc.a)(this,this.QE,"onMouseOver"),!0);this.tc.la("mouseout",Object(Kc.a)(this,this.uH,"onMouseOut"),!0)};H.prototype.Rkj=function(){this.yY.qA("mousemove")||
this.yY.la("mousemove",Object(Kc.a)(this,this.Owa,"onDocumentMouseMove"))};H.prototype.fWf=function(){this.yY.qA("mousemove")&&this.yY.detach("mousemove")};H.prototype.ecd=function(n){if(this.domElement.parentNode){var O=Sys.UI.DomElement.getBounds(this.domElement),da=new Sys.UI.Point(Math.round(O.x+O.width),Math.round(O.y+O.height));O=Math.abs(da.x-n.x);n=Math.abs(da.y-n.y);n=O>n?O:n;this.TKd?this.setOpacity(H.OGg(n)):100>=n&&this.Xbe()}};H.prototype.Xbe=function(){this.TKd=!0;this.eQa.cancel()};
H.prototype.QE=function(){this.raiseEvent("OnObjectButtonMouseOver")};H.prototype.uH=function(){this.raiseEvent("OnObjectButtonMouseOut")};H.prototype.setOpacity=function(n){Tg.a.setOpacity(this.domElement,n);this.O$e=cg.a.Ta.Lb};H.prototype.Zhj=function(){this.Xbe()};H.prototype.Yc=function(n){this.raiseEvent(this.GCb,n);this.FCb();return!0};H.prototype.Owa=function(n){100<zi.a(cg.a.Ta,this.O$e)&&this.ecd(new Sys.UI.Point(Math.round(n.clientX),Math.round(n.clientY)))};H.prototype.MM=function(n){Sh.g(n.Ga,
!1);return!1};H.OGg=function(n){return 100>=n?1:250<=n?0:.01*(100-(n-100)/150*100)};Object(hd.a)(H,"OnObjectButton",Te.a,[400,96,7]);var Bj=b(906),Fj=Gi.a;Cm(C,Fj);C.prototype.dispose=function(){this.T3g();this.$=null;Fj.prototype.dispose.call(this)};C.prototype.getButton=function(n,O){return this.Gta(n,void 0===O?!0:O)};C.prototype.Gta=function(n,O){var da=n.toString();da in this.buttons||this.XUg(n,void 0===O?!0:O);return this.buttons[da]};C.prototype.Ln=function(n,O,da,l,K,ka){K=void 0===K?!0:
K;ka=void 0===ka?!1:ka;this.hide();if(this.$.fa.isNamedObjectViewMode&&Zf.i(this.$.sa)){var $a=te.g(this.$).oN.domElement,Lb=n+this.buttonWidth-$a.scrollWidth;$a=O+this.buttonWidth-$a.scrollHeight;n=0<Lb?n-Lb:n;O=0<$a?O-$a:O}this.Gta(l,K).Ln(n,O,da,this.$,ka)};C.prototype.hide=function(){var n=this.buttons,O;for(O in n)n[O].hide()};C.prototype.Wpb=function(n,O){!this.N_e&&(O=this.buttons[O.toString()])&&(this.zgc=function(da,l){n(l,!0)},O.jtg(this.zgc),this.ygc=function(da,l){n(l,!1)},O.itg(this.ygc),
this.N_e=!0,O.Wpb())};C.prototype.XUg=function(n,O){function da(ka,$a){l.upi($a,n)}var l=this;this.Oua=String.format(this.ied===Df.a.i4b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ah.a.gg(this.ied),ah.a.gg(this.hed),"{0}");var K=String.format(this.Oua,ah.a.gg(this.altText));O=new H(""===this.buttonText?W.Cdh:W.Edh,""===this.buttonText?W.Ddh:W.Fdh,Df.a.MB,K,O,this.GCb,this.buttonText,
"ewa-sharedUi-launchButtonText");O.C1(da);this.buttons[n.toString()]=O;this.SDe[n.toString()]=da;K=te.g(this.$).Yf(n);K.domElement.insertBefore(O.domElement,K.domElement.firstChild)};C.prototype.T3g=function(){for(var n=Ml(Bj.a(this.buttons)),O=n.next();!O.done;O=n.next()){O=O.value;var da=this.buttons[O];da.jca(this.SDe[O]);Ff.a.Ia(da);delete this.buttons[O];this.zgc&&da.zUi(this.zgc);this.ygc&&da.yUi(this.ygc)}};C.prototype.domElement=function(n){return this.Gta(n).domElement};C.prototype.q_a=function(n){this.Gta(n).q_a()};
C.prototype.KKb=function(n,O,da){da=void 0===da?!0:da;this.Oua=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ah.a.gg(this.ied),ah.a.gg(this.hed),"{0}");n=String.format(this.Oua,ah.a.gg(n));this.Gta(O,da).W1f(n)};C.prototype.yRa=function(n,O,da){this.Gta(da,!1).Kvj(n,O)};C.prototype.K2f=function(){var n=void 0===n?!1:n;this.Oua=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",ah.a.gg(this.hed),"{1}");var O=String.format(this.Oua,void 0,ah.a.gg(void 0));this.Gta(void 0,n).W1f(O)};C.prototype.uQd=function(n,O,da){this.Gta(da,!1).Jvj(this.svgIconProvider,n,O)};Jl.Object.defineProperties(C.prototype,{Gs:{configurable:!0,enumerable:!0,get:function(){return ze.a(this.$).pEa(xh.a.Bwi)}},eZb:{configurable:!0,enumerable:!0,get:function(){return xh.a.Awi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return ze.a(this.$).pEa(xh.a.Cwi)}}});Object(hd.a)(C,"OnObjectLaunchButton",
Gi.a,[379,7]);var nj=b(83),ck=nj.a;Cm(B,ck);B.prototype.dispose=function(){Ff.a.Ia(this.oyb);this.oyb=null;ck.prototype.dispose.call(this)};B.prototype.nza=function(){Ff.a.Ia(this.oyb);this.oyb=Ec.a.instance.create(Object(Kc.a)(this,this.display,"display"),this.wTh,Xc.a.lbi)};B.prototype.zQa=function(){Ff.a.Ia(this.oyb);this.hide()};Object(hd.a)(B,"LoadingIndicatorBehavior",nj.a,[399,7]);Cm(J,B);J.prototype.dispose=function(){this.nyb=null;B.prototype.dispose.call(this)};J.prototype.display=function(){this.qbg(this.nyb)};
J.prototype.hide=function(){this.OQh(this.nyb)};J.prototype.$og=function(){this.nyb=document.createElement("div");this.domElement.appendChild(this.nyb)};Object(hd.a)(J,"ShimmerLoadingIndicatorBehavior",B,[]);Cm(z,B);z.prototype.dispose=function(){this.HLa=null;B.prototype.dispose.call(this)};z.prototype.display=function(){je.DOMElementExtensions.setVisible(this.HLa,!0)};z.prototype.hide=function(){je.DOMElementExtensions.setVisible(this.HLa,!1)};z.prototype.Zog=function(){this.HLa=document.createElement("div");
Sys.UI.DomElement.addCssClass(this.HLa,Rj.a.ych);var n=document.createElement("div");Sys.UI.DomElement.addCssClass(n,Rj.a.zch);this.Ywe&&Sys.UI.DomElement.addCssClass(n,this.Ywe);var O=this.Fbf?Sd.a.instance.da(this.Fbf):"",da=String.format('<div class="'+Rj.a.Ach+'">{0}</div>',O);this.dac?(O=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.dac,O),n.innerHTML=O+da):n.innerHTML=da;this.HLa.appendChild(n);this.domElement.appendChild(this.HLa)};Object(hd.a)(z,"SpinnerLoadingIndicatorBehavior",
B,[]);x.prototype.rZc=function(n,O,da){return new Ai.a(n,O,da)};x.prototype.x0b=function(n,O,da,l,K,ka,$a,Lb,bc,Dc){return new Qa(n,O,da,l,K,ka,$a,Lb,bc,Dc)};x.prototype.aZa=function(n,O,da,l,K){return new z(n,O,da,l,void 0===K?0:K)};x.prototype.E$c=function(n){return n.ea.Ea(238,void 0)||new T(n)};x.prototype.qob=function(n,O,da,l,K,ka,$a,Lb){return new C(n,O,da,l,K,ka,$a,void 0===Lb?"":Lb)};x.prototype.ave=function(n,O){return new N(n,O)};x.prototype.TTg=function(n,O,da,l){return new S(n,O,da,l)};
x.prototype.bob=function(n,O,da,l){return new fa(n,O,da,l)};Object(hd.a)(x,"SharedUIControlsFactory",null,[356]);var Sj=Sc.a;Cm(y,Sj);y.prototype.create=function(){fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?this.Jb(this.$.ea.Ea(12,void 0)||new x):this.Jb(new x)};y.la=function(n){n.ea.La(477,new y(n))};Object(hd.a)(y,"SharedUIControlsFactoryServiceFactory",Sc.a,[]);var Di=b(1008),Bi=Sc.a;Cm(A,Bi);A.prototype.create=function(){var n=this;Rc.ULS.sendTraceTag(574382426,
0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");Di.a.then(this.uWg(),function(O){n.Jb(O);return!0})};A.prototype.uWg=function(){var n=this;if(this.zZc)return this.zZc;var O=ra.a.dZa($d.b(),vi.a.none,"LoadResource","x10Scheduler loading");fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Tg.a.Iu?O.setResult(excelOnlineCalc.PluginSchedulerSingletonGlobal.instance()):this.$.ea.ub(266,function(){n.$.ea.ub(283,function(da){var l=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
da=Ie.b(ug.Task.Ua(da.xq));var K=excelOnlineCalc.x10.ensurePluginAttached(1,da),ka=excelOnlineCalc.x10.ensurePluginAttached(5,da),$a=excelOnlineCalc.x10.ensurePluginAttached(1E3,da),Lb=excelOnlineCalc.x10.ensurePluginAttached(1002,da),bc=excelOnlineCalc.x10.ensurePluginAttached(10,da),Dc=excelOnlineCalc.x10.ensurePluginAttached(11,da);K=[K,ka,$a,Lb,bc,Dc];fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(da=excelOnlineCalc.x10.ensurePluginAttached(1003,da),K.push(da));
Promise.all(K).then(function(){n.$.ea.La(413,l);O.setResult(l)})})});return this.zZc=O.task};A.la=function(n){n.ea.La(414,new A(n))};Object(hd.a)(A,"PluginSchedulerFactory",Sc.a,[]);var jk=Gi.a;Cm(v,jk);v.prototype.dispose=function(){this.ck.dispose();this.$=null;jk.prototype.dispose.call(this)};v.prototype.domElement=function(n){return this.ck.domElement(n)};v.prototype.getButton=function(n){return this.ck.getButton(n,!1)};v.prototype.KKb=function(n,O){this.ck.KKb(n,O,!1)};v.prototype.x6=function(n,
O){var da=te.g(this.$),l=da.$a.fk(n);this.ck.KKb(O?Sd.a.instance.da(1663):Sd.a.instance.da(1664),l);O=this.isMac?O?Sd.a.instance.da(1667):Sd.a.instance.da(1668):O?Sd.a.instance.da(1665):Sd.a.instance.da(1666);var K=da.Mg(n,l);n=da.Yf(l).pn;if(K&&0<=K.x&&0<=K.y){var ka=K.bottomRight.x+this.Gs;K=K.topLeft.y-this.Gs-this.buttonWidth;if(K<n.topLeft.y+this.Gs){if(da.$a.Mza){this.hide();return}K=n.topLeft.y+this.Gs}this.Ln(ka,K,da.rtl,l);this.ariaLiveNotifier.PNa(O)}else this.hide()};v.prototype.Ln=function(n,
O,da,l){this.ck.Ln(n,O,da,l,!1)};v.prototype.hide=function(){this.ck.hide()};Jl.Object.defineProperties(v.prototype,{Gs:{configurable:!0,enumerable:!0,get:function(){return this.ck.Gs}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.ck.buttonWidth}}});Object(hd.a)(v,"PulloutLaunchButton",Gi.a,[]);var Mk=Gi.a;Cm(w,Mk);w.prototype.dispose=function(){this.gridView&&(this.gridView.ga.nca(Object(Kc.a)(this,this.Ih,"onSelectionEnded")),this.gridView.view.Tr(Object(Kc.a)(this,this.qq,
"onGridScroll")),this.gridView.Hc&&this.gridView.Hc.mm(Object(Kc.a)(this,this.tk,"onEditStarted")));if(this.$){var n=this.$;n.nl(Object(Kc.a)(this,this.sd,"onWorkbookOpened"));n.Xo(Object(Kc.a)(this,this.Yd,"onWorkbookClosing"));n.AH(Object(Kc.a)(this,this.kk,"onContentAreaResized"));te.g(n).Ps(Object(Kc.a)(this,this.KQ,"onGridContentReady"))}this.dm&&this.dm.WBd(Object(Kc.a)(this,this.FAb,"onFieldInfoListContextLoaded"));Ff.a.Ia(this.Gg);this.dm=this.$=this.gridView=this.ylb=this.Gg=null;Mk.prototype.dispose.call(this)};
w.prototype.Tv=function(){this.Gg.hide()};w.prototype.vca=function(){this.Gg?this.Gg.getButton(this.yda).u9a():Rc.ULS.sendTraceTag(576245783,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};w.prototype.RYi=function(){this.u_=null};w.prototype.Zyf=function(){this.Gg&&this.Gg.hide()};w.prototype.AKh=function(){if(!this.Kbd||1!==this.selectedRange.width)return null;for(var n=this.selectedRange.clone();this.gridView.vZ(n);){n.left+=1;n.right+=1;if(!this.gridView.Yf(this.gridView.$a.fk(n)).Ph.Of(n))break;
if(this.gridView.Ha.Hr(n)){var O=this.gridView.$m("PulloutManager.GetValidatedRangeToFill",n,2);try{if(w.uAj(O))return n}finally{O&&O.dispose()}}}return null};w.prototype.Ih=function(){this.Yua&&(this.gridView?1===this.gridView.ga.Ze?(this.gridView.ga.ya.activeCell.equals(this.RDa)||this.vM||this.Tv(),this.ylb.Zq()):this.Tv():Rc.ULS.shipAssertTag(40251852,0,!1,"GridView is null during selection"))};w.prototype.tk=function(){this.Tv()};w.prototype.sd=function(){this.nW()};w.prototype.Yd=function(){this.Tv()};
w.prototype.Yc=function(){this.showCallout()};w.prototype.FAb=function(){if(this.dm.Al&&this.dm.Al.length)if(this.hTc)this.dm.hbi||(this.Oyc=this.dm.Al[0].BlockingDataForExpand),this.dm.gzh&&Rc.ULS.sendTraceTag(39367315,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.showCallout();else if(this.gridView.ga.ya.Eh){var n=this.gridView.ga.ya.activeCell;if(n&&this.u_){var O=this.tableManager.fo(n);this.LFc=!!O;var da=this.gridView.ga.ya.Xd;O=this.vM&&this.u_.oe(O);
var l=this.Kbd&&!this.vM&&da.equals(this.selectedRange);O||l?(Rc.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.$4b=!0,fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.vM&&this.tableManager.MIa(n)?Rc.ULS.shipAssertTag(539021527,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.vM?
this.Gg.x6(this.u_,this.vM):this.Gg.x6(da,this.vM):this.Gg.x6(this.u_,this.vM),this.$nc())):Rc.ULS.shipAssertTag(38887757,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};w.prototype.$nc=function(){this.dm.aoc()};w.prototype.showCallout=function(){var n=this;this.Yua&&(this.dm.Lbc?(this.Gg.getButton(this.yda).FCb(),fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?fe.TaskExtensions.Da(Nf.GetServiceTaskFactory.Xa(this.$.ea,8,9,0,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager"),
function(O){n.PSf(O.result)},this.$.ma,3):this.PSf(this.contextMenuManager)):(this.hTc=!0,this.D3()))};w.prototype.PSf=function(n){n.G8c("tableFieldList").AN(null,this.Gg.domElement(this.yda),this.dm,null,!0);this.$nc()};w.prototype.kk=function(){this.P3a()&&this.Gg.hide();1===this.gridView.ga.Ze&&this.nW()};w.prototype.KQ=function(){var n=this.gridView.ga.Ze;this.gridView.ga.ya.activeCell&&1===n&&this.nW()};w.prototype.qq=function(){if(fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.vM){if(this.u_&&
this.RDa){var n=this.tableManager.fo(this.RDa);n&&1<n.bottom-n.top&&(--n.bottom,this.gridView.vZ(n)&&this.ylb.Zq())}}else this.gridView.ga.ya.Eh&&this.gridView.vZ(this.gridView.ga.ya.Xd)&&this.ylb.Zq();else this.u_&&this.RDa&&this.vM&&(n=this.tableManager.fo(this.RDa))&&1<n.bottom-n.top&&(--n.bottom,this.gridView.vZ(n)&&this.ylb.Zq())};w.prototype.nW=function(){if(this.$&&this.gridView){if(this.$4b&&this.vM){var n=this.gridView.ga.ya.activeCell;this.u_=this.yKe();var O=!!this.kpc&&this.kpc.contains(n);
if(this.u_&&(n.equals(this.RDa)||O)){this.Gg.x6(this.u_,this.vM);return}}this.$4b=!1;(this.u_=this.yKe())&&this.Bwa&&this.gridView&&this.gridView.Ha.Hr(this.Bwa)?(this.hTc=!1,this.D3()):this.dm.hUc();this.$4b||this.Gg.hide()}};w.prototype.yKe=function(){if(!this.Yua||!this.gridView||this.gridView.ga.Sa.nc||!this.gridView.ga.ya.Eh)return null;var n=this.gridView.ga.ya.activeCell,O=te.g(this.$).$a.fk(n);if(!n)return null;this.RDa=n.clone();var da=this.tableManager.fo(n);this.LFc=!!da;if(this.vM){this.Gg.KKb(Sd.a.instance.da(1663),
O);this.UN=w.K4f(da);if(!this.UN)return null;O=this.tableManager.aue(da,this.gridView);n=O.VX;O=O.returnValue||n;this.Oyc=n;if(O)return this.kpc=new ui.Range(da.top,da.left,da.bottom,da.right,!1,!1),this.VHc=new ui.Range(this.UN.top,this.UN.right+1,this.UN.top,this.UN.right+1,!1,!1),this.UN}else if(this.Kbd){this.Gg.KKb(Sd.a.instance.da(1664),O);this.dVa=this.gridView.ga.ya.Xd.clone();da=te.g(this.$).kc.SKa(this.selectedRange);this.UN=w.K4f(this.selectedRange);if(!da||!this.UN||!this.selectedRange||
fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.MIa(this.selectedRange))return null;this.VHc=this.AKh();if((fd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.vZ(this.selectedRange):this.gridView.vZ(this.UN))&&this.Bwa)return this.kpc=this.UN,da=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.Bwa?this.Bwa.toString():"null",
this.UN?this.UN.toString():"null",n?n.toString():"null"),Rc.ULS.sendTraceTag(38887759,0,50,da),this.UN}return null};w.prototype.D3=function(){this.vM?this.dm.D3(jg.v(this.Bwa,this.$),!1,!0):fd.EwaSettings.ka(138)&&this.dm.D3(jg.v(this.selectedRange,this.$),!0,!1)};w.prototype.P3a=function(){return this.$.fa.isNamedObjectViewMode&&Zf.f(this.$.sa)};w.uAj=function(n){for(;n.$$mn();)if(!mf.a.na(n.$$cu().text)||n.$$cu().sM||n.$$cu().mj||n.Zn.ZYe)return!1;return!0};w.K4f=function(n){return n.right===xh.a.Qh?
null:new ui.Range(n.top,n.right,n.top,n.right,!1,!1)};Jl.Object.defineProperties(w.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return this.Gg.domElement(1)}},Bwa:{configurable:!0,enumerable:!0,get:function(){return this.VHc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.dVa}},vM:{configurable:!0,enumerable:!0,get:function(){return this.LFc}},Rxb:{configurable:!0,enumerable:!0,get:function(){var n=this.Gg.domElement(this.yda);return n?je.DOMElementExtensions.isVisible(n):
!1}},Yua:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&fd.EwaSettings.ka(138)?!(new oh.a(this.$.Aa)).vj:!1}},tvg:{configurable:!0,enumerable:!0,get:function(){return this.Oyc}},yda:{configurable:!0,enumerable:!0,get:function(){return this.Bwa?this.gridView.$a.fk(this.UN):1}}});Object(hd.a)(w,"PulloutManager",Gi.a,[351,7]);var xk=Sc.a;Cm(u,xk);u.prototype.create=function(){var n=this;Mg.a.Ja(function(O){var da=Nf.GetServiceTaskFactory.Xa(O.ea,12,477,n.vb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory"),
l=Nf.GetServiceTaskFactory.Xa(O.ea,66,134,n.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),K=Nf.GetServiceTaskFactory.Xa(O.ea,211,212,n.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),ka=null,$a=!fd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);$a&&(ka=Nf.GetServiceTaskFactory.Xa(O.ea,8,9,n.vb,"Microsoft.Office.Excel.WebUI.Client.IContextMenuManager"));fe.TaskExtensions.Da(fe.TaskExtensions.Fe([da,l,ka,K],O.ma),function(){$a?n.Jb(n.$.ea.Ea(261,
void 0)||new w(n.$,da.result,l.result,ka.result,K.result)):n.Jb(n.$.ea.Ea(261,void 0)||new w(n.$,da.result,l.result,null,K.result))},O.ma)})};u.la=function(n){n.ea.La(262,new u(n))};Object(hd.a)(u,"PulloutManagerFactory",Sc.a,[]);var Nk=b(381);Object(hd.a)(k,"GestureAdapterInfo",null,[]);var kk=b(370),Rk=b(217);t.prototype.Gai=function(){if(!this.EBc){var n=Ee.AFrameworkApplication.l6(String.format("{0}","hammer.min.js"),5);n=Rk.a.create(n,null,null);kk.a.j3(n);this.EBc=n.o5a}return this.EBc};Jl.Object.defineProperties(t,
{instance:{configurable:!0,enumerable:!0,get:function(){t.Pa||(t.Pa=new t);return t.Pa}}});t.Pa=null;Object(hd.a)(t,"HammerJsDependencyLoader",null,[421]);var lk;(function(n){n[n.none=-1]="none";n[n.pinch=0]="pinch";n[n.pan=1]="pan";n[n.swipe=2]="swipe"})(lk||(lk={}));Object(hd.b)("GestureEvent",lk);var Ii=b(71),Tj=Ii.a;Cm(r,Tj);r.create=function(n,O,da,l,K,ka){if(da.rawEvent)if(ka){var $a=da.rawEvent;$a=new Sys.UI.Point($a.clientX,$a.clientY)}else $a=Ii.a.Yrb(da);else $a=new Sys.UI.Point(da.clientX,
da.clientY);return new r(n,$a,O,da,l,K,da.shiftKey,da.ctrlKey,ka)};Jl.Object.defineProperties(r.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.nfa}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.ZW}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.deb}},Erb:{configurable:!0,enumerable:!0,get:function(){return this.Scg}}});Object(hd.a)(r,"GestureEventArgs",Ii.a,[]);Object(hd.a)(m,"GestureManagerData",null,[]);c.h8f=2;c.i8f=4;
c.j8f=8;c.k8f=8;Object(hd.a)(c,"HammerConstants",null,[]);var Fk=b(190),Kk=Bd.a;Cm(d,Kk);d.prototype.vAh=function(){return this.eJc?0:this.gae?1:2};d.prototype.jn=function(n){Kk.prototype.jn.call(this,n);this.Zd.dja(this.GTa,n,0,this.rhb)};d.prototype.$l=function(n){Kk.prototype.$l.call(this,n);this.Zd.AGa(n,this.GTa)};d.prototype.YPi=function(n,O,da){var l=this;da=void 0===da?null:da;var K=void 0===K?null:K;Ee.AFrameworkApplication.ucc()?t.instance.Gai().continueWith(function(ka){l.blj();if(ka.ng||
ka.Dh)Rc.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",ka.status);else{Rc.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ka.status);if(l.ZVd){ka=window.Hammer;if("undefined"===typeof ka){Rc.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");l.qtc();return}if("undefined"===typeof ka.inputHandler){Rc.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");l.qtc();return}}if(!n)throw l.qtc(),Error.argumentNull("source element can not be null");
ka=Fk.a.Wta(n,l.Foa);if(void 0===ka||null===ka)ka=new Ij.a,Fk.a.C$a(n,l.Foa,ka),l.ZPi(n);var $a=null;if(!ka.tb(lk[0])){$a=Object;var Lb=$a.assign,bc=new k,Dc=lk[0],wd=K;wd=void 0===wd?null:wd;if(void 0===l||null===l)throw Rc.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var ke=null;switch(Dc){case Ve.a.pinch:ke=new Hammer.Pinch(wd);break;case Ve.a.pan:ke=new Hammer.Pan(wd)}ke&&(ke.manager=l);$a=Lb.call($a,bc,{aca:ke,uNe:O});ka.add(lk[0],$a)}if(void 0!==
da&&null!==da)for(Lb=0;Lb<da.length;Lb++)ka.tb(lk[da[Lb]])&&(bc=ka.oa(lk[da[Lb]]),$a.aca.recognizeWith(bc.aca))}l.qtc()}):Rc.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};d.prototype.blj=function(){this.rDc&&(this.rh?this.KLc=this.rh.Ic("Task","RegisterGestureAdapterAfterLoad"):Rc.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.qtc=function(){this.rDc&&(this.KLc?this.KLc.stop():Rc.ULS.sendTraceTag(590387075,
310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};d.prototype.ZPi=function(n){this.Tcg.add(n);this.Zd.dja(this.GTa,n,0,this.rhb)};d.prototype.recognize=function(n){for(var O=Array(n.pointers.length),da=0;da<n.pointers.length;da++)O[da]=n.pointers[da].target;da=null;for(this.aoa=this.GCh(O);void 0!==this.aoa&&null!==this.aoa&&(da=Fk.a.Wta(this.aoa,this.Foa),void 0===da||null===da);this.aoa=this.aoa.parentNode);if(void 0!==da&&null!==da){this.curRecognizer&&this.curRecognizer.state===
c.k8f&&(this.curRecognizer=null);O=Ml(da.keys);for(var l=O.next();!l.done;l=O.next()){l=da.oa(l.value);void 0!==l&&null!==l&&void 0!==l.aca&&null!==l.aca&&(void 0===this.curRecognizer||null===this.curRecognizer||l.aca===this.curRecognizer||l.aca.canRecognizeWith(this.curRecognizer))&&l.aca.recognize(n);var K=l.aca.state;this.curRecognizer||c.h8f!==K&&c.i8f!==K&&c.j8f!==K||(this.curRecognizer=l.aca)}}};d.prototype.emit=function(n,O){if("hammer.input"!==n){this.R7=!1;O=r.create(n,this.aoa,O.srcEvent,
O,3,this.eJc);var da=Fk.a.Wta(this.aoa,this.Foa);if(this.j4h(n))var l=0;else if(this.Z3h(n))l=1;else if(this.K6h(n))l=2;else{Rc.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}da=da.Ec(lk[l]).value;void 0!==da&&null!==da&&((da=da.uNe,da.X1h())?n.endsWith("start")?this.R7=da.ksi(O):n.endsWith("end")?(da.isi(),this.R7=!0):n.endsWith("cancel")?(da.hsi(),this.R7=!0):n.endsWith("move")&&(this.R7=da.jsi(O)):Rc.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",
n))}};d.prototype.get=function(n){return Object(pf.a)(Hammer.Recognizer,n)};d.prototype.GCh=function(n){if(1>n.length)return null;if(1===n.length)return n[0];for(var O=n[0],da=!0,l=1;l<n.length;l++){if(!n[l])return null;if(O!==n[l]){da=!1;break}}if(da)return O;O=this.MNe(n[0]);da=0;n=Ml(n);for(l=n.next();!l.done;l=n.next()){l=this.MNe(l.value);if(O.oa(O.count-1)!==l.oa(l.count-1))return null;for(var K=O.count-2,ka=l.count-2;K>=da&&0<=ka;K--,ka--)if(O.oa(K)!==l.oa(ka)){da=K+1;break}}return O.oa(da)};
d.prototype.MNe=function(n){for(var O=new Aa.a;void 0!==n&&null!==n;n=n.parentNode)O.add(n);return O};d.prototype.qRe=function(n){switch(n){case Ve.a.Hf:case Ve.a.Wqa:return 1;case Ve.a.Og:case Ve.a.PXb:return 2;case Ve.a.Ge:case Ve.a.Ylb:return 4;case Ve.a.Puc:case Ve.a.MSc:return 8}return 0};d.prototype.jxa=function(n,O,da){n=this.qRe(n);O=this.sBh(da);Hammer.inputHandler(this,n,O);this.R7&&da.preventDefault();return this.R7};d.prototype.xYe=function(){return 1<this.lS.count};d.prototype.FYb=function(){Rc.ULS.sendTraceTag(594055960,
310,50,"CancelPendingPointerEvents");if(this.ojb)for(var n=Ml(this.lS),O=n.next();!O.done;O=n.next())this.AEf(O.value.key);else this.lS=new Ij.a;this.session=null};d.prototype.qpg=function(n,O,da){Rc.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",n);if(!this.Khb.tb(n)){try{O.setPointerCapture(n)}catch(l){Rc.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",l)}this.Khb.add(n,O)}this.lS.ja(n,da);this.LSa&&1<this.lS.count&&this.kea&&!this.kea.Emb&&(this.kea.Emb=!0)};
d.prototype.AEf=function(n){Rc.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",n);if(this.Khb.tb(n)){try{this.Khb.oa(n).releasePointerCapture(n)}catch(O){Rc.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",O)}this.Khb.remove(n)}else Rc.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",n);this.lS.remove(n);this.LSa&&1>=this.lS.count&&this.kea&&this.kea.Emb&&(this.kea.Emb=!1)};d.prototype.Wic=function(n,O,da){var l=da.rawEvent.pointerType.toString(),
K=da.rawEvent.pointerId.toString();if("touch"!==l)return!1;n=this.qRe(n);if(1!==n&&!this.lS.tb(K))return!1;this.dWd&&1===n&&da.rawEvent.isPrimary&&this.lS.count&&(Rc.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.FYb());this.ojb?this.qpg(K,O,da):this.lS.ja(K,da);this.VGc&&2===n&&(!this.oAc||this.oAc&&"function"===typeof da.rawEvent.getCoalescedEvents)&&(O=da.rawEvent.getCoalescedEvents())&&this.xYe()&&(this.Sgb=Math.max(this.Sgb,O.length));this.H7d&&(this.R7=!1);l=this.rBh(this.lS,
da,l);Hammer.inputHandler(this,n,l);if(4===n||8===n)this.ojb?this.AEf(K):this.lS.remove(K),this.lS.count||(this.session=null,this.VGc&&-1!==this.Sgb&&(Rc.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Sgb),this.Sgb=-1));this.R7&&da.preventDefault();return this.R7};d.prototype.Iic=function(){return!1};d.prototype.sBh=function(n){var O=new m,da=n.rawEvent,l=da.touches;da=da.changedTouches;O.pointers=Array.clone(l);O.pointers=Array.clone(0<l.length?l:da);O.changedPointers=
Array.clone(da);O.srcEvent=n;O.pointerType="touch";return O};d.prototype.rBh=function(n,O,da){var l=new m;l.pointers=Vf.toArray(n.values);l.changedPointers=[O];l.pointerType=da;l.srcEvent=O;return l};d.prototype.j4h=function(n){return ah.a.startsWith(n,Ve.a.pinch)};d.prototype.Z3h=function(n){return ah.a.startsWith(n,Ve.a.pan)};d.prototype.K6h=function(n){return ah.a.startsWith(n,Ve.a.swipe)};Object(hd.a)(d,"GestureInputManager",Bd.a,[353,354]);var Yk=b(269);a.prototype.$h=function(n){n.register(d,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Ac().Lc(function(){return new d(Yk.a.instance,Ee.AFrameworkApplication.za.bB)});this.pb=n};a.prototype.init=function(){this.Fw||(this.pb.resolve("Common.App.GestureManager.GestureInputManager"),this.Fw=!0)};a.prototype.dispose=function(){};a.main=function(){vh.a.instance.oj(new a)};Jl.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(hd.a)(a,
"GestureInputManagerPackage",null,[8,9]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");le.a.Xi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Mg.a.Ja(Jc.la);Mg.a.Ja(Ja.la);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Td.main();le.a.Xi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){Of.initData();Mg.a.Ja(function(n){Ug.la(n);ff.la(n);Of.la(n);Ye.la(n)})})();le.a.Xi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
le.a.Xi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Mg.a.Ja(ac.la);Mg.a.Ja(Ge.la);Mg.a.Ja(Zd.la);le.a.Xi(".ewa-facp-text-box{position:absolute}");(function(){Mg.a.Ja(function(n){Ma.la(n)})})();(function(){Mg.a.Ja(function(n){Ue.la(n)})})();Mg.a.Ja(Ic.la);Mg.a.Ja(Ke.la);Mg.a.Ja(hc.la);le.a.Xi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Mg.a.Ja(Xa.la);Mg.a.Ja(Fd.la);(function(){Mg.a.Ja(function(n){n.ea.La(150,new pb(n))})})();(function(){Mg.a.Ja(function(n){ic.la(n);tc.la(n);L.la(n)})})();Mg.a.Ja(y.la);(function(){Mg.a.Ja(function(n){A.la(n)})})();(function(){Mg.a.Ja(function(n){n.ka(138)&&u.la(n)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},824:function(D,F,b){function a(ba,ha,oa,Sa,ma,na,xa,Oa,ib,sb,nb,Gb){Oa=R.call(this)||this;Oa.dgc=!1;Oa.contextMenuController=null;Oa.XCc=null;Oa.jAc=null;Oa.Ahd=!1;Oa.nFj=
0;Oa.mFj=0;Oa.opb=null;Oa.Aoc=null;Oa.wb=ba;Oa.Fff=ma;Oa.dKc=sb;Oa.HEj=oa;Oa.GEj=Sa;Oa.mEj=ha;Oa.Twf=na;Oa.d_=xa;Oa.KPh=nb;Oa.kDf(Gb);return Oa}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(876),m=b(86),r=b(24),t=b(846),k=b(828),u=b(981),w=b(896),v=b(113),A=b(371),y=b(88),x=b(404),z=b(37),J=b(798);F=b(74);var B=b(18),C=b(4),H=b(959),W=b(79),S=b(46),N=b(57),T=b(141),fa=b(122),Y=b(1),L=b(9),P=b(7),ea=b(16),X=b(20),ja=b(34),R=F.a;Cm(a,R);a.prototype.$c=function(ba,ha){ba=!0;switch(ha){case 1651433993:case 1675506831:case 966232027:ba=
this.Ke(4096)||this.Ke(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:ba=this.Ke(8192)}return!ba};a.prototype.gd=function(ba,ha,oa){oa.IsShadowMenuOpen||H.h(this.$,H.d);ba=!1;ha===this.Rt&&(oa.IsShadowMenuOpen||H.h(this.$,H.a),ha=Object.assign(new c.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.Cwd(ha,oa.IsShadowMenuOpen),oa.MenuItems=ha,oa.IsShadowMenuOpen||H.h(this.$,H.c),ba=!0);ba&&this.dgc&&L.HelperMethods.RXb&&!oa.IsShadowMenuOpen&&H.j(this.$);
return ba};a.prototype.Cwd=function(ba,ha){(ha=this.nY(ha))?(this.U_e(ha),Array.addRange(ba.MenuSectionList,ha.JB().MenuSectionList),this.Jpg(ba)):d.ULS.sendTraceTag(50439426,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.nY=function(){d.ULS.sendTraceTag(50439427,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.AN=function(ba,ha,oa,
Sa,ma){ba=Sys.UI.DomElement.getBounds(ha);oa=new Sys.UI.Point(ba.x,ba.y+ba.height);this.vRa(oa,ha);this.$.isChromeRtl&&(oa.x+=ba.width);this.Ln(oa,ma)};a.prototype.Ln=function(ba,ha,oa){oa=void 0===oa?0:oa;ha&&(ba=ja.a(this.$).NIa(ba));ha=!0;if(this.KPh){var Sa;3===oa?(Sa=this.wIa(3))&&0<Sa.length?(ha=!1,this.showFloatie(Sa,new Sys.UI.Bounds(ba.x,ba.y,0,0),oa)):d.ULS.sendTraceTag(50680261,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",
this.menuId):2===oa&&this.$.isEditMode&&((Sa=this.wIa(2))&&0<Sa.length?Sa[0]!==a.hLe?(ha=!1,this.iKd(Sa,new Sys.UI.Bounds(ba.x,ba.y,0,0),oa)):d.ULS.sendTraceTag(572523857,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):d.ULS.sendTraceTag(587335493,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ha&&this.showContextMenu(new Sys.UI.Bounds(ba.x,
ba.y,0,0),oa)};a.prototype.wIa=function(){return null};a.prototype.U$c=function(ba,ha){var oa="";3===ba?oa="touch":2===ba&&(oa="mouse");ba={};return ba.ContextMenuId=this.menuId,ba.IsEditMode=this.$.isEditMode,ba.IsSLR=!!N.a.Nf&&N.a.Nf.xA,ba.IsReactMLR=!!N.a.Nf&&N.a.Nf.SU,ba.IsNov=this.$.fa.isNamedObjectViewMode,ba.InputType=oa,ba.FloatieGroups=JSON.stringify(void 0===ha?null:ha),ba};a.prototype.showContextMenu=function(ba,ha){ha=void 0===ha?0:ha;var oa=this.U$c(ha);d.ULS.sendTraceTag(595359709,0,
50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(oa));this.contextMenuController?this.RA!==C.a.pzd&&this.RA!==C.a.qzd||!ha?this.contextMenuController.hKd(this.RA,ba,W.a.Yb):this.contextMenuController.hKd(this.RA,ba,ha):d.ULS.sendTraceTag(50630859,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(ba,ha,oa){var Sa=this.U$c(oa,ba);d.ULS.sendTraceTag(595359710,
0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Sa));this.contextMenuController?(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.qDf(),this.contextMenuController.lsc(ba,ha,oa)):d.ULS.sendTraceTag(50680262,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(ba))};a.prototype.iKd=function(ba,ha,oa){var Sa=this.U$c(oa,
ba);d.ULS.sendTraceTag(553952158,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Sa));this.contextMenuController?(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.qDf(),this.contextMenuController.gKd(ba,ha,oa,this.RA)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};
a.prototype.kDf=function(ba){this.contextMenuController=ba};a.prototype.dispose=function(){this.$&&this.$.Na.T8a(this);this.wb=null;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.f1f();this.Aoc&&(m.a.Ia(this.Aoc),this.Aoc=null);R.prototype.dispose.call(this)};a.prototype.Qqh=function(ba){var ha=this.$.ea.Ea(204,void 0);ha&&(ha=ha.wrh(this.Fff))&&Array.add(ba.Fc,ha)};a.prototype.vRa=function(ba,ha){ba&&ha&&this.$.fa.mc.isDivSyndicated&&r.a.tf&&(ha=
ha.ownerDocument.documentElement,ba.x-=ha.scrollLeft,ba.y-=ha.scrollTop)};a.prototype.Ke=function(ba){return(new T.a(this.$.Aa)).Ke(ba)};a.prototype.U_e=function(ba){ba=Ml(ba.Fc);for(var ha=ba.next();!ha.done;ha=ba.next())if(ha=ha.value,Object(x.a)(381,ha)){ha.title&&(ha.title=a.Lq(ha.title));ha=Ml(ha.buttons);for(var oa=ha.next();!oa.done;oa=ha.next())oa=oa.value,Object(x.a)(382,oa)?(oa.label=a.Lq(oa.label),oa.kR(a.Lq(oa.alt))):Object(x.a)(383,oa)&&this.U_e(oa.menu)}};a.prototype.wpd=function(ba,
ha){ha=void 0===ha?!1:ha;var oa=[];ba=Ml(ba);for(var Sa=ba.next();!Sa.done;Sa=ba.next())oa.push(this.tT(Sa.value,ha));return oa};a.prototype.tT=function(ba){for(var ha=[],oa=Ml(ba.MenuItems),Sa=oa.next();!Sa.done;Sa=oa.next())switch(Sa=Sa.value,Sa.Type){case 3:Array.add(ha,this.Eue(Sa,!1));break;case 2:Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5775701_ContextMenuToggleButtonFix")?Array.add(ha,this.pYg(Sa)):Array.add(ha,this.Eue(Sa,!0));break;case 1:Array.add(ha,this.bUg(Sa))}return Object.assign(new t.a,
{ControlList:ha,Title:ba.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.z7c=function(ba,ha){ha=[this.opb,ba.RibbonCommand.toString(),ha||ba.Label,ba.Disabled?ba.Disabled.toString():"False"];var oa=ba.CommandData;oa=P.a.hashCode(oa).toString();ha.push(oa,ba.Identifier.toString());ha=ha.join("_");ba.IsChecked&&(ha+="_Checked");return ha};a.prototype.xrh=function(ba){var ha=[this.opb,P.a.hashCode(ba.Title).toString()];
ba=Ml(ba.MenuItems);for(var oa=ba.next();!oa.done;oa=ba.next())ha.push(oa.value.RibbonCommand.toString());return ha.join("_")};a.prototype.WMe=function(ba){var ha=ba.Label;ha=P.a.hashCode(ha).toString();ha=[this.opb,ha];Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&ba.Id&&ha.push(P.a.hashCode(ba.Id).toString());ha=ha.join("_");ba.IsChecked&&(ha+="_Checked");return ha};a.prototype.Eue=function(ba,ha){var oa=this.z6b(ba,ha&&ba.IsChecked);ha=oa.label;
var Sa=oa.KJa;oa=oa.Yo;var ma=this.z7c(ba,ha);return Object.assign(new k.a,{Command:ba.Disabled?(-251203935).toString():oa.toString(),ExternalId:ma,Id:ma,Image16by16Class:Sa,LabelText:ha||ba.Label,MenuItemId:ba.CommandData,CommandValueId:ba.CommandData})};a.prototype.pYg=function(ba){var ha=this.z6b(ba,ba.IsChecked);var oa=ha.label;var Sa=ha.KJa;ha=ha.Yo;var ma=this.z7c(ba,oa);return Object.assign(new u.a,{Command:ba.Disabled?(-251203935).toString():ha.toString(),ExternalId:ma,Id:ma,Image16by16Class:Sa,
LabelText:oa||ba.Label,MenuItemId:ba.CommandData,CommandValueId:ba.CommandData,IsChecked:ba.IsChecked})};a.prototype.bUg=function(ba){var ha=this.hNe(ba);var oa=ha.label;ha=ha.KJa;var Sa=Object.assign(new c.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(Sa.MenuSectionList,this.wpd(ba.SubMenu.Sections,!0));var ma=this.WMe(ba);ba=oa?oa:ba.Label;return Object.assign(new w.a,{ExternalId:ma,Id:ma,LabelText:ba,PopulateOnlyOnce:!1,Menu:Sa,Image16by16Class:ha,ImageIsVisible:!!ha})};a.prototype.hNe=
function(ba){ba=this.z6b(ba,!0);return{label:ba.label,KJa:ba.KJa,Yo:ba.Yo}};a.prototype.z6b=function(ba,ha){var oa=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(ba.Identifier){case 26:var Sa=912804500;ha=B.a.uHe;ba=ea.a.instance.da(1866);break;case 3:Sa=-1902148570;ha=ha?B.a.i$:null;ba=ea.a.instance.da(1826);break;case 4:Sa=-1902148570;ha=ha?B.a.i$:null;ba=ea.a.instance.da(1827);break;case 5:Sa=-1902148570;ha=ha?B.a.i$:null;ba=null;break;case 1:Sa=-1677817820;
ha=B.a.n4b;ba=ea.a.instance.da(219);break;case 2:Sa=-1649376918;ha=ba.IsChecked?B.a.zha:null;ba=ea.a.instance.da(2028);break;case 23:Sa=1701016594;ha=ba.IsChecked?B.a.zha:null;ba=ea.a.instance.da(2028);break;case 6:Sa=-87741481;ha=null;ba=ea.a.instance.da(2029);break;case 7:Sa=1948650742;ha=B.a.jGe;ba=ea.a.instance.da(1864);break;case 8:Sa=1933713114;ha=B.a.iGe;ba=ea.a.instance.da(1865);break;case 14:Sa=504133448;ha=oa?B.a.l3:ha?B.a.Xsa:B.a.l3;ba=ea.a.instance.da(142);break;case 30:Sa=504133448;ha=
oa?B.a.l3:ha?B.a.Xsa:B.a.l3;ba=ea.a.instance.da(146);break;case 32:Sa=504133448;ha=oa?B.a.l3:ha?B.a.Xsa:B.a.l3;ba=ea.a.instance.da(148);break;case 34:Sa=504133448;ha=oa?B.a.l3:ha?B.a.Xsa:B.a.l3;ba=ea.a.instance.da(150);break;case 27:Sa=1701016594;ha=ha?B.a.Xsa:B.a.l3;ba=ea.a.instance.da(142);break;case 15:Sa=-798968736;ha=oa?B.a.m3:ha?B.a.Ysa:B.a.m3;ba=ea.a.instance.da(144);break;case 31:Sa=-798968736;ha=oa?B.a.m3:ha?B.a.Ysa:B.a.m3;ba=ea.a.instance.da(147);break;case 33:Sa=-798968736;ha=oa?B.a.m3:
ha?B.a.Ysa:B.a.m3;ba=ea.a.instance.da(149);break;case 35:Sa=-798968736;ha=oa?B.a.m3:ha?B.a.Ysa:B.a.m3;ba=ea.a.instance.da(151);break;case 28:Sa=1701016594;ha=ha?B.a.Ysa:B.a.m3;ba=ea.a.instance.da(144);break;case 21:Sa=-2058042992;ha=B.a.F_a;ba=null;break;case 29:Sa=1701016594;ha=B.a.F_a;ba=null;break;case 9:Sa=1701016594;ba=ha=null;break;case 11:Sa=-1494291901;ba=ha=null;break;case 25:Sa=-1045020714;ha=ba.IsChecked?B.a.zha:null;ba=null;break;case 13:Sa=1701016594;ha=ba.IsChecked?B.a.zha:null;ba=ea.a.instance.da(153);
break;case 16:Sa=1701016594;ha=B.a.rHa;ba=ea.a.instance.da(1013);break;case 17:Sa=1701016594;ha=B.a.Vsa;ba=null;break;case 18:Sa=1701016594;ha=B.a.Usa;ba=null;break;case 19:Sa=1701016594;ha=B.a.E_a;ba=ea.a.instance.da(1018);break;case 20:Sa=1701016594;ha=B.a.J3c;ba=ea.a.instance.da(1019);break;case 24:Sa=1675506831;ha=oa?null:ba.IsChecked?B.a.zha:null;ba=null;break;case 22:Sa=ba.RibbonCommand;ha=ba.IsChecked?oa?B.a.i$:B.a.zha:null;ba=null;break;case 36:Sa=1461300262;ha=null;ba=ea.a.instance.da(152);
break;default:d.ULS.shipAssertTag(594354500,0,!1,"Unable to map menu item: {0}",JSON.stringify(ba)),Sa=1461300262,ba=ha=null}return{label:ba,KJa:ha,Yo:Sa}};a.prototype.Jpg=function(ba){if(!this.$.fa.amIAlone){var ha=this.$.ea.Ea(25,void 0);if((void 0!==ha&&null!==ha||!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!v.a.isEmpty(ha.hAa)&&(ha=ha.OKh(),!A.a.na(ha))){var oa=[];y.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").GWg(ha,oa);Array.addRange(ba.MenuSectionList,
oa)}}};a.prototype.qDf=function(){this.Ahd||(this.orb&&this.orb.xVb(Object(z.a)(this,this.aC,"dismissFloatie")),this.Lmb&&this.Lmb.xVb(Object(z.a)(this,this.aC,"dismissFloatie")),this.Ahd=!!this.orb||!!this.Lmb)};a.prototype.aC=function(){this.contextMenuController?this.contextMenuController.aC():d.ULS.sendTraceTag(545530817,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.f1f()};a.prototype.f1f=function(){this.orb&&this.orb.gnc(Object(z.a)(this,
this.aC,"dismissFloatie"));this.Lmb&&this.Lmb.gnc(Object(z.a)(this,this.aC,"dismissFloatie"));this.Ahd=!1};a.o7b=function(ba,ha,oa){ha=S.C(ha);var Sa=X.g(ba).Ha.p8b(ha);ha=X.g(ba).getCellBounds(Sa);var ma=Sa.nAg;Sa=Sa.mAg;var na=ha.x+ma.x;ha=ha.y+ma.y;oa&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(X.g(ba).rtl||(na+=Sa),ha-=Sa);return new Sys.UI.Point(na,ha)};a.Sih=function(ba){try{Object(J.a)(ba.CommandValueId)}catch(ha){}};a.Lq=function(ba){var ha=a.usa.parseFromString(ba,
"text/html");return ha?ha.body.innerText:(d.ULS.sendTraceTag(574132482,0,15,"Not able to decode htmlFormattedText"),ba)};Jl.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.Aoc}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Va:{configurable:!0,enumerable:!0,get:function(){return this.dKc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Mb+this.Fff}},orb:{configurable:!0,enumerable:!0,get:function(){this.XCc||
(this.XCc=fa.a(this.$));return this.XCc}},Lmb:{configurable:!0,enumerable:!0,get:function(){this.jAc||(this.jAc=X.g(this.$).Hc);return this.jAc}}});a.usa=new DOMParser;a.hLe="Unsupported";Object(D.a)(a,"ContextMenuBase",F.a,[159,384,7])},913:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.bEe="ewa-ac";a.j$g="ewa-ac-param";a.PEe="ewa-function-help-link";a.UEe="ewa-lb";a.IEe="ewa-fb-refactor";a.listItem="list-item";a.dyb="list-item-selected";a.iyb="list-table-touch";a.hyb="list-table";
a.ZMg="columnName-header";a.HFe="ewa-tt";a.fch="ewa-function-link-container";a.QEe="ewa-function-udf-name";a.rtl="rtl";Object(D.a)(a,"CssClassNames",null,[])},921:function(D,F,b){function a(ba,ha,oa){this.YMb=null;this.YE={};this.MNb=this.xB=null;t.ULS.sendTraceTag(40732553,0,50,"BorderFormatManager: Request new instance");this.$=ba;this.iXd=a.b0c;this.jXd=a.borderStyleSolidLine;this.Fi=ha;this.Va=oa;z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.ea.La(296,
this);this.RT=new d(this.$,this.Fi);this.eH=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);t.ULS.sendTraceTag(40732554,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function d(ba,ha){this.WCb=this.ribbonCommandInfo=this.cellFormat=this.ur=this.Sb=this.ga=null;this.pmc=!1;this.kyf=this.UJa=this.uyf=this.N_d=this.Kxa=this.cla=null;this.KXb=this.zsa=this.syf=0;this.borderStyle=this.vXa=this.borderColor=null;this.tA=!1;this.g1b=this.$7a=
null;this.$=ba;this.Fi=ha}function c(ba){ba.yDf()}function m(){this.iconName=this.title=this.key=null}function r(ba,ha,oa,Sa,ma,na,xa,Oa){this.k$f=ba;this.l$f=ha;this.j$f=oa;this.xO=Sa;this.rkg=ma;this.Cgg=na;this.Egb=xa;this.xfg=Oa}b.r(F);D=b(0);var t=b(15),k=b(931),u=b(833),w=b(4),v=b(79),A=b(48),y=b(212),x=b(32),z=b(1),J=b(7),B=b(16);r.eDg=function(){return new r("BorderStyleSolidLine",1870,1,"1","",1,8,0)};r.aDg=function(){return new r("BorderStyleDashedLine",1871,3,"1","5,3",1,8,0)};r.bDg=function(){return new r("BorderStyleDottedLine",
1872,4,"1","1,1",1,8,0)};r.dDg=function(){return new r("BorderStyleMediumLine",1873,2,"2","",1,8,0)};r.fDg=function(){return new r("BorderStyleThickLine",1874,5,"3","",1,8,0)};r.cDg=function(){return new r("BorderStyleDoubleLine",1875,6,"1","",2,8,3)};Jl.Object.defineProperties(r.prototype,{Ale:{configurable:!0,enumerable:!0,get:function(){return this.k$f}},IXb:{configurable:!0,enumerable:!0,get:function(){return this.l$f}},zle:{configurable:!0,enumerable:!0,get:function(){return this.j$f}},width:{configurable:!0,
enumerable:!0,get:function(){return this.xO}},hmj:{configurable:!0,enumerable:!0,get:function(){return this.rkg}},Gmi:{configurable:!0,enumerable:!0,get:function(){return this.Cgg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.Egb}},hai:{configurable:!0,enumerable:!0,get:function(){return this.xfg}}});Object(D.a)(r,"BorderLineStyleProperties",null,[]);Object(D.a)(m,"BorderLineStyleProps",null,[]);c.prototype.getBorderLineStyleProps=function(){var ba=b(921).BorderFormatManager.uXa,
ha=Array(Object.keys(ba).length),oa=0,Sa;for(Sa in ba){var ma=Sa,na=ba[Sa];ha[oa]=new m;ha[oa].key=ma;ma=na;ha[oa].title=B.a.instance.da(ma.IXb);ha[oa].iconName=ma.Ale;oa++}return ha};Object(D.a)(c,"BorderMenuController",null,[392]);var C=b(371),H=b(90),W=b(167),S=b(13),N=b(120),T=b(37),fa=b(25),Y=b(44),L=b(42),P=b(195),ea=b(9),X=b(106),ja=b(20),R=b(34);d.prototype.Wmg=function(ba){t.ULS.sendTraceTag(576534677,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ga=ja.g(this.$).ga;
this.Sb=ja.g(this.$).Sb;this.ribbonCommandInfo=ba;this.uyf=C.a.clone(this.ga.ya.selectedRanges);this.syf=this.ga.ya.pA;this.kyf=this.ga.ya.activeCell.clone();this.Sb&&this.Sb.gdd();this.Vx();this.Xj()};d.prototype.s_=function(){if(!this.tA||ja.g(this.$).Oy)this.tA=!1,ja.g(this.$).Oy=!1,this.zsa=0,ja.g(this.$).Vi.YA(w.a.kua),1===this.$.Na.AG()&&(ja.g(this.$).sU(C.a.clone(this.uyf),this.syf,this.$.sa?this.$.sa.sheetName:null,null,this.kyf.clone(),null,null,0,X.a.G5g,!0),ja.g(this.$).P_(!0)),this.lv(),
this.JPd(),this.sm(),this.pmc=!1,this.Kxa=this.cla=null,this.ur&&(this.ur.cancel(),this.ur.dispose()),t.ULS.sendTraceTag(587220504,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};d.prototype.dispose=function(){this.s_();this.WCb=this.ribbonCommandInfo=this.cellFormat=null};d.prototype.onPointerDown=function(ba){try{if(ba=this.Qe(ba),ja.g(this.$).Oy=!0,this.cla={},this.Kxa={},this.$7a=null,this.bmb(this.KXb),2===ba.Cb){var ha=ja.g(this.$).ga.Pr(ba.clientPoint,ba.Wb,5,void 0,void 0,
!1);ha&&(this.g1b=this.UJa=ha,this.NPi())}}catch(oa){ja.g(this.$).Oy=!1}return!0};d.prototype.vk=function(ba){try{ba=this.Qe(ba);var ha=ja.g(this.$).ga.Pr(ba.clientPoint,ba.Wb,5,void 0,void 0,!1),oa=ja.g(this.$).Ha.Hr(ha);if(!this.WCb||oa&&(oa.DJ!==this.WCb.DJ||oa.QG!==this.WCb.QG))if(this.tA=!0,this.WCb=oa,ha){var Sa=new fa.Range(this.UJa.top,this.UJa.left,this.UJa.top,this.UJa.left,!0,!1);Sa.union(ha);Sa=ja.g(this.$).ga.JFh(Sa);this.OXb(ha);this.NIf(this.$7a,Sa);if(this.bottomRightCorner(Sa.bottom,
Sa.right))return t.ULS.sendTraceTag(579418061,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var ma=new fa.Range(Sa.top,Sa.left,Sa.bottom+1,Sa.right+1,!0,!1),na=ja.g(this.$).L9("DrawBorderBehavior.OnPointerMove",[ma]);if(this.cla&&this.Kxa)for(;na.$$mn();){var xa=na.$$cu(),Oa=xa.cell.getRange().toString();Oa in this.cla&&1!==this.zsa||(this.cla[Oa]=xa,this.Kxa[Oa]=xa.cell.wOe())}this.$7a=ma;this.g1b=Sa;ja.g(this.$).sU([Sa],0,this.$.sa.sheetName,
null,Sa.topLeft,null,null,0,X.a.D5g,!0);this.Fi.wma(ja.g(this.$),-1690267012,this.cellFormat,!0,null,[Sa])}return!0}catch(ib){return ja.g(this.$).Oy=!1}};d.prototype.Hh=function(ba){ba=this.Qe(ba);(ba=ja.g(this.$).ga.Pr(ba.clientPoint,ba.Wb,5,void 0,void 0,!1))?this.tA&&(this.OXb(ba),this.UJa.union(ba),3===this.zsa?this.bmb(0):this.bmb(this.KXb),ja.g(this.$).sU([this.UJa],0,this.$.sa.sheetName,null,null,null,null,0,X.a.E5g,!0),this.Fi.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):
(3===this.zsa?this.bmb(0):this.bmb(this.KXb),ja.g(this.$).sU([this.g1b],0,this.$.sa.sheetName,null,null,null,null,0,X.a.F5g,!0),this.Fi.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.tA=!1;this.JPd();this.Kxa=this.cla=null;return!0};d.prototype.onKeyDown=function(ba){ba=this.Qe(ba);if(this.tA||Array.contains([17,16,18,20],ba.Ga.keyCode))return!0;this.s_();return!1};d.prototype.onKeyUp=function(ba){ba=this.Qe(ba);if(ba.Ga.keyCode===H.a.LK&&this.tA)return this.tA=!1,this.NIf(this.$7a,
this.g1b,!0),this.JPd(),!0;if(this.tA||ba.Ga.keyCode===H.a.iAa||ba.Ga.keyCode===H.a.LTd||ba.Ga.keyCode===H.a.KTd||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ba.Ga.keyCode)||ba.Ga.keyCode===H.a.N8f||ba.Ga.keyCode===H.a.J8f||ba.Ga.keyCode===H.a.G8f)return!0;this.s_();return!1};d.prototype.bmb=function(ba){var ha=b(921).BorderFormatManager;this.cellFormat={};var oa={};this.borderColor=this.borderColor||ha.b0c;var Sa=y.a.xG(this.borderColor,!1);oa.Color=[Sa,Sa,Sa,Sa];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&this.vXa&&(oa.ThemeBorderColor=[this.vXa,this.vXa,this.vXa,this.vXa],oa.ColorTypeOption=1);Sa=b(921).BorderFormatManager.uXa;this.borderStyle=this.borderStyle||ha.borderStyleSolidLine;ha=Sa[this.borderStyle].zle;oa.LineStyle=[ha,ha,ha,ha];this.cellFormat.BorderFormat=oa;this.cellFormat.ValidMembers=128;this.cellFormat.Border=ba};d.prototype.Vx=function(){for(var ba=Ml(ja.g(this.$).uo),ha=ba.next();!ha.done;ha=ba.next())W.a.instance.qa(S.a.pointerDown,ha.value.domElement,Object(T.a)(this,this.onPointerDown,
"onPointerDown"));N.KeyInputManager.instance.qa(S.a.Rb,document.documentElement,Object(T.a)(this,this.onKeyDown,"onKeyDown"));N.KeyInputManager.instance.qa(S.a.fe,document.documentElement,Object(T.a)(this,this.onKeyUp,"onKeyUp"))};d.prototype.NPi=function(){for(var ba=Ml(ja.g(this.$).uo),ha=ba.next();!ha.done;ha=ba.next())ha=ha.value,W.a.instance.qa(S.a.Jh,ha.domElement,Object(T.a)(this,this.vk,"onPointerMove")),W.a.instance.qa(S.a.de,ha.domElement,Object(T.a)(this,this.Hh,"onPointerUp"));W.a.instance.qa(S.a.de,
document.documentElement,Object(T.a)(this,this.Hh,"onPointerUp"));W.a.instance.qa(S.a.$y,document.documentElement,Object(T.a)(this,this.Hh,"onPointerUp"));this.pmc=!0};d.prototype.lv=function(){try{for(var ba=Ml(ja.g(this.$).uo),ha=ba.next();!ha.done;ha=ba.next())W.a.instance.Ca(S.a.pointerDown,ha.value.domElement,Object(T.a)(this,this.onPointerDown,"onPointerDown"));N.KeyInputManager.instance.Ca(S.a.Rb,document.documentElement,Object(T.a)(this,this.onKeyDown,"onKeyDown"));N.KeyInputManager.instance.Ca(S.a.fe,
document.documentElement,Object(T.a)(this,this.onKeyUp,"onKeyUp"))}catch(oa){ja.g(this.$).Oy=!1,t.ULS.sendTraceTag(587220494,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",oa)}};d.prototype.JPd=function(){if(this.pmc)try{this.pmc=!1;for(var ba=Ml(ja.g(this.$).uo),ha=ba.next();!ha.done;ha=ba.next()){var oa=ha.value;W.a.instance.Ca(S.a.Jh,oa.domElement,Object(T.a)(this,this.vk,"onPointerMove"));W.a.instance.Ca(S.a.de,oa.domElement,Object(T.a)(this,
this.Hh,"onPointerUp"))}W.a.instance.Ca(S.a.de,document.documentElement,Object(T.a)(this,this.Hh,"onPointerUp"));W.a.instance.Ca(S.a.$y,document.documentElement,Object(T.a)(this,this.Hh,"onPointerUp"))}catch(Sa){ja.g(this.$).Oy=!1,t.ULS.sendTraceTag(587220491,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",Sa)}};d.prototype.Xj=function(){this.$.Aa.Vf(Object(T.a)(this,this.s_,"resetBehavior"));ja.g(this.$).Hc.Cm(Object(T.a)(this,this.s_,"resetBehavior"));
ja.g(this.$).AD(Object(T.a)(this,this.s_,"resetBehavior"));this.$.Na.rkb(Object(T.a)(this,this.Mwa,"onCommandExecutionStarting"))};d.prototype.sm=function(){this.$.Aa.wg(Object(T.a)(this,this.s_,"resetBehavior"));ja.g(this.$).Hc.mm(Object(T.a)(this,this.s_,"resetBehavior"));ja.g(this.$).aF(Object(T.a)(this,this.s_,"resetBehavior"));this.$.Na.Y8a(Object(T.a)(this,this.Mwa,"onCommandExecutionStarting"))};d.prototype.NIf=function(ba,ha,oa){oa=void 0===oa?!1:oa;if(ba&&this.cla&&this.Kxa)for(ba=ja.g(this.$).L9("DrawBorderBehavior.ApplyBordersOnPreviewCells",
[ba]);ba.$$mn();){var Sa=ba.$$cu().cell.getRange();if(oa||!ha.contains(Sa)||1===this.zsa){Sa=Sa.toString();var ma=x.a.Ec(this.cla,Sa);if(ma){var na=x.a.Ec(this.Kxa,Sa);this.setBorders(ma,na);delete this.cla[Sa];delete this.Kxa[Sa]}}}};d.prototype.setBorders=function(ba,ha){var oa=ba.cell,Sa=oa.getRange();oa.XDf();Sa.right!==this.$7a.right&&(oa=new fa.Range(Sa.top,Sa.left-1,Sa.bottom,Sa.left-1,!0,!1),ja.g(this.$).Ha.Hr(oa).dBd(3));Sa.bottom!==this.$7a.bottom&&(oa=new fa.Range(Sa.top-1,Sa.left,Sa.top-
1,Sa.right,!0,!1),ja.g(this.$).Ha.Hr(oa).dBd(1));if(ha&&ha.Borders.length){var ma={};oa=0;for(var na=Array(4),xa=Array(4),Oa=0;4>Oa;Oa++)na[Oa]=1,xa[Oa]=0;ha=Ml(ha.Borders);for(Oa=ha.next();!Oa.done;Oa=ha.next()){Oa=Oa.value;var ib=Oa.BorderPosition;na[ib]=Oa.BorderLineStyle;var sb=new P.a(Oa.Color.Red,Oa.Color.Green,Oa.Color.Blue);xa[ib]=sb.e0();oa|=ea.HelperMethods.Prb(Oa.BorderPosition)}ma.LineStyle=na;ma.Color=xa;ma={BorderFormat:ma};ma.Border=oa;this.Fi.f9i(ba,ma,Sa)}};d.prototype.OXb=function(ba){var ha=
this,oa=new fa.Range(Math.max(1,ba.top-1),Math.max(1,ba.left-1),ba.bottom+1,ba.right+1,!1,!1);ja.g(this.$).Bja(oa)||this.ur&&this.ur.Po||(this.ur=Y.a.instance.create(function(){ja.g(ha.$).Dt(oa,60,X.a.B5g)},40,L.a.C5g))};d.prototype.bottomRightCorner=function(ba,ha){return 1048576<=ba||16384<=ha?!0:!1};d.prototype.Qe=function(ba){return R.a(this.$).Qe(ba)};d.prototype.Mwa=function(ba,ha){ja.g(this.$).Oy&&!Array.contains(this.CSh,ha.je.command)&&(t.ULS.sendTraceTag(576534674,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",
ha.je),this.s_())};Jl.Object.defineProperties(d.prototype,{CSh:{configurable:!0,enumerable:!0,get:function(){return this.N_d||(this.N_d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(D.a)(d,"DrawBorderBehavior",null,[7]);b.d(F,"BorderFormatManager",function(){return a});a.prototype.eXe=function(ba,ha){t.ULS.sendTraceTag(40944208,0,50,
"HandleBorderCommand : Begin handling, Command being executed: {0}",ha.command.toString());var oa={},Sa={};var ma=y.a.xG(this.B2,!1);Sa.Color=[ma,ma,ma,ma];this.eH&&this.Yra&&(Sa.ThemeBorderColor=[this.Yra,this.Yra,this.Yra,this.Yra],Sa.ColorTypeOption=1);ba=-600086683===ha.command?"OutsideBorders":ba[v.a.Vd];Sa.LineStyle=x.a.Ec(a.xxf,ba);Sa.LineStyle?t.ULS.sendTraceTag(41194721,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",ba):(ma=
a.uXa[this.dGa].zle,Sa.LineStyle=[ma,ma,ma,ma],t.ULS.sendTraceTag(41194720,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.dGa));ma=x.a.Nn(a.gCg,ba,0);t.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",ba,this.B2);oa.BorderFormat=Sa;4!==ma&&8!==ma||!this.$.sa.displayRtl||(ma=4===ma?8:4);oa.ValidMembers=128;oa.Border=ma;this.Fi.formatCells(-1690267012,
oa,ha);t.ULS.sendTraceTag(40944209,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",ha.command.toString());return!0};a.prototype.Pbd=function(ba,ha,oa){t.ULS.sendTraceTag(40944210,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",ba.toString(),this.B2);if(this.eH){if(J.a.contains(ha.SqmControlId,"ThemeColorPicker",!1)){var Sa=this.themesManager.getThemeColor(ha.Color);var ma=Sa.themeIndex;var na=Sa.Cza;Sa.returnValue?(this.MNb={},this.Yra.ThemeColorIndex=
ma,this.Yra.ThemeColorRow=na):this.MNb=null}else this.MNb=null;this.RT.vXa=this.Yra}this.iXd=-1803452024===ba?a.b0c:ha.Color;this.RT.borderColor=this.B2;this.qCe(oa);this.$.If();t.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",ba.toString(),this.B2);return!0};a.prototype.gOh=function(ba){t.ULS.sendTraceTag(40944212,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var ha=this.Va.sp(),oa=this.Va.Vc();ha.Fc.push(oa);var Sa=this.Va.cA("StyleDashGallery",
1,"Size120by20");oa.buttons.push(Sa);oa=a.uXa;for(var ma in oa){var na=ma,xa=oa[ma],Oa=B.a.instance.da(xa.IXb);Sa.jt(na,-2118943501,"QueryBorderStyle",xa.IXb,na,na,void 0,void 0,Oa)}t.ULS.sendTraceTag(40944214,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");ba.MenuItems=ha.JB();t.ULS.sendTraceTag(40944216,0,50,"RibbonPopulateCommand handled")};a.prototype.MMh=function(ba,ha){t.ULS.sendTraceTag(40944217,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.dGa);ba=
ba[v.a.Vd];if(a.A7h(ba))this.jXd=ba,t.ULS.sendTraceTag(40944218,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.dGa);else return t.ULS.sendTraceTag(40944219,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",ba),!0;this.RT.borderStyle=this.dGa;this.qCe(ha);this.$.If();t.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.dGa);return!0};a.prototype.Ubd=function(ba){t.ULS.sendTraceTag(587244384,
0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",ba.command.toString());this.INc(ba,64,this.B2,88,1);return!0};a.prototype.Vbd=function(ba){t.ULS.sendTraceTag(587244383,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",ba.command.toString());this.INc(ba,112,this.B2,89,2);return!0};a.prototype.sXe=function(ba){t.ULS.sendTraceTag(587244382,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",ba.command.toString());this.INc(ba,
112,"white",90,3);return!0};a.prototype.jOh=function(ba){this.R7i(this.hCg,ba,ba.MenuItemId?ba.MenuItemId:a.borderStyleSolidLine)};a.prototype.R7i=function(ba,ha,oa){oa in ba?(ba=ba[oa],t.ULS.sendTraceTag(40944221,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",oa),this.T7i(ha,ba)):t.ULS.sendTraceTag(40944222,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",oa)};a.prototype.uOh=function(ba,ha){var oa=ba[v.a.Vd];return"DrawBorder"===oa?this.Ubd(ha):
"DrawBorderGrid"===oa?this.Vbd(ha):"EraseBorder"===oa?this.sXe(ha):this.eXe(ba,ha)};a.prototype.yDf=function(){this.YMb||this.gDg()};a.prototype.xuh=function(){return new c(this)};a.prototype.gDg=function(){this.YMb={};var ba=0,ha=a.uXa,oa={},Sa;for(Sa in ha){oa.Hda=ha[Sa];var ma=oa.Hda.Ale;B.a.instance.da(oa.Hda.IXb);var na=function(xa){return function(){return appChrome.buildBorderStyleIconNew(xa.Hda.hmj,xa.Hda.width,xa.Hda.Gmi,xa.Hda.lineHeight,xa.Hda.hai)}}(oa);this.YMb[ma]=ma;this.M8a(ma,na);
ba++;oa={Hda:oa.Hda}}};a.prototype.M8a=function(ba,ha){if(!(ba in this.YE)){var oa={};ha=ha();oa[ba]=ha;appChrome.api.registerIconProvider(function(){return oa});this.YE[ba]=!0}return ba};a.prototype.T7i=function(ba,ha){ba.MenuItemId&&(ba[k.a.On]=ba.MenuItemId===this.dGa,ba[u.a.Icon]=ha)};a.prototype.INc=function(ba,ha,oa,Sa,ma){t.ULS.sendTraceTag(576534679,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.SJg(ba,ma)?(t.ULS.sendTraceTag(576534678,0,
50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.RT.s_()):(ja.g(this.$).Oy&&this.RT.s_(),A.a.current&&(Sa=String.format(w.a.csa,A.a.current.En(Sa)),ja.g(this.$).Vi.YA(Sa)),this.RT.KXb=ha,this.RT.borderColor=oa,ja.g(this.$).Oy=!0,this.RT.Wmg(ba),this.RT.zsa=ma)};a.prototype.qCe=function(ba){if(ba)switch(this.RT.zsa){case 2:this.Vbd(ba);break;default:this.Ubd(ba)}};a.prototype.SJg=function(ba,ha){return this.RT.zsa===ha&&-236759591!==ba.command&&-2118943501!==
ba.command?!0:!1};a.A7h=function(ba){return ba?ba in a.xxf||ba in a.uXa:!1};Jl.Object.defineProperties(a.prototype,{dGa:{configurable:!0,enumerable:!0,get:function(){return this.jXd}},B2:{configurable:!0,enumerable:!0,get:function(){return this.iXd}},Yra:{configurable:!0,enumerable:!0,get:function(){return this.MNb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.xB||(this.xB=this.$.ea.Ea(422,void 0));return this.xB}},hCg:{configurable:!0,enumerable:!0,get:function(){this.yDf();
return this.YMb}}});Jl.Object.defineProperties(a,{uXa:{configurable:!0,enumerable:!0,get:function(){var ba={};return a.kVd||(a.kVd=(ba.BorderStyleSolidLine=r.eDg(),ba.BorderStyleDashedLine=r.aDg(),ba.BorderStyleDottedLine=r.bDg(),ba.BorderStyleMediumLine=r.dDg(),ba.BorderStyleThickLine=r.fDg(),ba.BorderStyleDoubleLine=r.cDg(),ba))}},gCg:{configurable:!0,enumerable:!0,get:function(){var ba={};return a.jVd||(a.jVd=(ba.NoBorder=0,ba.BottomBorder=1,ba.TopBorder=2,ba.LeftBorder=4,ba.RightBorder=8,ba.OutsideBorders=
64,ba.AllBorders=112,ba.ThickOutsideBorders=64,ba.InsideBorders=48,ba.InsideHorizontalBorders=16,ba.InsideVerticalBorders=32,ba.BottomDoubleBorder=1,ba.ThickBottomBorder=1,ba.TopBottomBorder=3,ba.TopThickBottomBorder=3,ba.TopDoubleBottomBorder=3,ba))}},xxf:{configurable:!0,enumerable:!0,get:function(){var ba={};return a.C6d||(a.C6d=(ba.ThickOutsideBorders=[2,2,2,2],ba.BottomDoubleBorder=[1,6,1,1],ba.ThickBottomBorder=[1,2,1,1],ba.TopBottomBorder=a.f0g,ba.TopThickBottomBorder=[1,2,1,1],ba.TopDoubleBottomBorder=
[1,6,1,1],ba))}}});a.jVd=null;a.kVd=null;a.C6d=null;a.b0c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.f0g=[1,1,1,1];Object(D.a)(a,"BorderFormatManager",null,[366])},959:function(D,F,b){function a(B,C,H){window.performance.measure(B,C,H);C=window.performance.getEntriesByName(B);C.length||w.ULS.sendTraceTag(594634060,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",B);return C[C.length-1]?C[C.length-1].duration:-1}function d(){if(v.a.SXb){var B=a("OnContextMenuHandling",
"ContextMenuPerf.A","ContextMenuPerf.B"),C=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),H=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");w.ULS.sendTraceTag(594634061,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",B,C,H)}}function c(B,C){z.HelperMethods.Qle&&window.performance.mark(C)}function m(B){B=J.g(B).ga.ya;return B.Eh&&(B.Xd.isRow||B.Xd.Yh)}function r(B){return B.kc.Caa(B.ga.ya.activeCell)}
function t(B,C,H,W,S){B=W.$m("ContextMenuHelper.FindFirstCellInViewportArea",B,C,H);try{for(B.$$rst();B.$$mn();){var N=B.$$cu();if(N&&k(N,W,S))return N.cell}}finally{B&&B.dispose()}return null}function k(B,C,H){var W=C.rtl,S=H.isChromeRtl;B=B.cell;return(H=J.g(H).nJ(B))?(H=H.topLeft,W=H.x+=W===S?B.offsetWidth:0,S=H.y+=B.offsetHeight,C.view.visibleArea.contains(new y.a(W,S,0,0))):!1}function u(B,C){var H=B.Cc(null);if(H&&H.cell.Fj&&k(H,B,C))return B.getCellBounds(H.cell);H=B.ga.ya.activeCell;return(C=
t(new x.Range(H.top,H.left,A.a.Gh,H.left,!1,!1),2,!0,B,C)||t(new x.Range(1,H.left,H.top,H.left,!1,!1),2,!1,B,C)||t(new x.Range(H.top,H.right,H.top,A.a.Qh,!1,!1),1,!0,B,C)||t(new x.Range(H.top,1,H.top,H.right,!1,!1),1,!1,B,C)||null)&&C.Fj?B.getCellBounds(C):Sys.UI.DomElement.getBounds(B.Utb.Nb)}b.d(F,"i",function(){return"ContextMenuPerf.A"});b.d(F,"b",function(){return"ContextMenuPerf.B"});b.d(F,"d",function(){return"ContextMenuPerf.C1"});b.d(F,"a",function(){return"ContextMenuPerf.C2"});b.d(F,"c",
function(){return"ContextMenuPerf.D"});b.d(F,"e",function(){return u});b.d(F,"f",function(){return r});b.d(F,"g",function(){return m});b.d(F,"h",function(){return c});b.d(F,"j",function(){return d});var w=b(15),v=b(317),A=b(10),y=b(59),x=b(25),z=b(9),J=b(20)},960:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.kAg="AutoFill";a.a0i="RowOperations";a.$Mg="ColumnOperations";a.zBj="ViewModeRowOperations";a.yBj=
"ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.Yaj="ShapeStyle";a.Fnh="FloatingObjectClipboard";a.wwf="PivotTableCopyDelete";a.ywf="PivotTableFieldListActions";a.Doe="CellFloatie";a.Uaj="ShapeFloatie";a.contextMenu="ContextMenu";a.ZLh="GridContextMenu";a.zFi="PivotTableContextMenu";a.Gnh="FloatingObjectContextMenu";a.aJg="CellRTEFloatie";a.FQf="ShapeRTEFloatie";Object(D.a)(a,"FloatieGroupIdentifiers",null,[])},961:function(D,F,b){function a(A,y,x){y=v.call(this,
y)||this;y.sQ=!1;y.Oec=!1;y.ALa=null;y._selectedRowListBox=null;y.nn=null;y.wb=A;y.cyb=x;y.tza(!0);return y}b.d(F,"a",function(){return a});D=b(0);var d=b(86),c=b(276),m=b(13),r=b(167),t=b(37);F=b(227);var k=b(11),u=b(68),w=b(20),v=F.a;Cm(a,v);a.prototype.L8=function(A){this.get_events().addHandler(a.K1a,A)};a.prototype.kca=function(A){this.get_events().removeHandler(a.K1a,A)};a.prototype.vVb=function(A){this.get_events().addHandler(a.Wdd,A)};a.prototype.enc=function(A){this.get_events().removeHandler(a.Wdd,
A)};a.prototype.Gkb=function(A){this.get_events().addHandler(a.SGd,A)};a.prototype.IEb=function(A){this.get_events().removeHandler(a.SGd,A)};a.prototype.mWa=function(A){this.get_events().addHandler(a.rNa,A)};a.prototype.e9a=function(A){this.get_events().removeHandler(a.rNa,A)};a.prototype.qPc=function(A){this.get_events().addHandler(a.cld,A)};a.prototype.dCd=function(A){this.get_events().removeHandler(a.cld,A)};a.prototype.dispose=function(){this.K6(!1);this.tza(!1);d.a.rc([this.ALa]);this.ALa=null;
v.prototype.dispose.call(this)};a.prototype.c7b=function(A){return k.DOMElementExtensions.r9c(A.target,"tr",!0)};a.prototype.Pu=function(A){if(A){if(!this.lk){var y=this.nn;if(!y||!y.rows.length)return;this.lk=y.rows[0];0<A?A--:A++}y=this.lk;for(var x=0,z=Math.abs(A);x<z;x++)if(0>A){if(!y.previousSibling)break;y=y.previousSibling}else{if(!y.nextSibling)break;y=y.nextSibling}y&&(this.lk=y)}};a.prototype.hkb=function(A,y){k.DOMElementExtensions.toggleCssClass(A,this.cyb.ListTableClassInTouch,y)};a.prototype.K6=
function(A){var y=this.nn;y&&(A&&!this.Oec?(c.a.instance.qa(m.a.click,y,Object(t.a)(this,this.OAb,"onItemClick")),c.a.instance.qa(m.a.Dj,y,Object(t.a)(this,this.Etd,"onItemDoubleClick")),r.a.instance.qa(m.a.pointerDown,y,Object(t.a)(this,this.PAb,"onItemPointerDown")),this.Oec=!0):this.Oec&&(c.a.instance.Ca(m.a.click,y,Object(t.a)(this,this.OAb,"onItemClick")),c.a.instance.Ca(m.a.Dj,y,Object(t.a)(this,this.Etd,"onItemDoubleClick")),r.a.instance.Ca(m.a.pointerDown,y,Object(t.a)(this,this.PAb,"onItemPointerDown")),
this.Oec=!1))};a.prototype.Iza=function(A){var y=null;A&&(y=k.DOMElementExtensions.uj(A,this.cyb.ListCellClass))&&Sys.UI.DomElement.toggleCssClass(y,this.cyb.ListCellSelectedClass);return y};a.prototype.tza=function(A){this.og&&(A&&!this.sQ?(this.ALa=this.Ud.Kd(this.og),this.ALa.la("scroll",Object(t.a)(this,this.onScroll,"onScroll")),this.ALa.la("blur",Object(t.a)(this,this.onBlur,"onBlur")),r.a.instance.qa(m.a.pointerDown,this.domElement,Object(t.a)(this,this.onPointerDown,"onPointerDown")),this.sQ=
!0):this.sQ&&(d.a.Ia(this.ALa),this.ALa=null,r.a.instance.Ca(m.a.pointerDown,this.domElement,Object(t.a)(this,this.onPointerDown,"onPointerDown")),this.sQ=!1))};a.prototype.OAb=function(A){return this.Etd(A)};a.prototype.Etd=function(A){u.g(A.Ga);this.raiseEvent(a.K1a);this.raiseEvent(a.SGd);return!0};a.prototype.epc=function(A){if(A){var y=A.offsetTop,x=this.og.scrollTop;y<x?this.sLf(!0):y+A.offsetHeight>x+this.og.clientHeight&&this.sLf(!1)}};a.prototype.sLf=function(A){this.og.scrollTop=A?this.lk.offsetTop:
this.lk.offsetTop+this.lk.offsetHeight-this.og.clientHeight};a.prototype.onScroll=function(A){u.g(A);this.Tyd();this.raiseEvent(a.K1a)};a.prototype.onBlur=function(A){u.g(A);this.Tyd()};a.prototype.onPointerDown=function(){this.Tyd();this.raiseEvent(a.K1a);this.raiseEvent(a.rNa);return!1};a.prototype.Tyd=function(){w.g(this.$).isEditing&&this.raiseEvent(a.Wdd)};a.prototype.PAb=function(A){var y=A.Ga;y.button&&y.button!==Sys.UI.MouseButton.rightButton||(this.lk=this.c7b(y),this.onPointerDown(A));this.raiseEvent(a.cld);
return!1};Jl.Object.defineProperties(a.prototype,{lk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(A){this.Iza(this._selectedRowListBox);A?(this._selectedRowListBox=A,this.Iza(this._selectedRowListBox),this.epc(A)):this._selectedRowListBox=null}},EZ:{configurable:!0,enumerable:!0,get:function(){return this.cyb.ListCellClass}},Yaa:{configurable:!0,enumerable:!0,get:function(){return this.cyb.ListTableClass}},uC:{configurable:!0,enumerable:!0,get:function(){return 8}},
Ryb:{configurable:!0,enumerable:!0,get:function(){return 5}},Mec:{configurable:!0,enumerable:!0,get:function(){return 24}},Lec:{configurable:!0,enumerable:!0,get:function(){return 35}},og:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.K1a="GotFocus";a.Wdd="IgnoreBlur";a.SGd="SetCell";a.rNa="PointerDown";a.cld="ItemPointerDown";Object(D.a)(a,"ListBox",F.a,[394,7])}}]);

//# sourceMappingURL=EwaDS.kpae.js.map