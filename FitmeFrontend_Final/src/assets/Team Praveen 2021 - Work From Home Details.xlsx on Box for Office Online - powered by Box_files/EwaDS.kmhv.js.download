(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1071:function(D,F,b){function a(z,J){this.$=J;this.Ffc=z;this.fa=J.fa;this.fa.ak(Object(m.a)(this,this.ed,"onSessionIdChanged"));this.r$=y.a.Yje(this.$)}function d(z){this.ej=this.Oxc=null;this._state=0;this.Cf=z;this.lu=this.TK;this.moveNext()}b.r(F);D=b(0);var c=b(15),m=b(37),r=b(35),t=b(193),k=b(127),u=b(32),w=b(1),v=b(64),A=b(52);d.prototype.TK=function(){this.Oxc=this.Cf.$.Zb.Ic("LoadResource","DownloadACopyOperation");
return this.dTd};d.prototype.dTd=function(){var z=b(1071).DownloadACopyOperation;if(this.Cf.r$.j0e||!(this.Oxc.Gc<z.Wfc))return this.N6f;this.ej=A.Task.delay(z.NAe).g();this.ej.isCompleted||(this._state=2,this.ej.LM(Object(m.a)(this,this.moveNext,"moveNext")));return this.Jcb};d.prototype.N6f=function(){var z=b(1071).DownloadACopyOperation;this.Oxc.Gc>=z.Wfc&&c.ULS.sendTraceTag(554997601,0,15,"Download did not complete after 10 seconds.");v.a(this.Cf.$).ld.WI();this._state=3};d.prototype.Jcb=function(){this.ej.Ky();
return this.dTd};d.prototype.dispose=function(){};d.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.lu=this.lu()}catch(z){this.dispose(),this._state=3}};Object(D.a)(d,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[7]);var y=b(1162),x=b(134);b.d(F,"DownloadACopyOperation",function(){return a});a.prototype.m5g=function(){var z=this,J=this.nFg(this.$),B=this.$.userOperationManager.operationCount;0<B&&c.ULS.sendTraceTag(22590611,
0,15,"flushing queue in downloadcopy. Queue is {0}",B);this.$.userOperationManager.y$("DownloadACopyOperation.DownloadForkedFile");this.Ffc&&c.ULS.sendTraceTag(41239586,0,50,"DownloadACopyOperation - Dataloss scenario");this.r$.downloadFile(J,-21742208);w.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?r.TaskExtensions.Da(A.Task.delay(1),function(){z.i0e()},this.r$.ma,3):r.TaskExtensions.Da(A.Task.delay(1),function(){z.BSh()},
this.r$.ma,3)};a.prototype.dispose=function(){this.fa&&this.fa.xk(Object(m.a)(this,this.ed,"onSessionIdChanged"));this.$=this.fa=null};a.prototype.i0e=function(z){var J=this;(z=void 0===z?null:z)||(z=this.$.Zb.Ic("LoadResource","DownloadACopyOperation"));!this.r$.j0e&&z.Gc<a.Wfc?window.setTimeout(function(){J.i0e(z)},a.NAe):(z.Gc>=a.Wfc&&c.ULS.sendTraceTag(22590613,0,15,"Download did not complete after 10 seconds."),v.a(this.$).ld.WI())};a.prototype.BSh=function(){new d(this)};a.prototype.nFg=function(z){var J=
new Sys.StringBuilder,B=z.workbookContext,C=z.Ba;J.append(z.G_);J.append(C.FileHandlerRelativeUri);J.append("?id=");J.append(encodeURIComponent(t.a.nEb(B.WorkbookUri,"sc")));z.fa.pc&&(J.append("&sessionId="),J.append(encodeURIComponent(z.fa.sessionId)));J.append("&workbookType=FullForkedWorkbook");J.append("&dataloss=");J.append(this.Ffc?"true":"false");k.a.yEa(J,C);return J.toString()};a.prototype.ed=function(){u.a.yg(v.a(this.$).ld.activityState,x.a.Zrd)||this.r$.reset()};a.Wfc=1E5;a.NAe=100;Object(D.a)(a,
"DownloadACopyOperation",null,[7])},1154:function(D,F,b){function a(t,k){t=r.call(this,t,k)||this;d.ULS.sendTraceTag(51222469,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");t.title="";t.message=a.fwa;t.oJa=!0;return t}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(49),m=b(75);b=b(812);var r=b.a;Cm(a,r);a.prototype.Kka=function(t){r.prototype.Kka.call(this,t);c.a.openWindow(4,m.a.DG(a.aef))};a.prototype.bK=function(t){r.prototype.bK.call(this,t);a.pod&&a.pod(null)};
a.initialize=function(t,k,u,w){d.ULS.sendTraceTag(51222468,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.fwa=t;a.bef=k;a.aef=u;a.pod=w};Jl.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.bef}}});a.fwa=null;a.bef=null;a.aef=null;a.pod=null;Object(D.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1155:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.q$g="ewa-bb";a.s$g="ewa-bb-entry";a.t$g="ewa-bb-entry-body";a.z$g=
"ewa-bb-icon";a.v$g="ewa-bb-entry-icon";a.y$g="ewa-bb-entry-title";a.x$g="ewa-bb-entry-message";a.cEe="ewa-bb-entry-button";a.w$g="ewa-bb-entry-link";a.u$g="ewa-bb-entry-close";a.dEe="ewa-bb-entry-button-holder";a.B3c="ewa-nov2-ltr";a.r$g="ewa-bb-content";a.D3c="ewa-nov2-rtl";Object(D.a)(a,"CssClassNames",null,[])},1156:function(D,F,b){function a(c,m){c=d.call(this,c,m)||this;c.MG=!0;c.title=a.Cna;c.message=a.Ana;return c}b.d(F,"a",function(){return a});D=b(0);b=b(812);var d=b.a;Cm(a,d);a.prototype.pq=
function(c){d.prototype.pq.call(this,c);(c=a.Bna)&&c(null)};a.initialize=function(c,m,r,t){a.Cna=c;a.Ana=m;a.zna=r;a.Bna=t};Jl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.zna}}});a.Cna=null;a.Ana=null;a.zna=null;a.Bna=null;Object(D.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1157:function(D,F,b){function a(c,m){c=d.call(this,c,m)||this;c.MG=!0;c.title=a.Cna;c.message=a.Ana;return c}b.d(F,"a",function(){return a});D=b(0);b=
b(812);var d=b.a;Cm(a,d);a.prototype.pq=function(c){d.prototype.pq.call(this,c);(c=a.Bna)&&c(null)};a.initialize=function(c,m,r,t){a.Cna=c;a.Ana=m;a.zna=r;a.Bna=t};Jl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.zna}}});a.Cna=null;a.Ana=null;a.zna=null;a.Bna=null;Object(D.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1158:function(D,F,b){function a(c,m){c=d.call(this,c,m)||this;c.MG=!0;c.title=a.Cna;c.message=a.Ana;return c}
b.d(F,"a",function(){return a});D=b(0);b=b(812);var d=b.a;Cm(a,d);a.prototype.pq=function(c){d.prototype.pq.call(this,c);(c=a.Bna)&&c(null)};a.initialize=function(c,m,r,t){a.Cna=c;a.Ana=m;a.zna=r;a.Bna=t};Jl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.zna}}});a.Cna=null;a.Ana=null;a.zna=null;a.Bna=null;Object(D.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1159:function(D,F,b){function a(c,m){c=d.call(this,c,m)||this;c.MG=!0;
c.title=a.Iyb;c.message=a.fwa;return c}b.d(F,"a",function(){return a});D=b(0);b=b(812);var d=b.a;Cm(a,d);a.prototype.pq=function(c){d.prototype.pq.call(this,c);a.hwa&&a.hwa(null)};a.initialize=function(c,m,r,t){a.Iyb=c;a.fwa=m;a.z5a=r;a.hwa=t};Jl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.z5a}}});a.Iyb=null;a.fwa=null;a.z5a=null;a.hwa=null;Object(D.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1160:function(D,
F,b){function a(c,m){c=d.call(this,c,m)||this;a.z5a&&a.hwa&&(c.MG=!0);c.title=a.Iyb;c.message=a.fwa;return c}b.d(F,"a",function(){return a});D=b(0);b=b(812);var d=b.a;Cm(a,d);a.prototype.pq=function(c){d.prototype.pq.call(this,c);a.hwa&&a.hwa(null)};a.initialize=function(c,m,r,t){a.Iyb=c;a.fwa=m;a.z5a=r;a.hwa=t};Jl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.z5a}}});a.Iyb=null;a.fwa=null;a.z5a=null;a.hwa=null;Object(D.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",
b.a,[])},1161:function(D,F,b){function a(t,k,u,w,v,A){this.oX=t;this.pX=k;this.cEc=u;this.kD=w;this.fOb=v;this.ASa=A}b.d(F,"a",function(){return a});D=b(0);var d=b(1218),c=b(5),m=b(51),r=b(88);a.prototype.XMi=function(t){this.gjf(t)};a.prototype.T$h=function(t){this.gjf(t)};a.prototype.gjf=function(t){var k=10;1===t?(r.a.instance.resolve("Common.IOfficeTrialExperience").Aec(this.ASa),k=3):2===t&&((!this.cEc||this.cEc(this.kD))&&this.pX&&d.a.instance.SVg(this.pX,this.oX,this.kD),k=5);t&&1!==t||this.oX&&
this.oX(this.kD);c.AFrameworkApplication.Knc(m.a.Duf,this.fOb,k);this.dispose()};a.prototype.dispose=function(){this.kD=this.pX=this.oX=null};Jl.Object.defineProperties(a.prototype,{pTf:{configurable:!0,enumerable:!0,get:function(){return!this.pX&&!this.cEc}},Pif:{configurable:!0,enumerable:!0,get:function(){return 2===this.ASa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},DDe:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},Z_e:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},yua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},KZe:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},iUb:{configurable:!0,enumerable:!0,get:function(){return 2===this.ASa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:
CommonUIStrings.l_OICErrorC2RInstallButton}},$n:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(D.a)(a,"AOICErrorDialogWithTrial",null,[7])},1162:function(D,F,b){function a(y,x){var z=A.call(this,y)||this;z.yzj=["id","sessionId","workbookType","workbookFileType","dataloss"];z.command=0;z.iframe=y;z.$=x;z.tc.la("load",Object(m.a)(z,z.IAb,"onFrameLoad"));return z}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(49),m=b(37);F=b(227);var r=b(193),
t=b(39),k=b(6),u=b(33),w=b(64),v=b(603),A=F.a;Cm(a,A);a.prototype.downloadFile=function(y,x){var z={};(y=this.Vjh(y,z))&&c.a.Qkc("dlfr",y,z);this.command=x};a.prototype.Vjh=function(y,x){var z=y.split("?");if(2!==z.length)return y=null,d.ULS.sendTraceTag(38852812,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),y;z=z[1].split("&");z=Ml(z);for(var J=z.next();!J.done;J=z.next()){var B=J.value.split("=",2);if(2!==B.length){y=null;d.ULS.sendTraceTag(38852813,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}J=B[0];Array.contains(this.yzj,J)&&(B=decodeURIComponent(B[1]),x[J]=B,y=r.a.nEb(y,J))}return y};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.IAb=function(){var y=this.Syh();if(y){this.$.xH(!0);if(-2028960985!==this.command&&1461300262!==this.command){var x=w.a(this.$).ld.activityState;x[u.a.RVa]=k.a.download;x[v.a.XNc]=
this.command}t.a(this.$).Yt(y.Errors)}};a.prototype.Syh=function(){try{return this.iframe.contentWindow.ewaResult}catch(x){if(!this.$.fa.mc.isDivSyndicated){var y=window.document.referrer.match(RegExp("://(.[^/]+)/"));d.ULS.sendTraceTag(39076571,0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<y.length?y[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.bva);throw x;}return null}};a.Yje=
function(y){var x=document.createElement("iframe");x.id="ewaFileLoader";x.style.cssText="height:0;width:0;display:none";x.src="about:blank";x.setAttribute("name","dlfr");x=y.domElement.appendChild(x);return new a(x,y)};Jl.Object.defineProperties(a.prototype,{j0e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(D.a)(a,"FileLoader",F.a,[])},1163:function(D,F,b){function a(){this.BaseDocQuerySignature=
null;this.RoamingApp=0}b.d(F,"a",function(){return a});D=b(0);var d=b(1319),c=b(5),m=b(41),r=b(75);a.prototype.wGd=function(){return m.c([this.eia(),this])};a.prototype.execute=function(t,k,u){var w="RoamingAppsHandler.ashx";d.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=r.a.Mk(w,"wdEnableRoaming","1"));c.AFrameworkApplication.Md.Wl(w,2,this.wGd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.q1a(),t,k,u,void 0,void 0,void 0,void 0,"6")};
Object(D.a)(a,"ARoamingAppsRequest",null,[])},1166:function(D,F,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}b.d(F,"a",function(){return a});D=b(0);Object(D.a)(a,"PrintPreviewPaneProps",null,[])},1211:function(D,F,b){function a(vb,kc){kc=Ab.call(this,kc)||this;kc.zoh=L.DOMElementExtensions.gq+",div";kc.C2=Array(63);
kc.ym=!1;kc.wb=vb;kc.set_visible(!1);kc.addCssClass(ea.a.q$g);H.KeyInputManager.instance.qa(W.a.Rb,kc.Nb,Object(Y.a)(kc,kc.rV,"onKeyEvent"));ja.a(vb).$g(kc);return kc}function d(vb,kc){vb=ia.call(this,vb,kc)||this;vb.BAa=Kb.a.H0b();vb.MG=!0;vb.rua=vb.BAa.Izj;vb.title=vb.BAa.title;vb.message=vb.BAa.message;return vb}function c(vb,kc){vb=va.call(this,vb,kc)||this;vb.MG=!0;vb.title="";return vb}function m(vb,kc){kc=ta.call(this,vb,kc)||this;kc.policyManager=vb.$.ea.Ea(274,void 0);if(!kc.policyManager)return C.ULS.sendTraceTag(34402885,
306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),kc;kc.message=kc.policyManager.Ckc;kc.title=kc.policyManager.title;kc.oJa=!0;return kc}function r(vb,kc){vb=Ra.call(this,vb,kc)||this;vb.MG=!0;vb.rua=!0;return vb}function t(vb,kc,td,Oc){vb=ca.call(this,vb,kc)||this;vb.bub=td;vb.command=Oc;vb.oJa=!0;vb.MG=!0;return vb}function k(vb,kc,td){vb=Ha.call(this,vb,kc)||this;vb.bub=td;vb.oJa=!0;return vb}function u(vb,kc,td){vb=Gb.call(this,vb,kc)||this;vb.bub=
td;vb.MG=!0;return vb}function w(vb,kc){vb=sb.call(this,vb,kc)||this;vb.MG=!0;vb.rua=!1;return vb}function v(vb,kc){vb=ib.call(this,vb,kc)||this;vb.MG=!0;vb.rua=!0;return vb}function A(vb,kc,td,Oc,tc,sc,ic){return y.call(this,vb,0,kc,td,Oc,tc,sc,ic)||this}function y(vb,kc,td,Oc,tc,sc,ic,Ga){this.pI=this.o7=this.QW=0;this.v$f=vb;this.Wpj=kc;this.nO=td;this.Ldg=ic;this.Jfb=fa.a.Dv(Ga);this.Mbg=Ga;Oc&&(this.QW=Oc);tc&&(this.o7=tc);sc&&(this.pI=sc)}function x(vb,kc,td,Oc,tc){vb=z.call(this,vb,kc,td,Oc)||
this;vb.command=tc;vb.rua=!0;return vb}function z(vb,kc,td,Oc){vb=na.call(this,vb,kc)||this;vb.error=td;vb.options=Oc;vb.error&&vb.options&2&&(vb.message=vb.error.Description);vb.error&&vb.options&1&&(vb.title=vb.error.Caption);vb.MG=!(Oc&4);return vb}function J(vb,kc,td){return B.call(this,vb,kc,td)||this}function B(vb,kc,td){vb=Sa.call(this,vb,kc)||this;vb.MG=!0;vb.command=td;return vb}b.r(F);D=b(0);var C=b(15),H=b(120),W=b(13),S=b(90),N=b(86),T=b(51),fa=b(30),Y=b(37),L=b(11),P=b(227),ea=b(1155),
X=b(4),ja=b(254),R=b(1156),ba=b(812),ha=b(1236),oa=b(92),Sa=ba.a;Cm(B,Sa);B.prototype.pq=function(vb){Sa.prototype.pq.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(this.command,vb,this.businessBar.$.jd,10,null))};Object(D.a)(B,"CommandActionBusinessBarEntry",ba.a,[]);Cm(J,B);J.prototype.bK=function(vb){B.prototype.bK.call(this,vb)};Object(D.a)(J,"EditAttemptReadOnlyBusinessBarEntry",B,[]);var ma=b(39),na=ba.a;Cm(z,na);z.prototype.pq=function(vb){na.prototype.pq.call(this,vb);this.error.Appearance&=
-33;ma.a(this.businessBar.$).Yt([this.error])};Object(D.a)(z,"ErrorBusinessBarEntry",ba.a,[]);Cm(x,z);x.prototype.Bka=function(vb){z.prototype.Bka.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(this.command,vb,this.businessBar.$.jd,10,null))};Object(D.a)(x,"ErrorAndCommandBusinessBarEntry",z,[]);var xa=b(16);y.da=function(vb){return xa.a.instance.da(vb)};Jl.Object.defineProperties(y.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return y.da(this.Wpj)}},message:{configurable:!0,enumerable:!0,
get:function(){return y.da(this.nO)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.nO}},imb:{configurable:!0,enumerable:!0,get:function(){return this.v$f}},actionButton:{configurable:!0,enumerable:!0,get:function(){return y.da(this.QW)}},oWb:{configurable:!0,enumerable:!0,get:function(){return y.da(this.o7)}},link:{configurable:!0,enumerable:!0,get:function(){return y.da(this.pI)}},Rj:{configurable:!0,enumerable:!0,get:function(){return this.Ldg}},hash:{configurable:!0,enumerable:!0,
get:function(){return this.Jfb}},alt:{configurable:!0,enumerable:!0,get:function(){var vb=b(1211).BusinessBarControl;switch(this.Rj){case vb.g$:return y.da(26);case vb.yF:return y.da(25);case vb.sk:return y.da(24);default:return y.da(0)}}},U2c:{configurable:!0,enumerable:!0,get:function(){return this.Mbg}}});Object(D.a)(y,"EwaBusinessBarEntry",null,[]);Cm(A,y);Jl.Object.defineProperties(A.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(D.a)(A,"EwaNoTitleBusinessBarEntry",
y,[]);var Oa=b(68),ib=ba.a;Cm(v,ib);v.prototype.pq=function(vb){ib.prototype.pq.call(this,vb);this.set_visible(!1);this.businessBar.$.DH();this.businessBar.$.Na.Xb(new oa.a(1038998010,vb,this.businessBar.$.jd,10,null))};v.prototype.Bka=function(vb){ib.prototype.Bka.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(-722953877,vb,this.businessBar.$.jd,10,null))};v.prototype.bK=function(vb){this.businessBar.removeEntry(53);Oa.g(vb)};Object(D.a)(v,"ExternalLinksEnableContentBusinessBarEntry",ba.a,[]);var sb=
ba.a;Cm(w,sb);w.prototype.pq=function(vb){sb.prototype.pq.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(-722953877,vb,this.businessBar.$.jd,10,null))};w.prototype.bK=function(vb){this.businessBar.removeEntry(5);Oa.g(vb)};Object(D.a)(w,"ExternalLinksShowErrorBusinessBarEntry",ba.a,[]);var nb=b(9),Gb=ba.a;Cm(u,Gb);u.prototype.pq=function(vb){Gb.prototype.pq.call(this,vb);nb.HelperMethods.y5(this.businessBar.$.uF,this.bub,this.businessBar.$.yR)};Object(D.a)(u,"HelpButtonBusinessBarEntry",ba.a,[]);
var Ha=ba.a;Cm(k,Ha);k.prototype.Kka=function(vb){Ha.prototype.Kka.call(this,vb);nb.HelperMethods.y5(this.businessBar.$.uF,this.bub,this.businessBar.$.yR)};Object(D.a)(k,"HelpTextBusinessBarEntry",ba.a,[]);var ca=ba.a;Cm(t,ca);t.prototype.pq=function(vb){ca.prototype.pq.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(this.command,vb,this.businessBar.$.jd,10,null))};t.prototype.Kka=function(vb){ca.prototype.Kka.call(this,vb);var kc=new oa.a(-859308420,vb,this.businessBar.$.jd,12,null),td={};vb=(td.CommandValueId=
"HelpID="+this.bub,td.InputMethod=vb,td.MenuItemId=X.a.bZ,td.EnabledInViewMode=!0,td);this.businessBar.$.Na.Xb(kc,vb)};Object(D.a)(t,"HelpTextTaskPaneAndCommandBusinessBarEntry",ba.a,[]);var Ra=ba.a;Cm(r,Ra);r.prototype.pq=function(vb){Ra.prototype.pq.call(this,vb);this.set_visible(!1);this.businessBar.$.DH();this.businessBar.$.Na.Xb(new oa.a(-1081442996,vb,this.businessBar.$.jd,10,null))};r.prototype.Bka=function(vb){Ra.prototype.Bka.call(this,vb);this.businessBar.$.Na.Xb(new oa.a(1702917262,vb,
this.businessBar.$.jd,10,null))};r.prototype.bK=function(vb){this.businessBar.removeEntry(57);Oa.g(vb)};Object(D.a)(r,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ba.a,[]);var ua=b(1158),ta=ba.a;Cm(m,ta);m.prototype.Kka=function(vb){ta.prototype.Kka.call(this,vb);(vb=this.policyManager.ovi)&&vb(null)};Jl.Object.defineProperties(m.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(D.a)(m,"PolicyBusinessBarEntry",ba.a,[]);var db=
b(1157),Ta=b(1160),qb=b(1159);b(406);var za=b(173),Ia=b(29),va=ba.a;Cm(c,va);c.prototype.pq=function(vb){va.prototype.pq.call(this,vb);za.c(Ia.a.mki);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(D.a)(c,"UnsupportedBrowserBusinessBarEntry",ba.a,[]);var Ua=b(1154),Kb=b(1252),ia=ba.a;Cm(d,ia);d.prototype.pq=function(vb){ia.prototype.pq.call(this,vb);this.BAa.mkf(null)};d.prototype.Bka=function(vb){ia.prototype.Bka.call(this,vb);this.BAa.pkf(null)};d.prototype.bK=
function(vb){ia.prototype.bK.call(this,vb);this.BAa.Dze(null)};Jl.Object.defineProperties(d.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.BAa.Dme}},oWb:{configurable:!0,enumerable:!0,get:function(){return this.BAa.Fme}}});Object(D.a)(d,"WildFireMobileAppBusinessBarEntry",ba.a,[]);var E=b(241),fb=b(7),Za=b(261),ec=b(164),zc=b(47);b.d(F,"BusinessBarControl",function(){return a});var Ab=P.a;Cm(a,Ab);a.prototype.rV=function(vb){if(vb.Ga.keyCode===S.a.hB){var kc=this.Nb.querySelectorAll(this.zoh),
td=L.DOMElementExtensions.Cl(kc);kc=L.DOMElementExtensions.Iy(kc);return L.DOMElementExtensions.Kca(vb.Ga,td,kc)}return!1};a.prototype.Ye=function(vb,kc){kc||L.DOMElementExtensions.setFocus(this.domElement.firstChild);return!kc};a.prototype.Lh=function(vb){return L.DOMElementExtensions.jf(this.Nb,vb)};a.prototype.vi=function(){};a.prototype.ei=function(){};a.prototype.dispose=function(){this.ym||(H.KeyInputManager.instance.Ca(W.a.Rb,this.Nb,Object(Y.a)(this,this.rV,"onKeyEvent")),N.a.rc(this.C2),
this.C2=Array(63),this.wb=null,Ab.prototype.dispose.call(this),this.ym=!0)};a.prototype.t3a=function(vb){if(!this.get_visible())return!1;vb=this.C2[vb];return!!vb&&vb.isVisible};a.prototype.ND=function(vb){return!!this.C2[vb]};a.prototype.CI=function(vb,kc,td){td=void 0===td?null:td;var Oc=!1;if(this.ND(vb))td=this.C2[vb].get_visible();else{this.set_visible(!0);var tc=a.fWe()[vb];this.C2[vb]=this.Pra(vb,kc,td);td=!1;Oc=!0;var sc="",ic=0;kc&&(sc=kc.MessageIdName,ic=kc.MessageId);var Ga=tc.U2c;C.ULS.sendTraceTag(38887428,
0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",vb,zc.PageLoadTrackingInfo.instance.QIa(new Date));ec.a(this.$).UCd(tc.hash,sc,ic,T.a.lvc,!0,1,kc,Ga)}td||!Array.contains(ha.a.g9b(),vb)&&!Oc||(this.C2[vb].set_visible(!0),this.$.DH())};a.prototype.removeEntry=function(vb){return this.URi(vb)};a.prototype.cBd=function(){N.a.rc(this.C2);this.C2=Array(63);this.set_visible(!1)};a.prototype.URi=function(vb){if(!this.ND(vb))return!1;N.a.Ia(this.C2[vb]);this.C2[vb]=null;this.domElement.hasChildNodes()||
this.set_visible(!1);this.$.DH();return!0};a.prototype.Pra=function(vb,kc,td){td=void 0===td?null:td;var Oc=a.fWe()[vb],tc=!!(this.$.Gd&64);switch(vb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:vb=new ba.a(this,Oc);break;case 12:case 29:case 30:case 31:case 32:case 55:vb=tc?new B(this,Oc,-8805455):new ba.a(this,Oc);break;case 22:vb=new J(this,Oc,-8805455);break;case 44:case 43:vb=tc?new x(this,Oc,kc,0,-8805455):new z(this,Oc,kc,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:vb=
new z(this,Oc,kc,0);break;case 19:vb=new ba.a(this,Oc);break;case 45:vb=new z(this,Oc,kc,0);break;case 6:case 14:vb=new u(this,Oc,kc.HelpTopicId);break;case 36:vb=new k(this,Oc,X.a.b_g);break;case 16:vb=new ba.a(this,Oc);vb.title=fa.a.gg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);vb.message=fa.a.gg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:vb=new B(this,Oc,-1762562205);vb.m$b=!0;break;case 20:vb=new d(this,Oc);break;case 21:case 54:vb=new ba.a(this,Oc);
break;case 28:vb=new ba.a(this,Oc);break;case 24:vb=new c(this,Oc);break;case 27:vb=new m(this,Oc);break;case 37:vb=new Ua.a(this,Oc);break;case 38:vb=new R.a(this,Oc);break;case 39:vb=new db.a(this,Oc);break;case 40:vb=new ua.a(this,Oc);break;case 46:vb=new ba.a(this,Oc);break;case 47:vb=new ba.a(this,Oc);break;case 48:vb=new ba.a(this,Oc);break;case 49:vb=new ba.a(this,Oc);break;case 50:vb=new ba.a(this,Oc);break;case 51:vb=new qb.a(this,Oc);break;case 52:vb=new Ta.a(this,Oc);break;case 53:vb=new v(this,
Oc);break;case 5:vb=new w(this,Oc);break;case 56:vb=new B(this,Oc,-1753056834);kc?(kc=kc.Directive,fb.a.io(kc)||"&nbsp;"===kc||(vb.message=kc)):fb.a.na(td)||(vb.message=td);break;case 57:vb=new r(this,Oc);break;case 58:vb=new ba.a(this,Oc);break;case 59:case 62:vb=new k(this,Oc,X.a.cmi);break;case 60:vb=new t(this,Oc,X.a.SAg,-8805455);break;case 61:vb=new B(this,Oc,515196233);break;default:vb=new z(this,Oc,kc,7)}vb.GYc();return vb};a.fWe=function(){var vb=Za.a.E3a()?247:246;return a.ume||(a.ume=[new y(0,
262,263,264,0,0,a.g$,"BB_UnableToRefreshLock"),new y(1,262,263,264,0,0,a.g$,"BB_UnableToRefreshLockExpected"),new y(2,254,255,0,0,0,a.yF,"BB_WorkbookAlmostTooLarge"),new y(3,256,257,258,0,0,a.g$,"BB_WorkbookTooLarge"),new y(4,245,vb,0,0,0,a.yF,"BB_ExternalWorkbookLinksDisabled"),new y(5,249,248,250,0,0,a.g$,"BB_ExternalWorkbookLinksShowError"),new y(6,251,252,253,0,0,a.sk,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new y(7,237,238,239,0,0,a.sk,"BB_UnsupportedFeatures"),new y(8,0,0,0,0,0,a.sk,"BB_CollabDataAndDataStringsLocaleMismatch"),
new y(9,0,0,0,0,0,a.sk,"BB_CollabDataStringsLocaleMismatch"),new y(10,0,0,0,0,0,a.sk,"BB_CollabDataLocaleMismatch"),new y(11,265,266,267,0,0,a.g$,"BB_LastGenericStatusError"),new y(12,268,269,270,0,0,a.yF,"BB_ScratchPadWarning"),new y(13,271,272,273,0,0,a.g$,"BB_AuthenticationLost"),new y(14,274,275,276,0,0,a.yF,"BB_OdfCompatibilityIssues"),new y(15,0,553,0,0,0,a.yF,"BB_PivotChartInteractivityMissingWarning"),new y(16,0,0,0,0,0,a.sk,"BB_WorkbookIsIrmProtected"),new y(17,0,0,0,0,0,a.sk,"BB_BIFeatureNotAvailable"),
new y(18,277,278,273,0,0,a.yF,"BB_AnonymousCreateMode"),new y(19,240,241,0,0,0,a.yF,"BB_UnsupportedInteractiveReportEditing"),new y(20,0,0,0,0,0,a.sk,"BB_MobileAppCampaignBizBar"),new y(21,283,284,0,0,0,a.sk,"BB_TransientServerCommunicationFailures"),new y(22,1570,1581,1582,0,0,a.sk,"BB_EditAttemptInReadOnly"),new y(23,1570,1581,0,0,0,a.sk,"BB_EditAttemptInReadOnlyNoEditPermissions"),new y(24,0,nb.HelperMethods.jvj(),1559,0,0,a.sk,"BB_UnsupportedBrowser"),new y(25,286,287,0,0,0,a.sk,"BB_ReadOnlyPermissions"),
new y(26,288,289,0,0,0,a.sk,"BB_DocumentIsIrmProtectedWarning"),new y(27,0,0,0,0,0,a.yF,"BB_PolicyWarningMessage"),new y(28,1220,285,0,0,0,a.sk,"BB_WorkingOnIt"),new y(29,1570,1568,1569,0,0,a.sk,"BB_PasswordProtectedWorkbookLockedForEdit"),new y(30,1583,1584,1585,0,0,a.sk,"BB_WorkbookIsReadOnlyRecommended"),new y(31,1570,1586,1587,0,0,a.sk,"BB_WorkbookHasPasswordToModify"),new y(32,1570,1588,1591,0,0,a.sk,"BB_LegacySharedWorkbookEditWarning"),new y(33,1578,1589,239,0,0,a.sk,"BB_LegacyConnectionsWarning"),
new y(34,1579,1580,0,0,0,a.sk,"BB_GroupedSlicers"),new y(35,299,300,0,0,0,a.yF,"BB_ThirdPartyAddinDisabled"),new y(36,1711,1712,0,0,1713,a.sk,"BB_FinanceLinkedEntityDisclaimerBar"),new y(37,0,0,0,0,0,a.sk,"BB_WacGdprNotice"),new y(38,0,0,0,0,0,a.sk,"BB_AutomaticSensitivityLabel"),new y(39,0,0,0,0,0,a.sk,"BB_RecommendedSensitivityLabel"),new y(40,0,0,0,0,0,a.sk,"BB_MandatorySensitivityLabel"),new y(41,301,302,303,0,0,a.sk,"BB_LocalStorageDisabled"),new y(42,610,611,0,0,0,a.sk,"BB_AutoRefreshDisabled"),
new y(43,961,959,963,1249,0,a.sk,"BB_CorruptedFileRepaired"),new y(44,962,960,963,1249,0,a.sk,"CorruptedOdsFileRepaired"),new y(45,259,260,261,0,0,a.yF,"BB_MinorVersionLimitReached"),new y(46,290,291,0,0,0,a.yF,"BB_SensitivityApplicationGenericError"),new y(47,292,294,0,0,0,a.yF,"BB_SensitivityApplicationTooLargeFileError"),new y(48,293,294,0,0,0,a.yF,"BB_SensitivityApplicationLabelNotSupportedError"),new y(49,295,296,0,0,0,a.yF,"BB_SensitivityApplicationLabelDisabledError"),new y(50,297,298,0,0,
0,a.yF,"BB_SensitivityApplicationMandatoryConflictError"),new y(51,0,0,0,0,0,a.yF,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new y(52,0,0,0,0,0,a.yF,"BB_SensitivityApplicationSetLabelError"),new y(53,2025,2026,2027,2030,0,a.sk,"BB_ExternalWorkbookLinksPromptEnableContent"),new y(54,283,284,0,0,0,a.sk,"BB_NetworkDown"),new y(55,304,305,306,0,0,a.sk,"BB_DefaultToViewDueToCogs"),new y(56,1737,1738,1739,0,0,a.sk,"BB_RefreshLinkedEntityErrorBar"),new y(57,1714,1715,1716,1717,0,a.sk,"BB_LinkedEntitiesUntrustedImagesDisabled"),
new A(58,236,0,0,0,a.sk,"BB_CanvasHealth"),new y(59,307,308,0,0,309,a.sk,"BB_NovModeDepreciation"),new y(60,964,965,1249,0,966,a.sk,"BB_MismatchedFileFormatConverted"),new y(61,2126,2127,2128,0,0,a.sk,"BB_OptimizeWorkbook"),new y(62,310,311,0,0,312,a.sk,"BB_NovModePostDepreciation")])};Jl.Object.defineProperties(a.prototype,{he:{configurable:!0,enumerable:!0,get:function(){return E.a.fTc}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,
get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.g$="ewa-mb-error";a.yF="ewa-mb-warning";a.sk="ewa-mb-info";a.ume=null;Object(D.a)(a,"BusinessBarControl",P.a,[135])},1218:function(D,F,b){function a(){this.jgb=!!v.AFrameworkApplication.za&&v.AFrameworkApplication.za.Za.Ju}function d(C,H,W){var S=r.call(this,C,H,W)||this;C={};C=(C.errorMessage=S.EDe,C.errorFileDownloadOffer=S.iqb,C);H={};C.helpLink=(H.type="AppLinkProps",H.id="helpLink",
H.text=S.yua,H.onExecute=function(N){S.vMa(N)},H);H=new B.a(!1,!1,!0);H.lc=1;H.Dc(1,S.jqb);H.We=S.id;W={};C=(W.id=S.id,W.dialogIcon=S.icon,W.bodyControls=C,W);H.initializeAndShow(S.$n,Object(u.a)(S,S.szd,"reactOICErrorDialogHandler"),C);return S}function c(C,H,W,S){var N=k.call(this,C,H,W,S)||this;C={};C=(C.errorMessage=N.errorMessage,C);H={};C.helpLink=(H.type="AppLinkProps",H.id="helpLink",H.text=N.yua,H.onExecute=function(T){N.vMa(T)},H);N.Krc?(C.macOfficePreLinkText=N.vef,H={},C.macOfficeLink=
(H.type="AppLinkProps",H.id="macOfficeLink",H.text=N.sef,H.onExecute=function(T){N.$rd(T)},H),C.macOfficePostText=N.uef):N.y_b&&(C.errorFileDownloadOffer=N.iqb);H=new B.a(!1,!1,!0);N.y_b?(H.lc=1,H.Dc(1,N.jqb)):H.lc=0;H.We=N.id;W={};C=(W.id=N.id,W.dialogIcon=N.icon,W.bodyControls=C,W);H.initializeAndShow(N.$n,Object(u.a)(N,N.szd,"reactOICErrorDialogHandler"),C);return N}function m(C,H,W){C=r.call(this,C,H,W)||this;C.Sl=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=C.EDe;
H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));C.Sl=document.createElement("a");C.Sl.href="#";C.Sl.innerText=C.yua;H.appendChild(C.Sl);z.a.addHandler(C.Sl,"click",Object(u.a)(C,C.vMa,"oicErrorHelpLinkHandler"));H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));W=document.createElement("span");W.innerText=C.iqb;H.appendChild(W);W=new J.StandardDialog;W.We=C.id;W.lc=1;W.Dc(1,C.jqb);W.Hl(C.$n,null,C.icon,Object(u.a)(C,C.Amd,
"legacyOICErrorDialogHandler"),H);W.kW("errorMessageText");return C}function r(C,H,W){this.oX=H;this.pX=C;this.kD=W}function t(C,H,W,S){C=k.call(this,C,H,W,S)||this;C.Sl=null;C.Zoa=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=C.errorMessage;H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));C.Sl=document.createElement("a");C.Sl.href="#";C.Sl.innerText=C.yua;H.appendChild(C.Sl);z.a.addHandler(C.Sl,"click",Object(u.a)(C,C.vMa,"oicErrorHelpLinkHandler"));
W=new J.StandardDialog;W.We=C.id;if(C.Krc){S=document.createElement("span");var N=document.createElement("span");S.innerText=C.vef;N.innerText=C.uef;C.Zoa=document.createElement("a");C.Zoa.href="#";C.Zoa.innerText=C.sef;H.appendChild(document.createElement("br"));H.appendChild(S);H.appendChild(C.Zoa);H.appendChild(N);z.a.addHandler(C.Zoa,"click",Object(u.a)(C,C.$rd,"oicErrorMacOfferLinkHandler"))}else C.y_b&&(H.appendChild(document.createElement("br")),H.appendChild(document.createElement("br")),
S=document.createElement("span"),S.innerText=C.iqb,H.appendChild(S));C.y_b?(W.lc=1,W.Dc(1,C.jqb)):W.lc=0;W.Hl(C.$n,null,C.icon,Object(u.a)(C,C.Amd,"legacyOICErrorDialogHandler"),H);W.kW("errorMessageText");return C}function k(C,H,W,S){this.iHc=null;this.fOb=S;this.oX=C;this.pX=H;this.kD=W;this.z9d=this.tef.mdj;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Qfg=C[0];this.Pfg=C[1]}D=b(0);var u=b(37),w=b(15),v=b(5),A=b(51),y=b(406),x=b(88);k.prototype.szd=function(C){this.bAb(C)};k.prototype.Amd=
function(C){this.bAb(C)};k.prototype.bAb=function(C){var H=10;this.pX&&1===C&&(this.pX(this.kD),H=1);this.oX&&this.oX(this.kD);this.dF(H)};k.prototype.vMa=function(){y.Redirect.showHelp("OICFailure");this.dF(2)};k.prototype.$rd=function(){this.tef.waf();this.dF(4)};k.prototype.dF=function(C){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.fOb,C);v.AFrameworkApplication.Knc(A.a.Buf,this.fOb,C)};k.prototype.dispose=function(){this.kD=this.oX=this.pX=
null};Jl.Object.defineProperties(k.prototype,{tef:{configurable:!0,enumerable:!0,get:function(){return this.iHc||(this.iHc=x.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},yua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Krc:{configurable:!0,enumerable:!0,get:function(){return this.z9d}},
vef:{configurable:!0,enumerable:!0,get:function(){return this.Qfg}},uef:{configurable:!0,enumerable:!0,get:function(){return this.Pfg}},sef:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.z9d?3:2}},iqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},y_b:{configurable:!0,enumerable:!0,get:function(){return!!this.pX}},jqb:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},$n:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(D.a)(k,"AOICErrorDialog",null,[7]);var z=b(40),J=b(128);Cm(t,k);t.prototype.dispose=function(){this.Sl&&(z.a.removeHandler(this.Sl,"click",Object(u.a)(this,this.vMa,"oicErrorHelpLinkHandler")),this.Sl=null);this.Zoa&&(z.a.removeHandler(this.Zoa,"click",Object(u.a)(this,this.$rd,"oicErrorMacOfferLinkHandler")),this.Zoa=null);
k.prototype.dispose.call(this)};Object(D.a)(t,"OICErrorDialog",k,[]);r.prototype.szd=function(C){this.bAb(C)};r.prototype.Amd=function(C){this.bAb(C)};r.prototype.bAb=function(C){var H=10;1===C&&(this.pX(this.kD),H=1);this.oX&&this.oX(this.kD);this.dF(H)};r.prototype.vMa=function(){y.Redirect.showHelp("OICFailure");this.dF(2)};r.prototype.dF=function(C){v.AFrameworkApplication.Knc(A.a.Cuf,3,C)};r.prototype.dispose=function(){this.kD=this.pX=this.oX=null};Jl.Object.defineProperties(r.prototype,{id:{configurable:!0,
enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},EDe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},yua:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},iqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},jqb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,
get:function(){return 2}},$n:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(D.a)(r,"AOICErrorDialogWithDownload",null,[7]);Cm(m,r);m.prototype.dispose=function(){this.Sl&&(z.a.removeHandler(this.Sl,"click",Object(u.a)(this,this.vMa,"oicErrorHelpLinkHandler")),this.Sl=null);r.prototype.dispose.call(this)};Object(D.a)(m,"OICErrorDialogWithDownload",r,[]);var B=b(140);Cm(c,k);Object(D.a)(c,"ReactOICErrorDialog",k,[]);Cm(d,r);Object(D.a)(d,"ReactOICErrorDialogWithDownload",
r,[]);b.d(F,"a",function(){return a});a.prototype.RVg=function(C,H,W){this.jgb?new c(C,H,null,W):new t(C,H,null,W)};a.prototype.SVg=function(C,H,W){this.jgb?new d(C,H,W):new m(C,H,W)};a.prototype.TVg=function(C,H,W,S,N){var T=b(1293).ReactOICErrorDialogWithTrial,fa=b(1294).OICErrorDialogWithTrial;this.jgb?new T(C,H,W,null,S,N):new fa(C,H,W,null,S,N)};Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Pa||(a.Pa=new a)}}});a.Pa=null;Object(D.a)(a,"OICErrorDialogFactory",
null,[396])},1236:function(D,F,b){function a(ma,na){var xa=Sa.call(this)||this;xa.Qa=new w.a;xa.Y1=null;xa.$Bc=[];xa.$=ma;xa.CWa=na;xa.dzg();m.AFrameworkApplication.Md&&m.AFrameworkApplication.Md.BOc(xa);xa.Mjb=Array(63);for(var Oa=0;63>Oa;Oa++)xa.Mjb[Oa]=null;xa.Vg=Y.EcmaDateClock.instance;xa.p$e=xa.Vg.Lb;na&&(na=ma.ra,Oa=na.yf,na.FB(Object(u.a)(xa,xa.Vo,"onWebMethodError")),na.ls(Object(u.a)(xa,xa.Zh,"onWebMethodSuccess")),na.lkb(Object(u.a)(xa,xa.Ghc,"onAuthenticationChanged")),na.gWa(Object(u.a)(xa,
xa.Ghc,"onAuthenticationChanged")),P.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Oa.mtg(Object(u.a)(xa,xa.bBb,"onNetworkDownEvent")),Oa.Akb(Object(u.a)(xa,xa.$wa,"onNetworkResumed"))),ma.fa.ak(Object(u.a)(xa,xa.ed,"onSessionIdChanged")),ma.fa.ot(Object(u.a)(xa,xa.hg,"onWorkbookMetadataChanged")),ma.Nk(Object(u.a)(xa,xa.sd,"onWorkbookOpened")),ma.yn(Object(u.a)(xa,xa.Yd,"onWorkbookClosing")),ma.fa.B1(Object(u.a)(xa,xa.QM,"onModeChanged")),ma.userOperationManager.CB(Object(u.a)(xa,
xa.NBb,"onUserOperationQueued")),P.EwaSettings.ka(172)&&ma.fa.gh.get(45)&&m.AFrameworkApplication.ha.ta("SupportsPolicies")||xa.WXe(),xa.W0e(R.c(ma)));ma.ea.La(5,xa);return xa}function d(ma,na,xa){xa=void 0===xa?null:xa;var Oa=z.call(this)||this;Oa.imb=ma;Oa.e1c=na;Oa.data=xa;return Oa}D=b(0);var c=b(15),m=b(5),r=b(86),t=b(24),k=b(135),u=b(37),w=b(36),v=b(74),A;(function(ma){ma[ma.unableToRefreshLock=0]="unableToRefreshLock";ma[ma.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";ma[ma.workbookAlmostTooLarge=
2]="workbookAlmostTooLarge";ma[ma.workbookTooLarge=3]="workbookTooLarge";ma[ma.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ma[ma.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";ma[ma.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ma[ma.unsupportedFeatures=7]="unsupportedFeatures";ma[ma.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";ma[ma.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
ma[ma.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";ma[ma.lastGenericStatusError=11]="lastGenericStatusError";ma[ma.scratchPadWarning=12]="scratchPadWarning";ma[ma.authenticationLost=13]="authenticationLost";ma[ma.odfCompatibilityIssues=14]="odfCompatibilityIssues";ma[ma.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ma[ma.workbookIsIrmProtected=16]="workbookIsIrmProtected";ma[ma.biFeatureNotAvailable=17]="biFeatureNotAvailable";ma[ma.anonymousCreateSaveWarning=
18]="anonymousCreateSaveWarning";ma[ma.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ma[ma.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ma[ma.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";ma[ma.editAttemptInReadOnly=22]="editAttemptInReadOnly";ma[ma.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ma[ma.unsupportedBrowser=24]="unsupportedBrowser";ma[ma.readOnlyPermissions=25]="readOnlyPermissions";
ma[ma.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";ma[ma.policyWarningMessage=27]="policyWarningMessage";ma[ma.workingOnIt=28]="workingOnIt";ma[ma.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";ma[ma.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ma[ma.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ma[ma.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";ma[ma.legacyConnectionsBB=33]=
"legacyConnectionsBB";ma[ma.groupedSlicersBB=34]="groupedSlicersBB";ma[ma.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";ma[ma.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";ma[ma.wacGdprNotice=37]="wacGdprNotice";ma[ma.automaticSensitivityLabel=38]="automaticSensitivityLabel";ma[ma.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";ma[ma.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";ma[ma.localStorageDisabled=41]="localStorageDisabled";ma[ma.autoRefreshDisabled=
42]="autoRefreshDisabled";ma[ma.corruptedFileRepaired=43]="corruptedFileRepaired";ma[ma.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";ma[ma.minorVersionLimitReached=45]="minorVersionLimitReached";ma[ma.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";ma[ma.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";ma[ma.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";ma[ma.sensitivityApplicationLabelDisabledError=
49]="sensitivityApplicationLabelDisabledError";ma[ma.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";ma[ma.sensitivityApplicationMinorVersionLimitReachedError=51]="sensitivityApplicationMinorVersionLimitReachedError";ma[ma.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";ma[ma.promptEnableExternalLinks=53]="promptEnableExternalLinks";ma[ma.networkDown=54]="networkDown";ma[ma.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";
ma[ma.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";ma[ma.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";ma[ma.canvasHealth=58]="canvasHealth";ma[ma.novModeDepreciation=59]="novModeDepreciation";ma[ma.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";ma[ma.optimizeWorkbook=61]="optimizeWorkbook";ma[ma.novModePostDepreciation=62]="novModePostDepreciation";ma[ma.count=63]="count"})(A||(A={}));Object(D.b)("EwaBusinessBarEntryType",
A);var y=b(4),x=b(1156),z=Sys.EventArgs;Cm(d,z);Object(D.a)(d,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var J=b(1158),B=b(1157),C=b(1160),H=b(1159),W=b(1154),S=b(477),N=b(58),T=b(213),fa=b(35),Y=b(680),L=b(27),P=b(1),ea=b(9),X=b(7),ja=b(20),R=b(53),ba=b(64),ha=b(958),oa=b(173);b.d(F,"a",function(){return a});var Sa=v.a;Cm(a,Sa);a.prototype.WXe=function(){L.a.Fq(this.$.fa.XE)&&this.Vo(this,new S.a(this.$.fa.XE,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.rrg=function(ma){this.Qa.addHandler("bBarAttachedOrDetached",
ma)};a.prototype.dispose=function(){if(this.$){var ma=this.$,na=ma.ra,xa=na.yf;na.YC(Object(u.a)(this,this.Vo,"onWebMethodError"));na.Tt(Object(u.a)(this,this.Zh,"onWebMethodSuccess"));na.Vmc(Object(u.a)(this,this.Ghc,"onAuthenticationChanged"));na.pEb(Object(u.a)(this,this.Ghc,"onAuthenticationChanged"));xa.DEb(Object(u.a)(this,this.$wa,"onNetworkResumed"));xa.CUi(Object(u.a)(this,this.bBb,"onNetworkDownEvent"));ma.fa.xk(Object(u.a)(this,this.ed,"onSessionIdChanged"));ma.fa.ow(Object(u.a)(this,this.hg,
"onWorkbookMetadataChanged"));ma.nl(Object(u.a)(this,this.sd,"onWorkbookOpened"));ma.Xo(Object(u.a)(this,this.Yd,"onWorkbookClosing"));ma.fa.g6(Object(u.a)(this,this.QM,"onModeChanged"));ma.userOperationManager.WC(Object(u.a)(this,this.NBb,"onUserOperationQueued"));ja.g(ma).Hc.mm(Object(u.a)(this,this.Mnf,"onGridEditingStarted"))}r.a.Ia(this.Y1);this.$=this.Y1=null;Sa.prototype.dispose.call(this)};a.prototype.p_h=function(ma){switch(ma){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return P.EwaSettings.ka(706);
default:return!1}};a.prototype.tg=function(ma,na,xa,Oa){xa=void 0===xa?null:xa;Oa=void 0===Oa?null:Oa;if(!this.$.isMobileMode||this.p_h(ma))this.CWa&&!this.ND(ma)&&(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(554233872,0,50,"Adding entry to BB: {0}",Enum.toString(A,ma)),this.Mjb[ma]=this.Vg.Lb,this.Y1.CI(ma,na,Oa),this.Qa.raiseEvent("bBarAttachedOrDetached",new d(ma,!0,xa))),na&&32===na.Appearance&&ba.a(this.$).ld.eka(na)};a.prototype.agj=function(ma,
na,xa,Oa){c.ULS.sendTraceTag(554233871,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");W.a.initialize(ma,na,xa,Oa);this.tg(37,null)};a.prototype.bfj=function(ma,na,xa,Oa){x.a.initialize(ma,na,xa,Oa);this.tg(38,null)};a.prototype.ohj=function(ma,na,xa,Oa){B.a.initialize(ma,na,xa,Oa);this.tg(39,null)};a.prototype.Cgj=function(ma,na,xa,Oa){J.a.initialize(ma,na,xa,Oa);this.tg(40,null)};a.prototype.yhj=function(ma,na,xa,Oa){H.a.initialize(ma,na,xa,Oa);this.tg(51,null)};a.prototype.xhj=function(ma,na,
xa,Oa){C.a.initialize(ma,na,xa,Oa);this.tg(52,null)};a.prototype.removeEntry=function(ma){this.CWa&&(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(554233869,0,50,"Removing entry from BB: {0}",Enum.toString(A,ma)),this.Mjb[ma]=null,this.Y1.removeEntry(ma)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new d(ma,!1)))};a.prototype.t3a=function(ma){return this.CWa?this.Y1.t3a(ma):!1};a.prototype.ND=function(ma){return this.CWa?this.Y1.ND(ma):!1};a.prototype.xzb=
function(){c.ULS.sendTraceTag(554233866,0,50,"Network disconnect notification received from the app")};a.prototype.Ugc=function(){c.ULS.sendTraceTag(554233865,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.dzg=function(){var ma=b(1211).BusinessBarControl;if(this.CWa&&!this.Y1){ja.g(this.$).Hc.Cm(Object(u.a)(this,this.Mnf,"onGridEditingStarted"));var na=document.getElementById(this.$.Mb+
y.a.vFg);this.Y1=new ma(this.$,na)}};a.prototype.cBd=function(){this.CWa&&this.Y1.cBd()};a.prototype.Ghc=function(){this.$.ra.hKa?this.removeEntry(13):this.tg(13,null)};a.prototype.$wa=function(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(554233861,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");this.removeEntry(21);this.ND(54)&&(c.ULS.sendTraceTag(554233860,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),
this.removeEntry(54));this.SGf("OnNetworkResumed")};a.prototype.SGf=function(ma){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var na=this.Vg.Lb;if(3E5<=+na-+this.p$e){this.p$e=na;for(var xa=0;63>xa;xa++){var Oa=this.Mjb[xa];Oa&&(Oa=+na-+Oa,3E5<=Oa&&c.ULS.sendTraceTag(554233859,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",ma,Enum.toString(A,xa),Oa))}}}};a.prototype.Zh=function(ma,na){ma=0;for(var xa=a.g9b().length;ma<xa;ma++){var Oa=a.g9b()[ma];
this.removeEntry(Oa)}na.context&&0<na.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(554233858,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.SGf("OnWebMethodSuccess")};a.prototype.Vo=function(ma,na){ma=this.Dlh(na.errors);for(var xa=[],Oa=0,ib=ma.length;Oa<ib;++Oa){var sb=ma[Oa];if(1===sb.Type&&sb.Appearance&32)xa=this.KOh(sb,xa);else if(na.m5i){c.ULS.sendTraceTag(554233856,
0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var nb=na.context&&na.context.stopwatch?na.context.stopwatch.Gc:-1;5E3>nb?c.ULS.sendTraceTag(554232034,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",nb):m.AFrameworkApplication.jkd()||this.Nqg(sb,na.context.methodName)}var Gb=void 0;nb=(Gb=[]).concat.apply(Gb,a.g9b());Gb=
0;for(var Ha=xa.length;Gb<Ha;++Gb){var ca=xa[Gb];this.tg(ca,sb);Array.remove(nb,ca)}sb=0;for(Gb=nb.length;sb<Gb;++sb)this.removeEntry(nb[sb])}};a.prototype.Dlh=function(ma){for(var na=[],xa=Ml(ma),Oa=xa.next();!Oa.done;Oa=xa.next())switch(Oa.value.MessageId){case -113742550:Oa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.fa.isNamedObjectViewMode||L.a.dh(ma,Oa))&&Array.add(na,-113742550)}return L.a.$E(ma,na)};a.prototype.bBb=function(ma,na){ma=0;for(var xa=
na.errors.length;ma<xa;++ma){var Oa=na.errors[ma];m.AFrameworkApplication.jkd()||(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(554232033,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),this.tg(54,Oa))}};a.prototype.KOh=function(ma,na){switch(ma.MessageId){case 2113407564:for(var xa=L.a.CXa([1821390342,-943219229,-502303485,1437034227]),Oa=0;Oa<xa.length;Oa++)xa[Oa].HelpTopicId=ma.HelpTopicId,xa[Oa].HelpDescription=ma.HelpDescription,
Array.add(this.$Bc,xa[Oa])}switch(ma.MessageId){case -395951567:this.tg(6,ma);break;case 1643490758:this.tg(4,ma);break;case -907264831:this.tg(5,ma);break;case 757111532:case 2113407564:this.tg(7,ma);break;case 2010656511:this.tg(15,ma);break;case 1321660996:this.$.I_c=!0;this.tg(8,ma);break;case 526339737:this.$.I_c=!0;this.tg(9,ma);break;case -407088521:this.tg(10,ma);break;case 1756116017:this.tg(14,ma);break;case -1703455218:this.tg(17,ma);break;case 1393475740:this.tg(25,ma);break;case -949523941:this.tg(26,
ma);break;case 1779381952:this.tg(42,ma);break;case 1421575100:this.tg(43,ma);break;case 613676060:this.tg(44,ma);break;case 1233668252:this.tg(60,ma);break;case 1911608588:ma=!!(this.$.Gd&64);!this.$.fa.Yg()&&ma&&Array.add(na,29);break;case 1544494907:break;case -655555355:Array.add(na,this.Akd()?1:0);break;case -1221382671:Array.add(na,2);break;case 1662282929:Array.add(na,3);break;case 104919273:this.$.fa.Yg()||Array.add(na,30);break;case -689453604:ma=!!(this.$.Gd&64);this.$.fa.fZe=!0;!this.$.fa.Yg()&&
ma&&Array.add(na,31);break;case 157762400:this.$.fa.hcc=!0;!this.$.fa.Yg()&&this.$.Gd&64&&!this.$.isEditMode&&Array.add(na,32);break;case -73730134:P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableEditingOfFilesWithLegacyConnections",!1)&&!this.$.fa.Yg()&&this.$.Gd&64&&this.$.isEditMode&&Array.add(na,33);break;case -37299333:break;case 136737622:Array.add(na,45);break;case -1780327030:this.tg(53,ma);break;case -113742550:this.tg(55,ma);break;default:this.tg(11,ma)}return na};a.prototype.ed=
function(ma,na){this.Yd(ma,na)};a.prototype.Yd=function(){var ma=this.$.fa;ma.pc||ma.Yg()||(this.cBd(),Array.clear(this.$Bc))};a.prototype.JUh=function(){var ma=this;if(m.AFrameworkApplication.ha.ta("WildFireExcelBizBar")&&!ha.a.vid(ha.a.d8c(1))&&(t.a.Dp||t.a.hh)){var na=N.GetServiceTaskFactory.create(this.$.ea,155,this.$.ma,1,"System.Dictionary");fa.TaskExtensions.Da(na,function(){ma.tg(20,null)},this.ma,3)}};a.prototype.GUh=function(){var ma=P.EwaSettings.ka(74),na=P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),xa=P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);ea.HelperMethods.OJd(xa||na,ma)&&(oa.a("NewBrowserSuggestionShown"),xa||k.a.tw("NewBrowserSuggestionShown","true",7),this.tg(24,null))};a.prototype.bUh=function(ma){!ma&&T.g(this.$)&&this.tg(59,null)};a.prototype.cUh=function(ma){!ma&&T.h(this.$)&&this.tg(62,null)};a.prototype.sd=function(ma,na){this.$.fa.Yg()&&!na.kQ||this.W0e(na.kQ)};a.prototype.W0e=function(ma){(ma||this.$.printingEnabled)&&
!this.$.lg.get(1)||X.a.na(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription)||(c.ULS.sendTraceTag(554232031,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.tg(16,null));this.JUh();this.GUh();this.ipe();this.wTf();this.bUh(ma);this.cUh(ma)};a.prototype.NBb=function(){var ma=this.$.userOperationManager.U8b();ma&&ma.operation.flags&1&&this.oTf()};a.prototype.Mnf=function(){this.oTf()};a.prototype.hg=function(){this.ipe();this.wTf()};a.prototype.ipe=function(){this.$.workbookContext.Options&
32768&&this.Ofj()};a.prototype.Ofj=function(){P.EwaSettings.isChangeGateEnabled("OfficeVSO:5776164_DoNotShowFinanceBizBarOnColumnResize")&&this.Mjb[36]||this.tg(36,null)};a.prototype.wTf=function(){P.EwaSettings.ka(706)&&this.$.workbookContext.Options&524288&&this.tg(57,null)};a.prototype.STf=function(ma,na){this.tg(56,ma,null,na)};a.prototype.oTf=function(){this.$.Gd&8&&this.tg(12,null)};a.prototype.Akd=function(){var ma=this.$.ea.Ea(38,void 0);return ma?ma.tokenExpired:!1};a.prototype.Nqg=function(ma,
na){if(!this.ND(21)&&-1387426400!==ma.MessageId){c.ULS.sendTraceTag(554232030,0,50,"BusinessBar: raising the transient communication failures notification.");var xa={};xa.FailedMethod=na;this.tg(21,ma,xa)}};a.prototype.QM=function(){if(this.$.q4&&this.$.fa.Yg()&&this.$.fa.pc)if(this.$.fa.isEditMode)this.removeEntry(43),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(33),this.removeEntry(22),this.removeEntry(55);else{var ma=
this.$.ea.Ea(331,void 0);ma&&ma.CHa||this.removeEntry(53);this.removeEntry(5);P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableEditingOfFilesWithLegacyConnections",!1)&&this.removeEntry(33)}};a.g9b=function(){return a.Vge||(a.Vge=[0,1,2,3])};Jl.Object.defineProperties(a.prototype,{f2c:{configurable:!0,enumerable:!0,get:function(){return this.$Bc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.Y1?this.Y1.domElement:null}}});a.Vge=null;Object(D.a)(a,"BusinessBarManager",
v.a,[323,7,79])},1252:function(D,F,b){function a(A,y,x,z,J,B){this.tIc=null;this._id=A;this.dJc=y;this.edg=void 0===J?null:J;this.dgb=z;this.rib=void 0===B?null:B;this.Nna=null;this.AVa=x;this.Rib=d.instance.yIh(y,A)}function d(){this.dzc=new k.a;this.bzc=new k.a;this.azc=new k.a;this.XCg(this.dzc);this.WCg(this.bzc);this.VCg(this.azc);this.fEc=new k.a;this.eEc=new k.a;this.dEc=new k.a;this.qFg(this.fEc);this.pFg(this.eEc);this.oFg(this.dEc);this.sAc=new k.a;this.pDg(this.sAc);this.YDa(this.sAc);
this.YDa(this.azc);this.YDa(this.bzc);this.YDa(this.dzc);this.YDa(this.eEc);this.YDa(this.fEc);this.YDa(this.dEc)}D=b(0);var c=b(15),m=b(37),r=b(974),t=b(958),k=b(1231);d.prototype.yIh=function(A,y){switch(A){case 1:return this.ELh(y);case 2:return this.zth(y)}return t.a.Yrc?this.sAc:null};d.prototype.XCg=function(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};
d.prototype.WCg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};d.prototype.VCg=function(A){A.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};d.prototype.qFg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);A.add("OverlayBig","Get the Word app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1",
"Discover Word");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.pDg=function(A){A.add("Headline","Get the Office Online extension for Chrome");A.add("UseAppButton","Get the extension");A.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};d.prototype.pFg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);A.add("OverlayBig","Get the PowerPoint app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover PowerPoint");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.oFg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};d.prototype.YDa=function(A){A.add("Corporation","Microsoft Corporation")};d.prototype.ELh=function(A){switch(A){case 3:return this.fEc;case 2:return this.eEc;case 1:return this.dEc}return null};
d.prototype.zth=function(A){switch(A){case 3:return this.dzc;case 2:return this.bzc;case 1:return this.azc}return null};Jl.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){d.Pa||(d.Pa=new d);return d.Pa}}});d.Pa=null;Object(D.a)(d,"WildFireStringFactory",null,[]);var u=b(5),w=b(49),v=b(24);b.d(F,"a",function(){return a});a.prototype.GYc=function(){this.Nna=new r.a(this.title,this.message,null);this.Nna.addButton(this.Dme,Object(m.a)(this,this.mkf,"onButtonOneClick"),
"");this.AVa&&this.Nna.$pg(this.Fme,Object(m.a)(this,this.pkf,"onButtonTwoClick"));this.Nna.r9=Object(m.a)(this,this.Dze,"dismissBar");this.Nna.image=3;this.Nna.id=16;this.Nna.closeable=!0};a.prototype.mkf=function(){this.AVa?this.BXh():this.zzj()};a.prototype.pkf=function(){this.AVa&&this.XBi()};a.prototype.BXh=function(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.dgb&&this.rib&&this.rib();t.a.DCf(this._id,this.dJc)};a.prototype.XBi=function(){this.openUrl&&
(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.dgb&&this.rib&&this.rib(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(t.a.Qhe(this._id),this.openUrl,0,!1))};a.prototype.zzj=function(){t.a.Yrc?this.xFg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),t.a.ZHd("BizBarClicked"),1!==this.dJc&&2!==this.dJc||t.a.SLg(this.openUrl,this.dgb,this._id,this.rib))};a.prototype.xFg=function(){this.dgb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):
c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.PY(u.AFrameworkApplication.ha.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.m3g=function(){this.dgb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");t.a.ZHd(t.a.Kpe)};a.prototype.Dze=function(){t.a.Yrc?this.m3g():(t.a.ZHd(t.a.d8c(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.H0b=function(){var A=u.AFrameworkApplication.za.Za,
y=new a(A.Xk,t.a.e9b(),8<v.a.A2a,1===A.qMa,function(){return A.LB},A.gKf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return y};Jl.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Rib.oa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Rib.oa("CallToAction")}},Izj:{configurable:!0,enumerable:!0,get:function(){return this.AVa}},Dme:{configurable:!0,enumerable:!0,get:function(){return this.AVa?this.Rib.oa("InstallButton"):
this.Rib.oa("UseAppButton")}},Fme:{configurable:!0,enumerable:!0,get:function(){return this.AVa?this.Rib.oa("OpenAppButton"):""}},tFg:{configurable:!0,enumerable:!0,get:function(){return this.Nna}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.tIc||(this.tIc=this.edg());return this.tIc}}});Object(D.a)(a,"WildFireBusinessBar",null,[])},1293:function(D,F,b){function a(t,k,u,w,v,A){var y=r.call(this,t,k,u,w,v,A)||this;t={};k=(t.errorMessage=y.DDe,t.offerString=y.Pif,t);t=new m.a(!1,!1,!0);
y.pTf?(t.lc=1,u={},k.helpLink=(u.type="AppLinkProps",u.id="helpLink",u.text=y.yua,u.onExecute=function(){c.Redirect.showHelp(y.KZe)},u)):(t.lc=4,t.Dc(2,y.Z_e));t.Dc(1,y.iUb);t.We=y.id;u={};k=(u.id=y.id,u.dialogIcon=y.icon,u.bodyControls=k,u);t.initializeAndShow(y.$n,Object(d.a)(y,y.XMi,"reactOICErrorDialogWithTrialHandler"),k);return y}b.r(F);b.d(F,"ReactOICErrorDialogWithTrial",function(){return a});D=b(0);var d=b(37);F=b(1161);var c=b(406),m=b(140),r=F.a;Cm(a,r);Object(D.a)(a,"ReactOICErrorDialogWithTrial",
F.a,[])},1294:function(D,F,b){function a(r,t,k,u,w,v){r=m.call(this,r,t,k,u,w,v)||this;t=document.createElement("span");t.innerText=r.DDe;t.appendChild(document.createElement("br"));t.appendChild(document.createElement("br"));k=document.createElement("span");k.innerText=r.Pif;t.appendChild(k);k=new c.StandardDialog;r.pTf?(k.lc=1,k.yde(r.yua,r.KZe)):(k.lc=4,k.Dc(2,r.Z_e));k.Dc(1,r.iUb);k.We=r.id;k.Hl(r.$n,null,r.icon,Object(d.a)(r,r.T$h,"legacyOICErrorDialogWithTrialHandler"),t);return r}b.r(F);b.d(F,
"OICErrorDialogWithTrial",function(){return a});D=b(0);var d=b(37);F=b(1161);var c=b(128),m=F.a;Cm(a,m);Object(D.a)(a,"OICErrorDialogWithTrial",F.a,[])},1295:function(D,F,b){function a(){return d.call(this)||this}b.r(F);b.d(F,"CheckRoamingRightsRequest",function(){return a});D=b(0);b=b(1163);var d=b.a;Cm(a,d);a.prototype.q1a=function(){return 2};a.prototype.eia=function(){return 1};Object(D.a)(a,"CheckRoamingRightsRequest",b.a,[])},1296:function(D,F,b){function a(){return d.call(this)||this}b.r(F);
b.d(F,"GetRoamingLauncherRequest",function(){return a});D=b(0);b=b(1163);var d=b.a;Cm(a,d);a.prototype.q1a=function(){return 0};a.prototype.eia=function(){return 2};Object(D.a)(a,"GetRoamingLauncherRequest",b.a,[])},1319:function(D,F,b){function a(u){this.qAc=!1;this.RUa=a.uac;this.fKc=this.hIc=0;this.platform=null;this.Gig=u;this.Jae=this.gKc=!1}function d(){this.state=this.callback=null;this.whd=!1}function c(){this.classId=0}D=b(0);var m=b(37),r=b(41);c.CGa=function(u){try{return r.a(u)}catch(w){}return null};
Object(D.a)(c,"ARoamingAppsResponse",null,[]);Object(D.a)(d,"GetRoamingAppsLauncherContext",null,[]);var t=b(5),k=b(112);b.d(F,"a",function(){return a});a.prototype.qKg=function(){t.AFrameworkApplication.Bcc&&this.roamingAppsAreEnabled&&!this.gKc&&!this.qAc&&(this.fKc=1,this.qAc=!0,this.PYi(),this.qIe())};a.prototype.PYi=function(){this.RUa=a.uac;this.hIc=0};a.prototype.getRoamingAppsLauncher=function(u,w,v){this.Uzj?(u=new d,u.callback=w,u.state=v,u.whd=!0,this.vIe(u)):w(!1,"",v)};a.prototype.qIe=
function(){var u=new (b(1295).CheckRoamingRightsRequest);u.RoamingApp=this.fKc;u.BaseDocQuerySignature=t.AFrameworkApplication.hj;u.execute(Object(m.a)(this,this.sKg,"checkUserRoamingRightsSucceeded"),Object(m.a)(this,this.rKg,"checkUserRoamingRightsFailed"),null)};a.prototype.sKg=function(u){t.AFrameworkApplication.Ng||((u=c.CGa(u.data.pe))?this.aId(u.HasRights):this.aId(!1))};a.prototype.rKg=function(){if(!t.AFrameworkApplication.Ng)if(this.hIc>=a.Dgi)this.aId(!1);else{var u=new k.a(2,1,this.RUa,
Object(m.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);t.AFrameworkApplication.$j.sh(u);this.hIc++;this.RUa*=a.$Zi;this.RUa>a.fff&&(this.RUa=a.fff)}};a.prototype.aId=function(u){this.Jae=u;this.gKc=!0;this.qAc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.qIe()};a.prototype.vIe=function(u){var w=new (b(1296).GetRoamingLauncherRequest);w.RoamingApp=this.fKc;w.BaseDocQuerySignature=t.AFrameworkApplication.hj;w.execute(Object(m.a)(this,this.QGh,"getRoamingAppsLauncherSucceeded"),
Object(m.a)(this,this.PGh,"getRoamingAppsLauncherFailed"),u)};a.prototype.QGh=function(u){if(!t.AFrameworkApplication.Ng){var w=c.CGa(u.data.pe);u=u.data.state;w?(this.platform=w.Platform,u.callback(!0,w.Launcher,u.state)):u.callback(!1,"",u.state)}};a.prototype.PGh=function(u){if(!t.AFrameworkApplication.Ng){var w=u.data.state;5===u.data.status&&w.whd?(w.whd=!1,this.vIe(w)):w.callback(!1,"",w.state)}};Jl.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Gig}},
Uzj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.gKc?this.Jae:!1}}});Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.vB||(a.vB=new a(t.AFrameworkApplication.xyg))}}});a.uac=1E3;a.$Zi=5;a.fff=12E5;a.Dgi=5;a.vB=null;Object(D.a)(a,"RoamingAppsManager",null,[])},1353:function(D,F,b){function a(l){return da.call(this,l)||this}function d(l,K,ka){this.ignorePrintArea=!1;this.$=l;this.fa=l.fa;this.lha=K;this.XM=new L(1,
this.ignorePrintArea);this.NC=K=new c(l,K,Wd.AFrameworkApplication.Md,ka);this.$.ea.La(418,K);this.yyf=new B(l);this.$.ea.La(384,this);this.cLc=!1}function c(l,K,ka,$a){this.activeCell=this.selectedRange=this.ig=this.graphServiceEndpoint=null;this.f_=0;this.Mm=this.Tu=null;this.CJ=new J;this.jl=new J;this.Vaa=0;this.Z4a=null;this.XIb=!1;this.s0a=this.hCb=null;this.jjd=!1;this.U3a=this.pwb=this.Fcc=!0;this.Tka=this.txa=this.oLa=null;this.yvb=!1;this.X4a=null;this.m3a=this.xFc=!1;this.$=l;this.lha=
K;this.m2=ka;this.Prd=$a;this.$Cd=xe.HelperMethods.qZ;this.Qa=new wg.a;this.Yxd=this.$.Ba.PrintPreviewerPaginationRange;this.tva=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.j7e=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",!1);this.i7e=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",!1);this.ncc=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);this.useMSPdfViewer=
this.Lej();this.OVh();this.b_h=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PrintPreviewUseBlob",!1)&&this.OJg();this.ijd=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!$a&&yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.lg.get(116)&&!this.i_h())this.graphServiceEndpoint=this.$.Ba.GraphServiceEndpoint}function m(){this.showPaperSizeAndOrientationAsDisabledInAdvancedView=
this.disabledChangeGates=this.supportedPaperSizes=this.isUniversalPrintFlowEnabled=this.graphServiceEndpoint=null}function r(){this.onBackToSheet=null}function t(){this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function k(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=
this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function u(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function w(l,K,ka,$a,Lb){Lb=A.call(this,Lb)||this;Lb.Ld=!1;Lb.JUf=!1;Lb.NC=l;Lb.XM=ka;Lb.$=K;Lb.sheetName=$a;Lb.locale=window.navigator.browserLanguage||window.navigator.language||Lb.$.Ba.UICultureTag;Lb.EDi=Lb.BQg();Lb.$.userOperationManager.CB(Object(fd.a)(Lb,Lb.cK,"onQueueChanged"));Lb.jK=new Zg.a;Lb.tva=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",
!1);return Lb}function v(l,K){this.sheetPrintOptions=this.sheetName=null;this.sheetName=l;this.sheetPrintOptions=K}function A(l){this.Yki=[.75,.75,.7,.7,.3,.3];this.Kji=[.75,.75,.25,.25,.3,.3];this.xCj=[1,1,1,1,.5,.5];this.A3d=this.D8d=this.W5d=this.F5d=this.ibe=this.J5=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Rm=l;this.aWh();this.hWh()}function y(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function x(){this.footer=this.header=this.bottom=this.top=
this.right=this.left=0}function z(){this.marginValue=this.printSettingOption=null}function J(){this.margin=this.x_=this.Aba=this.orientation=this.mv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.XZa=!1}function B(l){this.ribbonCommandInfo=this.WBb=null;this.$=l;this.pHf=xe.HelperMethods.qZ&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5140883_ReportPrintAreaPageBreaksQosError");this.fJa=new Rk.a;this.lua=new Rk.a;this.lua.add(78661008,12);this.lua.add(275604654,13);this.lua.add(-13332329,
14);this.lua.add(-837651977,9);this.lua.add(-1778266776,10);this.lua.add(845325699,11);this.ijd=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function C(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function H(){this.Max=this.Min=this.Index=0}function W(){this.Col=this.Row=null}function S(l){this.sheetName=null;this.sheetName=l}function N(l){this.sheetName=null;this.sheetName=l}function T(l){this.sharedSheetCell=null;this.sharedSheetCell=
l}function fa(l){this.sharedSheetCell=null;this.sharedSheetCell=l}function Y(l,K){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=l;this.addToPrintArea=K}function L(l,K){this.L5=0;this.P_d=!1;this.mv=l;this.ignorePrintArea=K}function P(l,K,ka,$a,Lb,bc,Dc,wd){l=oa.call(this,l,K,ka,$a,Lb,yd.EwaSettings.ka(413))||this;l.Pba=null;l.f$=null;l.Z$b=null;l.jLd=!1;l.Qva=null;l.O7a=null;l.vxa=null;l.Bya=null;l.G2a=null;l.Mxa=1;l.gla=1;l.e_=0;l.L5=1;l.bDb=!1;l.Mr=null;l.SFb=0;l.RFb=0;l.wxa=null;
l.Cya=null;l.selectedRange=null;l.f_=0;l.lha=bc;l.activeCell=l.$.sa.activeCell.toString();l.Mm.SelectedRanges&&l.Mm.SelectedRanges.Ranges&&0<l.Mm.SelectedRanges.Ranges.length&&l.Mm.SelectedRanges.Ranges[0]&&(l.selectedRange=Qb.B(l.Mm.SelectedRanges.Ranges[0]).toString());l.sheetName=Dc;l.XM=wd;l.Dvd={};bc=0;for(Dc=P.paperSizeOptions.length;bc<Dc;++bc)l.Dvd[P.paperSizeOptions[bc].toString()]=bc;l.locale=window.navigator.browserLanguage||window.navigator.language||l.$.Ba.UICultureTag;l.B6=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");
return l}function ea(l,K){this.printSettings=this.sheetName=null;this.sheetName=l;this.printSettings=K}function X(){}function ja(l,K,ka,$a,Lb){l=oa.call(this,l,K,ka,$a,Lb)||this;l.dqb=null;return l}function R(l,K,ka,$a,Lb,bc,Dc,wd){wd=l.Ra(1,void 0===wd?null:wd);wd.sheetName=K;wd.locale=ka;return Ef.i(l,"GetPrintSettings",wd,$a,Lb,bc,Dc,4)}function ba(l,K,ka,$a,Lb,bc,Dc){Dc=l.Ra(1,void 0===Dc?null:Dc);Dc.ConvertInParameters=K;return Ef.i(l,"ConvertWorkbookToPrintPdf",Dc,ka,$a,Lb,bc,4)}function ha(l,
K,ka,$a,Lb,bc,Dc,wd){wd=l.Ra(9,void 0===wd?null:wd);wd.sheetName=K;wd.printSettings=ka;return Ef.i(l,"SetSheetPrintSettings",wd,$a,Lb,bc,Dc,0)}function oa(l,K,ka,$a,Lb,bc){l=ck.call(this,l,K,ka,void 0===bc?!1:bc)||this;l.Kv=null;l.Mm=$a;l.vNb=Lb;return l}function Sa(){this.ZXd=this.pb=null}function ma(l,K,ka,$a,Lb,bc,Dc,wd,ke,jf){this.QTb=null;this.obg=l;this.hhb=K;this.RHc=ka;this.yeg=$a;this.cfg=Lb;this.qJc=new Wg.a(Object(fd.a)(this,this.vFh,"getProbeResults"));this.eTa=bc;this.Q2d=ke;this.nkg=
Dc;this.dfg=wd;this.ifg=jf}function na(l,K){this.iXf=l;this.IQa=K}function xa(l){this.isEnabled=Boolean.parse(l.DirectPrintIsEnabled||"false");Boolean.parse(l.DirectPrintProbeIsEnabled||"false");this.I2h=Boolean.parse(l.DirectPrintEnabledForInternetExplorer||"false");this.HQa=(l.DirectPrintSupportedMimeTypes||"").split(xa.T0c);this.IQa=(l.DirectPrintSupportedPlugins||"").split(xa.T0c);this.VSh=(l.DirectPrintImmersivePreviewPlugins||"").split(xa.T0c);this.q4e=Boolean.parse(l.DirectPrintEnabledForEdge||
"false");this.I_h=Boolean.parse(l.ChromePrintLayoutFixIsEnabled||"false");this.DKg=parseInt(l.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Epd=14;this.Wff=14394;if(l=l.DirectPrintMinimalSupportedEdgeVersion){var K=l.split(".");2===K.length?(this.Epd=parseInt(K[0]),this.Wff=parseInt(K[1])):qd.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",l)}else qd.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
function Oa(l,K,ka,$a,Lb){ka=void 0===ka?null:ka;$a=void 0===$a?!0:$a;Lb=void 0===Lb?!1:Lb;K=Eg.call(this,l,!0,!(Oa.ARa&&$a),new ng(l,K),ka,Lb)||this;Oa.ARa=Oa.ARa&&$a;if(Oa.ARa){$a=document.createElement("iframe");Lb=null;var bc=K.w2g;$a.name="pdfObjectFrame";$a.id="pdfObjectIFrame";if(ka&&0<ka.count){var Dc=xd.a.K$c(l,ka);l=xd.a.ABd(l,ka);Lb=document.createElement("form");Lb.id="printPreviewPostForm";Lb.method="POST";Lb.target=$a.name;Lb.action=l;l=Ml(Dc);for(ka=l.next();!ka.done;ka=l.next())ka=
ka.value,Dc=document.createElement("input"),Dc.type="hidden",Dc.name=ka.key,Dc.value=ka.value,Lb.appendChild(Dc)}else $a.src=l;bc.appendChild($a);Lb&&(bc.appendChild(Lb),Lb.submit());Sys.UI.DomElement.addCssClass($a,"DirectPrintPdfObjectHidden");jh.a.wh($a,jh.a.GB,jh.a.rj)}return K}function ib(l){this.oO=l}function sb(l,K,ka,$a){$a=void 0===$a?null:$a;var Lb=Fj.call(this)||this;Lb.uoa=null;Lb.Tl=null;Lb.sO=null;Lb.Xm=[];Lb.iRb=K;Lb.oO=l;Lb.xdg=ka;Lb.wSb=$a;Lb.Qib=new Bj.a("LoadResource","LoadPrintablePdf");
return Lb}function nb(l){var K=Uh.call(this)||this;K.$=l;K.fc();return K}function Gb(l){this.stopwatch=this.tWb=this.buc=this.vNd=null;this.hYf=0;this.$=l;(this.ZQc=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||l.ea.La(322,this)}function Ha(l){this.O$d=0;this.iYf=l}function ca(l,K,ka,$a,Lb,bc,Dc){this.title=l;this.body=K;this.BIi=ka;this.primaryButtonAction=$a;this.secondaryButtonAction=bc;this.ELf=Lb;this.targetObject=Dc}function Ra(l){var K=Gi.call(this)||this;K.$=l;K.fc();return K}
function ua(l){this.$=l;l.ea.La(309,this)}function ta(l){l=vi.call(this,l)||this;l.Ko=null;l.stopwatch=null;return l}function db(){}function Ta(l){return Xh.call(this,l)||this}function qb(l){this.Bi=l}function za(l){var K=Qi.call(this)||this;K.$=l;K.fc();return K}function Ia(l){l.ea.La(446,this)}function va(l){return ri.call(this,l)||this}function Ua(l,K){this.sortOptions=this.Usc=this.selectedRange=null;this.L3e=!1;this.activeCell=this.ag=this.Bb=this.Zc=null;this.$=l;this.faf="";this.namedSheetViewPublic=
K;this.gridView=ag.g(this.$);this.$.Zb.yi("LoadResource","LoadDialogControlsStopwatch")}function Kb(l,K,ka,$a,Lb,bc,Dc){Dc=l.Ra(41,void 0===Dc?null:Dc);Dc.options=K;return Ef.i(l,"Sort",Dc,ka,$a,Lb,bc,0)}function ia(l){this.filterRange=null;this.filterRange=l}function E(l){this.selection=null;this.selection=l}function fb(l){this.selection=null;this.selection=l}function Za(l,K,ka,$a){l=bi.call(this,l)||this;l.EJd=!1;l.Ugd=!1;l.D5=[];qd.ULS.shipAssertTag(576791255,0,!!K.ActiveCell);qd.ULS.shipAssertTag(576791254,
0,!!K.SelectedRange);qd.ULS.shipAssertTag(576791253,0,Qb.D(K.SelectedRange).contains(Qb.C(K.ActiveCell)));qd.ULS.shipAssertTag(576791252,0,Re.a.equals(K.SelectedRange.SheetName,K.ActiveCell.SheetName,!0));l.selectedRange=K.SelectedRange;l.Kjc=K.ActiveCell;l.oHg=K.ExpandSelection;l.namedSheetViewPublic=ka;l.tbb=$a;l.initializeAndShow(Te.a.instance.da(177),Object(fd.a)(l,l.N0c,"dialogResultHandler"),l.Nra(K));return l}function ec(l,K){l=ph.call(this,l,K)||this;l.bzb=l.C7c();l.ar();return l}function zc(l,
K){var ka=l.SortRange;l=l.SortTopToBottom?ka.LastColumn-ka.FirstColumn:ka.LastRow-ka.FirstRow;return 0<=K&&K<=l}function Ab(l,K){if(!l.SortColumnInfoItems)return qd.ULS.sendTraceTag(38848454,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var ka=new Zg.a,$a=Ml(l.SortColumnInfoItems),Lb=$a.next();!Lb.done;Lb=$a.next()){Lb=Lb.value;if(!zc(l,Lb.ColumnOffset))return qd.ULS.sendTraceTag(38848455,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",
Lb.ColumnOffset,l.SortRange),!1;if(Re.a.na(Lb.Name))return qd.ULS.sendTraceTag(38848456,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",Lb.ColumnOffset),!1;if(Lb.CellColors&&!Lb.CellColors.length)return qd.ULS.sendTraceTag(42076109,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",Lb.CellColors.length),!1;if(Lb.TextColors&&!Lb.TextColors.length)return qd.ULS.sendTraceTag(50671874,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",
Lb.TextColors.length),!1;if(Lb.Icons&&!Lb.Icons.length)return qd.ULS.sendTraceTag(50671875,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",Lb.Icons.length),!1;ka.add(Lb.ColumnOffset)}if(l.SortConditions)for($a=Ml(l.SortConditions),Lb=$a.next();!Lb.done;Lb=$a.next())if(Lb=Lb.value,!ka.contains(Lb.RowColOffset))return qd.ULS.shipAssertTag(38848457,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",Lb.RowColOffset),
!1;if(l.HeaderColumnInfoItems){if(l.HeaderColumnInfoItems.length!==l.SortColumnInfoItems.length)return qd.ULS.shipAssertTag(41760733,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(ka=0;ka<l.HeaderColumnInfoItems.length;++ka){$a=l.HeaderColumnInfoItems[ka];if(K&&$a.ColumnOffset!==l.SortColumnInfoItems[ka].ColumnOffset)return qd.ULS.shipAssertTag(41760734,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),
!1;if($a.CellColors&&1<$a.CellColors.length)return qd.ULS.sendTraceTag(50671876,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if($a.TextColors&&1<$a.TextColors.length)return qd.ULS.sendTraceTag(50671877,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if($a.Icons&&1<$a.Icons.length)return qd.ULS.sendTraceTag(50671878,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0}function vb(l){if(!l.SortConditions)return!0;for(var K=Ml(l.SortConditions),ka=K.next();!ka.done;ka=K.next()){ka=ka.value;if(!zc(l,ka.RowColOffset))return qd.ULS.sendTraceTag(37336267,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",ka.RowColOffset,l.SortRange),!1;if(1===ka.SortConditionType&&ka.FillGradient&&!td.isValid(ka.FillGradient))return qd.ULS.sendTraceTag(595096285,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),
!1}return!0}function kc(l){return l.SortRange?4===l.SortRangeType?(qd.ULS.sendTraceTag(42321667,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",l.SortRangeType),!1):2===l.SortRangeType&&l.SortTopToBottom&&(null==l.HeaderRowSize||0>l.HeaderRowSize)?(qd.ULS.sendTraceTag(41952774,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(qd.ULS.sendTraceTag(37336266,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),
!1)}function td(){}function Oc(l,K,ka,$a){new Sys.UI.Point(l,K);new Sys.UI.Point(ka,$a)}function tc(){}function sc(l,K,ka,$a){l=l.HeaderColumnInfo;return $a||l?2===K&&ka?l.CellColors&&1!==l.CellColors.length?(qd.ULS.sendTraceTag(50671843,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):l.TextColors&&1!==l.TextColors.length?(qd.ULS.sendTraceTag(50671872,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):l.Icons&&1!==l.Icons.length?(qd.ULS.sendTraceTag(50671873,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:l?(qd.ULS.sendTraceTag(50671842,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",ka),!1):!0:!0}function ic(l,K){l=l.ColumnInfo;switch(K){case 1:return l.CellColors&&
l.CellColors.length?!0:(qd.ULS.sendTraceTag(50671838,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return l.TextColors&&l.TextColors.length?!0:(qd.ULS.sendTraceTag(50671839,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return l.Icons&&l.Icons.length?
!0:(qd.ULS.sendTraceTag(50671840,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return qd.ULS.sendTraceTag(50671841,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Ga(l){this.EIe=l}function cb(l,K,ka,$a,Lb,bc,Dc){Dc=l.Ra(41,void 0===Dc?null:Dc);Dc.filterRange=K;return Ef.i(l,"ReapplyAutoFilter",Dc,ka,$a,Lb,bc,0)}function Tb(l,
K,ka,$a,Lb,bc,Dc){Dc=l.Ra(41,void 0===Dc?null:Dc);Dc.filterRange=K;return Ef.i(l,"ToggleAutoFilter",Dc,ka,$a,Lb,bc,0)}function Bb(l){this.options=null;this.options=l}function nc(l){return Gg.call(this,l)||this}function Gc(l,K,ka){var $a=yf.call(this)||this;$a.yne=!1;$a.xne=!1;$a.$=l;$a.Va=K;$a.rJ=ka;ai.a($a.$).xAd(new Cd.a(cg.a.F1f,cg.a.idle,Gc.kJg),new Bk.a(cg.a.Wqe,cg.a.lV,null,cg.a.VN,cg.a.idle));return $a}function La(l){l=dd.call(this,l,Te.a.instance.da(1206))||this;l.textBox=null;l.VOa=null;
l.oRa=null;return l}function Wa(l,K,ka,$a,Lb,bc){bc=void 0===bc?0:bc;l=yc.call(this,l,Te.a.instance.da(K),!1)||this;l.message=ka;l.qni=$a;l.qSd=Lb;l.operationFlags=bc;return l}function wa(l,K,ka){l=Hb.call(this,l,new Sys.UI.Point(wa.w0g,wa.Z_g),Te.a.instance.da(K?1204:1203))||this;l.fZa=null;l.pFc=!1;l.v1d=K;l.je=ka;return l}function Da(){this.JG=null;this.Wwd=1461300262}function Va(){}function Jb(l){l=Hb.call(this,l,new Sys.UI.Point(960,680),Te.a.instance.da(1199))||this;l.name=vc.a.gCe;return l}
function Hb(l,K,ka,$a){l=ni.call(this,l,ka,2,void 0===$a?null:$a)||this;l.aEc=null;l.Zxe=K;l.$.zD(Object(fd.a)(l,l.onResize,"onResize"));l.l$b();return l}function Mb(l){return Dk.call(this,l)||this}function Ub(l){this.$=l}function pb(l,K,ka,$a,Lb,bc,Dc,wd){wd=l.Ra(9,void 0===wd?null:wd);wd.sheetName=K;wd.directionRtl=ka;return Ef.i(l,"ChangeSheetDirection",wd,$a,Lb,bc,Dc,0)}function gb(l,K,ka,$a,Lb,bc,Dc,wd){wd=l.Ra(9,void 0===wd?null:wd);wd.sheetName=K;wd.show=ka;return Ef.i(l,"ShowHeadings",wd,
$a,Lb,bc,Dc,0)}function Qa(l,K,ka,$a,Lb,bc,Dc,wd){wd=l.Ra(9,void 0===wd?null:wd);wd.sheetName=K;wd.show=ka;return Ef.i(l,"ShowGridlines",wd,$a,Lb,bc,Dc,0)}function eb(l,K){this.sheetName=null;this.value=!1;this.sheetName=l;this.value=K}function xb(l,K){var ka=Ck.call(this)||this;ka.activityName=l;ka.HT=K;ka.fc();return ka}function dc(l,K,ka,$a,Lb){l=Ij.call(this,l,K)||this;dc.Eod=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];dc.Dod=[-1468309555,-315732528,-399065540,810218235,
1531005923,1593924569,1112506702,1220851643];dc.mef=[-1468309555,611268539,-1750576502,61029505];dc.lef=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];l.Dsc=ka;l.aij=$a;l.Yqj=Lb;return l}function Nc(){var l=Yj.call(this)||this;l.fc();return l}function Pc(l,K){return Qj.call(this,l,K)||this}function Fd(l){var K=Vg.call(this)||this;K.$=l;K.fc();return K}function Ea(l,K){this.$=l;this.Bi=K;this.$.ea.La(393,this)}function Xa(l){return wk.call(this,l)||this}function hc(l,
K){this.$=l;this.Bi=K}function Xb(l){return Aj.call(this,l)||this}function Ic(l,K){this.$=l;this.Fi=K}function Qc(l,K){l=vk.call(this,l)||this;l.isRow=2040891415===K.command;l.gridView=ag.g(l.$);l.goc=new Hd(l.$.workbookContext.DxDigitNormal);l.Ved=l.LGg();K=l.LQg(l.Ved);var ka=l.NQg(l.Ved);l.$n=Te.a.instance.da(l.isRow?455:456);K=l.J3(K,ka);l.initializeAndShow(l.$n,Object(fd.a)(l,l.bZi,"resizeHeadersDialogHandler"),K);qd.ULS.sendTraceTag(577361430,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",
l.isRow);return l}function Cb(l){this.resizeParameters=null;this.resizeParameters=l}function $c(l,K){this.isRow=!1;this.autoFitRange=null;this.isRow=l;this.autoFitRange=K}function ae(){var l=Ej.call(this)||this;l.fc();return l}function Mc(l,K){var ka=gk.call(this,K.domElement)||this;ka.yIf=!1;ka.Eaa=!1;ka.FIb=null;ka.pxb=null;ka.yr=null;ka.offset=0;ka.am=0;ka.QFb=0;ka.Z_=null;ka.uOa=null;ka.lM=null;ka.AQh="headerResizeTooltip";ka.ifc=null;ka.tF=null;ka.A9a=!1;ka.nCa=!1;ka.SRc=!1;ka.Sg=K;ka.isRow=
K.isRow;ka.rtl=K.sj.rtl;ka.grid=l;ka.Tef=ka.isRow?ye.a.dpd:ye.a.Tfc;ka.wQh=Te.a.instance.da(414);ka.FQh=Te.a.instance.da(413);ka.zQh=Te.a.instance.da(415);gj.a(ka.grid.$,function($a){ka.ifc=$a.jP(ei.a.hZi,!1)});Qh.a.instance.qa(ef.a.Dj,ka.domElement,Object(fd.a)(ka,ka.oba,"onDblClick"));xj.a.instance.qa(ef.a.de,ka.domElement.ownerDocument.body,Object(fd.a)(ka,ka.aic,"onDocumentMouseUp"));bk.a.instance.qa(ef.a.Ge,ka.domElement.ownerDocument.body,Object(fd.a)(ka,ka.aic,"onDocumentMouseUp"));Sd.a.Sq||
(xj.a.instance.qa(ef.a.pointerDown,ka.domElement,Object(fd.a)(ka,ka.RM,"onMouseDown")),xj.a.instance.qa(ef.a.Jh,ka.domElement,Object(fd.a)(ka,ka.MQ,"onMouseMove")));ka.grid.ga.I1(Object(fd.a)(ka,ka.Ih,"onSelectionEnded"));ka.grid.ga.N8(Object(fd.a)(ka,ka.sq,"onSelectionStarted"));ka.grid.Eq(Object(fd.a)(ka,ka.Ih,"onSelectionEnded"));Qg.a(ka.grid.$).vg.Tfa(Object(fd.a)(ka,ka.RE,"onPartialInteractivityStatusChanged"));return ka}function Hd(l){this.L1c=l}function Nd(l,K,ka,$a,Lb,bc,Dc){this.uua=l;this.hzb=
K;this.uMa=ka;this.Pcd=$a;this.C9a=Lb;this.b9e=bc;this.DPh=Dc}function ge(){}function Ed(l){var K=tk.call(this)||this;K.$=l;K.fc();return K}function Zc(l){this.Wma=this.sMe=this.TCb=this.D_a=this.clc=this.Mba=this.ANa=null;this.Qjd=this.uKb=this.qEd=!1;this.LHb=!0;this.fva=!1;this.BKd=!0;this.tKb=this.pZa=this.fte=0;this.zpc={};this.Vjc={};this.Ujc={};this.Xxf=0;this.u4a=this.u1d=!1;this.$=l;this.gridView=ag.g(this.$);this.Y1i=l.Ba.PresentModeRenderUpdateTimeout;this.initialize(l)}function he(){}
function Ke(l,K){l=ci.call(this,l)||this;l.Mba=K;Sys.UI.DomElement.addCssClass(l.domElement,"ewr-presentMode-on");K={};K=(K.id=l.xc,K);l.lc=0;l.initializeAndShow("",Object(fd.a)(l,l.kIi,"presentModeWelcomeDialogHandler"),K);return l}function Ue(l){this.MXa=this.wxd=null;this.$=l;this.gridView=ag.g(this.$)}function Pb(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function kb(){this.height=this.width=0}function yb(){this.angle=this.translateY=this.translateX=this.height=
this.width=this.top=this.left=0}function Ma(l){this.Pje=this.yNa=this.uxd=this.vxd=this.Lba=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Gkc={};this.Fkc={};this.tNa=null;this.Nwf=0;this.$=l}function jd(){}function Zd(l){return Rf.call(this,l)||this}function Zb(l,K){this.$=l;this.presentModeManager=K}function wb(l,K,ka,$a){var Lb=$f.call(this)||this;Lb.activityName=l;Lb.HT=K;Lb.gJ=ka;Lb.$=$a;Lb.fc();return Lb}function gc(l,K,ka){l=Qe.call(this,l,K)||this;l.di=null;l.G1b=K;l.gJ=ka;return l}
function uc(l,K){l=Oe.call(this,l,K)||this;l.ioa=0;l.ar();return l}function id(l,K,ka,$a){var Lb=od.call(this)||this;Lb.activityName=l;Lb.HT=K;Lb.gJ=ka;Lb.$=$a;Lb.fc();return Lb}function Wc(l,K,ka){return Rd.call(this,l,K,ka)||this}function pd(l,K){l=Gd.call(this,l)||this;l.password=null;l.y9e=K;l.Nh();return l}function Yd(l,K,ka,$a){var Lb=ya.call(this)||this;Lb.activityName=l;Lb.HT=K;Lb.gJ=ka;Lb.$=$a;Lb.fc();return Lb}function be(l,K,ka){return Rd.call(this,l,K,ka)||this}function me(l){l=Gd.call(this,
l)||this;l.iEd=5;l.s1d=!1;l.passwordToModify=null;l.Nh();l.$.Nk(Object(fd.a)(l,l.Pvf,"passwordToModifyWorkbookOpenedinEdit"));return l}function Gd(l){l=Lh.call(this,l)||this;l.ioa=0;return l}function Rd(l,K,ka){l=rd.call(this,l,K)||this;l.di=null;l.Qvd=null;l.G1b=K;l.gJ=ka;return l}function Yf(l){var K=kf.call(this)||this;K.$=l;l.ea.La(56,new zf(l));K.fc();return K}function mg(l,K){return zj.call(this,l,K)||this}function zf(l){var K=Mi.call(this)||this;K.$=l;K.fc();zf.UOg();return K}function Ce(l,
K,ka){var $a=ne.call(this,!0)||this;$a.Qa=new wg.a;$a.OLe=!1;$a.z1c=!1;$a.hre=null;$a.Dm=null;$a.i_b=null;$a.$=l;$a.fa=l.fa;$a.rJ=K;$a.businessBar=ka;$a.fa.ak(Object(fd.a)($a,$a.ed,"onSessionIdChanged"));$a.r$=Nj.a.Yje($a.$);$a.VOg();l.ea.La(55,$a);return $a}function ne(l){this.Sea=this.nYd=this.OSa=null;this.ufb=!1;this.iHc=this.f5d=null;this.application=this.pB=0;this.Zmj=this.NMd=!1;this.Czj=l&&Wd.AFrameworkApplication.ha.ta("OICLaunchDialogIsEnabled");Wd.AFrameworkApplication.Hb.bia(Cf.a.BOa)||
Wd.AFrameworkApplication.Hb.$b(Cf.a.BOa,Bh.a.frame,Object(fd.a)(this,this.d_i,"retryOpenInClientAction"));this.xUf=!!Wd.AFrameworkApplication.ha&&Wd.AFrameworkApplication.ha.ta("SilentExternalHandler")}function Bf(){}function Le(){}function gd(l){var K=Mj.call(this)||this;K.Rp=l;K.We="ProtocolLaunchingDialog";Wd.AFrameworkApplication.$j.k2a&&Wd.AFrameworkApplication.$j.koc();Wd.AFrameworkApplication.za.Za.Abd&&K.rde(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(fd.a)(K,K.mic,"onGiveFeedbackClick"));
gd.HYe?(K.lc=12,K.Dc(1,CommonUIStrings.l_CloseFile),K.Dc(2,CommonUIStrings.l_OICDialogContinueHere),K.Dc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(K.lc=4,K.Dc(1,CommonUIStrings.l_OICDialogContinueHere),K.Dc(2,CommonUIStrings.l_OICDialogLaunchAgain));K.czb(CommonUIStrings.l_OICDialog2ndTitle,5===K.Rp.yuf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(fd.a)(K,K.zyd,"protocolLaunchingDialogResultHandler"),null);return K}function $b(l){var K=
Uj.call(this)||this;K.Xda=null;K.HSa=null;K.koa=!1;K.Rna=null;K.Rp=l;K.Mf=Fc.Mf;K.TRc=!0;K.lc=5;K.We="ProtocolLaunchingDialog";K.pBc="OICRetryDialog";Wd.AFrameworkApplication.$j.k2a&&Wd.AFrameworkApplication.$j.koc();Wd.AFrameworkApplication.$j.sh(new ki.a(2,1,5E3,function(){K.switchToBackupMode()},101));K.showDialog("",Object(fd.a)(K,K.zyd,"protocolLaunchingDialogResultHandler"));K.POf();K.kW("Issues");K.CLe();qd.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=
" OICDialog";return K}function Fc(){}function Vc(l){var K=Lj.call(this)||this;K.$Aa=null;K.ISa=null;K.koa=!1;K.Rp=l;K.Mf=ud.Mf;K.TRc=!0;K.lc=5;K.We="OICLaunchDialog";K.showDialog("",Object(fd.a)(K,K.oni,"oicLaunchDialogResultHandler"));K.POf();K.kW("ProtocolLaunchingDialogTitle");4!==Wd.AFrameworkApplication.za.Za.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);K.iz(K.$Aa);qd.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");
document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return K}function ud(){}function Ge(l,K,ka,$a,Lb){var bc=document.createElement("img");bc.alt=l;bc.className=Ib.getImageClassWithCluster(ka,$a);bc.src=K;bc.setAttribute(jh.a.Wd,jh.a.ns);l=document.createElement("span");l.className="ProtocolLaunchingDialogImg32Container";l.appendChild(bc);bc=document.createElement("span");bc.className="ProtocolLaunchingDialogIconContainer";bc.appendChild(l);Lb.appendChild(bc)}function ce(l,K,ka,
$a,Lb,bc,Dc){var wd=document.createElement("a");wd.className="ProtocolLaunchingDialogButtonAnchor";wd.className+=" OICDialog";wd.id=l;wd.setAttribute(jh.a.Wd,jh.a.Gq);wd.style.padding="0";wd.style.margin="0";$a&&Ge(Lb,K,ka,$a,wd);l=document.createElement("span");l.className="ProtocolLaunchingDialogButtonLabel";l.innerText=Lb;wd.appendChild(l);wd.tabIndex=0;bc&&Qh.a.instance.qa(ef.a.click,wd,bc);Dc&&V.KeyInputManager.instance.qa(ef.a.fe,wd,Dc);return wd}function Ae(l){return l.Ga.keyCode===fh.a.Vh||
l.Ga.keyCode===fh.a.mna?(l.Wb.click(),!0):!1}function Ob(l){for(var K=0;K<l.children.length;K++){var ka=l.children[K];ka.style.position="relative";ka.style.top=(ka.parentNode.offsetHeight-ka.offsetHeight)/2+"px"}}function ac(){}function fc(l,K,ka){var $a=this;this.Oa=l;this.Leg=K;this.nzc=null;(this.NTb=Wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Dd.a.instance.yc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Lb){$a.nzc=
Lb});this.Y0=ka}function Uc(l,K,ka){this.Oa=l;this.Heg=K;this.Y0=ka}function Vd(l){var K=Ti.call(this)||this;K.$=l;K.fc();return K}function ld(l){var K=ej.call(this)||this;K.$=l;K.fc();return K}function Od(l,K,ka){ka=void 0===ka?!1:ka;l=vj.call(this,l,K)||this;l.Eyb=null;l.Ffc=ka;return l}function De(l){return ji.call(this,l)||this}function Yb(l,K){this.Bi=K;this.$=l}function sa(l){var K=bj.call(this)||this;K.$=l;K.fc();return K}function hb(l){return ui.call(this,l)||this}function cc(l){this.zt="Excel";
this.$=l;this.gU=Li.a.current}function xc(l,K,ka,$a,Lb,bc,Dc){Dc=l.Ra(9,void 0===Dc?null:Dc);Dc.sheetName=K;Dc.confirmationChoice=!0;return Ef.i(l,"DeleteSheet",Dc,ka,$a,Lb,bc,0)}function vd(){}function Xd(l){var K=Jf.call(this)||this;K.eTd=null;K.gTd=0;K.ej=null;K._state=0;K.Cf=l;K.lu=K.TK;K.moveNext();return K}function Je(){}function ff(l){return Ve.call(this,l)||this}function Ye(l,K){this.$=l;this.gridView=K}function Pe(l,K,ka){var $a=pe.call(this,l)||this;$a.Njb=0;$a.Fvb=!1;$a.QZa=null;$a.oze=
!1;$a.Wnb=!0;$a.QNc=null;$a.$n=null;$a.Oqd=0;$a.Pqd=null;$a.Nqd=null;$a.removeHyperLink=!1;$a.cellValue=null;$a.location=null;$a.selectedRange=K;$a.nL=ka;$a.fa=l.fa;$a.sheetName=K.SheetName;$a.TJa();$a.rm();$a.lc=$a.Fvb?9:1;$a.Dc(1,Te.a.instance.da(4));$a.Fvb&&$a.Dc(2,Te.a.instance.da(733));l={};l=(l.disableDisplayText=$a.oze,l.displayTextValue=$a.QZa,l.activeLinkOption=$a.Njb,l.activeLinkValue=$a.QNc,l.copyLinkValueToDisplay=$a.Wnb,l);K={};l=(K.id=$a.xc,K.validateLinkValues=Object(fd.a)($a,$a.JAj,
"validateLinkValues"),K.bodyProps=l,K);$a.initializeAndShow($a.$n,Object(fd.a)($a,$a.bSh,"hyperLinkDialogHandler"),l);return $a}function wf(l){return mb.call(this,l)||this}function lf(l,K,ka,$a){var Lb=Q.call(this)||this;Lb.$=l;Lb.businessBar=$a;Lb.openInExcelOperation=K;Lb.rJ=ka;return Lb}function kg(){}function Bg(l){l=wc.call(this,l)||this;l.jH=null;if(1!==Wd.AFrameworkApplication.za.Za.Xk)return l;l.LB=l.$.workbookContext.ClientUrl;l.cAb="ms-excel:ofe|u|"+l.LB;l.ww=Wd.AFrameworkApplication.ha.Wa("AppUrl");
Sd.a.wja?l.ww="itms-apps://"+Wd.AFrameworkApplication.ha.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Sd.a.Dp&&(Sd.a.lcc?l.ww=Wd.AFrameworkApplication.ha.Wa("WildFireUrlChinaStoreAndroid"):4<Sd.a.nhe.Lyb&&(l.ww=Wd.AFrameworkApplication.ha.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return l}function Qf(){}function Ug(l){this.calculateType=0;this.calculateType=l}function Kf(l){this.calculationMode=
0;this.calculationMode=l}function Of(l,K){this.dialog=null;this.pni=l;this.Db=K;this.Db.skb(Object(fd.a)(this,this.Ulf,"onDownloadError"))}function hh(l,K){return Eg.call(this,l,void 0,void 0,K)||this}function Eg(l,K,ka,$a,Lb,bc){K=void 0===K?!0:K;ka=void 0===ka?!1:ka;$a=void 0===$a?null:$a;Lb=void 0===Lb?null:Lb;bc=void 0===bc?!1:bc;var Dc=ah.call(this)||this;Dc.mX=null;Dc.Tl=null;Dc.CTa=null;Dc.DTa=null;var wd=Dc.cOd?Dc.cOd:CommonUIStrings.l_DefaultDialogTitle;Eg.fub=bc;Dc.mOb=$a||new ng(l,!0);
Dc.mOb.Vje(Dc);var ke=[],jf=[];Eg.cy&&(Dc.bQc&&Dc.bQc.forEach(function(xi){Array.add(ke,xi)}),Dc.pge&&Dc.pge.forEach(function(xi){Array.add(jf,xi)}));K?ka?(Dc.lc=4,Dc.Dc(1,Dc.buttonText),Dc.Dc(2,CommonUIStrings.l_DialogClose)):(Dc.lc=6,Dc.Dc(0,CommonUIStrings.l_DialogClose)):Dc.lc=5;bc=document.createElement("span");Dc.ZZc&&(bc.className=Dc.ZZc);$a=document.createElement("a");$a.innerText=Dc.Jec;$a.href=l;$a.target="_blank";$a.id=Dc.Iec;$a.className=gh.AFrame.Wge;var Xf=!Sd.a.rA&&!!Lb&&0<Lb.count;
if(Xf){var Sf=xd.a.K$c(l,Lb);Lb=xd.a.ABd(l,Lb);$a.href="#";$a.target="_self";Dc.Tl=document.createElement("form");Dc.Tl.id="printPreviewPostForm1";Dc.Tl.method="post";Dc.Tl.target="_blank";Dc.Tl.action=Lb;Lb=Ml(Sf);for(Sf=Lb.next();!Sf.done;Sf=Lb.next()){Sf=Sf.value;var xg=document.createElement("input");xg.type="hidden";xg.name=Sf.key;xg.value=Sf.value;Dc.Tl.appendChild(xg)}}else Dc.Tl=null;Dc.Tl||Eg.fub?Eg.fub||(l={},Array.add(jf,(l.type="AppLinkProps",l.id=Dc.Iec,l.text=Dc.Jec,l.onExecute=function(){Dc.oBf()},
l))):(Lb={},Sf={},Array.add(jf,(Sf.type="AppLinkProps",Sf.id=Dc.Iec,Sf.text=Dc.Jec,Sf.handler=(Lb.href=Xf?"#":l,Lb.target=Xf?"_self":"_blank",Lb),Sf)));Dc.aMa&&Array.add(ke,Dc.aMa);ka?(l=document.createElement("span"),l.innerText=Dc.aMa.replace("{0}",""),bc.appendChild(l)):Dc.Qff?(l=document.createElement("span"),l.id=Dc.hi("message"),Xf=document.createElement("span"),Lb=document.createElement("span"),Sf=Dc.aMa.split("{0}"),Xf.innerText=Sf[0],Lb.innerText=Sf[1],l.appendChild(Xf),l.appendChild($a),
l.appendChild(Lb),bc.appendChild(l)):(l=document.createElement("span"),l.innerText=Dc.aMa,bc.appendChild(l),bc.appendChild(document.createElement("br")),bc.appendChild(document.createElement("br")),bc.appendChild($a),Eg.fub||Array.add(ke,"{0}"));Dc.Tl&&bc.appendChild(Dc.Tl);Eg.cy&&(Dc.j5a&&(Dc.Txb?Dc.qde(Dc.j5a,Dc.Txb):(Array.add(ke,"{0}"),l={},Array.add(jf,(l.type="AppLinkProps",l.id="LearnMoreLinkId",l.text=Dc.j5a,l.onExecute=function(){Dc.Cec()},l)))),Dc.iqa(ke,jf));Dc.czb(wd,null,Dc.f0e,null,
Object(fd.a)(Dc,Dc.Mv,"dialogHandler"),Eg.cy?null:bc);Dc.kW(Dc.hi("message"));!Eg.cy&&Dc.Txb&&Dc.j5a&&(wd=document.createElement("div"),wd.className="WACDialogLearnMoreLinkContainer",Dc.mX=document.createElement("a"),Dc.mX.innerText=Dc.j5a,Dc.mX.href=Dc.Txb,Dc.mX.target="_blank",Dc.mX.id=Dc.hi("LearnMoreLinkId"),Dc.mX.className=gh.AFrame.Wge,wd.appendChild(Dc.mX),K?Dc.Ob.insertBefore(wd,Dc.Ob.lastChild):Dc.Ob.appendChild(wd),Dc.kW(String.format("{0} {1}",Dc.hi("message"),Dc.hi("LearnMoreLinkId"))));
Dc.Seb=$a;ka?Dc.iz(Dc.jB):Dc.iz(Dc.Seb);Dc.bcf();Wd.AFrameworkApplication.za.vW.qa(ef.a.click,Dc.Seb,Object(fd.a)(Dc,Dc.HAe,"downloadLinkClicked"),null);Dc.mX&&Wd.AFrameworkApplication.za.vW.qa(ef.a.click,Dc.mX,Object(fd.a)(Dc,Dc.Cec,"learnMoreLinkClicked"),null);Dc.lOb=!1;return Dc}function ng(l,K){this._url=l;this.Rgg=K}function eg(l){return e.call(this,l)||this}function Yg(l){this.Bi=l}function Ud(l){var K=rg.call(this)||this;K.$=l;K.fc();return K}function Tc(){}function qg(){this.pb=null}function Lg(l){this.FJa=
this.j8a=null;this._initialized=!1;this.Gdd=l}function de(){this.pb=null}function tg(l,K,ka,$a,Lb,bc){K=qc.call(this,K,ka,$a,Lb,bc)||this;K.Oa=l;return K}function ve(l,K,ka,$a,Lb,bc,Dc){K=cf.call(this,K,ka,$a,Lb,bc,Dc)||this;K.jcg=l;return K}function tf(l,K,ka,$a){l=Se.call(this,l,K,ka,$a)||this;l.Mgg=K;return l}function lg(l){var K=cd.call(this)||this;K.lc=1;K.Dc(1,CommonUIStrings.l_RetryButtonLabel);K.Dc(0,CommonUIStrings.l_DialogClose);K.Oa=l;return K}function Og(l,K,ka){this.Oa=l;this.VW=K;this.njb=
ka}function Fa(l,K,ka,$a){var Lb=oc.call(this)||this;Lb.O7=null;Lb.VOb=null;Lb.Oa=l;Lb.VW=K;Lb.njb=ka;Lb.Dc(1,CommonUIStrings.l_SaveButtonLabel);Lb.Mf=lb.Mf;Lb.We="FileNameDialog-SaveACopy";Lb.yh=$a;return Lb}function lb(){}function pc(){this.pb=null}function qc(l,K,ka,$a,Lb){this.O7=this.Am=this.dBa=null;this.OBa=!1;this.yh=this.zfa=null;this.QMc=l;this.Rhb=K;this.ds=ka;this.Me=$a;this.rh=Lb}function Md(l){this.yb=l;this.MDa=l.appSettings.SkyDriveUploadWebServiceBase;this.Fz=l.appSettings.FileName;
this.wea=l.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function Pd(l,K,ka,$a,Lb,bc,Dc){this.LDa=l;this.Fz=K;this.vTa=ka;this.VOb=$a;this.xJc=Lb;this.wea=bc;this.yh=Dc}function ee(l,K,ka){this.Oa=l;this.g1=K;this.VW=ka}function xf(l,K,ka){var $a=rb.call(this)||this;$a.Oa=l;$a.g1=K;$a.VW=ka;$a.ku=!1;$a.lc=1;$a.$la(1);$a.Dc(1,CommonUIStrings.l_SignIn);$a.Dc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return $a}function Se(l,K,ka,$a){this.cSb=null;this.Tig=l;this.yb=ka;this.x5d=
K;this.Z2d=new bg.a;this.rh=$a}function cf(l,K,ka,$a,Lb,bc){this.yh=null;this.Tjg=l;this.g1=K;this.njb=ka;this.yb=$a;this.NMb=Lb;this.ds=bc}function dh(){}function df(){var l=Wf.call(this)||this;l.lc=0;l.Dc(1,CommonUIStrings.l_DialogClose);return l}function Uf(){this.mfa=this.GQb=this.EQb=this.pb=null}function bf(l,K,ka,$a,Lb){this.Am=this.dBa=null;this.Wyc=!1;this.xKc=this.O7=null;this.QMc=K;this.Rhb=ka;this.ds=$a;this.Me=Lb;this.Oa=l}function If(l){this.MDa=l.appSettings.SaveAsToHostWebServiceBase;
this.Fz=l.appSettings.FileName;this.wea=l.Wa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function vf(l,K,ka,$a,Lb,bc,Dc,wd){this.LDa=l;this.Fz=K;this.vTa=$a;this.xJc=bc;this.O7=ka;this.$jg=Lb;this.wea=Dc;this.yh=wd}function Dg(l,K,ka,$a){this.yh=this.y4d=null;this.EDa=l;this.ds=K;this.rIc=ka;this.Me=$a}function Pf(l,K,ka,$a,Lb,bc,Dc){this.yb=l;this.zCc=ka;this.Oa=K;this.uib=$a;this.nfb=Lb;this.rIc=bc;this.L$f=Dc}function gg(){return Ch.call(this)||this}function Sb(l,K,ka,$a){var Lb=
this;this.zo=this.shb=null;this.nfb=l;this.Me=ka;this.ohg=$a;this.ZBa=new Wg.a(function(){return new kh.a(K.value,Object(fd.a)(Lb,Lb.Dsb,"getMoreInfoEventReceived"))})}function Hc(l,K,ka,$a,Lb,bc,Dc,wd,ke,jf){this.Oa=K;this.yb=l;this.VW=$a;this.Afa=bc;this.ds=Lb;this.Me=ka;this.y8d=Dc;this.ufg=void 0===wd?null:wd;this.EDa=void 0===ke?null:ke;this.gVa=void 0===jf?null:jf}function ed(l,K,ka,$a,Lb,bc,Dc,wd,ke){this.FGc=null;this.Fz="";this.uib=l;this.ds=K;this.yh=ke;this.Afa=ka;this.Me=Lb;this.sv=$a;
this.EDa=Dc;this.gVa=wd;bc&&(this.FGc=new Wg.a(function(){return new kh.a(bc.value,null)}))}function Id(){this.properties=this.friendlyPath=this.folderName=null}function hf(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function Hf(l,K,ka,$a,Lb,bc,Dc,wd){l=qe.call(this,l,K,ka,$a,Lb,bc,wd)||this;l.ly=null;l.BKc=null;l.Doa=null;l.KFg=CommonUIStrings.l_SaveToAnotherFolder;l.Mf=Cg.Mf;l.We="FileNameDialog-SaveToSharePoint";l.uib=Dc;l.Tgg=wd;return l}
function Cg(){}function uf(){var l=sf.call(this)||this;l.lc=0;l.Dc(1,CommonUIStrings.l_DialogClose);return l}function ih(){this.pb=null}function qa(l,K,ka,$a,Lb,bc,Dc,wd){this.Am=null;this.BUa=this.OBa=!1;this.zfa=this.yh=this.Fz=null;this.yb=K;this.LDa=this.yb.appSettings.SaveAsToHostWebServiceBase;this.y0d=$a;this.Rhb=Lb;this.Ug=ka;this.ds=bc;this.rh=wd;this.Me=Dc;this.Oa=l;this.wea=K.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function tb(l,K,ka){this.Afa=ka;this.zCc=K;this.yb=l}
function rc(l,K,ka,$a,Lb,bc){this.Oa=K;this.yb=l;this.VW=$a;this.Afa=bc;this.ds=Lb;this.Me=ka}function kd(l,K,ka,$a,Lb,bc){l=qe.call(this,l,K,ka,$a,Lb,bc)||this;l.Mf=Td.Mf;l.We="FileNameDialog-SaveAsToHost";return l}function Td(){}function qe(l,K,ka,$a,Lb,bc,Dc){Dc=void 0===Dc?null:Dc;var wd=pa.call(this)||this;wd.lI=null;wd.Oa=K;wd.VW=$a;wd.Afa=bc;wd.yb=l;wd.ds=Lb;wd.Me=ka;wd.hfb=wd.yb.ta("SaveToHostWithExtraCharsInFileName");wd.yh=Dc;wd.Dc(1,CommonUIStrings.l_SaveButtonLabel);return wd}function Ne(l,
K){this.yb=l;this.Oa=K;this.hfb=this.yb.ta("SaveToHostWithExtraCharsInFileName")}function Ja(l,K){var ka=vh.call(this)||this;ka.BUa=!1;ka.Fz=null;ka.Oa=l;ka.hfb=K;ka.cQa=!1;return ka}function ob(){this.pb=null}function Nb(l){this.Ul=null;this.Ug=l;this.YJc=3}function Jc(l,K,ka,$a){K=Yc.call(this,l,K,ka,$a)||this;K.options.advanced.filter=l.Wa("OneDriveApiV72Filter")||"folder,photo";K.options.advanced.linkType="download";K.options.multiSelect=Wd.AFrameworkApplication.Ohe;l.ta("OneDriveApiV72CommandModeEnabled")&&
(K.options.commandMode=l.Wa("OneDriveApiV72CommandMode")||"none");l.ta("OneDriveApiV72QosExtraDataEnabled")&&(K.options.qosExtradata=new bd(Wd.AFrameworkApplication.userSessionId));return K}function bd(l){this.olsSessionId=this.value=this.key=null;this.olsSessionId=l}function Yc(l,K,ka,$a){K=le.call(this,l,K,ka,$a)||this;K.C9f=l;K.options={};K.options.advanced={};K.options.action="query";K.options.clientId=K.ha.Wa("OneDriveApiV72ClientId");K.options.advanced.trapFocus=!0;return K}function Db(l,K,
ka,$a,Lb){l=le.call(this,l,K,ka,$a)||this;l.w5d=null;l.fPb=null;l.Jbg=Lb;l.options={};l.options.clientId=l.ha.Wa("OneDriveApiV7ClientId");l.options.cancel=Object(fd.a)(l,l.Euc,"toggleHostDivVisibility");return l}function mc(l,K,ka,$a,Lb,bc){K=le.call(this,K,ka,$a,bc)||this;K.yh=null;K.g1=l;K.Njg=Lb;return K}function le(l,K,ka,$a){this.QCa=this.o5=null;this.UKc=this.WKc=!1;this.AUa=null;this.yb=l;this.NMb=K;this.wCa=ka;this.ds=$a}function hd(){}function of(){var l=We.call(this)||this;l.lc=0;l.Dc(1,
CommonUIStrings.l_DialogClose);return l}function Rc(){}function Kc(l,K,ka,$a){this.mfb=l;this.hpa=K;this.a1=ka;this.$cg=$a}function yg(l,K,ka,$a,Lb,bc,Dc){var wd=this;this.zo=null;this.L8d=!1;this.woa=this.DVd=0;this.ogg=l;this.yUa=K;this.JQb=ka;this.mfb=$a;this.hpa=Lb;this.a1=bc;this.ZBa=new Wg.a(function(){return new kh.a(Dc.value,Object(fd.a)(wd,wd.Dsb,"getMoreInfoEventReceived"))})}function nf(l,K,ka,$a,Lb,bc,Dc,wd){var ke=this;this.$zc=null;this.gNc=!0;this.dNb="";this.olg=0;this.jUa=null;this.pGc=
3;this.yb=wd;this.a1=l;this.gj=K;this.kcg=ka;this.o$f=$a;this.n$f=Lb;this.ZBa=new Wg.a(function(){return new kh.a(bc.value,null)});this.adg=new Wg.a(function(){return new kh.a(Dc.value,Object(fd.a)(ke,ke.eji,"mruEventResultReceived"))});this.yb.ta("WacInTabOpenMRUIsEnabledForUiHost");this.yb.ta("UiHostSupportsDocRebootFeatures")}function Kg(){return aa.call(this)||this}function jg(l,K,ka,$a,Lb,bc){var Dc=this;this.kMc=this.zo=this.eNb=null;this.USb=this.oLc=!1;this.N3d=0;this.dLc=this.yFc=!1;this.a1=
l;this.mfb=K;this.ZBa=new Wg.a(function(){return new kh.a(ka.value,Object(fd.a)(Dc,Dc.Dsb,"getMoreInfoEventReceived"))});this.ggg=$a;this.hpa=Lb;this.Ejg=bc;this.Fib=this.Wrc;2===this.ZJ.gba&&(this.dLc=!0)}function zg(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function hg(){}function bh(){}b.r(F);var Nf=b(514),fe=b(0),ch=b(274);bh.prototype.$h=function(){};bh.prototype.init=function(){};bh.prototype.dispose=function(){};bh.main=function(){ch.a.instance.oj(new bh)};Jl.Object.defineProperties(bh.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(fe.a)(bh,"CommonAppDialogWithLinkToResourcePackage",null,[8,9]);var Wg=b(675),qd=b(15),fd=b(37),kh=b(924),Lf=b(30),te=b(126);hg.l8g=function(l){return hg.qme("New",l)};hg.m8g=function(l){return hg.qme("Open",l)};hg.ame=function(l,K){return hg.sga("LoadingMenuSection",hg.kbi,l,hg.fmb("lblLoading",K))};hg.gmb=function(l,K,ka,$a){return hg.sga("MessageMenuSection",hg.ygf,K,hg.fmb("lblMessage",l,
void 0===ka?null:ka,void 0===$a?null:$a))};hg.gEg=function(l){return hg.ame(l,CommonUIStrings.l_VoicedLoadingText)};hg.hEg=function(l,K){return hg.gmb(CommonUIStrings.l_NewCreationLocationMessage,l.$i,K.G5,K.rza)};hg.fEg=function(l,K){return hg.gmb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,K.rza,"\n\n"),l.$i)};hg.cme=function(l){return hg.gmb(CommonUIStrings.l_NewGenericErrorMessage,l.$i)};hg.dEg=function(l,K,ka){return hg.sga("menuNewBlank",hg.tQh,ka?l.$i:null,hg.amb(l.wZe,l.xZe,
l.yZe,null,l.Wia,l.uub,K,"blank"))};hg.cFg=function(){return hg.fmb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};hg.lme=function(){return hg.fmb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};hg.dFg=function(l,K){return hg.sga("menuNewTemplates",l,null,K)};hg.bEg=function(l,K){return hg.sga("menuNewMoreTemplates",hg.MLe,null,hg.amb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,l,K))};hg.hDg=function(l,
K,ka){var $a="";ka&&K&&($a=hg.sga("BrowseMoreMenuSection",hg.MLe,null,hg.amb("btnBrowseMore",K,K,null,null,null,l||"1959943459",ka)));return $a};hg.fmb=function(l,K,ka,$a){ka=void 0===ka?null:ka;var Lb=$a=void 0===$a?null:$a;K&&0<K.length&&(Lb=hg.ohf.skc(K).trimEnd(),Lb=0<=Lb.indexOf("{0}")?String.format(Lb,$a):String.format("{0} {1}",Lb,$a));ka=ka&&$a?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Lf.a.Sf(ka),Lf.a.Sf($a),Lf.a.Sf(Lb)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Lf.a.Sf(l||""),hg.ohf.skc(Lf.a.Sf(K||"")),ka)};hg.amb=function(l,K,ka,$a,Lb,bc,Dc,wd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Lf.a.Sf(l||""),Lf.a.Sf(K||""),Lf.a.Sf(ka||""),$a||"32by32",
Lf.a.Sf(Lb||""),Lf.a.Sf(bc||""),Dc,Lf.a.Sf(wd||""))};hg.qme=function(l,K){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',l,K)};hg.sga=function(l,K,ka,$a){ka=ka?String.format('Title="{0}"',Lf.a.Sf(ka)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Lf.a.Sf(l||""),Lf.a.Sf(K||
""),ka,$a)};hg.ygf="MenuMru";hg.kbi="MenuLoading";hg.tQh="MenuHeader";hg.MLe="MenuFooter";hg.ohf=te.a.jx("\n","&#10;");Object(fe.a)(hg,"NewAndOpenXmlUtilities",null,[]);var Wd=b(5),mh=b(93),ug=b(242);Object(fe.a)(zg,"HostInformation",null,[]);var ki=b(112),Hg=b(49),Mg=b(523),Eh=b(177),Gh=b(678),qi=b(590),Bh=b(111),Cf=b(29);jg.prototype.Rg=function(){var l=this.ZJ.Z5a;l.$b(Cf.a.newDocument,Bh.a.frame,Object(fd.a)(this,this.newDocument,"newDocument"));l.Jf(Cf.a.Jkc,Bh.a.frame,Object(fd.a)(this,this.Jkc,
"populateNewMenu"),96)};jg.prototype.newDocument=function(l,K,ka,$a,Lb){return 1===ka?32:2===ka&&Lb&&Lb.MenuItemId&&Lb.SourceControlId?this.XYa(Lb.MenuItemId,Lb.SourceControlId):8};jg.prototype.XYa=function(l,K){var ka=this.Xgc.uZc;if(null===ka)return 8;var $a=Wd.AFrameworkApplication.ha.ta("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(Wd.AFrameworkApplication.Lja&&$a){qd.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var Lb=
{};Lb[Mg.a.nJb]=l;Lb[Mg.a.IO]=this.IO;Lb[Mg.a.lcid]=Wd.AFrameworkApplication.lcid.toString();Lb[Mg.a.reason]=Gh.a.createNew;Wd.AFrameworkApplication.$Y().execute(function(bc){bc.Yj(Eh.a.XYa,Lb)})}else $a=(new Date).getTime(),K=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ka,Lf.a.rf(this.qka),Lf.a.rf(l),Lf.a.rf(this.IO),Lf.a.rf(Wd.AFrameworkApplication.lcid.toString()),Lf.a.rf($a.toString()),Lf.a.rf(K),Lf.a.rf(Wd.AFrameworkApplication.canary),
Wd.AFrameworkApplication.hj),(ka=Wd.AFrameworkApplication.ha.Wa("ScenarioId"))&&""!==ka&&(K+="&wdscenarioid="+Lf.a.rf(ka)),K+="&"+Wd.AFrameworkApplication.L8b(),Wd.AFrameworkApplication.nva&&(K+="&"+Wd.AFrameworkApplication.g8b()),(ka=this.zo?this.zo.G5:null)&&(K+="&DestinationUrl="+Lf.a.rf(ka)),Hg.a.wf(K,"_blank",void 0,"CreateNewDocument");2===this.ZJ.gba&&(K={},qd.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(K.AppType=qi.a[this.ZJ.gba],K.Template=l,K)));return 32};jg.prototype.Vdi=
function(l){var K=Number.MAX_VALUE,ka=Number.MIN_VALUE,$a=window.performance;if($a&&"undefined"!==typeof $a.getEntriesByName){for(var Lb=0;Lb<l.length;Lb++){var bc=$a.getEntriesByName(l[Lb]);bc&&0<bc.length&&(bc=bc[0],K=Math.min(parseInt(String(bc.fetchStart)),K),ka=Math.max(parseInt(String(bc.responseEnd)),ka))}ka>K&&(l={},qd.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(l.TotalElapsedMs=ka-K,l.MinFetchStart=K,l.MaxResponseEnd=ka,l)))}};jg.prototype.Jkc=function(l,
K,ka,$a,Lb){if(1===ka)return this.dLc&&(Wd.AFrameworkApplication.uQ("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.dLc=!1),32;2!==ka||this.yFc||(this.N3d=(new Date).getTime(),l={},qd.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(l.ShouldShowTemplates=this.Wrc,l.CachedNewMenuXmlExists=!!this.eNb,l.ShouldCallGetMoreInfo=this.ZJ.supportsGetMoreInfoForPersonalStorage,l)));return this.AGi(Lb)};jg.prototype.AGi=function(l){l&&(this.eNb?l.PopulationXML=
this.eNb:(this.ZJ.supportsGetMoreInfoForPersonalStorage&&!this.zo&&this.vki.Ky("Opened New menu",!0),l.PopulationXML=this.wsh(this.getTemplateListJson())));return 32};jg.prototype.B7e=function(){return!this.ZJ.supportsGetMoreInfoForPersonalStorage||!!this.zo&&3===this.zo.state&&!!this.zo.rza&&!!this.zo.G5};jg.prototype.T4h=function(){return Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.wZ?!0:this.B7e()};jg.prototype.getTemplateListJson=function(){var l=this;if(!this.Wrc||!this.T4h())return null;
if(this.Fib&&!this.USb){var K="9",ka=Wd.AFrameworkApplication.ha.appSettings;"NumberOfTemplatesInBackstage"in ka&&(K=ka.NumberOfTemplatesInBackstage);var $a=this.IO;"TemplateCollectionId"in ka&&($a=ka.TemplateCollectionId);K=String.format(this.ZJ.PZ+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Lf.a.rf(Wd.AFrameworkApplication.lcid.toString()),Lf.a.rf($a),K);Boolean.parse(ka.AppendOriginQueryParam||"false")&&(K+="&org=backstage");K+="&"+Wd.AFrameworkApplication.L8b();Wd.AFrameworkApplication.nva&&
(K+="&"+Wd.AFrameworkApplication.g8b());this.ZJ.yzb.Wl(K,1,null,null,!1,2,function(Lb){l.ZJ.LLa("CreateNewActor.GetTemplateListJson",Lb.data);l.soj(Lb.data.pe)},function(Lb){l.ZJ.LLa("CreateNewActor.GetTemplateListJson",Lb.data);l.roj()},null,void 0,void 0,void 0,void 0,"5");this.Fib=!1}return this.kMc};jg.prototype.soj=function(l){this.kMc=l;this.Fib=!1;this.ODb();if(Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.wZ&&ug.appChromeAlreadyLoaded()){l=Wd.AFrameworkApplication.ha.ta("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var K=Wd.AFrameworkApplication.Lja;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.kMc,!0,l&&K))}};jg.prototype.roj=function(){this.USb=this.Fib=!0;this.ODb();Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.wZ&&ug.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));mh.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};jg.prototype.pJh=function(l){for(var K=
0,ka=0;ka<l.length;ka++)if("ST"===l[ka].ImageType){K=ka;break}var $a=l.length?l[K]:null;l=$a?$a.Url||"":"";var Lb,bc=ka=K=!1;if($a&&(Lb=$a.AspectRatio))Lb=parseFloat(Lb),1>Lb?K=!0:1.5<Lb?ka=!0:1===Lb&&(bc=!0);else switch(Lb={},qd.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(Lb.Url=l,Lb)),this.ZJ.gba){case 3:K=!0;break;case 2:ka=!0;break;case 5:bc=!0}return{returnValue:l,PSh:K?"95by123":ka?"123by69":bc?"100by100":"123by95"}};jg.prototype.wsh=function(l){var K=this.eEg(l,this.Xgc,
this.Xgc.SEa||"1056925771");l=K.returnValue;if(K.vrc){this.eNb=l;K=(new Date).getTime()-this.N3d;var ka={};qd.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(ka.ElapsedMsSinceMenuOpened=K,ka))}return l};jg.prototype.Dsb=function(l,K){qd.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.zo||3!==l.state?2===l.state&&(qd.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.oLc=!0,this.ODb()):(this.zo=l,K||this.ODb(),
Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.wZ&&ug.appChromeAlreadyLoaded()&&ug.appChromeContainsAction("setFileMenuHostInformation")&&(l=Object.assign(new zg,{hostUrl:this.zo.G5,hostName:this.zo.rza,folderUrl:Wd.AFrameworkApplication.breadcrumbFolderUrl,folderName:Wd.AFrameworkApplication.breadcrumbFolderName}),qd.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(l))))};jg.prototype.eEg=function(l,
K,ka){var $a=!1;var Lb=this.B7e(),bc="";if(this.ZJ.supportsGetMoreInfoForPersonalStorage)if(this.oLc)bc=hg.cme(K),this.oLc=!1,qd.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.zo)if(Lb)bc=hg.hEg(K,this.zo);else if(this.zo.MXh)$a=!0,this.Fib=!1,bc=hg.fEg(K,this.zo),qd.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{$a=!0;bc=hg.cme(K);var Dc={};qd.ULS.sendTraceTag(5849608,
202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(Dc.PersonalFileStorageUrlIsSet=!!this.zo.G5,Dc.StorageServiceDisplayNameIsSet=!!this.zo.rza,Dc))}else bc=hg.gEg(K.$i),qd.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");Lb&&(Lb=bc,K=hg.dEg(K,ka,!bc),l=this.bFg(l,ka),$a=l.vrc,bc=Lb+(K+l.returnValue));return{returnValue:hg.l8g(bc),vrc:$a}};jg.prototype.bFg=function(l,K){var ka=!1;if(!this.Wrc)return ka=!0,qd.ULS.sendTraceTag(5849609,202,
50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",vrc:ka};var $a="",Lb="",bc="MenuTemplate";if(this.USb)$a=hg.lme(),this.USb=!1,qd.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(l){try{var Dc=Sys.Serialization.JavaScriptSerializer.deserialize(l,!0);$a=this.aFg(Dc,K);qd.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");Wd.AFrameworkApplication.phf&&"OneDrive"===this.qka&&(Lb=hg.bEg(this.wki,Wd.AFrameworkApplication.phf))}catch(wd){K=
{},qd.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(K.JsonToConvert=l,K)),$a=hg.lme()}ka=!0}else bc="MenuLoading",$a=hg.cFg(),qd.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:hg.dFg(bc,$a)+Lb,vrc:ka}};jg.prototype.aFg=function(l,K){for(var ka=this,$a="",Lb=[],bc=0;bc<l.length;bc++){var Dc=l[bc],wd="";if(Dc){var ke=Dc.Title,jf=Dc.AssetId,Xf=Dc.Thumbnails;jf&&ke&&Xf&&(Dc=void 0,wd=this.pJh(Xf),Dc=wd.PSh,
wd=wd.returnValue,$a+=hg.amb("jbtnNewTemplate"+bc,ke,null,Dc,null,wd,K,jf))}Lb[bc]=wd}l=new ki.a(4,1,5E3,function(){ka.Vdi(Lb)},106);this.ZJ.Vgc.sh(l);return $a};jg.prototype.ODb=function(){this.yFc=!0;this.ZJ.hhf.yw(this.Xgc.$qb);this.yFc=!1};Jl.Object.defineProperties(jg.prototype,{IO:{configurable:!0,enumerable:!0,get:function(){switch(this.ZJ.gba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},ZJ:{configurable:!0,enumerable:!0,
get:function(){return this.a1.value}},Xgc:{configurable:!0,enumerable:!0,get:function(){return this.mfb.value}},vki:{configurable:!0,enumerable:!0,get:function(){return this.ZBa.value}},wki:{configurable:!0,enumerable:!0,get:function(){return this.ggg.value}},qka:{configurable:!0,enumerable:!0,get:function(){return this.hpa.value}},Wrc:{configurable:!0,enumerable:!0,get:function(){return this.Ejg.value}}});Object(fe.a)(jg,"CreateNewActor",null,[]);var Yh=b(1292),aa=Yh.a;Cm(Kg,aa);Kg.prototype.gee=
function(){this.LS(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.LS(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.LS(2,CommonUIStrings.l_Open);this.LS(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.LS(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.LS(5,CommonUIStrings.l_VoicedLoadingText)};Kg.pCi=function(l){return Kg.instance.da(l)};Jl.Object.defineProperties(Kg,{instance:{configurable:!0,enumerable:!0,get:function(){return Kg.Pa||(Kg.Pa=new Kg)}}});Kg.Pa=null;Object(fe.a)(Kg,"MruActorIntlHelper",
Yh.a,[]);var ab;(function(l){l[l.success=0]="success";l[l.failure=1]="failure";l[l.spinner=2]="spinner";l[l.none=3]="none"})(ab||(ab={}));Object(fe.b)("DisplayState",ab);var Rb=b(41);nf.prototype.eji=function(l,K){this.jUa=l;K||this.UCf()};nf.prototype.HQi=function(){this.BC.Z5a.Jf(Cf.a.Ikc,Bh.a.frame,Object(fd.a)(this,this.Ikc,"populateMruMenu"),96)};nf.prototype.Ikc=function(l,K,ka,$a,Lb){return 1!==ka&&Lb?this.wGi(Lb):32};nf.prototype.wGi=function(l){this.Q8g();this.P8g();l.PopulationXML=hg.m8g(this.dNb+
this.$zc);return 32};nf.prototype.Q8g=function(){var l=3,K=!1;if(this.dNb&&this.olg===this.jUa.Tpj)l={},qd.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(l.CacheRefresh="Not Dirty",l)),l=this.pGc;else{var ka={};qd.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(ka.CacheRefresh="Starting",ka));ka=this.BC.Rv();this.jUa=this.dji.Ky("File Open opened",!0);if(this.dNb&&2!==this.pGc&&3!==this.jUa.state)K=!0;else{l=this.uHh(this.jUa);
Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.wZ&&ug.appChromeAlreadyLoaded()&&l&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(l,!0));var $a=this.xsh(this.jUa);l=$a.nki;this.dNb=$a.returnValue}ka=this.BC.Rv()-ka;$a={};qd.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",($a.CacheRefresh="Complete",$a.ElapsedMs=ka,$a))}2!==l&&(ka={},ka=(ka.DisplayState=ab[l],ka),1!==l&&(ka.IsStale=K),qd.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
ka));this.pGc=l};nf.prototype.uHh=function(l){try{var K=Rb.c(l.aqd)}catch(ka){K=null,qd.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ka)}return K};nf.prototype.P8g=function(){if(this.gNc){qd.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var l=this.ifi();this.gNc=l.fCj;this.$zc=l.returnValue}else qd.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");l={};qd.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",(l.WaitingOnLinkInfo=this.gNc,l.NotDisplayingLink=!this.$zc,l))};nf.prototype.xsh=function(l){if(1!==l.state&&l.state)if(3===l.state&&l.aqd){var K=this.cEg(l.aqd);l=0}else l={},qd.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(l.Display="Server Error",l)),K=hg.gmb(this.Eia(1),this.Eia(2)),l=1;else l={},qd.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(l.Display="Spinner",l)),l=2,K=hg.ame(this.Eia(2),this.Eia(5));return{returnValue:K,
nki:l}};nf.prototype.cEg=function(l){var K=this.Xyb.SEa||"2155708348";if(l.length){var ka=hg.fmb("lblRecentDocuments",this.Eia(3));for(var $a=0,Lb=0;Lb<l.length;Lb++){var bc=l[Lb];"FileName"in bc&&"DocumentUrl"in bc&&"Path"in bc&&(ka+=hg.amb("MruButton"+Lb,bc.FileName.toString(),bc.Path.toString(),null,this.Xyb.Wia,this.Xyb.uub,K,bc.DocumentUrl.toString()),bc.IsPinned&&$a++)}ka=hg.sga("RecentDocumentsMenuSection",hg.ygf,this.Eia(2),ka);K={};qd.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",
(K.Display="MRU List",K.TotalDocuments=l.length,K.NumPinnedDocuments=$a,K))}else ka=hg.gmb(this.Eia(0),this.Eia(2)),l={},qd.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(l.Display="Empty MRU",l));return ka};nf.prototype.ifi=function(){var l=!0;var K=this.ACg,ka=this.zCg;if(K&&ka||!this.BC.supportsGetMoreInfoForPersonalStorage)l=!1;else{var $a=this.r8b.Ky("File Open",!1);3===$a.state&&(K=$a.G5,ka=$a.rza,l=!1)}ka=ka?String.format(this.Eia(4),ka):null;return{returnValue:hg.hDg(this.Xyb.SEa,
ka,K),fCj:l}};nf.prototype.UCf=function(){this.BC.hhf.yw(this.Xyb.$qb)};Jl.Object.defineProperties(nf.prototype,{BC:{configurable:!0,enumerable:!0,get:function(){return this.a1.value}},Eia:{configurable:!0,enumerable:!0,get:function(){return this.gj.value}},Xyb:{configurable:!0,enumerable:!0,get:function(){return this.kcg.value}},ACg:{configurable:!0,enumerable:!0,get:function(){return this.o$f.value}},zCg:{configurable:!0,enumerable:!0,get:function(){return this.n$f.value}},r8b:{configurable:!0,
enumerable:!0,get:function(){return this.ZBa.value}},dji:{configurable:!0,enumerable:!0,get:function(){return this.adg.value}}});Object(fe.a)(nf,"MruRenderer",null,[]);var Cc=b(228),Bc=b(880);yg.prototype.XYa=function(){!this.zo&&this.Lqd.supportsGetMoreInfoForPersonalStorage?this.r8b.Ky("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};yg.prototype.Dsb=function(l){if(!this.zo&&3===l.state)this.zo=l;else if(2===l.state){this.L8d?qd.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):
(this.r8b.Ky("NewDocumentFromStream",!0),this.L8d=!0);return}this.createNewDocumentFromStream()};yg.prototype.createNewDocumentFromStream=function(){this.DVd=(new Date).getTime();var l=this.Zkh.uZc;if(null===l)this.yUa(null);else{var K=this.JQb.ua,ka=this.JQb.PH,$a=this.JQb.bmj,Lb=this.JQb.clh;this.woa="streamBase64"===$a?Lb.length/1024:0;qd.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.IO,this.woa);var bc=(new Date).getTime();l=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
l,Lf.a.rf(this.qka),Lf.a.rf(K),Lf.a.rf(this.IO),Lf.a.rf(Wd.AFrameworkApplication.lcid.toString()),Lf.a.rf(bc.toString()),Lf.a.rf(ka),Lf.a.rf(Wd.AFrameworkApplication.canary),Wd.AFrameworkApplication.hj,Lf.a.rf($a));l+="&"+Wd.AFrameworkApplication.L8b();Wd.AFrameworkApplication.nva&&(l+="&"+Wd.AFrameworkApplication.g8b());(K=this.zo?this.zo.G5:null)&&(l+="&DestinationUrl="+Lf.a.rf(K));this.Lqd.yzb.Wl(l,2,Lb,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(fd.a)(this,this.qki,"newDocumentFromStreamSuccessHandler"),
Object(fd.a)(this,this.pki,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}};yg.prototype.qki=function(l){if(l&&l.data&&l.data.pe){var K=Rb.d(l.data.pe);var ka=K.xu;K.returnValue?ka.StatusCode!==Cc.a.bO&&ka.StatusCode!==Cc.a.Bob?(qd.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.IO,this.woa,ka.StatusCode),this.yUa(null)):ka.NewDocumentUrl&&""!==ka.NewDocumentUrl?(l=(new Date).getTime()-this.DVd,
qd.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.IO,this.woa,l),this.ogg(ka.NewDocumentUrl)):(qd.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.IO,this.woa),this.yUa(null)):(ka={},qd.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.IO,this.woa,(ka.ResponseData=Bc.a.Ibb(l.data.pe),
ka)),this.yUa(null))}else qd.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.IO,this.woa),this.yUa(null)};yg.prototype.pki=function(l){l&&l.data&&qd.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.IO,this.woa,l.data.status);this.yUa(null)};Jl.Object.defineProperties(yg.prototype,{IO:{configurable:!0,enumerable:!0,get:function(){switch(this.Lqd.gba){case 3:return"WordWAC";
case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},Zkh:{configurable:!0,enumerable:!0,get:function(){return this.mfb.value}},qka:{configurable:!0,enumerable:!0,get:function(){return this.hpa.value}},Lqd:{configurable:!0,enumerable:!0,get:function(){return this.a1.value}},r8b:{configurable:!0,enumerable:!0,get:function(){return this.ZBa.value}}});Object(fe.a)(yg,"NewDocumentFromStreamOperation",null,[]);Kc.prototype.create=function(l,K,ka){return new yg(l,K,
ka,this.mfb,this.hpa,this.a1,this.$cg)};Object(fe.a)(Kc,"NewDocumentFromStreamOperationFactory",null,[340]);var Dd=b(88),Ee=b(525),we=b(52);Rc.prototype.$h=function(l){l.register(Kc,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Ac().Lc(function(){return new Kc(new Wg.a(function(){return Wd.AFrameworkApplication.za.Za.n9c()}),new Wg.a(function(){return Wd.AFrameworkApplication.qka}),new Wg.a(function(){return l.Uh("Common.INewAndOpenCommonHelpers")}),
new Wg.a(function(){return l.Uh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};Rc.prototype.init=function(){var l=this;Wd.AFrameworkApplication.ha.Xv(function(){l.Nub()})};Rc.prototype.Nub=function(){var l=Ee.a.uq(Dd.a.instance.yc("Common.INewAndOpenCommonHelpers")),K=Ee.a.uq(Dd.a.instance.yc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Wd.AFrameworkApplication.qka&&we.Task.WAA.call(null,l,K).continueWith(function(){var $a=new jg(new Wg.a(function(){return l.result}),new Wg.a(function(){return Wd.AFrameworkApplication.za.Za.n9c()}),
new Wg.a(function(){return K.result}),new Wg.a(function(){return Wd.AFrameworkApplication.za.Za.o9c().SEa||"1959943459"}),new Wg.a(function(){return Wd.AFrameworkApplication.qka}),new Wg.a(function(){return Wd.AFrameworkApplication.F3h}));$a.Rg();$a.ODb()});if(Wd.AFrameworkApplication.JBf){var ka=Ee.a.uq(Dd.a.instance.yc("Common.IEventEmitter<Common.IMruResult>"));we.Task.WAA.call(null,l,K,ka).continueWith(function(){var $a=new nf(new Wg.a(function(){return l.result}),new Wg.a(function(){return Kg.pCi}),
new Wg.a(function(){return Wd.AFrameworkApplication.za.Za.o9c()}),new Wg.a(function(){return Wd.AFrameworkApplication.oCi}),new Wg.a(function(){return Wd.AFrameworkApplication.nCi}),new Wg.a(function(){return K.result}),new Wg.a(function(){return ka.result}),Wd.AFrameworkApplication.ha);$a.HQi();$a.UCf()})}};Rc.prototype.dispose=function(){};Jl.Object.defineProperties(Rc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(fe.a)(Rc,"UXPackageManager",
null,[8,9,7]);var Be=b(128),We=Be.StandardDialog;Cm(of,We);of.prototype.displayError=function(l){this.kz(l,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};of.prototype.d1c=function(l){this.kz(l,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(fe.a)(of,"ErrorDialog",Be.StandardDialog,[335]);var bg=b(139);hd.prototype.QNe=function(){qd.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var l=new bg.a;l.setResult("api.onedrive.com");
return l.task};Object(fe.a)(hd,"OneDriveConsumerEndpointHelper",null,[317]);var Ff=b(51),Ng=b(370),Sg=b(217);le.prototype.i1a=function(){this.AUa||(this.AUa=this.f7a?Sg.a.create(this.f7a,null,null,null,!1):null);return this.AUa};le.prototype.setup=function(l){var K=this;this.QCa=l;this.WKc||this.UKc?this.WKc&&this.QCa&&this.QCa(!0):(l=this.i1a())?(this.UKc=!0,l.o5a.continueWith(function(ka){K.Jwi(ka)}),Ng.a.j3(l)):(qd.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),
this.QCa(!1))};le.prototype.Gtd=function(l){qd.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",l.Kg?l.Kg.toString():"No error detail.")};le.prototype.Jwi=function(l){this.UKc=!1;if(l.ng)this.Gtd(l),this.QCa(!1);else try{this.WKc=!0,qd.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.$ed(),qd.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.QCa(!0)}catch(K){qd.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",
K.toString()),this.QCa(!1)}};le.prototype.startPicker=function(l){this.o5=l;this.wCa?qd.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(qd.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(fd.a)(this,this.lsd,"onApiReady")))};le.prototype.lsd=function(l){l?this.zec():this.ki()};le.prototype.ki=function(){this.ds().displayError(Ff.a.QBi)};le.prototype.onSuccess=function(l){qd.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.o5&&this.o5(!0,l)};le.prototype.dispose=function(){this.AUa&&this.AUa.dispose()};Jl.Object.defineProperties(le.prototype,{Hhe:{configurable:!0,enumerable:!0,get:function(){return this.NMb}},ha:{configurable:!0,enumerable:!0,get:function(){return this.yb}}});Object(fe.a)(le,"AOneDriveFilePickerApiManager",null,[348,7]);Cm(mc,le);mc.prototype.start=function(l,K){this.yh=l;this.startPicker(K)};mc.prototype.$ed=function(){var l={},K={};l=1===this.Hhe||2===this.Hhe?(l.client_id=this.ha.appSettings.UploadToSkyDriveClientId,
l):(K.client_id=this.ha.appSettings.UploadToSkyDriveClientId,K.env="INT",K);WL.init(l)};mc.prototype.startPicker=function(l){this.o5=l;!this.wCa&&this.g1.hKa?(qd.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(fd.a)(this,this.lsd,"onApiReady"))):(qd.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Njg())};mc.prototype.zec=function(){try{qd.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.yh).then(Object(fd.a)(this,
this.onSuccess,"onSuccess"),Object(fd.a)(this,this.n5,"onFailure"))}catch(l){qd.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",l,l.stack),this.ki()}};mc.prototype.n5=function(l){if(l&&l.error){if("user_canceled"===l.error.code){qd.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}qd.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",l.error.code,l.error.message)}else qd.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.o5&&this.o5(!1,l);this.ki()};Jl.Object.defineProperties(mc.prototype,{f7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiUrl")}}});Object(fe.a)(mc,"OneDriveFilePickerApiManagerV5",le,[]);Cm(Db,le);Db.prototype.start=function(l,K){var ka=this;this.fPb=K;var $a=this.Jbg.QNe();$a.continueWith(function(){qd.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");ka.w5d=$a.result;ka.startPicker(function(Lb,
bc){ka.Euc();l(Lb,bc)})},3);$a.continueWith(function(){qd.ULS.sendTraceTag(24134242,352,15,$a.Kg.message);ka.Euc()},5)};Db.prototype.$ed=function(){var l=this;this.options.success=function(K){var ka={};ka.data=K;l.onSuccess(ka)};this.options.error=function(K){var ka={};ka.error=K;l.n5(ka)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.w5d;this.options.advanced.iframeParentDiv=this.fPb};Db.prototype.zec=function(){try{qd.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Euc(),OneDrive.open(this.options)}catch(l){qd.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",l.message),this.ki()}};Db.prototype.n5=function(l){this.o5&&this.o5(!1,l);this.ki()};Db.prototype.Euc=function(){this.fPb.style.visibility="hidden"===this.fPb.style.visibility?"":"hidden"};Jl.Object.defineProperties(Db.prototype,{f7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});
Object(fe.a)(Db,"OneDriveFilePickerApiManagerV7",le,[]);Cm(Yc,le);Yc.prototype.start=function(l,K,ka,$a){this.options.advanced.iframeParentDiv=ka;this.options.advanced.endpointHint=$a;this.options.cancel=K;this.C9f.ta("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(l)};Yc.prototype.startPicker=
function(l){this.o5=l;this.wCa?qd.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(qd.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(fd.a)(this,this.lsd,"onApiReady")))};Yc.prototype.$ed=function(){var l=this;this.options.success=function(K){var ka={};ka.data=K;l.onSuccess(ka)};this.options.error=function(K){var ka={};ka.error=K;l.n5(ka)}};Yc.prototype.zec=function(){try{qd.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),
OneDrive.save(this.options)}catch(l){qd.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",l.message,l.stack),this.ki()}};Yc.prototype.Gtd=function(l){qd.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",l.Kg?l.Kg.toString():"No error detail.");Ng.a.xSi(this.f7a);this.AUa=null};Yc.prototype.ki=function(){this.ds().d1c(Ff.a.R0i)};Yc.prototype.n5=function(l){this.o5&&this.o5(!1,l)};Jl.Object.defineProperties(Yc.prototype,
{f7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});Object(fe.a)(Yc,"OneDriveFilePickerApiManagerV72",le,[]);Object(fe.a)(bd,"IExtraData",null,[]);Cm(Jc,Yc);Jc.prototype.zec=function(){try{qd.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",Wd.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(l){qd.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",l.message,l.stack),this.ki()}};Jl.Object.defineProperties(Jc.prototype,{f7a:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});Object(fe.a)(Jc,"OneDriveFilePickerApiOpenManagerV72",Yc,[]);Nb.prototype.QNe=function(){this.Ul=new bg.a;qd.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");
this.iGd();return this.Ul.task};Nb.prototype.iGd=function(l){l=void 0===l?null:l;var K=String.format("GetMoreInfoHandler.ashx?{0}",Wd.AFrameworkApplication.fGa);this.Ug.J8(K,1,null,l,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(fd.a)(this,this.eDh,"getMoreInfoSucceeded"),Object(fd.a)(this,this.cDh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Nb.prototype.cDh=function(l){if(l.data.httpStatus===Cc.a.QCb&&"X-NewKey"in l.data.responseHeaders){qd.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");
var K={};K["X-Key"]=l.data.responseHeaders["X-NewKey"];this.iGd(K)}else 0<this.YJc?(qd.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.YJc),this.YJc--,this.iGd()):(qd.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Ul.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};Nb.prototype.eDh=function(l){"PersonalFileStorageUrl"in l.data.responseHeaders&&
""!==l.data.responseHeaders.PersonalFileStorageUrl?(qd.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Ul.setResult(l.data.responseHeaders.PersonalFileStorageUrl)):(qd.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Ul.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(fe.a)(Nb,"OneDriveForBusinessEndpointHelper",null,[317]);var vg=b(578);ob.prototype.init=function(){};
ob.prototype.dispose=function(){};ob.prototype.$h=function(l){var K=this;this.pb=l;this.pb.register(mc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Ac().Lc(function(){return new mc(vg.a.instance,Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.s_a,Wd.AFrameworkApplication.limitedEdit,Wd.AFrameworkApplication.VTf,function(){return new of})});Wd.AFrameworkApplication.v8e?this.pb.register(317,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ac().Lc(function(){return new hd}):
this.pb.register(317,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ac().Lc(function(){return new Nb(Wd.AFrameworkApplication.Md)});this.pb.register(Db,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Ac().Lc(function(){return new Db(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.s_a,Wd.AFrameworkApplication.limitedEdit,function(){return new of},K.pb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.pb.register(Yc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Ac().Lc(function(){return new Yc(Wd.AFrameworkApplication.ha,
Wd.AFrameworkApplication.s_a,Wd.AFrameworkApplication.limitedEdit,function(){return new of})});this.pb.register(Jc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Ac().Lc(function(){return new Jc(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.s_a,Wd.AFrameworkApplication.limitedEdit,function(){return new of})})};ob.main=function(){ch.a.instance.oj(new ob)};Jl.Object.defineProperties(ob.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});
Object(fe.a)(ob,"PackageManager",null,[8,9]);var vh=Be.StandardDialog;Cm(Ja,vh);Ja.prototype.displayError=function(l,K,ka){this.Fz=K;this.BUa=ka;qd.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",l,ka);(l=this.kVc(l))?(this.lc=0,this.Dc(1,CommonUIStrings.l_DialogClose)):(this.lc=6,this.Dc(0,CommonUIStrings.l_DialogClose));l||qd.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.kz(Ff.a.Q0i,this.V8c(l),this.Txh(l,K),Object(fd.a)(this,this.nEd,"retryDialogHandler"),
!0)};Ja.prototype.nEd=function(l){1===l?(qd.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.Fz?this.Oa.Pe(Cf.a.KFb,2,[this.Fz,this.BUa]):this.Oa.processAction(Cf.a.KFb,2)):qd.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};Ja.prototype.kVc=function(l){return 0>l||6<l?(qd.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",l),0):l};Ja.prototype.Txh=function(l,K){l=this.kVc(l);return this.hfb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,K),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][l]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,K),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][l]};Ja.prototype.V8c=
function(l){l=this.kVc(l);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][l]};Object(fe.a)(Ja,"ErrorRetryDialog",Be.StandardDialog,[344]);Ne.prototype.create=function(){return new Ja(this.Oa,this.hfb)};Object(fe.a)(Ne,"ErrorRetryDialogFactory",null,[332]);var Ag=b(140),Aa=b(40),pa=Ag.a;Cm(qe,
pa);qe.prototype.vze=function(l,K){this.zK(1,!!l&&l!==K);this.lI=document.getElementById(qe.OJe);Aa.a.addHandler(this.lI,"change",Object(fd.a)(this,this.gic,"onFileNameChange"));Aa.a.addHandler(this.lI,"input",Object(fd.a)(this,this.gic,"onFileNameChange"));this.lI.focus()};qe.prototype.g5b=function(l){return this.hfb?(new RegExp("["+this.W3b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.W3b('\\/:*?"<>|#{}%~&')+"]")).test(l)};qe.prototype.W3b=function(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")};qe.prototype.Ybd=function(){var l=Lf.a.Pq(Wd.AFrameworkApplication.zl.zn);this.zK(1,!!this.lI&&""!==this.lI.value&&this.lI.value!==l)};qe.prototype.gic=function(){var l=this;this.lI&&window.setTimeout(function(){l.Ybd()},0)};qe.prototype.f5b=function(l,K){if(1!==l)qd.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=K[qe.OJe];K=qe.Zuf in K?K[qe.Zuf]:!1;qd.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",
Lf.a.dmc(l),K);var ka=Lf.a.I$(Wd.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==ka||1===this.za.state?this.g5b(l)?this.ds.create().displayError(1,l,K):this.Afa.Ema(l+ka,K,this.yh):this.ds.create().displayError(2,l,K)}};qe.prototype.dispose=function(){this.lI&&(Aa.a.removeHandler(this.lI,"change",Object(fd.a)(this,this.gic,"onFileNameChange")),Aa.a.removeHandler(this.lI,"input",Object(fd.a)(this,this.gic,"onFileNameChange")),this.lI=null);pa.prototype.dispose.call(this)};Jl.Object.defineProperties(qe.prototype,
{za:{configurable:!0,enumerable:!0,get:function(){return this.Me}}});qe.OJe="txtFileName";qe.Zuf="chkOverwrite";Object(fe.a)(qe,"FileNameDialogBase",Ag.a,[]);Jl.Object.defineProperties(Td,{Mf:{configurable:!0,enumerable:!0,get:function(){return Ag.a.jj(Td.Oj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Td.Oj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(fe.a)(Td,"FileNameDialogHtml",null,[]);Cm(kd,qe);kd.prototype.rP=function(l,K){var ka=Lf.a.Pq(Wd.AFrameworkApplication.zl.zn),$a={};K=($a.txtFileName=l||ka,$a.lblFolderName=CommonUIStrings.l_ToCurrentFolder,$a.chkOverwrite=K,$a);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(fd.a)(this,this.f5b,"fileNameDialogHandler"),K);this.vze(l,ka)};Object(fe.a)(kd,"FileNameDialog",qe,[345]);rc.prototype.create=function(){return new kd(this.yb,this.Oa,this.Me,this.VW,this.ds,this.Afa)};Object(fe.a)(rc,
"FileNameDialogFactory",null,[331]);var ub=b(677);tb.prototype.Rg=function(){2===Wd.AFrameworkApplication.za.Za.Xk?Wd.AFrameworkApplication.Hb.Jf(Cf.a.KFb,Bh.a.frame,Object(fd.a)(this,this.nKf,"saveAsToHostActionDispatcher"),4):Wd.AFrameworkApplication.Hb.$b(Cf.a.KFb,Bh.a.frame,Object(fd.a)(this,this.nKf,"saveAsToHostActionDispatcher"))};tb.prototype.nKf=function(l,K,ka,$a,Lb){return K.contextId!==Bh.a.frame||l!==Cf.a.KFb?2:this.yb.ta("SaveAsToHostBrsIsEnabled")?1===ka?ub.SessionStatusManager.instance.Ftb||
Wd.AFrameworkApplication.NU?8:32:2===ka?(qd.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),l=this.zCc.create(),Lb&&Object.getType(Lb)===Array&&2===Lb.length?l.rP(Lb[0],!!Lb[1]):l.rP(null,!1),32):8:8};Object(fe.a)(tb,"SaveAsToHostActor",null,[]);var xd=b(75);qa.prototype.iIb=function(){1!==this.Me.state&&(this.Am=this.Rhb(),this.Am.message=CommonUIStrings.l_CommentProgressTooltip,this.Am.lc=5,this.Am.Fu=!1,this.Am.iza(CommonUIStrings.l_DefaultDialogTitle,
null,null))};qa.prototype.oR=function(l){l=void 0===l?0:l;1!==this.Me.state&&this.ds.create().displayError(l,Lf.a.Pq(this.Fz),this.BUa)};qa.prototype.YNa=function(){var l=this.yb.appSettings.BreadcrumbFolderUrl;qd.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Hg.a.wf(l,Hg.a.JW(3),void 0,"UploadToHostManager.RedirectToFolder")};qa.prototype.XNa=function(l){var K=!1,ka=!1;this.yb&&(K=this.yb.ta("SaveACopyIsEnabledForUiHost"),ka=this.yb.ta("UiHostSupportsDocRebootFeatures"));
qd.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",l,K,ka);if(K&&ka){qd.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var $a={};$a[Mg.a.TNa]="1";$a[Mg.a.documentUrl]=l;$a[Mg.a.reason]=Gh.a.saveAs;Wd.AFrameworkApplication.$Y().execute(function(Lb){Lb.Yj(Eh.a.tsa,$a)})}else K&&!ka&&Wd.AFrameworkApplication.g6e?Hg.a.wf(l,Hg.a.JW(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
Hg.a.wf(l,Hg.a.JW(3),void 0,"UploadToHostManager.RedirectToEditUrl")};qa.prototype.Ema=function(l,K,ka){ka=void 0===ka?null:ka;qd.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.y0d&&!this.y0d()&&this.Ug&&(this.rh&&(this.zfa=this.rh.Ic("DialogShown","SaveAsToHostUploadTime")),this.iIb(),this.BUa=K,this.Fz=l,(this.yh=ka)&&"true"===this.yh.SkipSaveToHost?this.B4b():this.AP())};qa.prototype.AP=function(){var l=this;32!==this.Oa.processAction(Cf.a.POa,1)?(qd.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.B4b()):this.Oa.Pe(Cf.a.POa,2,[function(){qd.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");l.B4b()},function(K,ka){qd.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");l.oR(ka)}])};qa.prototype.eBi=function(l){this.OGa();this.OBa=!1;if(l&&l.data&&l.data.pe){var K=Rb.d(l.data.pe);var ka=K.xu;if(K.returnValue)if(ka.StatusCode!==
Cc.a.bO&&ka.StatusCode!==Cc.a.Bob)qd.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),l={},l.FailureReason=ka.StatusCode.toString(),l.ExtraInfo=ka.ExtraInfo,this.rca(l),this.oR(parseInt(ka.ExtraInfo));else{qd.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.gDd();try{ka.NewDocumentUrl&&""!==ka.NewDocumentUrl?this.XNa(ka.NewDocumentUrl):this.YNa()}catch($a){qd.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",$a.toString())}this.wCb()}else ka=
{},qd.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(ka.ResponseData=Bc.a.Ibb(l.data.pe),ka)),l={},this.rca((l.FailureReason="Failed to deserialize response",l)),this.oR()}else qd.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),l={},this.rca((l.FailureReason="null response",l)),this.oR()};qa.prototype.dBi=function(l){if(5!==l.data.status&&12!==l.data.status||this.OBa){var K={};qd.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(K.Status=l.data.status,K.HttpStatus=l.data.httpStatus,K));K={};this.rca((K.FailureReason=l.data.httpStatus.toString(),K));this.OGa();this.oR();this.wCb()}else qd.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.OBa=!0,this.yh&&"true"===this.yh.SkipSaveToHost?this.B4b():this.AP()};qa.prototype.OGa=function(){this.Am&&(this.Am.close(),this.Am=null)};qa.prototype.wCb=function(){this.zfa&&(this.zfa.stop(),this.zfa=null)};qa.prototype.gDd=function(){this.yh&&"VersionHistory"===
this.yh.SaveEntryPoint&&this.Oa.processAction(Cf.a.Snc,2)};qa.prototype.rca=function(l){this.yh&&"VersionHistory"===this.yh.SaveEntryPoint&&this.Oa.Pe(Cf.a.hDd,2,l)};qa.prototype.B4b=function(){var l=this.LDa+this.wea;l=xd.a.Mk(l,"qs",Lf.a.rf(Wd.AFrameworkApplication.hj));l=xd.a.Mk(l,"n",Lf.a.rf((new Date).getTime().toString()));l=xd.a.Mk(l,"ov",Lf.a.rf(this.BUa.toString()));l=xd.a.Mk(l,"fn",Lf.a.rf(this.Fz));this.yh&&this.yh.FileDownloadUrl&&(l=xd.a.Mk(l,"furl",Lf.a.rf(this.yh.FileDownloadUrl)));
this.Ug.Wl(l,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(fd.a)(this,this.eBi,"onUploadFinished"),Object(fd.a)(this,this.dBi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(fe.a)(qa,"UploadToHostManager",null,[330]);var oe=b(893);ih.prototype.init=function(){Wd.AFrameworkApplication.ha.Xv(Object(fd.a)(this,this.HA,"onFullAppSettingsReady"))};ih.prototype.HA=function(){Wd.AFrameworkApplication.ha.ta("SaveAsToHostBrsIsEnabled")&&this.pb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Rg()};
ih.prototype.$h=function(l){this.pb=l;this.pb.register(Ne,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Lc(function(){return new Ne(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.Hb)}).Ac();this.pb.register(qa,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Lc(function(){return new qa(Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.Md,function(){return Wd.AFrameworkApplication.Ng},
function(){return(new oe.a).create()},l.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Wd.AFrameworkApplication.za,Wd.AFrameworkApplication.za.bB)}).Ac();this.pb.register(rc,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Lc(function(){return new rc(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.za,Wd.AFrameworkApplication.za.Za,l.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ac();
this.pb.register(tb,"Common.App.SaveAsToHost.SaveAsToHostActor").Lc(function(){return new tb(Wd.AFrameworkApplication.ha,l.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),l.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ac()};ih.prototype.dispose=function(){};ih.main=function(){ch.a.instance.oj(new ih)};Jl.Object.defineProperties(ih.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(fe.a)(ih,"SaveAsToHostPackage",null,[8,9]);
var sf=Be.StandardDialog;Cm(uf,sf);uf.prototype.displayError=function(l,K){this.Oze(l,K,Ff.a.S0i)};uf.prototype.Oze=function(l,K,ka){qd.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ka);this.kz(ka,l,K,null)};uf.prototype.d1c=function(l,K){qd.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.kz(Ff.a.U0i,l,K,null,!0)};Object(fe.a)(uf,"ErrorDialog",Be.StandardDialog,[337]);Jl.Object.defineProperties(Cg,{Mf:{configurable:!0,enumerable:!0,
get:function(){return Ag.a.jj(Cg.Oj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});Cg.Oj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(fe.a)(Cg,"FileNameDialogHtml",null,[]);var ef=b(13),fh=b(90),jh=b(87);Cm(Hf,qe);Hf.prototype.rP=function(l){var K=Lf.a.Pq(Wd.AFrameworkApplication.zl.zn),ka=Wd.AFrameworkApplication.breadcrumbFolderName,$a=Wd.AFrameworkApplication.breadcrumbBrandName,Lb={};Lb=(Lb.txtFileName=l||K,Lb);var bc=CommonUIStrings.L_SaveAs;2===Wd.AFrameworkApplication.za.Za.Xk&&(bc=CommonUIStrings.L_SaveACopy);this.initializeAndShow(bc,Object(fd.a)(this,this.f5b,"fileNameDialogHandler"),Lb);this.vze(l,K);this.GGa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Wd.AFrameworkApplication.ha.ta("HideSaveToAnotherFolderButtonforUIHost")||(this.ly=document.getElementById("anotherFolder"),l=document.getElementById("folderLocation"),this.BKc=jh.a.Zhe(l,this.ly,"anotherFolderDescribedBy"),this.ly.className="WACButton WACDialogButtonNormal",l=!1,ka&&ka.length?(this.Xce(this.ly,this.BKc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,$a,ka)),
l=this.Qng($a,ka)):this.Xce(this.ly,this.BKc,CommonUIStrings.l_CurrentOnlineFolder),this.Nog(this.ly),this.Sng(this.ly),l?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.ly,"SaveToAnotherLocationTwo"),qd.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.ly,"SaveToAnotherLocationOne"),Aa.a.addHandler(this.ly,ef.a.click,Object(fd.a)(this,this.qud,"onSaveToAnotherLocationClick")),
Aa.a.addHandler(this.ly,ef.a.Rb,Object(fd.a)(this,this.Hrf,"onSaveToAnotherLocationKeyDown")))};Hf.prototype.Qng=function(l,K){var ka=!1;var $a=document.getElementById("currentLocation");$a.innerText="";var Lb=this.fSe($a,l),bc=this.fSe($a,K),Dc=255,wd=255;255<Lb+bc&&(Dc=Math.max(238,408-Lb),wd=Math.max(170,408-bc),ka=!0);this.jqg($a,l,wd,K,Dc);return ka};Hf.prototype.fSe=function(l,K){var ka=document.createElement("div");ka.innerText=K;ka.style.visibility="hidden";l.appendChild(ka);K=ka.clientWidth;
l.removeChild(ka);return K};Hf.prototype.jqg=function(l,K,ka,$a,Lb){K&&(this.Vce(l,K,ka),this.bqg(l));$a&&this.Vce(l,$a,Lb)};Hf.prototype.Vce=function(l,K,ka){var $a=document.createElement("div");$a.innerText=K;$a.title=K;$a.className="SaveToAnotherFolderBreadcrumb";$a.style.maxWidth=ka.toString()+"px";l.appendChild($a)};Hf.prototype.bqg=function(l){var K=document.createElement("span");K.id="FolderSeparator";var ka=document.createElementNS("http://www.w3.org/2000/svg","svg");ka.setAttribute("class",
"SeparatorCaret");var $a=document.createElementNS("http://www.w3.org/2000/svg","polygon");$a.setAttribute("points","1 4 1 11 5 7.5");ka.appendChild($a);K.appendChild(ka);l.appendChild(K)};Hf.prototype.Xce=function(l,K,ka){ka=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ka);K&&(K.innerText=ka);l.tabIndex=0;l.setAttribute(jh.a.Wd,jh.a.Gq)};Hf.prototype.Sng=function(l){var K=document.createElement("span");K.id="anotherFolderText";K.innerText=this.KFg;K.className="AnotherFolderTextSpan";
l.appendChild(K)};Hf.prototype.Nog=function(l){var K=document.createElement("span");K.className="cui-img-cont-float cui-img-16by16 ";this.Doa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Doa.setAttribute("class","FolderIconSVG");var ka=document.createElementNS("http://www.w3.org/2000/svg","path");ka.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Doa.appendChild(ka);K.appendChild(this.Doa);
l.appendChild(K)};Hf.prototype.Hrf=function(l){!l||l.keyCode!==fh.a.Vh&&l.keyCode!==fh.a.p0||this.qud(l)};Hf.prototype.qud=function(){if(this.lI){var l=Lf.a.I$(Wd.AFrameworkApplication.fileName),K=this.lI.value;this.hide();K&&""!==K&&""!==l||1===this.za.state?(""!==l&&(K+=l),this.g5b(K)?this.ds.create().displayError(1,K,!1):this.uib.start(K,this.Tgg)):this.ds.create().displayError(2,K,!1)}};Hf.prototype.rJg=function(l){this.ly&&this.Doa&&(l?(this.ly.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.ly,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Doa,"DisabledFolderIconSVG")):(this.ly.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.ly,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Doa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.ly,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Doa,"DisabledFolderIconSVG"))))};Hf.prototype.Ybd=function(){qe.prototype.Ybd.call(this);this.rJg(!!this.lI&&""!==this.lI.value)};Hf.prototype.dispose=function(){this.ly&&
(Aa.a.removeHandler(this.ly,ef.a.click,Object(fd.a)(this,this.qud,"onSaveToAnotherLocationClick")),Aa.a.removeHandler(this.ly,ef.a.Rb,Object(fd.a)(this,this.Hrf,"onSaveToAnotherLocationKeyDown")),this.ly=null);qe.prototype.dispose.call(this)};Object(fe.a)(Hf,"FileNameDialog",qe,[350]);var oh=b(797),Ph=b(786),Zg=b(210),ig=b(1027);Object(fe.a)(hf,"SaveAsDialogInput",null,[]);Object(fe.a)(Id,"SaveLocation",null,[]);var Sh=b(176);ed.prototype.axh=function(){var l=new oh.a(Ph.a.Dl());l.ja("type","currentHost");
return Object.assign(new Id,{folderName:this.sv.breadcrumbFolderName,friendlyPath:this.sv.breadcrumbBrandName,properties:l})};ed.prototype.d6h=function(l){return!!l&&"ClassicMru"===l.type&&!!l.service_info&&!!l.service_info.service_id&&-1!==l.service_info.service_id.indexOf("SHAREPOINT")};ed.prototype.LHh=function(){if(!this.FGc||!this.EDa)return null;var l=this.FGc.value.Ky("SaveAsToSharePointDialog",!1);if(!l||3!==l.state||!l.zgf)return null;l=l.zgf;for(var K=new Zg.a,ka=0,$a=0,Lb=0;Lb<l.length;Lb++){var bc=
l[Lb];if(this.d6h(bc)&&(ka++,bc.sharepoint_info)){var Dc=bc.url,wd=bc.sharepoint_info.site_url,ke=bc.title;bc=ig.b(bc,Wd.AFrameworkApplication.isRtl);if(Dc&&wd&&ke&&bc){$a++;var jf=new oh.a(Ph.a.Dl());jf.ja("type","SharePoint");jf.ja("siteUrl",wd);jf.ja("folderUrl",Dc);$a++;K.add(Object.assign(new Id,{folderName:ke,friendlyPath:bc,properties:jf}))}}}Lb=new Map;Lb.set("NumPlaces",l.length.toString());Lb.set("NumSharepointPlaces",ka.toString());Lb.set("placesWithMetadata",$a.toString());mh.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",
0,"smartfio",Lb);0<ka&&($a?.5>1*$a/ka&&mh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):mh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return K};ed.prototype.Sxh=function(){var l=new Zg.a;l.add(this.axh());var K=this.LHh();K&&l.addRange(K);return Object.assign(new hf,{enableMoreLocations:!Wd.AFrameworkApplication.ha.ta("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.Fz,extension:Lf.a.I$(this.sv.zn),
saveLocations:l.toArray(),scenario:"SaveToSharePoint"})};ed.prototype.Pxh=function(){return{inputPropsCallback:Object(fd.a)(this,this.Sxh,"getDialogInput")}};ed.prototype.rP=function(l){this.Fz=l;this.Fz||(this.Fz=String.format(CommonUIStrings.l_SaveACopy_Filename,Lf.a.Pq(this.sv.zn)));l={};l=(l.id="SaveAsDialog",l.bodyControls=this.Pxh(),l);var K=CommonUIStrings.L_SaveAs;2===this.Me.Za.Xk&&(K=CommonUIStrings.L_SaveACopy);var ka=new Ag.a(!1,!1,!0);ka.lc=1;ka.We="SaveAsDialog";ka.Dc(1,CommonUIStrings.l_SaveButtonLabel);
ka.initializeAndShow(K,Object(fd.a)(this,this.O0i,"saveAsDialogHandler"),l)};ed.prototype.Fgj=function(l,K){l&&""!==l&&""!==K||1===this.Me.state?this.c6h()?this.bbi(l,K):(""!==K&&(l+=K),this.uib.start(l,this.yh)):(qd.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.ds.create().displayError(2,l,!1))};ed.prototype.bbi=function(l,K){var ka=this;mh.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);this.gVa.L7b(this.gVa.$Yc(CommonUIStrings.l_PickerSaveACopyOkButton,
CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2)).then(function($a){if($a&&0<$a.length){var Lb=$a[0][Mg.a.pFi];$a=$a[0][Mg.a.owd];if(""!==Lb&&""!==$a)ka.EDa.Ema($a,l+K,Lb,ka.yh),mh.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{ka.ds.create().displayError(0,l,!1);var bc=ka.xs();bc&&(bc.set("SiteUrlAvailable",""===Lb?"false":"true"),bc.set("FolderUrlAvailable",""===$a?"false":"true"));mh.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",
!1,!1,Object.assign(new Sh.a,{extendedProperties:bc}))}}else ka.ds.create().displayError(0,l,!1),mh.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function($a){"Canceled"===$a?(($a=ka.xs())&&$a.set("IsCanceled","true"),mh.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Sh.a,{extendedProperties:$a}))):mh.Health.instance.recordKpiFailure("SaveACopySFP",$a,!1,!1,null)})};ed.prototype.c6h=function(){return this.gVa?this.gVa.Wjd()&&Wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1):(qd.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};ed.prototype.xs=function(){try{return new Map}catch(l){return null}};ed.prototype.O0i=function(l,K){if(K&&1===l){l=K.fileName;var ka=Lf.a.I$(this.sv.zn);K.moreLocationsSelected&&this.Fgj(l,ka);if(K.locationCallback){var $a=K.locationCallback();$a?$a.properties&&"currentHost"===$a.properties.oa("type")?this.Afa.Ema(l+ka,!1,this.yh):$a.properties&&"SharePoint"===$a.properties.oa("type")?(K=$a.properties.oa("siteUrl"),
$a=$a.properties.oa("folderUrl"),this.EDa.Ema($a,l+ka,K,this.yh)):qd.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):qd.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else qd.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(fe.a)(ed,"ReactSaveAsDialog",null,[350]);Hc.prototype.create=function(l){return this.Me&&this.Me.Za.Ju?new ed(this.y8d,this.ds,this.Afa,Wd.AFrameworkApplication.zl,this.Me,this.ufg,this.EDa,this.gVa,l):new Hf(this.yb,
this.Oa,this.Me,this.VW,this.ds,this.Afa,this.y8d,l)};Object(fe.a)(Hc,"FileNameDialogFactory",null,[336]);Sb.prototype.start=function(l){var K=this;if(!this.puf)if(Wd.AFrameworkApplication.breadcrumbFolderUrl&&Wd.AFrameworkApplication.breadcrumbFolderUrl.length)this.shb=Wd.AFrameworkApplication.breadcrumbFolderUrl;else return qd.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.zo),!1;var ka=this.ohg();ka.$gj();var $a=ka.EEh();if(!$a)return qd.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.nfb.start(function(Lb,bc){ka.hide();l(Lb,bc)},function(){K.zsd(ka)},$a,this.shb);return!0};Sb.prototype.zsd=function(l){l.hide();qd.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Sb.prototype.ZDh=function(l){l=l.toLowerCase();l.endsWith("/")||(l+="/");var K=l.indexOf("/documents/");return-1!==K?l.substring(0,
K+1)+"_layouts/15/onedrive.aspx":""};Sb.prototype.Dsb=function(l){this.zo||3!==l.state||(this.zo=l)};Jl.Object.defineProperties(Sb.prototype,{puf:{configurable:!0,enumerable:!0,get:function(){this.shb||(this.ZBa.value.Ky("Save As",!0),this.zo&&this.zo.G5&&this.zo.G5.length&&(this.shb=this.ZDh(this.zo.G5)));return this.shb}}});Object(fe.a)(Sb,"OneDriveFilePickerHelper",null,[334]);var Ch=Ag.a;Cm(gg,Ch);gg.prototype.$gj=function(){this.pBc="FilePickerDialog";this.Mf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.We="PickerDialog-MsoSp";this.showDialog("",null)};gg.prototype.EEh=function(){return document.getElementById("FilePickerDiv")};gg.prototype.CN=function(){};gg.prototype.MNa=function(){};Object(fe.a)(gg,"PickerDialog",Ag.a,[333]);var mf=b(957),Sd=b(24);Pf.prototype.Rg=function(){var l=this,K=this.nfb.i1a();K?Sd.a.sA||this.yb.ta("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Oa.Jf(Cf.a.saveToSharePoint,Bh.a.frame,Object(fd.a)(this,this.GKf,"saveToSharePointActionDispatcher"),64):(K.o5a.continueWith(function(ka){ka.ng&&
l.nfb.Gtd(ka)}),this.uYb()):qd.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};Pf.prototype.uYb=function(){Ng.a.BAd(Object(fd.a)(this,this.GKf,"saveToSharePointActionDispatcher"));Ng.a.A2c([new mf.a(Cf.a.saveToSharePoint,Bh.a.frame,0)],this.nfb.i1a())};Pf.prototype.GKf=function(l,K,ka,$a,Lb){return K.contextId!==Bh.a.frame||l!==Cf.a.saveToSharePoint?2:this.G4a&&(this.rIc.puf||this.Kne)?1===ka?ub.SessionStatusManager.instance.Ftb||Wd.AFrameworkApplication.NU?
8:this.L$f()?32:8:2===ka?(qd.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Lb&&Lb.SaveEntryPoint&&"VersionHistory"===Lb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Kne?(qd.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.zCc.create(Lb).rP(null)):(qd.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.uib.start(null,Lb)),32):8:8};Jl.Object.defineProperties(Pf.prototype,
{G4a:{configurable:!0,enumerable:!0,get:function(){return this.yb.ta("SaveToAnotherFolderBrsIsEnabled")}},Kne:{configurable:!0,enumerable:!0,get:function(){return this.yb.ta("UserCanWriteRelative")}}});Object(fe.a)(Pf,"SaveToSharePointActor",null,[]);Dg.prototype.start=function(l,K){var ka=this;qd.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.y4d=l;this.yh=K;this.rIc.start(function($a,Lb){ka.AJi($a,Lb)})||this.xKd()};Dg.prototype.AJi=function(l,K){if(l)this.onSuccess(K);else this.n5(K)};
Dg.prototype.xKd=function(){1!==this.Me.state&&this.ds().d1c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};Dg.prototype.onSuccess=function(l){qd.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(l&&l.data&&l.data.value&&l.data.value.length&&l.data.value[0].sharePoint){var K=l.data.value[0].sharePoint.url;l=l.data.value[0].sharePoint.listUrl;var ka=null;if(K&&(ka=l?this.bIh(l):this.aIh(K))){this.EDa.Ema(K,
this.y4d,ka,this.yh);return}qd.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!K,!ka)}qd.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.xKd()};Dg.prototype.aIh=function(l){l.endsWith("/")||(l+="/");for(var K=0,ka=0;ka<l.length;ka++)if("/"===l.charAt(ka)&&5===++K)return l.substr(0,ka);return null};Dg.prototype.bIh=function(l){l.endsWith("/")&&(l=l.substring(0,l.length-1));var K=l.lastIndexOf("/");
return-1!==K?l.substring(0,K):null};Dg.prototype.n5=function(l){qd.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");l&&l.error?qd.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",l.error.errorCode,l.error.message):qd.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.xKd()};Object(fe.a)(Dg,"SaveToSharePointManager",null,[329]);vf.prototype.execute=function(l,K){if(!Wd.AFrameworkApplication.Ng&&Wd.AFrameworkApplication.Md){var ka=
this.LDa+this.wea;ka=xd.a.Mk(ka,"fu",Lf.a.rf(this.O7));ka=xd.a.Mk(ka,"su",Lf.a.rf(this.$jg));ka=xd.a.Mk(ka,"fn",Lf.a.rf(this.Fz));ka=xd.a.Mk(ka,"n",Lf.a.rf((new Date).getTime().toString()));this.yh&&this.yh.FileDownloadUrl&&(ka=xd.a.Mk(ka,"furl",Lf.a.rf(this.yh.FileDownloadUrl)));ka=ka+"&"+this.xJc;this.vTa&&this.vTa.length?ka=xd.a.Mk(ka,"fnn",Lf.a.rf(this.vTa)):qd.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");qd.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
Wd.AFrameworkApplication.Md.Wl(ka,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,l,K,null,void 0,void 0,void 0,void 0,"9")}};Object(fe.a)(vf,"SharePointSaveAsCaller",null,[343]);If.prototype.create=function(l,K,ka,$a){return new vf(this.MDa,this.Fz,l,K,ka,Wd.AFrameworkApplication.hj,this.wea,$a)};Object(fe.a)(If,"SharePointUploadCallerFactory",null,[328]);var Gf=b(789);bf.prototype.Ema=function(l,K,ka,$a){this.Wyc=!1;qd.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.iIb();this.O7=l;$a&&$a.SaveEntryPoint&&(this.xKc=$a.SaveEntryPoint);this.dBa=this.QMc.create(l,K,ka,$a);$a&&"true"===$a.SkipSaveToHost?this.AP():this.Hoh()};bf.prototype.Hoh=function(){function l(){qd.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");K.AP()}var K=this;32!==this.Oa.Pe(Cf.a.POa,2,[function(){qd.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");K.AP()},l])&&l()};bf.prototype.AP=function(){qd.ULS.sendTraceTag(23881924,
216,50,"Send SharePointSaveAsHandler.ashx request.");this.dBa.execute(Object(fd.a)(this,this.xyi,"onSaveToSharePointUploadFinished"),Object(fd.a)(this,this.wyi,"onSaveToSharePointUploadFailed"))};bf.prototype.xyi=function(l){if(l&&l.data&&l.data.pe){var K=Rb.d(l.data.pe);var ka=K.xu;if(K.returnValue)if(ka.StatusCode!==Cc.a.bO&&ka.StatusCode!==Cc.a.Bob)qd.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",l.data.status,ka.StatusCode),ka.StatusCode!==
Cc.a.KHf&&this.oAe(l.data.status)||(this.rca(ka.StatusCode.toString()),this.Hfj(ka.StatusCode));else{qd.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.gDd();try{ka.NewDocumentUrl?this.XNa(ka.NewDocumentUrl):this.YNa()}catch($a){qd.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",$a.toString())}}else ka={},qd.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(ka.ResponseData=Bc.a.Ibb(l.data.pe),ka)),this.O2b()||(this.rca("Failed to deserialize response"),
this.gIb())}else qd.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.O2b()||(this.rca("Unknown"),this.gIb())};bf.prototype.wyi=function(l){l&&l.data?this.oAe(l.data.status)||(qd.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.rca(Gf.a[l.data.status]),this.gIb()):(qd.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.O2b()||(this.rca("Unknown"),this.gIb()))};bf.prototype.O2b=function(){if(!this.Wyc)return qd.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.Wyc=!0,this.AP(),!0;qd.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};bf.prototype.oAe=function(l){qd.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",l);return this.O2b()};bf.prototype.YNa=function(){qd.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Hg.a.wf(this.O7,Hg.a.JW(3),void 0,"UploadToSharePointManager.RedirectToFolder")};bf.prototype.XNa=function(l){var K=!1,ka=!1;Wd.AFrameworkApplication.ha&&
(K=Wd.AFrameworkApplication.ha.ta("SaveACopyIsEnabledForUiHost"),ka=Wd.AFrameworkApplication.ha.ta("UiHostSupportsDocRebootFeatures"));qd.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",l,K);if(K&&ka){qd.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var $a={};$a[Mg.a.TNa]="1";$a[Mg.a.documentUrl]=l;$a[Mg.a.reason]=Gh.a.saveAs;Wd.AFrameworkApplication.$Y().execute(function(Lb){Lb.Yj(Eh.a.tsa,
$a)})}else Hg.a.wf(l,Hg.a.JW(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};bf.prototype.iIb=function(){this.Me&&1===this.Me.state||(this.Am=this.Rhb(),this.Am.message=CommonUIStrings.l_CommentProgressTooltip,this.Am.lc=5,this.Am.Fu=!1,this.Am.iza(CommonUIStrings.l_DefaultDialogTitle,null,null))};bf.prototype.OGa=function(){this.Am&&(this.Am.close(),this.Am=null)};bf.prototype.gIb=function(){this.ki(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};bf.prototype.Jgj=
function(){this.ki(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};bf.prototype.Mfj=function(){var l=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.ki(CommonUIStrings.l_SaveAsFileTooLargeTitle,l,Ff.a.P0i)};bf.prototype.ki=function(l,K,ka){ka=void 0===ka?Ff.a.T0i:ka;qd.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",l,K);this.OGa();1!==this.Me.state&&this.ds().Oze(l,K,ka)};bf.prototype.Hfj=function(l){qd.ULS.sendTraceTag(25180166,
216,50,"Upload fail with status code: {0}.",l);switch(l){case Cc.a.J0f:this.Jgj();break;case Cc.a.KHf:this.Mfj();break;default:this.gIb()}};bf.prototype.gDd=function(){"VersionHistory"===this.xKc&&this.Oa.processAction(Cf.a.Snc,2)};bf.prototype.rca=function(l){if("VersionHistory"===this.xKc){var K={};this.Oa.Pe(Cf.a.hDd,2,(K.FailureReason=l,K))}};Object(fe.a)(bf,"UploadToSharePointManager",null,[327]);Uf.prototype.init=function(){};Uf.prototype.dispose=function(){};Uf.prototype.$h=function(l){var K=
this;this.pb=l;this.EQb=Ee.a.uq(l.yc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.GQb=Ee.a.uq(l.yc("Common.IEventEmitter<Common.IMruResult>"));Wd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)?(this.mfa=Ee.a.uq(l.yc("Common.App.SharedFilePicker.ISharedFilePicker")),we.Task.WAA.call(null,this.EQb,this.GQb,this.mfa).continueWith(function(){K.gDf()})):(this.mfa=null,we.Task.WAA.call(null,this.EQb,this.GQb).continueWith(function(){K.gDf()}))};
Uf.prototype.gDf=function(){var l=this;this.pb.register(If,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Lc(function(){return new If(Wd.AFrameworkApplication.ha)}).Ac();this.pb.register(bf,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Lc(function(){return new bf(Wd.AFrameworkApplication.Hb,l.pb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),
function(){return(new oe.a).create()},function(){return new uf},Wd.AFrameworkApplication.za)}).Ac();this.pb.register(Dg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Lc(function(){return new Dg(l.pb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),function(){return new uf},l.pb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),Wd.AFrameworkApplication.za)}).Ac();this.pb.register(Sb,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Lc(function(){return new Sb(l.pb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
new Wg.a(function(){return l.EQb.result}),Wd.AFrameworkApplication.za,function(){return new gg})}).Ac();this.pb.register(Hc,"Common.App.SaveToSharePoint.FileNameDialogFactory").Lc(function(){return new Hc(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.za,Wd.AFrameworkApplication.za.Za,l.pb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.pb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),l.pb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Wg.a(function(){return l.GQb.result}),l.pb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),l.mfa?l.mfa.result:null)}).Ac();this.pb.register(Pf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Lc(function(){return new Pf(Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.Hb,l.pb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),l.pb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),l.pb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
l.pb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return Wd.AFrameworkApplication.za.JHg})}).Ac();Wd.AFrameworkApplication.ha.ta("SaveToAnotherFolderBrsIsEnabled")&&this.pb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Rg()};Uf.main=function(){ch.a.instance.oj(new Uf)};Jl.Object.defineProperties(Uf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(fe.a)(Uf,"PackageManager",null,[8,9]);var Wf=Be.StandardDialog;
Cm(df,Wf);df.prototype.displayError=function(l){this.kz(l,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(fe.a)(df,"ErrorDialog",Be.StandardDialog,[426]);dh.default=0;Object(fe.a)(dh,"SaveToCloudErrorCodes",null,[]);cf.prototype.start=function(l){this.yh=l;if("SharePointOnlineConsumer"===this.yb.Wa("FileSource")){var K=Dd.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(K){K.start(null,l);return}}this.g1.hKa?(qd.ULS.sendTraceTag(6590559,
216,50,"User is signed in. We will show file picker."),this.fHg()):(qd.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};cf.prototype.showSignInDialog=function(){this.Tjg.create().rP()};cf.prototype.ki=function(){this.ds().displayError(dh.default)};cf.prototype.fHg=function(){try{qd.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var l={},K=(l.client_id=this.yb.appSettings.UploadToSkyDriveClientId,l.env="INT",l);if(1===this.NMb||
2===this.NMb)l={},K=(l.client_id=this.yb.appSettings.UploadToSkyDriveClientId,l);l={};var ka=(l.mode="save",l.lightbox="grey",l);WL.init(K);qd.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(ka).then(Object(fd.a)(this,this.onSuccess,"onSuccess"),Object(fd.a)(this,this.n5,"onFailure"))}catch($a){qd.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",$a,$a.stack),this.ki()}};cf.prototype.onSuccess=function(l){qd.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");l&&l.data&&l.data.folders&&this.njb.Ema(l.data.folders[0].id,l.data.folders[0].urls.viewInBrowser,null,this.yh)};cf.prototype.n5=function(l){if(l&&l.error){if("user_canceled"===l.error.code){qd.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}qd.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",l.error.code,l.error.message)}else qd.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.ki()};Object(fe.a)(cf,"SaveToCloudManager",null,[427]);Se.prototype.G4a=function(){return this.yb.ta("SaveToCloudStorageUIIsEnabled")};Se.prototype.vNe=function(){return Cf.a.saveToCloudStorage};Se.prototype.uYb=function(){Ng.a.BAd(Object(fd.a)(this,this.EKf,"saveToCloudActionDispatcher"));Ng.a.A2c([new mf.a(Cf.a.saveToCloudStorage,Bh.a.frame,0)],this.x5d.i1a())};Se.prototype.Rg=function(){var l=this,K=this.x5d.i1a();K?(K.NX(function(){l.Z2d.setResult(!0)}),
this.uYb()):qd.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Se.prototype.sCf=function(){qd.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};Se.prototype.EKf=function(l,K,ka,$a,Lb){var bc=this;return K.contextId!==Bh.a.frame||l!==this.vNe()?2:this.G4a()?1===ka?ub.SessionStatusManager.instance.Ftb||Wd.AFrameworkApplication.NU?8:32:2===ka?(this.sCf(),Lb&&Lb.FileDownloadUrl&&qd.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.rh&&(this.cSb=this.rh.Ic("DialogShown","SaveToOneDriveReponseTime")),this.Z2d.task.continueWith(function(){bc.cSb&&(bc.cSb.stop(),bc.cSb=null);bc.Tig.start(Lb)}),32):8:8};Object(fe.a)(Se,"SaveToCloudStorageActor",null,[424]);var f=b(277),rb=Be.StandardDialog;Cm(xf,rb);xf.prototype.rP=function(){this.g1.gWa(Object(fd.a)(this,this.Fsf,"onSignIn"));this.Hl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(fd.a)(this,this.cXh,"inputHandler"))};xf.prototype.cXh=
function(l){l?this.E5():(qd.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())};xf.prototype.MJg=function(){var l="2";if(this.VW)switch(this.VW.Xk){case 3:l="0";break;case 2:l="3";break;case 1:l="1"}return l};xf.prototype.hide=function(){this.g1.pEb(Object(fd.a)(this,this.Fsf,"onSignIn"));rb.prototype.hide.call(this)};xf.prototype.E5=function(){var l=new f.QueryStringBuilder("Signin.aspx");l.Ym("prompt","1");l.Ym("cbcxt",this.MJg());Wd.AFrameworkApplication.Zjb(l);Hg.a.wf(l.toString(),
"LoginWindow",void 0,"SignInDialog")};xf.prototype.Fsf=function(){this.Ht&&this.hide();qd.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Oa.processAction(Cf.a.saveToCloudStorage,2)};Object(fe.a)(xf,"SignInDialog",Be.StandardDialog,[438]);ee.prototype.create=function(){return new xf(this.Oa,this.g1,this.VW)};Object(fe.a)(ee,"SignInDialogFactory",null,[422]);Pd.prototype.execute=function(l,K){if(!Wd.AFrameworkApplication.Ng&&Wd.AFrameworkApplication.Md){var ka=
this.LDa+this.wea;ka=xd.a.Mk(ka,"fo",Lf.a.rf(this.VOb));ka=xd.a.Mk(ka,"fn",Lf.a.rf(this.Fz));ka=xd.a.Mk(ka,"qs",Lf.a.rf(this.xJc));ka=xd.a.Mk(ka,"n",Lf.a.rf((new Date).getTime().toString()));this.yh&&this.yh.FileDownloadUrl&&(ka=xd.a.Mk(ka,"furl",Lf.a.rf(this.yh.FileDownloadUrl)));this.vTa&&(ka=xd.a.Mk(ka,"fnn",Lf.a.rf(this.vTa)));Wd.AFrameworkApplication.Md.Wl(ka,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,l,K,null)}};Object(fe.a)(Pd,"SkyDriveUploadCaller",null,[352]);Md.prototype.create=
function(l,K,ka){return new Pd(this.MDa,this.Fz,K,l,Wd.AFrameworkApplication.hj,this.wea,ka)};Object(fe.a)(Md,"SkydriveUploadCallerFactory",null,[338]);qc.prototype.iIb=function(){this.Me&&1===this.Me.state||(this.Am=this.Rhb(),this.Am.message=CommonUIStrings.l_CommentProgressTooltip,this.Am.lc=5,this.Am.Fu=!1,this.Am.iza(CommonUIStrings.l_DefaultDialogTitle,null,null))};qc.prototype.OGa=function(){this.Am&&(this.Am.close(),this.Am=null)};qc.prototype.oR=function(){1!==Wd.AFrameworkApplication.za.state&&
this.ds().displayError(dh.default)};qc.prototype.YNa=function(){qd.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Hg.a.wf(this.O7,Hg.a.JW(3),void 0,"UploadToCloudManager.RedirectToFolder")};qc.prototype.XNa=function(l){var K=!1,ka=!1;Wd.AFrameworkApplication.ha&&(K=Wd.AFrameworkApplication.ha.ta("SaveACopyIsEnabledForUiHost"),ka=Wd.AFrameworkApplication.ha.ta("UiHostSupportsDocRebootFeatures"));qd.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
l,K);if(K&&ka){qd.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var $a={};$a[Mg.a.TNa]="1";$a[Mg.a.documentUrl]=l;Wd.AFrameworkApplication.$Y().execute(function(Lb){Lb.Yj(Eh.a.tsa,$a)})}else Hg.a.wf(l,Hg.a.JW(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};qc.prototype.Ema=function(l,K,ka,$a){ka=void 0===ka?null:ka;$a=void 0===$a?null:$a;qd.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.rh&&(this.zfa=this.rh.Ic("DialogShown",
"SaveToOneDriveUploadTime"));this.iIb();this.O7=K;this.dBa=this.QMc.create(l,ka,$a);this.yh=$a;this.AP()};qc.prototype.AP=function(){qd.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.dBa.execute(Object(fd.a)(this,this.vyi,"onSaveToCloudUploadFinished"),Object(fd.a)(this,this.uyi,"onSaveToCloudUploadFailed"))};qc.prototype.vyi=function(l){this.OGa();this.OBa=!1;if(l&&l.data&&l.data.pe){var K=Rb.d(l.data.pe);var ka=K.xu;if(K.returnValue)if(ka.StatusCode!==Cc.a.bO&&ka.StatusCode!==
Cc.a.Bob)qd.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.oR();else{qd.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{ka.NewDocumentUrl&&""!==ka.NewDocumentUrl?this.XNa(ka.NewDocumentUrl):this.YNa()}catch($a){qd.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",$a.toString())}this.wCb()}else ka={},qd.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(ka.ResponseData=Bc.a.Ibb(l.data.pe),
ka)),this.oR()}else qd.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.oR()};qc.prototype.uyi=function(l){5!==l.data.status&&12!==l.data.status||this.OBa?(qd.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",l.data.status),this.OGa(),this.oR(),this.wCb()):(qd.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.OBa=!0,this.AP())};qc.prototype.wCb=function(){this.zfa&&(this.zfa.stop(),this.zfa=
null)};Object(fe.a)(qc,"UploadToCloudManager",null,[326]);pc.prototype.init=function(){Wd.AFrameworkApplication.ha.ta("SaveToCloudStorageUIIsEnabled")&&this.pb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Rg()};pc.prototype.dispose=function(){};pc.prototype.$h=function(l){this.pb=l;this.pb.register(ee,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Lc(function(){return new ee(Wd.AFrameworkApplication.Hb,vg.a.instance,
Wd.AFrameworkApplication.za.Za)}).Ac();this.pb.register(Md,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Lc(function(){return new Md(Wd.AFrameworkApplication.ha)}).Ac();this.pb.register(Se,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Lc(function(){return new Se(l.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),l.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Wd.AFrameworkApplication.ha,
Wd.AFrameworkApplication.za.bB)}).Ac();this.pb.register(qc,"Common.App.SaveToCloudStorage.UploadToCloudManager").Lc(function(){return new qc(l.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new oe.a).create()},function(){return new df},Wd.AFrameworkApplication.za,Wd.AFrameworkApplication.za.bB)}).Ac();this.pb.register(cf,"Common.App.SaveToCloudStorage.SaveToCloudManager").Lc(function(){return new cf(l.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
vg.a.instance,l.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.s_a,function(){return new df})}).Ac()};pc.main=function(){ch.a.instance.oj(new pc)};Jl.Object.defineProperties(pc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(fe.a)(pc,"PackageManager",null,[8,9]);Jl.Object.defineProperties(lb,{Mf:{configurable:!0,enumerable:!0,get:function(){return Ag.a.jj(lb.Oj,CommonUIStrings.l_SaveACopyFileName)}}});
lb.Oj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(fe.a)(lb,"FileNameDialogHtml",null,[]);var oc=Ag.a;Cm(Fa,oc);Fa.prototype.rP=function(l,K,ka){this.VOb=l;this.O7=ka;l={};K=(l.txtFileName=Lf.a.Pq(Wd.AFrameworkApplication.zl.zn),
l.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,K),l);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(fd.a)(this,this.f5b,"fileNameDialogHandler"),K);qd.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};Fa.prototype.f5b=function(l,K){1!==l?qd.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(l=K.txtFileName.trim(),qd.ULS.sendTraceTag(7165651,
216,50,"User click save to upload file with new name."),K=Lf.a.I$(Wd.AFrameworkApplication.fileName),l&&""!==l&&""!==K&&(l+=K),this.njb.Ema(this.VOb,this.O7,l,this.yh))};Object(fe.a)(Fa,"FileNameDialog",Ag.a,[439]);Og.prototype.create=function(l){return new Fa(this.Oa,this.VW,this.njb,l)};Object(fe.a)(Og,"FileNameDialogFactory",null,[428]);var cd=Be.StandardDialog;Cm(lg,cd);lg.prototype.displayError=function(l){qd.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",l);this.kz(l,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_ErrorSavingToOneDrive,Object(fd.a)(this,this.nEd,"retryDialogHandler"))};lg.prototype.nEd=function(l){1===l?(qd.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Oa.processAction(Cf.a.saveACopy,2)):qd.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};Object(fe.a)(lg,"RetryDialog",Be.StandardDialog,[426]);Cm(tf,Se);tf.prototype.G4a=function(){return this.yb.ta("SaveACopyBrsIsEnabled")};tf.prototype.vNe=function(){return Cf.a.saveACopy};tf.prototype.uYb=
function(){Ng.a.BAd(Object(fd.a)(this,this.EKf,"saveToCloudActionDispatcher"));Ng.a.A2c([new mf.a(Cf.a.saveACopy,Bh.a.frame,0)],this.Mgg.i1a())};tf.prototype.sCf=function(){qd.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(fe.a)(tf,"SaveACopyActor",Se,[]);Cm(ve,cf);ve.prototype.onSuccess=function(l){l&&l.data&&l.data.folders?(qd.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.jcg.create(this.yh).rP(l.data.folders[0].id,
l.data.folders[0].name,l.data.folders[0].urls.viewInBrowser)):(qd.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ki())};ve.prototype.n5=function(l){l&&l.error&&"user_canceled"===l.error.code&&qd.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");cf.prototype.n5.call(this,l)};ve.prototype.ki=function(){qd.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");cf.prototype.ki.call(this)};Object(fe.a)(ve,"SaveACopyManager",
cf,[]);Cm(tg,qc);tg.prototype.Hjd=function(){return!!this.yh&&!!this.yh.SaveEntryPoint&&"VersionHistory"===this.yh.SaveEntryPoint.toString()};tg.prototype.oR=function(){qd.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.Hjd()){var l={};this.Oa.Pe(Cf.a.hDd,2,(l.FailureReason="Unknown",l))}qc.prototype.oR.call(this)};tg.prototype.YNa=function(){qd.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Hjd()&&this.Oa.processAction(Cf.a.Snc,2);
qc.prototype.YNa.call(this)};tg.prototype.XNa=function(l){qd.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",l);this.Hjd()&&this.Oa.processAction(Cf.a.Snc,2);qc.prototype.XNa.call(this,l)};tg.prototype.AP=function(){var l=this;this.yh&&"true"===this.yh.SkipSaveToHost?qc.prototype.AP.call(this):32!==this.Oa.processAction(Cf.a.POa,1)?(qd.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),qc.prototype.AP.call(this)):
this.Oa.Pe(Cf.a.POa,2,[function(){qd.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");qc.prototype.AP.call(l)},function(){qd.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");l.oR()}])};Object(fe.a)(tg,"SaveACopyUploadToCloudManager",qc,[]);de.prototype.init=function(){Wd.AFrameworkApplication.ha.Xv(Object(fd.a)(this,this.HA,"onFullAppSettingsReady"))};de.prototype.HA=function(){Wd.AFrameworkApplication.ha.ta("SaveACopyBrsIsEnabled")&&
this.pb.resolve("Common.App.SaveACopy.SaveACopyActor").Rg()};de.prototype.dispose=function(){};de.prototype.$h=function(l){this.pb=l;this.pb.register(tg,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Lc(function(){return new tg(Wd.AFrameworkApplication.Hb,l.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new oe.a).create()},function(){return new lg(Wd.AFrameworkApplication.Hb)},Wd.AFrameworkApplication.za,Wd.AFrameworkApplication.za.bB)}).Ac();this.pb.register(Og,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Lc(function(){return new Og(Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.za.Za,l.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Ac();this.pb.register(tf,"Common.App.SaveACopy.SaveACopyActor").Lc(function(){return new tf(l.resolve("Common.App.SaveACopy.SaveACopyManager"),l.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.za.bB)}).Ac();
this.pb.register(ve,"Common.App.SaveACopy.SaveACopyManager").Lc(function(){return new ve(l.resolve("Common.App.SaveACopy.FileNameDialogFactory"),l.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),vg.a.instance,l.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),Wd.AFrameworkApplication.ha,Wd.AFrameworkApplication.s_a,function(){return new lg(Wd.AFrameworkApplication.Hb)})}).Ac()};de.main=function(){ch.a.instance.oj(new de)};Jl.Object.defineProperties(de.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(fe.a)(de,"PackageManager",null,[8,9]);var $d;(function(l){l[l.myFiles=0]="myFiles";l[l.recent=1]="recent";l[l.currentFolder=2]="currentFolder"})($d||($d={}));Object(fe.b)("SharedFilePickerLandingLocation",$d);Lg.prototype.n_a=function(l){this._initialized||(l.vn(Eh.a.$Bf),l.km(Eh.a.$Bf,Object(fd.a)(this,this.Cxi,"onReceivedPickerResponse")),this._initialized=!0)};Lg.prototype.L7b=function(l){var K=this;return this.FJa=new Promise(function(ka,
$a){var Lb={};Lb[Mg.a.oFi]=l;K.j8a=function(bc,Dc){""===Dc?(qd.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ka(bc)):("Canceled"===Dc?qd.ULS.sendTraceTag(572548164,306,50,Dc):qd.ULS.sendTraceTag(556901065,306,10,Dc),$a(Dc))};K.Gdd.execute(function(bc){K.n_a(bc);bc.Yj(Eh.a.sCi,Lb)})})};Lg.prototype.Cxi=function(l){this.j8a(l.Values[Mg.a.n3i],void 0===l.Values[Mg.a.nwd]||null===l.Values[Mg.a.nwd]?"":l.Values[Mg.a.nwd])};Lg.prototype.Wjd=function(){return Wd.AFrameworkApplication.ha.ta("UiHostCommonFilePicker")};
Lg.prototype.$Yc=function(l,K,ka,$a,Lb,bc,Dc){var wd=void 0===wd?null:wd;var ke={};ke[Mg.a.a3i]=l;ke[Mg.a.titleText]=K;ke[Mg.a.swg]=ka;ke[Mg.a.twg]=$a;ke[Mg.a.uwg]=!1;ke[Mg.a.C3g]=!0;ke[Mg.a.jlh]=Lb;ke[Mg.a.rFi]=bc;ke[Mg.a.qFi]=$d[Dc];wd&&(null!=wd.uQc&&(ke[Mg.a.uQc]=wd.uQc),null!=wd.xed&&(ke[Mg.a.xed]=wd.xed));return ke};Object(fe.a)(Lg,"SharedFilePickerManager",null,[324]);qg.prototype.$h=function(l){this.pb=l;l.register(Lg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Ac().Lc(function(){return new Lg(l.yc("Postmessage.IHostPostmessenger"))})};
qg.prototype.init=function(){var l=this;Wd.AFrameworkApplication.ha.Xv(function(){l.Nub()})};qg.prototype.Nub=function(){this.pb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};qg.prototype.dispose=function(){};qg.main=function(){ch.a.instance.oj(new qg)};Jl.Object.defineProperties(qg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(fe.a)(qg,"SharedFilePickerPackage",null,[8,9]);var ze=b(1252),He=b(958);Tc.prototype.Wce=function(l){var K=
!1;l&&(l.GYc(),l.tFg&&(K=!1));return K};Tc.prototype.FSg=function(){var l=Wd.AFrameworkApplication.za.Za;l=new ze.a(l.Xk,He.a.e9b(),!1,1===l.qMa);this.Wce(l)&&qd.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")};Tc.prototype.H0b=function(l,K,ka,$a,Lb,bc){l=new ze.a(l,ka,$a,K,Lb,bc);this.Wce(l)&&qd.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Tc.prototype.QYg=function(){var l=Wd.AFrameworkApplication.za.Za,K=Wd.AFrameworkApplication.ha,ka=l.Xk,$a=1===l.qMa;if(K.ta(He.a.UKh(ka))){var Lb=
He.a.e9b(),bc=8<Sd.a.A2a;if(2!==ka||2!==Lb||!$a){K=K.ta(He.a.VKh(ka));var Dc=l.gKf(),wd=function(){return l.LB};K&&!He.a.vid(He.a.d8c(ka))&&this.H0b(ka,$a,Lb,bc,wd,Dc)}}};Tc.prototype.init=function(){var l=Wd.AFrameworkApplication.ha,K=l.ta("WildFireChromeExtensionEnabled");l=l.ta("WildFireChromeExtensionBar")&&K;He.a.Yrc&&l&&!He.a.vid(He.a.Kpe)?this.FSg():(document.body&&He.a.lej&&this.QYg(),Wd.AFrameworkApplication.Hb.$b(Cf.a.qmd,Bh.a.frame,Object(fd.a)(this,this.qmd,"launchWildFireBusinessBar")))};
Tc.prototype.qmd=function(l,K,ka,$a,Lb){if(1===ka)return 32;if(!Lb)return 8;this.H0b(Lb.app,Lb.mode,Lb.platform,Lb.useTwoButton,null,null);return 32};Tc.prototype.dispose=function(){};Tc.prototype.$h=function(){};Tc.main=function(){ch.a.instance.oj(new Tc)};Jl.Object.defineProperties(Tc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(fe.a)(Tc,"PackageManager",null,[8,9]);var Ie=b(211),Me=b(1236),rg=Ie.a;Cm(Ud,rg);Ud.prototype.create=function(){this.Jb(this.$.ea.Ea(5,
void 0)||new Me.a(this.$,!this.$.caa))};Ud.la=function(l){l.ea.La(4,new Ud(l))};Object(fe.a)(Ud,"BusinessBarManagerFactory",Ie.a,[]);var pf=b(12),$g;"undefined"==typeof $g&&($g={});window.MSOJS=$g;$g.ldb=function(){function l(){return Dc()&&(Oi()||3<=(Sf()?pj("version/"):0))}function K(){return 0<=window.navigator.userAgent.indexOf("Windows")}function ka(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function $a(){nl||(nl=!0,kl=Lb("Windows Phone"))}function Lb(Mf){Mf=(new RegExp(Mf+
"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var qh=-1;return null!=Mf&&2<=Mf.length&&(qh=parseFloat(Mf[1]),isNaN(qh)&&(qh=-1)),qh}function bc(){return"function"==typeof navigator.msLaunchUri&&!ka()&&!xi()&&!wd()}function Dc(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function wd(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ke(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function jf(){return ke()?
8==window.document.documentMode:!1}function Xf(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Sf(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function xg(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function xi(){var Mf=window.navigator.userAgent.toLowerCase();return 0<=Mf.indexOf("android")&&0<=Mf.indexOf("chrome")}function Oi(){return 3<=(Xf()?pj("firefox/"):0)}function pj(Mf){var qh=window.navigator.userAgent.toLowerCase(),Vh=qh.indexOf(Mf),
Kh,yi;return 0<=Vh?(Kh=Vh+Mf.length,yi=qh.length,parseInt(qh.substring(Kh,yi))):0}function dk(Mf,qh,Vh,Kh,yi){if(Kh&&null!=qh)qh();else if(bc())navigator.msLaunchUri(Mf,qh,Vh);else if(!(xg()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&Dc())||wd())Jj(Mf,qh,Vh);else if(xg()&&yi)a:{try{window.open(Mf,"_self")}catch(Ji){null!=Vh&&Vh();break a}null!=qh&&qh()}else Yi(Mf,qh,Vh)}function Yi(Mf,qh,Vh){var Kh=document.getElementById("OICLinkTag"),
yi;null==Kh&&(Kh=document.createElement("a"),Kh.id="OICLinkTag",Kh.style.visibility="hidden",Kh.href="",Kh.target=0==(Cj.Options&mk.SupportsTopTargetNavigation)||Cj.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Kh),null!=Kh.addEventListener&&Kh.addEventListener("click",function(Ji){null!=Ji.stopPropagation&&Ji.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(yi=function(Ji){var Ki=document.createEvent("MouseEvent");return Ki.initMouseEvent(Ji,!1,!1,window,0,0,0,0,0,!1,
!1,!1,!1,0,null),Ki},yi.prototype=Event.prototype,window.MouseEvent=yi),Kh.href=Mf,Kh.dispatchEvent(new MouseEvent("click"))}catch(Ji){null!=Vh&&Vh();return}null!=qh&&qh()}function Jj(Mf,qh,Vh){var Kh=document.getElementById("OICFrame");null==Kh&&(Kh=document.createElement("iframe"),Kh.className="ObjectInDialog",Kh.style.visibility="hidden",Kh.src="about:blank",document.body.appendChild(Kh),Kh.id="OICFrame");try{Kh.contentWindow.location.href=Mf}catch(yi){null!=Vh&&Vh();return}null!=qh&&qh()}function Gk(Mf){return 0!=
(Mf.Options&mk.SkipProtocolHandler)||jf()}function Hk(Mf){return Mf===Tk.ReadOnly||Mf===Tk.ReadWrite}function Ok(Mf,qh,Vh,Kh){var yi,Ji;try{if(yi=new ActiveXObject(af),yi)return Ji=yi.ViewDocument3(window.self,Mf,qh,Kh),Ji?(lc(Lk.O14ActiveX),Zi.None):Zi.Failed}catch(Ki){}if(mk.O14Only===(Vh&mk.O14Only))return Cj.DescriptiveUnattemptedEnums?Zi.O14AttemptFailure:Zi.Unattempted;try{if(yi=new ActiveXObject(Xe),yi)return Ji=yi.ViewDocument3(window.self,Mf,qh,Kh),Ji?(lc(Lk.O12ActiveX),Zi.None):Zi.Failed}catch(Ki){}if(mk.O12UpOnly===
(Vh&mk.O12UpOnly))return Cj.DescriptiveUnattemptedEnums?Zi.O12UpOnlyFail:Zi.Unattempted;try{if(yi=new ActiveXObject(pg),yi)return Ji=Hk(qh)?yi.ViewDocument2(window.self,Mf,Kh):yi.EditDocument2(window.self,Mf,Kh),Ji?(lc(Lk.O11ActiveX),Zi.None):Zi.Failed}catch(Ki){}return Cj.DescriptiveUnattemptedEnums?Zi.ActiveXUnattempted:Zi.Unattempted}function bl(Mf,qh,Vh,Kh,yi){var Ji,Ki;Mf==kj.Visio&&Vh==Tk.ReadWrite&&(Vh=Tk.WriteOnly);Mf=yi;(Kh=Kh||ka()&&!($a(),8<=kl))||(Ji="",Ji+=Hk(Vh)?Zj+Gj:Wj,Ji+=Hj,Mf+=
cl(Ji));Mf+=cl(qh);qh=window.location.href;Vh=Wk;Kh=qh.toLowerCase().indexOf("&"+Vh+"=");var rk;Vh=-1==Kh?void 0:(Ki=Kh+(Vh.length+2),rk=qh.indexOf("&",Ki),-1==rk)?qh.substr(Ki):qh.substring(Ki,rk);if(null!=Vh&&"undefined"!=typeof Vh){Ki="";try{Ki=decodeURIComponent(Vh)}catch(Dj){}0<Ki.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ki)&&(Mf+=ek,Mf+=Ki)}return Mf}function Uk(Mf,qh,Vh,Kh,yi,Ji){var Ki=la(Mf),rk;return null==Ki?(Lc(Cj.DescriptiveUnattemptedEnums?Zi.ProtocolHandlerIsNull:
Zi.Unattempted,Cj.Application),!1):(rk=bl(Mf,qh,Vh,Kh,Ki),dk(rk,el,fl,yi,Ji),!0)}function cl(Mf){if(Dc()&&xg()){var qh="";try{qh=decodeURI(Mf)}catch(Vh){}if(qh==Mf)return encodeURI(Mf)}return Mf}function el(){lc(Lk.ProtocolHandler)}function fl(){Cj.Options|=mk.SkipProtocolHandler;Fb(Cj,al,Xk)}function gl(){null!=il&&il(Lk.RoamingProtocolHandler)}function hl(){null!=jl&&jl(Zi.ControlNeeded)}function dl(){var Mf=document.getElementById(Oh),qh;if(null==Mf){if(qh=sg,Dc()&&3<=(Sf()?pj("version/"):0)&&
Pk(lh,!0)&&(qh=lh),!Pk(qh,!0))if(Dc()&&Pk(Pi,!0))qh=Pi;else return null;Mf=document.createElement("object");Mf.id=Oh;Mf.type=qh;Mf.style.width="0px";Mf.style.height="0px";Mf.style.setProperty("visibility","hidden","");document.body.appendChild(Mf);Mf=document.getElementById(Oh)}return Mf}function Pk(Mf,qh){var Vh=window.navigator.mimeTypes,Kh;return null==Vh?!1:(Kh=Vh[Mf],Kh)?qh&&!Kh.enabledPlugin?!1:!0:!1}function Vk(Mf){try{if(null!=new ActiveXObject(Mf))return!0}catch(qh){}return!1}function G(Mf){switch(Mf){case kj.OneNote:return Ri;
default:return""}}function la(Mf){if(Mf!=kj.OneNote&&ka()&&!($a(),8<=kl))return"office:";switch(Mf){case kj.Excel:return"ms-excel:";case kj.OneNote:return"onenote:";case kj.PowerPoint:return"ms-powerpoint:";case kj.Visio:return"ms-visio:";case kj.Word:return"ms-word:";case kj.Project:return"ms-project:";case kj.Publisher:return"ms-publisher:";case kj.Infopath:return"ms-infopath:";case kj.Access:return"ms-access:";default:return""}}function Ya(Mf){switch(Mf){case kj.Excel:return"root\\office15\\excel.exe";
case kj.PowerPoint:return"root\\office15\\powerpnt.exe";case kj.Visio:return"root\\office15\\visio.exe";case kj.Word:return"root\\office15\\winword.exe";case kj.Project:return"root\\office15\\winproj.exe";case kj.Publisher:return"root\\office15\\mspub.exe";case kj.Infopath:return"root\\office15\\infopath.exe";case kj.Access:return"root\\office15\\msaccess.exe";default:return null}}function Fb(Mf,qh,Vh){if(Cj=Mf,al=qh,Xk=Vh,Mf.DocumentUrl){var Kh=Vh=qh=Mf.DocumentUrl;try{Kh=decodeURIComponent(Mf.DocumentUrl)}catch(Qk){}try{Vh=
encodeURI(Mf.DocumentUrl)}catch(Qk){}qh=qh+""+Mf.CorrelationIdForWinClient;Kh+=Mf.CorrelationIdForWinClient;Vh+=Mf.CorrelationIdForWinClient;Mf.Mode===Tk.ReadWrite&&mk.CheckoutRequired===(Mf.Options&mk.CheckoutRequired)&&(Mf.Mode=Tk.ForceCheckout);mk.HostIsEditOnly===(Mf.Options&mk.HostIsEditOnly)&&(Mf.Mode=Tk.WriteOnly);if(Gk(Mf)?0:Dc()&&(Mf.Application==kj.OneNote||Pk(Jh,!1)||Pk(th,!1))||bc()||xi()||!(l()||Oi()||"ActiveXObject"in window&&!ka()||xg())||15<=ad())Uk(Mf.Application,Mf.EncodeUrl?Vh:
qh,Mf.Mode,Mf.Application==kj.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen);else{var yi;if(yi=jf())a:{var Ji=Mf.EncodeUrl?qh:Kh,Ki=Mf.Mode,rk=G(Mf.Application);try{yi=(new ActiveXObject(ue)).ViewDocument3(window.self,Ji,Ki,rk);break a}catch(Qk){}yi=!1}if(yi)lc(Lk.O15ActiveX);else{if(l()||Oi()){var Dj=Mf.EncodeUrl?qh:Kh;Kh=Mf.Mode;yi=G(Mf.Application);Ji=dl();if(null==Ji)Dj=Cj.DescriptiveUnattemptedEnums?Zi.PluginIsNull:Zi.Unattempted;else{Ki=!1;try{Ki=Ji.ViewDocument3(window.self,Dj,
Kh,yi)}catch(Qk){}if(!Ki)try{Ki=Hk(Kh)?Ji.ViewDocument2(window.self,Dj,yi):Ji.EditDocument2(window.self,Dj,yi)}catch(Qk){}Dj=Ki?(lc(Lk.NpapiPlugin),Zi.None):Zi.Failed}}else{try{Dj=new ActiveXObject(pi),null!=Dj&&Dj.SaveSSOCreds()}catch(Qk){}Dj=Ok(Mf.EncodeUrl?qh:Kh,Mf.Mode,Mf.Options,G(Mf.Application))}if(Dj!=Zi.None){if(Kh=Mf.CouldUseRoamingApps)ll||(ll=!0,ml=Lb("Windows NT")),Kh=6.1<=ml&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ke()||Oi()||xg());if(Kh&&Mf.Application!=kj.OneNote){if(!$g.ldb.FDj()){Lc(Zi.ControlNeeded,
Cj.Application);return}if(Mf.RoamingAppsLauncher){"undefined"==typeof Mf.RoamingAppsLauncher||null==Mf.RoamingAppsLauncher?Lc(Cj.DescriptiveUnattemptedEnums?Zi.RoamingLauncherIsNull:Zi.Unattempted,Cj.Application):"undefined"==typeof Mf.RoamingBitsUrl||null==Mf.RoamingBitsUrl?$g.ldb.JDj(Mf.DocumentUrl,Mf.RoamingAppsLauncher,Mf.Application,Mf.ApplicationParameters,al,Xk):$g.ldb.Q7f(Mf.DocumentUrl,Mf.RoamingAppsLauncher,Mf.RoamingApplicationExe,Mf.ApplicationParameters,Mf.RoamingPlatform,Mf.RoamingBitsUrl,
al,Xk);return}if(!Mf.ContinueIfLauncherIsNull){Lc(Zi.LauncherNeeded,Cj.Application);return}}mk.NoProtocolHandlerFallback==(Mf.Options&mk.NoProtocolHandlerFallback)||Gk(Mf)||ke()||Dc()&&!(Cj.DescriptiveUnattemptedEnums?Dj>=Zi.O14Unattempted&&Dj<=Zi.DocumentUrlIsNull:Dj==Zi.Unattempted)?Lc(Dj,Cj.Application):Uk(Mf.Application,Mf.EncodeUrl?Vh:qh,Mf.Mode,Mf.Application==kj.OneNote,Mf.SilentExternalHandler,Mf.NavigateUsingWindowOpen)}}}}else Lc(Cj.DescriptiveUnattemptedEnums?Zi.DocumentUrlIsNull:Zi.Unattempted,
Cj.Application)}function lc(Mf){null!=al&&al(Mf)}function Lc(Mf,qh){"undefined"==typeof qh&&(qh=null);null!=Xk&&Xk(Mf,qh)}function ad(){var Mf=0;if(l()||Oi()||xg()){var qh=dl();try{null!=qh&&(Mf=qh.GetOfficeVersion())}catch(Vh){}}else Vk(ue)?Mf=15:Vk(af)?Mf=14:Vk(Xe)?Mf=12:Vk(pg)&&(Mf=11);return Mf}function Kd(){return Dc()&&(Pk(sg,!0)||Pk(lh,!0))}var ue="SharePoint.OpenDocuments.5",af="SharePoint.OpenDocuments.4",Xe="SharePoint.OpenDocuments.3",pg="SharePoint.OpenDocuments.2",sg="application/x-sharepoint",
lh="application/x-sharepoint-webkit",Jh="application/x-sharepoint-protocolhandler",th="application/x-sharepoint-webkit-protocolhandler",Pi="application/officelive",Oh="npSharePointPlugin",pi="IDBHO.IDBHOCtrl",Ri="OneNote.Notebook",Zj="ofv|",Gj="ofc|",Wj="ofe|",Hj="u|",ek="|f|",Wk="wdlor",Sk="",Zk="",$k="",al,Xk,il,jl,Cj,ll,ml,nl,kl,Tk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},mk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,
NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Zi={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Lk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},
kj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Tk,OpenDocumentOptions:mk,OpenDocumentFailureType:Zi,OpenDocumentControl:Lk,OfficeApplication:kj,EditDocumentInClient:Fb,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=kj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=
this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1},OfficeVersionInstalled:ad,IsO14MacPluginInstalled:Kd,OfferOfficeInDialog:function(){return K()&&11>=ad()},OfferOfficeNoIntrusive:function(){return K()&&15>ad()},OfferMacOffice:function(){return Dc()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Kd()},InstallRoamingControl:function(){Xf()?window.InstallTrigger.install({Office:{URL:Zk}}):
Jj($k,null,null)},CanUseRoamingControl:function(){var Mf,qh,Vh;if(bc())return!0;if(xg())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Xf())return Mf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Mf),qh=document.createEvent("Events"),qh.initEvent("RoamingOfficeInstalled",!0,!1),Mf.dispatchEvent(qh),!!Mf.getAttribute("installed");if(ke())try{return Vh=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),
Vh.HrExists()}catch(Kh){}return!1},InitUrls:function(Mf,qh,Vh){Sk=Mf;Zk=Vh;$k=qh},LaunchRoamingApps:function(Mf,qh,Vh,Kh,yi,Ji){$g.ldb.Q7f(Mf,qh,Ya(Vh),Kh,"x86",Sk,yi,Ji)},LaunchRoamingApps2:function(Mf,qh,Vh,Kh,yi,Ji,Ki,rk){var Dj="",Qk;if(null!=Kh&&(Dj+=" "+Kh),null!=Mf&&(Dj+=' "'+Mf+'"'),bc()||xg())il=Ki,jl=rk,Ki='office: "'+(Ji+'" "')+(Vh+'" "ROAMING"'),Ki+=' "'+qh+'"',Ki+=' "'+yi+'"',Ki+=" "+Dj,dk(Ki,gl,hl,!1,!1);else if(Xf())Mf=document.createElement("RoamingExtensionElement"),Mf.setAttribute("cabUrl",
Ji),Mf.setAttribute("app",Vh),Mf.setAttribute("licensingEntitlements",qh),Mf.setAttribute("platform",yi),Mf.setAttribute("args",Dj),document.documentElement.appendChild(Mf),qh=document.createEvent("Events"),qh.initEvent("RoamingOfficeLaunch",!0,!1),Mf.dispatchEvent(qh),null!=Ki&&Ki(Lk.RoamingFFExtension);else if(ke()){if(Qk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Qk)try{Qk.HrConfigureSingle(Ji,Vh,qh,yi,Dj),null!=Ki&&Ki(Lk.RoamingActiveX)}catch(ol){}}else null!=rk&&rk(Zi.Failed)},
ShouldShowDialog:function(){return!ka()},NavigateToUrlUsingClickingOnATag:Yi,OpenDocumentWithProtocolHandler:Uk,OpenDocumentWithProtocolHandlerNoCallBack:function(Mf,qh,Vh,Kh){var yi=la(Mf),Ji;return null==yi?(Lc(Cj.DescriptiveUnattemptedEnums?Zi.ProtocolHandlerNoCallbackIsNull:Zi.Unattempted,Cj.Application),!1):(Ji=bl(Mf,qh,Vh,Kh,yi),dk(Ji,null,null,!1,!1),!0)}}}();$g.ClientUtils=$g.ldb;var Df=b(800),Vf=b(58),og=b(35),h=b(172);Yg.prototype.$c=function(){return!1};Yg.prototype.executeCommand=function(l,
K,ka){return 2!==this.Bi.Pe(Cf.a.newDocument,2,ka)?we.Task.Ua(!0):h.a(K.command)};Yg.prototype.Jc=function(l,K){return 1056925771===K.command};Yg.prototype.gd=function(l,K,ka){l=!0;switch(K){case "PopulateNewMenu":this.Bi&&this.Bi.Pe(Cf.a.Jkc,2,ka);break;default:l=!1}return l};Object(fe.a)(Yg,"CreateNewCommandHandler",null,[159]);var e=Df.a;Cm(eg,e);eg.prototype.Rd=function(){var l=this,K=Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),ka=Vf.GetServiceTaskFactory.create(this.$.ea,
165,this.ma,this.vb,"System.IDisposable");og.TaskExtensions.Da(og.TaskExtensions.Fe([K,ka],this.ma),function(){l.Hd([new Yg(Wd.AFrameworkApplication.Hb)])},this.ma,3)};eg.la=function(l){Df.a.ie(87,new eg(l))};Object(fe.a)(eg,"CreateNewCommandHandlerFactory",Df.a,[]);var I=b(1232),Z=b(861),Ca=b(371),Na=b(187),Vb=b(281),vc=b(4),md=b(149),Ld=b(96),Jd=b(79),je=b(72),qf=b(365),rf=b(160),Zf=b(57),Ef=b(81),sh=b(315),Jg=b(601);ng.prototype.Vje=function(){};ng.prototype.l1c=function(){this.Rgg?Hg.a.downloadFile(this._url):
Hg.a.wf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};ng.prototype.dispose=function(){};Object(fe.a)(ng,"OpenUrlInTabDialogDownloadBehavior",null,[284,7]);var gh=b(275),ah=Be.StandardDialog;Cm(Eg,ah);Eg.prototype.yRc=function(){this.Tl&&(this.CTa||(this.CTa=Object(fd.a)(this,this.zni,"onActionButtonClicked"),this.fy.qa(ef.a.click,this.jB,this.CTa)),this.DTa||(this.DTa=Object(fd.a)(this,this.Ani,"onActionButtonKeyUp"),this.qe.qa(ef.a.fe,this.jB,this.DTa)));ah.prototype.yRc.call(this)};
Eg.prototype.zni=function(l){this.tIe(l);return!0};Eg.prototype.Ani=function(l){return this.i$e(l,Object(fd.a)(this,this.tIe,"executeDismissActionButtonFromArgs"))};Eg.prototype.tIe=function(l){this.Tl&&this.Tl.submit();this.ata(l.Wb)};Eg.prototype.ond=function(){};Eg.prototype.HAe=function(){this.dcf();this.Tl?this.Tl.submit():this.mOb.l1c();return!0};Eg.prototype.Cec=function(){return!1};Eg.prototype.dispose=function(){this.mOb.dispose();this.Seb&&(Wd.AFrameworkApplication.za.vW.Ca(ef.a.click,this.Seb,
Object(fd.a)(this,this.HAe,"downloadLinkClicked")),this.Seb=null);this.mX&&(Wd.AFrameworkApplication.za.vW.Ca(ef.a.click,this.mX,Object(fd.a)(this,this.Cec,"learnMoreLinkClicked")),this.mX=null);this.fy&&this.CTa&&(this.fy.Ca(ef.a.click,this.jB,this.CTa),this.CTa=null);this.qe&&this.DTa&&(this.qe.Ca(ef.a.fe,this.jB,this.DTa),this.DTa=null);ah.prototype.dispose.call(this)};Eg.prototype.oBf=function(){this.Tl&&(document.body.appendChild(this.Tl),this.Tl.submit(),document.body.removeChild(this.Tl))};
Eg.prototype.Mv=function(l){1===l&&(this.ond(),this.Tl?Eg.cy&&this.oBf():this.mOb.l1c());this.dispose()};Jl.Object.defineProperties(Eg.prototype,{f0e:{configurable:!0,enumerable:!0,get:function(){return null}},cOd:{configurable:!0,enumerable:!0,get:function(){return null}},aMa:{configurable:!0,enumerable:!0,get:function(){return null}},Txb:{configurable:!0,enumerable:!0,get:function(){return null}},j5a:{configurable:!0,enumerable:!0,get:function(){return null}},Qff:{configurable:!0,enumerable:!0,
get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},ZZc:{configurable:!0,enumerable:!0,get:function(){return null}},bQc:{configurable:!0,enumerable:!0,get:function(){return null}},pge:{configurable:!0,enumerable:!0,get:function(){return null}}});Jl.Object.defineProperties(Eg,{cy:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.za.Za.Ju&&Wd.AFrameworkApplication.za.Za.v7e}},fub:{configurable:!0,enumerable:!0,
get:function(){return Eg.x_d},set:function(l){Eg.x_d=l}}});Eg.x_d=!1;Object(fe.a)(Eg,"ADialogWithLinkToResource",Be.StandardDialog,[]);var Wh=b(406),zh=b(312),Te=b(16);Cm(hh,Eg);hh.prototype.bcf=function(){qd.ULS.sendTraceTag(7702494,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};hh.prototype.dcf=function(){qd.ULS.sendTraceTag(7702495,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};hh.prototype.Cec=function(){Wh.Redirect.showHelp(zh.a.Umi);
return!0};Jl.Object.defineProperties(hh.prototype,{aMa:{configurable:!0,enumerable:!0,get:function(){return Te.a.instance.Ya(410)}},Jec:{configurable:!0,enumerable:!0,get:function(){return Te.a.instance.Ya(411)}},Iec:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},Txb:{configurable:!0,enumerable:!0,get:function(){return"#"}},j5a:{configurable:!0,enumerable:!0,get:function(){return Te.a.instance.Ya(412)}},Qff:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(fe.a)(hh,
"DownloadACopyAsOdsDialog",Eg,[]);Of.prototype.Vje=function(l){this.dialog=l};Of.prototype.l1c=function(){this.pni.uuf(-1059172980)};Of.prototype.dispose=function(){this.Db.vEb(Object(fd.a)(this,this.Ulf,"onDownloadError"))};Of.prototype.Ulf=function(){this.dialog&&this.dialog.hide()};Object(fe.a)(Of,"DownloadACopyAsOdsDialogDownloadBehavior",null,[284,7]);Object(fe.a)(Kf,"MacroRecorderWorkbookCalculationModeSetPayload",null,[115]);Object(fe.a)(Ug,"MacroRecorderWorkbookRecalculatedPayload",null,[115]);
var Th=b(197),V=b(120),Pa=b(368);Jl.Object.defineProperties(Qf,{fCi:{configurable:!0,enumerable:!0,get:function(){return Qf.eCi}}});Qf.eCi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(fe.a)(Qf,"OpenInAppDialogCopyHtml",null,[]);var Ib=b(366),wc=Pa.a;Cm(Bg,wc);Bg.prototype.openUrl=function(l,K){var ka=document.getElementById("link");ka||(ka=document.createElement("a"),ka.id="link",ka.style.visibility="hidden",ka.href="",document.body.appendChild(ka));ka.target=K;ka.href=l;ka.click()};Bg.prototype.nAb=function(){var l=this;qd.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");Sd.a.Dp?(qd.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),
this.LB&&this.LB.length||qd.ULS.sendTraceTag(574993311,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.LB+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+this.ww+";end","_top")):9<=Sd.a.Udd?(qd.ULS.sendTraceTag(574993310,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.cAb,"_top"),window.setTimeout(function(){l.openUrl(l.ww,"_blank")},9E3)):(qd.ULS.sendTraceTag(574993308,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),
this.openUrl(this.cAb,"_top"),window.setTimeout(function(){l.openUrl(l.ww,"_blank")},500));return!0};Bg.prototype.Jka=function(l){return l.Ga.keyCode===fh.a.Vh||l.Ga.keyCode===fh.a.mna?(qd.ULS.sendTraceTag(574993307,306,50,"KeyPress: Open with redirection timer"),l.Wb.click(),!0):!1};Bg.prototype.Nh=function(){this.Mf=Ag.a.jj(Qf.fCi,Te.a.instance.da(640),Te.a.instance.da(641),Wd.AFrameworkApplication.pC,Ib.getImageClass(Wd.AFrameworkApplication.ha.Wa("AppIcon")),Te.a.instance.da(642));this.We="OpenInAppDialog";
this.lc=5;this.initializeAndShow("",null,null);this.iz(this.jH)};Bg.prototype.Yu=function(l){wc.prototype.Yu.call(this,l);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.jH=document.getElementById("LinkToInstall");Th.a.instance.qa(ef.a.click,this.jH,Object(fd.a)(this,this.nAb,"onClickHandler"));V.KeyInputManager.instance.qa(ef.a.fe,this.jH,Object(fd.a)(this,this.Jka,"onKeyUpHandler"))};Bg.prototype.dispose=function(){this.jH&&(Th.a.instance.Ca(ef.a.click,this.jH,Object(fd.a)(this,
this.nAb,"onClickHandler")),V.KeyInputManager.instance.Ca(ef.a.fe,this.jH,Object(fd.a)(this,this.Jka,"onKeyUpHandler")),this.jH=null);wc.prototype.dispose.call(this)};Jl.Object.defineProperties(Bg.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(fe.a)(Bg,"OpenInAppDialogCopy",Pa.a,[]);var nd=b(26),Bd=b(27),yd=b(1),re=b(348),xe=b(9),Re=b(7),Tf=b(273),ag=b(20),Qg=b(39),Rg=b(243),Hh=b(458),Fg=b(373),Xg=b(50),cg=b(6),Mh=b(134),Nh=b(1107),zd=b(80),li=b(33),
fg=b(354),Si=b(244);kg.prototype.QP=function(l,K){l=Bd.a.Ad(12,1,643,0,0,0,"Blank");l.Description=String.format(Te.a.instance.da(644),K);return l};kg.prototype.D6b=function(l){switch(l){case 1:case 2:return 0;default:return 2}};Object(fe.a)(kg,"ReloadCloseConfirmation",null,[91]);var uj=b(146),$i=b(602),ai=b(64),Q=Na.a;Cm(lf,Q);lf.prototype.$c=function(){return!1};lf.prototype.executeCommand=function(l,K,ka,$a){var Lb=this,bc=this.P2b,Dc=this.$,wd=K.command,ke=this.openInExcelOperation,jf=this.$.Mb,
Xf=ka.SourceControlId;Dc.wk.Vde(wd);l=null;switch(wd){case 1455037301:this.$.q4?ke.nte():ke.mte();break;case -2044628748:case 2004484710:this.$.q4?ke.nte():ke.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Xf?(this.wyb("CellLongPress"),qd.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.wyb("PencilIcon"),qd.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));
this.showOpenInAppDialog();break;case -2028960985:ke.sVf();break;case -1059172980:new hh(ke.pme(wd),new Of(ke,Dc.Db));break;case -1285148982:this.clientWorkflow.ld.activityState[li.a.ZNc]=!0;this.Vuc(!1);break;case -75280711:this.Vuc(!1);break;case -455164169:this.Vuc(!0);break;case -1388494670:this.$.ea.ub(400,function(Yi){Yi.Zfi();Lb.Vuc(!1)});break;case 810888577:Wd.AFrameworkApplication.qk=(new Date).getTime();qd.ULS.sendTraceTag(40749250,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",
Wd.AFrameworkApplication.qk);break;case -1804063550:case -974518828:K=0;vc.a.Yud in ka&&(K=ka[vc.a.Yud]);ke.uuf(wd,K);break;case -1339961039:K=!1;ka&&vc.a.uEd in ka&&(K=ka[vc.a.uEd]);this.reloadWorkbook(!1,K);break;case -8805455:var Sf=this.workbookContext;Dc.isEditMode||(lf.Sqe(Dc),l=og.TaskExtensions.Da(this.rJ.value,function(Yi){Yi=Yi.result;var Jj=Yi.isEnabled();Jj&&Jg.a(Yi,Eh.a.copyAndEdit,Zf.a.Nf.kPe(),Lb.$.fa.gh.get(2))?qd.ULS.sendTraceTag(19482255,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
Jj&&Wd.AFrameworkApplication.Z3f?(Jj={},Jj[I.a.Sxd]=Wd.AFrameworkApplication.userSessionId,Jj[Wd.AFrameworkApplication.tii]=nd.a.Ta.Lb.getTime().toString(),qd.ULS.sendTraceTag(19482256,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Yi.Yj(Eh.a.editMode,Jj)):bc.CopyAndEditUrl?Lb.$Qg():(Lb.mc.supportsEditing||Sf.EditUrl)&&Lb.reloadWorkbookInEditMode()},this.ma,3));break;case -723527778:Dc.isEditMode&&(lf.Sqe(Dc),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var xg=Dc.ra.xa.dc(),xi=-1355155015===wd?1:0,Oi=function(){return new Ug(xi)};l=qf.a(this.$.userOperationManager,function(Yi,Jj,Gk){return Ef.U(Dc.ra.xa,xi,null,Yi,Jj,Gk,null,xg)},function(Yi){return new rf.a(128,0,Yi,void 0,Oi)},K);ag.g(Dc).Vi.fG(!1);break;case -1158102843:l=ag.g(Dc).Vi.recalcSheet(K);ag.g(Dc).Vi.fG(!1);break;case -988468372:if(yd.EwaSettings.ka(310))if($a=parseInt(ka[Jd.a.Vd]),0<=$a&&3>$a)this.setCalculationMode(K,
$a);else return qd.ULS.sendTraceTag(41263680,0,10,"SetCalculationMode , unexpected menuItemId: {0}",ka[Jd.a.Vd]),h.a(wd);break;case 257398710:md.a.ntw(bc.ReportAbuseUrl,Dc);break;case 1800405051:this.V0i();break;case -48469327:this.saveACopy();break;case 214430355:K=!1;ka&&vc.a.U1c in ka&&(K=ka[vc.a.U1c]);if(!this.udj(K,ka))break;Wd.AFrameworkApplication.NU?this.businessBar.tg(40,null):this.businessBar.tg(K?22:23,null);break;case 1389557314:l=og.TaskExtensions.Da(this.rJ.value,function(Yi){Jg.a(Yi.result,
Eh.a.klh,null,Lb.$.fa.gh.get(6))||md.a.ntw(bc.FileVersionUrl,Dc)},this.ma,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Xf===jf+vc.a.$9e?ke.r$h():ke.q$h();break;case 512141517:Xf===jf+vc.a.Z9e?ke.B$h():ke.A$h();break;case -1224038235:var pj=Z.a.On in ka?!ka[Z.a.On]:Ld.j(Dc.fa.workbookContext.Options);ka[Z.a.Description]=pj?Te.a.instance.da(549):Te.a.instance.da(550);l=qf.a(this.$.userOperationManager,function(Yi,Jj,Gk){var Hk=Lb.$.ra.xa,Ok=Hk.Ra(9,null);Ok.isReadOnlyRecommended=
!pj;return Ef.i(Hk,"SetReadOnlyRecommended",Ok,Yi,Jj,Gk,null,0)},function(Yi){return new rf.a(129,0,Yi)},K);break;case 1118926154:if(this.$.isEditMode){var dk=new bg.a;this.$.ea.ub(53,function(Yi){Yi?(Yi.Hn.l$h(Lb.$.Mb+vc.a.ild),dk.setResult(!0)):qd.ULS.sendTraceTag(39661579,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});l=dk.task}break;case -1698025133:ke.openInBrowser();break;case 520859864:l=og.TaskExtensions.Da(Vf.GetServiceTaskFactory.Xa(this.$.ea,393,394,
$a.yia(),"Microsoft.Office.Excel.WebUI.Client.ISaveToHostManager"),function(Yi){Yi.result||qd.ULS.sendTraceTag(588801298,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ma,3);break;default:l=h.a(wd)}return l||we.Task.Ua(!0)};lf.prototype.wyb=function(l){if(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(xe.HelperMethods.qZ){var K=new Map;K.set("EntryPoint",l);mh.Health.instance.recordKpiUsage(Fg.a.dCi,0,Hh.a.bii,K)}else qd.ULS.sendTraceTag(572565280,
0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};lf.prototype.showOpenInAppDialog=function(){Wd.AFrameworkApplication.isMobileMode&&(yd.EwaSettings.ka(702)?(qd.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Bg(this.$)).Nh()):(qd.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),Wd.AFrameworkApplication.showOpenInAppDialog()))};
lf.prototype.udj=function(l,K){var ka=this;return Wd.AFrameworkApplication.isMobileMode&&!je.a(this.$.Ba,30)?(this.showOpenInAppDialog(),qd.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.wyb("CellDoubleTap"),qd.ULS.sendTraceTag(595080800,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):Wd.AFrameworkApplication.ycc&&(l&&re.c(this.workbookContext.WorkbookFileName)||
Re.a.na(this.workbookContext.FullDocumentInfo.HostEditUrl))?(qd.ULS.sendTraceTag(23414109,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",re.d(this.workbookContext.WorkbookFileName)?"xls":"csv",Re.a.na(this.workbookContext.FullDocumentInfo.HostEditUrl)?"":"not "),!1):Ca.a.any([25,26,30,31,55,32],function($a){return ka.businessBar.t3a($a)})?(qd.ULS.sendTraceTag(593081302,0,
50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):K&&vc.a.TJi in K&&!l?!1:!0};lf.prototype.Jc=function(l,K){l=!1;switch(K.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:l=
!0;break;case 520859864:l=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:l=yd.EwaSettings.ka(110);break;case -1388494670:l=yd.EwaSettings.ka(110);break;case 810888577:l=yd.EwaSettings.ka(276);break;case -1224038235:l=this.$.fa.amIAlone;break;case -988468372:l=yd.EwaSettings.ka(310);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:l=!0,qd.ULS.shipAssertTag(572306195,0,this.$.qaa,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return l};lf.prototype.gd=function(){return!1};lf.prototype.V0i=function(){var l=this;if(this.pc){var K=this.$;Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!1,!0);var ka=l.clientWorkflow.ld.activityState;ka[Si.a.kp]=cg.a.Bca;ka[Mh.a.DS]=2;ka[li.a.qr]=K.isEditMode;ka[Mh.a.Gfa]=!1}))}};lf.prototype.saveACopy=function(){var l=this;if(this.pc){var K=this.$;Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!1,!1);
var ka=l.clientWorkflow.ld,$a=ka.activityState;$a[Si.a.kp]=cg.a.eKf;$a[$i.a.PUb]=l.mc.hasUnsupportedFeaturesForEdit;$a[Mh.a.Gfa]=!1;ka.it(Bd.a.n$(l.businessBar.f2c,[-502303485]))}))}};lf.prototype.Vuc=function(l){var K=this;Qg.a(this.$).Nr(new Rg.a(cg.a.Xla,2,function(){K.$.xH(!0,!0);var ka=ai.a(K.$).ld,$a=K.$.isEditMode;$a=Bd.a.Ad(1,1,0,0,0,$a?-315732528:-2087635043,$a?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");$a.ForceVersionUpgrade=l;ka.it([$a]);ka=ai.a(K.$).ld.activityState;ka[Si.a.kp]=
cg.a.Xla;ka[li.a.qr]=K.$.isEditMode;ka[Mh.a.Gfa]=!1}))};lf.prototype.closeWorkbook=function(){var l=this;if(this.pc){var K=this.$;Zf.a.Nf.xrc("2145659238")?og.TaskExtensions.Da(this.rJ.value,function(ka){ka.result.Yj(Eh.a.JJe,{})},this.ma,3):Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!0,!1);var ka=l.clientWorkflow.ld.activityState;ka[Mh.a.GX]=!1;ka[Mh.a.Gfa]=!1;l.mc.inViewerFromWebPart?(sh.a.Dyd(K,l.clientWorkflow.ld),K.wk.Sw("InViewerFromWebPart"),ka[Si.a.kp]=cg.a.lV):(ka[Si.a.kp]=cg.a.Ck,K.Gd&
32?ka[Mh.a.DS]=0:(ka[Mh.a.DS]=1,ka[Mh.a.EUb]=new Nh.a),ka[uj.a.tce]=!0)}))}};lf.prototype.$Qg=function(){var l=this,K=this.mc.vbaRemovedDuringConversion;qd.ULS.sendTraceTag(19674946,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",K);var ka=this.$;K?Qg.a(ka).Nr(new Rg.a(cg.a.xx,5,function(){var $a=Bd.a.Ad(3,0,0,1200,0,1069271157,"XLSMacroFailure");l.clientWorkflow.ld.it([$a]);l.clientWorkflow.ld.activityState[Si.a.kp]=cg.a.ybb})):Wd.AFrameworkApplication.hideHeader?
xe.HelperMethods.wf(this.P2b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):md.a.ntw(this.P2b.CopyAndEditUrl,ka)};lf.prototype.reloadWorkbookInEditMode=function(){var l=this;if(this.pc)if(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Zf.a.Nf.SU&&Zf.a.Nf.qAd(),Wd.AFrameworkApplication.ycc&&!Wd.AFrameworkApplication.Lja)xe.HelperMethods.wf(this.$.emb(!0),Vb.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var K=
this.$,ka=!1,$a=this.mc.hasUnsupportedFeaturesForEdit,Lb=this.workbookContext.FileWasRepaired;re.d(this.workbookContext.WorkbookFileName)?(ka=!0,qd.ULS.sendTraceTag(19482258,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",$a)):re.a(this.workbookContext.WorkbookFileName)&&(ka=!0,qd.ULS.sendTraceTag(19931723,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var bc=K.lg.get(59);bc=!(K.fa.mc.supportsEditing&&
bc);if(ka&&!$a||bc&&(ka||$a)){var Dc=bc?$a?-2066104278:816071846:yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&je.a(this.$.Ba,25)&&!this.$.Gwb?765011943:-213064907;ka=function(){var wd=Bd.a.CXa([Dc]);l.clientWorkflow.ld.it(wd);l.clientWorkflow.ld.activityState[Si.a.kp]=cg.a.ybb}}else ka=function(){K.xH(!0,!1);var wd=l.clientWorkflow.ld,ke=wd.activityState;ke[Mh.a.DS]=1;ke[fg.a.JUb]=Gh.a.sgc;ke[li.a.qr]=!0;ke[$i.a.PUb]=l.mc.hasUnsupportedFeaturesForEdit;ke[Mh.a.Gfa]=
!!l.workbookContext.EditUrl;ke[zd.a.HX]=l.workbookContext.EditUrl;if(!l.P2b.CopyAndEditUrl){var jf=[yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&je.a(l.$.Ba,25)&&!l.$.Gwb?-943219229:1821390342];wd.it(Bd.a.n$(l.businessBar.f2c,jf))}Lb&&!$a?(re.b(l.workbookContext.WorkbookFileName)&&yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(wd=Bd.a.CXa([-425642652]),qd.ULS.sendTraceTag(539301980,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
wd=Bd.a.CXa([108482388]),l.clientWorkflow.ld.it(wd),ke[Si.a.kp]=cg.a.sKf):yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5663121_PasswordToModify")&&l.$.fa.fZe?(qd.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Xg.b().VLd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),ke[Si.a.kp]=cg.a.oCb):yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5708910_EditSharedWorkbooks")&&
l.$.fa.hcc?ke[Si.a.kp]=cg.a.Xxb:ke[Si.a.kp]=cg.a.ybb};Qg.a(K).Nr(new Rg.a(cg.a.xx,5,ka))}};lf.prototype.reloadWorkbookInViewMode=function(){var l=this;if(this.pc){yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&Zf.a.Nf.SU&&Zf.a.Nf.qAd();var K=this.$;Sd.a.hh&&ag.g(K).Hc.textBox.blur();Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!K.fa.isNamedObjectViewMode,!1);var ka=l.clientWorkflow.ld.activityState;ka[Si.a.kp]=cg.a.Oga;ka[Mh.a.DS]=1;ka[Mh.a.GX]=!0;ka[li.a.qr]=
!1;ka[li.a.Sjb]=!0;ka[fg.a.JUb]=Gh.a.sgc}))}};lf.prototype.reloadWorkbook=function(l,K){var ka=this;if(this.pc){var $a=this.$;$a.XL&65536&&Qg.a($a).Nr(new Rg.a(cg.a.xx,5,function(){$a.xH(l,!0);var Lb=ka.clientWorkflow.ld.activityState;Lb[Si.a.kp]=cg.a.Dk;Lb[li.a.bOc]=ka.workbookContext.NovMode;K||(Lb[Mh.a.DS]=1,Lb[Mh.a.EUb]=new kg)}))}};lf.prototype.setCalculationMode=function(l,K){function ka(){return new Kf(K)}var $a=this;qd.ULS.sendTraceTag(41263681,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",
K);var Lb=this.$.fa.workbookContext.CalcMode;this.$.fa.workbookContext.CalcMode=K;return qf.a(this.$.userOperationManager,function(bc,Dc,wd){var ke=$a.$.ra.xa;bc=Tf.b(bc,lf.Tyi($a.$,Lb));Dc=Tf.a(Dc,lf.Syi($a.$,Lb));var jf=ke.Ra(9,null);jf.calc_type=K;return Ef.i(ke,"SetCalculationOptions",jf,bc,Dc,wd,null,0)},function(bc){return new rf.a(197,0,bc,void 0,ka)},l)};lf.Sqe=function(l){l.Db&&0<l.Db.PQ&&l.Db.C4c(function(K){K.su()})};lf.Tyi=function(l,K){return function(ka){Bd.a.eh(ka.Errors)&&(l.fa.workbookContext.CalcMode=
K,qd.ULS.sendTraceTag(593609297,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",K,Bd.a.fd(ka.Errors)))}};lf.Syi=function(l,K){return function(){l.fa.workbookContext.CalcMode=K;qd.ULS.sendTraceTag(593609296,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",K)}};Jl.Object.defineProperties(lf.prototype,{pc:{configurable:!0,enumerable:!0,get:function(){return this.$.fa.pc}},
workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},P2b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return ai.a(this.$)}},mc:{configurable:!0,enumerable:!0,get:function(){return this.$.mc}}});Object(fe.a)(lf,"FileOperationsCommandHandler",Na.a,[159]);var ra=b(147),mb=Df.a;Cm(wf,mb);wf.prototype.Rd=function(){var l=this,K=this.$,ka=[],$a=Vf.GetServiceTaskFactory.create(K.ea,
56,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IOpenInExcelOperation");ka.push($a);var Lb=Vf.GetServiceTaskFactory.Xa(K.ea,5,4,this.vb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");ka.push(Lb);og.TaskExtensions.Da(we.Task.WAA.apply(null,ka),function(){ra.b($a)&&l.Hd([new lf(K,$a.result,new Wg.a(function(){return Vf.GetServiceTaskFactory.create(K.ea,137,l.ma,l.vb,"Postmessage.IHostPostmessenger")}),Lb.result)])},this.ma,0)};wf.la=function(l){Df.a.ie(94,new wf(l))};
Object(fe.a)(wf,"FileOperationsCommandHandlerFactory",Df.a,[]);var Qb=b(46),Sc;(function(l){l[l.url=0]="url";l[l.ref=1]="ref";l[l.mailto=2]="mailto"})(Sc||(Sc={}));Object(fe.b)("HyperlinkSelectionState",Sc);var Ad=b(884),ye=b(10),Ze=b(599),sd=b(91),pe=Ad.a;Cm(Pe,pe);Pe.prototype.bSh=function(l,K){1===l||2===l?(qd.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===l?"OK":"Remove"),this.Pqd=K[Pe.mai],this.Oqd=K[Pe.l3i],this.Nqd=K[Pe.M3g],2===l&&(this.removeHyperLink=!0),this.commit()):qd.ULS.sendTraceTag(555755669,
0,50,"HyperLink Cancel pressed")};Pe.prototype.HRe=function(l,K){switch(K){case 2:return l.startsWith("mailto:")?l:"mailto:"+l;case 1:return String.format("{0}{1}",ye.a.sxf,this.mCh(l));default:return l}};Pe.prototype.JAj=function(l,K){return K&&l.length?1===K?this.cQe(Qb.y(l,this.fa.Aa)||this.uji(l),730):this.cQe(Lf.a.hhd(l),732):null};Pe.prototype.Ww=function(){var l=this,K=this.$;this.location=this.HRe(this.Pqd,this.Oqd);try{this.location=sd.a.Lq(this.location)}catch(Lb){qd.ULS.sendTraceTag(555755668,
0,15,"Decoding link text failed")}qd.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Sc[this.Oqd]);this.cellValue=this.Nqd.length?this.Nqd:this.Pqd;K.Ss();var ka=K.ra.xa.dc(),$a=Qb.s(this.selectedRange);return function(Lb,bc,Dc){return Ef.c(K.ra.xa,$a,l.cellValue,l.location,l.removeHyperLink,!1,123,Lb,bc,Dc,l.nL.range,ka)}};Pe.prototype.Yl=function(){var l=this,K=Qb.s(this.selectedRange);return function(){return new Ze.a(K,l.cellValue,l.location)}};Pe.prototype.Ujh=function(){var l=this.nL.cell.HJa;
this.nL.cell.a2a?l&&l.startsWith("mailto:")?(this.Njb=2,l=l.substr(7)):this.Njb=0:this.Njb=1;return l};Pe.prototype.TJa=function(){yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1)?this.Fvb=this.nL.U$:this.Fvb=!!this.nL.EIa(64)||!!this.nL.EIa(128)};Pe.prototype.rm=function(){if(this.Fvb){this.QZa=this.nL.text;var l=this.Ujh();l&&(this.QNc=l);this.$n=Te.a.instance.da(789);this.Wnb=this.QNc===this.QZa}else this.nL.text?(this.QZa=this.nL.text,this.Wnb=!1):(this.QZa="",this.Wnb=
!0),this.Njb=0,this.$n=Te.a.instance.da(788);this.nL.NG&&(this.Wnb=!1,this.oze=!0,yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.QZa=this.nL.formulaBarText))};Pe.prototype.uji=function(l){return this.fa.Ab.Gj(l)};Pe.prototype.cQe=function(l,K){return l?null:Te.a.instance.da(K)};Pe.prototype.mCh=function(l){var K=Qb.Y(l,this.fa.Aa);var ka=K.sheetName;var $a=K.range;K.returnValue&&$a&&(l=Qb.x($a,ka||this.sheetName,!1));return l};Jl.Object.defineProperties(Pe.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Aw:{configurable:!0,enumerable:!0,get:function(){return 526}}});Pe.mai="linkValue";Pe.l3i="selectedLink";Pe.M3g="displayText";Object(fe.a)(Pe,"HyperlinkDialog",Ad.a,[]);Ye.prototype.$c=function(){return!1};Ye.prototype.Jc=function(l,K){return 1===l&&-1583422759===K.command};Ye.prototype.gd=function(){return!1};Ye.prototype.executeCommand=function(){this.mgj();return we.Task.Ua(!0)};Ye.prototype.mgj=function(){var l=Qb.v(this.gridView.ga.ya.Xd,
this.$),K=ag.e(this.gridView);(!yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.qt([this.gridView.ga.ya.Xd],!0))&&K&&new Pe(this.$,l,K)};Object(fe.a)(Ye,"ShowHyperlinkCommandHandler",null,[159]);var Ve=Df.a;Cm(ff,Ve);ff.prototype.Rd=function(){this.Hd([new Ye(this.$,ag.g(this.$))])};ff.la=function(l){Df.a.ie(105,new ff(l))};Object(fe.a)(ff,"ShowHyperlinkCommandHandlerFactory",Df.a,[]);var Li=b(1126);Je.create="Create";Je.activate=
"Activate";Je.close="Close";Je.remove="Delete";Je.duplicate="Duplicate";Object(fe.a)(Je,"Actions",null,[]);var Jf=we.Task;Cm(Xd,Jf);Xd.prototype.TK=function(){this.eTd=Bd.a.Ad(3,2,0,1594,0,-1244327602,"MsFormDeleteConfirmation");this.ej=Qg.a(this.Cf.$).ki(this.eTd).G();this.ej.isCompleted||(this._state=2,this.ej.LM(Object(fd.a)(this,this.moveNext,"moveNext")));return this.Lxc};Xd.prototype.Lxc=function(){this.gTd=this.ej.Ky();this.gTd||(this.Cf.$.workbookContext.Options=xe.HelperMethods.wN(!1,this.Cf.$.workbookContext.Options,
2048),this.Cf.deleteMsFormMetaDataSheet());this._state=3;this.lPa(!0)};Xd.prototype.dispose=function(){};Xd.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.lu=this.lu()}catch(l){this.dispose(),this.Nca(l),this._state=3}};Object(fe.a)(Xd,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",we.Task,[7]);vd.action="Action";vd.ynh="FlexPane";vd.e6b="formId";vd.id="id";vd.title="Title";vd.xLb="XlWorkbookId";vd.pph="Fragment";vd.host="Host";vd.Wqj=
"TopView";vd.q1="auth_pvr";Object(fe.a)(vd,"Parameters",null,[]);cc.prototype.$c=function(l,K){switch(K){case -105284469:return!Ld.i(this.$.sg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};cc.prototype.executeCommand=function(l,K){l=og.TaskExtensions.um();K=K.command;switch(K){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();
break;case 2023601781:l=this.deleteMsForm();break;default:l=h.a(K)}return l};cc.prototype.Jc=function(l,K){if(!this.$.fa.gh.get(61))return!1;l=!1;switch(K.command){case -105284469:l=Ld.i(this.$.sg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:l=this.hasMsForm}return l};cc.prototype.gd=function(){return!1};cc.prototype.insertMsForm=function(){var l=Lf.a.Pq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),K={},ka={};K[vd.action]=Je.create;K[vd.q1]=
this.q1;ka[vd.action]=Je.create;ka[vd.xLb]=encodeURIComponent(this.tLb);ka[vd.host]=this.zt;ka[vd.title]=encodeURIComponent(l);this.Oyb(K,ka);this.$.workbookContext.Options=xe.HelperMethods.wN(!1,this.$.workbookContext.Options,2048)};cc.prototype.editMsForm=function(){var l={},K={};l[vd.q1]=this.q1;K[vd.e6b]=this.Ggc;K[vd.xLb]=encodeURIComponent(this.tLb);K[vd.host]=this.zt;this.Oyb(l,K)};cc.prototype.previewMsForm=function(){var l={},K={};l[vd.q1]=this.q1;K[vd.e6b]=this.Ggc;K[vd.xLb]=encodeURIComponent(this.tLb);
K[vd.host]=this.zt;K[vd.Wqj]="Preview";this.Oyb(l,K)};cc.prototype.sendMsForm=function(){var l={},K={};l[vd.q1]=this.q1;K[vd.e6b]=this.Ggc;K[vd.ynh]="SendForm";K[vd.xLb]=encodeURIComponent(this.tLb);K[vd.host]=this.zt;this.Oyb(l,K)};cc.prototype.deleteMsForm=function(){return new Xd(this)};cc.prototype.deleteMsFormMetaDataSheet=function(){var l=this;this.$.userOperationManager.yt(new rf.a(158,0,function(K,ka,$a){return xc(l.$.ra.hw,l.gU.irb,Tf.b(K,function(){l.Y0g()}),ka,$a,null)}))};cc.prototype.Y0g=
function(){var l={},K={};l[vd.action]=Je.remove;l[vd.q1]=this.q1;K[vd.action]=Je.remove;K[vd.host]=this.zt;K[vd.e6b]=encodeURIComponent(this.Ggc);K[vd.xLb]=encodeURIComponent(this.tLb);this.Oyb(l,K)};cc.prototype.Oyb=function(l,K){var ka=this.$.Ba.MsFormBaseUrl+"/Pages/DesignPage.aspx",$a="",Lb="";if(K){for(var bc in K){var Dc=bc,wd=K[bc];Lb+=Lb.length?"&":"";Lb+=Dc+"="+wd}l||(l={});l[vd.pph]=encodeURIComponent(Lb)}if(l)for(var ke in l)K=ke,Lb=l[ke],$a+=$a.length?"&":"?",$a+=K+"="+Lb;window.open(ka+
$a,"_blank")};Jl.Object.defineProperties(cc.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return Ld.c(this.$.sg)}},Ggc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},tLb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},q1:{configurable:!0,enumerable:!0,get:function(){return Re.a.contains(this.$.pu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(fe.a)(cc,"MsFormCommandHandler",
null,[159]);var ui=Df.a;Cm(hb,ui);hb.prototype.Rd=function(){var l=this,K=Vf.GetServiceTaskFactory.create(this.$.ea,203,this.ma,this.vb,"System.IDisposable");og.TaskExtensions.Da(og.TaskExtensions.Fe([K],this.ma),function(){l.Hd([new cc(l.$)])},this.ma,3)};hb.la=function(l){l.fa.gh.get(61)&&Df.a.ie(215,new hb(l))};Object(fe.a)(hb,"MsFormCommandHandlerFactory",Df.a,[]);var bj=Ie.a;Cm(sa,bj);sa.prototype.create=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,164,
this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.NewAndOpen.INewAndOpenCoreManager"),function(){l.Jb(new Rc)},this.ma,3)};Object(fe.a)(sa,"NewAndOpenUXFactory",Ie.a,[]);Yb.prototype.executeCommand=function(l,K,ka){l=2;switch(K.command){case Cf.a.openUrlInNewTab:l=this.Bi.Pe(Cf.a.openUrlInNewTab,2,ka);break;case Cf.a.VMa:l=this.Bi.Pe(Cf.a.VMa,2,ka)}return 2!==l?we.Task.Ua(!0):h.a(K.command)};Yb.prototype.Jc=function(l,K){return K.command===Cf.a.openUrlInNewTab||K.command===Cf.a.VMa};Yb.prototype.gd=
function(l,K,ka){return"PopulateMruMenu"===K?(this.Bi.Pe(Cf.a.Ikc,2,ka),!0):!1};Yb.prototype.$c=function(){return!1};Object(fe.a)(Yb,"OpenFromMruCommandHandler",null,[159]);var ji=Df.a;Cm(De,ji);De.prototype.Rd=function(){var l=this,K=Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),ka=Vf.GetServiceTaskFactory.create(this.$.ea,165,this.ma,this.vb,"System.IDisposable");og.TaskExtensions.Da(og.TaskExtensions.Fe([K,ka],this.ma),function(){l.Hd([new Yb(l.$,Wd.AFrameworkApplication.Hb)])},
this.ma,3)};De.la=function(l){Df.a.ie(88,new De(l))};Object(fe.a)(De,"OpenFromMruCommandHandlerFactory",Df.a,[]);var Ei=b(86),mi=b(82),Zh=b(236),gi=b(657),gf=b(1071),vj=Zh.a;Cm(Od,vj);Od.prototype.execute=function(l){var K=Object(mi.a)(11,l.Je);if(!K.qaa)return qd.ULS.sendTraceTag(50954706,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Sfd(l),this.mh(cg.a.idle),1;this.Eyb||(this.Eyb=new gf.DownloadACopyOperation(this.Ffc,K));this.Eyb.m5g();
qd.ULS.shipAssertTag(22590615,0,3!==ai.a(K).pi.At,"The current activity should not be closed.");return 1};Od.prototype.Sfd=function(l){var K=Object(mi.a)(11,l.Je),ka=new gi.a(K);this.subscribe(l,Object(fd.a)(this,this.hud,"onProtectedFileDataLeakErrorDialogDisposing"),function($a){ka.add_disposing($a)});qd.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");ka.initialize();ka.Bf()};Od.prototype.hud=function(l){this.unsubscribe(function(K){l.remove_disposing(K)});
this.mh(cg.a.Ck);this.So()};Od.prototype.dispose=function(){Ei.a.Ia(this.Eyb);this.Eyb=null;vj.prototype.dispose.call(this)};Object(fe.a)(Od,"DownloadAForkedCopyActivity",Zh.a,[]);var ej=Ie.a;Cm(ld,ej);ld.prototype.create=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){l.Jb(new Od(cg.a.WZa,cg.a.Ck,!0))},this.ma)};Object(fe.a)(ld,"DownloadACopyPreDatalossActivityFactory",Ie.a,[]);var Ti=Ie.a;Cm(Vd,Ti);Vd.prototype.create=
function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){l.Jb(new Od(cg.a.unmergeableDownloadCopy,cg.a.bna))},this.ma)};Object(fe.a)(Vd,"DownloadAForkedCopyActivityFactory",Ie.a,[]);Uc.prototype.Rg=function(){this.Oa.$b(Cf.a.tryMacOffice,Bh.a.frame,Object(fd.a)(this,this.LAi,"onTryMacOffice"));this.Oa.$b(Cf.a.h0f,Bh.a.frame,Object(fd.a)(this,this.Ptf,"onTryMacOfficeFromViewer"));this.Oa.$b(Cf.a.g0f,Bh.a.frame,Object(fd.a)(this,
this.Ptf,"onTryMacOfficeFromViewer"))};Uc.prototype.LAi=function(l,K,ka,$a,Lb){if(1===ka)return 32;Lb?(l=Lb.SourceControlId,"btnjTryMacOfficeForWordEditor"===l?Hg.a.wf(xd.a.UY(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===l&&Hg.a.wf(xd.a.UY(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.waf();return 32};Uc.prototype.Ptf=function(l,K,ka){if(1===ka)return 32;switch(l){case Cf.a.h0f:Hg.a.wf(xd.a.UY(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");
break;case Cf.a.g0f:Hg.a.wf(xd.a.UY(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};Uc.prototype.waf=function(){var l=void 0===l?null:l;var K=0;l&&(K=l);Hg.a.wf(2===K?"https://go.microsoft.com/fwlink/?LinkId=331579":Uc.Zei,"_blank",void 0,"LaunchMacTrialWindow")};Jl.Object.defineProperties(Uc.prototype,{Krc:{configurable:!0,enumerable:!0,get:function(){return this.Heg&&Sd.a.isMac&&!Sd.a.o4h&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},mdj:{configurable:!0,enumerable:!0,get:function(){return this.Krc}}});
Jl.Object.defineProperties(Uc,{Zei:{configurable:!0,enumerable:!0,get:function(){return xd.a.DG("522401")}}});Object(fe.a)(Uc,"MacOfficeOffer",null,[397]);fc.prototype.Rg=function(){this.Oa.$b(Cf.a.tryOffice,Bh.a.frame,Object(fd.a)(this,this.MAi,"onTryOffice"));this.Oa.$b(Cf.a.tryOfficeThroughTellMe,Bh.a.frame,Object(fd.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.Oa.$b(Cf.a.k0f,Bh.a.frame,Object(fd.a)(this,this.l0f,"tryOfficeThroughViewer"));this.Oa.$b(Cf.a.j0f,Bh.a.frame,
Object(fd.a)(this,this.l0f,"tryOfficeThroughViewer"))};fc.prototype.MAi=function(l,K,ka,$a,Lb){if(this.NTb&&1===ka)return this.isFreemiumUpsellEnabled&&this.CHb?32:8;2===ka&&(Lb?(l=Lb.SourceControlId,"btnjTryOfficeForWordEditor"===l?Hg.a.wf(xd.a.UY(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===l?Hg.a.wf(xd.a.UY(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Aec()):this.Aec());return 32};fc.prototype.tryOfficeThroughTellMe=function(l,K,ka,$a,Lb){if(this.NTb&&
1===ka)return this.isFreemiumUpsellEnabled&&this.CHb?32:8;2===ka&&(Lb?(l=Lb.SourceControlId,Hg.a.wf(xd.a.DG("862405")+this.wEh(l),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Hg.a.wf(xd.a.DG("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};fc.prototype.l0f=function(l,K,ka){if(this.NTb&&1===ka)return this.isFreemiumUpsellEnabled&&this.CHb?32:8;if(2===ka)switch(l){case Cf.a.k0f:Hg.a.wf(xd.a.UY(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Cf.a.j0f:Hg.a.wf(xd.a.UY(24),
"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};fc.prototype.Aec=function(l){l=void 0===l?null:l;var K=0;l&&(K=l);Hg.a.wf(fc.nCh(K),"_blank",void 0,"LaunchOfficeOffer")};fc.prototype.wEh=function(l){var K=0;switch(l){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":K=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":K=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":K=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":K=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":K=
5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":K=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":K=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":K=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":K=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":K=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":K=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":K=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":K=18;break;
case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":K=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":K=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":K=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":K=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":K=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":K=29}return K?String.format("&pc={0:D}",K):""};fc.nCh=function(l){if(Sd.a.hh)switch(l){case 1:return xd.a.DG("393806");case 2:return xd.a.DG("393810");
case 3:return xd.a.DG("393809");case 5:return xd.a.DG("393805")}else if(Sd.a.Dp)switch(l){case 1:return xd.a.DG("521979");case 3:return xd.a.DG("521980");case 5:return xd.a.DG("521978");case 2:return xd.a.DG("522490")}else{if(2===l)return xd.a.DG("517778");if(1===l)return xd.a.UY(30)}return xd.a.DG("522402")};Jl.Object.defineProperties(fc.prototype,{Oif:{configurable:!0,enumerable:!0,get:function(){return this.CHb}},Wmi:{configurable:!0,enumerable:!0,get:function(){return this.CHb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},
CHb:{configurable:!0,enumerable:!0,get:function(){return this.Leg&&!Sd.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var l=!1;this.nzc&&(l=this.nzc.isFreemiumUpsellEnabled());return l}}});Object(fe.a)(fc,"OfficeTrialExperience",null,[380]);ac.prototype.$h=function(l){l.register(fc,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Ac().Lc(function(){return new fc(Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.mwb,Wd.AFrameworkApplication.lcid)});
l.register(Uc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Ac().Lc(function(){return new Uc(Wd.AFrameworkApplication.Hb,Wd.AFrameworkApplication.occ,Wd.AFrameworkApplication.lcid)})};Object(fe.a)(ac,"OpenInClientConfiguration",null,[9]);var oj=b(1319),wg=b(36),qj=b(1218),Qh=b(276);Jl.Object.defineProperties(ud,{Mf:{configurable:!0,enumerable:!0,get:function(){return Ag.a.jj(ud.Oj,CommonUIStrings.l_OICLaunchDialogTitle)}}});ud.Oj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(fe.a)(ud,"OICLaunchDialogHtml",null,[]);var Lj=Ag.a;Cm(Vc,Lj);Vc.prototype.D6a=function(){this.$Aa=ce("BtnRichClient",this.Rp.ppb,this.Rp.Cub,this.Rp.led,CommonUIStrings.l_OICLaunchRichClient,Object(fd.a)(this,this.Arf,"onRichClientButtonClick"),Ae);document.getElementById("OICLaunchRichClient").appendChild(this.$Aa);Ob(this.$Aa);this.ISa=ce("BtnReturn",this.Rp.ppb,this.Rp.Cub,this.Rp.x0e,CommonUIStrings.l_OICReturnToOnlineClient,Object(fd.a)(this,this.xrf,"onReturnButtonClick"),Ae);document.getElementById("OICReturnToApp").appendChild(this.ISa);
Ob(this.ISa)};Vc.prototype.xrf=function(){this.hide();this.Rp.F9a();return!0};Vc.prototype.Arf=function(){qd.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Wd.AFrameworkApplication.Hb.processAction(Cf.a.BOa,2);return!0};Vc.prototype.oni=function(){this.Rp.F9a()};Vc.prototype.dispose=function(){this.koa||(this.$Aa&&(Qh.a.instance.Ca(ef.a.click,this.$Aa,Object(fd.a)(this,this.Arf,"onRichClientButtonClick")),V.KeyInputManager.instance.Ca(ef.a.fe,this.$Aa,Ae)),this.ISa&&
(Qh.a.instance.Ca(ef.a.click,this.ISa,Object(fd.a)(this,this.xrf,"onReturnButtonClick")),V.KeyInputManager.instance.Ca(ef.a.fe,this.ISa,Ae)),Lj.prototype.dispose.call(this),this.koa=!0)};Object(fe.a)(Vc,"OICLaunchDialog",Ag.a,[]);Jl.Object.defineProperties(Fc,{Mf:{configurable:!0,enumerable:!0,get:function(){return Ag.a.jj(Fc.Oj,CommonUIStrings.l_OICDialogTitle)}}});Fc.Oj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(fe.a)(Fc,"ProtocolLaunchingDialogV2Html",null,[]);var Uj=Ag.a;Cm($b,Uj);$b.prototype.D6a=function(){var l=document.getElementById("Issues");if(l){Ge("",this.Rp.ppb,this.Rp.Cub,this.Rp.led,l);var K=document.createElement("span");K.className="WACDialogSectionTitle";K.innerText=5===this.Rp.yuf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;l.appendChild(K);Ob(l);l.style.display="none"}Wd.AFrameworkApplication.za.Za.Abd?(this.HSa=ce("GiveFeedback",this.Rp.ppb,this.Rp.Cub,
"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(fd.a)(this,this.mic,"onGiveFeedbackClick"),Object(fd.a)(this,this.Fnf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.HSa),Ob(this.HSa)):document.getElementById("ButtonGiveFeedback").style.display="none";Wd.AFrameworkApplication.za.Za.editMode&&!Wd.AFrameworkApplication.X2g?(this.Xda=ce("Edit",this.Rp.ppb,this.Rp.Cub,"",2===Wd.AFrameworkApplication.za.Za.Xk?4===Wd.AFrameworkApplication.za.Za.editMode?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Wd.AFrameworkApplication.za.Za.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(fd.a)(this,this.mmf,"onEditClick"),Object(fd.a)(this,this.pmf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Xda),Ob(this.Xda)):document.getElementById("ButtonEdit").style.display="none";Wd.AFrameworkApplication.za.Za.editMode||Wd.AFrameworkApplication.mwb||
!l||(l.style.display="none")};$b.prototype.ELe=function(){return this.Rna?(this.iz(this.Rna),!0):!1};$b.prototype.CLe=function(){return this.Xda?(this.iz(this.Xda),!0):!1};$b.prototype.pmf=function(l){return this.wsd(l,0)};$b.prototype.Fnf=function(l){return this.wsd(l,2)};$b.prototype.vrf=function(l){return this.wsd(l,1)};$b.prototype.wsd=function(l,K){var ka=!1;if(l.Ga.keyCode===fh.a.Vh||l.Ga.keyCode===fh.a.mna)l.Wb.click(),ka=!0;else if(l.Ga.keyCode===Sys.UI.Key.down||l.Ga.keyCode===Sys.UI.Key.up)switch(K){case 1:ka=
this.CLe();break;case 0:ka=this.ELe()}return ka};$b.prototype.mmf=function(){this.hide();4===Wd.AFrameworkApplication.za.Za.editMode?(qd.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Rp.F9a()):(qd.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Rp.Wbd());return!0};$b.prototype.mic=function(){qd.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Rp.LXe();return!0};$b.prototype.djc=function(){qd.ULS.sendTraceTag(19239263,211,50,
"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Wd.AFrameworkApplication.Hb.processAction(Cf.a.BOa,2);return!0};$b.prototype.zyd=function(){this.Rp.F9a()};$b.prototype.switchToBackupMode=function(){var l=document.getElementById("ProtocolLaunchingDialogTitle");if(l){l.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(l=document.getElementById("Issues"))l.style.display="block";(l=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!l.children.length&&(this.Rna=
ce("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(fd.a)(this,this.djc,"onRetryOICClick"),Object(fd.a)(this,this.vrf,"onRetryOICKeyUp")),l.appendChild(this.Rna),Ob(this.Rna),this.Xda||this.ELe())}};$b.prototype.dispose=function(){this.koa||(this.Xda&&(Qh.a.instance.Ca(ef.a.click,this.Xda,Object(fd.a)(this,this.mmf,"onEditClick")),V.KeyInputManager.instance.Ca(ef.a.fe,this.Xda,Object(fd.a)(this,this.pmf,"onEditKeyUp"))),this.HSa&&(Qh.a.instance.Ca(ef.a.click,this.HSa,Object(fd.a)(this,
this.mic,"onGiveFeedbackClick")),V.KeyInputManager.instance.Ca(ef.a.fe,this.HSa,Object(fd.a)(this,this.Fnf,"onGiveFeedbackKeyUp"))),this.Rna&&(Qh.a.instance.Ca(ef.a.click,this.Rna,Object(fd.a)(this,this.djc,"onRetryOICClick")),V.KeyInputManager.instance.Ca(ef.a.fe,this.Rna,Object(fd.a)(this,this.vrf,"onRetryOICKeyUp"))),Uj.prototype.dispose.call(this),this.koa=!0)};Object(fe.a)($b,"ProtocolLaunchingDialog",Ag.a,[]);var dg=b(474),Mj=Be.StandardDialog;Cm(gd,Mj);gd.prototype.mic=function(l){qd.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.Emf(l)};gd.prototype.djc=function(){qd.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Wd.AFrameworkApplication.Hb.processAction(Cf.a.BOa,2)};gd.prototype.zyd=function(l){gd.HYe?3===l?this.UIf():2!==l&&l?1===l&&this.pMg():this.continueEditing():2===l?this.UIf():1!==l&&l||this.continueEditing()};gd.prototype.pMg=function(){qd.ULS.sendTraceTag(577783557,211,50,"Closing the document");Wd.AFrameworkApplication.Hb.Pe(Cf.a.close,2,dg.a)};gd.prototype.UIf=function(){qd.ULS.sendTraceTag(593602691,
211,50,"OIC dialog retry");window.setTimeout(Object(fd.a)(this,this.djc,"onRetryOICClick"),0)};gd.prototype.continueEditing=function(){4===Wd.AFrameworkApplication.za.Za.editMode||Wd.AFrameworkApplication.ha.ta("WordConsumptionViewToEditRedirectIsEnabled")&&1===Wd.AFrameworkApplication.za.mode?(qd.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Rp.F9a()):(qd.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Rp.Wbd())};Jl.Object.defineProperties(gd,
{HYe:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.ha.ta("OICDialogThreeActions")&&32===Wd.AFrameworkApplication.Hb.processAction(Cf.a.close,1)}}});Object(fe.a)(gd,"StandardProtocolLaunchingDialog",Be.StandardDialog,[]);Object(fe.a)(Le,"EditDocumentInClientParams",null,[]);Bf.X1c=function(l,K,ka,$a,Lb,bc,Dc,wd,ke,jf,Xf,Sf){Dc=void 0===Dc?!1:Dc;wd=void 0===wd?!1:wd;ke=void 0===ke?"":ke;jf=void 0===jf?!1:jf;Xf=void 0===Xf?!1:Xf;Sf=void 0===Sf?!1:Sf;var xg=new Le;xg.DocumentUrl=
l;xg.Mode=K;xg.Options=ka;xg.Application=$a;xg.SilentExternalHandler=Dc;xg.EncodeUrl=wd;xg.CorrelationIdForWinClient=ke;xg.NavigateUsingWindowOpen=jf;xg.DescriptiveUnattemptedEnums=Xf;xg.NoBrowserModalDialogs=Sf;MSOJS.ClientUtils.EditDocumentInClient(xg,Lb,bc)};Object(fe.a)(Bf,"ClientUtils",null,[]);var wj=b(944);ne.prototype.d_i=function(l,K,ka){return K.contextId!==Bh.a.frame?2:1===ka?32:this.BOa()};ne.prototype.Wmj=function(){return!(2===this.application&&Wd.AFrameworkApplication.ha.ta("IsEmbeddedScenario"))};
ne.prototype.closeApplication=function(){this.NMd||this.Qih()};ne.prototype.F9a=function(){this.Zmj||this.djh()};ne.prototype.VBf=function(l){this.Czj&&Sd.a.hh?new Vc(this):this.h_b(l)};ne.prototype.h_b=function(l){l=this.V9h(l);var K=l.returnValue;qd.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===K,l.Pza);return K};ne.prototype.MEa=function(l,K,ka,$a,Lb,bc){this.OSa=l;this.nYd=K;this.Sea=bc;this.application=ka;this.pB=$a;Wd.AFrameworkApplication.downloadCopyOnOpenInClient?this.taf():
Wd.AFrameworkApplication.limitedEdit&&!Wd.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?Wd.AFrameworkApplication.VTf():this.dBg(Lb)};ne.prototype.BOa=function(){return this.h_b(this.ufb)};ne.prototype.tMf=function(){var l=new wj.a(Eh.a.openInClient);l.Values["ui-language"]=Wd.AFrameworkApplication.lcid.toString();l.Values[I.a.l_c]=Wd.AFrameworkApplication.userSessionId;return this.Sea.value.send(l)?32:8};ne.prototype.F4i=function(l){var K=new wj.a(Eh.a.PBj);K.Values["ui-language"]=
Wd.AFrameworkApplication.lcid.toString();K.Values[I.a.l_c]=Wd.AFrameworkApplication.userSessionId;K.Values[Mg.a.OBj]=l;this.Sea.value.send(K)};ne.prototype.V9h=function(l){this.ufb=l;this.F4i(5===this.pB?ne.hCi:ne.jCi);return 5===this.pB?this.U9h():this.Z9h()};ne.prototype.U9h=function(){this.zaf();return{returnValue:32,Pza:"HostEditUrl,"}};ne.prototype.Z9h=function(){var l,K=l="";Wd.AFrameworkApplication.dee&&(K="|f|"+Wd.AFrameworkApplication.userSessionId);var ka=Wd.AFrameworkApplication.ha.ta("IsAssignmentMode")&&
Wd.AFrameworkApplication.ha.ta("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||Wd.AFrameworkApplication.isUnifiedHostMode||Sd.a.Jja,$a=Wd.AFrameworkApplication.ha.ta("UnattemptedEnumIsEnabled"),Lb=Wd.AFrameworkApplication.ha.ta("NoBrowserModalDialogs");if(Wd.AFrameworkApplication.yxf){l+="NewOrder,";var bc=8;this.Sea&&this.Sea.value&&this.Sea.value.isEnabled()&&Wd.AFrameworkApplication.nRd&&(l+="Post,",bc=this.tMf());if(32===bc)return{returnValue:bc,Pza:l};qd.ULS.sendTraceTag(4994821,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Wd.AFrameworkApplication.zl.g7a?(qd.ULS.shipAssertTag(5566816,211,!!Wd.AFrameworkApplication.zl.g7a),l+="HostUrl,",{returnValue:Wd.AFrameworkApplication.za.uzb(Wd.AFrameworkApplication.zl.g7a),Pza:l}):this.OSa?(qd.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",Wd.AFrameworkApplication.userSessionId),l+="DocUrl,",Bf.X1c(this.OSa,this.pB,this.options,this.application,Object(fd.a)(this,this.omf,
"onEditInClientSuccess"),Object(fd.a)(this,this.nmf,"onEditInClientFailure"),this.xUf,Wd.AFrameworkApplication.ha.ta("OICEncodeUrlIsEnabled"),K,ka,$a,Lb),{returnValue:32,Pza:l}):{returnValue:8,Pza:l}}l+="OldOrder,";if(!this.OSa&&Wd.AFrameworkApplication.zl.g7a)return this.Sea&&this.Sea.value&&this.Sea.value.isEnabled()&&Wd.AFrameworkApplication.nRd?(l+="Post,",K=this.tMf()):(qd.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),K=8),32!==K?(qd.ULS.shipAssertTag(22595484,
211,!!Wd.AFrameworkApplication.zl.g7a),l+="HostUrl,",{returnValue:Wd.AFrameworkApplication.za.uzb(Wd.AFrameworkApplication.zl.g7a),Pza:l}):{returnValue:K,Pza:l};qd.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Wd.AFrameworkApplication.userSessionId);l+="DocUrl,";Bf.X1c(this.OSa,this.pB,this.options,this.application,Object(fd.a)(this,this.omf,"onEditInClientSuccess"),Object(fd.a)(this,this.nmf,"onEditInClientFailure"),this.xUf,Wd.AFrameworkApplication.ha.ta("OICEncodeUrlIsEnabled"),
K,ka,$a,Lb);return{returnValue:32,Pza:l}};ne.prototype.WGf=function(l){Wd.AFrameworkApplication.Sm.setDw(8981,l)};ne.prototype.omf=function(l){this.WGf(l);qd.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===l&&MSOJS.ClientUtils.ShouldShowDialog()?this.rXf||this.zaf():this.NMd||this.closeApplication()};ne.prototype.nmf=function(l,K){K=void 0===K?0:K;qd.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",l,K);if(5===l)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);
else{var ka=!!this.nYd&&!this.ufb,$a=0;1===l&&($a=2);6<=l&&13>=l&&($a=1,1===K&&(this.NMd=!0));this.ouc.Wmi?(qd.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",$a),qj.a.instance.TVg(this.ufb?Object(fd.a)(this,this.ejf,"oicErrorDialogHandlerCloseForced"):Object(fd.a)(this,this.fjf,"oicErrorDialogHandlerNoCloseForced"),ka?Object(fd.a)(this,this.Hof,"onLaunchDownload"):null,this.hze(!1)?Object(fd.a)(this,this.gSh,"iHaveOfficeButtonHandler"):null,$a,K)):(qd.ULS.sendTraceTag(18715409,
211,50,"Open OICErrorDialog. Dialog cause: {0}",$a),qj.a.instance.RVg(this.ufb?Object(fd.a)(this,this.ejf,"oicErrorDialogHandlerCloseForced"):Object(fd.a)(this,this.fjf,"oicErrorDialogHandlerNoCloseForced"),ka?Object(fd.a)(this,this.Hof,"onLaunchDownload"):null,$a))}};ne.prototype.zaf=function(){Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.Ju&&Wd.AFrameworkApplication.ha.ta("StandardProtocolDialogIsEnabled")?new gd(this):new $b(this)};ne.prototype.ejf=function(){this.closeApplication()};
ne.prototype.fjf=function(){this.F9a()};ne.prototype.Hof=function(){this.taf()};ne.prototype.gSh=function(){return this.hze(!0)};ne.prototype.hze=function(l){var K=(Sd.a.rM||Sd.a.IJ)&&!!Wd.AFrameworkApplication.j2b;K&&l&&(Hg.a.wf(Wd.AFrameworkApplication.j2b,"_blank",void 0,"OpenInClient"),this.closeApplication());return K};Jl.Object.defineProperties(ne.prototype,{yuf:{configurable:!0,enumerable:!0,get:function(){return this.pB}},options:{configurable:!0,enumerable:!0,get:function(){var l=0;Wd.AFrameworkApplication.oYi&&
(l|=1);Wd.AFrameworkApplication.openInClientEditOnly&&(l|=4);this.Wmj()&&(l|=64);return l}},ppb:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.pC}},Cub:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.wub}},x0e:{configurable:!0,enumerable:!0,get:function(){return""}},led:{configurable:!0,enumerable:!0,get:function(){return""}},rXf:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.ha.ta("OneNoteMobileViewerIsEnabled")}},
ouc:{configurable:!0,enumerable:!0,get:function(){return this.f5d||(this.f5d=Dd.a.instance.resolve("Common.IOfficeTrialExperience"))}}});ne.jCi="OpenInDesktop";ne.hCi="OpenInBrowser";Object(fe.a)(ne,"AOpenInClientOperation",null,[]);var Ci=b(189),Ig=b(193),rj=b(127),fk=b(44),Kj=b(42),ak=b(178),Ui=b(92),fj=b(32),sk=b(478),Nj=b(1162),Hi=b(603);Cm(Ce,ne);Ce.prototype.tOg=function(){this.VBf(this.OLe)};Ce.prototype.dQg=function(){var l=this,K=this.$;og.TaskExtensions.Da(this.rJ.value,function(ka){l.MEa(K.workbookContext.ClientUrl,
Wd.AFrameworkApplication.X2,1,K.isEditMode?2:0,!0,new Wg.a(function(){return ka.result}))},this.ma,3)};Ce.prototype.Wbd=function(){Zf.a.Nf.editMode&&(this.$.Db.MJ=!1)};Ce.prototype.LXe=function(){var l={};l[vc.a.i5c]=!1;l[vc.a.Fha]="OpenInExcel";this.$.Re(802602464,Jd.a.Yb,8,l)};Ce.prototype.mte=function(){var l=this;if(this.fa.pc){var K=this.$;K.isEditMode&&og.TaskExtensions.Da(this.rJ.value,function(ka){l.MEa(K.workbookContext.ClientUrl,Wd.AFrameworkApplication.X2,1,2,!1,new Wg.a(function(){return ka.result}))},
this.ma,3)}};Ce.prototype.nte=function(){var l=this;this.fa.pc&&og.TaskExtensions.Da(this.rJ.value,function(K){l.MEa(l.$.workbookContext.ClientUrl,Wd.AFrameworkApplication.X2,1,l.$.isEditMode?2:0,!1,new Wg.a(function(){return K.result}))},this.ma,3)};Ce.prototype.openInExcelClient=function(){var l=this;this.fa.pc&&(this.$.isEditMode||og.TaskExtensions.Da(this.rJ.value,function(K){l.MEa(l.$.workbookContext.ClientUrl,Wd.AFrameworkApplication.X2,1,0,!1,new Wg.a(function(){return K.result}))},this.ma,
3))};Ce.prototype.openInBrowser=function(){var l=this;this.fa.pc&&og.TaskExtensions.Da(this.rJ.value,function(K){l.MEa(l.$.workbookContext.ClientUrl,Wd.AFrameworkApplication.X2,1,5,!1,new Wg.a(function(){return K.result}))},this.ma,3)};Ce.prototype.downloadFile=function(l){var K=this.pme(l);this.r$.downloadFile(K,l)};Ce.prototype.uuf=function(l,K){K=void 0===K?0:K;if(this.fa.pc){var ka=this.$;ai.a(ka).iKa?this.vuf(l,ka):0<K?this.Ukj(l,ka,K):this.MSf(ka)}};Ce.prototype.MEa=function(l,K,ka,$a,Lb,bc){this.$.Db.MJ=
!yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.mc.inWebPart;this.OLe=Lb;this.i_b=null;this.z1c=!1;this.iBg(l,K,$a,Lb,bc)};Ce.prototype.h_b=function(l){var K=this.$.mc;qd.ULS.sendTraceTag(38367435,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",K.inEmbedView,K.inWebPart,K.isDivSyndicated,this.$.isEditMode?Ci.a.edit:Ci.a.view);return Ce.w6e()?(this.JZb(),Bf.X1c(this.OSa,this.pB,this.options,1,Object(fd.a)(this,
this.dri,"onEditInClientSuccessForWebPart"),Object(fd.a)(this,this.cri,"onEditInClientFailureForWebPart"),!1,Wd.AFrameworkApplication.ha.ta("OICEncodeUrlIsEnabled")),32):ne.prototype.h_b.call(this,l)};Ce.prototype.Qih=function(){this.XHf();var l=this.$;if(!this.fa.mc.inWebPart&&this.fa.pc&&!l.isEditMode){var K=new Ui.a(2145659238,Jd.a.Yb,this.$.jd,0,null);this.hre=fk.a.instance.create(function(){l.Na.Xb(K)},0,Kj.a.kCi)}};Ce.prototype.dispose=function(){this.fa&&this.fa.xk(Object(fd.a)(this,this.ed,
"onSessionIdChanged"));Ei.a.rc([this.Qa,this.hre,this.Dm]);this.$=this.fa=null};Ce.prototype.djh=function(){this.XHf()};Ce.prototype.taf=function(){var l=this;fk.a.instance.create(function(){l.$.Na.Xb(new Ui.a(-2028960985,Jd.a.Yb,0,30,null))},0,Kj.a.lCi,!0,!0)};Ce.prototype.dBg=function(l){var K=this.$,ka=ai.a(this.$).ld.activityState;ka[sk.a.uce]=!0;K.isEditMode&&this.fa.pc?(this.JZb(),Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!1);ka[Si.a.kp]=cg.a.LZb;ka[sk.a.rng]=l;ka[Mh.a.e6c]=!0;K.isEditMode&&
(ka[Mh.a.DS]=1,ka[Mh.a.GX]=!0,ka[uj.a.NUb]=!0,ka[uj.a.cOc]=!0);ka[sk.a.xce]=1455037301}))):this.VBf(l)};Ce.prototype.sVf=function(){var l=Wd.AFrameworkApplication.X2;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.uzb(l,!0)){var K=this.$.fa.mc;qd.ULS.sendTraceTag(7353228,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",l,K.inEmbedView,K.inWebPart,K.isDivSyndicated,this.$.isEditMode?Ci.a.edit:Ci.a.view)}}else this.r$.downloadFile(l,-2028960985);this.z1c=!0;
this.JZb()};Ce.prototype.q$h=function(){this.ouc.Oif&&this.ouc.Aec(1)};Ce.prototype.r$h=function(){this.ouc.Oif&&xe.HelperMethods.wf(xd.a.UY(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};Ce.prototype.A$h=function(){xe.HelperMethods.wf(xd.a.UY(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};Ce.prototype.B$h=function(){xe.HelperMethods.wf(xd.a.UY(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};Ce.prototype.pme=function(l){var K=
new Sys.StringBuilder,ka=this.$.workbookContext,$a=this.$.Ba;K.append(this.$.G_);K.append($a.FileHandlerRelativeUri);K.append("?id=");K.append(encodeURIComponent(Ig.a.nEb(ka.WorkbookUri,"sc")));this.$.fa.pc&&(K.append("&sessionId="),K.append(encodeURIComponent(this.$.fa.sessionId)));switch(l){case -974518828:K.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:K.append("&workbookType=FullWorkbook");break;case -1059172980:K.append("&workbookType=FullWorkbook&workbookFileType=Odf");
break;default:K.clear()}rj.a.yEa(K,$a);return K.toString()};Ce.prototype.VOg=function(){oj.a.instance.qKg();var l=this.$.Ba;MSOJS.ClientUtils.InitUrls(l.RoamingAppsX86RootUrl,l.RoamingAppsControlInstallerUrl,l.RoamingAppsFirefoxExtensionUrl)};Ce.prototype.ed=function(){fj.a.yg(ai.a(this.$).ld.activityState,Mh.a.Zrd)||this.r$.reset()};Ce.prototype.XHf=function(){var l=this.$;this.fa.pc||sh.a.Dyd(l,ai.a(l).ld);this.JZb();this.i_b&&this.i_b(this,this.z1c);l.frame.oz.$l(this.$.frame.G$());l.frame.vW.$l(this.$.frame.G$());
l.Db.MJ=!1;ag.g(l).focus()};Ce.prototype.iBg=function(l,K,ka,$a,Lb){var bc=this.$;Wd.AFrameworkApplication.za&&!Ce.w6e()&&(bc.frame.oz.jn(bc.frame.G$()),bc.frame.vW.jn(bc.frame.G$()));ne.prototype.MEa.call(this,l,K,1,ka,$a,Lb)};Ce.prototype.JZb=function(){var l=this.$;ai.a(l).pi.activityName===cg.a.openInExcelClient&&ai.a(l).ld.WI()};Ce.prototype.Ifj=function(){var l=Bd.a.Ad(1,0,653,654,0,1341525452,"OpenInExcelActiveXError");Qg.a(this.$).Yt([l])};Ce.prototype.dri=function(l){this.WGf(l)};Ce.prototype.cri=
function(){this.Ifj()};Ce.prototype.Ukj=function(l,K,ka){var $a=this,Lb=null,bc=window.setTimeout(function(){ai.a(K).$mc(Lb);$a.MSf(K)},ka);Lb=function(){ai.a(K).iKa&&(ai.a(K).$mc(Lb),window.clearTimeout(bc),$a.vuf(l,K))};ai.a(K).fPc(Lb)};Ce.prototype.MSf=function(l){var K=Bd.a.Ad(1,1,0,668,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Qg.a(l).Yt([K])};Ce.prototype.vuf=function(l,K){var ka=this;Qg.a(K).Nr(new Rg.a(cg.a.xx,5,function(){K.xH(!1);var $a=ai.a(K).ld,Lb=$a.activityState;Lb[Si.a.kp]=
cg.a.GAe;Lb[$i.a.PUb]=K.fa.mc.hasUnsupportedFeaturesForEdit;Lb[Hi.a.XNc]=l;$a.it(Bd.a.n$(ka.businessBar.f2c,[1437034227]))}))};Ce.w6e=function(){return 1<Zf.a.getRegisteredEwaInstances().length};Jl.Object.defineProperties(Ce.prototype,{x0e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},ma:{configurable:!0,enumerable:!0,get:function(){this.Dm=this.Dm||new ak.a;return this.Dm.token}},led:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},rXf:{configurable:!0,
enumerable:!0,get:function(){return this.fa.mc.inWebPart}}});Object(fe.a)(Ce,"OpenInExcelOperation",ne,[339,7]);var Mi=Ie.a;Cm(zf,Mi);zf.prototype.create=function(){var l=this;if(this.$.ea.Ea(55,void 0))this.Jb(this.$.ea.Ea(55,void 0));else{var K=Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),ka=Vf.GetServiceTaskFactory.Xa(this.$.ea,5,4,this.vb,"Microsoft.Office.Excel.WebUI.Client.BusinessBar.IBusinessBarManager");og.TaskExtensions.Da(we.Task.WAA(K,ka),function(){l.Jb(new Ce(l.$,
new Wg.a(function(){return Vf.GetServiceTaskFactory.create(l.$.ea,137,l.ma,l.vb,"Postmessage.IHostPostmessenger")}),ka.result))},this.ma,3)}};zf.UOg=function(){zf.hjf||(zf.hjf=!0,(new ac).$h(Dd.a.instance),Dd.a.instance.resolve("Common.IOfficeTrialExperience").Rg(),Dd.a.instance.resolve("Common.IMacOfficeOffer").Rg())};zf.hjf=!1;Object(fe.a)(zf,"OpenInClientFactory",Ie.a,[]);var xh=b(114),lj=b(385),zj=xh.a;Cm(mg,zj);mg.prototype.execute=function(l){var K=Object(mi.a)(11,l.Je);og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(K.ea,
56,K.ma,0,"Microsoft.Office.Excel.WebUI.Client.IOpenInExcelOperation"),function(ka){K.downloadCopyOnOpenInClient?(l.activityState[lj.a.vce]=!0,ka.result.sVf()):ka.result.dQg()},K.ma,3);return 1};Object(fe.a)(mg,"OpenInExcelClientActivity",xh.a,[]);var kf=Ie.a;Cm(Yf,kf);Yf.prototype.create=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){l.Jb(new mg(cg.a.openInExcelClient,cg.a.idle))},this.ma)};Object(fe.a)(Yf,
"OpenInExcelClientActivityFactory",Ie.a,[]);var rd=Zh.a;Cm(Rd,rd);Rd.prototype.initialize=function(l){rd.prototype.initialize.call(this,l)};Rd.prototype.execute=function(l){this.di=l;l=Object(mi.a)(11,this.di.Je);this.rob(l);return 1};Rd.prototype.aI=function(l){rd.prototype.aI.call(this,l)};Rd.prototype.rob=function(){var l=this;this.subscribe(this.di,Object(fd.a)(this,this.pCb,"passwordProtectedFilePasswordInputDialogDisposing"),function(K){l.Qvd.add_disposing(K)})};Rd.prototype.pCb=function(l){this.unsubscribe(function(K){l.remove_disposing(K)});
this.di.activityState[li.a.u1]=0};Object(fe.a)(Rd,"PasswordProtectedFileActivity",Zh.a,[]);var ie=b(522),Lh=ie.a;Cm(Gd,Lh);Gd.prototype.x8a=function(l){this.ioa=l};Gd.prototype.z2=function(){var l={};l[ie.a.description]=Te.a.instance.da(1889);l[ie.a.Yka]=Te.a.instance.da(1885);l[ie.a.Ovf]=Te.a.instance.da(1907);l[ie.a.Mvf]=Te.a.instance.da(1908);l[ie.a.Nvf]=Te.a.instance.da(1886);l[ie.a.zed]=Te.a.instance.da(1892);l[ie.a.kke]=Te.a.instance.da(1593);l[ie.a.dBj]=Te.a.instance.Ya(25);l[ie.a.V4f]=Object(fd.a)(this,
this.NRa,"verifySubmittedPassword");return l};Gd.prototype.Nra=function(){var l={};l[Pa.a.d2b]=this.xc;l[ie.a.rle]=this.z2();return l};Gd.prototype.Nh=function(){this.lc=1;this.initializeAndShow(this.$n,Object(fd.a)(this,this.x8a,"reactPasswordDialogHandler"),this.Nra())};Jl.Object.defineProperties(Gd.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},fpb:{configurable:!0,enumerable:!0,get:function(){return this.ioa}},$n:{configurable:!0,enumerable:!0,get:function(){return Te.a.instance.da(1888)}}});
Object(fe.a)(Gd,"PasswordProtectedFilePasswordInputDialog",ie.a,[]);var M=b(303);Cm(me,Gd);me.prototype.x8a=function(l,K){Gd.prototype.x8a.call(this,l,K);qd.ULS.sendTraceTag(557446528,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",l)};me.prototype.NRa=function(l,K){this.passwordToModify=l;var ka={};ka.FileModifyPassword=Lf.a.rf(l);Ef.mb(this.$.ra.xa,ka,this.hBi(K),this.gBi(K),null,null)};me.prototype.z2=function(){var l=Gd.prototype.z2.call(this);
l[ie.a.zed]=Te.a.instance.da(1893);l[ie.a.description]=Te.a.instance.Ya(24);return l};me.prototype.Nh=function(){Xg.b().x2c("PasswordToModifyDialogShown");qd.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");Gd.prototype.Nh.call(this)};me.prototype.hBi=function(l){var K=this;return function(ka){Bd.a.dh(ka.Errors,[-2019873242])&&K.u2b(K.job());if(!ka||M.a(ka))if(0<K.iEd&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5683438_RetryVerifyPasswordToModify"))K.iBf(l);
else{qd.ULS.sendTraceTag(557446499,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",Bd.a.fd(ka.Errors));K.$.fa.Wo(ka.Errors);K.hide();return}K.s1d=ka.Result;K.Ecc&&(Xg.b().VLd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),qd.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
l(K.Ecc?0:1)}};me.prototype.gBi=function(l){var K=this;return function(){0<K.iEd&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5683438_RetryVerifyPasswordToModify")?K.iBf(l):(qd.ULS.sendTraceTag(557446498,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),l(3))}};me.prototype.iBf=function(l){--this.iEd;this.NRa(this.passwordToModify,l)};me.prototype.job=function(){return Bd.a.Ad(1,0,1592,1593,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};
me.prototype.Pvf=function(){this.$.isEditMode&&this.Ecc&&(Xg.b().x2c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.nl(Object(fd.a)(this,this.Pvf,"passwordToModifyWorkbookOpenedinEdit")))};Jl.Object.defineProperties(me.prototype,{Ecc:{configurable:!0,enumerable:!0,get:function(){return this.s1d}},$n:{configurable:!0,enumerable:!0,get:function(){return Te.a.instance.da(1890)}}});Object(fe.a)(me,"PasswordProtectedFileModifyPasswordInputDialog",Gd,[]);Cm(be,Rd);be.prototype.rob=function(l){this.Qvd=
new me(l);Rd.prototype.rob.call(this,l)};be.prototype.pCb=function(l,K){var ka=l.fpb,$a=l.Ecc,Lb=l.passwordToModify;Rd.prototype.pCb.call(this,l,K);this.di.nwa([2001366804]);switch(ka){case 1:$a?(K=Object(mi.a)(11,this.di.Je),this.di.activityState[li.a.Lce]=Lf.a.rf(Lb),this.di.activityState[li.a.QVa]=!0,l.passwordToModify="",this.mh(K.isEditMode?cg.a.Vj:this.G1b)):qd.ULS.sendTraceTag(557446531,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.So();break;case 0:this.di.activityState[li.a.qr]=!1;this.mh(this.gJ);this.So();break;default:qd.ULS.sendTraceTag(557446530,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",ka)}};Object(fe.a)(be,"PasswordProtectedFileModifyActivity",Rd,[]);var ya=Ie.a;Cm(Yd,ya);Yd.prototype.create=function(){this.Jb(new be(this.activityName,this.HT,this.gJ))};Yd.la=function(l){l.ea.La(434,new Yd(cg.a.oCb,cg.a.ybb,cg.a.oFa,l))};Object(fe.a)(Yd,"PasswordProtectedFileModifyActivityFactory",
Ie.a,[]);Cm(pd,Gd);pd.prototype.NRa=function(l,K){this.password=l;K(0)};pd.prototype.z2=function(){var l=Gd.prototype.z2.call(this);this.y9e&&(l[ie.a.J9g]=1);return l};pd.prototype.Nh=function(){qd.ULS.sendTraceTag(558735873,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.y9e);Gd.prototype.Nh.call(this);Qg.a(this.$).Ege()};Object(fe.a)(pd,"PasswordProtectedFileOpenPasswordInputDialog",Gd,[]);var Eb=b(155),jc=b(133);Cm(Wc,Rd);
Wc.prototype.rob=function(l){var K=Bd.a.dh(this.di.errors,[1217361942]);this.Qvd=new pd(l,K);l.Yac||l.bze();Rd.prototype.rob.call(this,l)};Wc.prototype.pCb=function(l,K){var ka=l.password;l.password="";var $a=l.fpb;Rd.prototype.pCb.call(this,l,K);this.di.activityState[li.a.gOc]=Lf.a.rf(ka);yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5700049_PasswordProtectedWorkbookEditMode")?this.di.activityState[li.a.QVa]=!0:(this.di.activityState[li.a.qr]=!1,yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5288832_TrackPasswordProtectedFilesOpenAndEditModeSupport")&&
mh.Health.instance.recordQosError(Eb.a.passwordProtectedWorkbook,[jc.a.unsupportedFeatures],!1,!1,!1,!0,null));this.di.nwa([110414285,1217361942]);qd.ULS.sendTraceTag(558735875,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",$a);switch($a){case 1:this.mh(this.G1b);this.So();break;case 0:this.mh(this.gJ),this.So()}};Object(fe.a)(Wc,"PasswordProtectedFileOpenActivity",Rd,[]);var od=Ie.a;Cm(id,od);id.prototype.create=function(){this.Jb(new Wc(this.activityName,
this.HT,this.gJ))};id.la=function(l){l.ea.La(386,new id(cg.a.jkc,cg.a.Vj,cg.a.Ck,l))};Object(fe.a)(id,"PasswordProtectedFileOpenActivityFactory",Ie.a,[]);var Fe=b(375),Oe=Fe.a;Cm(uc,Oe);uc.prototype.Us=function(l,K){this.ioa=l;Oe.prototype.Us.call(this,l,K)};uc.prototype.ar=function(){Oe.prototype.ar.call(this);this.lc=9;var l=this.eCh();this.Dc(1,Te.a.instance.da(1591));this.Dc(2,Te.a.instance.da(941));this.Hl(Te.a.instance.da(674),sd.a.Lq(l),this.icon,Object(fd.a)(this,this.Us,"standardDialogHandler"))};
uc.prototype.eCh=function(){return String.format(Te.a.instance.da(675))};Jl.Object.defineProperties(uc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},fpb:{configurable:!0,enumerable:!0,get:function(){return this.ioa}}});Object(fe.a)(uc,"LegacySharedWorkbookDialog",Fe.a,[]);var Qe=Zh.a;Cm(gc,Qe);gc.prototype.initialize=function(l){Qe.prototype.initialize.call(this,l)};gc.prototype.execute=function(l){this.di=l;this.tTg();return 1};gc.prototype.aI=function(l){Qe.prototype.aI.call(this,
l)};gc.prototype.tTg=function(){var l=Object(mi.a)(11,this.di.Je),K=Bd.a.CXa([-573864504]);K[0].HelpDescription=Te.a.instance.da(677);K[0].HelpTopicId=zh.a.Y$h;var ka=new uc(l,K[0]);this.subscribe(this.di,Object(fd.a)(this,this.X$h,"legacySharedDialogDisposing"),function($a){ka.add_disposing($a)})};gc.prototype.X$h=function(l){var K=this.cs.ld,ka=Object(mi.a)(11,K.Je);var $a=l.fpb;this.unsubscribe(function(Dc){l.remove_disposing(Dc)});for(var Lb=0,bc=K.errors.length;Lb<bc;Lb++)-573864504===K.errors[Lb].MessageId&&
K.eka(K.errors[Lb]);switch($a){case 1:ka.fa.evc=!0;qd.ULS.sendTraceTag(540360835,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.mh(ka.isEditMode?cg.a.PJb:this.G1b);this.So();break;case 2:this.mh(cg.a.openInExcelClient);this.So();break;case 0:K.activityState[li.a.qr]=!1,this.mh(this.gJ),this.So()}};Object(fe.a)(gc,"LegacySharedWorkbookActivity",Zh.a,[]);var $f=Ie.a;Cm(wb,$f);wb.prototype.create=function(){this.Jb(new gc(this.activityName,
this.HT,this.gJ))};wb.la=function(l){l.ea.La(460,new wb(cg.a.Xxb,cg.a.ybb,cg.a.oFa,l))};Object(fe.a)(wb,"LegacySharedWorkbookActivityFactory",Ie.a,[]);Zb.prototype.$c=function(){return!1};Zb.prototype.Jc=function(l,K){if(!yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(K.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Ry;default:return!1}};Zb.prototype.executeCommand=function(l,K){l=og.TaskExtensions.um();K=K.command;switch(K){case 642419866:this.presentModeManager.tsc(!this.presentModeManager.Ry);
this.presentModeManager.kh("TogglePresentMode");break;case 588342182:this.presentModeManager.u4a=!this.presentModeManager.u4a;this.presentModeManager.JTf(this.presentModeManager.u4a,"TogglePresentModeOverlay");this.presentModeManager.kh("TogglePresentModeOverlay");break;default:l=h.a(K)}return l};Zb.prototype.gd=function(){return!1};Object(fe.a)(Zb,"PresentModeCommandHandler",null,[159]);var Rf=Df.a;Cm(Zd,Rf);Zd.prototype.Rd=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.Xa(this.$.ea,
423,424,this.vb,"Microsoft.Office.Excel.WebUI.Client.PresentMode.IPresentModeManager"),function(K){l.Hd([new Zb(l.$,K.result)])},this.ma,3)};Zd.la=function(l){Df.a.ie(420,new Zd(l))};Object(fe.a)(Zd,"PresentModeCommandHandlerFactory",Df.a,[]);var uh=b(135),Tg=b(113);jd.jdh="ewa-presentMode-overlay";jd.kdh="ewa-presentMode-panel-container";jd.ldh="ewa-presentMode-rowHdrParent-container";Object(fe.a)(jd,"CssClassNames",null,[]);var yh=b(18),Ah=b(143),aj=b(284),ei=b(110),mj=b(122),tj=b(429),nh=b(11),
Fi=b(95),eh=b(336),gj=b(108),Vj=b(408),si=b(254),sj=b(241),Oj=b(174);Ma.prototype.dispose=function(){this.$=this.uxd=this.vxd=this.Lba=this.yNa=null};Ma.prototype.rVh=function(){var l=this;window.requestAnimationFrame(function(){l.Lba=document.createElement("div");l.$.yy.insertBefore(l.Lba,l.$.yy.lastChild);l.Lba.id=l.$.Mb+vc.a.K5b;Sys.UI.DomElement.addCssClass(l.Lba,jd.kdh);l.vxd=document.getElementById(l.$.Mb+vc.a.T_c);l.uxd=[l.$.Xz];l.isInitialized=!0});this.yNa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.yNa.initializePresentModeFloatie()};Ma.prototype.aJh=function(){var l={};l.PollingCountPerCaller=Tg.a.toJSON(this.Fkc);l.PollingDurationPerCaller=Tg.a.toJSON(this.Gkc);return l};Ma.prototype.wKd=function(l){this.isInitialized?l?(this.yNa.showPresentModeFloatie(this.Lba,this.vxd,this.uxd),this.kh("ShowOrHideFloatiePanel"),this.lQi()):(this.yNa.hidePresentModeFloatie(),this.Guj()):qd.ULS.sendTraceTag(546060440,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};
Ma.prototype.kh=function(l){this.Nwf=xe.HelperMethods.Kc();this.tNa=l;this.Pje=Oj.AsyncMethodContext.kx(Object(fd.a)(this,this.Kl,"pollForStateAndUpdateInternal"),100,Kj.a.jIi+l,this.Pje)};Ma.prototype.Ye=function(l,K){if(K)return!1;l=nh.DOMElementExtensions.Cl(this.Lba.querySelectorAll(nh.DOMElementExtensions.gq));if(!l)return qd.ULS.sendTraceTag(538551379,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;l.focus();return!0};Ma.prototype.Lh=
function(l){return nh.DOMElementExtensions.jf(this.Nb,l)};Ma.prototype.vi=function(){};Ma.prototype.ei=function(){};Ma.prototype.onKeyDown=function(l){l=l.Ga;if(9===l.keyCode){var K=this.Lba.querySelectorAll(nh.DOMElementExtensions.gq),ka=nh.DOMElementExtensions.Cl(K);K=nh.DOMElementExtensions.Iy(K);nh.DOMElementExtensions.Kca(l,ka,K);return!0}return!1};Ma.prototype.lQi=function(){var l=this;si.a(this.$).$g(this);this.$.ea.ub(15,function(K){l.ewaAccessibilityManager=K;l.ewaAccessibilityManager.mode=
5});V.KeyInputManager.instance.qa(ef.a.Rb,this.Nb,Object(fd.a)(this,this.onKeyDown,"onKeyDown"))};Ma.prototype.Guj=function(){si.a(this.$).UA(this);ag.g(this.$).K_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);V.KeyInputManager.instance.Ca(ef.a.Rb,this.Nb,Object(fd.a)(this,this.onKeyDown,"onKeyDown"))};Ma.prototype.Kl=function(){var l=this,K=[];this.$.ea.ub(337,function(ka){l.yNa.getPresentModeFloatieControlsMap().then(function($a){for(var Lb={},bc=0;bc<$a.length;bc++)Lb[$a[bc].controlId]=
$a[bc].modelType;K.push.apply(K,ka.Tba.E1a(Lb));0<K.length&&appChrome.api.dispatch(K);l.n1i()})})};Ma.prototype.n1i=function(){var l=xe.HelperMethods.Kc()-this.Nwf,K=this.Gkc[this.tNa]?this.Gkc[this.tNa]:0;this.Gkc[this.tNa]=K>l?K:l;this.Fkc[this.tNa]=this.Fkc[this.tNa]?this.Fkc[this.tNa]+1:1};Jl.Object.defineProperties(Ma.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return this.Lba}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.yNa.updatePresentModeFloatieShyState(2);
return!!this.Lba}},he:{configurable:!0,enumerable:!0,get:function(){return sj.a.Yxf}}});Object(fe.a)(Ma,"PresentModeFloatieManager",null,[347,135,7]);var Vi=b(59);Object(fe.a)(yb,"OverlayCavityInfo",null,[]);Object(fe.a)(kb,"OverlayContainerInfo",null,[]);Object(fe.a)(Pb,"PresentModeOverlayProps",null,[]);Ue.prototype.$Vh=function(){var l=this;this.wxd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){l.MXa=Array(5);for(var K,
ka,$a=1;4>=$a;$a++)K=document.createElement("div"),nh.DOMElementExtensions.setVisible(K,!1),K.id=String.format("{0}-{1}","PresentModeOverlay",$a),nh.DOMElementExtensions.toggleCssClass(K,jd.jdh,!0),ka=l.gridView.Yf($a).domElement,ka.insertBefore(K,ka.firstChild),l.MXa[$a]=K})};Ue.prototype.ITf=function(l){l&&this.Qxj();for(var K=1;4>=K;K++)this.Q6e(K)&&nh.DOMElementExtensions.setVisible(this.MXa[K],l);nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-overlay",l)};Ue.prototype.Qxj=
function(){for(var l=this.QGg(),K,ka=1;4>=ka;ka++)K=ka,l[K]&&this.wxd.showOverlayWithCavity(this.MXa[K],l[K])};Ue.prototype.dispose=function(){this.wxd=this.MXa=this.gridView=this.$=null};Ue.prototype.QGg=function(){for(var l,K,ka=ag.g(this.$).rtl,$a,Lb=Array(5),bc=1;4>=bc;bc++)K=bc,this.Q6e(bc)&&(l=this.gridView.Yf(bc),$a=this.gridView.ga.Sa.uja?this.Kzh(bc,l,ka):this.BAh(bc,l,ka),l=this.cWg(l),Lb[K]=this.vWg(this.MXa[K].id,l,$a));return Lb};Ue.prototype.Q6e=function(l){return this.gridView.$a.zJ(l)};
Ue.prototype.cWg=function(l){return Object.assign(new kb,{width:l.pn.width,height:l.pn.height})};Ue.prototype.vWg=function(l,K,ka){return Object.assign(new Pb,{containerId:l,overlayContainerInfo:K,overlayCavityInfos:ka?[ka]:null})};Ue.prototype.Kzh=function(l,K,ka){var $a=ag.g(this.$).ga.Sa.nc;if(!$a)return qd.ULS.sendTraceTag(559742997,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var Lb=$a.extension.Nzh(l);l=Lb.tAa;$a=Lb.rotation;var bc=
Lb.translateX;var Dc=Lb.translateY;return Lb.returnValue?(Lb=l.x-K.pn.x,Object.assign(new yb,{left:(ka?K.pn.width-(Lb+l.width):Lb)-3+1,top:l.y-K.pn.y-3+1,width:l.width+5,height:l.height+5,angle:$a,translateX:bc,translateY:Dc})):null};Ue.prototype.BAh=function(l,K,ka){l=this.gridView.Sb.Rrb(this.gridView.ga.ya.activeRange,l)||Vi.a.g3;if(!l.Of(K.pn))return null;var $a=l.x-K.pn.x;return Object.assign(new yb,{left:ka?K.pn.width-($a+l.width)-2:$a-3,top:l.y-K.pn.y-3,width:l.width+5,height:l.height+5})};
Object(fe.a)(Ue,"PresentModeOverlayRenderer",null,[346,7]);var ci=ie.a;Cm(Ke,ci);Ke.prototype.hide=function(){ci.prototype.hide.call(this);uh.a.tw(vc.a.NTf,"false",this.$.Ba.ShowPresentModeWelcomeDialogCookieExpirationDays)};Ke.prototype.kIi=function(){this.Mba.wKd(!0)};Jl.Object.defineProperties(Ke.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(fe.a)(Ke,"PresentModeWelcomeDialog",ie.a,[]);he.requestFullscreen=function(l){l.webkitRequestFullscreen?
l.webkitRequestFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():l.mozRequestFullScreen?l.mozRequestFullScreen():l.requestFullscreen?l.requestFullscreen():qd.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};he.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():
qd.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Jl.Object.defineProperties(he,{Rph:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},Sph:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":
"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},U1h:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(fe.a)(he,"FullscreenUtils",null,[]);Zc.prototype.tsc=function(l){var K=this;this.Ry!==l&&
(this.u1d=l,this.u4a=this.Ry,this.H2e(),this.LHb=this.ySf(),window.requestAnimationFrame(function(){nh.DOMElementExtensions.toggleCssClass(K.$.sr,"ewr-presentMode-transition",!0);$addHandler(K.D_a,"transitionend",K.Wma);K.Qgj(!l);K.oDi();nh.DOMElementExtensions.toggleCssClass(K.$.sr,"ewr-presentMode-on",l);K.Pgj(l);Ah.b(K.$).GTf(K.Ry);Ah.c(K.$).GTf(K.Ry);K.$.Dla();K.ANa.ITf(K.LHb);if(K.Ry){K.$Wa();uh.a.get(vc.a.NTf)?K.Mba.wKd(K.Ry):K.clc=new Ke(K.$,K.Mba);var ka=Vj.b(K.$);ka&&(K.qEd=ka.o2c(!1));K.Xxf=
xe.HelperMethods.Kc()}else K.Mba.wKd(l),K.qEd&&(ka=Vj.b(K.$))&&(ka.o2c(!0),K.qEd=!1),K.X1b(),K.qdi()}))};Zc.prototype.JTf=function(l,K){this.BKd=l;this.vda(K)};Zc.prototype.kh=function(l){this.Mba.kh(l)};Zc.prototype.dispose=function(){this.X1b();this.ANa&&(this.ANa.dispose(),this.ANa=null);this.gridView=this.$=null};Zc.prototype.Qgj=function(l){var K=this.$.ea.Ea(25,void 0);void 0===K||null===K?qd.ULS.sendTraceTag(542986703,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):
l?K.nsc():K.p$b()};Zc.prototype.oDi=function(){var l=this;nh.DOMElementExtensions.toggleCssClass(document.getElementById(Wd.AFrameworkApplication.M_a),yh.a.zu,this.Ry);nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-on",this.Ry);this.Tgj(this.Ry);this.gridView.Mhd=!this.Ry;this.fyj();this.$.ea.ub(32,function(K){K.Ayj(l.Ry)});mj.b(this.$,function(K){K.D2f(l.Ry)})};Zc.prototype.Tgj=function(l){if(this.TCb)if(l){if(l=Object(mi.a)(Fi.a,this.$.sa))nh.DOMElementExtensions.toggleCssClass(this.$.sr,
"ewr-presentMode-on-headers-off",!l.headersVisible),nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-on-rtl",ag.g(this.$).rtl);this.Lvc(0)}else Sys.UI.DomElement.removeCssClass(this.$.sr,"ewr-presentMode-on-headers-off"),Sys.UI.DomElement.removeCssClass(this.$.sr,"ewr-presentMode-on-rtl"),this.Lvc(1)};Zc.prototype.Lvc=function(l){var K=Object(mi.a)(Fi.a,this.$.sa);if(K){var ka=parseInt(this.$.yy.style.right);if(1===l||2===l){if(isNaN(ka)||ka<this.pZa)return;ka-=this.pZa}l&&2!==l||
(l=K.headersVisible,K=ag.g(this.$).rtl,l=l?K?0:32:12,ka=isNaN(ka)?l:ka+l,this.pZa=l);this.$.yy.style.right=xe.HelperMethods.Ub(ka);this.fte=ka}};Zc.prototype.fyj=function(){var l=document.getElementById(this.$.Mb+vc.a.y1b).parentNode;nh.DOMElementExtensions.toggleCssClass(l,jd.ldh,this.Ry)};Zc.prototype.ESi=function(){nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-transition",!1);$removeHandler(this.D_a,"transitionend",this.Wma)};Zc.prototype.initialize=function(l){this.ANa=new Ue(l);
this.ANa.$Vh();this.Mba=new Ma(l);this.Mba.rVh();this.D_a=document.getElementById("MainApp");this.sMe=Object(fd.a)(this,this.bsi,"onFullScreenChangeEventHandler");$addHandler(this.D_a,he.Rph,this.sMe);l=Object(fd.a)(this,this.csi,"onFullScreenErrorEventHandler");$addHandler(this.D_a,he.Sph,l);this.TCb||(this.TCb=document.createElement("div"),this.TCb.className="ewa-presentMode-right-frame",this.$.Xz.appendChild(this.TCb));this.Wma=Object(fd.a)(this,this.ESi,"removeTransitionCss")};Zc.prototype.$Wa=
function(){this.gridView.ga.N8(Object(fd.a)(this,this.sq,"onSelectionStarted"));this.gridView.ga.G1(Object(fd.a)(this,this.Ih,"onSelectionEnded"));this.gridView.zc.Cm(Object(fd.a)(this,this.tk,"onEditStarted"));this.gridView.zc.mt(Object(fd.a)(this,this.Zk,"onEditEnded"));this.gridView.AD(Object(fd.a)(this,this.Uo,"onCurrentSelectionModeChanged"));this.gridView.view.nt(Object(fd.a)(this,this.jw,"onVisibleAreaChanged"));this.gridView.mkb(Object(fd.a)(this,this.j5,"onBeforeActiveItemCleanup"));this.gridView.Ha.XF(Object(fd.a)(this,
this.jm,"onBlockCacheItemEvicted"));this.gridView.Ha.Dq(Object(fd.a)(this,this.Le,"onBlockCacheItemChanged"));this.$.Aa.Vf(Object(fd.a)(this,this.Ii,"onActiveSheetChanged"));this.$.Aa.fWa(Object(fd.a)(this,this.mba,"onActiveItemPanesChanged"));this.$.Aa.Sfa(Object(fd.a)(this,this.vBb,"onSheetInserted"));this.$.zD(Object(fd.a)(this,this.kk,"onContentAreaResized"));this.$.Nk(Object(fd.a)(this,this.sd,"onWorkbookOpened"));var l=Object(mi.a)(eh.a,this.$.Aa);l=Ml(l.items);for(var K=l.next();!K.done;K=
l.next())K.value.Hkb(Object(fd.a)(this,this.gxa,"onSheetOptionsChanged"))};Zc.prototype.X1b=function(){this.gridView&&(this.gridView.ga.oca(Object(fd.a)(this,this.sq,"onSelectionStarted")),this.gridView.ga.q_(Object(fd.a)(this,this.Ih,"onSelectionEnded")),this.gridView.zc.mm(Object(fd.a)(this,this.tk,"onEditStarted")),this.gridView.zc.Qs(Object(fd.a)(this,this.Zk,"onEditEnded")),this.gridView.aF(Object(fd.a)(this,this.Uo,"onCurrentSelectionModeChanged")),this.gridView.view.Tr(Object(fd.a)(this,this.jw,
"onVisibleAreaChanged")),this.gridView.qEb(Object(fd.a)(this,this.j5,"onBeforeActiveItemCleanup")),this.gridView.Ha.zH(Object(fd.a)(this,this.jm,"onBlockCacheItemEvicted")),this.gridView.Ha.Jp(Object(fd.a)(this,this.Le,"onBlockCacheItemChanged")));if(this.$){this.$.Aa.wg(Object(fd.a)(this,this.Ii,"onActiveSheetChanged"));this.$.Aa.X8a(Object(fd.a)(this,this.mba,"onActiveItemPanesChanged"));this.$.Aa.ula(Object(fd.a)(this,this.vBb,"onSheetInserted"));this.$.AH(Object(fd.a)(this,this.kk,"onContentAreaResized"));
this.$.nl(Object(fd.a)(this,this.sd,"onWorkbookOpened"));var l=Object(mi.a)(eh.a,this.$.Aa);l=Ml(l.items);for(var K=l.next();!K.done;K=l.next())K.value.xCd(Object(fd.a)(this,this.gxa,"onSheetOptionsChanged"))}};Zc.prototype.kk=function(){var l=this;parseInt(this.$.yy.style.right)!==this.fte&&window.requestAnimationFrame(function(){l.Lvc(0);l.$.Rxa(aj.a.WY("PresentModeManager.OnContentAreaResized"))})};Zc.prototype.gxa=function(){var l=this,K=Object(mi.a)(Fi.a,this.$.sa);if(K&&this.Ry){this.gridView.Mhd=
!1;K=K.headersVisible;var ka=ag.g(this.$).rtl;nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-on-headers-off",!K);nh.DOMElementExtensions.toggleCssClass(this.$.sr,"ewr-presentMode-on-rtl",ka);(12!==this.pZa&&!K||32!==this.pZa&&K&&!ka||0!==this.pZa&&K&&ka)&&window.requestAnimationFrame(function(){l.Lvc(2)})}};Zc.prototype.sd=function(){this.H2e();this.kh("OnWorkbookOpened");qd.ULS.sendTraceTag(538826503,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
Zc.prototype.sq=function(){this.Qjd=!0;this.vda("OnSelectionStarted")};Zc.prototype.Ih=function(){this.Qjd=!1;this.vda("OnSelectionEnded");this.yKf()};Zc.prototype.tk=function(){this.vda("OnEditStarted")};Zc.prototype.Zk=function(){this.vda("OnEditEnded")};Zc.prototype.jw=function(){if(!this.fva){var l=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.vda("OnVisibleAreaChanged",!0,l)}};Zc.prototype.j5=function(){this.fva=!0};Zc.prototype.Uo=function(){this.vda("OnCurrentSelectionModeChanged");
this.yKf();this.kh("OnCurrentSelectionModeChanged")};Zc.prototype.jm=function(){this.vda("OnBlockCacheItemEvicted")};Zc.prototype.Le=function(){this.vda("OnBlockCacheItemChanged")};Zc.prototype.mba=function(){this.fva||this.vda("OnActiveItemPanesChanged")};Zc.prototype.Ii=function(){this.fva=!1;this.Mba.kh("ActiveSheetChanged");this.gxa()};Zc.prototype.vBb=function(l,K){if(l=Object(mi.a)(Fi.a,K.item))l.Omb(16,!0),l.Hkb(Object(fd.a)(this,this.gxa,"onSheetOptionsChanged"))};Zc.prototype.ySf=function(){if(!this.Ry||
!this.u4a)return!1;if(1===this.gridView.ga.Ze){var l=this.$.sa.activeRange.isSingle,K=1===this.$.sa.selectedRanges.length&&!l,ka=this.gridView.isEditing,$a=this.Qjd;K||qd.ULS.sendTraceTag(540389446,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",l);return this.BKd&&K&&!ka&&!$a}return this.BKd};Zc.prototype.Pgj=function(l){l?he.requestFullscreen(this.D_a):he.exitFullscreen()};Zc.prototype.bsi=function(){he.U1h||(this.clc&&this.clc.Ht&&
this.clc.hide(),ag.g(this.$).isEditing&&ag.g(this.$).Zo(!0),this.tsc(!1),qd.ULS.sendTraceTag(538826502,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};Zc.prototype.csi=function(){qd.ULS.sendTraceTag(540389445,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};Zc.prototype.vda=function(l,K,ka){var $a=this;ka=void 0===ka?!1:ka;void 0!==K&&K||(this.LHb=this.ySf());qd.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",
l,this.LHb,ka);if(this.uKb&&ka)qd.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.tKb),window.cancelAnimationFrame(this.tKb),this.tKb=0;else if(this.uKb){qd.ULS.sendTraceTag(543023558,0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",l);return}ka?this.zQd(xe.HelperMethods.Kc(),l):(this.tKb=window.requestAnimationFrame(function(Lb){$a.zQd(Lb,l)}),this.uKb=!0)};Zc.prototype.zQd=function(l,K){var ka=this,$a=xe.HelperMethods.Kc();
if($a-l>this.Y1i)this.tKb=window.requestAnimationFrame(function(bc){ka.zQd(bc,K)}),this.uKb=!1,qd.ULS.sendTraceTag(560566431,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",$a-l);else{this.ANa.ITf(this.LHb);this.uKb=!1;var Lb=xe.HelperMethods.Kc();l=xe.HelperMethods.Kc()-l;$a=Lb-$a;this.a1i(l,K);qd.ULS.sendTraceTag(560566430,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",$a,l)}};Zc.prototype.H2e=
function(){var l=this;qf.a(this.$.userOperationManager,function(K,ka,$a){var Lb=l.$.ra.xa,bc=l.Ry,Dc=Lb.Ra(41,null);Dc.shouldEnablePresentMode=bc;return Ef.i(Lb,"SetPresentMode",Dc,K,ka,$a,null,0)},function(K){return new rf.a(252,0,K)},null)};Zc.prototype.yKf=function(){var l=tj.a(this.gridView.Ze);1!==this.gridView.Ze||this.$.sa.activeRange.isSingle||(l="Range");this.zpc[l]=this.zpc[l]?this.zpc[l]+1:1};Zc.prototype.a1i=function(l,K){var ka=this.Vjc[K]?this.Vjc[K]:0;this.Vjc[K]=ka>l?ka:l;this.Ujc[K]=
this.Ujc[K]?this.Ujc[K]+1:1};Zc.prototype.qdi=function(){var l={},K=xe.HelperMethods.Kc()-this.Xxf;l.PresentModeDuration=K;l.SelectionCountPerObject=Tg.a.toJSON(this.zpc);l.OverlayCountPerCaller=Tg.a.toJSON(this.Ujc);l.OverlayDurationPerCaller=Tg.a.toJSON(this.Vjc);K=this.Mba.aJh();for(var ka in K)l[ka]=K[ka];gj.b(this.$).Jd(ei.a.iIi,l,void 0,!0)};Jl.Object.defineProperties(Zc.prototype,{Ry:{configurable:!0,enumerable:!0,get:function(){return this.u1d}}});Object(fe.a)(Zc,"PresentModeManager",null,
[322,7]);var Ik=b(333),tk=Ie.a;Cm(Ed,tk);Ed.prototype.create=function(){var l=this,K=Vf.GetServiceTaskFactory.Xa(this.$.ea,283,284,1,"Common.IDynamicScriptLoaderProvider");og.TaskExtensions.Da(K,function(){og.TaskExtensions.Da(Ik.c(K.result.xq.loadScript("presentMode")),function(){var ka=l.$.ea.Ea(423,void 0);ka||(ka=new Zc(l.$),l.$.ea.La(423,ka));l.Jb(ka)},l.$.ma,3)},this.$.ma,3)};Ed.la=function(l){l.ea.La(424,new Ed(l))};Object(fe.a)(Ed,"PresentModeManagerFactory",Ie.a,[]);var xj=b(167),bk=b(156),
yk=b(517),uk=b(83),dj=b(28);ge.ydh="ewa-resizehdr-row-hidden";ge.xdh="ewa-resizehdr-col-hidden";Object(fe.a)(ge,"CssClassNames",null,[]);var zk=b(61),Wi=b(25),Xi=b(141),nk=b(48),ti=b(68),Jk=b(256),Xj=b(367);Object(fe.a)(Nd,"HeaderEventCachedInfo",null,[]);Hd.prototype.Ete=function(l){return Math.max(0,Math.min(Hd.hff,xe.HelperMethods.twd(l)))};Hd.prototype.vte=function(l){return this.LFi(l)};Hd.prototype.XMg=function(l){return Math.round(this.L1c*l+2*this.RPe()+1)};Hd.prototype.LFi=function(l){return Math.max(0,
Math.min(Hd.Ref,(Math.max(0,Math.min(ye.a.Tfc,l))-2*this.RPe()-1)/this.L1c))};Hd.prototype.RPe=function(){return Math.floor(Math.max((this.L1c+3)/4,2))};Hd.prototype.m8b=function(l,K){return K?l?Hd.hff:ye.a.dpd:l?Hd.Ref:ye.a.Tfc};Hd.hff=409;Hd.Ref=255;Object(fe.a)(Hd,"ResizeHeadersConverter",null,[]);var ok=b(34),gk=uk.a;Cm(Mc,gk);Mc.prototype.dispose=function(){this.OVc();this.grid.ga&&(this.grid.ga.nca(Object(fd.a)(this,this.Ih,"onSelectionEnded")),this.grid.ga.oca(Object(fd.a)(this,this.sq,"onSelectionStarted")));
this.grid.Ps(Object(fd.a)(this,this.Ih,"onSelectionEnded"));Qg.a(this.grid.$)&&Qg.a(this.grid.$).vg.vla(Object(fd.a)(this,this.RE,"onPartialInteractivityStatusChanged"));Qh.a.instance.Ca(ef.a.Dj,this.domElement,Object(fd.a)(this,this.oba,"onDblClick"));xj.a.instance.Ca(ef.a.de,this.domElement.ownerDocument.body,Object(fd.a)(this,this.aic,"onDocumentMouseUp"));bk.a.instance.Ca(ef.a.Ge,this.domElement.ownerDocument.body,Object(fd.a)(this,this.aic,"onDocumentMouseUp"));Sd.a.Sq||(xj.a.instance.Ca(ef.a.pointerDown,
this.domElement,Object(fd.a)(this,this.RM,"onMouseDown")),xj.a.instance.Ca(ef.a.Jh,this.domElement,Object(fd.a)(this,this.MQ,"onMouseMove")));this.A9a&&(xj.a.instance.Ca(ef.a.Jh,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),bk.a.instance.Ca(ef.a.Og,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),this.A9a=!1);this.tF&&(xj.a.instance.Ca(ef.a.pointerDown,this.tF,Object(fd.a)(this,this.RM,"onMouseDown")),Qh.a.instance.Ca(ef.a.Dj,
this.tF,Object(fd.a)(this,this.oba,"onDblClick")),this.OVc(),this.tF=null);this.yIf&&(nh.DOMElementExtensions.rg(Mc.D9a),Mc.D9a=null);this.Sg=null;gk.prototype.dispose.call(this)};Mc.prototype.p9g=function(){if(!Mc.D9a){document.getElementById(Mc.xIf);this.yIf=!0;var l=Mc.D9a=document.createElement("div");this.grid.$.frame.G$().appendChild(l);l.id=Mc.xIf;l.className=dj.a.zdh;nh.DOMElementExtensions.setVisible(l,!1)}};Mc.prototype.RM=function(l){l=ok.a(this.grid.$).Qe(l);if(3===l.Cb&&!this.c9e(l.Ga)||
!this.Kxf(l,!1))return!1;qd.ULS.sendTraceTag(25281678,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var K=this.HKd();this.kNe(l,K,!0);this.A9a||(xj.a.instance.qa(ef.a.Jh,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),bk.a.instance.qa(ef.a.Og,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),this.A9a=!0);this.l5e()&&this.Eaa&&this.q0e(l);return!1};Mc.prototype.aic=function(l){l=ok.a(this.grid.$).Qe(l);
this.l5e()&&this.SRc&&this.q0e(l);if(l.Ga.button||!this.Eaa)return!1;ti.g(l.Ga);this.HCe();l=ye.a.V2a;this.yr&&(l=this.nCa?this.c9c():this.yr.Sta());var K=l!==this.am;if(this.FIb&&K&&l!==ye.a.V2a){l=this.grid;K=this.QTe(l);var ka={};ka.SheetMultiRange=Qb.r(K,l.$);Mc.HHd(ka,this.isRow,this.am);this.H8g(ka);l.qnj=!0}else this.Ih(null,null),this.Nmc();return this.nCa=!1};Mc.prototype.HCe=function(){this.A9a&&(xj.a.instance.Ca(ef.a.Jh,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),
bk.a.instance.Ca(ef.a.Og,this.domElement.ownerDocument.body,Object(fd.a)(this,this.Owa,"onDocumentMouseMove")),this.A9a=!1);this.Eaa=!1;this.h_i();this.GBd();Xj.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};Mc.prototype.h_i=function(){this.grid.Sb.ll([this.isRow?13:14]);this.grid.Sb.oab()};Mc.prototype.oba=function(l){l=yk.a.create(l.eventName,l.Wb,l.Ga,l.Cb);l=ok.a(this.grid.$).Qe(l);if(!this.Kxf(l,!0))return!1;l=this.grid;var K=this.QTe(l);K=Qb.r(K,l.$);l.Sb.ll([this.isRow?13:
14]);l.Sb.oab();this.Nmc();var ka={};l.$.Re(this.isRow?146338636:1391094586,Jd.a.Yb,30,(ka.autoFitRanges=K,ka));return!1};Mc.prototype.Owa=function(l){l=ok.a(this.grid.$).Qe(l);if(!this.Eaa)return!1;ti.g(l.Ga);var K=this.isRow;if(!this.Z_){this.Z_=document.createElement("div");this.Z_.style.cssText="position: relative; width: inherit; height: inherit;"+(K?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var ka=this.yr.qJ();ka.nextSibling;)this.Z_.appendChild(ka.nextSibling);ka.parentNode.appendChild(this.Z_)}ka=
K?l.clientPoint.y-this.pxb.y:(this.rtl?-1:1)*(l.clientPoint.x-this.pxb.x);var $a=K?l.clientPoint.y-this.FIb.y:(this.rtl?-1:1)*(l.clientPoint.x-this.FIb.x),Lb=this.yr.Sta();if(Lb===ye.a.V2a)return!1;ka&&(0<this.am||0<Lb+$a)&&Lb+$a<=this.Tef&&(this.am=this.HKd($a),this.kNe(l,this.am,!1),nh.DOMElementExtensions.xRa(this.yr.qJ(),!K,Math.max(this.QFb+$a,0)),this.Z_.style[K?"top":this.rtl?"right":"left"]=Math.max($a,-this.QFb)+"px",nh.DOMElementExtensions.xRa(this.yr.Sg.domElement,!K,(K?this.yr.Sg.TO:this.yr.Sg.UO)+
Math.max($a,-this.QFb)),this.pxb=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),nh.DOMElementExtensions.setVisible(this.tF,!1));return!0};Mc.prototype.kNe=function(l,K,ka){this.lM&&ka&&(qd.ULS.sendTraceTag(23666761,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.GBd());this.lM||ka||qd.ULS.sendTraceTag(23666762,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");
this.ifc&&(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?this.ifc(function(){var $a={};return $a.Location="canvas",$a}):this.ifc(function(){return{}}));this.lM?this.pNe(K):(this.lM=document.createElement("div"),this.lM.id=this.AQh,this.pNe(K),this.lM.className=dj.a.och,K=document.getElementById(this.grid.$.Mb+vc.a.Igf),K.insertBefore(this.lM,K.firstChild),l=ok.a(this.grid.$).NIa(l.clientPoint),this.lM.style.left=(this.rtl?Math.max(l.x-this.lM.offsetWidth,0):l.x-
Math.max(l.x+this.lM.offsetWidth-K.offsetWidth,0)).toString()+"px",K=document.getElementById(vc.a.clb),this.lM.style.top=(l.y-K.offsetHeight-this.lM.offsetHeight).toString()+"px")};Mc.prototype.GBd=function(){nh.DOMElementExtensions.rg(this.lM);this.lM=null};Mc.prototype.pNe=function(l){var K=new Hd(this.grid.$.workbookContext.DxDigitNormal);this.lM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.wQh:this.FQh,this.isRow?K.Ete(l).toFixed(2):K.vte(l).toFixed(2),l.toString(),this.zQh)};Mc.prototype.Kxf=
function(l,K){var ka;if(-1!==this.grid.ga.selectionType||2===l.Cb&&l.Ga.button||!this.Xkd(ka=this.N9c(l))||!this.L7e)return!1;ti.g(l.Ga);this.FIb=this.pxb=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.lGg(ka,K);if(!this.yr)return!1;this.Eaa=!0;this.i5h(this.yr,ka)&&this.qUh();yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?(l={},gj.b(this.grid.$).Jd(ei.a.uIf,(l.IsResizingHiddenHeader=this.nCa,l.IsAutoFitting=K,l.NumberOfSelectedRanges=this.grid.ga.ya.gw,
l.Location="canvas",l))):(l={},gj.b(this.grid.$).Jd(ei.a.uIf,(l.IsResizingHiddenHeader=this.nCa,l.IsAutoFitting=K,l.NumberOfSelectedRanges=this.grid.ga.ya.gw,l)));this.QFb=this.c9c();this.offset=this.yr.Fia();this.am=this.yr.Sta();if(this.am===ye.a.V2a)return!1;Xj.c(this.grid.$,!1,"HeaderResizeBehavior:PrepareResizeOperation");return!0};Mc.prototype.i5h=function(l,K){var ka=this.yr.qJ();if(!ka)return qd.ULS.shipAssertTag(42062210,2,!1,"cell being resized element received is null"),!1;ka=ka.nextSibling;
if(!ka)return!1;l=l.getRange();ka=this.Sg.Ita(ka).getRange();if((!l||!ka)&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4307391_ColumnResizeOnSnappingHeaders_IsResizingHidden"))return qd.ULS.shipAssertTag(590128395,2,!1,"IsResizingHidden: range is null"),!1;var $a=l.right===ka.right;return l.right+1!==ka.right&&!$a&&this.Xkd(K,!0)};Mc.prototype.qUh=function(){var l=this.yr.qJ(),K=this.Sg.Ita(l.nextSibling);Mc.j5h(K,this.isRow)?(this.yr=K,this.uOa=this.yr.getRange()):(this.Kog(l),this.yr=K,l=this.yr.getRange(),
this.uOa=this.isRow?new Wi.Range(l.top-1,l.left,l.top-1,l.right,!1,!0):new Wi.Range(l.top,l.left-1,l.bottom,l.left-1,!1,!0),this.nCa=!0)};Mc.prototype.Kog=function(l){var K=this.Sg.Ita(l.nextSibling),ka=Mc.xUg(K,this.isRow,this.rtl);ka&&l.parentNode.insertBefore(ka,K.qJ())};Mc.prototype.QTe=function(l){var K=this.uOa,ka=l.ga.ya.selectedRanges;if(l.ga.ya.vpb(K))if(this.isRow){if(Ca.a.all(ka,function($a){return $a.isRow}))return ka}else if(Ca.a.all(ka,function($a){return $a.Yh}))return ka;return[K]};
Mc.prototype.c9c=function(){var l=this.yr.qJ().style;return Math.max(0,Math.min(this.Tef,0|parseInt(this.isRow?l.height:l.width)))};Mc.prototype.HKd=function(l){l=void 0===l?0:l;var K=this.grid,ka=this.Sg.sj.paneType;ka=this.isRow?3===ka?[3,2]:[1,4]:4===ka?[2,4]:[1,3];var $a=K.view.visibleArea.bottomRight,Lb=this.yr.Sta();Lb===ye.a.V2a&&(Lb=0);l=this.nCa?Math.max(this.c9c(),0):Math.max(Lb+l,0);$a=this.isRow?new Vi.a(0,this.offset,$a.x,l):new Vi.a(this.offset,0,l,$a.y);Lb=[this.isRow?13:14];K.Sb.qm(Wi.Range.xd(1,
1),Lb,!1);K.Sb.Wr(Lb,$a,ka);return l};Mc.prototype.MQ=function(l){l=ok.a(this.grid.$).Qe(l);var K;if(!this.L7e||-1!==this.grid.ga.selectionType)return Qg.a(this.grid.$).Rq()&&(K=this.N9c(l))&&(K.uua.style.cursor=""),!1;if(this.Eaa)return this.mWh(),!1;K=this.N9c(l);if(!K)return!1;K.uua.style.cursor=!this.grid.isEditing&&this.Xkd(K)?this.isRow?"row-resize":"col-resize":"";ti.g(l.Ga);return!0};Mc.prototype.OVc=function(){this.uOa=this.FIb=this.pxb=null;if(this.Z_){var l=this.Z_.parentNode;if(l)for(l.removeChild(this.Z_);this.Z_.firstChild;)l.appendChild(this.Z_.firstChild);
this.Z_=null}this.yr=null;nh.DOMElementExtensions.setVisible(Mc.D9a,!1);this.Eaa=!1;this.GBd();nh.DOMElementExtensions.setVisible(this.tF,!1)};Mc.prototype.N9c=function(l){if(nh.DOMElementExtensions.Py(l.Wb,"a"))return null;var K=this.c9e(l.Ga);if(K&&this.grid.ga.ya.Eh){var ka=this.grid.ga.ya.Xd;ka=this.Sg.zs(Wi.Range.xd(ka.bottom,ka.right))}else ka=this.Sg.Ita(l.Wb);if(!ka)return null;var $a=ka.qJ(),Lb=new Sys.UI.Bounds($a.offsetLeft,$a.offsetTop,$a.offsetWidth,$a.offsetHeight),bc=nh.DOMElementExtensions.getBoundingClientRect(l.Wb);
bc=new Sys.UI.Point(l.clientPoint.x-bc.x,l.clientPoint.y-bc.y);this.isRow&&!K&&(bc.y+=xe.HelperMethods.mA(l.Wb,$a,this.rtl).y);return new Nd($a,bc,Lb,ka.getRange(),Math.max(Mc.Zhi,Math.min(Mc.Kgi,(this.isRow?Lb.height:Lb.width)*Mc.iZi)),K,!this.isRow&&0<$a.getElementsByTagName("input").length)};Mc.prototype.Xkd=function(l,K){K=void 0===K?!1:K;if(!l||this.grid.isEditing)return!1;if(l.b9e)return!0;var ka=l.uMa,$a=l.C9a,Lb=this.Sg.sj.paneType,bc=this.grid.Yf(Lb).Ph,Dc=!!bc&&bc.top===l.Pcd.top,wd=!!bc&&
bc.left===l.Pcd.left;Lb=!!bc&&bc.bottom===l.Pcd.bottom&&(3===Lb||2===Lb);this.isRow?(wd=l.hzb.y,l=wd<=$a&&!Dc,ka=wd>=ka.height-$a-(Lb?Mc.Kph:0),K=K?l:ka||l):(Lb=l.DPh,Dc=this.rtl,bc=l.hzb.x,l=bc<=$a&&(!wd||Dc)&&(!Lb||!Dc),ka=bc>=ka.width-$a&&(!Dc||!wd)&&(!Lb||Dc),K=K?Dc?ka:l:l||ka);return K};Mc.prototype.lGg=function(l,K){var ka=this.isRow;if(l.b9e)this.yr=this.Sg.Ita(l.uua);else if(ka&&l.hzb.y<=l.C9a&&l.uMa.height>l.C9a||!ka&&l.uMa.width>l.C9a&&(!this.rtl&&l.hzb.x<=l.C9a||this.rtl&&l.hzb.x>=l.uMa.width-
l.C9a)){if(this.yr=l.uua.previousSibling?this.Sg.Ita(l.uua.previousSibling):this.WBh(),K&&Sys.UI.DomElement.containsCssClass(l.uua,ka?dj.a.cIe:dj.a.bIe)&&(l=this.Sg.Ita(l.uua)))l=l.getRange(),this.uOa=ka?new Wi.Range(l.top-1,l.left,l.top-1,l.right,!1,!0):new Wi.Range(l.top,l.left-1,l.bottom,l.left-1,!1,!0)}else this.yr=this.Sg.Ita(l.uua);!this.uOa&&this.yr&&(this.uOa=this.yr.getRange())};Mc.prototype.WBh=function(){var l=this.isRow?1:0;return(l=this.Sg.sj.xF(this.Sg.sj.Ha.Lg(this.grid.$.sa,zk.a.KL(this.Sg.position.X+
l-1,this.Sg.position.Y-l,this.Sg.position.PaneType))))?l.VBh():null};Mc.prototype.mWh=function(){var l=this.jZi;nh.DOMElementExtensions.setVisible(l,!0);l.style.cursor=this.isRow?dj.a.qFe:dj.a.jEe;this.HKd()};Mc.prototype.H8g=function(l){var K={};this.grid.$.Re(this.isRow?745189930:-445963340,Jd.a.Yb,30,(K.resizeRowColumnParameters=l,K))};Mc.prototype.sq=function(){this.Nmc()};Mc.prototype.Ih=function(){if((3===Jd.a.Yb||Sd.a.Sq)&&this.grid.ga.ya.Eh){var l=this.grid.ga.ya.Xd;if(!(!l.isRow&&!l.Yh||
!this.domElement||l.isRow&&this.isRow&&!Array.contains(this.Sg.ho,l.top)||l.Yh&&!this.isRow&&!Array.contains(this.Sg.ho,l.left))){var K=this.grid.Mg(l,this.Sg.sj.paneType);K&&(this.tF||this.wYg(),l.isRow&&this.isRow?(nh.DOMElementExtensions.setVisible(this.tF,!0),this.tF.style.top=K.bottomRight.y-this.tF.offsetHeight/2+"px"):l.isRow||this.isRow||(nh.DOMElementExtensions.setVisible(this.tF,!0),Jk.b(this.tF.style,this.grid.rtl,K.bottomRight.x-this.tF.offsetWidth/2+"px")))}}};Mc.prototype.wYg=function(){var l=
document.createElement("div");l.className=dj.a.leh;var K=document.createElement("div");K.className=yh.a.MB;l.appendChild(K);var ka=document.createElement("img");ka.src=nk.a.Ee(0);ka.className=this.isRow?yh.a.wdh:yh.a.tdh;K.appendChild(ka);this.Sg.HB.domElement.parentNode.insertBefore(l,this.Sg.HB.domElement);xj.a.instance.qa(ef.a.pointerDown,l,Object(fd.a)(this,this.RM,"onMouseDown"));Qh.a.instance.qa(ef.a.Dj,l,Object(fd.a)(this,this.oba,"onDblClick"));nh.DOMElementExtensions.setVisible(l,!1);this.tF=
l};Mc.prototype.Nmc=function(){this.OVc();this.tF&&(this.Sg.HB.domElement.parentNode.removeChild(this.tF),this.tF=null)};Mc.prototype.c9e=function(l){return nh.DOMElementExtensions.jf(this.tF,l.target)};Mc.prototype.RE=function(l,K){K.zO&&this.Gmb()};Mc.prototype.Gmb=function(){this.Eaa&&(this.HCe(),nh.DOMElementExtensions.xRa(this.yr.qJ(),!this.isRow,this.QFb),this.Nmc(),this.nCa=!1)};Mc.prototype.l5e=function(){return yd.EwaSettings.ka(732)};Mc.prototype.q0e=function(l){(l=l.Ga.rawEvent)&&l.detail===
Mc.K2i&&(l.type===ef.a.To?(this.Eaa=!1,this.SRc=!0):l.type===ef.a.vC&&(this.Eaa=!0,this.SRc=!1))};Mc.tUg=function(l,K){return new Mc(l,K)};Mc.j5h=function(l,K){if(!l||!l.qJ())return qd.ULS.shipAssertTag(25571525,2,!1,"header after hidden headers is null"),!1;var ka=l.getRange();l=l.qJ().style;if(!ka||!l)return qd.ULS.shipAssertTag(25571526,2,!1,"header range or style is null"),!1;l=K?l.height:l.width;return(K?ka.top:ka.left)===(K?ye.a.Gh:ye.a.Qh)&&l===Mc.t6f};Mc.xUg=function(l,K,ka){if(!l)return qd.ULS.shipAssertTag(25571527,
2,!1,"header after hidden is null"),null;var $a=l.qJ();if(!$a||!$a.style)return qd.ULS.shipAssertTag(25571528,2,!1,"header after hidden element or style is null"),null;l=document.createElement("div");var Lb=$a.style;l.style.top=K?Lb.top:Mc.t6f;K||(ka?l.style.right=Lb.right:l.style.left=Lb.left);Sys.UI.DomElement.addCssClass(l,K?ge.ydh:ge.xdh);Sys.UI.DomElement.addCssClass(l,K?dj.a.yqb:dj.a.xqb);ka=document.createElement("div");Sys.UI.DomElement.addCssClass(ka,K?dj.a.RHe:dj.a.n4c);$a=K?Number.parseInvariant($a.innerText):
Wi.Range.zYa($a.innerText);ka.innerText=K?($a-1).toString():Wi.Range.p2($a-1);l.appendChild(ka);return l};Mc.HHd=function(l,K,ka){if(K)for(l.ColumnWidth=-1,l.RowHeight=ka,l=Ml(l.SheetMultiRange.Ranges),K=l.next();!K.done;K=l.next())K=K.value,K.FirstColumn=0,K.LastColumn=0;else for(l.RowHeight=-1,l.ColumnWidth=ka,l=Ml(l.SheetMultiRange.Ranges),K=l.next();!K.done;K=l.next())K=K.value,K.FirstRow=0,K.LastRow=0};Jl.Object.defineProperties(Mc.prototype,{L7e:{configurable:!0,enumerable:!0,get:function(){var l=
(new Xi.a(this.grid.$.Aa)).Ke(this.isRow?16:8),K=this.grid.$.Db.MJ,ka=this.grid.wi,$a=Qg.a(this.grid.$).Rq();return l&&!K&&!ka&&!$a}},jZi:{configurable:!0,enumerable:!0,get:function(){this.p9g();return Mc.D9a}}});Mc.Zhi=0;Mc.Kgi=5;Mc.Kph=3;Mc.iZi=.1;Mc.xIf="ewa-rszrbg";Mc.t6f="0px";Mc.K2i=2;Mc.D9a=null;Object(fe.a)(Mc,"HeaderResizeBehavior",uk.a,[]);var Ej=Ie.a;Cm(ae,Ej);ae.prototype.create=function(){this.Jb(Mc.tUg)};ae.la=function(l){l.ea.La(136,new ae)};Object(fe.a)(ae,"HeaderResizeBehaviorFactory",
Ie.a,[]);var yj=b(194),Pj=b(412),hj=b(519),Ai=b(70);Object(fe.a)($c,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[115]);Object(fe.a)(Cb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[115]);var vk=ie.a;Cm(Qc,vk);Qc.prototype.J3=function(l,K){var ka={};return ka.id=this.xc,ka.isRow=this.isRow,ka.initialSizeInPx=l,ka.initialSizeInDefaultUnits=K,ka.isInitialUnitsDefaultUnits=this.Lwb,ka.getInputErrorIfInvalid=Object(fd.a)(this,this.ysb,"getInputErrorIfInvalid"),ka};Qc.prototype.ysb=function(l){l=
this.Z9c(l);return this.x7c(l)};Qc.prototype.LGg=function(){var l=this.Psh();try{return this.dxh(l)}finally{l&&l.dispose()}};Qc.prototype.bZi=function(l,K){var ka=this.Lwb=K[Qc.x0h];1===l?(l=K[Qc.hij],ka=this.IVe(l,ka),qd.ULS.shipAssertTag(576312971,0,ka!==Qc.maa,"ResizeHeadersDialogHandler - invalid size input, size = {0}",l),l=ka!==this.Ved,qd.ULS.sendTraceTag(577361429,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,
this.Lwb,ka,l),l&&this.XRg(ka)):qd.ULS.sendTraceTag(577361428,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",this.isRow)};Qc.prototype.XRg=function(l){var K={};K.SheetMultiRange=Qb.r(this.gridView.ga.ya.selectedRanges,this.$);Qc.HHd(K,this.isRow,l);l={};this.$.Re(this.isRow?745189930:-445963340,Jd.a.Yb,8,(l.resizeRowColumnParameters=K,l))};Qc.prototype.IVe=function(l,K){return Re.a.OU(l)?K?this.KQg(l):this.MQg(l):Qc.maa};Qc.prototype.MQg=function(l){return Math.floor(parseFloat(l))};
Qc.prototype.KQg=function(l){l=parseFloat(l);return 0>l?Qc.maa:l?this.isRow?xe.HelperMethods.TFi(l):this.goc.XMg(l):0};Qc.prototype.NQg=function(l){return l===Qc.maa?"":this.isRow?this.goc.Ete(l).toString():this.goc.vte(l).toFixed(2)};Qc.prototype.LQg=function(l){return l===Qc.maa?"":l.toString()};Qc.prototype.dxh=function(l){if(!l||!l.$$mn()||!l.Zn)return Qc.maa;var K=Object(mi.a)(210,l.Zn);if(!K)return Qc.maa;for(K=this.isRow?K.Sub:K.Ted;l.$$mn();){var ka=Object(mi.a)(210,l.Zn);if(ka&&(this.isRow?
ka.Sub:ka.Ted)!==K)return Qc.maa}return K};Qc.prototype.Psh=function(){for(var l=[],K=Ml(this.gridView.ga.ya.selectedRanges),ka=K.next();!ka.done;ka=K.next()){ka=ka.value.clone();var $a=this.gridView.Yf(this.gridView.$a.fk(ka));$a=ka.Of($a.Ph);if(!$a)return null;this.isRow?ka.right=ka.left=$a.left:ka.top=ka.bottom=$a.top;Array.add(l,ka)}return l.length?this.gridView.L9("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",l):null};Qc.prototype.Z9c=function(l){if(!Re.a.OU(l))return 1;l=this.IVe(l,
this.Lwb);return!l&&this.h5h()?3:this.M7h(l)?0:2};Qc.prototype.h5h=function(){var l=this.gridView.ga.ya.selectedRanges;return this.isRow&&Qb.P(l)||!this.isRow&&Qb.O(l)};Qc.prototype.x7c=function(l){var K="";switch(l){case 0:K="";break;case 1:K=Te.a.instance.da(737);break;case 2:l=this.Lwb;K=String.format(Te.a.instance.Eb(98),0,this.m8b(l));break;case 3:K=Te.a.instance.da(738)}return K};Qc.prototype.M7h=function(l){return 0<=l&&l<=this.m8b(!1)};Qc.prototype.m8b=function(l){return this.goc.m8b(l,this.isRow)};
Qc.HHd=function(l,K,ka){if(K)for(l.ColumnWidth=Qc.maa,l.RowHeight=ka,l=Ml(l.SheetMultiRange.Ranges),K=l.next();!K.done;K=l.next())K=K.value,K.FirstColumn=0,K.LastColumn=0;else for(l.RowHeight=Qc.maa,l.ColumnWidth=ka,l=Ml(l.SheetMultiRange.Ranges),K=l.next();!K.done;K=l.next())K=K.value,K.FirstRow=0,K.LastRow=0};Jl.Object.defineProperties(Qc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},Lwb:{configurable:!0,enumerable:!0,get:function(){return Qc.F1d},set:function(l){Qc.F1d=
l}}});Qc.C2a="id";Qc.hij="size";Qc.x0h="isDefaultUnits";Qc.maa=-1;Qc.F1d=!0;Object(fe.a)(Qc,"ResizeHeadersDialog",ie.a,[]);Ic.prototype.$c=function(l,K){l=!0;switch(K){case -445963340:case 1391094586:l=this.Ke(8);break;case 745189930:case 146338636:l=this.Ke(16)}return!l};Ic.prototype.executeCommand=function(l,K,ka){var $a=og.TaskExtensions.um();var Lb=ag.g(this.$);l=yj.a.create().toString();var bc=K.command;switch(bc){case 1391094586:case 146338636:var Dc=1391094586===bc;(l=ka.autoFitRanges)&&l.Ranges&&
l.Ranges.length||(l=Qb.r(Lb.ga.ya.selectedRanges,this.$));$a=this.x4g(Dc?1:0,l,K);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Dc=-445963340===bc||-706918724===bc||369708605===bc;if(-445963340===bc||745189930===bc)Dc=Pj.a(K.command),Lb.Ui.Xca(16,l,Dc),ka=ka.resizeRowColumnParameters;else{var wd=Lb.ga.ya.selectedRanges;if(-706918724===bc&&6===K.qf&&Qb.O(wd)){qd.ULS.sendTraceTag(573690833,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");
break}if(1051390410===bc&&6===K.qf&&Qb.P(wd)){qd.ULS.sendTraceTag(573690832,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}Lb=369708605===bc||1542466017===bc?-2:0;ka={};ka.SheetMultiRange=Qb.r(wd,this.$);if(Dc)for($a=Ml(ka.SheetMultiRange.Ranges),bc=$a.next();!bc.done;bc=$a.next())bc=bc.value,bc.FirstRow=0,bc.LastRow=0;else for($a=Ml(ka.SheetMultiRange.Ranges),bc=$a.next();!bc.done;bc=$a.next())bc=bc.value,bc.FirstColumn=0,bc.LastColumn=
0;ka.RowHeight=Dc?-1:Lb;ka.ColumnWidth=Dc?Lb:-1}$a=this.N4g(ka,K,l);break;case 957527587:case 2040891415:new Qc(this.$,K)}return $a};Ic.prototype.Sxi=function(l,K){if(!M.a(l)&&K){var ka=!!l&&!!l.RequestTelemetryData;ag.g(this.$).Ui.fka(K,l.StateId,ka?l.RequestTelemetryData.EcsOperationDuration:0,ka?l.RequestTelemetryData.EcsRequestDuration:0,ka?l.RequestTelemetryData.WfeRequestDuration:0)}};Ic.prototype.Jc=function(l,K,ka,$a){if(l=!!ka&&!!$a&&1===$a.Wz)switch(K.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:l=!1}return l};Ic.prototype.gd=function(){return!1};Ic.prototype.sgj=function(l,K,ka,$a){if(!ka)return this.syb(!1,"resizing to 0 - ignore"),!1;var Lb=l.Ha;if(l.dQh())return this.syb(!1,"skeleton in view - ignore"),!1;var bc=l.Df;if(!bc)return qd.ULS.sendTraceTag(556865247,0,15,"ResizeCommandHandler.ShowInstantaneousResize: ActiveSheetProcessedData is null"),!1;var Dc=bc.aRe(K);if(Dc&&0<Dc.length)return this.syb(!1,Dc.length.toString()+" hiddens in resizeRanges"),!1;if(this.l3h(l,K,$a))return this.syb(!1,
"There's a merge cell across blocks in resizeRanges"),!1;if(yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!$a)for(l=Ml(K),Dc=l.next();!Dc.done;Dc=l.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Dc.value.left);l=yj.a.create().toString();bc.m3f(K,ka,$a);ka=Lb.V1f($a);this.Fi.XOi(K,$a);Lb.hAf(ka,l);this.syb(!0);return!0};Ic.prototype.l3h=function(l,K,ka){for(var $a=Ml(K),Lb=$a.next();!Lb.done;Lb=$a.next())Lb=Lb.value,ka?Lb.right=ye.a.Qh:
Lb.bottom=ye.a.Gh;l=l.L9("ResizeCommandHandler.IsMergeCellAcrossBlocksExistInRanges",K);try{for(l.$$rst();l.$$mn();)if(l.Zn.Njj)return!0}finally{l&&l.dispose()}return!1};Ic.prototype.syb=function(l,K){qd.ULS.sendTraceTag(554201368,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",l,void 0===K?"":K)};Ic.prototype.Ke=function(l){return(new Xi.a(this.$.Aa)).Ke(l)};Ic.prototype.x4g=function(l,K,ka){function $a(){return new $c(Dc,K)}var Lb=this,bc=this.$.ra.xa.dc(),
Dc=!l;return qf.a(this.$.userOperationManager,function(wd,ke,jf){var Xf=Lb.$.ra.xa,Sf=Xf.Ra(41,bc);Sf.isRow=Dc;Sf.autoFitRanges=K;return Ef.i(Xf,"AutoFit",Sf,wd,ke,jf,null,0)},function(wd){return new rf.a(135,0,wd,void 0,$a)},ka)};Ic.prototype.N4g=function(l,K,ka){function $a(){return new Cb(l)}function Lb(Xf,Sf,xg){bc.$.Ss();Qb.i(Dc,",",bc.$,!1);var xi=bc.$.ra.xa;Xf=Tf.b(Xf,Object(fd.a)(bc,bc.Sxi,"onResizeOperationWebMethodSuccess"));var Oi=xi.Ra(41,void 0===jf?null:jf);Oi.resizeRowColumnParameters=
l;return Ef.i(xi,"ResizeRowsColumns",Oi,Xf,Sf,xg,ka,0)}var bc=this,Dc=Qb.g(l.SheetMultiRange.Ranges),wd=!1,ke=K.command;if(745189930===ke||-445963340===ke)qd.ULS.shipAssertTag(556865245,0,this.$.activeItemName===l.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),ke=(wd=745189930===ke)?l.RowHeight:l.ColumnWidth,(wd=this.sgj(ag.g(this.$),Dc,ke,wd))&&ag.g(this.$).Ui.S_(ka,Ai.BasicTelemetryCalculator.bQ);var jf=this.$.ra.xa.dc(!0);return wd?yd.EwaSettings.wc()?
qf.a(this.$.userOperationManager,Lb,function(Xf){return new rf.a(136,0,Xf,64,$a)},K):qf.a(this.$.userOperationManager,Lb,function(Xf){return new hj.a(136,0,Xf,void 0,$a)},K):qf.a(this.$.userOperationManager,Lb,function(Xf){return new rf.a(136,0,Xf,void 0,$a)},K)};Object(fe.a)(Ic,"ResizeCommandHandler",null,[159]);var Aj=Df.a;Cm(Xb,Aj);Xb.prototype.Rd=function(){var l=this,K=Vf.GetServiceTaskFactory.create(this.$.ea,18,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.IFormatCellsAction");og.TaskExtensions.Da(K,
function(){l.Hd([new Ic(l.$,K.result)])},this.ma,3)};Xb.la=function(l){Df.a.ie(113,new Xb(l))};Object(fe.a)(Xb,"ResizeCommandHandlerFactory",Df.a,[]);hc.prototype.$c=function(){return!1};hc.prototype.executeCommand=function(l,K,ka){l=2;switch(K.command){case -309686558:l=this.Bi.Pe(Cf.a.saveACopy,2,ka);break;case 617689800:l=this.Bi.Pe(Cf.a.saveToCloudStorage,2,ka);break;case -1244760097:l=this.Bi.Pe(Cf.a.saveToSharePoint,2,ka)}return 2===l&&K?h.a(K.command):we.Task.Ua(!0)};hc.prototype.Jc=function(l,
K){l=!1;switch(K.command){case -1244760097:case -309686558:case 617689800:l=!0,qd.ULS.shipAssertTag(572306193,0,this.$.qaa,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return l};hc.prototype.gd=function(){return!1};Object(fe.a)(hc,"SaveToHostCommandHandler",null,[159]);var wk=Df.a;Cm(Xa,wk);Xa.prototype.Rd=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),function(){l.Hd([new hc(l.$,
Wd.AFrameworkApplication.Hb)])},this.ma,3);Wd.AFrameworkApplication.Hb.$b(Cf.a.POa,Bh.a.frame,Object(fd.a)(this,this.Goh,"forceSaveActionDispatcher"))};Xa.prototype.Goh=function(l,K,ka,$a,Lb){return 1===ka?32:l===Cf.a.POa&&2===ka?(l=this.$.ra.xa.dc(),Ef.Z(this.$.ra.xa,Lb[0],Lb[1],null,null,l),32):8};Xa.la=function(l){Df.a.ie(267,new Xa(l))};Object(fe.a)(Xa,"SaveToHostCommandHandlerFactory",Df.a,[]);Ea.prototype.$c=function(l){switch(l){case -309686558:return 8===this.Bi.processAction(Cf.a.saveACopy,
1,null);case 617689800:return 8===this.Bi.Pe(Cf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Bi.Pe(Cf.a.saveToSharePoint,1,null)}return!1};Ea.prototype.dispose=function(){this.$=null};Object(fe.a)(Ea,"SaveToHostManager",null,[321,7]);var Vg=Ie.a;Cm(Fd,Vg);Fd.prototype.create=function(){this.Jb(this.$.ea.Ea(393,void 0)||new Ea(this.$,Wd.AFrameworkApplication.Hb))};Fd.la=function(l){l.ea.La(394,new Fd(l))};Object(fe.a)(Fd,"SaveToHostManagerFactory",Ie.a,[]);var Qj=xh.a;Cm(Pc,Qj);Pc.prototype.execute=
function(l){var K=Object(mi.a)(11,l.Je);qd.ULS.shipAssertTag(35985042,0,Bd.a.mlb(l.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");K.xH(!0,!0);l.activityState[li.a.IUb]=K.fa.sessionId;l.activityState[li.a.Rjb]=!0;l.activityState[li.a.OUb]=!0;qd.ULS.sendTraceTag(35985043,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(fe.a)(Pc,"SessionReloadActivity",xh.a,[]);var Yj=Ie.a;Cm(Nc,Yj);Nc.prototype.create=
function(){this.Jb(new Pc(cg.a.k$a,cg.a.Dk))};Nc.la=function(l){l.ea.La(142,new Nc)};Object(fe.a)(Nc,"SessionReloadActivityFactory",Ie.a,[]);var pk=b(55),Ak=b(264),Pg=b(109),Rj=b(47),Bk=b(239),cj=b(115),Ij=xh.a;Cm(dc,Ij);dc.prototype.execute=function(l){var K=Object(mi.a)(11,l.Je);l.activityState[li.a.hqa]=!0;var ka=dc.ZHh(l);if(dc.icj(l,ka))return dc.agi(l),ka=50,0<l.errors.length&&(ka=15),qd.ULS.sendTraceTag(37535887,0,ka,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",
Bd.a.fd(l.errors)),l.activityState[li.a.hqa]=!1,this.mh(cg.a.idle),3;switch(ka){case 1:case 3:this.VWh(l,ka);break;case 2:this.UWh(l);break;case 0:l.activityState[li.a.RVa]=null}qd.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",ka,this.activityName,this.RZ,K.fa.P6);var $a=fj.a.yg(l.activityState,cj.a.Cbb);qd.ULS.shipAssertTag(40502925,0,!$a||$a&&(1===ka||3===ka),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
$a,ka);K=K.wk.reloadCount;return ka&&0<K?($a=Ak.a.w1a(K,200),qd.ULS.sendTraceTag(24404636,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",ka,K,$a,this.activityName),fk.a.instance.create(function(){dc.WI(l)},$a,Kj.a.x5i),1):3};dc.prototype.VWh=function(l,K){qd.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var ka=Object(mi.a)(11,l.Je);l.activityState[li.a.Rjb]=!0;ka.Yac||
Rj.PageLoadTrackingInfo.instance.Lj("ReopenOnLoad");!dc.isEditMode(l)&&Bd.a.mlb(l.errors)&&(qd.ULS.sendTraceTag(35985044,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),l.activityState[li.a.IUb]=ka.fa.sessionId,l.activityState[li.a.OUb]=!0);l.Rod();3===K?(ka.fa.Yg()||ka.fa.Jli(),ka.xH(!0,!0),this.mh(this.Yqj),l.activityState[li.a.Bce]=ka.workbookContext.CalcMode):(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===K&&ka.xH(!0,!0),l.activityState[li.a.ZNc]=!1,this.mh(this.Dsc))};dc.prototype.UWh=function(l){qd.ULS.sendTraceTag(21304145,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");l.activityState[li.a.RVa]=null;l.Rod();this.mh(this.aij);l=Object(mi.a)(11,l.Je);l.Yac||(Rj.PageLoadTrackingInfo.instance.Lj("RefreshOnLoad"),l.TEb())};dc.WI=function(l){l.WI()};dc.ZHh=function(l){var K=Object(mi.a)(11,l.Je),ka=K.fa,$a=dc.isEditMode(l),Lb=Bd.a.dh(l.errors,$a?dc.Dod:dc.Eod),
bc=Bd.a.dh(l.errors,$a?dc.lef:dc.mef),Dc=K.dQ,wd=K.wk.reloadCount,ke=K.Ba.MaxConsecutiveSilentReloadAllowed,jf=K.wk.bZe(),Xf=Bd.a.fd(l.errors),Sf=Bd.a.fd(l.Oxa),xg=0<Bd.a.YL(function(pj){return!pj.triggerSilentReopenOnly},l.errors).length,xi=Lb,Oi=fj.a.yg(l.activityState,cj.a.Cbb);Oi&&(xi=!0);Lb={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:$a,isSilentReopenError:Lb,isSilentRefreshError:bc};Lb.reloadSequenceCount=K.wk.eOa;Lb.reloadCount=wd;Lb.maxReloads=ke;Lb.stopSilentReloads=
jf;Lb.errorNames=Xf;Lb.processedErrorNames=Sf;Lb.isClientDirty=Dc;Lb.errorsForSilentReopenOnly=xg;Lb.triggerSilentReloadAfterTokenRefresh=Oi;Lb.IsReopenDisabled=K.QKa;Dc=pk.a.Oc(Lb);qd.ULS.sendTraceTag(21837004,0,50,Dc);if(!jf){if(xi&&($a?dc.Zbj(l):dc.acj(l)))return Bk.a.sRf(l,K)?3:K.QKa?2:1;if(bc&&($a||!ka.B8a))return 2}return 0};dc.icj=function(l,K){for(var ka=Ml(l.errors),$a=ka.next();!$a.done;$a=ka.next())if($a=$a.value,-1337545025===$a.MessageId||-238814601===$a.MessageId)return!1;return Bd.a.YL(function(Lb){return!Lb.triggerSilentReopenOnly},
l.errors).length?3!==K:!1};dc.agi=function(l){var K=Bd.a.YL(function($a){return!$a.triggerSilentReopenOnly},l.errors);K=Ml(K);for(var ka=K.next();!ka.done;ka=K.next())l.eka(ka.value)};dc.isEditMode=function(l){var K=Object(mi.a)(11,l.Je);return K.fa.pc?K.isEditMode&&!!(K.Gd&64):fj.a.yg(l.activityState,li.a.qr)};dc.acj=function(l){var K=Object(mi.a)(11,l.Je),ka=Bd.a.n$(l.errors,dc.Eod);if(Pg.b(ka,function($a){return $a.ForceVersionUpgrade}))return!1;l=Bd.a.mlb(l.errors);return!K.fa.B8a||l?!0:!1};dc.Zbj=
function(l){l=Bd.a.n$(l.errors,dc.Dod);return!Pg.b(l,function(K){return K.ForceVersionUpgrade})};dc.Eod=null;dc.Dod=null;dc.mef=null;dc.lef=null;Object(fe.a)(dc,"SessionReloadSilentActivity",xh.a,[]);var Ck=Ie.a;Cm(xb,Ck);xb.prototype.create=function(){this.Jb(new dc(this.activityName,this.HT,cg.a.Dk,cg.a.nj,cg.a.PJb))};xb.la=function(l){l.ea.La(143,new xb(cg.a.Xla,cg.a.sXb));l.ea.La(144,new xb(cg.a.$pc,cg.a.WMa));l.ea.La(145,new xb(cg.a.aqc,cg.a.$ud));l.ea.La(154,new xb(cg.a.l$a,cg.a.VN))};Object(fe.a)(xb,
"SessionReloadSilentActivityFactory",Ie.a,[]);eb.prototype.getSheetName=function(){return this.sheetName};eb.prototype.getValue=function(){return this.value};Object(fe.a)(eb,"MacroRecorderSheetOptionToggledPayload",null,[115]);Ub.prototype.$c=function(){return!1};Ub.prototype.executeCommand=function(l,K){function ka(){return new eb($a.SheetName,jf)}var $a={};this.$.gk($a);l=K.command;var Lb=Object(mi.a)(Fi.a,this.$.Aa.getItemByName($a.SheetName));if(!Lb)return h.a(l);switch(l){case 705559150:case -1411193626:var bc=
16;var Dc=!Lb.hideGridLines;var wd=Qa;var ke=183;var jf=Lb.hideGridLines;break;case -2052321504:case 515737500:bc=4;Dc=!Lb.headersVisible;wd=gb;ke=184;jf=!Lb.headersVisible;break;case -1478455630:bc=2;Dc=!Lb.displayRtl;wd=pb;ke=185;jf=!Lb.displayRtl;ag.g(this.$).Ha.Gvj(Dc);break;default:return h.a(l)}Lb.Omb(bc,Dc);var Xf=this.$.ra.xa;return qf.a(this.$.userOperationManager,function(Sf,xg,xi){return wd(Xf,$a.SheetName,jf,Tf.b(Sf,function(Oi){Ub.CBb(Oi,Lb,bc,Dc)}),Tf.a(xg,function(){Ub.EAb(Lb,bc,Dc)}),
xi,null)},function(Sf){return new rf.a(ke,0,Sf,void 0,ka)},K)};Ub.prototype.Jc=function(l,K){l=!1;switch(K.command){case -1411193626:case 515737500:case -1478455630:l=!0;break;case 705559150:case -2052321504:l=Xj.a(this.$)}return l};Ub.prototype.gd=function(){return!1};Ub.CBb=function(l,K,ka,$a){Bd.a.Fq(l.Errors)&&K.Omb(ka,!$a)};Ub.EAb=function(l,K,ka){l.Omb(K,!ka)};Object(fe.a)(Ub,"SheetOptionsToggleCommandHandler",null,[159]);var Dk=Df.a;Cm(Mb,Dk);Mb.prototype.Rd=function(){this.Hd([new Ub(this.$)])};
Mb.la=function(l){Df.a.ie(100,new Mb(l))};Object(fe.a)(Mb,"SheetOptionsToggleCommandHandlerFactory",Df.a,[]);var qk=b(63),hk=b(43),Ek=b(196),ni=Ek.a;Cm(Hb,ni);Hb.prototype.initialize=function(){var l=this.$.Mb+"iframeDialog_frame",K=this.$.Mb+"iframeDialog";var ka=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',l,this.HQe(K));this.Qb.style.margin=xe.HelperMethods.Ub(0);this.Qb.style.marginBottom=xe.HelperMethods.Ub(-2);this.Qb.innerHTML=ka;this.aEc=document.getElementById(l);
this.domElement.id=K;this.onResize(null,Sys.EventArgs.Empty);Sd.a.ecc&&fk.a.instance.create(Object(fd.a)(this,this.T8g,"ensureCloseButton"),50,Kj.a.eSh,!0,!0);ni.prototype.initialize.call(this)};Hb.prototype.dispose=function(){this.$&&this.$.AH(Object(fd.a)(this,this.onResize,"onResize"));ni.prototype.dispose.call(this)};Hb.prototype.setFocus=function(){nh.DOMElementExtensions.setFocus(this.JJa)};Hb.prototype.onHide=function(){this.JJa.contentWindow.close();nh.DOMElementExtensions.rg(this.JJa);this.aEc=
null;ni.prototype.onHide.call(this)};Hb.prototype.onResize=function(){var l=this.bBh();this.JJa.setAttribute("width",l.x);this.JJa.setAttribute("height",l.y);this.owj(l);this.wtd()};Hb.prototype.owj=function(l){var K=this.domElement.style;K.width=xe.HelperMethods.Ub(l.x);K.marginLeft=xe.HelperMethods.Ub(-l.x/2)};Hb.prototype.bBh=function(){var l=nh.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*l.width),this.Zxe.x),Math.min(Math.floor(.9*l.height),this.Zxe.y))};
Hb.prototype.T8g=function(){var l=this.ax.parentNode.style,K=l.top;l.top="2px";l.top=K};Jl.Object.defineProperties(Hb.prototype,{JJa:{configurable:!0,enumerable:!0,get:function(){return this.aEc}}});Object(fe.a)(Hb,"IFrameDialog",Ek.a,[]);Cm(Jb,Hb);Jb.prototype.HQe=function(l){var K=new Sys.StringBuilder(this.$.Ba.EmbedConfiguratorUrl);Ig.a.Bg(K,vc.a.bah,l);if(je.a(this.$.Ba,33)){Ig.a.Bg(K,vc.a.$$g,"1");l=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5593231_PassEwaJsSplitEnabledToEmbed");var ka=
je.a(this.$.Ba,35);l&&ka&&Ig.a.Bg(K,vc.a.aah,"1")}return K.toString()};Jb.prototype.onShow=function(){qd.ULS.sendTraceTag(20717841,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");Hb.prototype.onShow.call(this)};Jl.Object.defineProperties(Jb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(fe.a)(Jb,"EmbeddingDialog",Hb,[]);Va.JQf="FrameDialog_ShareFromEdit";Va.view="FrameDialog_View";Va.Oqe="FrameDialog_CloseAndRefresh";Va.hbj="FrameDialog_ShareFromView";
Va.edit="FrameDialog_Edit";Va.jPi="FrameDialog_RefreshGrid";Va.tMg="FrameDialog_CloseMe";Va.Yqe="FrameDialog_CloseMeError";Va.ready="FrameDialog_Ready";Va.SFi="FrameDialog_PleaseClose";Va.JG="GotoRange";Object(fe.a)(Va,"PostMessageConstants",null,[]);var ik=b(106);Object(fe.a)(Da,"SessionUpdateContext",null,[]);Cm(wa,Hb);wa.prototype.Xsg=function(l){this.addHandler(wa.Cmd,l)};wa.prototype.nUi=function(l){this.removeHandler(wa.Cmd,l)};wa.prototype.dispose=function(){Ei.a.Ia(this.fZa);this.fZa=null;
Hb.prototype.dispose.call(this)};wa.prototype.initialize=function(){Hb.prototype.initialize.call(this);var l=xd.a.K$(this.$.Ba.FormLightBoxUrl),K=this.fZa=new I.a(this.JJa.contentWindow,l);K.isEnabled()&&K.XDa(l)&&(this.pla(Va.JQf,Object(fd.a)(this,this.yjc,"onUpdateMessage")),this.pla(Va.view,Object(fd.a)(this,this.yjc,"onUpdateMessage")),this.pla(Va.Oqe,Object(fd.a)(this,this.yjc,"onUpdateMessage")),this.pla(Va.hbj,Object(fd.a)(this,this.ezi,"onShareFromView")),this.pla(Va.edit,Object(fd.a)(this,
this.eri,"onEditMessage")),this.pla(Va.jPi,Object(fd.a)(this,this.yjc,"onUpdateMessage")),this.pla(Va.ready,Object(fd.a)(this,this.yxi,"onReadyMessage")),this.pla(Va.tMg,Object(fd.a)(this,this.Xkf,"onCloseMessage")),this.pla(Va.Yqe,Object(fd.a)(this,this.Xkf,"onCloseMessage")))};wa.prototype.close=function(l){l===this.closeAction&&this.V5e&&this.fZa.send(new wj.a(Va.SFi))||Hb.prototype.close.call(this,l)};wa.prototype.HQe=function(){return this.eve(this.Scc)};wa.prototype.eve=function(l){var K=this.$.Ba,
ka=new Sys.StringBuilder(K.FormLightBoxUrl);Ig.a.Bg(ka,vc.a.$oh,this.$.fa.sessionId);Ig.a.Bg(ka,vc.a.Yoh,l?vc.a.Zoh:vc.a.Xoh);rj.a.yEa(ka,K);return ka.toString()};wa.prototype.yjc=function(l){function K(Dc,wd,ke){return Ef.E($a.ra.xa,Tf.b(Dc,Object(fd.a)(ka,ka.Ryi,"onSessionUpdated")),wd,ke,Lb)}var ka=this,$a=this.$,Lb=new Da;Lb.JG=l.Values[Va.JG];var bc=!1;switch(l.MessageId){case Va.JQf:this.su();bc=!0;Lb.Wwd=1334518759;break;case Va.view:this.Hza=Te.a.instance.da(1204);this.A3f(!0);break;case Va.Oqe:this.su(),
bc=!0}yd.EwaSettings.wc()?(l=new rf.a(140,0,K),l.flags=bc?16:80):(l=bc?new rf.a(140,0,K):new hj.a(140,0,K),l.flags=16);$a.userOperationManager.oc(l,this.je)};wa.prototype.eri=function(){var l=this.$;l.Ba.SurveyRedirectUrl?(this.su(),l.Re(1305810481,0,8,null)):(this.Hza=Te.a.instance.da(1203),this.A3f(!1))};wa.prototype.ezi=function(){var l=this.$;this.su();l.Re(1334518759,0,8,null)};wa.prototype.Xkf=function(l){var K=this.$;this.su();l.MessageId===Va.Yqe&&K.fa.P6c()};wa.prototype.yxi=function(){this.pFc=
!0;this.raiseEvent(wa.Cmd)};wa.prototype.A3f=function(l){this.pFc=!1;this.JJa.src=this.eve(l);this.v1d=l};wa.prototype.pla=function(l,K){this.fZa.vn(l);this.fZa.km(l,K)};wa.prototype.Ryi=function(l,K){var ka=this;if(!M.a(l)){l=this.$;if(K.JG){var $a=l.fa.Aa;if($a.contains(K.JG.SheetName))this.wic(K);else{var Lb=null;Lb=function(){$a.ula(Lb);ka.wic(K)};$a.Sfa(Lb)}}1461300262!==K.Wwd&&l.Re(K.Wwd,0,8,null)}};wa.prototype.wic=function(l){var K=this.$.fa.Aa.getItemByName(l.JG.SheetName);K&&!K.ay&&ag.g(this.$).ui(l.JG,
null,null,null,20,ik.a.Joh)};Jl.Object.defineProperties(wa.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},V5e:{configurable:!0,enumerable:!0,get:function(){return this.pFc}},Scc:{configurable:!0,enumerable:!0,get:function(){return this.v1d}}});wa.w0g=900;wa.Z_g=1200;wa.Cmd="lightBoxReady";Object(fe.a)(wa,"FormDialog",Hb,[188]);var U;(function(l){l[l.comment=10]="comment";l[l.range=12]="range";l[l.table=13]="table";l[l.chart=14]="chart"})(U||(U={}));Object(fe.b)("NavigationType",
U);var Ba=b(1002),jb=b(118),Wb=b(577),Ec=b(1060),Xc=b(278),Ac=b(835),yc=Ac.a;Cm(Wa,yc);Wa.prototype.initialize=function(){var l="<div class='"+jb.a.Ey+"'>\r\n\t<div class='"+jb.a.vEe+"'>\r\n\t\t<div class='"+yh.a.dWc+"'>\r\n\t\t\t<img src='{0}' class='"+yh.a.pHe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+jb.a.yEe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";l=String.format(l,nk.a.Ee(13),Te.a.instance.da(25),Te.a.instance.da(this.message));this.Qb.innerHTML=l;this.addButton(0,this.qni);
this.addButton(1);yc.prototype.initialize.call(this)};Wa.prototype.Ww=function(){return this.qSd};Jl.Object.defineProperties(Wa.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Aw:{configurable:!0,enumerable:!0,get:function(){return 1005}},xra:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(fe.a)(Wa,"WebMethodConfirmationDialog",Ac.a,[]);var dd=Ba.a;Cm(La,dd);La.prototype.dispose=function(){this.oRa&&this.oRa.jca(Object(fd.a)(this,
this.Stf,"onUnshareClicked"));Ei.a.rc([this.textBox,this.VOa,this.oRa]);this.oRa=this.VOa=this.textBox=null;dd.prototype.dispose.call(this)};La.prototype.initialize=function(){var l="<div class='"+jb.a.Ey+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+jb.a.oqb+"'>\r\n\t<input type='text' id='{1}' class='"+jb.a.bU+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";l=String.format(l,Te.a.instance.da(1207),"sfd_input","sfd_unshare",yh.a.zu,
Te.a.instance.da(1208));this.Qb.innerHTML=l;this.textBox=new Xc.a(this.getElementById("sfd_input"));this.VOa=new Ec.a(this.textBox.domElement);this.oRa=Wb.a.create(this.getElementById("sfd_unshare"));this.oRa.C1(Object(fd.a)(this,this.Stf,"onUnshareClicked"));this.textBox.text=Te.a.instance.da(708);this.textBox.enabled=!1;this.textBox.readOnly=!Sd.a.hh;this.addButton(1,10);dd.prototype.initialize.call(this)};La.prototype.qga=function(){var l=this;return function(K,ka,$a){var Lb=l.$.ra.xa.dc(),bc=
l.$.ra.xa;K=l.dia(K);ka=l.C$(ka);Lb=bc.Ra(1,Lb);return Ef.i(bc,"ShareForm",Lb,K,ka,$a,null,0)}};La.prototype.Mx=function(l,K,ka){this.textBox.text=l.Result;this.textBox.enabled=!0;nh.DOMElementExtensions.setVisible(this.oRa.domElement,!0);dd.prototype.Mx.call(this,l,K,ka)};La.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(l){}dd.prototype.setFocus.call(this)};La.prototype.Stf=function(){var l=this.$;this.su();var K=new Wa(l,1209,1210,1211,
function(ka,$a,Lb){var bc=l.ra.xa.dc(),Dc=l.ra.xa;bc=Dc.Ra(1,bc);return Ef.i(Dc,"UnshareForm",bc,ka,$a,Lb,null,0)},16);K.initialize();K.Bf()};Jl.Object.defineProperties(La.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(fe.a)(La,"ShareFormDialog",Ba.a,[]);var Qd=b(658),Cd=b(131),se=b(173),$e=b(247),Af=b(17),yf=Na.a;Cm(Gc,yf);Gc.prototype.$c=function(l,K){l=this.$.workbookContext.FullDocumentInfo;switch(K){case 353606613:case -1099009678:case 192430811:return!yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.fa.isNamedObjectViewMode;case 869186573:return K=$e.a()&&this.$.fa.gh.get(5),Re.a.na(l.FileSharingUrl)&&!K;case -1570751769:case 1986648902:return 131072!==(this.$.XL&131072);case 330035228:return!(this.l0a(!0)&&this.vxc);case -509039657:return!(this.l0a()&&this.vxc);case 1334518759:return!(this.l0a()&&this.vxc&&this.Hne())}return!1};Gc.prototype.executeCommand=function(l,K,ka){l=this.$.workbookContext.FullDocumentInfo;var $a=Cf.a.workflow,Lb=og.TaskExtensions.um(),bc=K.command;if(bc===
$a||-266099===bc)return this.mPh(K,$a,l);switch(bc){case 1986648902:this.VPf();break;case -1570751769:this.aNh(K);break;case 869186573:K=Cf.a.gbj;Lb=Wd.AFrameworkApplication.ha.ta("ShareMenuIsEnabled");$a=hk.a.Y5e();bc=null;(yd.EwaSettings.ka(592)||Lb)&&ka&&"CopyLink"===ka.SourceControlId?(bc={},bc[Mg.a.nHb]="copy",K=Cf.a.IQf):Lb&&ka&&"ManageAccess"===ka.SourceControlId?(bc={},bc[Mg.a.nHb]="manageAccess",K=Cf.a.ibj):$a&&ka&&"LinkToComment"===ka.SourceControlId&&(bc={},bc[Mg.a.nHb]="copy",bc[Mg.a.KQf]=
ka.navId,K=Cf.a.IQf);Lb=this.$Tf(l,bc);se.c(K);break;case -1099009678:Lb=this.sId(12,l);break;case 192430811:Lb=this.sId(13,l);break;case 353606613:Lb=this.sId(14,l);break;case -59906385:case 1197060601:this.AOh(K,l);break;case 1305810481:this.IXe(!1,K);break;case 330035228:this.IXe(!0,K);break;case -509039657:this.deleteForm();break;case 1334518759:K.Fbc=!0;this.shareForm();break;case 710925581:Zf.a.Nf.xrc("710925581")&&(Lb=og.TaskExtensions.Da(this.rJ.value,function(Dc){Dc.result.Yj(Eh.a.conversation,
{})},this.ma,3));break;default:Lb=h.a(bc)}return Lb};Gc.prototype.Jc=function(l,K){l=!1;K=K.command;if(K===Cf.a.workflow)return!0;switch(K){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:l=!0;break;case 353606613:case -1099009678:case 192430811:l=yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode}return l};Gc.prototype.gd=
function(l,K,ka){if("PopulateFormMenu"===K){K=this.vxc?this.Hne()?Gc.hjh:Gc.ijh:Gc.uki;l=this.Va.Vc();for(var $a=0;$a<K.length;$a++)Array.add(l.buttons,this.Va.zb(K[$a]));K=this.Va.sp("Forms.Flyout");Array.add(K.Fc,l);ka.MenuItems=K.JB();return!0}return!1};Gc.prototype.mPh=function(l,K,ka){return this.aFd&&l.command===K?(this.ZEd(l,-266099),og.TaskExtensions.P3()):og.TaskExtensions.Da(this.rJ.value,function($a){Jg.a($a.result,Eh.a.workflow,null,ka.WorkflowPostMessage)||xe.HelperMethods.wf(ka.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ma,3)};Gc.prototype.Hne=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.fa.gh.get(26)};Gc.prototype.aNh=function(l){this.aFd?this.ZEd(l,1986648902):this.VPf()};Gc.prototype.IXe=function(l,K){!l&&this.$.Ba.SurveyRedirectUrl?this.UJi():(l=new wa(this.$,l,K),l.initialize(),l.Bf())};Gc.prototype.AOh=function(l,K){var ka=this;this.aFd&&1197060601===l.command?this.ZEd(l,-59906385):og.TaskExtensions.Da(this.rJ.value,
function($a){$a=$a.result;$a&&Jg.a($a,Eh.a.replyWithChanges,null,ka.$.fa.gh.get(8))||($a=new Sys.StringBuilder(K.ReplyWithChangesUrl),Ig.a.Bg($a,dg.e,dg.d),md.a.ntw($a.toString(),ka.$))},this.ma,3)};Gc.prototype.ZEd=function(l,K){var ka=this,$a=ai.a(this.$).ld.activityState,Lb=new Ui.a(K,l.method,l.mode,l.qf,l.tabName);Qg.a(this.$).Nr(new Rg.a(cg.a.xx,5,function(){$a[Si.a.kp]=cg.a.hKf;$a[Qd.a.VNc]=Lb;ka.$.wk.Sw("SocialSharingSaveBeforeCommand");ka.$.wk.Vde(Lb.command)}))};Gc.prototype.VPf=function(){var l=
this,K=this.$.Ba.DocumentHostInfo;K.HostEmbeddedViewUrl||this.yne?this.VSf():this.$.lg.get(53)&&og.TaskExtensions.Da(this.rJ.value,function(ka){l.ltj(ka.result)||md.a.ntw(K.FileEmbedCommandUrl,l.$)},this.ma,3)};Gc.prototype.ltj=function(l){return l.isEnabled()&&(this.xne||(this.xne=l.km(Eh.a.wne,Object(fd.a)(this,this.Eoi,"onCanEmbedMessageReceived"))))?l.Yj(Eh.a.Okh,null):!1};Gc.prototype.Eoi=function(){this.yne=!0;this.VSf()};Gc.prototype.VSf=function(){if(Sd.a.Sq)md.a.ntw(this.$.Ba.EmbedConfiguratorUrl,
this.$);else{var l=new Jb(this.$);l.initialize();l.Bf()}};Gc.prototype.deleteForm=function(){var l=this.$,K=new Wa(l,1212,1213,1205,function(ka,$a,Lb){var bc=l.ra.xa.dc(),Dc=l.ra.xa;bc=Dc.Ra(9,bc);bc.surveyId=null;return Ef.i(Dc,"DeleteSurvey",bc,ka,$a,Lb,null,0)});K.initialize();K.Bf()};Gc.prototype.shareForm=function(){var l=this,K=this.$.workbookContext.FullDocumentInfo;if(this.$.fa.gh.get(26)){var ka=new La(this.$);ka.initialize();ka.Bf()}else og.TaskExtensions.Da(this.rJ.value,function($a){var Lb=
{};Jg.a($a.result,Eh.a.shareForm,(Lb.SurveyTitle=l.$.workbookContext.SurveyTitle,Lb),l.$.fa.gh.get(10))||md.a.ntw(K.ShareFormCommandUrl,l.$)},this.ma,3)};Gc.prototype.UJi=function(){var l=this.$;l.Ba.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var K=new Sys.StringBuilder(l.Ba.SurveyRedirectUrl);Ig.a.Bg(K,"startupDialog","FormEdit");var ka=ai.a(this.$),$a=ka.ld.activityState;$a[zd.a.HX]=K.toString();$a[zd.a.AI]=zd.a.vqd;this.$.wk.Sw("SocialSharingEnvironmentChange");
Qg.a(l).Nr(new Rg.a(cg.a.xx,5,function(){var Lb=Bd.a.Ad(3,2,1257,1258,1259,554412057,"FossEnvironmentUnsupported");ka.ld.it([Lb]);$a[Si.a.kp]=cg.a.F1f}))};Gc.prototype.l0a=function(l){return(this.$.fa.isEditMode||(void 0===l?!1:l))&&this.$.fa.gh.get(25)&&$e.a()};Gc.prototype.MHh=function(l){var K=void 0===K?null:K;var ka=ag.g(this.$).ga;var $a=this.$.Aa.sa?qk.d(this.$.Aa.sa):null;if(!$a)return qd.ULS.sendTraceTag(541705947,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",
U[l]),null;14===l?K=this.mHh(ka):12===l?(K=ka.hha,K=Re.a.contains(K,"!",!0)?K.split("!")[1]:K):13===l&&(ka=ka.ya.selectedRanges,ka[0]&&(ka=ag.g(this.$).kc.Rk(ka[0])))&&(K=ka.qj);if(!K)return qd.ULS.sendTraceTag(541705946,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",U[l]),null;ka={};ka[Mg.a.nHb]="copy";ka[Mg.a.KQf]=this.Jyh(l,K,$a);qd.ULS.sendTraceTag(545097236,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",
U[l],K,$a);return ka};Gc.prototype.mHh=function(l){if(l.Sa.uja&&(l=l.Sa.nc.floatingObject)&&!l.type){var K=l.id.split(".");if(1<K.length)return K[1];qd.ULS.sendTraceTag(541103810,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",l.id)}return null};Gc.prototype.Jyh=function(l,K,ka){l=btoa(l+"_"+K+"_"+ka);l=l.replace(RegExp("\\+","g"),"-");l=l.replace(RegExp("\\/","g"),"_");return l=l.replace(RegExp("\\=+$","g"),"")};Gc.prototype.$Tf=function(l,K){var ka=
this;return og.TaskExtensions.Da(this.rJ.value,function($a){Jg.a($a.result,Eh.a.sharing,K,ka.$.fa.gh.get(5))?qd.ULS.sendTraceTag(579654538,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",K?K[Mg.a.nHb]:""):xe.HelperMethods.wf(l.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)};Gc.prototype.sId=function(l,K){if(!yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1))return null;var ka=
this.MHh(l);if(ka)return this.$Tf(K,ka);qd.ULS.sendTraceTag(541705945,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",U[l]);return null};Jl.Object.defineProperties(Gc.prototype,{vxc:{configurable:!0,enumerable:!0,get:function(){return Ld.b(this.$.sg)}},aFd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.fa.w6g||this.$.dQ)}}});Gc.uki=[103];Gc.hjh=[107,104,105,106];Gc.ijh=[104,105];Gc.kJg=[new Af.a(cg.a.Wqe,554412057,
0,0,1260),new Af.a(cg.a.idle,554412057,0,1)];Object(fe.a)(Gc,"SocialSharingCommandHandler",Na.a,[159]);var Gg=Df.a;Cm(nc,Gg);nc.prototype.Rd=function(){var l=this,K=new Wg.a(function(){return Vf.GetServiceTaskFactory.create(l.$.ea,137,l.ma,l.vb,"Postmessage.IHostPostmessenger")});og.TaskExtensions.Da(Vf.GetServiceTaskFactory.create(this.$.ea,102,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),function(ka){l.Hd([new Gc(l.$,ka.result,K)])},this.ma,3)};nc.la=
function(l){Df.a.ie(114,new nc(l))};Object(fe.a)(nc,"SocialSharingCommandHandlerFactory",Df.a,[]);Object(fe.a)(Bb,"MacroRecorderRangeCustomSortedPayload",null,[115]);var rh=b(1078),hi=b(1079),fi=b(955),di=b(859),Rh=b(195);Ga.prototype.show=function(){var l=new Be.StandardDialog;l.lc=11;l.Dc(1,Te.a.instance.da(2032));l.Dc(2,Te.a.instance.da(2033));l.QTf(Te.a.instance.da(2031),Te.a.instance.Ya(643),Object(fd.a)(this,this.Mv,"dialogHandler"))};Ga.prototype.Mv=function(l){switch(l){case 0:this.NLa("Cancel");
break;case 1:this.NLa("Expand and sort");this.EIe(!0);break;case 2:this.NLa("Just sort"),this.EIe(!1)}};Ga.prototype.NLa=function(l){qd.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",l)};Object(fe.a)(Ga,"ExpandSortSelectionDialog",null,[]);tc.isValid=function(l){return Array.contains(tc.ujh,l.Position)?!0:(qd.ULS.shipAssertTag(590112389,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",l.Position),!1)};tc.ujh=[0,.5,1];Object(fe.a)(tc,"FillGradientStopExtension",
null,[]);Object(fe.a)(Oc,"GradientLine",null,[]);td.isValid=function(l){if(!(l.Degree.toString()in td.tjh))return qd.ULS.shipAssertTag(590112392,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",l.Degree),!1;if(!l.GradientStops)return qd.ULS.shipAssertTag(590112391,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(l.GradientStops.length<td.Uhi||l.GradientStops.length>td.ugi)return qd.ULS.shipAssertTag(590112390,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",
l.GradientStops.length),!1;l=Ml(l.GradientStops);for(var K=l.next();!K.done;K=l.next())if(!tc.isValid(K.value))return!1;return!0};td.Uhi=2;td.ugi=3;var Fh={};td.tjh=(Fh["0"]=new Oc(0,0,1,0),Fh["180"]=new Oc(1,0,0,0),Fh["90"]=new Oc(0,0,0,1),Fh["270"]=new Oc(0,1,0,0),Fh["45"]=new Oc(0,0,1,1),Fh["225"]=new Oc(1,1,0,0),Fh["135"]=new Oc(1,0,0,1),Fh["315"]=new Oc(0,1,1,0),Fh);Object(fe.a)(td,"FillGradientExtension",null,[]);var ph=Fe.a;Cm(ec,ph);ec.prototype.Us=function(l,K){if(1===l){var ka=Qb.v(this.bzb,
this.$);ag.g(this.$).ui(ka,null,null,null,0,ik.a.vjj)}yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?(ka={},ka=(ka.DialogButton=l,ka.Location="dialog",ka)):(ka={},ka=(ka.DialogButton=l,ka));gj.b(this.$).Jd(ei.a.xjj,ka,null,!0);ph.prototype.Us.call(this,l,K)};ec.prototype.ar=function(){ph.prototype.ar.call(this);var l=this.ujj();this.lc=1;this.Dc(1,Te.a.instance.da(2133));this.Hl(Te.a.instance.da(2134),sd.a.Lq(l),1,Object(fd.a)(this,this.Us,"standardDialogHandler"))};
ec.prototype.ujj=function(){return String.format(Te.a.instance.Eb(164),this.bzb.toString())};ec.prototype.C7c=function(){var l=this.error.Description.split("_");return new Wi.Range(Number.parseInvariant(l[1])+1,Number.parseInvariant(l[2])+1,Number.parseInvariant(l[3])+1,Number.parseInvariant(l[4])+1,!0,!1)};Jl.Object.defineProperties(ec.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(fe.a)(ec,"SortMergedCellsErrorDialog",Fe.a,[]);var bi=fi.a;
Cm(Za,bi);Za.prototype.dispose=function(){this.Ugd||(this.Ugd=!0,this.GYb(),this.D5=null);bi.prototype.dispose.call(this)};Za.prototype.QYh=function(l,K){var ka=this,$a=this.nUg(l);this.Y2a(214,function(Lb,bc,Dc){return Ef.G(ka.$.ra.xa,$a,ka.dYa(Lb,ka.Wqh(K)),ka.hT(bc),Dc,null)},16,!0)};Za.prototype.Wqh=function(l){var K=this;return function(ka){if(M.b(ka,-901005882))ai.a(K.$).ld.AO(-901005882),K.wyd();else if(M.b(ka,-569193796))ai.a(K.$).ld.AO(-569193796),K.hide(),new ec(K.$,ka.Errors[0]);else if(M.a(ka))qd.ULS.sendTraceTag(574944461,
0,10,"CustomSortReactDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),K.hide();else{ka=ka.Result;K.$.gk(ka.SortRange);var $a=yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");ka&&kc(ka)&&vb(ka)&&Ab(ka,$a)?l(ka):K.u2b(Za.job())}}};Za.prototype.PYh=function(l,K,ka){l=Ef.F(this.$.ra.xa,K,this.B7c(K,ka),Object(fd.a)(this,this.Dti,"onGetSortConditionColorsOrIconsRequestFailure"),null,l);Array.add(this.D5,l)};Za.prototype.B7c=
function(l,K){var ka=this;return function($a,Lb){if(ka.Ugd)qd.ULS.sendTraceTag(572785181,0,50,"CustomSortReactDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!$a||M.a($a))qd.ULS.sendTraceTag(572785180,0,10,"CustomSortReactDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Bd.a.fd($a.Errors)),ka.$.fa.Wo($a.Errors),ka.hide();else{$a=$a.Result;var bc=l.RangeType,Dc=l.HeaderRowSize,wd=l.SortTopToBottom;
$a&&ic($a,l.ConditionType)&&sc($a,bc,Dc,wd)?($a.ColumnInfo.ColumnOffset=Lb,void 0!==$a.HeaderColumnInfo&&null!==$a.HeaderColumnInfo&&($a.HeaderColumnInfo.ColumnOffset=Lb),K($a,l.ConditionType,l.SortTopToBottom)):(qd.ULS.sendTraceTag(572785179,0,10,"CustomSortReactDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),ka.u2b(Za.job()))}}};Za.prototype.Dti=function(){qd.ULS.sendTraceTag(572785178,0,10,"CustomSortReactDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");
this.u2b(Za.job())};Za.prototype.N0c=function(l,K){if(1===l){l=K.sortRangeType;var ka={};ka.SortOptions=K.sortOptions;ka.ShouldRestoreSelection=this.EJd;ka.SelectedRange=this.selectedRange;ka.OriginalActiveCell=this.Kjc;ka.TopCellAddress=this.tbb;if(this.wdj(l)){var $a=this.$;this.namedSheetViewPublic.bQa().continueWith(function(Lb){Lb.result&&Za.GAf($a,ka)})}else Za.GAf(this.$,ka)}else this.EJd&&this.gna(this.selectedRange,this.Kjc)};Za.prototype.wdj=function(l){return!!this.namedSheetViewPublic&&
(!l||3===l)};Za.prototype.nUg=function(l){var K={};K.SelectedRange=this.selectedRange;K.ActiveCell=this.Kjc;K.SortInfoMode=l;K.ExpandSortSelection=this.oHg;K.ExpandSortSelectionSupported=!0;return K};Za.prototype.Nra=function(l){var K={};K[Pa.a.d2b]=this.xc;K.fromAutoFilter=l.FromAutoFilter;K.gridRTL=ag.g(this.$).rtl;K.activeCell=l.ActiveCell;K.selectedRange=l.SelectedRange;K.invokeGetSortInfo=Object(fd.a)(this,this.QYh,"invokeGetSortInfoAction");K.invokeGetSortConditionColorsOrIcons=Object(fd.a)(this,
this.PYh,"invokeGetSortConditionColorsOrIconsAction");K.highlightSortRange=Object(fd.a)(this,this.zRh,"highlightSortRangeAction");K.getColorName=Object(fd.a)(this,this.getColorName,"getColorName");return K};Za.prototype.zRh=function(l,K){this.EJd=!0;this.gna(l,K)};Za.prototype.gna=function(l,K){l=Qb.D(l);this.ga.ya.Xd.equals(l)||this.ga.updateSelection(l,Qb.C(K),0,void 0,void 0,void 0,!0)};Za.prototype.getColorName=function(l){return di.a.HIa(Rh.a.wG(l))};Za.prototype.wyd=function(){var l=this;(new Ga(function(K){var ka=
{};ka.ActiveCell=l.Kjc;ka.SelectedRange=l.selectedRange;ka.ExpandSelection=K;ka.FromAutoFilter=!1;K={};l.$.Re(-207540907,Jd.a.Yb,8,(K.SortCommandData=ka,K))})).show()};Za.prototype.GYb=function(){if(void 0!==this.D5&&null!==this.D5)for(var l=Ml(this.D5),K=l.next();!K.done;K=l.next())this.$.ra.xa.Jbb(K.value.ou)};Za.GAf=function(l,K){var ka={};l.Re(1659552324,Jd.a.Yb,8,(ka.CustomSortCommandData=K,ka))};Za.job=function(){return Bd.a.Ad(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Jl.Object.defineProperties(Za.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ga:{configurable:!0,enumerable:!0,get:function(){return ag.g(this.$).ga}}});Object(fe.a)(Za,"CustomSortReactDialog",fi.a,[]);fb.prototype.getSelection=function(){return this.selection};Object(fe.a)(fb,"MacroRecorderAutoFilterToggledPayload",null,[115]);E.prototype.getSelection=function(){return this.selection};Object(fe.a)(E,"MacroRecorderRangeAutoFilterClearedPayload",null,[115]);Object(fe.a)(ia,"MacroRecorderRangeFilterReappliedPayload",
null,[115]);var wh=b(910),$h=b(911);Ua.prototype.$c=function(l,K){return!this.o5h(l,K)};Ua.prototype.executeCommand=function(l,K,ka){l=null;var $a=K.command;switch($a){case -864298118:l=this.D4g(K,ka);break;case -1010737776:l=this.r1c(!0,K,ka);break;case 2123420468:l=this.r1c(!1,K,ka);break;case -207540907:case -1677817820:l=this.gridView.kc.Caa(this.gridView.ga.ya.activeCell)?this.VJi():this.SJi(K,ka);break;case 1659552324:l=this.A4g(K,ka);break;case 368460465:l=this.P4g(K);break;case 529856798:l=
this.y4g(K);break;case 644342024:l=this.L4g(K)}return l||h.a($a)};Ua.prototype.Jc=function(l,K){if(l=1===l)switch(K.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;default:l=!1}return l};Ua.prototype.gd=function(){return!1};Ua.prototype.ga=function(){return this.$&&this.gridView?this.gridView.ga:null};Ua.prototype.jDf=function(l){l?this.gridView.Eq(Object(fd.a)(this,this.onContentReady,"onContentReady")):
this.gridView.Ps(Object(fd.a)(this,this.onContentReady,"onContentReady"));this.L3e=l};Ua.prototype.zej=function(l){return!!this.sortOptions&&Re.a.equals(this.faf,l.hha,!0)};Ua.prototype.o5h=function(l,K){var ka=ag.g(this.$).ga.ya.selectedRanges;return(new Xi.a(this.$.Aa)).ko(l,K,ka,this.gridView)};Ua.prototype.r1c=function(l,K,ka){var $a={OperationType:0};$a.IsAscending=l;$a.HasHeader=!0;$a.GuessHeader=!0;$a.SortTopToBottom=!0;$a.ExpandSortSelectionSupported=!0;ka&&void 0!==ka[Ua.Bab]&&null!==ka[Ua.Bab]?
(ka=ka[Ua.Bab],$a.ActiveCell=ka.ActiveCell,$a.SelectedRange=ka.SelectedRange,$a.ExpandSortSelection=ka.ExpandSelection):($a.ActiveCell=Qb.o(this.ga().ya.activeCell,this.$),$a.SelectedRange=Qb.v(this.ga().ya.Xd,this.$),$a.ExpandSortSelection=null);return this.hkd([Qb.D($a.SelectedRange)])?this.gridView.kc.Caa(Qb.D($a.SelectedRange))?this.I4g(l):this.K2e($a,K):og.TaskExtensions.um()};Ua.prototype.D4g=function(l,K){var ka=null,$a=this.ga();$a&&(this.zej($a)?this.hkd($a.ya.selectedRanges)&&(this.sortOptions.IsAscending=
!this.sortOptions.IsAscending,ka=this.K2e(this.sortOptions,l)):ka=this.r1c(!0,l,K));return ka};Ua.prototype.hkd=function(l){return yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&this.$.isEditMode?this.$.qt(l,!0,1):!0};Ua.prototype.I4g=function(l){this.JEh(l);return we.Task.Ua(!0)};Ua.prototype.YDg=function(l){if(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var K=this.gridView.kc.Rk(this.ga().ya.Xd,!1);if(K){var ka=
K.name;K=K.usedRange;K=this.ga().ya.activeCell.left-K.left;return new hi.a(ka,K,l.IsAscending)}}return new rh.a(l)};Ua.prototype.K2e=function(l,K){function ka(){return $a.YDg(l)}var $a=this;this.gridView.Vi.fG(!1);return this.RCe(function(Lb,bc,Dc){return Kb($a.$.ra.xa,l,Tf.b(Lb,Object(fd.a)($a,$a.Ezi,"onSortSuccessCallback")),bc,Dc,l)},function(Lb){return new rf.a(141,0,Lb,void 0,ka)},K,this.vdj(l))};Ua.prototype.vdj=function(l){if(!this.namedSheetViewPublic)return!1;var K=this.ga().ya.Xd,ka=Qb.v(this.ga().ya.Xd,
this.$),$a=this.gridView.kc.b4a(K,!0),Lb=this.ga().ya.Gva()&&this.gridView.kc.s7e(ka),bc=this.gridView.kc.E4h(ka);l=!K.Haa&&!K.v4||K.isSingle||null!=l.ExpandSortSelection?l.ExpandSortSelection&&this.gridView.kc.s7e(ka):!1;return $a||Lb||bc||l};Ua.prototype.VJi=function(){return this.$.Re(-1556797033,Jd.a.Yb,8,null)};Ua.prototype.SJi=function(l,K){l=8===l.qf&&K&&void 0!==K[Ua.Bab]&&null!==K[Ua.Bab]?K[Ua.Bab]:19===l.qf&&K&&void 0!==K[Jd.a.Mj]&&null!==K[Jd.a.Mj]?pk.a.gi(K[Jd.a.Mj]):this.pTg();if(!this.hkd([Qb.D(l.SelectedRange)]))return og.TaskExtensions.um();
ag.g(this.$).Vi.fG(!1);var ka=null;yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5770108_PTPSOnReactCustomSort")&&(K=K.TopCellAddress)&&(ka=Qb.o(K,this.$));new Za(this.$,l,this.namedSheetViewPublic,ka);return we.Task.Ua(!0)};Ua.prototype.A4g=function(l,K){function ka(){return new Bb(Dc.SortOptions)}function $a(){Dc.ShouldRestoreSelection&&bc.gna(Dc.SelectedRange,Dc.OriginalActiveCell);qd.ULS.sendTraceTag(574373910,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",
l.qf)}function Lb(){Dc.ShouldRestoreSelection&&bc.gna(Dc.SelectedRange,Dc.OriginalActiveCell);qd.ULS.sendTraceTag(574373911,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",l.qf);if(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5770108_PTPSOnReactCustomSort")){if(Dc.TopCellAddress)var wd=Qb.C(Dc.TopCellAddress);else wd=Dc.OriginalActiveCell,wd=new Wi.Range(wd.FirstRow+1,wd.FirstColumn+1,wd.FirstRow+1,wd.FirstColumn+1,!0,!1);bc.uR(wd)}}var bc=this,
Dc=K[Ua.BZg];return qf.a(this.$.userOperationManager,function(wd,ke,jf){return Kb(bc.$.ra.xa,Dc.SortOptions,Tf.b(wd,Lb),Tf.a(ke,$a),jf,bc.sortOptions)},function(wd){return new rf.a(187,0,wd,void 0,ka)},null)};Ua.prototype.gna=function(l,K){l=Qb.D(l);ag.g(this.$).ga.ya.Xd.equals(l)||ag.g(this.$).ga.updateSelection(l,Qb.C(K),0,void 0,void 0,void 0,!0)};Ua.prototype.pTg=function(){var l={};l.ActiveCell=Qb.o(this.ga().ya.activeCell,this.$);l.SelectedRange=Qb.v(this.ga().ya.Xd,this.$);l.FromAutoFilter=
!1;l.ExpandSelection=null;return l};Ua.prototype.P4g=function(l){function K(){return new fb($a)}var ka=this,$a=this.tIa();if(!$a)return we.Task.Ua(!1);var Lb=this.$.ra.xa.dc();return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,function(bc,Dc,wd){return Tb(ka.$.ra.xa,$a,wh.a.eua(jc.a.e9,$h.a.toggleAutoFilter,bc),Dc,wd,null,Lb)},function(bc){return new rf.a(516,0,bc,64,K)},l):qf.a(this.$.userOperationManager,function(bc,Dc,wd){return Tb(ka.$.ra.xa,$a,wh.a.eua(jc.a.e9,$h.a.toggleAutoFilter,
bc),Dc,wd,null,Lb)},function(bc){return new hj.a(516,0,bc,void 0,K)},l)};Ua.prototype.y4g=function(l){function K(){return new E($a)}var ka=this,$a=this.tIa();if(!$a)return we.Task.Ua(!1);var Lb=this.gridView.kc.Rk(this.ga().ya.Xd,!0);Lb&&qd.ULS.sendTraceTag(42038165,0,50,"DoClearAutoFilter for namedObject: Type : {0}",Lb.type.toString());var bc=this.$.ra.xa.dc();Lb=yd.EwaSettings.wc()?function(Dc){return new rf.a(517,0,Dc,64,K)}:function(Dc){return new hj.a(517,0,Dc,void 0,K)};return this.RCe(function(Dc,
wd,ke){var jf=ka.$.ra.xa;Dc=wh.a.eua(jc.a.JEa,$h.a.clearAutoFilter,Dc);var Xf=jf.Ra(41,void 0===bc?null:bc);Xf.selectedRange=$a;return Ef.i(jf,"ClearAutoFilter",Xf,Dc,wd,ke,null,0)},Lb,l,!!this.namedSheetViewPublic)};Ua.prototype.RCe=function(l,K,ka,$a){var Lb=this;return $a?this.namedSheetViewPublic.bQa().continueWith(function(bc){bc.result&&qf.a(Lb.$.userOperationManager,l,K,ka)}):qf.a(this.$.userOperationManager,l,K,ka)};Ua.prototype.L4g=function(l){function K(){return new ia($a)}var ka=this,$a=
this.tIa();if(!$a)return we.Task.Ua(!1);var Lb=this.$.ra.xa.dc();return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,function(bc,Dc,wd){return cb(ka.$.ra.xa,$a,wh.a.eua(jc.a.JEa,$h.a.eBf,bc),Dc,wd,null,Lb)},function(bc){return new rf.a(518,0,bc,64,K)},l):qf.a(this.$.userOperationManager,function(bc,Dc,wd){return cb(ka.$.ra.xa,$a,wh.a.eua(jc.a.JEa,$h.a.eBf,bc),Dc,wd,null,Lb)},function(bc){return new hj.a(518,0,bc,void 0,K)},l)};Ua.prototype.Ezi=function(l,K){M.b(l,-901005882)?(ai.a(this.$).ld.AO(-901005882),
this.wyd(K)):M.b(l,-569193796)?(ai.a(this.$).ld.AO(-569193796),new ec(this.$,l.Errors[0])):!M.a(l)&&l.Result&&(this.sortOptions=K,this.Usc=Qb.D(l.Result.ActualSortRange),this.faf=this.ga().hha,this.L3e||(this.selectedRange=this.ga().ya.Xd,this.selectedRange.equals(this.Usc)||this.Ghj()),this.sortOptions&&this.sortOptions.ActiveCell&&(l=this.sortOptions.ActiveCell,l=new Wi.Range(l.FirstRow+1,l.FirstColumn+1,l.FirstRow+1,l.FirstColumn+1,!0,!1),this.uR(l),this.XOd(l)))};Ua.prototype.wyd=function(l){var K=
this;(new Ga(function(ka){var $a={};$a.ActiveCell=l.ActiveCell;$a.SelectedRange=l.SelectedRange;$a.ExpandSelection=ka;ka={};K.$.Re(l.IsAscending?-1010737776:2123420468,Jd.a.Yb,8,(ka.SortCommandData=$a,ka))})).show()};Ua.prototype.Ghj=function(){var l=this.ga();l.updateSelection(this.Usc,l.ya.activeCell,0,void 0,void 0,void 0,!0);this.jDf(!0)};Ua.prototype.onContentReady=function(){this.jDf(!1);var l=this.ga();l.ya.Eh&&l.ya.Xd.equals(this.Usc)&&l.updateSelection(this.selectedRange,l.ya.activeCell,
0,void 0,void 0,void 0,!0)};Ua.prototype.tIa=function(){var l=this.ga();if(!l)return qd.ULS.shipAssertTag(23666764,0,!!l,"SelectionManger is null"),null;this.gridView.Vi.fG(!1);return Qb.v(l.ya.Xd,this.$)};Ua.prototype.GGb=function(){this.Zc&&this.Zc.Go&&(this.ag=this.Zc.Go,this.Bb=this.Zc.t7b())};Ua.prototype.JEh=function(l){var K=this;if(this.$.isEditMode&&(this.Zc=this.gridView.kc.hq(this.gridView.ga.ya.activeCell))){this.activeCell=Qb.o(this.gridView.ga.ya.activeCell,this.$);if(this.Zc&&this.Zc.Go){var ka=
this.Zc.Go.CurrentCol;if(this.Zc.Go.CurrentRow===this.activeCell.FirstRow&&ka===this.activeCell.FirstColumn){this.GGb();this.applyPivotSort(l);return}}this.$.ra.xa.dc();ka=new rf.a(228,0,function($a,Lb,bc){return Ef.B(K.$.ra.xa,K.activeCell,Tf.b($a,Object(fd.a)(K,K.lti,"onGetPivotTableContextAndApplySortSuccessCallback")),Tf.a(Lb,Object(fd.a)(K,K.kti,"onGetPivotTableContextAndApplySortFailedCallback")),bc,l)},16);this.$.userOperationManager.oc(ka,null)}};Ua.prototype.lti=function(l,K){l&&!Bd.a.eh(l.Errors)&&
this.Zc&&(this.Zc.Go=l.Result,this.GGb(),this.applyPivotSort(K))};Ua.prototype.kti=function(){};Ua.prototype.applyPivotSort=function(l){var K=this;if(this.Zc&&this.Bb&&this.activeCell&&this.ag){var ka=8===this.ag.CellArea,$a=1===this.ag.CellArea||2===this.ag.CellArea;(ka||$a)&&8!==this.ag.CellType&&4!==this.ag.CellType&&(ka?qf.a(this.$.userOperationManager,function(Lb,bc,Dc){return Ef.e(K.$.ra.xa,K.activeCell,l?1:2,K.Bb.Caption,Lb,bc,Dc,null)},function(Lb){return new rf.a(1015,0,Lb,void 0,null)},
null):(ka=1===this.ag.CellArea?1:2,this.$.ka(750)?md.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Zc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Zc.isOlap?"":this.Bb.Caption,ka,l):md.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Zc.externalSourceIndex,this.Bb.Index.toString(),l)))}};Ua.prototype.uR=function(l){yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&
og.TaskExtensions.Da(Vf.GetServiceTaskFactory.Xa(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),function(K){K.result.gRa(l);qd.ULS.sendTraceTag(541131087,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};Ua.prototype.XOd=function(l){yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&og.TaskExtensions.Da(Vf.GetServiceTaskFactory.Xa(this.$.ea,
476,475,0,"Microsoft.Office.Excel.WebUI.Client.ProactiveSuggestion.IProactiveSuggestionManager"),function(K){K.result.XOd(l,0);qd.ULS.sendTraceTag(537518598,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.ma,3)};Ua.BZg="CustomSortCommandData";Ua.Bab="SortCommandData";Object(fe.a)(Ua,"SortCommandHandler",null,[159]);var ri=Df.a;Cm(va,ri);va.prototype.Rd=function(){var l=this;og.TaskExtensions.Da(Vf.GetServiceTaskFactory.Xa(this.$.ea,309,310,this.vb,
"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic"),function(K){l.Hd([new Ua(l.$,K.result)])},this.$.ma,3)};va.la=function(l){Df.a.ie(160,new va(l))};Object(fe.a)(va,"SortCommandHandlerFactory",Df.a,[]);Ia.prototype.QXg=function(l,K){new ec(l,K)};Object(fe.a)(Ia,"SortUtil",null,[319]);var Qi=Ie.a;Cm(za,Qi);za.prototype.create=function(){var l=this.$.ea.Ea(446,void 0);l||(l=new Ia(this.$),this.$.ea.La(446,l));this.Jb(l)};za.la=function(l){l.ea.La(447,new za(l))};Object(fe.a)(za,
"SortUtilFactory",Ie.a,[]);qb.prototype.executeCommand=function(l,K,ka){return 2!==this.Bi.Pe(Cf.a.tryOfficeThroughTellMe,2,ka)?we.Task.Ua(!0):h.a(K.command)};qb.prototype.Jc=function(l,K){return 215809929===K.command};qb.prototype.gd=function(){return!1};qb.prototype.$c=function(){return!1};Object(fe.a)(qb,"TryOfficeThroughTellMeCommandHandler",null,[159]);var Xh=Df.a;Cm(Ta,Xh);Ta.prototype.Rd=function(){this.Hd([new qb(Wd.AFrameworkApplication.Hb)])};Ta.la=function(l){Df.a.ie(207,new Ta(l))};Object(fe.a)(Ta,
"TryOfficeThroughTellMeCommandHandlerFactory",Df.a,[]);var Dh=b(142);db.mU=function(){return Ag.a.jj(db.Oj,Dh.a.Ya(433))};db.Oj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(fe.a)(db,"NamedSheetViewTeachingDialogHtml",
null,[]);var vi=Pa.a;Cm(ta,vi);ta.prototype.Nh=function(){this.lc=4;this.stopwatch=this.$.Zb.Ic("UserAction",this.xc);var l=Te.a.instance.da(1828);this.Mf=db.mU();this.Ko=new bg.a;this.initializeAndShow(l,Object(fd.a)(this,this.Fji,"namedSheetViewTeachingDialogHandler"),{});return this.Ko.task};ta.prototype.Fji=function(l){var K=this;if(1===l)this.$.Na.Xb(new Ui.a(-2050946363,Jd.a.Yb,2,8,null)).continueWith(function($a){K.Ko.setResult(!ra.a($a)&&$a.result)}),l="Yes";else{var ka=2===l;this.Ko.setResult(ka);
l=2===l?"No":"Close";ka&&this.rIi()}this.adi(l);this.hide()};ta.prototype.Yu=function(l){vi.prototype.Yu.call(this,l);this.Dc(1,Te.a.instance.da(1830));this.Dc(2,Te.a.instance.Ya(446))};ta.prototype.rIi=function(){this.$.fa.Rgc=!1};ta.prototype.adi=function(l){var K={};K.a=this.$.Ba.UserSessionId;K.b="NamedSheetViewTeachingDialogClose";K.c=l;K.e=!0;this.stopwatch&&(this.stopwatch.stop(),K.d=this.stopwatch.Gc);Xg.b().Se(53,K,!0)};Jl.Object.defineProperties(ta.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(fe.a)(ta,"NamedSheetViewTeachingDialog",Pa.a,[]);ua.prototype.bQa=function(){if(this.Wdj()){if(yd.EwaSettings.ka(619)){this.$.Aa.sa.kf.HJd=!0;var l=new bg.a;this.$.Na.Xb(new Ui.a(-2050946363,Jd.a.Yb,2,0,null)).continueWith(function(K){l.setResult(!ra.a(K)&&K.result)});return l.task}return(new ta(this.$)).Nh()}return we.Task.Ua(!0)};ua.prototype.Wdj=function(){var l=this.$.Aa.sa;return this.$.fa.g6a&&this.$.fa.Rgc&&!l.kf.jQ&&this.$.fa.UL};
Object(fe.a)(ua,"NamedSheetViewPublic",null,[320]);var Gi=Ie.a;Cm(Ra,Gi);Ra.prototype.create=function(){this.Jb(this.$.ea.Ea(309,void 0)||new ua(this.$))};Ra.la=function(l){l.ea.La(310,new Ra(l))};Object(fe.a)(Ra,"NamedSheetViewPublicFactory",Ie.a,[]);var zi=b(1291),ij=b(985),ii=b(579);Object(fe.a)(ca,"NamedSheetViewTeachingCalloutContent",null,[]);Jl.Object.defineProperties(Ha.prototype,{uNd:{configurable:!0,enumerable:!0,get:function(){return this.O$d}},bKi:{configurable:!0,enumerable:!0,get:function(){if(this.uNd<
this.iYf.count){var l;return this.iYf.oa((this.O$d=(l=this.uNd)+1,l))}return null}}});Object(fe.a)(Ha,"NamedSheetViewTeachingCalloutList",null,[]);var Ih=b(1164);Gb.prototype.CUh=function(l){var K=this;this.hYf=l;var ka=Object.assign(new Zg.a,{});Gb.u1h(l)?(ka.add(new ca(Te.a.instance.Ya(435),Te.a.instance.Ya(436),Te.a.instance.da(1858),function(){K.kH(2,"Continue");K.bC(!0)},Te.a.instance.da(1859),function(){K.bC();K.kH(1,"ExitGuide")},Ih.a())),1===l&&ka.add(new ca(Te.a.instance.da(1860),Te.a.instance.Ya(438),
Te.a.instance.da(1858),function(){K.kH(2,"FirstEnterTempViewContinueSecond");K.bC(!0)},Te.a.instance.da(1859),function(){K.bC();K.kH(1,"FirstEnterTempViewExitGuideSecond")},Ih.a())),ka.add(new ca(Te.a.instance.Ya(439),Te.a.instance.Ya(440),Te.a.instance.da(1858),function(){K.kH(2,"FirstEnterExitCalloutContinue");K.bC(!0)},Te.a.instance.da(1859),function(){K.bC();K.kH(1,"FirstEnterExitCalloutGuide")},Gb.jSe())),ka.add(new ca(Te.a.instance.da(1861),Te.a.instance.Ya(437),Te.a.instance.da(1862),function(){K.CTf();
K.bC();K.kH(1,"LearnMore")},Te.a.instance.da(1863),function(){K.bC();K.kH(1,"Done")},Gb.iSe()))):2===l?ka.add(new ca(Te.a.instance.da(1860),Te.a.instance.Ya(438),Te.a.instance.da(1857),function(){K.bC();K.kH(1,"EnterTempViewAfterPersistedView")},null,null,Ih.a())):3===l&&(ka.add(new ca(Te.a.instance.Ya(435),Te.a.instance.da(1869),Te.a.instance.da(1858),function(){K.kH(2,"AutoOptInExitCalloutContinue");K.bC(!0)},Te.a.instance.da(1859),function(){K.bC();K.kH(1,"AutoOptInExitGuide")},Gb.jSe())),ka.add(new ca(Te.a.instance.da(1860),
Te.a.instance.Ya(438),Te.a.instance.da(1858),function(){K.kH(2,"Continue");K.bC(!0)},Te.a.instance.da(1859),function(){K.bC();K.kH(1,"ExitGuide")},Ih.a())),ka.add(new ca(Te.a.instance.da(1861),Te.a.instance.Ya(437),Te.a.instance.da(1862),function(){K.CTf();K.bC();K.kH(1,"LearnMore")},Te.a.instance.da(1863),function(){K.bC();K.kH(1,"Done")},Gb.iSe())));this.vNd=new Ha(ka)};Gb.prototype.CTf=function(){var l=new Ui.a(-859308420,Jd.a.Yb,this.$.jd,9,null),K={};K=(K.CommandValueId="HelpID=SheetViews",K.InputMethod=
Jd.a.Yb,K.MenuItemId=vc.a.bZ,K.ShouldCanvasTakeFocus=!0,K);this.$.Na.Xb(l,K)};Gb.prototype.show=function(l){this.CUh(l);this.iab()};Gb.prototype.E8i=function(l){this.tWb=l};Gb.prototype.iab=function(){var l=this,K=this.vNd.bKi;if(K){var ka=Object.assign(new zi.a,{label:K.BIi,onExecute:K.primaryButtonAction}),$a=null;K.ELf&&($a=Object.assign(new zi.a,{label:K.ELf,onExecute:K.secondaryButtonAction}));K=Object.assign(new ij.a,{target:K.targetObject,content:K.body,title:K.title,showCloseIcon:!0,primaryButtonProps:ka,
secondaryButtonProps:$a,useTeachingStyles:!0});K=this.tWb.callout(K);ka=Object.assign(new ii.a,{onShow:function(){l.kH(0)}});this.buc=this.tWb.addNotification(K,ka);this.ZQc||(this.$.$jd=!0)}};Gb.prototype.dismiss=function(){this.bC();this.kH(1,"DismissedByOthers")};Gb.prototype.bC=function(l){l=void 0===l?!1:l;this.buc&&(this.ZQc||(this.$.$jd=!1),this.tWb.removeNotification(this.buc),this.buc=null);l&&this.iab()};Gb.prototype.kH=function(l,K){var ka={};ka.a=this.$.Ba.UserSessionId;ka.b=this.hYf;
ka.c=this.vNd.uNd;ka.d=l;ka.e=void 0===K?null:K;l?(this.stopwatch&&(this.stopwatch.stop(),ka.f=this.stopwatch.Gc,this.stopwatch=null),2===l&&(this.stopwatch=this.$.Zb.Ic("UserAction","ShowNamedSheetViewTeachingCalloutNext"))):this.stopwatch=this.$.Zb.Ic("UserAction","ShowNamedSheetViewTeachingCallout");Xg.b().Se(52,ka,!0)};Gb.iSe=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Gb.jSe=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};
Gb.u1h=function(l){return!l||1===l};Object(fe.a)(Gb,"NamedSheetViewTeachingCallout",null,[318]);var Uh=Ie.a;Cm(nb,Uh);nb.prototype.create=function(){var l=this.$.ea.Ea(322,void 0);l||(l=new Gb(this.$),yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.ea.La(322,l));this.Jb(l)};nb.la=function(l){l.ea.La(323,new nb(l))};Object(fe.a)(nb,"NamedSheetViewTeachingCalloutFactory",Ie.a,[]);var oi=b(100),wi=b(169),Ni=b(1165),jj=b(85),Bj=b(1057),Fj=Be.StandardDialog;Cm(sb,Fj);sb.prototype.rP=
function(){this.lc=5;this.width=40;var l=document.createElement("span");l.id=this.hi("DirectPrintHeaderContent");var K=document.createElement("span");K.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(K,"DirectPrintHeader");this.sO=document.createElement("iframe");this.sO.name="pdfObjectFrame";this.sO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.sO.onload=Object(fd.a)(this,this.NIi,"printablePdfLoaded");if(this.wSb&&0<this.wSb.count){var ka=xd.a.K$c(this.iRb,
this.wSb),$a=xd.a.ABd(this.iRb,this.wSb);this.Tl=document.createElement("form");this.Tl.id="printPreviewPostForm";this.Tl.method="POST";this.Tl.target=this.sO.name;this.Tl.action=$a;ka=Ml(ka);for($a=ka.next();!$a.done;$a=ka.next()){$a=$a.value;var Lb=document.createElement("input");Lb.type="hidden";Lb.name=$a.key;Lb.value=$a.value;this.Tl.appendChild(Lb)}}else this.sO.setAttribute("src",this.iRb);Sys.UI.DomElement.addCssClass(this.sO,wi.a.$4d);this.xdg?(Sys.UI.DomElement.addCssClass(this.sO,"DirectPrintPdfObjectHidden"),
K.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,jh.a.wh(this.sO,jh.a.GB,jh.a.rj)):(Sys.UI.DomElement.addCssClass(this.sO,"DirectPrintPdfObject"),this.Xm.push(this.sO));l.appendChild(K);l.appendChild(document.createElement("br"));l.appendChild(this.sO);this.Tl&&l.appendChild(this.Tl);l.appendChild(document.createElement("br"));l.appendChild(this.rPg(this.Tl?"#":this.iRb));this.Qib.start();this.czb(CommonUIStrings.l_AppTitle,null,null,null,null,l);this.kW(this.hi("DirectPrintHeaderContent"));
this.Tl&&this.Tl.submit();this.cUg();qd.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};sb.prototype.rPg=function(l){var K=document.createElement("span"),ka=document.createElement("span");ka.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;K.appendChild(ka);Wd.AFrameworkApplication.ha&&(2===Wd.AFrameworkApplication.za.Za.Xk&&Wd.AFrameworkApplication.ha.ta("PPTDisableDirectPrintDialogDownloadPDFLink")||1===Wd.AFrameworkApplication.za.Za.Xk&&Wd.AFrameworkApplication.ha.ta("XLODisableDirectPrintDialogOpenPDFLink"))?
(l=document.createElement("span"),2===Wd.AFrameworkApplication.za.Za.Xk?l.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===Wd.AFrameworkApplication.za.Za.Xk&&(l.innerText=CommonUIStrings.l_InternalError_Directive,qd.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.uoa=l,K.appendChild(document.createElement("br")),K.appendChild(l)):(ka=document.createElement("a"),ka.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ka.href=l,ka.target=
"_blank",ka.id="PrintPDFLink",ka.className="AllowBrowserClick",this.uoa=ka,K.appendChild(document.createElement("br")),K.appendChild(ka),this.Tl&&Aa.a.addHandler(ka,"click",Object(fd.a)(this,this.sjc,"onSubmit")),this.oO.qa(ef.a.click,this.uoa,Object(fd.a)(this,this.JAe,"downloadPDFLinkClicked"),null));this.Xm.push(this.uoa);return K};sb.prototype.sjc=function(l){this.Tl&&(this.Tl.target="_blank",this.Tl.submit());l.preventDefault()};sb.prototype.cUg=function(){if(0<this.Xm.length){var l=new Ni.a(this.Xm),
K=oi.FocusManager.instance().PP();K&&(this.uoa.focus(),K.mf=l,K.eV=!0)}};sb.prototype.JAe=function(){qd.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};sb.prototype.ond=function(){qd.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};sb.prototype.NIi=function(){qd.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Qib&&this.Qib.stop()};sb.prototype.dispose=function(){this.uoa&&(this.oO.Ca(ef.a.click,
this.uoa,Object(fd.a)(this,this.JAe,"downloadPDFLinkClicked")),this.uoa=null);jj.a.p_(this.sO);this.sO=null;Fj.prototype.dispose.call(this)};Object(fe.a)(sb,"DirectPrintDialog",Be.StandardDialog,[283]);ib.prototype.Zxh=function(l,K,ka){return new sb(this.oO,l,K,void 0===ka?null:ka)};Object(fe.a)(ib,"DirectPrintDialogFactory",null,[268]);Cm(Oa,Eg);Oa.prototype.bcf=function(){qd.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Oa.prototype.dcf=function(){Wd.AFrameworkApplication.Sm.Jub(9540);
qd.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Oa.prototype.ond=function(){qd.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Jl.Object.defineProperties(Oa.prototype,{f0e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},cOd:{configurable:!0,enumerable:!0,get:function(){return Oa.ARa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},aMa:{configurable:!0,enumerable:!0,get:function(){return Oa.ARa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},
bQc:{configurable:!0,enumerable:!0,get:function(){var l=[];Array.add(l,CommonUIStrings.l_PrintDialogCanCloseDocument);Eg.fub&&Array.add(l,CommonUIStrings.l_DirectPrintDialogFallbackSuggestion);return Oa.ARa?l:null}},Jec:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Iec:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},
ZZc:{configurable:!0,enumerable:!0,get:function(){return Wd.AFrameworkApplication.Uye?"UIFontDialogTextLarge":null}}});Jl.Object.defineProperties(Oa,{ARa:{configurable:!0,enumerable:!0,get:function(){return!!Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.Ju&&Wd.AFrameworkApplication.ha.ta("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Sd.a.rA||Sd.a.tf||Sd.a.Pf||Sd.a.m4a)&&Wd.AFrameworkApplication.ha.ta("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(fe.a)(Oa,
"PrintDialogWithLinkToPdf",Eg,[]);xa.T0c=",";Object(fe.a)(xa,"DirectPrintBrsSettings",null,[]);Object(fe.a)(na,"DirectPrintProbeResults",null,[]);ma.prototype.start=function(){};ma.prototype.JKi=function(){var l=Array(this.$B.HQa.length);if(void 0!==this.hhb&&null!==this.hhb)for(var K=0;K<this.$B.HQa.length;K++)l[K]=this.$B.HQa[K]in this.hhb&&this.yeg(this.hhb[this.$B.HQa[K]]);return l};ma.prototype.KKi=function(){for(var l=Array(this.$B.IQa.length),K=!(void 0===this.RHc||null===this.RHc),ka=0;ka<
this.$B.IQa.length;ka++){var $a=this.$B.IQa[ka];l[ka]=K&&$a in this.RHc?!0:this.cfg($a)}return l};ma.prototype.MIh=function(){for(var l=this.JKi(),K=Array(l.length),ka=0;ka<l.length;ka++)K[ka]=l[ka]?this.Wjh(this.hhb[this.$B.HQa[ka]]):null;return K};ma.prototype.Wjh=function(l){if(void 0===l||null===l)return null;l=l.enabledPlugin;return void 0===l||null===l?null:l.name};ma.prototype.vFh=function(){for(var l=this.MIh(),K=this.KKi(),ka={},$a={},Lb=0;Lb<this.$B.HQa.length;Lb++)ka[this.$B.HQa[Lb]]=l[Lb];
for(l=0;l<this.$B.IQa.length;l++)$a[this.$B.IQa[l]]=K[l];return new na(ka,$a)};ma.prototype.Jej=function(){return this.ifg||!this.$B.isEnabled||Wd.AFrameworkApplication.isUnifiedHostMode?!1:this.Lmj()};ma.prototype.$rc=function(){if(null!=this.QTb)return this.QTb;var l=ma.p4e(this.$B);return this.QTb=this.$B.q4e&&l||this.H_h()};ma.prototype.H_h=function(){return Sd.a.Oo&&this.$B.I_h&&Sd.a.Mpe>=this.$B.DKg?!0:!1};ma.prototype.Lmj=function(){if(!this.dfg(this.$B))return!1;var l=Tg.a.lbd(this.qJc.value.iXf);
l=Ml(l);for(var K=l.next();!K.done;K=l.next())if(K=K.value,void 0!==K&&null!==K)return!0;l=Tg.a.lbd(this.qJc.value.IQa);l=Ml(l);for(K=l.next();!K.done;K=l.next())if(K.value)return!0;return!1};ma.prototype.NPh=function(){var l=Tg.a.lbd(this.qJc.value.iXf);l=Ml(l);for(var K=l.next();!K.done;K=l.next())if(Ca.a.contains(this.$B.VSh,K.value))return!0;return!1};ma.prototype.OTf=function(l){var K=void 0===K?!1:K;var ka=void 0===ka?null:ka;Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.ha.ta("DirectPrintDialogAsStandardDialogIsEnabled")?
this.Q2d(l,ka):this.Jej()?this.E3g(l,this.NPh()&&!K,ka):this.Q2d(l,ka)};ma.prototype.E3g=function(l,K,ka){ka=void 0===ka?null:ka;var $a=this.nkg.Ic("UserAction","OpenDirectPrintDialog");this.eTa.Zxh(l,K,ka).rP();$a.stop()};ma.D8e=function(l){try{return new ActiveXObject(l),!0}catch(K){qd.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",l)}return!1};ma.t4e=function(l){return void 0===l||null===l?!1:!(void 0===l.enabledPlugin||null===l.enabledPlugin)};ma.create=function(l){var K=
new xa(Wd.AFrameworkApplication.ha.appSettings),ka=null;try{ka=window.navigator.mimeTypes}catch(jf){qd.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var $a=null;try{$a=window.navigator.plugins}catch(jf){qd.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var Lb=ma.t4e,bc=ma.D8e;l=l.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var Dc=Wd.AFrameworkApplication.za.bB,wd=ma.E8e,ke=!!Wd.AFrameworkApplication.za&&Wd.AFrameworkApplication.za.Za.Ju&&
!Wd.AFrameworkApplication.ha.ta("PrintDialogFallbackLinkEnabled");return new ma(K,ka,$a,Lb,bc,l,Dc,wd,function(jf,Xf){return new Oa(jf,!1,Xf,!0,ke)},Wd.AFrameworkApplication.tKa)};ma.E8e=function(l){return Sd.a.Oo||Sd.a.tf&&l.I2h||l.q4e&&ma.p4e(l)?!0:!1};ma.p4e=function(l){var K=Sd.a.n3b;if(K){var ka=K.split(".");if(2===ka.length)return K=parseInt(ka[0]),ka=parseInt(ka[1]),K>l.Epd||K===l.Epd&&ka>=l.Wff}return!1};Jl.Object.defineProperties(ma.prototype,{$B:{configurable:!0,enumerable:!0,get:function(){return this.obg}}});
Object(fe.a)(ma,"DirectPrintManager",null,[251]);Sa.prototype.$h=function(l){var K=this;this.pb=l;l.register(ib,"Common.App.DirectPrint.DirectPrintDialogFactory").Ac().Lc(function(){return new ib(Wd.AFrameworkApplication.za.vW)});l.register(251,"Common.App.DirectPrint.IDirectPrintManager").Ac().Lc(function(){return ma.create(K.pb)})};Sa.prototype.init=function(){this.ZXd=this.pb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.ZXd.start()};Sa.prototype.dispose=function(){};Jl.Object.defineProperties(Sa.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(fe.a)(Sa,"PackageManager",null,[8,9]);var nj=b(588),ck=Ba.a;Cm(oa,ck);oa.prototype.setFocus=function(){this.Kv.checked?nh.DOMElementExtensions.setFocus(this.Kv):nh.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Jl.Object.defineProperties(oa.prototype,{je:{configurable:!0,enumerable:!0,get:function(){return this.vNb}}});oa.h1b="printCurrentSelection";Object(fe.a)(oa,"BasePrintDialog",Ba.a,
[]);var Sj=b(222);Cm(ja,oa);ja.prototype.initialize=function(){qd.ULS.sendTraceTag(51499289,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.yVh();this.ZVa(1153);this.addButton(1);oa.prototype.initialize.call(this)};ja.prototype.qga=function(){var l=this;return function(K,ka,$a){var Lb=l.$.ra.xa,bc=l.Mm;K=l.dia(K);ka=l.C$(ka);var Dc=l.je,wd=Lb.Ra(1,null);wd.printOptions=bc;return Ef.i(Lb,"ValidatePrint",wd,K,ka,$a,Dc,0)}};ja.prototype.commit=function(){this.WNg();return!0};
ja.prototype.Mx=function(l,K,ka){var $a=l.Result;if($a&&K){var Lb=0,bc=0;$a.SelectedRanges&&$a.SelectedRanges.Ranges&&0<$a.SelectedRanges.Ranges.length&&$a.SelectedRanges.Ranges[0]&&(Lb=Math.min(ja.WQf($a.SelectedRanges.Ranges[0]),65535));$a.UsedRange&&(bc=Math.min(ja.WQf(Qb.j(Qb.D($a.UsedRange))),65535));Sj.h(K,Lb);Sj.i(K,bc)}this.Mm=$a;oa.prototype.Mx.call(this,l,K,ka)};ja.prototype.setFocus=function(){this.dqb.checked?nh.DOMElementExtensions.setFocus(this.dqb):oa.prototype.setFocus.call(this)};
ja.prototype.yVh=function(){this.Qb.innerHTML=ja.JHi(this.$.fa.isNamedObjectViewMode);this.Kv=nh.DOMElementExtensions.getElementById(this.Qb,oa.h1b);this.dqb=nh.DOMElementExtensions.getElementById(this.Qb,"printEntireItem");this.Mm.Type&&this.Mm.UseSelection?(this.Kv.checked=!0,this.dqb.disabled=!this.Mm.SheetName):(this.dqb.checked=!0,this.Kv.disabled=!this.Mm.Type||!ag.g(this.$).ga.ya.Eh)};ja.prototype.WNg=function(){qd.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");
var l=new Sys.StringBuilder;this.Rrh(l);var K=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Sd.a.Pf?0:1);xe.HelperMethods.wf(l.toString(),"",K,"PrintDialog.PrintViewUrl")||qd.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};ja.prototype.Rrh=function(l){var K=this.$.Ba;l.append(this.$.G_+K.LayoutsRelativeUri+"/xlprintview.aspx?");Ig.a.Bg(l,vc.a.gKi,this.Mm.SessionId);Ig.a.Bg(l,vc.a.iKi,this.Kv.checked?
"1":"0");if(this.Mm.Type){if(!this.Mm.UsedRangeTooBig){var ka=Qb.D(this.Mm.UsedRange);(ka=Qb.x(ka,this.Mm.SheetName))&&Ig.a.Bg(l,vc.a.jKi,ka)}1===this.Mm.Type?Ig.a.Bg(l,vc.a.eKi,this.Mm.ObjectId):(ka=Qb.B(this.Mm.SelectedRanges.Ranges[0]),ka=Qb.x(ka,this.Mm.SheetName),Ig.a.Bg(l,vc.a.fKi,ka))}else Ig.a.Bg(l,vc.a.dKi,this.Mm.ObjectId);rj.a.yEa(l,K);Ig.a.Bg(l,vc.a.hKi,this.Mm.Title)};ja.JHi=function(l){return String.format("<div class='"+jb.a.Ey+"'>{0}</div>\r\n\t<div class='"+jb.a.q3c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
Te.a.instance.da(1154),oa.h1b,Te.a.instance.da(1157),"printEntireItem",l?Te.a.instance.da(1156):Te.a.instance.da(1155))};ja.WQf=function(l){return(l.LastColumn-l.FirstColumn+1)*(l.LastRow-l.FirstRow+1)};Jl.Object.defineProperties(ja.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(fe.a)(ja,"HtmlPrintDialog",oa,[]);var Di=b(573),Bi=b(67);X.EIi="PrintDialogBody";X.printDialogTitle="PrintDialogTitle";X.b4b="ewa-dlg-elements-container-rtl";X.FIi="PrintDialogLeftContainer";
X.GIi="PrintDialogRightContainer";X.e8a="PrintDialogRadioButtonContainer";X.Gyf="PrintRadioButtonElementInnerDiv";X.LIi="PrintRadioButtonElementOuterDiv";X.f8a="PrintDialogTitleSection";X.Vxd="PrintDialogComboBoxContainer";X.MIi="PrintRadioButtonIcon";X.DIi="PrintButtonArea";X.IV="PrintPreviewerContainer";Object(fe.a)(X,"CssClassNames",null,[]);var jk=b(882),Mk=b(286),xk=b(999),Nk=b(836);ea.prototype.getSheetName=function(){return this.sheetName};ea.prototype.getPrintSettings=function(){return this.printSettings};
Object(fe.a)(ea,"MacroRecorderSheetPrintSettingsSavedPayload",null,[115]);Cm(P,oa);P.prototype.initialize=function(){this.B6&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&P.MUg(this.Qb);this.Ne?this.Mse(968,null):(this.Tk(),this.ZVa(968));oa.prototype.initialize.call(this)};P.prototype.dispose=function(){this.Ntj();oa.prototype.dispose.call(this)};P.prototype.close=function(l){qd.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.f_,l?"without":"with");this.o1i();if(this.Mr){var K=this.bxh();!this.jLd&&!this.f$.checked&&this.$.isEditMode&&this.Hcd(K)&&this.f1i(K)}oa.prototype.close.call(this,l)};P.prototype.qga=function(){var l=this;return function(K,ka,$a){return R(l.$.ra.xa,l.$.Aa.sa.name,l.locale,l.dia(K),l.C$(ka),$a,null)}};P.prototype.Mx=function(l,K,ka){this.Mr=l.Result;this.SFb=this.Mr.ScalingWidth;this.RFb=this.Mr.ScalingHeight;this.i6c();this.gVh();oa.prototype.Mx.call(this,l,K,ka)};P.prototype.Tk=function(){qd.ULS.sendTraceTag(51499292,
0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.zVh();oa.prototype.Tk.call(this)};P.prototype.commit=function(){this.VNg();return!0};P.prototype.setFocus=function(){this.Ne?Ek.a.dvc(this.Pba):this.Pba.checked?nh.DOMElementExtensions.setFocus(this.Pba):oa.prototype.setFocus.call(this)};P.prototype.NWh=function(){switch(this.XM.mv){case 1:this.Pba.checked=!0;break;case 0:this.Kv.disabled?this.Pba.checked=!0:this.Kv.checked=!0;break;case 2:this.f$.checked=!0;break;
default:qd.ULS.sendTraceTag(595194763,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.XM.mv),this.XM.mv=1,this.Pba.checked=!0}};P.prototype.o1i=function(){this.XM.mv=this.FTc();this.B6&&(this.XM.ignorePrintArea=this.G2a.checked)};P.prototype.i6c=function(){if(100!==this.Mr.ScalingPercent||this.Mr.FitToPage&&(1<this.Mr.ScalingWidth||1<this.Mr.ScalingHeight))this.jLd=!0,this.Mr.ScalingWidth=P.o0c,this.Mr.ScalingHeight=P.n0c,this.Mr.ScalingPercent=P.I1b,this.Mr.FitToPage=P.i0c;this.Mr.PaperSize.toString()in
this.Dvd||(this.jLd=!0,this.Mr.PaperSize=this.Mr.PaperSize===P.MAg?34:P.Xob)};P.prototype.gVh=function(){this.Mxa=this.Mr.IsLandscape?2:1;this.e_=this.Mr.FitToPage?1===this.Mr.ScalingWidth&&1===this.Mr.ScalingHeight?1:this.Mr.ScalingWidth||1!==this.Mr.ScalingHeight?2:3:0;this.gla=this.Mr.PaperSize;this.m2c(this.f$.checked?!0:!1);this.aHd(this.f$.checked?!0:!1)};P.prototype.NVh=function(){this.Z$b.disabled=this.Kv.checked;this.bDb=this.G2a.checked=this.XM.ignorePrintArea};P.prototype.rXg=function(l){this.Cya=
document.createElement("select");this.Cya.style.width=224+Bi.a.nf;this.Cya.style.height=32+Bi.a.nf;this.Cya.setAttribute(vc.a.DD,"scalingElementId");this.Bya=new Nk.a(this.Cya,!0);for(var K=0,ka=P.scalingOptions.length;K<ka;++K){var $a=Te.a.instance.da(P.P1i[K]);this.Bya.oL($a,P.scalingOptions[K].toString(),!1)}l.appendChild(this.Cya)};P.prototype.Rve=function(l){this.wxa=document.createElement("select");this.wxa.style.width=224+Bi.a.nf;this.wxa.style.height=32+Bi.a.nf;this.wxa.setAttribute(vc.a.DD,
"paperSizeElementId");this.vxa=new Nk.a(this.wxa,!0);for(var K=0,ka=P.paperSizeOptions.length;K<ka;++K){var $a=Te.a.instance.da(P.FDi[K]);this.vxa.oL($a,P.paperSizeOptions[K].toString(),!1)}l.appendChild(this.wxa)};P.prototype.bxh=function(){var l={};l.IsLandscape=2===this.Mxa;l.PaperSize=this.gla;l.ScalingWidth=this.SFb;l.ScalingHeight=this.RFb;l.ScalingPercent=100;l.FitToPage=this.e_?!0:!1;return l};P.prototype.WFa=function(){var l=new Sys.StringBuilder;l.append(xk.a(this.$,"Pdf",!0));this.lha.$rc()&&
Ig.a.Bg(l,ye.a.d4f,"1");Ig.a.Bg(l,ye.a.Kyd,""+this.L5);Ig.a.Bg(l,ye.a.Tzf,this.$.Aa.sa.name);this.L5||(Ig.a.Bg(l,ye.a.Szf,this.selectedRange),Ig.a.Bg(l,ye.a.Mzf,this.activeCell));Ig.a.Bg(l,ye.a.Nzf,""+this.Mxa);Ig.a.Bg(l,ye.a.Ozf,""+this.gla);Ig.a.Bg(l,ye.a.Rzf,""+this.e_);Ig.a.Bg(l,ye.a.Qzf,"1");Ig.a.Bg(l,ye.a.Lzf,this.bDb?"1":"0");Ig.a.Bg(l,ye.a.Pzf,"1");qd.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",l.toString());return l.toString()};P.prototype.jvb=function(){var l=this,
K=null;qd.ULS.sendTraceTag(51676162,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.oc(new rf.a(223,0,function(ka,$a,Lb){ka=new Mk.a(ka,null,$a,Lb,null,!0,!1,"GetFileCopyFileHandler","");ka.correlationID=yj.a.create().toString();K=ka;Wd.AFrameworkApplication.Md.J8(l.WFa(),1,null,null,P.B5c,!1,2,Object(fd.a)(l,l.gtd,"onFileHandlerSuccessCallback"),Object(fd.a)(l,l.ftd,"onFileHandlerFailureCallback"),K,void 0,void 0,void 0,12E4);return we.Task.Ua(!0)},
16),null)};P.prototype.zVh=function(){qd.ULS.sendTraceTag(51499293,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.IHi(this.Qb);this.m2c(!0);this.aHd(!0);this.Kv=nh.DOMElementExtensions.getElementById(this.Qb,oa.h1b);this.Pba=nh.DOMElementExtensions.getElementById(this.Qb,"printActiveSheet");this.f$=nh.DOMElementExtensions.getElementById(this.Qb,"printEntireWorkbook");this.B6&&(this.Z$b=nh.DOMElementExtensions.getElementById(this.Qb,"ignorePrintAreaCheckboxButtonId"),
this.G2a=new jk.a(this.Z$b));this.Crc()&&(this.Kv.disabled=!0,this.Mm.SheetName=this.sheetName);this.NWh();this.B6&&this.NVh();this.iQi()};P.prototype.Crc=function(){return!!this.Mm.ObjectId||!ag.g(this.$).ga.ya.Eh};P.prototype.iQi=function(){Di.a.instance.qa(ef.a.change,this.Pba,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));Di.a.instance.qa(ef.a.change,this.f$,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));Di.a.instance.qa(ef.a.change,this.Kv,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));
Di.a.instance.qa(ef.a.change,this.Qva,Object(fd.a)(this,this.Nhc,"onChangeOrientation"));Di.a.instance.qa(ef.a.change,this.O7a,Object(fd.a)(this,this.Nhc,"onChangeOrientation"));Di.a.instance.qa(ef.a.change,this.wxa,Object(fd.a)(this,this.Akf,"onChangePaperSize"));Di.a.instance.qa(ef.a.change,this.Cya,Object(fd.a)(this,this.Bkf,"onChangeScaling"));this.B6&&this.G2a.pkb(Object(fd.a)(this,this.zkf,"onChangeIgnorePrintArea"))};P.prototype.t6a=function(){this.f_++;this.L5=this.FTc();this.m2c(this.f$.checked?
!0:!1);this.B6&&(this.Z$b.disabled=this.Kv.checked);this.aHd(this.f$.checked?!0:!1);qd.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",this.L5.toString());return!0};P.prototype.zkf=function(){this.f_++;this.bDb=this.G2a.checked;qd.ULS.sendTraceTag(573309013,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",this.bDb.toString())};P.prototype.Nhc=function(){this.f_++;this.Mxa=this.ine();qd.ULS.sendTraceTag(595079450,
0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",this.Mxa.toString());return!0};P.prototype.Akf=function(){this.f_++;var l=this.gla;this.gla=P.paperSizeOptions[this.vxa.selectedIndex];qd.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",l.toString(),this.gla.toString());return!0};P.prototype.Bkf=function(){this.f_++;var l=this.e_;this.e_=P.scalingOptions[this.Bya.selectedIndex];2===this.e_?(this.SFb=1,this.RFb=0):
3===this.e_?(this.SFb=0,this.RFb=1):1===this.e_&&(this.RFb=this.SFb=1);qd.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",l.toString(),this.e_.toString());return!0};P.prototype.Ntj=function(){Di.a.instance.Ca(ef.a.change,this.Pba,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));Di.a.instance.Ca(ef.a.change,this.f$,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));Di.a.instance.Ca(ef.a.change,this.Kv,Object(fd.a)(this,this.t6a,"onChangeWhatToPrint"));
Di.a.instance.Ca(ef.a.change,this.Qva,Object(fd.a)(this,this.Nhc,"onChangeOrientation"));Di.a.instance.Ca(ef.a.change,this.O7a,Object(fd.a)(this,this.Nhc,"onChangeOrientation"));Di.a.instance.Ca(ef.a.change,this.wxa,Object(fd.a)(this,this.Akf,"onChangePaperSize"));Di.a.instance.Ca(ef.a.change,this.Cya,Object(fd.a)(this,this.Bkf,"onChangeScaling"));this.B6&&this.G2a.ica(Object(fd.a)(this,this.zkf,"onChangeIgnorePrintArea"))};P.prototype.IHi=function(l){Sys.UI.DomElement.addCssClass(l,X.EIi);if(!this.Ne){var K=
document.getElementById("ewaDialogTitle");Sys.UI.DomElement.addCssClass(K,X.printDialogTitle);K=document.getElementById("ewaDialogCloseButtonLink");K.style.top=32+Bi.a.nf;this.rtl?K.style.left=32+Bi.a.nf:K.style.right=32+Bi.a.nf}K=P.By(X.FIi);l.appendChild(K);var ka=P.By(X.f8a,1161);ka.style.marginBottom=12+Bi.a.nf;ka.id="whatToPrintTitleElementId";K.appendChild(ka);ka=P.By(X.e8a);K.appendChild(ka);P.uob(ka,this.rtl,"printActiveSheet",1165,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32",
"activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");K.appendChild(document.createElement("BR"));ka=P.By(X.e8a);K.appendChild(ka);P.uob(ka,this.rtl,"printEntireWorkbook",1158,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");K.appendChild(document.createElement("BR"));ka=P.By(X.e8a);K.appendChild(ka);P.uob(ka,this.rtl,oa.h1b,1157,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId",
"whatToPrintTitleElementId");this.B6?(ka=P.By(X.f8a,1190),ka.style.marginTop=24+Bi.a.nf,ka.id="printAreaElementId",K.appendChild(ka),yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(ka.style.marginBottom=12+Bi.a.nf,ka=P.By(jb.a.r3c),ka.id="ignorePrintAreaCheckboxWarpperId",nh.DOMElementExtensions.setVisible(ka,!0),K.appendChild(ka),K=this.getElementById("ignorePrintAreaCheckboxButtonId"),nh.DOMElementExtensions.setVisible(K,!0),ka.appendChild(K),K=this.getElementById("ignorePrintAreaCheckboxLabelId"),
nh.DOMElementExtensions.setVisible(K,!0),ka.appendChild(K)):(ka=P.By(X.e8a),K.appendChild(ka),P.DSg(ka,this.rtl))):(ka=P.By(X.f8a,1163),ka.style.marginTop=24+Bi.a.nf,ka.id="paperSizeElementId",K.appendChild(ka),ka=P.By(X.Vxd),this.Rve(ka),K.appendChild(ka));K=P.By(X.GIi);l.appendChild(K);l=P.By(X.f8a,1162);l.style.marginBottom=12+Bi.a.nf;l.id="orientationTitleElementId";K.appendChild(l);l=P.By(X.e8a);K.appendChild(l);P.uob(l,this.rtl,"portraitRadioButtonId",1168,"orientationRbName","Portrait_32x32x32",
"portraitRadioButtonInnerLabelElementId","orientationTitleElementId");K.appendChild(document.createElement("BR"));l=P.By(X.e8a);K.appendChild(l);P.uob(l,this.rtl,"landscapeRadioButtonId",1167,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.B6&&(l=P.By(X.f8a,1163),l.style.marginTop=12+Bi.a.nf,l.id="paperSizeElementId",K.appendChild(l),l=P.By(X.Vxd),this.Rve(l),K.appendChild(l));l=P.By(X.f8a,1164);l.style.marginTop=(this.B6?10:74)+
Bi.a.nf;l.id="scalingElementId";K.appendChild(l);l=P.By(X.Vxd);this.rXg(l);K.appendChild(l);this.Ne||(l=document.getElementById("buttonarea"),Sys.UI.DomElement.addCssClass(l,X.DIi));this.Qva=nh.DOMElementExtensions.getElementById(this.Qb,"landscapeRadioButtonId");this.O7a=nh.DOMElementExtensions.getElementById(this.Qb,"portraitRadioButtonId")};P.prototype.VNg=function(){var l=this;qd.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.L5=this.FTc();
2!==this.L5&&(this.Mxa=this.ine(),this.vxa&&(this.gla=P.paperSizeOptions[this.vxa.selectedIndex]),this.Bya&&(this.e_=P.scalingOptions[this.Bya.selectedIndex]));if(this.$.bva&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var K=this.$.ra.xa.dc();this.$.userOperationManager.oc(new rf.a(133,0,function(ka,$a,Lb){var bc={};bc.WhatToPrint=l.L5;bc.UseNamedAction=l.lha.$rc();bc.SelectedSheetName=l.$.Aa.sa.name;bc.ActiveCell=l.activeCell;bc.SelectedRanges=
[l.selectedRange];bc.IsPdfDocumentRequired=!1;bc.Orientation=l.Mxa;bc.PaperSize=l.gla;bc.Scaling=l.e_;bc.RichValuesEnabled=!0;l.B6&&(bc.IgnorePrintArea=l.bDb);return ba(l.$.ra.xa,bc,Tf.b(Object(fd.a)(l,l.tAb,"onConvertWorkbookToPdfSucceeded"),ka),$a,Lb,K)},16),null)}else this.jvb()};P.prototype.gtd=function(l){if(l&&l.data&&l.data.pe&&l.data.responseHeaders&&l.data.pe.length){if(l.data.responseHeaders["Content-Type"]&&Re.a.contains(l.data.responseHeaders["Content-Type"].toString(),"application/pdf",
!0)){qd.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");var K={};this.tAb(K,null,null)}else K=pk.a.gi(l.data.pe),qd.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",K.Errors[0].MessageId);l=l.data.state;l.G3c(K,l.userContext,l.methodName)}else qd.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",l?l.data?l.data.pe?
l.data.responseHeaders?l.data.pe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};P.prototype.ftd=function(l){var K=rj.a.Eg(l.data);qd.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Bd.a.fd(K));K=l.data.state;K.o$(l,K.userContext,K.methodName)};P.prototype.m2c=function(l){this.O7a.disabled=
l;this.Qva.disabled=l;this.vxa.Kn.disabled=l;this.Bya.Kn.disabled=l};P.prototype.aHd=function(l){l?(this.Qva.checked=!1,this.O7a.checked=!1,this.vxa.selectedIndex=-1,this.Bya.selectedIndex=-1):(2===this.Mxa?this.Qva.checked=!0:this.O7a.checked=!0,this.vxa.selectedIndex=this.Dvd[this.gla.toString()],this.Bya.selectedIndex=this.e_)};P.prototype.f1i=function(l){var K=this;qd.ULS.sendTraceTag(595079447,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");
var ka=this.$.Aa.sa.name,$a=this.$.ra.xa.dc();this.$.userOperationManager.oc(new rf.a(226,0,function(Lb,bc,Dc){return ha(K.$.ra.xa,ka,l,Lb,bc,Dc,$a)},void 0,function(){return new ea(ka,l)}),null)};P.prototype.Hcd=function(l){return this.Mr.IsLandscape!==l.IsLandscape||this.Mr.PaperSize!==l.PaperSize||this.Mr.FitToPage!==l.FitToPage||this.Mr.ScalingHeight!==l.ScalingHeight||this.Mr.ScalingWidth!==l.ScalingWidth?!0:!1};P.prototype.ine=function(){return this.Qva&&this.Qva.checked?2:1};P.prototype.FTc=
function(){return this.Kv.checked?0:this.Pba.checked?1:this.f$.checked?2:1};P.prototype.tAb=function(l){l.Errors&&0<l.Errors.length?qd.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",l.Errors[0].MessageId):(6===this.je.qf&&Wd.AFrameworkApplication.za.Te.Zj(ag.g(this.$).hLf),qd.ULS.shipAssertTag(572384396,0,!!this.$.Aa.sa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),this.$.Aa.sa&&this.lha.OTf(this.WFa()))};
P.By=function(l,K){l=void 0===l?null:l;K=void 0===K?0:K;var ka=document.createElement("div");Re.a.na(l)||(ka.className=l);K&&(ka.innerHTML=Te.a.instance.da(K));return ka};P.MUg=function(l){var K=document.createElement("input");K.setAttribute("type","checkbox");K.className=jb.a.qEe;K.id="ignorePrintAreaCheckboxButtonId";K.setAttribute("name","ignorePrintAreaCbName");K.style.height=16+Bi.a.nf;K.style.width=16+Bi.a.nf;nh.DOMElementExtensions.setVisible(K,!1);var ka=Te.a.instance.da(1190),$a=Te.a.instance.da(1191);
K.setAttribute(vc.a.Av,ka+Bi.a.space+$a);l.appendChild(K);K=document.createElement("label");K.setAttribute("for","ignorePrintAreaCheckboxButtonId");K.id="ignorePrintAreaCheckboxLabelId";K.innerHTML=$a;K.setAttribute(vc.a.LO,!0);K.style.position="relative";K.style.marginLeft=15+Bi.a.nf;nh.DOMElementExtensions.setVisible(K,!1);l.appendChild(K)};P.DSg=function(l,K){var ka=document.createElement("input");ka.setAttribute("type","checkbox");ka.id="ignorePrintAreaCheckboxButtonId";ka.setAttribute("name",
"ignorePrintAreaCbName");ka.setAttribute(vc.a.DD,"printAreaElementId"+Bi.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");ka.style.height=16+Bi.a.nf;ka.style.width=16+Bi.a.nf;K?ka.style.marginRight=0+Bi.a.nf:ka.style.marginLeft=0+Bi.a.nf;l.appendChild(ka);K=document.createElement("label");K.setAttribute("for","ignorePrintAreaCheckboxButtonId");K.setAttribute(vc.a.LO,!0);K.style.position="relative";K.style.marginLeft=15+Bi.a.nf;l.appendChild(K);l=P.By(X.Gyf,1191);l.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";
K.appendChild(l)};P.uob=function(l,K,ka,$a,Lb,bc,Dc,wd){var ke=document.createElement("input");ke.setAttribute("type","radio");ke.id=ka;ke.setAttribute("name",Lb);ke.setAttribute(vc.a.DD,wd+Bi.a.space+Dc);ke.style.height=16+Bi.a.nf;ke.style.width=16+Bi.a.nf;K?ke.style.marginRight=0+Bi.a.nf:ke.style.marginLeft=0+Bi.a.nf;l.appendChild(ke);K=document.createElement("label");K.setAttribute("for",ka);K.style.position="relative";l.appendChild(K);l=Ib.createClusteredImage(32,32,bc,X.MIi,!0,Te.a.instance.da($a));
$a=P.By(X.Gyf,$a);$a.id=Dc;$a.setAttribute(vc.a.LO,!0);Dc=P.By(X.LIi);Dc.appendChild($a);K.appendChild(Dc);K.appendChild(l)};Jl.Object.defineProperties(P.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});P.o0c=1;P.n0c=0;P.I1b=100;P.Xob=9;P.i0c=!0;P.MAg=13;P.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];P.FDi=[1170,1171,1178,1172,1173,1174,1175,1176,1169,1179,1180,1181,1182,1183,1184,1185];P.scalingOptions=[0,1,2,3];P.P1i=[1186,1187,1188,1189];P.B5c=
["Content-Type"];Object(fe.a)(P,"PdfPrintDialog",oa,[]);Jl.Object.defineProperties(L.prototype,{mv:{configurable:!0,enumerable:!0,get:function(){return this.L5},set:function(l){0<=l&&2>=l?this.L5=l:(qd.ULS.sendTraceTag(595194761,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.L5=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.P_d},set:function(l){l||!l?this.P_d=l:qd.ULS.sendTraceTag(588777489,0,10,"Attempt to set invalid ignorePrintArea")}}});
Object(fe.a)(L,"PdfPrintDialogBrowserSessionState",null,[]);var kk=b(1347);Object(fe.a)(Y,"MacroRecorderPrintAreaSetPayload",null,[115]);Object(fe.a)(fa,"MacroRecorderPageBreakInsertedPayload",null,[115]);Object(fe.a)(T,"MacroRecorderPageBreakRemovedPayload",null,[115]);N.prototype.getSheetName=function(){return this.sheetName};Object(fe.a)(N,"MacroRecorderPageBreaksAllResetPayload",null,[115]);S.prototype.getSheetName=function(){return this.sheetName};Object(fe.a)(S,"MacroRecorderPrintAreaClearedPayload",
null,[115]);Object(fe.a)(W,"PageBreaksInformation",null,[]);Object(fe.a)(H,"RowColBreak",null,[]);Object(fe.a)(C,"SharedRange",null,[]);var Rk=b(125);B.prototype.executeCommand=function(l,K,ka,$a,Lb,bc,Dc){Lb=void 0===Lb?null:Lb;bc=void 0===bc?null:bc;Dc=void 0===Dc?null:Dc;this.WOd();this.ribbonCommandInfo=K;this.skj(K.command);l=Tf.b(Lb,Object(fd.a)(this,this.Irj,"triggerGridPerfTracking"));qd.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",K.command);
switch(K.command){case 78661008:return this.fYe(K,l,bc,Dc,!1);case 275604654:return this.fYe(K,l,bc,Dc,!0);case -13332329:return this.jXe(K,l,bc,Dc);case -837651977:return this.HNh(K,l,bc,Dc);case -1778266776:return this.yOh(K,l,bc,Dc);case 845325699:return this.aYe(K,l,bc,Dc)}return h.a(K.command)};B.prototype.Jc=function(l,K){switch(K.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===l;case 845325699:case -13332329:return!0}return!1};B.prototype.vPf=function(l,K,
ka){var $a=ag.g(this.$),Lb=$a.Ha,bc=Qb.r($a.ga.ya.selectedRanges,this.$);if((Lb=Lb.lJ())&&Lb.length){Lb=Ml(Lb);for(var Dc=Lb.next();!Dc.done;Dc=Lb.next()){Dc=Dc.value;var wd=Dc.fg;if(wd){for(var ke=Qb.j(Dc.mg),jf=new Zg.a,Xf=Ml(bc.Ranges),Sf=Xf.next();!Sf.done;Sf=Xf.next()){var xg=Sf.value;xg.FirstRow>ke.LastRow+1||xg.LastRow<ke.FirstRow||xg.FirstColumn>ke.LastColumn+1||xg.LastColumn<ke.FirstColumn||(Sf=this.lFh(ke,xg,wd),xg=this.kFh(ke,xg,wd),jf.add(Object.assign(new C,{FirstRow:Sf.FirstRow,FirstColumn:xg.FirstColumn,
LastRow:Sf.LastRow,LastColumn:xg.LastColumn})))}0<jf.count&&!ka?wd.setPrintArea(jf.toArray()):0<jf.count&&ka?wd.addToPrintArea(jf.toArray()):!ka&&wd.hasPrintArea()&&wd.clearPrintArea();!wd.isDirty()&&wd.hasPageLayout()&&wd.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Dc.Od,4)}}this.UJb($a,l,K)}};B.prototype.xLg=function(l,K){var ka=ag.g(this.$),$a=ag.g(this.$).Ha.lJ();if($a&&$a.length){$a=Ml($a);for(var Lb=$a.next();!Lb.done;Lb=$a.next()){Lb=Lb.value;var bc=Lb.fg;bc&&(bc.clearPrintArea(),
!bc.isDirty()&&bc.hasPageLayout()&&bc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Lb.Od,4))}this.UJb(ka,l,K)}};B.prototype.qXh=function(l,K){var ka=ag.g(this.$),$a=ka.Ha,Lb=Qb.o(ka.ga.ya.activeCell,this.$);if(Lb){var bc=$a.lJ();if(bc&&bc.length){$a=null;for(var Dc=Ml(bc),wd=Dc.next();!wd.done;wd=Dc.next()){wd=wd.value;var ke=wd.fg;if(ke){var jf=Qb.j(wd.mg);if(!(Lb.FirstRow>jf.LastRow||Lb.FirstRow<jf.FirstRow||Lb.FirstColumn>jf.LastColumn||Lb.FirstColumn<jf.FirstColumn)&&
($a=this.dWg(ke,jf,Lb),ke.insertPageBreak($a),!ke.isDirty()&&ke.hasPageLayout()&&ke.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+wd.Od,4),$a))break}}if(!$a)for(bc=Ml(bc),wd=bc.next();!wd.done;wd=bc.next())if($a=wd.value,Dc=$a.fg)$a=Qb.j($a.mg),$a=this.Qve(Dc,$a,Lb),Dc.insertPageBreak($a);this.UJb(ka,l,K)}}};B.prototype.tSi=function(l,K){var ka=ag.g(this.$),$a=ka.Ha,Lb=Qb.o(ka.ga.ya.activeCell,this.$);if(Lb&&($a=$a.lJ())&&$a.length){$a=Ml($a);for(var bc=$a.next();!bc.done;bc=
$a.next()){bc=bc.value;var Dc=bc.fg;if(Dc){var wd=Qb.j(bc.mg);(wd=this.Qve(Dc,wd,Lb))&&Dc.removePageBreak(wd);!Dc.isDirty()&&Dc.hasPageLayout()&&Dc.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+bc.Od,4)}}this.UJb(ka,l,K)}};B.prototype.rYi=function(l,K){var ka=ag.g(this.$),$a=ka.Ha.lJ();if($a&&$a.length){$a=Ml($a);for(var Lb=$a.next();!Lb.done;Lb=$a.next()){Lb=Lb.value;var bc=Lb.fg;bc&&(bc.resetAllPageBreak(),!bc.isDirty()&&bc.hasPageLayout()&&bc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+
Lb.Od,4))}this.UJb(ka,l,K)}};B.prototype.fYe=function(l,K,ka,$a,Lb){if(!Lb){var bc=this.$.Ab.getItemByName("PRINT_AREA");if(bc&&(qd.ULS.sendTraceTag(543794887,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",bc.type),2===bc.type))return this.XYh(),we.Task.Ua(!0)}bc=ag.g(this.$).ga.ya;var Dc=Qb.r(bc.selectedRanges,this.$);if(1===Dc.Ranges.length&&!Lb){if(bc.Gva())return this.NOh(l,Dc,K,ka,$a,Lb),we.Task.Ua(!0);if(Qb.R(Dc.Ranges[0]))return this.$.Aa.sa.hasPrintArea?
this.jXe(l,K,ka,$a):we.Task.Ua(!0)}this.vPf(l.command,$a,Lb);return this.J2e(l,K,ka,Dc,Lb)};B.prototype.jXe=function(l,K,ka,$a){this.xLg(l.command,$a);return this.IYh(l,K,ka)};B.prototype.HNh=function(l,K,ka,$a){this.qXh(l.command,$a);return this.UYh(l,K,ka)};B.prototype.yOh=function(l,K,ka,$a){if(yd.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var Lb=Qb.r(ag.g(this.$).ga.ya.selectedRanges,this.$);if(Qb.R(Lb.Ranges[0]))return this.aYe(l,K,ka,
$a)}this.tSi(l.command,$a);return this.ZYh(l,K,ka)};B.prototype.aYe=function(l,K,ka,$a){this.rYi(l.command,$a);return this.aZh(l,K,ka)};B.prototype.J2e=function(l,K,ka,$a,Lb){function bc(){return new Y($a,Lb)}function Dc(ke,jf,Xf){ke=Tf.b(ke,K);jf=Tf.a(jf,ka);var Sf=wd.Ra(1,null);Sf.selectedRanges=$a;Sf.addToPrintArea=Lb;return Ef.i(wd,"SetPrintArea",Sf,ke,jf,Xf,null,0)}var wd=this.$.ra.xa;return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,Dc,function(ke){return new rf.a(241,0,ke,64,bc)},
l):qf.a(this.$.userOperationManager,Dc,function(ke){return new hj.a(241,0,ke,void 0,bc)},l)};B.prototype.IYh=function(l,K,ka){function $a(){return new S(bc)}function Lb(wd,ke,jf){wd=Tf.b(wd,K);ke=Tf.a(ke,ka);var Xf=Dc.Ra(1,null);Xf.sheetName=bc;return Ef.i(Dc,"ClearPrintArea",Xf,wd,ke,jf,null,0)}var bc=this.$.Aa.sa.name,Dc=this.$.ra.xa;return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,Lb,function(wd){return new rf.a(243,0,wd,64,$a)},l):qf.a(this.$.userOperationManager,Lb,function(wd){return new hj.a(243,
0,wd,void 0,$a)},l)};B.prototype.UYh=function(l,K,ka){function $a(){return new fa(wd)}function Lb(ke,jf,Xf){var Sf=bc.$.ra.xa;ke=Tf.b(ke,K);jf=Tf.a(jf,ka);var xg=Sf.Ra(9,null);xg.sheetCell=wd;return Ef.i(Sf,"InsertPageBreak",xg,ke,jf,Xf,null,0)}var bc=this,Dc=ag.g(this.$),wd=Qb.o(Dc.ga.ya.activeCell,this.$);return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,Lb,function(ke){return new rf.a(244,0,ke,64,$a)},l):qf.a(this.$.userOperationManager,Lb,function(ke){return new hj.a(244,0,ke,void 0,
$a)},l)};B.prototype.ZYh=function(l,K,ka){function $a(){return new T(wd)}function Lb(ke,jf,Xf){var Sf=bc.$.ra.xa;ke=Tf.b(ke,K);jf=Tf.a(jf,ka);var xg=Sf.Ra(9,null);xg.sheetCell=wd;return Ef.i(Sf,"RemovePageBreak",xg,ke,jf,Xf,null,0)}var bc=this,Dc=ag.g(this.$),wd=Qb.o(Dc.ga.ya.activeCell,this.$);return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,Lb,function(ke){return new rf.a(245,0,ke,64,$a)},l):qf.a(this.$.userOperationManager,Lb,function(ke){return new hj.a(245,0,ke,void 0,$a)},l)};B.prototype.aZh=
function(l,K,ka){function $a(){return new N(Dc)}function Lb(wd,ke,jf){var Xf=bc.$.ra.xa;wd=Tf.b(wd,K);ke=Tf.a(ke,ka);var Sf=Xf.Ra(9,null);Sf.sheetName=Dc;return Ef.i(Xf,"ResetAllPageBreaks",Sf,wd,ke,jf,null,0)}var bc=this,Dc=this.$.Aa.sa.name;return yd.EwaSettings.wc()?qf.a(this.$.userOperationManager,Lb,function(wd){return new rf.a(246,0,wd,64,$a)},l):qf.a(this.$.userOperationManager,Lb,function(wd){return new hj.a(246,0,wd,void 0,$a)},l)};B.prototype.lFh=function(l,K,ka){if(!l||!K||!ka)return null;
var $a=new C;$a.FirstRow=K.FirstRow===l.LastRow+1?ka.getRowIndex(l.LastRow+1)+1:K.FirstRow<l.FirstRow?0:ka.getRowIndex(K.FirstRow+1);$a.LastRow=K.FirstRow===l.LastRow+1||K.LastRow>l.LastRow?ka.getRowIndex(l.LastRow+1)+1:ka.getRowIndex(K.LastRow+1);return $a};B.prototype.kFh=function(l,K,ka){if(!l||!K||!ka)return null;var $a=new C;$a.FirstColumn=K.FirstColumn===l.LastColumn+1?ka.getColumnIndex(l.LastColumn+1)+1:K.FirstColumn<l.FirstColumn?0:ka.getColumnIndex(K.FirstColumn+1);$a.LastColumn=K.FirstColumn===
l.LastColumn+1||K.LastColumn>l.LastColumn?ka.getColumnIndex(l.LastColumn+1)+1:ka.getColumnIndex(K.LastColumn+1);return $a};B.prototype.dWg=function(l,K,ka){if(!K||!ka||!l)return null;var $a=l.getPrintArea();if(!$a||!$a.length)return null;var Lb=l.getRowIndex(ka.FirstRow+1),bc=l.getColumnIndex(ka.FirstColumn+1),Dc=null,wd=null;$a=Ml($a);for(var ke=$a.next();!ke.done;ke=$a.next())if(ke=ke.value,Lb>=ke.FirstRow&&Lb<=ke.LastRow&&bc>=ke.FirstColumn&&bc<=ke.LastColumn){if(ka.FirstRow===ke.FirstRow&&ka.FirstColumn===
ke.FirstColumn)return new W;Lb>ke.FirstRow&&(Dc=Object.assign(new H,{Index:Lb-1,Min:ke.FirstColumn-1,Max:Math.min(ke.LastColumn,l.getColumnIndex(K.LastColumn+1))}));bc>ke.FirstColumn&&(wd=Object.assign(new H,{Index:bc-1,Min:ke.FirstRow-1,Max:Math.min(ke.LastRow,l.getRowIndex(K.LastRow+1))}));break}return Dc||wd?Object.assign(new W,{Row:Dc?[Dc]:null,Col:wd?[wd]:null}):null};B.prototype.nXg=function(l,K,ka){if(!K||!ka||!l)return null;var $a=null;ka.FirstRow>K.FirstRow&&ka.FirstRow<=K.LastRow?$a=Object.assign(new H,
{Index:l.getRowIndex(ka.FirstRow+1)-1,Min:-1,Max:-1}):ka.FirstRow===K.LastRow+1&&($a=Object.assign(new H,{Index:l.getRowIndex(K.LastRow+1),Min:-1,Max:-1}));return $a};B.prototype.KSg=function(l,K,ka){if(!K||!ka||!l)return null;var $a=null;ka.FirstColumn>K.FirstColumn&&ka.FirstColumn<=K.LastColumn?$a=Object.assign(new H,{Index:l.getColumnIndex(ka.FirstColumn+1)-1,Min:-1,Max:-1}):ka.FirstColumn===K.LastColumn+1&&($a=Object.assign(new H,{Index:l.getColumnIndex(K.LastColumn+1),Min:-1,Max:-1}));return $a};
B.prototype.Qve=function(l,K,ka){if(!ka||!l||!K)return null;var $a=this.nXg(l,K,ka);l=this.KSg(l,K,ka);return $a||l?Object.assign(new W,{Row:$a?[$a]:null,Col:l?[l]:null}):null};B.prototype.XYh=function(){var l=new Be.StandardDialog;l.lc=0;l.Dc(1,Te.a.instance.da(4));l.Hl(Te.a.instance.da(547),Te.a.instance.da(548),1,null)};B.prototype.skj=function(l){if(this.lua.tb(l)&&(this.pHf&&(this.WBb=this.$.Zb.Ic("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.fJa.tb(l)&&this.fJa.remove(l),this.fJa.add(l,
yj.a.create().toString()),ag.g(this.$).Ui)){var K=Xg.b()?Xg.b().ji(l):"";ag.g(this.$).Ui.Xca(this.lua.oa(l),this.fJa.oa(l),K)}};B.prototype.IJg=function(l){if(this.WBb&&l){var K=this.WBb.Gc;this.WBb.stop();this.WBb=null;switch(l){case "SetPrintArea":this.Tmb(K,1700,l);break;case "ClearPrintArea":this.Tmb(K,1500,l);break;case "InsertPageBreak":this.Tmb(K,1500,l);break;case "RemovePageBreak":this.Tmb(K,1600,l);break;case "ResetAllPageBreaks":this.Tmb(K,1700,l)}}};B.prototype.Tmb=function(l,K,ka){l>
K&&(K=Object.assign(new Sh.a,{extendedProperties:new Map}),K.extendedProperties.set("OperationName",ka),K.extendedProperties.set("OperationExecutionTime",l.toString()),mh.Health.instance.recordQosError(Eb.a.gjj,[jc.a.bjj],!1,!0,!0,!1,K))};B.prototype.Irj=function(l,K,ka){K=!!l&&!!l.RequestTelemetryData;ag.g(this.$).Ui&&ag.g(this.$).Ui.fka(this.fJa.oa(this.ribbonCommandInfo.command),l.StateId,K?l.RequestTelemetryData.EcsOperationDuration:0,K?l.RequestTelemetryData.EcsRequestDuration:0,K?l.RequestTelemetryData.WfeRequestDuration:
0);this.pHf&&this.IJg(ka)};B.prototype.NOh=function(l,K,ka,$a,Lb,bc){var Dc=this,wd=new Be.StandardDialog,ke=new kk.a(Te.a.instance.da(545),Te.a.instance.da(546),Te.a.instance.da(6),Te.a.instance.da(5));wd.lc=1;wd.Dc(1,ke.confirmButton);wd.Dc(0,ke.cancelButton);wd.Hl(ke.title,ke.body,3,function(jf){1===jf&&(Dc.vPf(l.command,Lb,bc),Dc.J2e(l,ka,$a,K,bc))})};B.prototype.UJb=function(l,K,ka){ka();this.fJa.tb(K)&&l.Ui.S_(this.fJa.oa(K),Ai.BasicTelemetryCalculator.bQ)};B.prototype.WOd=function(){this.ijd&&
this.$.Re(-1753588160,-1,0,null)};Object(fe.a)(B,"PrintAreaBreakManager",null,[303]);var lk=b(382);J.prototype.equals=function(l){return l?this.orientation===l.orientation&&this.Aba===l.Aba&&this.x_===l.x_&&this.margin===l.margin&&this.sheetPrintOptions===l.sheetPrintOptions&&this.XZa===l.XZa:!1};J.Ute=function(l,K){l&&K&&(K.mv=l.mv,K.orientation=l.orientation,K.Aba=l.Aba,K.x_=l.x_,K.margin=l.margin,K.ignorePrintArea=l.ignorePrintArea,K.sheetPrintOptions=l.sheetPrintOptions,K.XZa=l.XZa)};Object(fe.a)(J,
"PrintSettingsContainer",null,[]);var Ii=b(148),Tj=b(335),Fk=b(930),Kk=b(891),Yk=b(787);Object(fe.a)(z,"PrintSettingMarginOption",null,[]);Object(fe.a)(x,"PrintSettingMarginValue",null,[]);Object(fe.a)(y,"PrintSettingOption",null,[]);A.prototype.dispose=function(){};A.prototype.Psb=function(l){if(!l)return null;var K=new x;K.left=l.Left;K.right=l.Right;K.top=l.Top;K.bottom=l.Bottom;K.header=l.Header;K.footer=l.Footer;return K};A.prototype.yZc=function(l){qd.ULS.shipAssertTag(545116432,0,6===l.length,
"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var K={};K.Top=l[0];K.Bottom=l[1];K.Left=l[2];K.Right=l[3];K.Header=l[4];K.Footer=l[5];return K};A.prototype.hWh=function(){this.ibe=[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Rm.da(1165)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Rm.da(1158)}),Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Rm.da(1157)})];this.F5d=
[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Rm.da(1168)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Rm.da(1167)})];this.W5d=[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Rm.da(1170)}),Object.assign(new y,{printSettingOptionKey:5,printSettingOptionText:this.Rm.da(1171)}),Object.assign(new y,{printSettingOptionKey:6,printSettingOptionText:this.Rm.da(1178)}),Object.assign(new y,{printSettingOptionKey:7,printSettingOptionText:this.Rm.da(1172)}),
Object.assign(new y,{printSettingOptionKey:8,printSettingOptionText:this.Rm.da(1173)}),Object.assign(new y,{printSettingOptionKey:9,printSettingOptionText:this.Rm.da(1174)}),Object.assign(new y,{printSettingOptionKey:11,printSettingOptionText:this.Rm.da(1175)}),Object.assign(new y,{printSettingOptionKey:12,printSettingOptionText:this.Rm.da(1176)}),Object.assign(new y,{printSettingOptionKey:13,printSettingOptionText:this.Rm.da(1177)}),Object.assign(new y,{printSettingOptionKey:3,printSettingOptionText:this.Rm.da(1169)})];
this.D8d=[Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Rm.da(1186)}),Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Rm.da(1187)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Rm.da(1188)}),Object.assign(new y,{printSettingOptionKey:3,printSettingOptionText:this.Rm.da(1189)})];this.A3d=[Object.assign(new z,{printSettingOption:Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Rm.da(1192)}),marginValue:this.Psb(this.normal)}),
Object.assign(new z,{printSettingOption:Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Rm.da(1193)}),marginValue:this.Psb(this.wide)}),Object.assign(new z,{printSettingOption:Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Rm.da(1194)}),marginValue:this.Psb(this.narrow)}),Object.assign(new z,{printSettingOption:Object.assign(new y,{printSettingOptionKey:3,printSettingOptionText:this.Rm.da(1195)}),marginValue:this.Psb(this.J5)})]};A.prototype.aWh=
function(){this.normal=this.yZc(this.Yki);this.narrow=this.yZc(this.Kji);this.wide=this.yZc(this.xCj)};Jl.Object.defineProperties(A.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.ibe}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.F5d}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.W5d}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.D8d}},marginDetailedOptions:{configurable:!0,
enumerable:!0,get:function(){return this.A3d}}});A.v0g=1;A.h0g=1;A.Xob=9;A.m0g=2;A.g0g=0;A.$_g=!1;A.X_g=!1;A.xGa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(fe.a)(A,"PrintSettingsManagerBase",null,[7]);var n=b(123);v.prototype.getSheetName=function(){return this.sheetName};Object(fe.a)(v,"MacroRecorderSheetPrintOptionsSavedPayload",null,[115]);Cm(w,A);w.prototype.NYh=function(l){var K=this;this.OYh(function(ka){l&&(ka=K.qFh(ka),l(ka))})};w.prototype.cFd=function(l,
K){if(l){var ka=new L(l.mv,l.ignorePrintArea);this.e1i(ka);if(!K||this.JUf)qd.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",K?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false");else{K=this.sFh(l.x_);K.IsLandscape=2===l.orientation;K.PaperSize=l.Aba;this.tva&&(K.PageMargin=this.T$c(l.margin));if(yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",!1)||yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",
!1))K.SheetPrintOptions=A.xGa,K.SheetPrintOptions.PrintGrid=l.sheetPrintOptions.PrintGrid,K.SheetPrintOptions.HorizontalCenter=l.sheetPrintOptions.HorizontalCenter,K.SheetPrintOptions.VerticalCenter=l.sheetPrintOptions.VerticalCenter,K.SheetPrintOptions.PrintHeaders=l.sheetPrintOptions.PrintHeaders;this.d1i(K)}}else qd.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};w.prototype.T$c=function(l){var K={};l?1===l?K=this.wide:
2===l?K=this.narrow:3===l&&(K=this.J5):K=this.normal;return K};w.prototype.eZh=function(l){var K=this;if(l){qd.ULS.sendTraceTag(544032543,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var ka=function(){return new v(K.$.Aa.sa.name,l)},$a=this.$.ra.xa,Lb=this.$.ra.xa.dc(),bc=function(Dc,wd,ke){var jf=K.$.Aa.sa.name;Dc=Tf.b(Object(fd.a)(K,K.gud,"onPrintOptionsUpdationSuccess"),Dc);wd=Tf.a(Object(fd.a)(K,K.pud,"onSavePrintOptionsToFileFailure"),
wd);var Xf=$a.Ra(1,null);Xf.sheetName=jf;Xf.printOptions=l;return Ef.i($a,"SetPrintOptions",Xf,Dc,wd,ke,Lb,0)};ka=yd.EwaSettings.wc()?new rf.a(598,0,bc,64,ka):new hj.a(598,0,bc,void 0,ka);this.$.userOperationManager.oc(ka,null)}else qd.ULS.sendTraceTag(543540999,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};w.prototype.dispose=function(){this.Ld||(this.Ld=!0,this.$.userOperationManager.WC(Object(fd.a)(this,this.cK,"onQueueChanged")),this.B8())};
w.prototype.e1i=function(l){this.XM.mv=l.mv;this.XM.ignorePrintArea=l.ignorePrintArea};w.prototype.OYh=function(l){function K(wd,ke,jf){return R(Lb.$.ra.xa,Lb.sheetName,Lb.locale,Tf.b(wd,$a),Tf.a(ke,ka),jf,bc)}function ka(wd){wd=rj.a.Eg(wd.data);qd.ULS.sendTraceTag(573853731,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Bd.a.fd(wd));l(null)}function $a(wd){M.a(wd)?qd.ULS.sendTraceTag(573853761,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",
Bd.a.fd(wd.Errors)):(qd.ULS.sendTraceTag(573853760,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),l(wd.Result))}var Lb=this,bc=this.$.ra.xa.dc();var Dc=yd.EwaSettings.wc()?new rf.a(247,0,K,80):new hj.a(247,0,K,16);Dc=this.$.userOperationManager.oc(Dc,null);this.jK.add(Dc)};w.prototype.d1i=function(l){var K=this;qd.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var ka=
this.$.ra.xa.dc();this.$.userOperationManager.oc(new rf.a(226,0,function($a,Lb,bc){return ha(K.$.ra.xa,K.sheetName,l,Tf.b($a,Object(fd.a)(K,K.tyi,"onSavePrintSettingsToFileSuccess")),Tf.a(Lb,Object(fd.a)(K,K.syi,"onSavePrintSettingsToFileFailure")),bc,ka)},void 0,function(){return new ea(K.sheetName,l)}),null)};w.prototype.v4h=function(l){return this.V3e(l)||!this.R6e(l.PaperSize)};w.prototype.i6c=function(l){this.V3e(l)&&(qd.ULS.sendTraceTag(593294028,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),
l.ScalingWidth=w.o0c,l.ScalingHeight=w.n0c,l.ScalingPercent=w.I1b,l.FitToPage=w.i0c);this.R6e(l.PaperSize)||(qd.ULS.sendTraceTag(593294027,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",l.PaperSize.toString()),l.PaperSize=w.Xob);return l};w.prototype.oFh=function(l){if(l.FitToPage){if(1===l.ScalingWidth&&1===l.ScalingHeight)return 1;if(!l.ScalingWidth&&1===l.ScalingHeight)return 3}else return 0;return 2};w.prototype.nFh=function(l){return this.Wid(l,
this.normal)?0:this.Wid(l,this.wide)?1:this.Wid(l,this.narrow)?2:3};w.prototype.Wid=function(l,K){return l.Left===K.Left&&l.Right===K.Right&&l.Top===K.Top&&l.Bottom===K.Bottom&&l.Header===K.Header&&l.Footer===K.Footer};w.prototype.sFh=function(l){var K={};K.ScalingPercent=w.I1b;K.FitToPage=!!l;2===l?(K.ScalingWidth=1,K.ScalingHeight=0):3===l?(K.ScalingWidth=0,K.ScalingHeight=1):1===l&&(K.ScalingWidth=1,K.ScalingHeight=1);return K};w.prototype.R6e=function(l){return this.EDi.contains(l.toString())};
w.prototype.V3e=function(l){return 100!==l.ScalingPercent||l.FitToPage&&(1<l.ScalingWidth||1<l.ScalingHeight)};w.prototype.BQg=function(){for(var l=new Yk.a(Ph.a.Dl()),K=0;K<this.paperSizeOptions.length;K++)l.add(this.paperSizeOptions[K].printSettingOptionKey.toString());return l};w.prototype.gud=function(l){this.NC.gud(l)};w.prototype.pud=function(l){this.NC.pud(l)};w.prototype.tyi=function(){qd.ULS.sendTraceTag(593294030,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
w.prototype.syi=function(l){l=rj.a.Eg(l.data);qd.ULS.sendTraceTag(593294029,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Bd.a.fd(l))};w.prototype.qFh=function(l){var K=null;if(l){var ka=this.XM.mv,$a=this.XM.ignorePrintArea;this.v4h(l)&&(this.JUf=!0,l=this.i6c(l));K=new J;K.mv=ka;K.ignorePrintArea=$a;K.orientation=l.IsLandscape?2:1;K.Aba=l.PaperSize;K.x_=this.oFh(l);if(yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintGridlines",
!1)||yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PrintAlignmentsAndHeadings",!1))K.sheetPrintOptions=A.xGa,K.sheetPrintOptions.PrintGrid=l.SheetPrintOptions.PrintGrid,K.XZa=l.Draft,K.sheetPrintOptions.HorizontalCenter=l.SheetPrintOptions.HorizontalCenter,K.sheetPrintOptions.VerticalCenter=l.SheetPrintOptions.VerticalCenter,K.sheetPrintOptions.PrintHeaders=l.SheetPrintOptions.PrintHeaders;this.tva&&(K.margin=this.nFh(l.PageMargin),yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
qd.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",K.margin),3===K.margin&&(this.J5={},this.J5.Left=l.PageMargin.Left,this.J5.Right=l.PageMargin.Right,this.J5.Top=l.PageMargin.Top,this.J5.Bottom=l.PageMargin.Bottom,this.J5.Header=l.PageMargin.Header,this.J5.Footer=l.PageMargin.Footer))}return K};w.prototype.cK=function(l,K){2===K.QC?this.jK.clear():1===K.QC&&this.jK&&this.jK.contains(K.Sh)&&(qd.ULS.sendTraceTag(570753094,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",
n.a(K.Sh.operation.operationName),+K.Sh.dequeueUtcTime-+K.Sh.enqueueUtcTime),this.jK.remove(K.Sh))};w.prototype.B8=function(){if(this.jK){for(var l=Ml(this.jK),K=l.next();!K.done;K=l.next())K=K.value,this.$&&this.$.userOperationManager&&(K.operation&&qd.ULS.sendTraceTag(570753093,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",n.a(K.operation.operationName)),this.$.userOperationManager.FZa(K)),this.jK.remove(K);this.jK=null}};w.o0c=1;w.n0c=0;w.I1b=
100;w.Xob=9;w.i0c=!0;Object(fe.a)(w,"PrintSettingsManager",A,[]);Object(fe.a)(u,"PrintSettingsTaskPaneCallbacks",null,[]);Object(fe.a)(k,"SelectedPrintSettings",null,[]);Object(fe.a)(t,"PrintOperationCallbacks",null,[]);Object(fe.a)(r,"PrintPreviewPaneCallbacks",null,[]);var O=b(1166);Object(fe.a)(m,"UniversalPrintAppSettings",null,[]);c.prototype.Wtg=function(l){this.Qa.addHandler("ppocek",l)};c.prototype.aVi=function(l){this.Qa.removeHandler("ppocek",l)};c.prototype.dhj=function(l,K){this.LYi();
this.$.userOperationManager.CB(Object(fd.a)(this,this.cK,"onQueueChanged"));this.Mm=l;this.Qa.raiseEvent("ppocek");this.Mm.SelectedRanges&&this.Mm.SelectedRanges.Ranges&&0<this.Mm.SelectedRanges.Ranges.length&&this.Mm.SelectedRanges.Ranges[0]&&(this.selectedRange=Qb.B(this.Mm.SelectedRanges.Ranges[0]).toString());qd.ULS.shipAssertTag(593294042,0,!this.Tu,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Tu=new w(this,this.$,K,this.$.Aa.sa.name,Te.a.instance);qd.ULS.shipAssertTag(593294041,
0,!this.ig,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.ig=new Kk.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.ig.V3g();this.ig.fhj();this.ig.ntg(Object(fd.a)(this,this.Mpf,"onNotifyOperationStatusUpdated"))};c.prototype.JCh=function(){this.Tu.J5&&4<=this.Tu.marginDetailedOptions.length&&(this.Tu.marginDetailedOptions[3].marginValue=this.Tu.Psb(this.Tu.J5));return this.Tu.marginDetailedOptions};c.prototype.Crc=function(){return!!this.Mm&&
!!this.Mm.ObjectId||!ag.g(this.$).ga.ya.Eh};c.prototype.tFh=function(){var l=Object.assign(new k,{selectedWhatToPrint:A.v0g,selectedOrientation:A.h0g,selectedPaperSize:A.Xob,selectedScaling:A.m0g,selectedMargin:A.g0g,selectedIgnorePrintArea:A.$_g,selectedPrintGridlines:A.xGa.PrintGrid,selectedDraft:A.X_g,selectedHorizontalCenter:A.xGa.HorizontalCenter,selectedVerticalCenter:A.xGa.VerticalCenter,selectedRowAndColumnHeadings:A.xGa.PrintHeaders});this.CJ?(l.selectedWhatToPrint=this.CJ.mv,l.selectedOrientation=
this.CJ.orientation,l.selectedPaperSize=this.CJ.Aba,l.selectedScaling=this.CJ.x_,this.tva&&(l.selectedMargin=this.CJ.margin),l.selectedIgnorePrintArea=this.CJ.ignorePrintArea,this.j7e&&(l.selectedPrintGridlines=this.CJ.sheetPrintOptions.PrintGrid,l.selectedDraft=this.CJ.XZa),this.i7e&&(l.selectedHorizontalCenter=this.CJ.sheetPrintOptions.HorizontalCenter,l.selectedVerticalCenter=this.CJ.sheetPrintOptions.VerticalCenter,l.selectedRowAndColumnHeadings=this.CJ.sheetPrintOptions.PrintHeaders)):qd.ULS.sendTraceTag(593294038,
0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return l};c.prototype.tTe=function(){var l=this;return Object.assign(new r,{onBackToSheet:function(){l.Dka()}})};c.prototype.pFh=function(){var l=this;return Object.assign(new O.a,{backActionButtonText:Te.a.instance.da(1145),printPreviewPaneCallbacks:this.tTe(),logger:new lk.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new t,{onClosePreviewer:function(){l.Dka()},getGraphServiceAuthorizationToken:this.M6b(),
onLocalPrint:function(){l.Dqf()}}),universalPrintAppSettings:Object.assign(new m,{graphServiceEndpoint:this.graphServiceEndpoint,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,supportedPaperSizes:c.kuj,showPaperSizeAndOrientationAsDisabledInAdvancedView:!1})})};c.prototype.rFh=function(){var l=this;return Object.assign(new u,{onSettingChange:function(K){l.hxi(K)},onPrint:function(){l.Dqf()}})};c.prototype.hxi=function(l){this.f_++;l?(this.ig&&this.ig.Xhj(),this.jl.mv=l.selectedWhatToPrint,
this.jl.x_=l.selectedScaling,this.jl.orientation=l.selectedOrientation,this.jl.Aba=l.selectedPaperSize,this.tva&&(this.jl.margin=l.selectedMargin),this.jl.ignorePrintArea=l.selectedIgnorePrintArea,this.R8i(l.selectedPageStart,l.selectedPageEnd),(this.j7e||this.i7e)&&this.Tu&&this.XPh(this.jl,l)?(this.jl.sheetPrintOptions=A.xGa,this.jl.sheetPrintOptions.PrintGrid=l.selectedPrintGridlines,this.jl.sheetPrintOptions.HorizontalCenter=l.selectedHorizontalCenter,this.jl.sheetPrintOptions.VerticalCenter=
l.selectedVerticalCenter,this.jl.sheetPrintOptions.PrintHeaders=l.selectedRowAndColumnHeadings,this.Tu.eZh(this.jl.sheetPrintOptions)):this.jvb()):qd.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};c.prototype.Dka=function(){this.m3a&&(this.XIb=!0);qd.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.f_);this.Cqf();this.Vpe()};
c.prototype.Dqf=function(){qd.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.f_);this.tva&&yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&qd.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.jl.margin,this.CJ.margin);if(this.useMSPdfViewer)this.Cyf();else if(this.U3a)try{this.ig.printPdf(),
this.qWc()}catch(l){qd.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.Cyf()}else this.lha.OTf(this.WFa(!0)),this.qWc()};c.prototype.Cyf=function(){var l=this.WFa(!0);this.qWc();xe.HelperMethods.wf(l,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};c.prototype.dispose=function(){Ei.a.Ia(this.Qa)};c.prototype.jvb=function(){var l=this;if(this.$.bva)this.KYh();else{this.B8();this.YIf();var K=null;this.CVh();qd.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var ka=function($a,Lb,bc){$a=new Mk.a($a,null,Lb,bc,null,!0,!1,"GetFileCopyFileHandler","");$a.correlationID=yj.a.create().toString();K=$a;l.Vaa=l.m2.J8(l.WFa(l.U3a?!1:!0,l.b_h?"Base64":"Pdf"),1,null,null,c.B5c,!1,2,Object(fd.a)(l,l.gtd,"onFileHandlerSuccessCallback"),Object(fd.a)(l,l.ftd,"onFileHandlerFailureCallback"),K,void 0,void 0,void 0,12E4);$a.requestId=l.Vaa;qd.ULS.sendTraceTag(570753096,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",
l.Vaa);return we.Task.Ua(!0)};this.oLa=yd.EwaSettings.wc()?this.$.userOperationManager.oc(new rf.a(223,0,ka,80),null):this.$.userOperationManager.oc(new hj.a(223,0,ka,16),null)}};c.prototype.qWc=function(){this.Cqf();this.Vpe()};c.prototype.gud=function(l){Bd.a.Fq(l.Errors)?this.ig.showErrorMessageForPrintOptions(Te.a.instance.da(1196)):(qd.ULS.sendTraceTag(541878434,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.jvb(),this.ig&&this.ig.hideErrorMessageForPrintOptions())};
c.prototype.pud=function(l){this.ig&&this.ig.showErrorMessageForPrintOptions(Te.a.instance.da(1196));l=rj.a.Eg(l.data);qd.ULS.sendTraceTag(541878433,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Bd.a.fd(l))};c.prototype.KYh=function(){function l($a,Lb,bc){var Dc={};Dc.WhatToPrint=K.jl.mv;Dc.UseNamedAction=K.lha.$rc();Dc.SelectedSheetName=K.$.Aa.sa.name;Dc.ActiveCell=K.activeCell;Dc.SelectedRanges=[K.selectedRange];Dc.IsPdfDocumentRequired=
!1;Dc.Orientation=K.jl.orientation;Dc.PaperSize=K.jl.Aba;Dc.Scaling=K.jl.x_;Dc.RichValuesEnabled=!0;Dc.IgnorePrintArea=K.jl.ignorePrintArea;Dc.Preview=!0;K.qRf()&&(Dc.PaginationStartPage=K.txa,Dc.PaginationEndPage=K.Tka,Dc.OutputTotalPdfPageCount=!0);if(K.tva){var wd=K.Tu.T$c(K.jl.margin);wd&&(Dc.PageMargin={},Dc.PageMargin.Top=wd.Top,Dc.PageMargin.Bottom=wd.Bottom,Dc.PageMargin.Left=wd.Left,Dc.PageMargin.Right=wd.Right,Dc.PageMargin.Header=wd.Header,Dc.PageMargin.Footer=wd.Footer)}K.Z4a=ba(K.$.ra.xa,
Dc,Tf.b(Object(fd.a)(K,K.lqi,"onConvertWorkbookToPdfSucceededInWebParts"),$a),Tf.a(Object(fd.a)(K,K.kqi,"onConvertWorkbookToPdfFailed"),Lb),bc,ka);return K.Z4a}var K=this;qd.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.B8();var ka=this.$.ra.xa.dc();yd.EwaSettings.wc()?this.oLa=this.$.userOperationManager.oc(new rf.a(133,0,l,80),null):this.oLa=this.$.userOperationManager.oc(new hj.a(133,0,l,16),null)};c.prototype.Vpe=
function(){this.$.userOperationManager.WC(Object(fd.a)(this,this.cK,"onQueueChanged"));this.B8();this.YIf();qd.ULS.shipAssertTag(594106396,0,!!this.ig,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.ig&&(this.ig.DUi(Object(fd.a)(this,this.Mpf,"onNotifyOperationStatusUpdated")),this.ig.d4g(),this.ig=null);this.Mm=null;this.Tu&&(this.Tu.dispose(),this.Tu=null);this.s0a=this.hCb=null;this.xFc=!1;this.Qa&&this.Qa.raiseEvent("ppocek")};c.prototype.Ocj=function(){return this.$.isEditMode&&
!!this.CJ&&!!this.jl&&2!==this.jl.mv&&this.Hcd()};c.prototype.cFd=function(){qd.ULS.shipAssertTag(573097988,0,!!this.Tu,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Tu&&this.Tu.cFd(this.jl,this.Ocj())};c.prototype.WFa=function(l,K){K=void 0===K?"Pdf":K;var ka=new Sys.StringBuilder;ka.append(xk.a(this.$,K,!0));Ig.a.Bg(ka,ye.a.Kyd,""+this.jl.mv);l&&this.lha.$rc()&&Ig.a.Bg(ka,ye.a.d4f,"1");Ig.a.Bg(ka,ye.a.Tzf,this.$.Aa.sa.name);this.jl.mv||(Ig.a.Bg(ka,ye.a.Szf,
this.selectedRange),Ig.a.Bg(ka,ye.a.Mzf,this.activeCell));Ig.a.Bg(ka,ye.a.Nzf,""+this.jl.orientation);Ig.a.Bg(ka,ye.a.Ozf,""+this.jl.Aba);Ig.a.Bg(ka,ye.a.Rzf,""+this.jl.x_);Ig.a.Bg(ka,ye.a.Qzf,"1");Ig.a.Bg(ka,ye.a.Lzf,this.jl.ignorePrintArea?"1":"0");Ig.a.Bg(ka,ye.a.Pzf,"1");this.uxg(ka);this.tva&&this.txg(ka);Re.a.equals(K,"Pdf",!0)&&(ka.append("&#toolbar=0"),yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5687501_PrintPreviewerResetZoomLevel")&&ka.append("&zoom=100"));l=ka.toString().replace("GetFileCopyFileHandler.aspx?",
"GetFileCopyFileHandler.aspx/?");qd.ULS.sendTraceTag(593266760,0,50,"PrintPreviewManager: Print Pdf Url {0}",l);return l};c.prototype.R8i=function(l,K){l||K?(this.yvb=!0,this.txa=l,this.Tka=K):this.nIf()};c.prototype.uxg=function(l){this.qRf()&&(Ig.a.Bg(l,ye.a.FKi,""+this.txa),Ig.a.Bg(l,ye.a.EKi,""+this.Tka),Ig.a.Bg(l,ye.a.GKi,"1"),qd.ULS.sendTraceTag(557160024,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.txa,this.Tka))};c.prototype.qRf=function(){return null!=
this.txa&&0<this.txa&&null!=this.Tka&&0<this.Tka};c.prototype.txg=function(l){if(this.Tu&&this.jl){var K=this.Tu.T$c(this.jl.margin);K&&Ig.a.Bg(l,ye.a.DKi,""+K.Top+" "+K.Bottom+" "+K.Left+" "+K.Right+" "+K.Header+" "+K.Footer)}};c.prototype.gtd=function(l){if(!(l&&l.data&&l.data.pe&&l.data.responseHeaders&&l.data.pe.length)){var K=l?l.data?l.data.pe?l.data.responseHeaders?l.data.pe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":
"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.ig&&(l=this.yya(Te.a.instance.da(1146)),this.xma(l,0));qd.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",K);this.$Cd&&(l=Object.assign(new Sh.a,{extendedProperties:new Map}),l.extendedProperties.set("InvalidParameterName",K),mh.Health.instance.recordQosError(Eb.a.Ayf,[jc.a.Byf],!1,!0,!0,!1,l))}else if(0<this.Vaa&&l.data.id===this.Vaa){if(l.data.responseHeaders["Content-Type"]&&
(Re.a.contains(l.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Re.a.contains(l.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){qd.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ka=null;Re.a.contains(l.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ka=this.zSg(l));K={};this.tAb(K,null,null,ka);l.data.responseHeaders["Total-Pdf-PageCount"]?(ka=parseInt(l.data.responseHeaders["Total-Pdf-PageCount"].toString()),
this.yvb||(this.Yxd>=ka?this.Tka=ka:this.yvb=!0),this.U3a&&this.ig&&this.ig.setPageRangeSettings(ka,this.Yxd,this.yvb,this.txa,this.Tka)):qd.ULS.sendTraceTag(555267871,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else K=pk.a.gi(l.data.pe),Bd.a.Z8(K.Errors)||ai.a(this.$).ld.AO(K.Errors[0].MessageId),this.JOi(K.Errors),this.ig&&(ka=this.yya(K.Errors[0].Description),-1831476778===K.Errors[0].MessageId?(qd.ULS.sendTraceTag(559437384,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),
this.xma(ka,0,Te.a.instance.da(1149))):this.xma(ka,0)),297284985===K.Errors[0].MessageId?qd.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",K.Errors[0].MessageId):qd.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",K.Errors[0].MessageId);l=l.data.state;l.G3c(K,l.userContext,l.methodName)}};c.prototype.ftd=function(l){var K=this;if(0<this.Vaa&&
l.data.id===this.Vaa){var ka=rj.a.Eg(l.data);this.ig&&this.xma(this.yya(ka[0].Description),1);qd.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Bd.a.fd(ka));ka=l.data.state;ka.o$(l,ka.userContext,ka.methodName);this.$.userOperationManager.I4.operation.APa(function(){return K.XIb})}};c.prototype.tAb=function(l,K,ka,$a){this.ig&&(qd.ULS.shipAssertTag(572384395,0,!!this.$.Aa.sa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.Aa.sa&&(this.U3a?(Re.a.na($a)&&($a=this.WFa(!1)),this.ig.Sai($a)):this.Ygj()))};c.prototype.lqi=function(l,K,ka){l.Errors&&0<l.Errors.length&&this.ig?(Bd.a.Z8(l.Errors)||ai.a(this.$).ld.AO(l.Errors[0].MessageId),this.xma(this.yya(l.Errors[0].Description),0),qd.ULS.sendTraceTag(593266761,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",l.Errors[0].MessageId)):(qd.ULS.sendTraceTag(553649882,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),
this.tAb(l,K,ka,null))};c.prototype.kqi=function(l){var K=this;l=rj.a.Eg(l.data);this.ig&&this.xma(this.yya(l[0].Description),1);qd.ULS.sendTraceTag(579179235,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Bd.a.fd(l));this.$.userOperationManager.I4.operation.APa(function(){return K.XIb})};c.prototype.Hcd=function(){return!this.CJ.equals(this.jl)};c.prototype.Cqf=function(){!this.XIb&&0<this.f_&&(this.jjd?this.cFd():qd.ULS.sendTraceTag(571074333,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));
qd.ULS.shipAssertTag(573097987,0,!!this.ig,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.ig&&this.ig.fRh();this.WOd()};c.prototype.ki=function(){qd.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.ig){var l=this.yya(Te.a.instance.da(1));this.xma(l,1)}else l=Bd.a.Ad(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),yd.EwaSettings.rC()?new Tj.a(this.$,l):(new Ii.ErrorDialog(this.$,l)).Bf()};c.prototype.ehj=
function(l){l?(!l.mv&&this.Crc()&&(qd.ULS.sendTraceTag(591927431,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",this.Mm.ObjectId?"floatingObject":"discontinuousRange"),l.mv=1),J.Ute(l,this.CJ),J.Ute(l,this.jl),qd.ULS.shipAssertTag(593294040,0,!!this.ig,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.ig&&(this.jjd=!0,this.ig.ghj(),this.jvb())):(qd.ULS.sendTraceTag(593294039,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),
this.ki())};c.prototype.Mpf=function(l,K){var ka=this;if(K)switch(K.IIi){case 1:if(this.jl&&this.s0a)switch(l=this.s0a.Gc,this.s0a.stop(),this.s0a=null,this.jl.mv){case 1:this.gVc(l,4800,"ActiveSheet");break;case 0:this.gVc(l,6100,"CurrentSelection");break;case 2:this.gVc(l,7500,"EntireWorkbook")}break;case 0:this.hCb&&(l=this.hCb.Gc,this.hCb.stop(),2400<l&&(K=Object.assign(new Sh.a,{extendedProperties:new Map}),K.extendedProperties.set("PaneLoadTime",l.toString()),mh.Health.instance.recordQosError(Eb.a.fjj,
[jc.a.RUf],!1,!0,!0,!1,K)),this.Tu.NYh(function($a){ka.ehj($a)}))}};c.prototype.gVc=function(l,K,ka){l>K&&(K=Object.assign(new Sh.a,{extendedProperties:new Map}),K.extendedProperties.set("WtpSelectedValue",ka),K.extendedProperties.set("FullyRenderedPdfLoadTime",l.toString()),mh.Health.instance.recordQosError(Eb.a.ejj,[jc.a.RUf],!1,!0,!0,!1,K))};c.prototype.cK=function(l,K){(1===K.QC&&this.oLa===K.Sh||2===K.QC)&&this.IDd()};c.prototype.B8=function(){this.oLa&&(0<this.Vaa||this.Z4a)&&(qd.ULS.sendTraceTag(570753095,
0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Vaa),this.$.userOperationManager.FZa(this.oLa),this.Z4a?rj.a.gv(this.Z4a.ou):this.m2.gv(this.Vaa),this.IDd())};c.prototype.IDd=function(){this.Z4a=this.oLa=null};c.prototype.CVh=function(){this.$Cd&&this.jl&&(this.s0a=this.$.Zb.Ic("UserAction",(1===this.jl.mv?"ActiveSheet":this.jl.mv?"EntireWorkbook":"CurrentSelection")+"FullyRenderedPdfLoadTimeStopwatch"))};c.prototype.nIf=function(){this.yvb=!1;this.txa=
1;this.Tka=this.Yxd};c.prototype.yya=function(l){if(l)return l.replace("&#39;","'");qd.ULS.sendTraceTag(557061537,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return l};c.prototype.Ygj=function(){qd.ULS.sendTraceTag(557061536,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.pwb)if(this.Fcc)qd.ULS.sendTraceTag(557061535,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var l=this.yya(Te.a.instance.da(1150));
this.xma(l,2)}else l=this.yya(Te.a.instance.da(1151)),this.xma(l,3)};c.prototype.xma=function(l,K,ka){this.ig.kz(l,K,void 0===ka?null:ka)};c.prototype.OVh=function(){this.Fcc=this.Cpe();this.pwb=this.eKg();this.U3a=this.fKg();qd.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.Fcc,this.pwb,this.U3a)};c.prototype.LYi=function(){this.X4a=
null;this.IDd();this.nIf();this.hCb=this.$.Zb.Ic("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.sa.activeCell.toString();this.f_=0;this.jjd=this.m3a=this.XIb=!1;this.xFc=!0};c.prototype.Lej=function(){var l=this.ncc&&this.N8e()?!0:!1;qd.ULS.sendTraceTag(539375326,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",l);return l};c.prototype.Cpe=function(){return!Sd.a.sA};c.prototype.OJg=function(){var l=15;Sd.a.IJ&&(Re.a.na(Sd.a.n3b)||(l=parseFloat(Sd.a.n3b)));return this.Cpe()&&14<
l&&this.pwb};c.prototype.eKg=function(){var l=this.$.lg.get(111);return this.ncc?l:l&&!this.N8e()};c.prototype.N8e=function(){return Sd.a.rA||Wd.AFrameworkApplication.isUnifiedHostMode};c.prototype.fKg=function(){return this.Fcc&&this.pwb};c.prototype.YIf=function(){this.X4a&&(URL.revokeObjectURL(this.X4a),this.X4a=null)};c.prototype.zSg=function(l){var K=l.data.pe;l=this.$.Zb.Ic("UserAction","PrintPreviewBlobFileCreation");var ka=window.self.atob(K);K=new Uint8Array(K.length);for(var $a=0;$a<ka.length;$a++)K[$a]=
ka.charCodeAt($a)&255;ka=new Blob([K],{type:"application/pdf"});this.X4a=URL.createObjectURL(ka);qd.ULS.sendTraceTag(556410915,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",l.Gc,ka.size);l.stop();l=this.X4a+"#toolbar=0";yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5687501_PrintPreviewerResetZoomLevel")&&(l+="&zoom=100");return l};c.prototype.JOi=function(l){if(this.$Cd&&Bd.a.dh(l,c.OEi)){var K=Object.assign(new Sh.a,{extendedProperties:new Map});
K.extendedProperties.set("ErrorMessageIdName",l[0].MessageIdName);mh.Health.instance.recordQosError(Eb.a.Ayf,[jc.a.Byf],!1,!0,!0,!1,K)}};c.prototype.XPh=function(l,K){return l.sheetPrintOptions.PrintGrid!==K.selectedPrintGridlines||l.sheetPrintOptions.HorizontalCenter!==K.selectedHorizontalCenter||l.sheetPrintOptions.VerticalCenter!==K.selectedVerticalCenter||l.sheetPrintOptions.PrintHeaders!==K.selectedRowAndColumnHeadings};c.prototype.WOd=function(){this.ijd&&this.$.Re(-1753588160,-1,0,null)};c.prototype.i_h=
function(){return!!this.$.Ba&&!!this.$.Ba.DocumentHostInfo&&"TestHost"===this.$.Ba.DocumentHostInfo.HostTier};c.prototype.getToken=function(){return this.Prd.vR("Print",this.graphServiceEndpoint).then(function(l){return l?(l.IsSuccess||qd.ULS.sendTraceTag(539246855,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",l.ErrorCode,l.ErrorMessage),l):Object.assign(new Fk.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(l){var K=
new Fk.a;Object.getType(l)===Object.getType(K)?K=l:(K.ErrorMessage=l.toString(),K.ErrorCode="exception");return Promise.resolve(K)})};c.prototype.M6b=function(){var l=this;return function(){var K=Promise.resolve("");try{if(l.Prd){var ka=l.Prd.b3a();if(null!=ka&&ka)return l.getToken().then(function($a){return $a.IsSuccess?Promise.resolve($a.Token):K},function(){return K})}}catch($a){qd.ULS.sendTraceTag(539246854,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",
$a)}return K}};Jl.Object.defineProperties(c.prototype,{u4h:{configurable:!0,enumerable:!0,get:function(){return this.xFc}}});c.OEi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];c.B5c=["Content-Type","Total-Pdf-PageCount"];c.kuj="A3;A4;A5;JIS B4;JIS B5;North America Executive;North America Letter;North America Invoice;North America Ledger;North America Legal".split(";");Object(fe.a)(c,
"PrintPreviewManager",null,[301,7,302]);d.prototype.$c=function(){return!1};d.prototype.executeCommand=function(l,K,ka,$a){var Lb=K.command;return 1588554917===Lb?(K.Fbc=!0,Xj.a(this.$)&&this.$.ea.Ea(423,void 0).tsc(!1),this.J4g(K)?we.Task.Ua(!0):h.a(Lb)):this.yyf.executeCommand(l,K,ka,$a,Object(fd.a)(this,this.Pwi,"onPageLayoutCommandSuccess"),Object(fd.a)(this,this.Owi,"onPageLayoutCommandFailure"),Object(fd.a)(this,this.Drj,"triggerBlockRendering"))};d.prototype.Jc=function(l,K){return 1588554917===
K.command?(qd.ULS.shipAssertTag(572306194,0,this.$.qaa,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.yyf.Jc(l,K)};d.prototype.gd=function(){return!1};d.prototype.J4g=function(l){return this.$.fa.pc?this.K4g(l):!1};d.prototype.K4g=function(l){qd.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var K=this.$.Zb.Ic("UserAction","DoPrintHtml"),ka=this.$,$a=this.fa.isNamedObjectViewMode?ka.Ab.sa.sheetName:ka.Aa.sa.name,Lb=this.fa.isNamedObjectViewMode,
bc=!Lb;ka=this.mFh(ka,$a,bc);var Dc=!0;!yd.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.bva&&(Dc=!1);bc?Dc?nj.a(this.$)?qd.ULS.sendTraceTag(573097989,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.NC.dhj(ka,this.XM),qd.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new P(this.$,Te.a.instance.da(1159),3,ka,l,this.lha,$a,this.XM)).Bf(),qd.ULS.sendTraceTag(595194760,0,50,
"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",K.Gc)):((new ja(this.$,Te.a.instance.da(1159),3,ka,l)).Bf(),qd.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",K.Gc,Lb));K.stop();this.hcd();return!0};d.prototype.mFh=function(l,K,ka){var $a={};$a.SessionId=this.fa.sessionId;$a.UsedRangeTooBig=!1;var Lb=ag.g(l),bc=Lb.ga,Dc=bc.Ze;if(qk.e(l.sa))$a.Type=0,$a.ObjectId=l.sa.name,$a.UseSelection=
!1;else if(qk.g(l.sa))$a.Type=1,$a.ObjectId=l.sa.Xia,$a.UseSelection=!0;else if(2===Dc||4===Dc||64===Dc){var wd=bc.Sa.nc.floatingObject;$a.Type=1;$a.SheetName=K;$a.ObjectId=wd.id;$a.UseSelection=!0}else if(ka&&Dc&470)$a.ObjectId=bc.Sa.nc.floatingObject.id,$a.SheetName=K;else if(qk.i(l.sa)){$a.Type=2;$a.SheetName=K;if(bc.ya.Eh)if(ka=bc.ya.Xd,$a.SelectedRanges=Qb.q(ka,l),20<ka.XO)$a.UseSelection=!0;else{K=0;Lb=Lb.$m("PrintCommandHandler.DoPrintHtml",ka);try{for(Lb.$$rst();Lb.$$mn()&&2>K;)wd=Lb.$$cu(),
Re.a.na(wd.text)||K++;$a.UseSelection=2<=K}finally{Lb&&Lb.dispose()}}else $a.UseSelection=!1,$a.SelectedRanges=Qb.q(bc.ya.activeRange,l);this.fa.isNamedObjectViewMode&&($a.UsedRange=Qb.v(l.sa.usedRange,l))}$a.Title=l.workbookContext.WorkbookFileName;return $a};d.prototype.hcd=function(){ag.g(this.$);if(!this.ARf){this.cLc=!0;var l=this.$.Zb.Ic("UserAction","HandlePageLayoutRendering");this.Rrj();qd.ULS.sendTraceTag(559724699,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",
l.Gc);l.stop()}};d.prototype.Rrj=function(){for(var l=ag.g(this.$).Ha,K=l.lJ(),ka=!1,$a=0,Lb=0;Lb<K.length;Lb++){var bc=K[Lb],Dc=bc.fg;Dc&&Dc.hasPageLayout()&&(ka=!0,Dc.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+bc.Od,4),$a++)}ka&&(qd.ULS.sendTraceTag(559724698,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",K.length,$a),l.ihc())};d.prototype.Drj=function(){var l=ag.g(this.$).Ha;this.cLc=
!0;l.ihc()};d.prototype.Pwi=function(){this.hcd()};d.prototype.Owi=function(l,K,ka){qd.ULS.sendTraceTag(579379991,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",ka);this.hcd()};Jl.Object.defineProperties(d.prototype,{ARf:{configurable:!0,enumerable:!0,get:function(){return this.cLc}}});Object(fe.a)(d,"PrintCommandHandler",null,[159,291]);var da=Df.a;Cm(a,da);a.prototype.Rd=function(){var l=this,K=Wd.AFrameworkApplication.ha.appSettings,ka=this.$.Ba.DirectPrintSetting;
K.DirectPrintIsEnabled=ka.DirectPrintIsEnabled.toString();K.DirectPrintProbeIsEnabled=ka.DirectPrintProbeIsEnabled.toString();K.DirectPrintEnabledForInternetExplorer=ka.DirectPrintEnabledForInternetExplorer.toString();K.DirectPrintSupportedMimeTypes=ka.DirectPrintSupportedMimeTypes;K.DirectPrintSupportedPlugins=ka.DirectPrintSupportedPlugins;K.DirectPrintImmersivePreviewPlugins=ka.DirectPrintImmersivePreviewPlugins;K.DirectPrintMinimalSupportedEdgeVersion=ka.DirectPrintMinimalSupportedEdgeVersion;
K.DirectPrintEnabledForEdge=ka.DirectPrintEnabledForEdge.toString();K=new xa(K);var $a=null;ka=null;try{ka=window.navigator.mimeTypes}catch(Dc){qd.ULS.sendTraceTag(571815075,0,15,"Failed to get Window.Navigator.mimeTypes")}var Lb=null;try{Lb=window.navigator.plugins}catch(Dc){qd.ULS.sendTraceTag(571815074,0,15,"Failed to get Window.Navigator.plugins")}$a=new ma(K,ka,Lb,ma.t4e,ma.D8e,new ib(Wd.AFrameworkApplication.za.vW),Wd.AFrameworkApplication.za.bB,ma.E8e,function(Dc,wd){return new Oa(Dc,!1,wd)},
!1);if(yd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.lg.get(116)){var bc=Vf.GetServiceTaskFactory.Xa(this.$.ea,349,350,this.vb,"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper");og.TaskExtensions.Da(bc,function(){var Dc=new d(l.$,$a,bc.result);l.Hd([Dc])},this.$.ma)}else this.Hd([new d(this.$,$a,null)])};a.la=function(l){Df.a.ie(73,new a(l))};Object(fe.a)(a,"PrintCommandHandlerFactory",Df.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Nf.a.Xi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");bh.main();Type.registerNamespace("Common.App.NewAndOpen.UX");ch.a.instance.oj(new Rc);Type.registerNamespace("Common.App.OneDriveFilePickerApi");ob.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");ih.main();Type.registerNamespace("Common.App.SaveToSharePoint");Uf.main();Type.registerNamespace("Common.App.SaveToCloudStorage");pc.main();Type.registerNamespace("Common.App.SaveACopy");
de.main();Type.registerNamespace("Common.App.SharedFilePicker");qg.main();Type.registerNamespace("Common.App.WildFire");Tc.main();pf.a.Ja(Ud.la);pf.a.Ja(eg.la);pf.a.Ja(wf.la);Nf.a.Xi(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
pf.a.Ja(ff.la);Nf.a.Xi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){pf.a.Ja(function(l){hb.la(l)})})();(function(){pf.a.Ja(function(l){l.ea.La(165,new sa(l))})})();pf.a.Ja(De.la);(function(){pf.a.Ja(function(l){l.ea.La(57,new Yf(l));l.ea.La(60,new Vd(l));l.ea.La(63,new ld(l))})})();pf.a.Ja(id.la);pf.a.Ja(Yd.la);pf.a.Ja(wb.la);Nf.a.Xi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){pf.a.Ja(function(l){Ed.la(l);Zd.la(l)})})();Nf.a.Xi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Nf.a.Xi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){pf.a.Ja(function(l){ae.la(l);Xb.la(l)})})();pf.a.Ja(Xa.la);pf.a.Ja(Fd.la);(function(){pf.a.Ja(function(l){Nc.la(l);xb.la(l)})})();pf.a.Ja(Mb.la);pf.a.Ja(nc.la);(function(){pf.a.Ja(function(l){va.la(l);za.la(l)})})();pf.a.Ja(Ta.la);(function(){pf.a.Ja(function(l){Ra.la(l);nb.la(l)})})();Type.registerNamespace("Common.App.DirectPrint");ch.a.instance.oj(new Sa);pf.a.Ja(a.la)},812:function(D,
F,b){function a(W,S){var N=H.call(this,document.createElement("div"))||this;N.ax=null;N.QW=null;N.o7=null;N.Waa=null;N.IZb=null;N.Kbe=null;N.ghe=null;N.Saf=null;N.m$b=!1;N.MG=!1;N.rua=!1;N.oJa=!1;N.C0=W;N.oG=S;N.VRc=S.imb.toString();N.title=S.title;N.message=S.message;N.set_visibilityMode(1);return N}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(86),m=b(276),r=b(13),t=b(120),k=b(90),u=b(37);F=b(227);var w=b(1155),v=b(18),A=b(4),y=b(314),x=b(48),z=b(11),J=b(68),B=b(16),C=b(20),H=F.a;Cm(a,
H);a.prototype.dispose=function(){c.a.rc([this.IZb,this.QW,this.o7]);this.MG&&this.QW&&(m.a.instance.Ca(r.a.click,this.QW.domElement,Object(u.a)(this,this.csd,"onActionClickHandler")),t.KeyInputManager.instance.jv(this.domElement,this.Kbe));this.rua&&this.o7&&(m.a.instance.Ca(r.a.click,this.o7.domElement,Object(u.a)(this,this.ksd,"onAltActionClickHandler")),t.KeyInputManager.instance.jv(this.domElement,this.ghe));this.oJa&&this.Waa&&(m.a.instance.Ca(r.a.click,this.Waa,Object(u.a)(this,this.Jtd,"onLinkClickHandler")),
t.KeyInputManager.instance.jv(this.domElement,this.Saf));this.Waa=this.ax=this.C0=this.o7=this.QW=null;H.prototype.dispose.call(this)};a.prototype.GYc=function(){var W="<div class='"+w.a.t$g+"' id='{0}'><div class='"+w.a.r$g+"'><a class='"+w.a.z$g+"' title='{1}'><span class='"+v.a.cWc+" "+w.a.v$g+"' id='{2}'>";this.Rj.length&&(W+="<img class='{3}' src='{4}'/>");W+="</span></a><span class='"+w.a.y$g+"' id='{5}'>{6}</span><span class='"+w.a.x$g+"' id='message'>{7}</span><a id='link' href='#' class='"+
w.a.w$g+"'>{8}</a><span class='"+w.a.dEe+"'><button type='button' id='action' class='"+w.a.cEe+"'>{9}</button></span><span class='"+w.a.dEe+"'><button type='button' id='altAction' class='"+w.a.cEe+"'>{10}</button></span></div><a class='"+w.a.u$g+"' tabindex='0' role='button'><span id='close' class='"+v.a.MB+"'><img class='"+v.a.$3c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement);var S=this.businessBar.$.Mb,
N=S+"ewaBusinessBarEntryBody"+this.VRc,T=S+"ewaBusinessBarEntryTitle"+this.VRc;S=S+"ewaBusinessBarEntryIcon"+this.VRc;this.domElement.className=w.a.s$g;this.domElement.innerHTML=String.format(W,N,this.alt,S,this.Rj,x.a.Ee(0),T,this.title,this.message,this.linkText,this.actionButton,this.oWb,x.a.Ee(13),B.a.instance.da(759));z.DOMElementExtensions.xo(this.domElement,A.a.aga,T,N);this.Waa=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.Waa,this.oJa);this.oJa&&(m.a.instance.qa(r.a.click,
this.Waa,Object(u.a)(this,this.Jtd,"onLinkClickHandler")),this.Saf=t.KeyInputManager.instance.Qr(this.Waa,Object(u.a)(this,this.Jtd,"onLinkClickHandler"),k.a.Vh,k.a.p0));this.QW=new y.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.QW.isVisible=this.MG;this.o7=new y.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.o7.isVisible=this.rua;this.MG&&(m.a.instance.qa(r.a.click,this.QW.domElement,Object(u.a)(this,this.csd,"onActionClickHandler")),this.Kbe=
t.KeyInputManager.instance.Qr(this.QW.domElement,Object(u.a)(this,this.csd,"onActionClickHandler"),k.a.Vh,k.a.p0),this.rua&&(m.a.instance.qa(r.a.click,this.o7.domElement,Object(u.a)(this,this.ksd,"onAltActionClickHandler")),this.ghe=t.KeyInputManager.instance.Qr(this.QW.domElement,Object(u.a)(this,this.ksd,"onAltActionClickHandler"),k.a.Vh,k.a.p0)));this.ax=$get("close",this.domElement);this.IZb=this.Ud.Kd(this.ax);this.IZb.la("click",Object(u.a)(this,this.bK,"onCloseClick"));this.IZb.la("keydown",
Object(u.a)(this,this.Api,"onCloseKeyDown"));z.DOMElementExtensions.setVisible(this.ax,!this.m$b)};a.prototype.pq=function(){d.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.oG.hash,this.oG.U2c);C.g(this.businessBar.$).Zo(!0)};a.prototype.Bka=function(){d.ULS.sendTraceTag(21517969,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.oG.hash);C.g(this.businessBar.$).Zo(!0)};a.prototype.Kka=function(){d.ULS.sendTraceTag(21517970,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.oG.hash);C.g(this.businessBar.$).Zo(!0)};a.prototype.bK=function(W){d.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.oG.hash,this.oG.U2c);this.set_visible(!1);this.businessBar.removeEntry(this.wFg);J.g(W)};a.prototype.Api=function(W){13===W.keyCode&&this.bK(W)};a.prototype.csd=function(W){this.pq(W.Cb);return!0};a.prototype.ksd=function(W){this.Bka(W.Cb);return!0};a.prototype.Jtd=
function(W){this.Kka(W.Cb);return!0};Jl.Object.defineProperties(a.prototype,{wFg:{configurable:!0,enumerable:!0,get:function(){return this.oG.imb}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.C0}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.oG?this.oG.actionButton:""}},oWb:{configurable:!0,enumerable:!0,get:function(){return this.oG?this.oG.oWb:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.oG?this.oG.link:""}},Rj:{configurable:!0,
enumerable:!0,get:function(){return this.oG?this.oG.Rj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.oG?this.oG.alt:""}}});Object(D.a)(a,"BusinessBarEntry",F.a,[])},891:function(D,F,b){function a(Y,L,P,ea){var X=fa.call(this)||this;X.Qba=null;X.PC=null;X.UQ=null;X.IV=null;X.cDb=null;X.iK=null;X.Rec=null;X.lyb=null;X.kyb=!1;X.hva=!0;X.nkc=null;X.ewaAccessibilityManager=null;X.Xxd=null;X.Wxd=null;X.$xd=null;X.Tgd=!1;X.$=Y;X.NC=L;X.BWg();X.ncc=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",
!1);X.useMSPdfViewer=P;X.isUniversalPrintEnabled=ea;X.h6c=B.EwaSettings.isChangeGateEnabled("OfficeVSO:5768956_FixCtrlF6LoopForPdfViewer");return X}function d(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function c(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=
this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function m(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function r(Y){this.ig=Y}function t(Y){this.ig=Y}function k(Y){this.ig=Y}function u(Y){var L=W.call(this)||this;L.IIi=Y;return L}b.r(F);D=b(0);var w=b(15);b(24);var v=b(382),A=b(37),y=b(36),x=b(58),z=b(11),J=b(124),B=b(1),C=b(16),H=b(20),W=Sys.EventArgs;Cm(u,W);Object(D.a)(u,"PrintPreviewPaneOperationStatusEventArgs",
Sys.EventArgs,[]);var S=b(254),N=b(241);k.prototype.$g=function(){S.a(this.ig.$).fM(this.he)||S.a(this.ig.$).$g(this)};k.prototype.Z6=function(){S.a(this.ig.$).fM(this.he)&&S.a(this.ig.$).UA(this)};k.prototype.Lh=function(Y){return z.DOMElementExtensions.jf(this.Nb,Y)};k.prototype.vi=function(){this.ig.$.frame.Te.Zj(this.ig.$.frame.Te.XD)};k.prototype.ei=function(){};k.prototype.Ye=function(Y,L){return L?!1:(this.ig.enterPrintPreviewHeaderFocusTrapZone(),!0)};Jl.Object.defineProperties(k.prototype,
{he:{configurable:!0,enumerable:!0,get:function(){return N.a.Dyf}},Nb:{configurable:!0,enumerable:!0,get:function(){var Y=b(891).PrintPreviewPane;return document.getElementById(Y.HIi)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(D.a)(k,"PrintPreviewHeaderKeyboardAccessibleSection",null,[135]);t.prototype.$g=function(){S.a(this.ig.$).fM(this.he)||S.a(this.ig.$).$g(this)};t.prototype.Z6=function(){S.a(this.ig.$).fM(this.he)&&S.a(this.ig.$).UA(this)};t.prototype.Lh=
function(Y){return z.DOMElementExtensions.jf(this.Nb,Y)};t.prototype.vi=function(){this.ig.$.frame.Te.Zj(this.ig.$.frame.Te.XD)};t.prototype.ei=function(){};t.prototype.Ye=function(Y,L){return L?!1:(this.ig.useMSPdfViewer&&this.ig.h6c?(Y=document.getElementById(b(891).PrintPreviewPane.Rvd))&&z.DOMElementExtensions.setFocus(Y,!0):z.DOMElementExtensions.setFocus(this.ig.iK),!0)};Jl.Object.defineProperties(t.prototype,{he:{configurable:!0,enumerable:!0,get:function(){return N.a.Eyf}},Nb:{configurable:!0,
enumerable:!0,get:function(){var Y=b(891).PrintPreviewPane;return this.ig.useMSPdfViewer&&this.ig.h6c?document.getElementById(b(891).PrintPreviewPane.Rvd):document.getElementById(Y.Yvf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(D.a)(t,"PrintPreviewKeyboardAccessibleSection",null,[135]);r.prototype.$g=function(){S.a(this.ig.$).fM(this.he)||S.a(this.ig.$).$g(this)};r.prototype.Z6=function(){S.a(this.ig.$).fM(this.he)&&S.a(this.ig.$).UA(this)};r.prototype.Lh=
function(Y){return z.DOMElementExtensions.jf(this.Nb,Y)};r.prototype.vi=function(){this.ig.$.frame.Te.Zj(this.ig.$.frame.Te.XD)};r.prototype.ei=function(){};r.prototype.Ye=function(Y,L){return L?!1:(this.ig.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Jl.Object.defineProperties(r.prototype,{he:{configurable:!0,enumerable:!0,get:function(){return N.a.Hyf}},Nb:{configurable:!0,enumerable:!0,get:function(){var Y=b(891).PrintPreviewPane;return document.getElementById(Y.Zxd)}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(D.a)(r,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[135]);Object(D.a)(m,"MSPdfViewerFileUrl",null,[]);Object(D.a)(c,"PrintSettingsTaskPaneProps",null,[]);Object(D.a)(d,"ViewerPaneProps",null,[]);var T=b(1166);b.d(F,"PrintPreviewPane",function(){return a});var fa=y.a;Cm(a,fa);a.prototype.ntg=function(Y){this.addHandler(a.Mzb,Y)};a.prototype.DUi=function(Y){this.removeHandler(a.Mzb,Y)};a.prototype.fhj=function(){this.wWg()};a.prototype.ghj=
function(){var Y=this.$.Zb.Ic("UserAction","createSettingsPaneStopwatch"),L=document.getElementById(a.Zxd);this.CWg();this.PC.createPrintSettingsTaskPane(L,this.DWg());Y.stop();this.kyb=!1;this.KAd()};a.prototype.setPageRangeSettings=function(Y,L,P,ea,X){this.PC&&(this.PC.setPageRangeSettings(Y,L,P,ea,X),this.jPf(String.format(C.a.instance.Eb(194),ea,X,Y)))};a.prototype.fRh=function(){this.IV&&(this.IV.style.display="none")};a.prototype.d4g=function(){this.dispose();this.QPd();this.Jtj();this.Qba&&
this.Qba.closePrintPreviewPane();this.UQ=this.PC=this.Qba=this.IV=null};a.prototype.Sai=function(Y){w.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.lyb=this.$.Zb.Ic("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||w.ULS.sendTraceTag(539375325,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.UQ.renderPdf(Y)):this.iK&&((this.Rec=this.$.Zb.Ic("UserAction","loadPdfStopwatch"))||w.ULS.sendTraceTag(590700560,
0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.kyb=!0,this.iK.src&&this.iK.src===Y?this.lof(null):this.iK.src=Y)};a.prototype.onPdfLoad=function(){this.lyb?(w.ULS.sendTraceTag(539375324,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.lyb.Gc,this.hva),this.lyb.stop()):w.ULS.sendTraceTag(539375323,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.Mzb,new u(1));this.hideWaitCursor();this.jHd()};
a.prototype.printPdf=function(){z.DOMElementExtensions.setFocus(this.iK);this.iK.contentWindow.print()};a.prototype.Xhj=function(){this.showSpinner();this.showWaitCursor();this.jPf("")};a.prototype.nRh=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.kz=function(Y,L,P){this.IV&&this.UQ&&(this.Tgd=!1,this.UQ.showErrorDetails(L,Y,void 0===P?null:P),this.NC.m3a=!0,this.iK&&(this.iK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.f4h(L)&&(this.Tgd=!0,this.Swi()))};a.prototype.hidePreviewError=
function(){this.NC.m3a=!1;this.UQ.hidePreviewError();this.enablePrintButton()};a.prototype.V3g=function(){(this.cDb=document.getElementById(a.Fyf))&&this.cDb.parentNode&&this.cDb.parentNode.removeChild(this.cDb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.PC&&this.PC.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(Y){this.PC&&this.PC.showErrorMessageForPrintOptions(Y)};a.prototype.showSpinner=function(){this.NC.m3a||B.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&
this.Tgd?this.hidePreviewError():this.iK&&(this.iK.style.visibility="hidden");this.UQ&&this.UQ.showSpinner()};a.prototype.hideSpinner=function(){this.UQ&&this.UQ.hideSpinner()};a.prototype.enablePrintButton=function(){this.PC&&this.PC.enablePrintButton()};a.prototype.disablePrintButton=function(){this.PC&&this.PC.disablePrintButton()};a.prototype.showWaitCursor=function(){this.PC&&this.PC.showWaitCursor()};a.prototype.hideWaitCursor=function(){this.PC&&this.PC.hideWaitCursor()};a.prototype.lof=function(){w.ULS.sendTraceTag(575411527,
0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",this.kyb);this.kyb&&(this.nRh(),this.iK.style.visibility="visible",this.Rec?this.Rec.stop():w.ULS.sendTraceTag(575411526,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),this.raiseEvent(a.Mzb,new u(1)),this.jHd(),this.kyb=!1)};a.prototype.zWg=function(){this.IV?w.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null"):
(this.IV=document.createElement("div"),this.IV.id=a.Fyf,Sys.UI.DomElement.addCssClass(this.IV,a.JIi),this.$.sr.insertBefore(this.IV,this.$.sr.firstChild))};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.Qba.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.Qba.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.EGi=function(){var Y=this;this.$.ea.ub(15,function(L){Y.ewaAccessibilityManager=L;Y.ewaAccessibilityManager.mode=
3})};a.prototype.BWg=function(){this.$xd=new r(this);this.Xxd=new t(this);this.Wxd=new k(this)};a.prototype.KAd=function(){this.$xd.$g();this.Xxd.$g();this.Wxd.$g();this.EGi()};a.prototype.QPd=function(){this.$xd.Z6();this.Xxd.Z6();this.Wxd.Z6();H.g(this.$).K_();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.RV=function(){this.nkc=J.a.instance.Kd(this.iK);this.nkc.la("load",Object(A.a)(this,this.lof,"onIframeContentChange"))};a.prototype.Jtj=function(){this.nkc&&
this.iK&&this.nkc.detach("load")};a.prototype.jHd=function(){if(this.hva){var Y=document.getElementById(a.Zxd);Y&&(Y=z.DOMElementExtensions.getElementById(Y,a.zyf))&&(this.hva=!1,Y.focus())}};a.prototype.Swi=function(){this.NC.m3a=!1;this.enablePrintButton();this.jHd()};a.prototype.wWg=function(){var Y=this;x.GetServiceTaskFactory.Xa(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider").result.xq.loadScript("excelPrintPreviewer").then(function(){var L=Y.$.Zb.Ic("UserAction","createEmptyPreviewerStopwatch");
Y.zWg();Y.AWg();Y.Qba.createEmptyPrintPreviewPane(Y.IV,Y.yWg());L.stop();L=Y.$.Zb.Ic("UserAction","createPdfPreviewPaneStopwatch");var P=document.getElementById(a.Rvd);Y.useMSPdfViewer&&Y.h6c&&(P.tabIndex=0);Y.jWg();Y.iWg(P);L.stop();Y.raiseEvent(a.Mzb,new u(0))})};a.prototype.AWg=function(){this.Qba||(this.Qba=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.Qba||w.ULS.sendTraceTag(591927429,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};
a.prototype.CWg=function(){this.PC||(this.PC=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.PC||w.ULS.sendTraceTag(591927428,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.jWg=function(){this.UQ||(this.UQ=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.UQ||w.ULS.sendTraceTag(591927427,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};
a.prototype.iWg=function(Y){this.ncc?this.UQ.createPrintPreviewPane(Y,this.NYg()):this.UQ.createPrintPreview(Y);this.useMSPdfViewer||(this.iK=z.DOMElementExtensions.getElementById(this.IV,a.Yvf),this.iK.title=C.a.instance.da(1147),this.RV())};a.prototype.DWg=function(){var Y=null,L="en-US";B.EwaSettings.isChangeGateEnabled("OfficeVSO:5618940_FixMeasurementUnitInMargin")&&(Y=this.$.Ba.IsMetricMeasurementUnit,L=this.$.Ba.DataCultureTag?this.$.Ba.DataCultureTag:L);return Object.assign(new c,{whatToPrintOptions:this.NC.Tu.whatToPrintOptions,
orientationOptions:this.NC.Tu.orientationOptions,paperSizeOptions:this.NC.Tu.paperSizeOptions,scalingOptions:this.NC.Tu.scalingOptions,marginDetailedOptions:this.NC.JCh(),selectedPrintSettingsValues:this.NC.tFh(),printSettingsTaskPaneCallbacks:this.NC.rFh(),logger:new v.a,shouldDisableCurrentSelection:this.NC.Crc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:Y,dataCultureTag:L})};a.prototype.yWg=function(){return this.isUniversalPrintEnabled?this.NC.pFh():Object.assign(new T.a,{backActionButtonText:C.a.instance.da(1145),
printPreviewPaneCallbacks:this.NC.tTe(),logger:new v.a,disableTellMeControl:!0})};a.prototype.NYg=function(){var Y=this;return this.useMSPdfViewer?Object.assign(new d,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.yVg(),onPdfLoad:function(){Y.onPdfLoad()}}):Object.assign(new d,{useMSPdfViewer:!1})};a.prototype.yVg=function(){return Object.assign(new m,{pdfViewerWorkerUrl:this.$.Ba.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.Ba.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.Ba.PrintPreviewerMSPdfKitWasmUrl})};
a.prototype.jPf=function(Y){this.IV&&this.Qba.setAdditionalHeaderText(Y)};a.f4h=function(Y){return 3===Y||2===Y};a.Fyf="PrintPreviewerContainer";a.Zxd="printSettingsTaskPaneId";a.Rvd="previewId";a.Yvf="printpreviewiframe";a.HIi="printPreviewHeaderId";a.zyf="printButton";a.JIi="PrintPreviewerContainer";a.Mzb="pppnosu";Object(D.a)(a,"PrintPreviewPane",y.a,[316])},958:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);var d=b(15),c=b(5),m=b(49),r=b(24);a.UNe=function(t,k){switch(t){case 3:return a.YKh(k);
case 2:return a.tEh(k);case 1:return a.Vyh(k)}return""};a.YKh=function(t){switch(t){case 1:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.tEh=function(t){switch(t){case 1:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.Vyh=function(t){switch(t){case 1:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return c.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(t,k,u){if(r.a.hh||r.a.Dp)window.setTimeout(function(){a.DCf(u,a.e9b())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Qhe(u),t,0,!1)};a.SLg=function(t,k,u,w){k&&w&&w();a.openInClient(t,k,u)};a.e9b=function(){return r.a.hh?1:r.a.Dp?2:r.a.Q4a?3:r.a.isMac?4:0};a.UKh=function(t){switch(t){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";
case 1:return"WildFireExcelBizBar";default:return""}};a.VKh=function(t){switch(t){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.DCf=function(t,k){1===k?(d.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),t=a.UNe(t,k),8<r.a.A2a?m.a.wf(t,void 0,void 0,"RedirectToAppStore"):m.a.PY(t)):document.hidden||(a.lcc?(t=c.AFrameworkApplication.ha.appSettings.WildFireUrlChinaStoreAndroid.toString())?
(d.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),m.a.PY(t)):d.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(d.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.UNe(t,k),null,null)))};a.Qhe=function(t){switch(t){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.d8c=function(t){switch(t){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";
default:return""}};a.vid=function(t){return(t=a.GBh(t))&&""!==t?Boolean.parse(t):!1};a.ZHd=function(t){a.e8i(t)};a.GBh=function(t){try{return localStorage.getItem(t)}catch(k){return d.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+k.message),null}};a.e8i=function(t){try{localStorage.setItem(t,"true")}catch(k){d.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+k.message)}};Jl.Object.defineProperties(a,
{lcc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},Yrc:{configurable:!0,enumerable:!0,get:function(){return(r.a.Q4a||r.a.isMac)&&r.a.Oo}},lej:{configurable:!0,enumerable:!0,get:function(){return r.a.hh||r.a.Dp}}});a.Kpe="ChromeExtensionBarDismiss";Object(D.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=EwaDS.kmhv.js.map