var sharedComments=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[23],{1013:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),o=n(1253);function a(e){var t=Object(r.__read)(e,1)[0];return Object(o.a)(t)}},102:function(e,t,n){"use strict";n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return T})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return D})),n.d(t,"j",(function(){return E})),n.d(t,"b",(function(){return j}));var r=n(1),o=n(7),a=n(5),i=n(242),s=n(87),c=n(281),d=n(184),u=n(51),l=n(119),m=n(17),f=n(176),p=n(206);function C(e,t,n){for(var r=t;r<e.length;++r)if(e[r].commentId===n.commentId)return r;return-1}function g(e,t,n,r,o,i){for(var s=[],c=t,d=o;c<=n&&d<=i;){var u=e[c].date;Object(a.i)().assertConditionTag(!!u,"commentDate should not be undefined",595719177),!u||u<=r.history[d].records[0].time?(Object(a.i)().assertConditionTag(e[c].parentId===r.commentId,"comments must belong to the same thread",595719173),s.push({commentModel:e[c]}),++c):(Object(a.i)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719178),s.push({historyItem:r.history[d],parentThreadId:r.commentId,taskId:r.id}),++d)}for(;c<=n;++c)s.push({commentModel:e[c]});for(;d<=i;++d)Object(a.i)().assertConditionTag(!r.history[d].commentId,"Unachored history item should not have commentId",595719179),s.push({historyItem:r.history[d],parentThreadId:r.commentId,taskId:r.id});return s}function h(e,t){if(!m.b()||!t||0===t.history.length)return e.map((function(e){return{commentModel:e}}));var n=!0;if(m.c()||t.commentId===t.history[0].commentId||(Object(a.i)().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),n=!1),e[0].commentId!==t.commentId&&(Object(a.i)().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),n=!1),!n)return e.map((function(e){return{commentModel:e}}));var o=[];m.c()||o.push({commentModel:e[0],historyItem:t.history[0]});for(var i=m.c()?0:1,s=m.c()?0:1,c=m.c()?0:1;i<e.length&&c<t.history.length;){var d=C(e,i,t.history[c]);d>=0&&(o.push.apply(o,Object(r.__spread)(g(e,i,d-1,t,s,c-1))),Object(a.i)().assertConditionTag(0===d||e[d].parentId===t.commentId,"comments must belong to the same thread",595719175),o.push({commentModel:e[d],historyItem:t.history[c]}),i=d+1,s=c+1),++c}return o.push.apply(o,Object(r.__spread)(g(e,i,e.length-1,t,s,t.history.length-1))),o}function b(e,t){for(var n=[],o=0,a=1;a<=e.length;a++)(a===e.length||Object(s.a)(e[a]))&&(n.push.apply(n,Object(r.__spread)(h(e.slice(o,a),t[e[o].commentId]))),o=a);return n}function v(e){return e.filter(p.a).map((function(e){return e.commentModel}))}function y(e,t){var n=e.find((function(e){return Object(p.a)(e)&&e.commentModel.commentId===t}));if(Object(p.a)(n))return n.commentModel}function T(e){var t=e[0];if(Object(p.a)(t))return t.commentModel;throw new u.a(l.a,o.d.reserveTag(589103627),2130957505)}function O(e){return Object(p.a)(e)?e.commentModel.parentId:e.parentThreadId}function I(e){return Object(p.a)(e)?e.commentModel.commentId:e.historyItem.records[0].recordId}function S(e){return Object(p.a)(e)?Object(s.b)(e.commentModel):e.parentThreadId}function _(e,t){var n=e.records[0];switch(n.type){case c.a.Create:if(!(o=e.records[1])||o.type!==c.a.Assign)return Object(a.i)().assertConditionTag(!1,"HistoryRecordType Create encountered without Assign ",595723398),{icon:0,description:"Unexpected HistoryRecordType"};var r=Object(d.g)(o.assignee);return{icon:13,description:t.formatString(114,r)};case c.a.UnassignAll:case c.a.Unassign:var o;if(!(o=e.records[1])||o.type!==c.a.Assign)return Object(a.i)().assertConditionTag(!1,"HistoryRecordType Unassign encountered without Assign ",595723399),{icon:14,description:t.getString(204)};r=Object(d.g)(o.assignee);return{icon:14,description:t.formatString(115,r)};case c.a.Progress:return 100===n.completion?{icon:15,description:t.getString(116)}:{icon:21,description:t.getString(117)};case c.a.Schedule:return{icon:17,description:t.getString(118)};default:return Object(a.i)().assertConditionTag(!1,"Unexpected HistoryRecordType",595723400),{icon:0,description:t.getString(119)}}}function D(e,t){return e.findIndex((function(e){return e.length>0&&S(e[0])===t}))}function E(e,t){return e.some((function(e){return Object(p.a)(e)&&!!(e.commentModel.commentFlags&i.f.LowFidelity)&&(void 0===t||t===e.commentModel.parentId||t===e.commentModel.commentId)}))}function j(e,t,n,r,o){for(var i=[],s=!o&&void 0!==n&&n.index>=0,c=v(e).length,d=n&&n.index===c?c:-1,u=-1,l=0;l<e.length;l+=1){var m=e[l],C=Object(p.a)(m)?m:void 0;if(C&&void 0!==t[C.commentModel.commentId])if(t[C.commentModel.commentId].pending===f.a.Delete&&r)for(;!(l+1>=e.length||""===O(e[l+1]));)++l;else{++u,i.push([C]),s&&-1===d&&n&&u===n.index&&(d=i.length-1);for(var g=l+1;g<e.length;g+=1){if(m=e[g],Object(p.a)(m)){var h=O(m);if(h!==C.commentModel.commentId){Object(a.i)().assertConditionTag(!h,"Orphaned reply with id "+I(m)+", expected parent "+C.commentModel.commentId+" but was "+h,593085889);break}i[i.length-1].push(m),++u}else i[i.length-1].push(m);++l}}else{var b=C?C.commentModel.commentId:"",y=C?C.commentModel.parentId:"";for(Object(a.i)().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: "+e.length+" | cardViewStateLength: "+Object.keys(t).length+" | isLieThread: "+s+" | CommentId: "+b+" | ParentId: "+y,593085888);!(l+1>=e.length||""===O(e[l+1]));)++l}}return-1!==d&&s&&n&&i.splice(d,0,[{commentModel:n.newComment}]),i}},1021:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"}(r||(r={}))},1023:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=(n(171),o.a.createContext(null));var i=function(e){e()},s={notify:function(){}};function c(){var e=i,t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}var d=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=s,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=c())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=s)},e}();var u=function(e){var t=e.store,n=e.context,i=e.children,s=Object(r.useMemo)((function(){var e=new d(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),c=Object(r.useMemo)((function(){return t.getState()}),[t]);Object(r.useEffect)((function(){var e=s.subscription;return e.trySubscribe(),c!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[s,c]);var u=n||a;return o.a.createElement(u.Provider,{value:s},i)},l=n(105),m=n(141),f=n(294),p=n.n(f),C=n(1255),g="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect,h=[],b=[null,null];function v(e,t){var n=e[1];return[t.payload,n+1]}function y(e,t,n){g((function(){return e.apply(void 0,t)}),n)}function T(e,t,n,r,o,a,i){e.current=r,t.current=o,n.current=!1,a.current&&(a.current=null,i())}function O(e,t,n,r,o,a,i,s,c,d){if(e){var u=!1,l=null,m=function(){if(!u){var e,n,m=t.getState();try{e=r(m,o.current)}catch(e){n=e,l=e}n||(l=null),e===a.current?i.current||c():(a.current=e,s.current=e,i.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=m,n.trySubscribe(),m();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,l)throw l}}}var I=function(){return[null,0]};function S(e,t){void 0===t&&(t={});var n=t,i=n.getDisplayName,s=void 0===i?function(e){return"ConnectAdvanced("+e+")"}:i,c=n.methodName,u=void 0===c?"connectAdvanced":c,f=n.renderCountProp,g=void 0===f?void 0:f,S=n.shouldHandleStateChanges,_=void 0===S||S,D=n.storeKey,E=void 0===D?"store":D,j=(n.withRef,n.forwardRef),P=void 0!==j&&j,x=n.context,A=void 0===x?a:x,k=Object(m.a)(n,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]),R=A;return function(t){var n=t.displayName||t.name||"Component",a=s(n),i=Object(l.a)({},k,{getDisplayName:s,methodName:u,renderCountProp:g,shouldHandleStateChanges:_,storeKey:E,displayName:a,wrappedComponentName:n,WrappedComponent:t}),c=k.pure;var f=c?r.useMemo:function(e){return e()};function S(n){var a=Object(r.useMemo)((function(){var e=n.reactReduxForwardedRef,t=Object(m.a)(n,["reactReduxForwardedRef"]);return[n.context,e,t]}),[n]),s=a[0],c=a[1],u=a[2],p=Object(r.useMemo)((function(){return s&&s.Consumer&&Object(C.isContextConsumer)(o.a.createElement(s.Consumer,null))?s:R}),[s,R]),g=Object(r.useContext)(p),S=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(g)&&Boolean(g.store);var D=S?n.store:g.store,E=Object(r.useMemo)((function(){return function(t){return e(t.dispatch,i)}(D)}),[D]),j=Object(r.useMemo)((function(){if(!_)return b;var e=new d(D,S?null:g.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[D,S,g]),P=j[0],x=j[1],A=Object(r.useMemo)((function(){return S?g:Object(l.a)({},g,{subscription:P})}),[S,g,P]),k=Object(r.useReducer)(v,h,I),w=k[0][0],N=k[1];if(w&&w.error)throw w.error;var M=Object(r.useRef)(),F=Object(r.useRef)(u),L=Object(r.useRef)(),V=Object(r.useRef)(!1),B=f((function(){return L.current&&u===F.current?L.current:E(D.getState(),u)}),[D,w,u]);y(T,[F,M,V,u,B,L,x]),y(O,[_,D,P,E,F,M,V,L,x,N],[D,P,E]);var H=Object(r.useMemo)((function(){return o.a.createElement(t,Object(l.a)({},B,{ref:c}))}),[c,t,B]);return Object(r.useMemo)((function(){return _?o.a.createElement(p.Provider,{value:A},H):H}),[p,H,A])}var D=c?o.a.memo(S):S;if(D.WrappedComponent=t,D.displayName=a,P){var j=o.a.forwardRef((function(e,t){return o.a.createElement(D,Object(l.a)({},e,{reactReduxForwardedRef:t}))}));return j.displayName=a,j.WrappedComponent=t,p()(j,t)}return p()(D,t)}}function _(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function D(e,t){if(_(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!_(e[n[o]],t[n[o]]))return!1;return!0}var E=n(149);function j(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function P(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function x(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=P(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=P(o),o=r(t,n)),o},r}}var A=[function(e){return"function"==typeof e?x(e):void 0},function(e){return e?void 0:j((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?j((function(t){return Object(E.bindActionCreators)(e,t)})):void 0}];var k=[function(e){return"function"==typeof e?x(e):void 0},function(e){return e?void 0:j((function(){return{}}))}];function R(e,t,n){return Object(l.a)({},n,e,t)}var w=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,o=n.pure,a=n.areMergedPropsEqual,i=!1;return function(t,n,s){var c=e(t,n,s);return i?o&&a(c,r)||(r=c):(i=!0,r=c),r}}}(e):void 0},function(e){return e?void 0:function(){return R}}];function N(e,t,n,r){return function(o,a){return n(e(o,a),t(r,a),a)}}function M(e,t,n,r,o){var a,i,s,c,d,u=o.areStatesEqual,l=o.areOwnPropsEqual,m=o.areStatePropsEqual,f=!1;function p(o,f){var p,C,g=!l(f,i),h=!u(o,a);return a=o,i=f,g&&h?(s=e(a,i),t.dependsOnOwnProps&&(c=t(r,i)),d=n(s,c,i)):g?(e.dependsOnOwnProps&&(s=e(a,i)),t.dependsOnOwnProps&&(c=t(r,i)),d=n(s,c,i)):h?(p=e(a,i),C=!m(p,s),s=p,C&&(d=n(s,c,i)),d):d}return function(o,u){return f?p(o,u):(s=e(a=o,i=u),c=t(r,i),d=n(s,c,i),f=!0,d)}}function F(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,a=Object(m.a)(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),i=n(e,a),s=r(e,a),c=o(e,a);return(a.pure?M:N)(i,s,c,e,a)}function L(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function V(e,t){return e===t}function B(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?S:n,o=t.mapStateToPropsFactories,a=void 0===o?k:o,i=t.mapDispatchToPropsFactories,s=void 0===i?A:i,c=t.mergePropsFactories,d=void 0===c?w:c,u=t.selectorFactory,f=void 0===u?F:u;return function(e,t,n,o){void 0===o&&(o={});var i=o,c=i.pure,u=void 0===c||c,p=i.areStatesEqual,C=void 0===p?V:p,g=i.areOwnPropsEqual,h=void 0===g?D:g,b=i.areStatePropsEqual,v=void 0===b?D:b,y=i.areMergedPropsEqual,T=void 0===y?D:y,O=Object(m.a)(i,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),I=L(e,a,"mapStateToProps"),S=L(t,s,"mapDispatchToProps"),_=L(n,d,"mergeProps");return r(f,Object(l.a)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:I,initMapDispatchToProps:S,initMergeProps:_,pure:u,areStatesEqual:C,areOwnPropsEqual:h,areStatePropsEqual:v,areMergedPropsEqual:T},O))}}var H=B();function U(){return Object(r.useContext)(a)}function G(e){void 0===e&&(e=a);var t=e===a?U:function(){return Object(r.useContext)(e)};return function(){return t().store}}var W=G();function q(e){void 0===e&&(e=a);var t=e===a?W:G(e);return function(){return t().dispatch}}var z=q(),Y=function(e,t){return e===t};function K(e){void 0===e&&(e=a);var t=e===a?U:function(){return Object(r.useContext)(e)};return function(e,n){void 0===n&&(n=Y);var o=t(),a=function(e,t,n,o){var a,i=Object(r.useReducer)((function(e){return e+1}),0)[1],s=Object(r.useMemo)((function(){return new d(n,o)}),[n,o]),c=Object(r.useRef)(),u=Object(r.useRef)(),l=Object(r.useRef)(),m=Object(r.useRef)(),f=n.getState();try{a=e!==u.current||f!==l.current||c.current?e(f):m.current}catch(e){throw c.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),e}return g((function(){u.current=e,l.current=f,m.current=a,c.current=void 0})),g((function(){function e(){try{var e=u.current(n.getState());if(t(e,m.current))return;m.current=e}catch(e){c.current=e}i()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[n,s]),a}(e,n,o.store,o.subscription);return Object(r.useDebugValue)(a),a}}var X,J=K(),Q=n(38);n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return H})),n.d(t,"c",(function(){return z})),n.d(t,"d",(function(){return J})),X=Q.unstable_batchedUpdates,i=X},1024:function(e,t,n){"use strict";var r,o,a=n(216);!function(e){e[e.Enabled=0]="Enabled",e[e.Execute=1]="Execute",e[e.Query=2]="Query"}(o||(o={}));var i,s=((r={})[0]=a.DeltaFormattingType.Weight,r[1]=a.DeltaFormattingType.Highlight,r[2]=a.DeltaFormattingType.Hyperlink,r[3]=a.DeltaFormattingType.Italic,r[4]=a.DeltaFormattingType.Strikethrough,r[5]=a.DeltaFormattingType.Underline,r[6]=a.DeltaFormattingType.Color,r),c=n(5),d=function(){function e(){var e=this;this.selectionChangedHandlers=[],this.keypressHandlers=[],this.onHyperlinkClick=function(t){return!!e.hyperlinkNavigator&&e.hyperlinkNavigator(t)},this.onSelectionChangeHandler=function(){e.invokeHandlers(e.selectionChangedHandlers)},this.onKeypressHandler=function(t){e.invokeHandlers(e.keypressHandlers,t)}}return e.prototype.executeCommand=function(e,t,n){var r,o,i,s;if(!this.richContentEditorActor)return 1;if(0===t)return this.isRootCommandEnabled(e)?2:0;if(this.isRootCommandEnabled(e)){if(2===t&&n){var c=this.richContentEditorActor.getFormattingAtCurrentSelection();switch(e){case 0:n.bold=c.bold;break;case 3:n.italic=c.italic;break;case 5:n.underline=c.underline;break;case 4:n.strikethrough=c.strikethrough;break;case 1:n.highlight=c.highlight;break;case 6:n.fontColor=c.fontColor}return 2}var d=void 0,u=void 0;switch(e){case 0:d={type:a.DeltaFormattingType.Weight};break;case 3:d={type:a.DeltaFormattingType.Italic};break;case 5:d={type:a.DeltaFormattingType.Underline};break;case 4:d={type:a.DeltaFormattingType.Strikethrough};break;case 2:if(null===(r=null==n?void 0:n.hyperlinkData)||void 0===r?void 0:r.link){var l=null===(o=null==n?void 0:n.hyperlinkData)||void 0===o?void 0:o.link,m=null!==(s=null===(i=null==n?void 0:n.hyperlinkData)||void 0===i?void 0:i.text)&&void 0!==s?s:l;u={type:a.DeltaFormattingType.Hyperlink,data:{text:m,link:l}}}break;case 1:(null==n?void 0:n.highlight)&&(d={type:a.DeltaFormattingType.Highlight,data:{color:n.highlight.color}});break;case 6:(null==n?void 0:n.fontColor)&&(d={type:a.DeltaFormattingType.Color,data:{fontColor:n.fontColor.color}})}return d&&this.richContentEditorActor.applyFormattingToCurrentSelection(d),u&&this.richContentEditorActor.addContent(u),2}return 0},e.prototype.getSelection=function(){return this.richContentEditorActor?{text:this.richContentEditorActor.getSelection().text}:{text:""}},e.prototype.initRichContentEditor=function(e){Object(c.i)().assertConditionTag(!this.richContentEditorActor,"[initRichContentEditor] RichContentEditor already set",590141192),this.richContentEditorActor=e,this.richContentEditorActor.registerSelectionChangeHandler(this.onSelectionChangeHandler),this.richContentEditorActor.registerKeypressHandler(this.onKeypressHandler)},e.prototype.registerSelectionChangeHandler=function(e){e&&this.selectionChangedHandlers.push(e)},e.prototype.registerKeypressHandler=function(e){e&&this.keypressHandlers.push(e)},e.prototype.registerSafelinksNavigator=function(e){e&&(this.hyperlinkNavigator=e)},e.prototype.setFocus=function(){this.richContentEditorActor&&this.richContentEditorActor.setFocus()},e.prototype.isRootCommandEnabled=function(e){return!!this.richContentEditorActor&&this.richContentEditorActor.isFormatEnabled(s[e])},e.prototype.invokeHandlers=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e)for(var r=0;r<e.length;r++)e[r].apply(e,t)},e}();function u(){return void 0===i&&(i=new d),i}var l=new(function(){function e(){}return e.prototype.getRichContentEditAPI=function(){return u()},e}());n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}))},1026:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Like=1]="Like"}(r||(r={}))},1027:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.Enter="Enter",e.Escape="Escape",e.Meta="Meta",e.Tab="Tab",e.Home="Home",e.End="End",e.F6="F6",e.F12="F12",e.Space=" "}(r||(r={}))},1028:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(88);function o(e,t){if(!t)return e;switch(e){case r.c.ArrowLeft:return r.c.ArrowRight;case r.c.ArrowRight:return r.c.ArrowLeft;default:return e}}function a(e){switch(e){case"Down":return r.c.ArrowDown;case"Up":return r.c.ArrowUp;case"Left":return r.c.ArrowLeft;case"Right":return r.c.ArrowRight;case"OS":return r.c.Meta;case"Del":return r.c.Delete;case"Spacebar":return" ";case"Esc":return r.c.Escape;case"Ctrl":case"Ctl":return r.c.Control;case"F6":return r.c.F6;case"F12":return r.c.F12;default:return e}}},103:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));var r,o=n(385);function a(e){return e===o.a.CheckEnabled}function i(e){return e===o.a.CheckToggled}function s(e){return e===o.a.Execute}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"}(r||(r={}))},1031:function(e,t,n){"use strict";var r,o=n(0),a=n(1);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(void 0,Object(a.__spreadArrays)(n,t))}),t)}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!r)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return r((function(){return e.apply(void 0,t)}),t)}function c(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r)throw new Error("Recursive calls of hooks is not supported!");r=e;var o=s.apply(void 0,t);return r=void 0,o}}c(o.useMemo);var d,u=c(o.useEffect),l=(c(o.useLayoutEffect),d=o.useCallback,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r)throw new Error("Recursive calls of hooks is not supported!");r=d;var n=i.apply(void 0,e);return r=void 0,n}),m=function(e,t,n){return e()&&n?n(t):null};n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return m}))},1038:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=!1;function o(){r=!0}function a(){return r}},1039:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17),o=n(16),a=n(231);function i(e,t,n){var i=Object(o.J)(n);if(i)return i.threadId!==e?a.a.InOtherCard:r.n()&&i.renderContextType!==t?a.a.InOtherContextOfThisCard:"EDIT"===i.commentDraft.sessionConfiguration.sessionType?a.a.InChildPost:a.a.InCard}},107:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"}(r||(r={})),t.b=r},1088:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},1089:function(e,t,n){var r=n(1541);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},109:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"}(r||(r={}))},1090:function(e,t,n){var r=n(1091),o=n(1093),a=n(1542);e.exports=function(e){return function(t,n,i){var s,c=r(t),d=o(c.length),u=a(i,d);if(e&&n!=n){for(;d>u;)if((s=c[u++])!=s)return!0}else for(;d>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},1091:function(e,t,n){var r=n(911),o=n(912);e.exports=function(e){return r(o(e))}},1092:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},1093:function(e,t,n){var r=n(1094),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},1094:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},1095:function(e,t,n){var r=n(910)("wks"),o=n(909),a=n(546).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},1096:function(e,t,n){var r=n(1089),o=n(911),a=n(1097),i=n(1093),s=n(1545);e.exports=function(e,t){var n=1==e,c=2==e,d=3==e,u=4==e,l=6==e,m=5==e||l,f=t||s;return function(t,s,p){for(var C,g,h=a(t),b=o(h),v=r(s,p,3),y=i(b.length),T=0,O=n?f(t,y):c?f(t,0):void 0;y>T;T++)if((m||T in b)&&(g=v(C=b[T],T,h),e))if(n)O[T]=g;else if(g)switch(e){case 3:return!0;case 5:return C;case 6:return T;case 2:O.push(C)}else if(u)return!1;return l?-1:d||u?u:O}}},1097:function(e,t,n){var r=n(912);e.exports=function(e){return Object(r(e))}},1102:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-1.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M7.4375,24.8349609 C7.875,24.8349609 8.29654745,24.8919265 8.70214844,25.0058594 C9.10774942,25.1197922 9.48827947,25.2815745 9.84375,25.4912109 C10.1992205,25.7008474 10.522785,25.9514959 10.8144531,26.2431641 C11.1061213,26.5348322 11.3567698,26.8583967 11.5664062,27.2138672 C11.7760427,27.5693377 11.937825,27.9498678 12.0517578,28.3554688 C12.1656907,28.7610697 12.2226562,29.1826172 12.2226562,29.6201172 C12.2226562,30.2444693 12.1030285,30.8471651 11.8637695,31.4282227 C11.6245105,32.0092802 11.2838564,32.5208311 10.8417969,32.9628906 L5.12011719,38.6777344 L4.50488281,38.0625 L10.2197266,32.3408203 C10.5797544,31.9807925 10.8577464,31.5649438 11.0537109,31.0932617 C11.2496755,30.6215797 11.3476562,30.1305364 11.3476562,29.6201172 C11.3476562,29.0869114 11.2439789,28.5833357 11.0366211,28.109375 C10.8292633,27.6354143 10.5478533,27.2207049 10.1923828,26.8652344 C9.83691229,26.5097638 9.42220289,26.2283539 8.94824219,26.0209961 C8.47428148,25.8136383 7.97070579,25.7099609 7.4375,25.7099609 C6.94531004,25.7099609 6.51123235,25.7840162 6.13525391,25.9321289 C5.75927546,26.0802416 5.41178545,26.2762032 5.09277344,26.5200195 C4.77376143,26.7638359 4.46728663,27.0406886 4.17333984,27.3505859 C3.87939306,27.6604833 3.57063964,27.9794905 3.24707031,28.3076172 L6.125,28.3076172 L6.125,29.1826172 L1.75,29.1826172 L1.75,24.8076172 L2.625,24.8076172 L2.625,27.6855469 C2.87565229,27.4303373 3.11604703,27.1831067 3.34619141,26.9438477 C3.57633579,26.7045886 3.80647671,26.479005 4.03662109,26.2670898 C4.26676547,26.0551747 4.50146365,25.8614918 4.74072266,25.6860352 C4.97998167,25.5105785 5.23518745,25.3601894 5.50634766,25.2348633 C5.77750787,25.1095371 6.07145024,25.0115563 6.38818359,24.940918 C6.70491695,24.8702796 7.05468559,24.8349609 7.4375,24.8349609 Z",id:"Reopen"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1103:function(e,t,n){"use strict";var r=n(1589).SharedCommentsVersion;t.a=r},1104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(130),o=n(17),a=n(16);function i(e,t){if(!o.n())return!1;var n=Object(a.J)(e);return void 0!==n&&n.renderContextType!==t&&n.commentDraft.sessionConfiguration.sessionType===r.a}},1105:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),o=n(16),a=n(165),i=n(127);function s(e,t){var n=Object(o.J)(e);if(!n)return Object(r.i)().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Object(i.b)(t)?a.a.ClosePaneDraft:a.a.CancelNewDraft;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return a.a.CancelNewDraft;case"EDIT":return a.a.CancelPostEdit;case"REPLY":return a.a.CancelReplyDraft;case"METADATA":return Object(r.i)().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),a.a.CancelNewDraft}}},114:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r,o=n(21);function a(e){switch(e){case r.SelectCard:case r.Polite:return!1;case r.ExpandCard:case r.SelectPost:return!0}}function i(e,t,n,r,a){return Object(o.b)("SELECT_COMMENT",{selectedCard:t,selectedPost:n,selectType:r,source:a},e)}!function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"}(r||(r={}))},119:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"m",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"n",(function(){return C})),n.d(t,"a",(function(){return g}));var r="Selected comment not found",o="Selected thread index out of bounds",a="Invalid number of posts for display more replies string",i="Unrecognized post display mode",s="Method not implemented",c="StringId is invalid",d="LocalizationModule NativeModule not valid",u="Store state unexpected",l="Editor reference is invalid",m="Invalid arguments",f="Comment ID value is invalid in the current operation",p="Attempting to perform an operation on an inactive draft",C="Feature not running with the correct feature gates which expect view manager construction",g="CommentModel not found in a thread of RenderableItems"},1196:function(e,t,n){"use strict";var r=n(5),o=n(974),a=n(12),i=n(41),s=n(169),c=n(207),d=function(){function e(){}return e.prototype.getThemeMode=function(){return 0},e}(),u=n(17);n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return g}));var l,m=(l=new d,{setThemeAPI:function(e){l=e},getThemeAPI:function(){return l},resetThemeAPI:function(){l=new d}});function f(){return!!u.bb()&&1===m.getThemeAPI().getThemeMode()}function p(){return!u.bb()||0===m.getThemeAPI().getThemeMode()}var C=Object(a.c)((function(e){return Object(r.i)().assertConditionTag(u.bb(),"Semantic color map should not be used if web theme integration is disabled.",553710797),f()?function(e){return Object(r.i)().assertConditionTag(f(),"Should not retrieve dark mode semantic colors if dark theme is not set.",545067039),{AtMentionHighlight:o.b.gray140,AtMentionText:o.b.gray40,AtMentionToMeHighlight:e.palette.themeTertiary,AtMentionToMeText:e.palette.black,BlueDot:"#5099FF",CancelDraftButtonIcon:void 0,CancelDraftButtonIconFocused:void 0,CancelDraftButtonIconHovered:void 0,CancelDraftButtonIconPressed:void 0,CardBackground:o.b.gray180,CardBorder:o.b.gray120,CardBorderEmphasis:"#C480CB",CardTopperContainerBorder:o.b.gray140,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:e.palette.themePrimary,CheckBoxBackgroundCheckedHovered:"#3D7CE8",CheckBoxBackgroundHovered:o.b.gray190,CheckBoxBackgroundPressed:e.palette.white,CheckBoxBorder:o.b.gray80,CheckBoxBorderCheckedHovered:"#3D7CE8",CheckBoxBorderDisabled:o.b.gray130,CheckBoxBorderHovered:o.b.gray80,CheckBoxCheckMark:o.b.gray80,CheckBoxCheckMarkChecked:e.palette.black,ClosePaneButton:o.b.gray20,ClosePaneButtonFocused:e.palette.black,ClosePaneButtonHovered:u.X()?o.b.gray160:void 0,ClosePaneButtonPressed:u.X()?o.b.gray150:void 0,ClosePaneButtonIcon:o.b.gray20,ClosePaneButtonIconHovered:u.X()?o.b.gray20:void 0,ClosePaneButtonIconPressed:u.X()?o.b.gray20:void 0,CommonControlBorder:o.b.gray120,DefaultButton:"transparent",DefaultButtonHovered:o.b.gray160,DefaultButtonIcon:o.b.gray20,DefaultButtonIconDisabled:o.b.gray130,DefaultButtonPressed:e.palette.white,ExpandButtonTextResolved:o.b.gray80,ExpandButtonTextResolvedHovered:o.b.gray50,ExpandButtonTextResolvedPressed:o.b.gray30,Hyperlink:"#7DB0FF",HyperlinkActive:"#FF0000",MenuIcon:e.palette.black,MenuIconDisabled:o.b.gray130,MenuIconHoveredPressed:e.palette.black,NewCommentButton:"transparent",NewCommentButtonBorderFocused:o.b.gray20,NewCommentButtonDisabled:o.b.gray130,NewCommentButtonHovered:o.b.gray180,NewCommentButtonLabel:o.b.gray20,NewCommentButtonLabelHovered:o.b.gray20,NewCommentButtonPressed:o.b.gray160,NewCommentButtonIconHoveredPressed:"#3D7CE8",PaneBackground:o.b.gray200,PersonaColorResolved:o.b.gray80,PersonaInitialsTextColor:e.palette.black,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themePrimary,PrimaryButtonHovered:"#3D7CE8",PrimaryButtonIcon:e.palette.black,PrimaryButtonPressed:e.palette.themeDarker,ResolvedCardBackground:e.palette.white,ResolvedCardText:o.b.gray80,ResolvedCardTitle:o.b.gray50,SmartRepliesText:o.b.gray20,SubText:o.b.gray80,SuggestedItem:o.b.gray140,SuggestedItemHovered:o.b.gray120,SuggestedItemPressed:e.palette.white,TaskAssignerFocus:e.palette.black,TaskAssignerText:o.b.gray20,TaskBorder:e.palette.black,TaskPickerButton:e.palette.black,Text:o.b.gray20}}(e):function(e){return Object(r.i)().assertConditionTag(p(),"Should not retrieve light mode semantic colors if light theme is not set.",545067040),{AtMentionHighlight:o.b.gray20,AtMentionText:o.b.gray180,AtMentionToMeHighlight:e.palette.themeLighter,AtMentionToMeText:e.palette.themeDarkAlt,BlueDot:"#006bFF",CancelDraftButtonIcon:i.a.GRAY_E,CancelDraftButtonIconFocused:i.a.GRAY_J,CancelDraftButtonIconHovered:i.a.GRAY_J,CancelDraftButtonIconPressed:i.a.GRAY_J,CardBackground:e.palette.white,CardBorder:i.a.COMMENTS_GRAY,CardBorderEmphasis:i.a.COMMENTS_PURPLE,CardTopperContainerBorder:i.a.GRAY_B,CheckBoxBackground:"transparent",CheckBoxBackgroundChecked:c.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundCheckedHovered:c.b.TASK_ASSIGNER_CHECKED_BOX,CheckBoxBackgroundHovered:"transparent",CheckBoxBackgroundPressed:"transparent",CheckBoxBorder:c.b.TASK_BORDER,CheckBoxBorderCheckedHovered:c.b.TASK_BORDER,CheckBoxBorderDisabled:c.b.TASK_DISABLED,CheckBoxBorderHovered:c.b.TASK_CHECKBOX_COLOR,CheckBoxCheckMark:c.b.TASK_TEXT,CheckBoxCheckMarkChecked:e.palette.white,ClosePaneButton:i.a.GRAY_E,ClosePaneButtonFocused:i.a.ACTIVE_COMMENT_TEXT,ClosePaneButtonHovered:u.X()?o.b.gray40:i.a.GRAY_J,ClosePaneButtonPressed:u.X()?o.b.gray70:i.a.GRAY_J,ClosePaneButtonIcon:i.a.GRAY_F,ClosePaneButtonIconHovered:i.a.GRAY_J,ClosePaneButtonIconPressed:i.a.GRAY_J,CommonControlBorder:o.b.gray110,DefaultButton:"transparent",DefaultButtonHovered:void 0,DefaultButtonIcon:o.b.gray200,DefaultButtonIconDisabled:o.b.gray100,DefaultButtonPressed:void 0,ExpandButtonTextResolved:o.b.gray130,ExpandButtonTextResolvedHovered:i.a.GRAY_H,ExpandButtonTextResolvedPressed:i.a.GRAY_H,Hyperlink:"#0000EE",HyperlinkActive:"#FF0000",MenuIcon:i.a.GRAY_F,MenuIconDisabled:i.a.GRAY_C,MenuIconHoveredPressed:i.a.GRAY_J,NewCommentButton:e.palette.white,NewCommentButtonBorderFocused:e.palette.black,NewCommentButtonDisabled:s.b.BUTTON_DISABLED,NewCommentButtonHovered:void 0,NewCommentButtonLabel:o.b.gray180,NewCommentButtonLabelHovered:i.a.GRAY_J,NewCommentButtonPressed:void 0,NewCommentButtonIconHoveredPressed:i.a.GRAY_J,PaneBackground:o.b.gray30,PersonaColorResolved:o.b.gray130,PersonaInitialsTextColor:e.palette.white,PersonaInitialsTextColorResolved:e.palette.white,PrimaryButton:e.palette.themePrimary,PrimaryButtonFocused:e.palette.themeDarkAlt,PrimaryButtonHovered:e.palette.themeDarkAlt,PrimaryButtonIcon:e.palette.white,PrimaryButtonPressed:e.palette.themeDark,ResolvedCardBackground:o.b.gray20,ResolvedCardText:o.b.gray130,ResolvedCardTitle:o.b.gray160,SmartRepliesText:o.b.gray140,SubText:i.a.GRAY_E,SuggestedItem:i.a.SUGGESTED_PICKER_ITEM,SuggestedItemHovered:i.a.SUGGESTED_PICKER_ITEM_HOVER,SuggestedItemPressed:i.a.SUGGESTED_PICKER_ITEM_HOVER,TaskAssignerFocus:c.b.TASK_BORDER_FOCUS,TaskAssignerText:e.palette.black,TaskBorder:c.b.TASK_BORDER,TaskPickerButton:c.b.TASK_BORDER,Text:i.a.ACTIVE_COMMENT_TEXT}}(e)})),g=Object(a.c)((function(e){return Object(r.i)().assertConditionTag(u.bb(),"Semantic style map should not be used if web theme integration is disabled",545067043),f()?function(e){return Object(r.i)().assertConditionTag(f(),"Should not retrieve dark mode semantic styles if dark theme is not set.",545067041),{BoxShadowLevel1:"0px 1px 4px 0px rgba(0,0,0,0.2)",BoxShadowLevel2:"0px 1px 8px 8px rgba(0,0,0,0.2)",BoxShadowLevel3:"0px 1px 16px 8px rgba(0,0,0,0.2)",BoxShadowLevel4:"0px 1px 32px 8px rgba(0,0,0,0.2)",BoxShadowLevel5:"0px 1px 48px 8px rgba(0,0,0,0.2)",CalloutBoxShadow:"0px 1px 16px 8px rgba(0,0,0,0.2)",CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(255, 255, 255, 0.2)",DefaultButtonFocusedBorder:"1px solid "+e.palette.black,DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #323130",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px black",PostOverlay:"rgba(0,0,0,0.5)"}}(e):(Object(r.i)().assertConditionTag(p(),"Should not retrieve light mode semantic styles if light theme is not set.",545067042),{BoxShadowLevel1:"0px 1px 2px 0px rgba(0,0,0,0.1)",BoxShadowLevel2:"0px 1px 4px 0px rgba(0,0,0,0.1)",BoxShadowLevel3:"0px 1px 8px 0px rgba(0,0,0,0.1)",BoxShadowLevel4:"0px 1px 16px 0px rgba(0,0,0,0.1)",BoxShadowLevel5:"0px 1px 24px 0px rgba(0,0,0,0.1)",CalloutBoxShadow:void 0,CardBorder:"1px solid",DefaultButtonBoxShadow:"0 2px 4px -.75px rgba(0,0,0,0.1)",DefaultButtonFocusedBorder:"1px solid",DisabledButtonBoxShadow:"inset 0px 0px 0px 1px #F3F2F1",FocusedButtonBoxShadow:"inset 0px 0px 0px 1px white",PostOverlay:"rgba(255,255,255,0.5)"})}))},1234:function(e,t,n){"use strict";var r;n(17);!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(r||(r={}));n(23),n(96),n(127);var o=n(41);n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s}));r.None;var a=function(e){return"ios"===e||"android"===e};function i(e,t){return!e||t?o.a.WHITE:o.a.REST_RESOLVED_BODY}function s(e,t,n){return e&&(!n||t)}},1255:function(e,t,n){"use strict";e.exports=n(1590)},127:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(23);function o(e){return e===r.a.FullPane||e===r.a.HalfPane}function a(e){return e===r.a.DiscreteIntegrated||e===r.a.DiscreteIsolated}},129:function(e,t,n){"use strict";var r=n(583),o=n(242);n.d(t,"j",(function(){return r.a})),n.d(t,"k",(function(){return r.c})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.d})),n.d(t,"e",(function(){return o.f})),n.d(t,"c",(function(){return o.c})),n.d(t,"h",(function(){return o.j})),n.d(t,"f",(function(){return o.g})),n.d(t,"g",(function(){return o.h})),n.d(t,"i",(function(){return o.k}))},130:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i}));var r="CREATE",o="EDIT",a="REPLY",i="METADATA"},131:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"}(r||(r={}))},132:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated",e[e.NativeHeartbeat=50]="NativeHeartbeat"}(r||(r={}))},14:function(e,t,n){"use strict";n.d(t,"m",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"v",(function(){return l})),n.d(t,"p",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"d",(function(){return C})),n.d(t,"k",(function(){return g})),n.d(t,"q",(function(){return h})),n.d(t,"h",(function(){return b})),n.d(t,"t",(function(){return v})),n.d(t,"r",(function(){return y})),n.d(t,"j",(function(){return T})),n.d(t,"o",(function(){return O})),n.d(t,"s",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return _})),n.d(t,"i",(function(){return D})),n.d(t,"g",(function(){return E})),n.d(t,"z",(function(){return j})),n.d(t,"y",(function(){return x})),n.d(t,"w",(function(){return A})),n.d(t,"n",(function(){return k})),n.d(t,"x",(function(){return R})),n.d(t,"u",(function(){return w})),n.d(t,"e",(function(){return N}));var r=n(100),o=n(23),a=n(1104),i=n(102),s=n(16),c=n(275),d=function(e){return e.commentState.contextState.isReadOnly},u=function(e){return e.commentState.atMentionState_deprecated},l=function(e){return e.commentState.topVisibleThreadId},m=function(e){return e.commentState.personaIconPropertiesMap},f=function(e){return e.commentState.cardViewState},p=function(e){return e.commentState.highlightedCommentId},C=function(e){return e.commentState.commentData},g=function(e){return e.commentState.commentData.length>0},h=function(e){return e.commentState.postViewState},b=function(e){return e.commentState.draftState},v=function(e){return Object(s.J)(b(e))},y=function(e){return e.commentState.selectedComment},T=function(e){return e.commentState.expandedComments},O=function(e){return e.commentState.pendingCommentLoad},I=function(e){return e.commentState.selectedThreadIdBeforeCommentSession},S=function(e){return e.commentState.capabilities_deprecated},_=function(e){return e.commentState.contextState},D=function(e,t,n){return Object(s.F)(b(e),t,n)},E=function(e,t,n){return e.commentState.createdCommentLie&&D(e,t,n)?e.commentState.createdCommentLie:void 0},j=function(){return Object(r.a)([C,c.b],i.l)},P=function(e,t){return t},x=function(e){return Object(r.a)([b,function(e){return E(e)},f,e,P],(function(e,t,n,r,s){return i.b(r,n,t,s.componentTreeId.renderContextType!==o.a.HalfPane,Object(a.a)(e,s.componentTreeId.renderContextType))}))},A=function(e){return e.commentState.virtualized},k=function(e){return e.commentState.modelCapabilities},R=function(){return Object(r.a)(b,(function(e){var t;return null===(t=Object(s.J)(e))||void 0===t?void 0:t.renderContextType}))},w=function(e){return e.commentState.suggestionsDetails},N=function(e,t){return t?C(e).find((function(e){return e.commentId===t})):void 0}},142:function(e,t,n){"use strict";var r=n(129),o=(n(1038),n(1021),n(432),n(585));n.d(t,"i",(function(){return r.j})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.e})),n.d(t,"g",(function(){return r.h})),n.d(t,"d",(function(){return r.f})),n.d(t,"f",(function(){return r.g})),n.d(t,"h",(function(){return r.i})),n.d(t,"e",(function(){return o.b})),n.d(t,"j",(function(){return o.d}))},145:function(e,t,n){"use strict";var r,o,a;!function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"}(r||(r={})),function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(a||(a={}));var i,s=function(){function e(e){this.apiContext=e}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}(),c=n(297),d=n(5),u=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(e){},e.prototype.moveFocus=function(e){},e.prototype.bringContentIntoView=function(e){},e}();function l(e,t){Object(d.i)().assertConditionTag(void 0===i,"Overriding already set ContentNavigationAPI.",591726551),i=e}function m(e){return Object(d.i)().assertConditionTag(e===c.a,"Unexpected API context received.",591726552),void 0===i&&(Object(d.i)().assertConditionTag(!1,"GetContentNavigationAPI called prior to API being set, overriding with stub.",591726553),i=new u),i}function f(e){return Object(d.i)().assertConditionTag(e===c.a,"Unexpected API context received.",591726554),void 0!==i}function p(e){Object(d.i)().assertConditionTag(e===c.a,"Unexpected API context received.",591726555),i=void 0}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return p}))},146:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.Reloading=3]="Reloading",e[e.NeedsReload=4]="NeedsReload"}(r||(r={}))},1530:function(e,t,n){n(1531),e.exports=n(373).Array.includes},1531:function(e,t,n){"use strict";var r=n(545),o=n(1090)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(913)("includes")},1532:function(e,t,n){var r=n(1533),o=n(1534),a=n(1536),i=Object.defineProperty;t.f=n(638)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},1533:function(e,t,n){var r=n(637);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},1534:function(e,t,n){e.exports=!n(638)&&!n(639)((function(){return 7!=Object.defineProperty(n(1535)("div"),"a",{get:function(){return 7}}).a}))},1535:function(e,t,n){var r=n(637),o=n(546).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},1536:function(e,t,n){var r=n(637);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},1537:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},1538:function(e,t,n){var r=n(546),o=n(908),a=n(1088),i=n(909)("src"),s=n(1539),c=(""+s).split("toString");n(373).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var d="function"==typeof n;d&&(a(n,"name")||o(n,"name",t)),e[t]!==n&&(d&&(a(n,i)||o(n,i,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[i]||s.call(this)}))},1539:function(e,t,n){e.exports=n(910)("native-function-to-string",Function.toString)},1540:function(e,t){e.exports=!1},1541:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},1542:function(e,t,n){var r=n(1094),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},1543:function(e,t,n){n(1544),e.exports=n(373).Array.find},1544:function(e,t,n){"use strict";var r=n(545),o=n(1096)(5),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(913)("find")},1545:function(e,t,n){var r=n(1546);e.exports=function(e,t){return new(r(e))(t)}},1546:function(e,t,n){var r=n(637),o=n(1547),a=n(1095)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},1547:function(e,t,n){var r=n(1092);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1548:function(e,t,n){n(1549),e.exports=n(373).String.trimRight},1549:function(e,t,n){"use strict";n(1550)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},1550:function(e,t,n){var r=n(545),o=n(912),a=n(639),i=n(1551),s="["+i+"]",c=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,n){var o={},s=a((function(){return!!i[e]()||"​"!="​"[e]()})),c=o[e]=s?t(l):i[e];n&&(o[n]=c),r(r.P+r.F*s,"String",o)},l=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},1551:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},1558:function(e,t,n){n(1559),e.exports=n(373).Array.findIndex},1559:function(e,t,n){"use strict";var r=n(545),o=n(1096)(6),a="findIndex",i=!0;a in[]&&Array(1)[a]((function(){i=!1})),r(r.P+r.F*i,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(913)(a)},1560:function(e,t,n){n(1561),e.exports=n(373).Object.assign},1561:function(e,t,n){var r=n(545);r(r.S+r.F,"Object",{assign:n(1562)})},1562:function(e,t,n){"use strict";var r=n(638),o=n(1563),a=n(1567),i=n(1568),s=n(1097),c=n(911),d=Object.assign;e.exports=!d||n(639)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||Object.keys(d({},t)).join("")!=r}))?function(e,t){for(var n=s(e),d=arguments.length,u=1,l=a.f,m=i.f;d>u;)for(var f,p=c(arguments[u++]),C=l?o(p).concat(l(p)):o(p),g=C.length,h=0;g>h;)f=C[h++],r&&!m.call(p,f)||(n[f]=p[f]);return n}:d},1563:function(e,t,n){var r=n(1564),o=n(1566);e.exports=Object.keys||function(e){return r(e,o)}},1564:function(e,t,n){var r=n(1088),o=n(1091),a=n(1090)(!1),i=n(1565)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),c=0,d=[];for(n in s)n!=i&&r(s,n)&&d.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~a(d,n)||d.push(n));return d}},1565:function(e,t,n){var r=n(910)("keys"),o=n(909);e.exports=function(e){return r[e]||(r[e]=o(e))}},1566:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},1567:function(e,t){t.f=Object.getOwnPropertySymbols},1568:function(e,t){t.f={}.propertyIsEnumerable},1569:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 192 768 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15 m 768 0 q 40 0 75 15 q 35 15 61 41 q 26 26 41 61 q 15 35 15 75 q 0 40 -15 75 q -15 35 -41 61 q -26 26 -61 41 q -35 15 -75 15 q -40 0 -75 -15 q -35 -15 -61 -41 q -26 -26 -41 -61 q -15 -35 -15 -75 q 0 -40 15 -75 q 15 -35 41 -61 q 26 -26 61 -41 q 35 -15 75 -15"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1570:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:0}),r.createElement("path",{className:"OfficeIconColors_m22",fill:"currentColor",d:"M 1965 173 l -850 851 l 850 851 l -90 90 l -851 -850 l -851 850 l -90 -90 l 850 -851 l -850 -851 l 90 -90 l 851 850 l 851 -850",key:1})])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1571:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 1920 128 v 1280 h -256 v 512 l -512 -512 h -1024 v -512 h 128 v 384 h 949 l 331 331 v -331 h 256 v -1024 h -1024 v -128 m 128 384 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1572:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M 896 512 h -384 v 384 h -128 v -384 h -384 v -128 h 384 v -384 h 128 v 384 h 384 m 1024 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -640 h 128 v 512 h 256 v 331 l 331 -331 h 949 v -1024 h -1024 v -128 z"}))}o.defaultProps={width:"16",height:"16",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1573:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("path",{type:"path",className:"OfficeIconColors_HighContrast",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:0}),r.createElement("path",{type:"path",fill:"currentColor",className:"OfficeIconColors_m22",d:"M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",key:1})])}o.defaultProps={height:"100%",width:"100%",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1574:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("path",{fill:"currentColor",d:"M0,7.93,1.32,4,0,0,11.9,4ZM2,3.59H8.41L1.18,1.18ZM1.18,6.75,8.41,4.34H2Z"}))}o.defaultProps={viewBox:"-0.25 0.5 11.9 7.93",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1575:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M9.75,2.25H9v8.63a1,1,0,0,1-.09.43,1.1,1.1,0,0,1-.6.6,1,1,0,0,1-.43.09h-6a1,1,0,0,1-.44-.09,1.1,1.1,0,0,1-.6-.6,1,1,0,0,1-.09-.43V2.25H0V1.5H3V.75A.68.68,0,0,1,3.06.46.78.78,0,0,1,3.22.22.78.78,0,0,1,3.46.06.68.68,0,0,1,3.75,0H6a.68.68,0,0,1,.29.06.78.78,0,0,1,.24.16.78.78,0,0,1,.16.24.68.68,0,0,1,.06.29V1.5h3Zm-1.5,0H1.5v8.63a.38.38,0,0,0,.11.26.39.39,0,0,0,.27.11h6a.38.38,0,0,0,.37-.37Zm-4.5,7.5H3v-6h.75Zm0-8.25H6V.75H3.75Zm1.5,8.25H4.5v-6h.75Zm1.5,0H6v-6h.75Z"})))])}o.defaultProps={viewBox:"0 0 9.75 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1576:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M12,2a1.93,1.93,0,0,1-.15.75,1.87,1.87,0,0,1-.42.65L3.71,11.07,0,12,.93,8.29,8.64.57A1.87,1.87,0,0,1,9.29.15,1.93,1.93,0,0,1,10,0a1.79,1.79,0,0,1,.76.16,1.79,1.79,0,0,1,.62.42,1.79,1.79,0,0,1,.42.62A1.79,1.79,0,0,1,12,2ZM1,11,3,10.49A1.84,1.84,0,0,0,2.77,10a2.29,2.29,0,0,0-.32-.43A2.29,2.29,0,0,0,2,9.23,1.84,1.84,0,0,0,1.51,9Zm.88-2.6a2.64,2.64,0,0,1,1.72,1.72L10,3.75,8.25,2ZM10.5,3.22l.28-.28A2,2,0,0,0,11,2.67a1.34,1.34,0,0,0,.17-.31A1.14,1.14,0,0,0,11.25,2a1,1,0,0,0-.1-.47A1.2,1.2,0,0,0,10.5.85,1,1,0,0,0,10,.75a1.14,1.14,0,0,0-.39.06A1.34,1.34,0,0,0,9.33,1a2,2,0,0,0-.27.24l-.28.28Z"})))])}o.defaultProps={viewBox:"0 0 12 12",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1577:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M0,5,.53,4.5,3.64,7.61,11.25,0l.53.53L3.64,8.67Z"})))])}o.defaultProps={viewBox:"0 0 10 10",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1578:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 m 1547 -256 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -73 -31 q -38 -14 -80 -22 l 75 -75 z",key:0}),r.createElement("path",{className:"reopenThreadIconShading",fillOpacity:"1.000",d:"M 1073 1344 h -203 l -422 422 v -422 h -256 v -561 l 384 385 l 195 -196 l -25 46 m 1110 -826 v 1152 h -723 l 105 -160 q 52 -79 79 -168 q 27 -90 27 -184 q 0 -115 -39 -220 q -40 -105 -109 -188 q -69 -84 -164 -141 q -95 -58 -206 -80 l 11 -11 z",key:1}),r.createElement("path",{className:"reopenThreadIconArrow",fillOpacity:"1.000",d:"M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -689 l 128 128 v 433 h 256 v 331 l 331 -331 h 949 v -1024 h -813 q -36 -17 -74 -31 q -38 -14 -79 -22 l 75 -75 z",key:2}),r.createElement("path",{className:"reopenThreadIconBubble",fillOpacity:"1.000",d:"M 737 384 q 87 6 163 44 q 75 37 132 98 q 56 60 88 139 q 32 79 32 167 q 0 69 -19 131 q -20 61 -55 115 l -94 -94 q 19 -35 30 -72 q 10 -38 10 -80 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -331 l 294 293 l -91 91 l -448 -448 l 448 -448 l 91 91 l -294 293 z",key:3})])}o.defaultProps={width:"14",height:"14",viewBox:"200,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1579:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("path",{className:"cls-1",d:"M7.5 0C8.19271 0 8.85677 0.0885417 9.49219 0.265625C10.1328 0.442708 10.7318 0.695312 11.2891 1.02344C11.8464 1.34635 12.3516 1.73698 12.8047 2.19531C13.263 2.64844 13.6536 3.15365 13.9766 3.71094C14.3047 4.26823 14.5573 4.86719 14.7344 5.50781C14.9115 6.14323 15 6.80729 15 7.5C15 8.19271 14.9115 8.85938 14.7344 9.5C14.5573 10.1354 14.3047 10.7318 13.9766 11.2891C13.6536 11.8464 13.263 12.3542 12.8047 12.8125C12.3516 13.2656 11.8464 13.6562 11.2891 13.9844C10.7318 14.3073 10.1328 14.5573 9.49219 14.7344C8.85677 14.9115 8.19271 15 7.5 15C6.80729 15 6.14062 14.9115 5.5 14.7344C4.86458 14.5573 4.26823 14.3073 3.71094 13.9844C3.15365 13.6562 2.64583 13.2656 2.1875 12.8125C1.73438 12.3542 1.34375 11.8464 1.01562 11.2891C0.692708 10.7318 0.442708 10.1354 0.265625 9.5C0.0885417 8.85938 0 8.19271 0 7.5C0 6.80729 0.0885417 6.14323 0.265625 5.50781C0.442708 4.86719 0.692708 4.26823 1.01562 3.71094C1.34375 3.15365 1.73438 2.64844 2.1875 2.19531C2.64583 1.73698 3.15365 1.34635 3.71094 1.02344C4.26823 0.695312 4.86458 0.442708 5.5 0.265625C6.14062 0.0885417 6.80729 0 7.5 0ZM7.5 14C8.09375 14 8.66667 13.9219 9.21875 13.7656C9.77604 13.6094 10.2943 13.3906 10.7734 13.1094C11.2578 12.8281 11.6979 12.4896 12.0938 12.0938C12.4896 11.6979 12.8281 11.2604 13.1094 10.7812C13.3906 10.2969 13.6094 9.77865 13.7656 9.22656C13.9219 8.67448 14 8.09896 14 7.5C14 6.90625 13.9219 6.33333 13.7656 5.78125C13.6094 5.22396 13.3906 4.70573 13.1094 4.22656C12.8281 3.74219 12.4896 3.30208 12.0938 2.90625C11.6979 2.51042 11.2578 2.17188 10.7734 1.89062C10.2943 1.60938 9.77604 1.39062 9.21875 1.23438C8.66667 1.07812 8.09375 1 7.5 1C6.90104 1 6.32552 1.07812 5.77344 1.23438C5.22135 1.39062 4.70312 1.60938 4.21875 1.89062C3.73958 2.17188 3.30208 2.51042 2.90625 2.90625C2.51042 3.30208 2.17188 3.74219 1.89062 4.22656C1.60938 4.70573 1.39062 5.22396 1.23438 5.78125C1.07812 6.33333 1 6.90625 1 7.5C1 8.09375 1.07812 8.66927 1.23438 9.22656C1.39062 9.77865 1.60938 10.2969 1.89062 10.7812C2.17188 11.2604 2.51042 11.6979 2.90625 12.0938C3.30208 12.4896 3.73958 12.8281 4.21875 13.1094C4.70312 13.3906 5.22135 13.6094 5.77344 13.7656C6.32552 13.9219 6.90104 14 7.5 14ZM7 4H8V9H7V4ZM7 10H8V11H7V10Z",fill:"#252423",key:1})])}o.defaultProps={width:"15",height:"15",viewBox:"0 0 15 15",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1580:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(0.000000, 0.648438)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Reassign",points:"7.52636719 0 13.9589844 6.43261719 7.52636719 12.8652344 6.91113281 12.25 12.2910156 6.87011719 0 6.87011719 0 5.99511719 12.2910156 5.99511719 6.91113281 0.615234375"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 14 14",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1581:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-32.000000, -2.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Resolve",points:"42.5673828 2.625 43.1826172 3.24023438 35.875 10.5546875 32.0673828 6.74023438 32.6826172 6.125 35.875 9.31054688"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 9",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1582:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-62.000000, -26.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("polygon",{id:"Cancel",points:"73.5888672 27.0839844 68.8720703 31.8076172 73.5888672 36.53125 72.9736328 37.1464844 68.25 32.4296875 63.5263672 37.1464844 62.9111328 36.53125 67.6279297 31.8076172 62.9111328 27.0839844 63.5263672 26.46875 68.25 31.1855469 72.9736328 26.46875"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 12 11",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1583:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"Ex:-Tasks",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("g",{id:"Group",transform:"translate(-30.000000, -24.351562)",fill:"currentColor",fillRule:"nonzero"},r.createElement("path",{d:"M44.625,27.0976562 C44.625,27.398439 44.5680344,27.6901028 44.4541016,27.9726562 C44.3401687,28.2552097 44.1738292,28.5058583 43.9550781,28.7246094 L34.9521484,37.7275391 L30.625,38.8076172 L31.7050781,34.4804688 L40.7080078,25.4775391 C40.9267589,25.258788 41.1774074,25.0924485 41.4599609,24.9785156 C41.7425144,24.8645828 42.0341782,24.8076172 42.3349609,24.8076172 C42.6494156,24.8076172 42.9456366,24.8680007 43.2236328,24.9887695 C43.501629,25.1095384 43.7443023,25.2735992 43.9516602,25.480957 C44.159018,25.6883148 44.3230788,25.9309882 44.4438477,26.2089844 C44.5646165,26.4869806 44.625,26.7832016 44.625,27.0976562 Z M32.8535156,34.5693359 C33.336591,34.7288419 33.7524397,34.9829084 34.1010742,35.331543 C34.4497088,35.6801775 34.7037752,36.0960262 34.8632812,36.5791016 L42.2529297,29.1826172 L40.25,27.1796875 L32.8535156,34.5693359 Z M31.828125,37.6044922 L34.0771484,37.0439453 C34.0315753,36.8343088 33.95752,36.6360686 33.8549805,36.4492188 C33.7524409,36.2623689 33.6282559,36.0960294 33.4824219,35.9501953 C33.3365878,35.8043612 33.1702483,35.6801763 32.9833984,35.5776367 C32.7965485,35.4750971 32.5983083,35.4010419 32.3886719,35.3554688 L31.828125,37.6044922 Z M42.875,28.5605469 C42.9889329,28.446614 43.0983068,28.3395187 43.203125,28.2392578 C43.3079432,28.1389969 43.4013668,28.0330409 43.4833984,27.9213867 C43.5654301,27.8097325 43.6303709,27.6889655 43.6782227,27.559082 C43.7260745,27.4291986 43.75,27.2776701 43.75,27.1044922 C43.75,26.9085277 43.7124027,26.7250985 43.637207,26.5541992 C43.5620113,26.3832999 43.4594733,26.2329108 43.3295898,26.1030273 C43.1997064,25.9731439 43.0493173,25.8706058 42.878418,25.7954102 C42.7075187,25.7202145 42.5240895,25.6826172 42.328125,25.6826172 C42.1549471,25.6826172 42.0034186,25.7065427 41.8735352,25.7543945 C41.7436517,25.8022463 41.6228847,25.8671871 41.5112305,25.9492188 C41.3995763,26.0312504 41.2936203,26.124674 41.1933594,26.2294922 C41.0930985,26.3343104 40.9860032,26.4436843 40.8720703,26.5576172 L42.875,28.5605469 Z",id:"Edit"}))))}o.defaultProps={height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",x:"0",y:"0",viewBox:"0 0 15 15",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1584:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("path",{d:"M1 4L3.5 6.5L9 1"}))}o.defaultProps={viewBox:"0 0 10 8",focusable:"false",fill:"none",fillOpacity:"0.0"},e.exports=o,o.default=o},1585:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:0}),r.createElement("path",{fill:"currentColor",fillOpacity:"1.000",d:"M 939 1571 l -829 -828 l 121 -121 l 708 708 l 707 -708 l 121 121 z",key:1})])}o.defaultProps={width:"12",height:"12",viewBox:"0,0,2048,2048",focusable:"false"},e.exports=o,o.default=o},1586:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,r.createElement("g",{id:"***-Symbols",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.createElement("path",{d:"M14.5,5 C14.703126,5 14.8958324,5.03906211 15.078125,5.1171875 C15.2604176,5.19531289 15.4205722,5.30208266 15.5585938,5.4375 C15.6966153,5.57291734 15.8046871,5.73176992 15.8828125,5.9140625 C15.9609379,6.09635508 16,6.29166562 16,6.5 C16,6.6666675 15.9739586,6.82552008 15.921875,6.9765625 L13.921875,12.9765625 C13.8697914,13.1276049 13.7968755,13.2669264 13.703125,13.3945312 C13.6093745,13.5221361 13.5,13.6302079 13.375,13.71875 C13.2499994,13.8072921 13.113282,13.8763018 12.9648438,13.9257812 C12.8164055,13.9752607 12.6614591,14 12.5,14 L8.5,14 C7.56770367,14 6.66927516,13.8203143 5.8046875,13.4609375 C5.42968563,13.3098951 5.0533873,13.1953129 4.67578125,13.1171875 C4.2981752,13.0390621 3.90625203,13 3.5,13 L0,13 L0,6 L3.2578125,6 C3.59635586,6 3.91536309,5.93750062 4.21484375,5.8125 C4.51432441,5.68749938 4.78385297,5.50520953 5.0234375,5.265625 L9.8828125,0.4140625 C10.0130215,0.283853516 10.1432285,0.182292031 10.2734375,0.109375 C10.4036465,0.0364579688 10.5624991,0 10.75,0 C10.9218759,0 11.0833326,0.0325517578 11.234375,0.09765625 C11.3854174,0.162760742 11.5182286,0.252603594 11.6328125,0.3671875 C11.7473964,0.481771406 11.8372393,0.614582578 11.9023438,0.765625 C11.9674482,0.916667422 12,1.07812414 12,1.25 C12,1.67187711 11.9531255,2.07421684 11.859375,2.45703125 C11.7656245,2.83984566 11.6276051,3.21874813 11.4453125,3.59375 C11.3411453,3.81770945 11.2526045,4.04557176 11.1796875,4.27734375 C11.1067705,4.50911574 11.0572918,4.74999875 11.03125,5 L14.5,5 Z M1,12 L3.5,12 C3.9734466,12 4.4332293,12.0458255 4.87838685,12.1379271 C5.31513303,12.2282884 5.74859274,12.3602761 6.18851278,12.5375318 C6.93158683,12.8463999 7.69958736,13 8.5,13 L12.5,13 C12.5548236,13 12.602973,12.9923123 12.648616,12.977098 C12.7042395,12.9585568 12.7526835,12.9341041 12.7969807,12.9027269 C12.8337665,12.8766702 12.8664285,12.8443971 12.8972432,12.8024548 C12.9312256,12.7562009 12.9571761,12.7066171 12.9731917,12.6603347 L14.976502,6.65057182 C14.9920216,6.60556505 15,6.55689677 15,6.5 C15,6.42541757 14.9877526,6.36418032 14.9636675,6.3079818 C14.9365874,6.244795 14.9025618,6.19478151 14.8582531,6.15130876 C14.8093393,6.10331783 14.7532414,6.06591924 14.6842057,6.03633253 C14.6271661,6.01188698 14.5685237,6 14.5,6 L9.92167262,6 L10.0366316,4.89639392 C10.0695629,4.58025353 10.1325645,4.27353503 10.2257814,3.97723847 C10.311817,3.70376821 10.4161404,3.43528887 10.5459446,3.15655729 C10.6976958,2.8443835 10.8114223,2.53217213 10.8880777,2.21916252 C10.9624237,1.91558304 11,1.59305299 11,1.25 C11,1.21274116 10.9946165,1.18603901 10.9840197,1.16145435 C10.9688056,1.12615764 10.9504819,1.09907042 10.9257057,1.07429428 C10.9009296,1.04951814 10.8738424,1.03119444 10.8385457,1.01598034 C10.813961,1.0053835 10.7872588,1 10.75,1 C10.7324276,1 10.7311357,0.999063781 10.7416579,0.993076126 L10.7490693,0.989479263 C10.7056707,1.01597571 10.651885,1.05920353 10.5893502,1.12173792 L5.73054428,5.97273178 C5.3997463,6.30352976 5.02122029,6.55953769 4.60002886,6.73533933 C4.17716132,6.91184057 3.72718088,7 3.2578125,7 L1,7 L1,12 Z",fill:"#2B5C9C",fillRule:"nonzero"})))}o.defaultProps={width:"16px",height:"16px",viewBox:"0 0 16 16",focusable:"false",version:"1.1"},e.exports=o,o.default=o},1587:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("path",{d:"M1.08001 9.31998L1.28001 8.63998H4.28001C4.60001 8.13998 4.96001 7.59998 5.36001 7.03998C6.16001 5.91998 6.72001 5.21998 7.06001 4.93998C7.96001 4.23998 8.52001 3.77998 8.76001 3.57998C9.66001 2.77998 10.16 2.17998 10.24 1.75998C10.32 1.31998 10.46 0.999976 10.64 0.799976C10.76 0.659976 10.9 0.599976 11.04 0.599976C11.3 0.599976 11.56 0.779976 11.8 1.11998C12.16 1.59998 12.16 2.27998 11.82 3.11998C11.6 3.65998 11.38 4.09998 11.16 4.43998C10.86 4.87998 10.68 5.15998 10.62 5.29998C10.44 5.65998 10.36 6.05998 10.42 6.47998C11.08 6.51998 11.76 6.61998 12.42 6.79998C13.76 7.13998 14.42 7.67998 14.42 8.37998C14.42 8.59998 14.38 8.77998 14.32 8.97998C14.24 9.17998 14.14 9.25998 14.04 9.25998L14.34 9.47998C14.54 9.71998 14.64 10.04 14.64 10.44C14.64 10.66 14.54 10.84 14.34 11.02C14.24 11.1 14.14 11.18 14.04 11.22L14.2 11.52C14.3 11.78 14.3 12.08 14.22 12.42C14.18 12.62 14.06 12.8 13.86 12.98C13.68 13.14 13.54 13.2 13.42 13.2V13.94C13.36 14.46 13.16 14.82 12.82 14.98C12.1 15.34 11.7 15.52 11.62 15.56C11.06 15.72 10.26 15.76 9.22001 15.68C8.22001 15.6 7.12001 15.42 5.92001 15.16C5.32001 15.02 4.82001 14.9 4.42001 14.78H1.42001C1.32001 14.54 1.22001 14.24 1.12001 13.86C0.920014 13.12 0.820015 12.42 0.820015 11.76C0.880015 10.78 0.960014 9.97998 1.08001 9.31998Z",fill:"#FDCE4C",key:0}),r.createElement("path",{d:"M9.78002 9.59995C10.04 9.65995 10.2 10.0399 10.22 10.7599C10.24 11.3599 10.2 11.9799 10.06 12.5799C10.02 12.8199 10.02 13.2999 10.06 14.0199C10.08 14.4599 9.98002 14.6599 9.76002 14.6199C9.44002 14.5399 9.10002 14.2399 8.78002 13.6799C8.42002 13.0999 8.30002 12.5799 8.40002 12.0999C8.54002 11.4799 8.72002 10.9199 8.96002 10.4199C9.24002 9.83995 9.52002 9.55995 9.78002 9.59995Z",fill:"url(#paint0_linear)",key:1}),r.createElement("path",{d:"M10.34 8.84C10.5 8.58 10.4 8.86 10.06 9.72C9.69999 10.58 9.09999 11.08 8.23999 11.22C7.37999 11.38 6.71999 11.38 6.27999 11.22C7.43999 11 8.29999 10.56 8.79999 9.92C9.31999 9.28 9.59999 8.62 9.63999 7.94C9.93999 8.8 10.18 9.1 10.34 8.84Z",fill:"url(#paint1_linear)",key:2}),r.createElement("path",{d:"M11 8.89995C11.12 9.07995 11.28 9.21995 11.48 9.31995C10.98 9.69995 10.8 10.1599 10.94 10.6999C11 10.9599 11.12 11.1999 11.3 11.3799C10.76 11.7799 10.54 12.2199 10.66 12.6799C10.72 12.9199 10.82 13.0999 10.98 13.2599C10.68 13.5399 10.54 13.9799 10.54 14.5999C10.54 14.8999 10.58 15.1799 10.64 15.4199C10.08 15.2199 9.75998 14.7999 9.67998 14.1599L9.71998 13.2599C9.41998 12.8599 9.33998 12.3999 9.49998 11.8999L9.79998 11.2799C9.43998 10.9999 9.33998 10.5999 9.45998 10.0399L9.73998 9.29995C9.61998 8.85995 9.81998 8.47995 10.36 8.17995C10.64 8.01995 10.92 7.89995 11.22 7.81995C10.84 8.19995 10.76 8.55995 11 8.89995Z",fill:"#FDCE4C",key:3}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.619 13.18C13.619 13.0701 13.5299 12.981 13.42 12.981H9.82C9.71008 12.981 9.62098 13.0701 9.62098 13.18C9.62098 13.2899 9.71008 13.379 9.82 13.379H13.42C13.5299 13.379 13.619 13.2899 13.619 13.18Z",fill:"#AC8662",key:4}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 11.22C14.239 11.11 14.1499 11.0209 14.04 11.0209H9.83999C9.73008 11.0209 9.64097 11.11 9.64097 11.22C9.64097 11.3299 9.73008 11.419 9.83999 11.419H14.04C14.1499 11.419 14.239 11.3299 14.239 11.22Z",fill:"#AC8662",key:5}),r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.239 9.23997C14.239 9.13006 14.1499 9.04095 14.04 9.04095H9.83999C9.73008 9.04095 9.64097 9.13006 9.64097 9.23997C9.64097 9.34989 9.73008 9.43899 9.83999 9.43899H14.04C14.1499 9.43899 14.239 9.34989 14.239 9.23997Z",fill:"#AC8662",key:6}),r.createElement("defs",{key:7},[r.createElement("linearGradient",{x1:"8.14689",y1:"8.32298",x2:"11.0687",y2:"8.28505",gradientUnits:"userSpaceOnUse",key:0},[r.createElement("stop",{stopColor:"#B8895A",stopOpacity:"0.2",key:0}),r.createElement("stop",{offset:"1",stopColor:"#B57E4A",key:1})]),r.createElement("linearGradient",{x1:"4.86538",y1:"9.62116",x2:"7.60127",y2:"8.17258",gradientUnits:"userSpaceOnUse",key:1},[r.createElement("stop",{stopColor:"#F0C194",stopOpacity:"0.4",key:0}),r.createElement("stop",{offset:"1",stopColor:"#CBA37C",stopOpacity:"0.502",key:1})])])])}o.defaultProps={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e.exports=o,o.default=o},1588:function(e,t,n){var r=n(0);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".cls-1{fill:currentColor;}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{className:"cls-1",d:"M 2048 1216 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -512 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 64 v 128 h -64 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 512 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -64 v -128 h 64 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 m -640 -384 q 0 93 -35 175 q -36 81 -96 142 q -61 60 -142 96 q -82 35 -175 35 h -64 v -128 h 64 q 66 0 124 -25 q 58 -25 102 -68 q 43 -44 69 -102 q 25 -59 25 -125 q 0 -66 -25 -124 q -26 -58 -69 -101 q -44 -44 -102 -69 q -58 -26 -124 -26 h -512 q -66 0 -124 26 q -59 25 -102 69 q -44 43 -69 101 q -25 58 -25 124 q 0 66 25 125 q 25 58 69 102 q 43 43 102 68 q 58 25 124 25 h 64 v 128 h -64 q -93 0 -174 -35 q -82 -36 -142 -96 q -61 -61 -96 -142 q -36 -82 -36 -175 q 0 -93 36 -174 q 35 -82 96 -142 q 60 -61 142 -96 q 81 -36 174 -36 h 512 q 93 0 175 36 q 81 35 142 96 q 60 60 96 142 q 35 81 35 174 z"})))])}o.defaultProps={width:"100%",height:"100%",viewBox:"0,0,2048,2048",overflow:"visible",focusable:"false"},e.exports=o,o.default=o},1589:function(e){e.exports={SharedCommentsVersion:"3.29.4"}},1590:function(e,t,n){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r="function"==typeof Symbol&&Symbol.for,o=r?Symbol.for("react.element"):60103,a=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,d=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,m=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,C=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,h=r?Symbol.for("react.lazy"):60116,b=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,y=r?Symbol.for("react.responder"):60118,T=r?Symbol.for("react.scope"):60119;function O(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case l:case m:case i:case c:case s:case p:return e;default:switch(e=e&&e.$$typeof){case u:case f:case h:case g:case d:return e;default:return t}}case a:return t}}}function I(e){return O(e)===m}t.AsyncMode=l,t.ConcurrentMode=m,t.ContextConsumer=u,t.ContextProvider=d,t.Element=o,t.ForwardRef=f,t.Fragment=i,t.Lazy=h,t.Memo=g,t.Portal=a,t.Profiler=c,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return I(e)||O(e)===l},t.isConcurrentMode=I,t.isContextConsumer=function(e){return O(e)===u},t.isContextProvider=function(e){return O(e)===d},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return O(e)===f},t.isFragment=function(e){return O(e)===i},t.isLazy=function(e){return O(e)===h},t.isMemo=function(e){return O(e)===g},t.isPortal=function(e){return O(e)===a},t.isProfiler=function(e){return O(e)===c},t.isStrictMode=function(e){return O(e)===s},t.isSuspense=function(e){return O(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===m||e===c||e===s||e===p||e===C||"object"==typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===g||e.$$typeof===d||e.$$typeof===u||e.$$typeof===f||e.$$typeof===v||e.$$typeof===y||e.$$typeof===T||e.$$typeof===b)},t.typeOf=O},16:function(e,t,n){"use strict";var r=n(1),o=n(7);function a(e,t){var n=e.filter(t);return n.length===e.length?e:n}var i=n(5),s=n(129),c=n(239),d=n(405),u=n(399),l=n(164),m=n(87),f=n(109),p=n(188),C=n(23),g=n(625),h=n(77),b=n(96),v=n(127),y=n(390),T=n(51),O=n(119),I=n(17),S=n(114),_=n(176),D=n(46),E=n(146),j=n(263),P=n(53),x=n(202),A=n(382),k=n(486);n.d(t,"P",(function(){return R})),n.d(t,"N",(function(){return w})),n.d(t,"e",(function(){return N})),n.d(t,"x",(function(){return M})),n.d(t,"l",(function(){return F})),n.d(t,"s",(function(){return L})),n.d(t,"n",(function(){return V})),n.d(t,"g",(function(){return B})),n.d(t,"U",(function(){return H})),n.d(t,"k",(function(){return U})),n.d(t,"j",(function(){return G})),n.d(t,"L",(function(){return W})),n.d(t,"u",(function(){return q})),n.d(t,"w",(function(){return z})),n.d(t,"v",(function(){return Y})),n.d(t,"T",(function(){return K})),n.d(t,"a",(function(){return X})),n.d(t,"W",(function(){return J})),n.d(t,"R",(function(){return Q})),n.d(t,"X",(function(){return Z})),n.d(t,"m",(function(){return $})),n.d(t,"z",(function(){return ee})),n.d(t,"B",(function(){return ne})),n.d(t,"D",(function(){return re})),n.d(t,"C",(function(){return oe})),n.d(t,"fb",(function(){return ae})),n.d(t,"O",(function(){return se})),n.d(t,"E",(function(){return ce})),n.d(t,"bb",(function(){return de})),n.d(t,"o",(function(){return ue})),n.d(t,"p",(function(){return le})),n.d(t,"A",(function(){return me})),n.d(t,"F",(function(){return fe})),n.d(t,"b",(function(){return pe})),n.d(t,"K",(function(){return ge})),n.d(t,"t",(function(){return he})),n.d(t,"Y",(function(){return ye})),n.d(t,"db",(function(){return Te})),n.d(t,"eb",(function(){return Oe})),n.d(t,"cb",(function(){return Ie})),n.d(t,"G",(function(){return Se})),n.d(t,"H",(function(){return De})),n.d(t,"I",(function(){return Ee})),n.d(t,"J",(function(){return je})),n.d(t,"Z",(function(){return Pe})),n.d(t,"V",(function(){return xe})),n.d(t,"ab",(function(){return Ae})),n.d(t,"S",(function(){return ke})),n.d(t,"i",(function(){return Re})),n.d(t,"c",(function(){return we})),n.d(t,"M",(function(){return Ne})),n.d(t,"y",(function(){return Me})),n.d(t,"Q",(function(){return Fe})),n.d(t,"h",(function(){return Le})),n.d(t,"d",(function(){return Ve})),n.d(t,"f",(function(){return Be})),n.d(t,"r",(function(){return He})),n.d(t,"q",(function(){return Ue}));function R(e){return""===e||null===e?void 0:e}function w(e){return e.state===E.a.Placeholder||e.state===E.a.Loading}function N(e){return{commentId:e,commentBody:Object(y.b)(),author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function M(e,t,n){for(var r={},o=0;o<e.length;++o)r[e[o].commentId]=F(I.gb()&&t.includes(Object(m.b)(e[o]))?V(e[o].date,e[o].displayDate,n.dataCulture):e[o].displayDate);return r}function F(e){return{displayDate:e,displayingErrorUI:!1,pending:j.a.None}}function L(e){return{displayDate:e}}function V(e,t,n){return t||(!e||isNaN(e.getDate())?"":g.a(e,n))}function B(e,t,n,o){for(var a,s=void 0,c=!1,d=0;d<n.length;d++)if(Object(m.b)(n[d])===e){c=!0,Object(i.i)().assertConditionTag(!!t[n[d].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=null!==(a=t[n[d].commentId])&&void 0!==a?a:F(void 0);u.displayDate||(s||(s=Object(r.__assign)({},t)),s[n[d].commentId]=Object(r.__assign)(Object(r.__assign)({},u),{displayDate:V(n[d].date,n[d].displayDate,o.dataCulture)}))}else if(c)break;return s}function H(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function U(e,t){for(var n={},r=0;r<e.length;++r)""===e[r].parentId&&(n[e[r].commentId]=G(void 0,t));return n}function G(e,t){return q(e,t===E.a.Loading||t===E.a.Placeholder?{state:t,initialItemCount:1}:{state:null!=t?t:E.a.Loaded})}function W(e){var t,n,o={};try{for(var a=Object(r.__values)(e),i=a.next();!i.done;i=a.next()){var s=i.value;o[s.threadId]=q(void 0,{state:E.a.Placeholder,initialItemCount:s.itemCount})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}function q(e,t){return{loadState:null!=t?t:{state:E.a.Loaded},pending:_.a.None,alternateId:e}}function z(e){var t={};return t[e]={pending:j.a.Post,displayDate:void 0,displayingErrorUI:!1},t}function Y(e){var t={};return t[e]={pending:_.a.Card,loadState:{state:E.a.Loaded},alternateId:e},t}function K(e,t){var n=Object(r.__assign)({},e);return t.forEach((function(e){return delete n[e]})),n}function X(e,t,n){var r=Q(e,t,n);if(!t||r.includes(t.selectedCardId))return r;var o=je(n);return o&&o.threadId===t.selectedCardId?[o.threadId]:o&&r.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function J(e,t,n,r){if(!t.includes(e))return t;var o=je(n);return o&&o.threadId===e?t:r&&Object(P.j)(r.selectionDetails)?(Object(i.i)().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function Q(e,t,n){var r=je(n);return a(e,(function(e){return e===(null==t?void 0:t.selectedCardId)||e===(null==r?void 0:r.threadId)}))}function Z(e,t,n){var r=je(n);return a(e,(function(e){return t[e]||e===(null==r?void 0:r.threadId)}))}function $(e){return{selectedCardId:e,selectionDetails:{lowFidelityWarningType:void 0}}}function ee(e,t){var n;if(I.db()){var r=e.draftState.postIdToDraftIdMap[t];if(!r)return e.selectedComment;var a=e.draftState.drafts[r];if(!a.isInCurrentContext)return(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)===a.threadId?void 0:e.selectedComment}var i=e.commentData.find((function(e){return e.commentId===t}));if(!i)throw new T.a(O.i,o.d.reserveTag(589103587),-2130957563);return $(Object(m.b)(i))}function te(e,t){return{selectedCardId:e,selectionDetails:{selectedPostId:t,lowFidelityWarningType:void 0}}}function ne(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return $(t.sessionConfiguration.draftId);case"EDIT":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n)return te(Object(m.b)(n),t);throw new T.a(O.d,o.d.reserveTag(589103616),-2130957556)}(e,t.sessionConfiguration.commentId);case"REPLY":return function(e,t){var n=e.find((function(e){return e.commentId===t}));if(n&&""===n.parentId)return $(t);throw new T.a(O.d,o.d.reserveTag(589103617),-2130957556)}(e,t.sessionConfiguration.threadId);default:throw new T.a(O.c,o.d.reserveTag(589103618),-2130957532)}}function re(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return $(e.threadId);case"EDIT":return te(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new T.a(O.c,o.d.reserveTag(577610274),-2130957532)}}function oe(e,t,n){return(null==t?void 0:t.selectedCardId)===e&&Object(P.j)(t.selectionDetails)&&!Object(D.l)(n)?$(e):t}function ae(e,t){var n=t.payload;return{selectedCardId:n.selectedCard,selectionDetails:ie(e,n)}}function ie(e,t){return t.selectType===S.a.SelectPost?e&&Object(P.j)(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0}:{lowFidelityWarningType:e&&!Object(P.j)(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0}}function se(e){return e===Object(h.x)()}function ce(e,t,n){var r,o=t.payload.params;return Object(l.f)(o)?$(n):Object(l.e)(o)?{selectedCardId:n,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:I.D()?$(null!==(r=null==e?void 0:e.selectedCardId)&&void 0!==r?r:n):$(Object(h.x)())}function de(e,t,n){if("CLEAR_COMMENT_SELECTION"===n.type)return!!t&&!Object(D.l)(e);if(!t)return!0;if(Object(D.l)(e))return n.payload.selectedCard===t.selectedCardId&&!Object(P.j)(t.selectionDetails)&&n.payload.selectType===S.a.ExpandCard;if(n.payload.selectedCard===t.selectedCardId)switch(n.payload.selectType){case S.a.SelectCard:return Object(P.j)(t.selectionDetails);case S.a.Polite:return!1;case S.a.SelectPost:case S.a.ExpandCard:return!0;default:Object(o.m)(n.payload)}return!0}function ue(e){var t={};return e.commentId&&(t[e.commentId]={pending:_.a.None,loadState:{state:E.a.Loaded},alternateId:e.commentId}),t}function le(e){var t={};return e.commentId&&(t[e.commentId]={pending:j.a.None,displayDate:void 0,displayingErrorUI:!1}),t}function me(e,t){return e&&e.selectedCardId===t.payload.commentId?$(t.payload.commentId):e}function fe(e,t,n){if(e.pendingDraft&&"CREATE"===e.pendingDraft.sessionType)return Object(h.x)();if(e.committedLieId)return e.committedLieId;var r=je(e);return!r||"CREATE"!==r.commentDraft.sessionConfiguration.sessionType||t&&!r.isInCurrentContext||n&&r.renderContextType!==n&&r.renderContextType!==C.a.None?void 0:r.commentDraft.sessionConfiguration.draftId}function pe(e,t,n,o){if(!fe(o,!0))return e;var a=fe(o);if(e&&a&&n[a]&&n[a].pending===_.a.None){var i=Object(r.__assign)({},e),s=t.length;if(i.index>=s)i.index=s;else if(i.index>=0&&t[i.index].parentId){var c=new u.a(t,i.index);c.next().done?i.index=s:i.index=c.currentIndex()}return i}}function Ce(e,t,n){if(!t)return-1;var r=n?t.selectedCardId:Object(P.b)(t);return e.findIndex((function(e){return e.commentId===r}))}function ge(e,t){return Ce(e,t,!0)}function he(e,t){return Ce(e,t,!1)}function be(e,t){var n=Object(r.__assign)({},e);return n[t]&&delete n[t],n}function ve(e,t){if(void 0===t)return Object(i.i)().assertConditionTag(0===Object.keys(e).length,"Invalid number of drafts.",593762516),e;Object(i.i)().assertConditionTag(1===Object.keys(e).length,"Invalid number of drafts.",593762517),Object(i.i)().assertConditionTag(!!e[t.sessionConfiguration.draftId],"Draft is not in map",593762518);var n=Object(r.__assign)({},e);return delete n[t.sessionConfiguration.draftId],n}function ye(e){return Object(A.a)(e)===p.a.CanAutoDiscard?Object(D.h)():e}function Te(e,t,n,r,a,i,s){var c,d;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(!t[c=e.pendingDraft.threadId])return e;break;case"EDIT":if(!r[d=e.pendingDraft.commentId])return e;break;default:return e}else{var u=je(e);if(!u||!u.isInCurrentContext)return e;switch(u.commentDraft.sessionConfiguration.sessionType){case"REPLY":c=u.threadId;break;case"EDIT":d=u.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(c&&!n[c]){var l=xe(e,c);return I.Q()?Object(x.c)(e,l,3,i,o.d.reserveTag(539297118)):Object(x.d)(e,l,3,s),l}if(d&&!a[d]){l=Ae(e,d);return I.Q()?Object(x.c)(e,l,2,i,o.d.reserveTag(539297119)):Object(x.d)(e,l,2,s),l}return e}function Oe(e,t){var n=Object(r.__assign)({},e.drafts),o=!1;return Object.keys(n).forEach((function(e){var a=t(e);a!==n[e].renderContextType&&(n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{renderContextType:a}),o=!0)})),o?Object(r.__assign)(Object(r.__assign)({},e),{drafts:n}):e}function Ie(e,t){if(t===f.a.Closed){if(Object(v.b)(e))return C.a.None}else if(e===C.a.DiscreteIntegrated)return C.a.FullPane;return e}function Se(e){var t=je(e);return t?t.commentDraft:void 0}function _e(e){var t=Object.keys(e);if(t.length>1)throw Object(i.i)().assertConditionTag(!1,"Invalid number of drafts.",593762519),new T.a("Only a single draft is supported at this time.",o.d.reserveTag(589103619),-2130957551);if(0!==t.length)return t[0]}function De(e){return _e(e.cardIdToDraftIdMap)}function Ee(e){return _e(e.postIdToDraftIdMap)}function je(e){var t=e.drafts,n=_e(t);return n?t[n]:void 0}function Pe(e){var t,n,a=e.drafts,s=Object.keys(a).filter((function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.isInCurrentContext})).map((function(e){return a[e]}));if(0===s.length)return e;var c=Object(r.__assign)({},e);try{for(var d=Object(r.__values)(s),u=d.next();!u.done;u=d.next()){var l=u.value;switch(l.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":Object(i.i)().assertConditionTag("METADATA"!==l.commentDraft.sessionConfiguration.sessionType,"Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),c=xe(c,l.threadId);break;case"EDIT":c=Ae(c,l.commentDraft.sessionConfiguration.commentId);break;default:Object(o.m)(l.commentDraft.sessionConfiguration)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return c}function xe(e,t){var n,o=e.pendingDraft&&Object(l.f)(e.pendingDraft)&&e.pendingDraft.threadId===t,a=e.cardIdToDraftIdMap[t];return a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:ve(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),cardIdToDraftIdMap:be(e.cardIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function Ae(e,t){var n,o=e.pendingDraft&&Object(l.e)(e.pendingDraft)&&e.pendingDraft.commentId===t,a=e.postIdToDraftIdMap[t];return a?Object(r.__assign)(Object(r.__assign)({},e),{drafts:ve(e.drafts,null===(n=e.drafts[a])||void 0===n?void 0:n.commentDraft),postIdToDraftIdMap:be(e.postIdToDraftIdMap,t),pendingDraft:o?void 0:e.pendingDraft}):o?Object(r.__assign)(Object(r.__assign)({},e),{pendingDraft:void 0}):e}function ke(e,t,n){var o=xe(e,t),a=Ee(o);if(a){var i=o.postIdToDraftIdMap[a],s=o.drafts[i];s&&s.threadId===t&&(o=Ae(o,a))}if(o.pendingDraft&&Object(l.e)(o.pendingDraft)){var c=o.pendingDraft.commentId,d=n.find((function(e){return e.commentId===c}));d&&Object(m.b)(d)===t&&(o=Object(r.__assign)(Object(r.__assign)({},o),{pendingDraft:void 0}))}return o}function Re(e,t){return I.G()?e.atMention:t.capability}function we(e){if(I.G()&&("web"===Object(b.a)()||"win32"===Object(b.a)())){if(e.tasks===d.a.Unknown){if("win32"===Object(b.a)())return I.b();Object(i.i)().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===d.a.Enabled&&I.b()}return I.b()}function Ne(e,t){return I.G()?e.virtualized:t}function Me(e,t){return I.G()?e.resolve:t}function Fe(e,t,n){var r,a=e.pendingCommentLoad,i=void 0,s=e.expandedComments;if(e.pendingCommentLoad){var c=e.pendingCommentLoad.selectedThreadIndex;if(void 0!==c&&Object(k.a)({commentData:t,pendingCommentLoad:a,virtualized:n})){var d=t.filter(m.a);if(!(c>=0&&c<d.length))throw Object(o.i)("selectedThreadIndex out of bounds"),new T.a(O.k,o.d.reserveTag(589103620),-2130957565);s=X(s,i=$(d[c].commentId),e.draftState)}t.length===e.pendingCommentLoad.numberOfComments&&(a=void 0)}if(e.selectedComment)if(I.mb()){var u=je(e.draftState);(null!==(r=null==u?void 0:u.threadId)&&void 0!==r?r:fe(e.draftState))===e.selectedComment.selectedCardId&&(i=e.selectedComment,s=e.expandedComments)}else Object(D.d)(e.draftState)&&(i=e.selectedComment,s=e.expandedComments);return{pendingCommentLoad:a,selectedComment:i,expandedComments:s}}function Le(e,t){var n=e.find((function(e){return e.commentId===t}));return(null==n?void 0:n.author.DisplayName)&&(null==n?void 0:n.date)?{valid:!0,matchesCurrentUser:!!(null==n?void 0:n.author.IsCurrentUser),timeElapsed:(null==n?void 0:n.date)?Date.now()-n.date.getTime():0}:{valid:!1}}function Ve(e,t){return t?e.filter((function(e){return""===e.parentId&&!(e.commentFlags&c.a.Resolved)})).length>0:e.length>0}var Be=0;function He(){return{atMention:s.b.Unknown,newThread:!1,resolve:!1,richTextCapabilities:Be,tasks:d.a.Unknown,virtualized:!1,presentLinkToComment:!1,UIAAnnotationPattern:!1}}function Ue(e,t){var n,o=e.cardIdToDraftIdMap[t.commentId],a=o?e.drafts[o].commentDraft:void 0;if(void 0===a)return Object(i.i)().assertConditionTag(0===Object.keys(e.drafts).length,"Could not find draft for adding smart replies",590202465),e;var s=t.smartReplies,c=a.sessionConfiguration.sessionType,d=s.length;return"REPLY"===c&&(d<=3&&d>0)?Object(r.__assign)(Object(r.__assign)({},e),{drafts:Object(r.__assign)(Object(r.__assign)({},e.drafts),(n={},n[o]=Object(r.__assign)(Object(r.__assign)({},e.drafts[o]),{smartReplies:s}),n))}):e}},164:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(247),o=n(107),a=n(130);function i(e){return e.sessionType===a.a}function s(e){return e.sessionType===a.d&&void 0!==e.threadId}function c(e){return e.sessionType===a.b&&void 0!==e.commentId}var d={CREATE:0,REPLY:1,EDIT:2,METADATA:3},u={CREATE:o.a.Insert,REPLY:o.a.Insert,EDIT:o.a.Modify,METADATA:o.a.Modify};function l(e){return i(e)?r.a.InitCreateCommentSession:s(e)?r.a.InitReplyCommentSession:c(e)?r.a.InitEditCommentSession:r.a.Unknown}},165:function(e,t,n){"use strict";var r;!function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"}(r||(r={})),t.a=r},169:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"b",(function(){return C})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"j",(function(){return I})),n.d(t,"a",(function(){return S})),n.d(t,"g",(function(){return _})),n.d(t,"i",(function(){return D})),n.d(t,"h",(function(){return E})),n.d(t,"n",(function(){return j}));var r,o,a,i,s,c=n(3),d=n(41),u=1e3,l="2px",m="4px",f="@media screen and (-ms-high-contrast: active), (forced-colors: active)",p={content:'""',position:"absolute",left:-1,top:-1,bottom:-1,right:-1,border:0,outline:"none",zIndex:1},C={BUTTON_HOVER:"#F3F2F1",BUTTON_SELECT:"#E1DFDD",BUTTON_DOWN:"#D2D0CE",BUTTON_DISABLED:"#FAF9F8",HIGH_CONTRAST:{BUTTON_FOCUS:"highlight"}},g=((r={forcedColorAdjust:"auto",MsHighContrastAdjust:"auto",svg:{forcedColorAdjust:"auto"}})[f]={color:"revert",stroke:"revert"},r);function h(e){return Object(c.db)(e,g)}var b={selectors:(o={},o[c.l]={backgroundColor:"Highlight",color:"HighlightText",borderColor:"WindowText",MsHighContrastAdjust:"none",selectors:{"svg > path":{fill:"HighlightText"}}},o)},v=Object(c.db)(b,{selectors:(a={},a[c.l]={outline:"2px",outlineOffset:"-2px"},a)}),y=Object(c.db)({selectors:(i={},i[c.l]={outline:"2px",outlineOffset:"-2px"},i)}),T=Object(c.db)(((s={})[f]={color:"ButtonText"},s)),O=function(e){void 0===e&&(e={});var t={rootHovered:h(v),rootFocused:h(b),rootDisabled:h(y),icon:h(T)};return Object(c.cb)(e,t)};function I(e){var t;return Object(c.cb)(e,{root:(t={},t[c.l]={color:"ButtonText"},t)})}var S={LEVEL1:"0px 1px 2px 0px rgba(0,0,0,0.10)",LEVEL2:"0px 2px 4px 0px rgba(0,0,0,0.10)",LEVEL3:"0px 4px 8px 0px rgba(0,0,0,0.10)",LEVEL4:"0px 8px 16px 0px rgba(0,0,0,0.10)",LEVEL5:"0px 16px 24px 0px rgba(0,0,0,0.10)"},_='"Segoe UI"',D='"Segoe UI Web"',E='"Segoe UI Semibold"';function j(e,t,n){var r,o;return!e||t?null!==(r=null==n?void 0:n.CardBackground)&&void 0!==r?r:d.a.WHITE:null!==(o=null==n?void 0:n.ResolvedCardBackground)&&void 0!==o?o:d.a.REST_RESOLVED_BODY}},17:function(e,t,n){"use strict";var r=n(69),o=n(79),a=n(5),i=n(699);function s(e,t){return void 0===t&&(t=new Set),!!Object(o.a)().isFeatureEnabled(e)&&(t.add(e),i.a[e].dependencies.every((function(n){var r=t.has(n)||s(n,t);return Object(a.i)().assertConditionTag(r,"Gate "+e+" enabled without dependency gate "+n,544482649),r})))}function c(){return s("LivePersonaPicker")}function d(){return s("PersonaFeature")}function u(){return s("NewCommentButton")}function l(){return s("DiscreteHostedComments")}function m(){return s("CommentsFluentUI")}function f(){return s("RenderDHCInPane")}function p(){return s("CommentTasks")}function C(){return s("NoDiscardOnFocusLoss")}function g(){return s("NewDraftingUI")}function h(){return s("TaskPaneWithNewInfrastructure")}function b(){return s("CommentTasksFromReply")}function v(){return s("NewModelState")}function y(){return s("HeadlessBoot")}function T(){return s("HyperlinksInComments")}function O(){return s("ContentNavigation")}function I(){return s("AtMentionFloodgateSurvey")}function S(){return s("ExtendedDrafting")}function _(){return s("RichTextFormattingInWeb")}function D(){return s("LogDraftCommentIdPair")}function E(){return s("RichContentEditIntegrationInWeb")}function j(){return s("SmartReplies")}function P(){return s("NewSelectionInteractions")}function x(){return s("CommentReactions")}function A(){return s("HyperlinksWithDisplayText")}function k(){return s("LinkToComment")}function R(){return s("WebThemeIntegration")}function w(){return s("TruncationUIWithReadMoreText")}function N(){return s("QuillInitializationTelemetry")}function M(){return s("QuickEdit")}function F(){return s("CtrlEnterTip")}function L(){return s("HighlightsAndFontColorInWebComments")}function V(){return s("DiagnosticHeartbeat")}function B(){return!1}function H(){return Object(o.a)().isChangeGateEnabled("DeprecateCommentAPIResolve",Object(r.c)(5577264))}function U(){return Object(o.a)().isChangeGateEnabled("LocalHistoryRecordIDs",Object(r.c)(5464019))}function G(){return Object(o.a)().isChangeGateEnabled("SetTimeoutForFocusTriggeredHandling",Object(r.c)(5467191))}function W(){return Object(o.a)().isChangeGateEnabled("FormatDateMissingLocaleFix",Object(r.c)(5483206))}function q(){return Object(o.a)().isChangeGateEnabled("LPPTabFixWeb",Object(r.c)(5560451))}function z(){return Object(o.a)().isChangeGateEnabled("ContextMenuHighContrastFixWeb",Object(r.c)(5557903))}function Y(){return Object(o.a)().isChangeGateEnabled("EscMoveFocusToCanvas",Object(r.c)(5565542))}function K(){return Object(o.a)().isChangeGateEnabled("EnsureCardSelectionOnReverseTabLoop",Object(r.c)(5605361))}function X(){return Object(o.a)().isChangeGateEnabled("FixReadOnlyEditingButtons",Object(r.c)(5624655))}function J(){return Object(o.a)().isChangeGateEnabled("FixReducerDisplayDate",Object(r.c)(5631329))}function Q(){return Object(o.a)().isChangeGateEnabled("FixOutlookHyperlinkPasting",Object(r.c)(5637536))}function Z(){return Object(o.a)().isChangeGateEnabled("AriaPlaceholderForCommentEditorWeb",Object(r.c)(5643247))}function $(){return Object(o.a)().isChangeGateEnabled("ShortCircuitPersonaProperties",Object(r.c)(5703224))}function ee(){return Object(o.a)().isChangeGateEnabled("ThreadDescribedBy",Object(r.c)(5670736))}function te(){return Object(o.a)().isChangeGateEnabled("NumberOfMentioneeOnDiscard",Object(r.c)(5651263))}function ne(){return Object(o.a)().isChangeGateEnabled("FixDetachedHyperlinksWeb",Object(r.c)(5670271))}function re(){return Object(o.a)().isChangeGateEnabled("WebHyperlinkStylingFix",Object(r.c)(5703519))}function oe(){return Object(o.a)().isChangeGateEnabled("LPPManagerContext",Object(r.c)(5576712))}function ae(){return Object(o.a)().isChangeGateEnabled("WebCommentPaneCloseButtonStylingFix",Object(r.c)(5703529))}function ie(){return Object(o.a)().isChangeGateEnabled("SilentDiscardTelemetry",Object(r.c)(5700659))}function se(){return Object(o.a)().isChangeGateEnabled("UseDraftBoxMessage",Object(r.c)(5665352))}function ce(){return Object(o.a)().isChangeGateEnabled("TaskAssignerA11yFix",Object(r.c)(5727631))}function de(){return Object(o.a)().isChangeGateEnabled("SpaceKeyGhostCard",Object(r.c)(5737018))}function ue(){return Object(o.a)().isChangeGateEnabled("AllowDiscardEditInOtherContext",Object(r.c)(5727883))}function le(){return Object(o.a)().isChangeGateEnabled("A11yFastPastFixes",Object(r.c)(5736337))}function me(){return Object(o.a)().isChangeGateEnabled("WebEmptyDraftThreadReverseTabLoopFix",Object(r.c)(5746415))}function fe(){return Object(o.a)().isChangeGateEnabled("WebThemeIntegrationHighContrastFixes",Object(r.c)(5746447))}function pe(){return Object(o.a)().isChangeGateEnabled("HideCardContextMenuForRootReadOnly",Object(r.c)(5751627))}function Ce(){return Object(o.a)().isChangeGateEnabled("ContextDetailsPreservesDraftThreadSelection",Object(r.c)(5749931))}function ge(){return Object(o.a)().isChangeGateEnabled("NewCommentLikeUserList",Object(r.c)(5752330))}function he(){return Object(o.a)().isChangeGateEnabled("WebHistoryItemIconHighContrastFix",Object(r.c)(5759110))}function be(){return Object(o.a)().isChangeGateEnabled("FixSelectRootPostOfSelectedThread",Object(r.c)(5775395))}n.d(t,"x",(function(){return c})),n.d(t,"J",(function(){return d})),n.d(t,"D",(function(){return u})),n.d(t,"n",(function(){return l})),n.d(t,"i",(function(){return m})),n.d(t,"jb",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"H",(function(){return C})),n.d(t,"F",(function(){return g})),n.d(t,"T",(function(){return h})),n.d(t,"c",(function(){return b})),n.d(t,"G",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"d",(function(){return T})),n.d(t,"kb",(function(){return O})),n.d(t,"h",(function(){return I})),n.d(t,"q",(function(){return S})),n.d(t,"N",(function(){return _})),n.d(t,"B",(function(){return D})),n.d(t,"M",(function(){return E})),n.d(t,"e",(function(){return j})),n.d(t,"mb",(function(){return P})),n.d(t,"a",(function(){return x})),n.d(t,"w",(function(){return A})),n.d(t,"A",(function(){return k})),n.d(t,"bb",(function(){return R})),n.d(t,"V",(function(){return w})),n.d(t,"L",(function(){return N})),n.d(t,"K",(function(){return M})),n.d(t,"k",(function(){return F})),n.d(t,"v",(function(){return L})),n.d(t,"m",(function(){return V})),n.d(t,"C",(function(){return B})),n.d(t,"l",(function(){return H})),n.d(t,"lb",(function(){return U})),n.d(t,"O",(function(){return G})),n.d(t,"t",(function(){return W})),n.d(t,"z",(function(){return q})),n.d(t,"j",(function(){return z})),n.d(t,"p",(function(){return Y})),n.d(t,"o",(function(){return K})),n.d(t,"fb",(function(){return X})),n.d(t,"gb",(function(){return J})),n.d(t,"s",(function(){return Q})),n.d(t,"g",(function(){return Z})),n.d(t,"P",(function(){return $})),n.d(t,"U",(function(){return ee})),n.d(t,"I",(function(){return te})),n.d(t,"r",(function(){return ne})),n.d(t,"ab",(function(){return re})),n.d(t,"y",(function(){return oe})),n.d(t,"X",(function(){return ae})),n.d(t,"Q",(function(){return ie})),n.d(t,"W",(function(){return se})),n.d(t,"S",(function(){return ce})),n.d(t,"R",(function(){return de})),n.d(t,"db",(function(){return ue})),n.d(t,"f",(function(){return le})),n.d(t,"Y",(function(){return me})),n.d(t,"cb",(function(){return fe})),n.d(t,"ib",(function(){return pe})),n.d(t,"eb",(function(){return Ce})),n.d(t,"E",(function(){return ge})),n.d(t,"Z",(function(){return he})),n.d(t,"hb",(function(){return be}))},173:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"}(r||(r={}))},174:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"}(r||(r={}))},175:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"}(r||(r={}))},176:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"}(r||(r={}))},1790:function(e,t,n){"use strict";n.r(t);var r=n(1);n(1530),n(1543),n(1548);var o=n(142);n(473);var a=n(297),i=n(7),s=n(2049),c=n(69),d=n(5),u=n(133),l=n(28),m=(n(1558),n(1560),n(764)),f=n(420),p=n(1196),C=n(585),g=n(17),h=function(){function e(){this._listeners=[]}return e.prototype.add=function(e){this._listeners.push(e)},e.prototype.remove=function(e){var t=this._listeners.indexOf(e);t>=-1&&this._listeners.splice(t,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var e=this;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e._listeners.forEach((function(e){return e.apply(void 0,Object(r.__spread)(t))}))}},enumerable:!1,configurable:!0}),e}(),b=function(){function e(){var e=this;this.changedEvent=new h,this.fireEvent=function(t){e.changedEvent.invoke(t)}}return e.prototype.registerForViewContainerEvents=function(e){this.changedEvent.add(e)},e.prototype.unregisterForViewContainerEvents=function(e){this.changedEvent.remove(e)},e}(),v=function(){function e(e,t,n){this.viewContainerBase=e,this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.identifier=e.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}(),y=n(345),T=n(0),O=n(38),I=n(77),S=n(62);function _(e,t){return e+"-"+t}var D,E=n(145),j=n(433);!function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"}(D||(D={}));var P={sendCodeMarker:function(e){},onStartEvent:new j.EventImpl((function(){})),onStopEvent:new j.EventImpl((function(){}))},x=function(e){this.onMockUIAction=new j.EventImpl((function(){}))},A=n(697),k=n(232),R=n(387),w=n(51),N=function(e,t){var n=this;this.commentViewManager=e,this.correlationId=t,this.visit=function(e){e.attachContext(n.commentViewManager.apiContext),n.correlationId&&e.addDataField("InstanceCorrelationId",n.correlationId,d.d.SystemMetadata)}};function M(e){return new N(F(e),e.correlationId)}var F=function(){throw new Error("ViewManagerFactory not set")};var L=new(function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(e){var t=this;return this.instanceMap.get(e)||{visit:function(n){var r=t.instanceMap.get(e);if(!r)return n.attachContext(e),void n.addDataField("MissingInstanceTelemetry",!0,d.d.SystemMetadata);r.visit(n)}}},e.prototype.closeViewManager=function(e){var t=this.instanceMap.get(e);t&&(t.commentViewManager.teardown(),this.instanceMap.delete(e))},e.prototype.doesViewManagerExist=function(e){return this.instanceMap.has(e)},e.prototype.ensureViewManager=function(e){var t=e.apiContext,n=e.displayMode,r=e.contentNavigationAPI;this.initialized||this.ensureInitialized();var o=this.instanceMap.get(t);return o?this.updateInstanceObject(o,n):(this.initializeContentNavigationAPI(t,r),o=M(e),this.instanceMap.set(t,o)),o.commentViewManager},e.prototype.getCorrelationId=function(e){var t=this.instanceMap.get(e);return t&&t.correlationId},e.prototype.getStore=function(e){var t=this.instanceMap.get(e);if(!t)throw new w.a("Instance is not initialized",i.d.reserveTag(589103622),-2130957512);return t.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(e){var t=this.tryGetViewManager(e);if(!t)throw new w.a("Instance is not initialized",i.d.reserveTag(589103623),-2130957512);return t},e.prototype.tryGetViewManager=function(e){var t;return null===(t=this.instanceMap.get(e))||void 0===t?void 0:t.commentViewManager},e.prototype.ensureInitialized=function(){var e=this;g.u()&&P.onStartEvent.subscribe((function(t){e.initializeContentNavigationAPI(t.context,void 0),e.initializeViewManager(t.context,t.correlationId,t.useMockMode)})),P.onStopEvent.subscribe((function(t){e.closeViewManager(t.context),Object(E.e)(t.context)})),this.initialized=!0},e.prototype.initializeViewManager=function(e,t,n){var r=this.instanceMap.get(e);if(r)r.correlationId=t;else{var o=void 0;n&&g.n()&&(Object(d.i)().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(e),d.a.None,d.b.FullEvent).successTag(592511450),o=new x(e)),this.instanceMap.set(e,M({apiContext:e,correlationId:t,initializationReason:R.a.PaneOpen,displayMode:k.b.FullPane,foldableLayoutState:A.a.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:o}))}},e.prototype.updateInstanceObject=function(e,t){var n=e.commentViewManager.viewProvider;n.getViewContainer().containerType!==t&&n.changeViewContainerType(t)},e.prototype.initializeContentNavigationAPI=function(e,t){Object(E.g)(e)||Object(E.h)(t||new E.b(e),e)},e}()),V=n(109),B=n(282),H=function(){function e(e,t,n){var r=this;this.viewContainerBase=e,this.context=t,this.viewContainerProvider=n,this.rootNode=null,this.lastRenderFailed=!1,this.processVisibilityEvent=function(e){switch(e.viewContainerVisibilityState){case V.a.Visible:r.viewContainerBase.identifier?r.rootNode=document.getElementById(r.viewContainerBase.identifier):Object(d.i)().assertConditionTag(!1,"View container base identifier expected",558401364),r.providerPromise.then((function(e){r.renderIntoView(e)})).catch(Object(S.a)(i.d.reserveTag(558401365)));break;case V.a.Closed:r.viewContainerBase.identifier&&r.rootNode&&(Object(O.unmountComponentAtNode)(r.rootNode),r.rootNode=null);break;case V.a.Hidden:Object(d.i)().assertConditionTag(!1,"ViewContainerVisibilityState.Hidden is not currently supported for web.",558401366);break;default:Object(i.m)(e.viewContainerVisibilityState)}},this.containerType=e.containerType,this.onReadyToRender=e.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(e)),this.invokeModalConfirmationDialog=e.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(e)),this.setDisplayConfiguration=e.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(e)),this.closeView=e.closeView.bind(e),this.onViewEventReceived=this.onViewEventReceived.bind(this),this.onProviderStateChange=this.onProviderStateChange.bind(this);var o=_("SharedCommentPane",t);this.viewContainerProvider&&(this.viewContainerProvider.registerForViewContainerEvents(this.onViewEventReceived),this.providerPromise=Object(y.c)().getComponent(o),this.providerPromise.then((function(e){e.onStateChanged.subscribe(r.onProviderStateChange)})).catch(Object(S.a)(i.d.reserveTag(558401359))))}return Object.defineProperty(e.prototype,"identifier",{get:function(){return this.viewContainerBase.identifier},enumerable:!1,configurable:!0}),e.prototype.renderIntoView=function(e){this.renderPane(e)},e.prototype.renderPane=function(e){var t=this,n=e.component,r=Object(d.i)().createActivityObject("RenderPaneIntoView",L.getTelemetryVisitor(this.context),d.a.None,d.b.NecessaryServiceDataEvent);if(!n)return this.lastRenderFailed&&r.failTag(558401360,-2130957502),void(this.lastRenderFailed=!0);Object(O.render)(T.createElement(n,{resource:{id:"CommentPane"}}),this.rootNode,(function(){var e=document.getElementById(I.y());e&&e.focus(),t.lastRenderFailed=!1})),r.successTag(558401361)},e.prototype.onProviderStateChange=function(e){var t=this;this.rootNode&&(e===y.a.Registered?this.providerPromise.then((function(e){t.renderIntoView(e)})).catch((function(e){Object(d.i)().assertConditionTag(!1,"Unexpected promise rejection from component provider promise",558401362)})):e===y.a.Unregistered&&Object(O.unmountComponentAtNode)(this.rootNode))},e.prototype.onViewEventReceived=function(e){var t;switch(e.eventType){case B.a.VisibilityChanged:this.processVisibilityEvent(e);break;case B.a.ViewContainerChanged:e.newViewContainer!==this&&(null===(t=this.viewContainerProvider)||void 0===t||t.unregisterForViewContainerEvents(this.onViewEventReceived));break;case B.a.FoldableLayoutStateChanged:case B.a.FocusTriggered:break;default:Object(i.m)(e)}},e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.closeView=function(){this.viewContainerBase.closeView()},e.prototype.moveFocusToCanvas_donotuse=function(){},e}(),U=function(e){function t(t,n){var r=e.call(this)||this;return r.viewContainerProvider=n,r.apiContext=t,n.registerForViewContainerEvents(r.fireEvent),r}return Object(r.__extends)(t,e),t.prototype.getViewContainer=function(){return this.currentContainer||(g.T()?this.currentContainer=new v(this.viewContainerProvider.getViewContainer(),this.apiContext,this):this.currentContainer=new H(this.viewContainerProvider.getViewContainer(),this.apiContext,this)),this.currentContainer},t.prototype.changeViewContainerType=function(e){},t}(b);var G=n(246),W=n(12),q=Object(W.c)((function(){return{offscreenLiveRegion:{clip:"rect(1px, 1px, 1px, 1px)",height:0,overflow:"hidden",position:"absolute",whiteSpace:"nowrap",width:0}}})),z=function(e){function t(t){var n=e.call(this,t)||this;return n.state={liveRegionUpdate:t.liveRegionUpdate,liveRegionCounter:0},n}return Object(r.__extends)(t,e),t.prototype.appendLiveRegionUpdate=function(e){var t=this,n=this.state.liveRegionCounter+1;this.setState({liveRegionUpdate:e,liveRegionCounter:n}),setTimeout((function(){t.state.liveRegionCounter===n&&t.setState({liveRegionUpdate:void 0,liveRegionCounter:0})}),1e3)},t.prototype.render=function(){var e=q();return T.createElement("span",{role:"region","aria-live":"assertive","aria-atomic":"true","aria-relevant":"additions",style:e.offscreenLiveRegion},this.state.liveRegionUpdate)},t}(T.PureComponent);function Y(){var e=document.createElement("div");document.body.appendChild(e),O.render(T.createElement(z,{ref:X}),e),Object(G.c)({announceToScreenReader:function(e){var t=K;t&&!function(e){return null==e}(e)&&t.appendLiveRegionUpdate(e)}})}var K=void 0;function X(e){K=e}n(79);var J=n(699),Q=n(3);var Z={name:"OfficeSharedComments",version:n(1103).a},$=n(119);function ee(){if(!g.n())throw new w.a($.n,i.d.reserveTag(589103628),-2130957516);return L.getViewManager(a.a)}function te(){ee().beginInitialization()}var ne,re=n(184),oe=n(242),ae=n(583),ie=function(){function e(e,t,n,r,o){var a=this;this.hostCommentAPI=e,this.author=t,this._anchorHintText=n,this.sessionConfiguration=r,this._insertIndex=o,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(e){e.draftId===a.sessionConfiguration.draftId&&(e.anchorHintText&&(a._anchorHintText=e.anchorHintText),void 0!==e.insertIndex&&(a._insertIndex=e.insertIndex))},this.handleCommentEvents=function(e,t){e===oe.e.CommentContextChanged&&Object(ae.b)(t)&&t.contextDrafts?t.contextDrafts.forEach((function(e){return a.updateDraft(e)})):e===oe.e.UpdateDraftThread&&Object(ae.d)(t)&&a.updateDraft(t)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(e,t){this._propertiesToUpdate[e]=Object(r.__assign)({},t)},e.prototype.commit=function(e){if(!this.hostCommentAPI.commit)throw new w.a($.h,i.d.reserveTag(589103689),-2130957526);if(!this._active)throw new w.a($.b,i.d.reserveTag(589103690),-2130957525);var t=g.b()&&this.sessionConfiguration.sessionType===oe.i;if(void 0===e&&!t||t&&void 0!==e)throw new w.a($.c,i.d.reserveTag(589103691),-2130957507);return g.b()||g.a()?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,e)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}(),se=function(){function e(e){this.hostCommentAPI=e,this.loadThreads=e.loadThreads.bind(e),this.deleteComment=e.deleteComment.bind(e),this.selectComment=e.selectComment.bind(e),this.highlightComment=e.highlightComment.bind(e),this.setThreadResolvedState=e.setThreadResolvedState.bind(e),this.selectFirstThreadInNextCommentContext=e.selectFirstThreadInNextCommentContext.bind(e),this.selectLastThreadInPreviousCommentContext=e.selectLastThreadInPreviousCommentContext.bind(e),this.registerForCommentEvents=e.registerForCommentEvents.bind(e),this.unregisterForCommentEvents=e.unregisterForCommentEvents.bind(e),this.registerForAction=e.registerForAction.bind(e),this.unregisterForAction=e.unregisterForAction.bind(e),this.resolveSupported=e.resolveSupported.bind(e),this.checkAtMentionCapability=e.checkAtMentionCapability.bind(e),g.A()&&(this.presentLinkToComment=e.presentLinkToComment.bind(e)),e.registerForInterruptableCommands&&(this.registerForInterruptableCommands=e.registerForInterruptableCommands.bind(e)),e.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=e.unregisterForInterruptableCommands.bind(e)),g.m()&&e.diagnosticHeartbeat&&setInterval((function(){var t;null===(t=e.diagnosticHeartbeat)||void 0===t||t.call(e)}),1e3)}return e.prototype.beginDraftingAsync=function(e){var t=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new w.a("Drafting APIs are undefined on Host Comment API",i.d.reserveTag(589103700),-2130957527);var n=Object(s.a)(),o=Object(r.__assign)(Object(r.__assign)({},e),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(o).then((function(e){return new ie(t.hostCommentAPI,Object(re.b)(e),e.anchorHintText,e.updatedDraftSessionConfiguration||o,e.insertIndex)}))},e}(),ce=n(41),de={themeId:1,palette:{ApplePaneTopBorder:ce.a.GRAY_C,ButtonBorder:ce.a.GRAY_B,CardAccent:ce.a.GRAY_B,CardBackground:ce.a.WHITE,CardHoveredBackground:ce.a.GRAY_20,CardDraftBoxBackgroundHovered:ce.a.WHITE,CardDraftBoxBorderHovered:ce.a.GRAY_160,CardDraftBoxBorder:ce.a.GRAY_110,CardDraftBoxBackground_HalfPane:ce.a.WHITE,CardDraftBoxBackground:ce.a.GRAY_A,CardExpandButtonBorder:ce.a.GRAY_B,CardHeroBarBackground_HalfPane:ce.a.GRAY_A,CardHeroBarBackground:ce.a.WHITE,CardReplyBackground_HalfPane:ce.a.GRAY_A,CardReplyBackground:ce.a.GRAY_A,CardReplyTopBorder:ce.a.GRAY_B,CardSelectionColor:ce.a.COMMENTS_PURPLE,CardShadowColor:ce.a.BLACK,CardBorder:ce.a.GRAY_B,CardBorderEmphasis:ce.a.COMMENTS_PURPLE,CommandBarBorder:ce.a.GRAY_B,CommandBarTopBorder:ce.a.GRAY_B,IconButtonDisabledTint:ce.a.GRAY_C,IconButtonFocusedTint:ce.a.GRAY_I,NavigationBarBackground:ce.a.WHITE,NavigationBarBorder:ce.a.GRAY_B,PaneBackground_HalfPane:ce.a.WHITE,PaneBackground:ce.a.GRAY_A,UnreadDotColor:ce.a.DOT_BLUE,UnreadDotBorderColor:ce.a.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:ce.a.GRAY_150,CardPlaceholderColor:ce.a.GRAY_130,ResolvedCardBackground:ce.a.GRAY_20}},ue=function(){function e(){}return e.prototype.getTheme=function(){return Object(d.i)().assertConditionTag(!1,"Should not be called",592986821),de},e.prototype.registerForThemeChange=function(e){},e.prototype.unregisterForThemeChange=function(e){},e}(),le=n(1013),me=n(185),fe=n(241),pe=n(27),Ce=n(52),ge=n(486),he=n(16),be=n(176),ve=n(46),ye=n(53),Te=n(14),Oe=n(65),Ie=n(291),Se=n(231);!function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"}(ne||(ne={}));var _e,De=n(23),Ee=n(378),je=n(96),Pe=n(127);function xe(e,t){return{type:_e.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}function Ae(e){return e.type===_e.FocusComponent&&void 0!==e.component}function ke(e,t,n){return void 0===n&&(n={priorityArgs:{priority:1}}),Object(r.__assign)({type:_e.FocusComponent,component:t,causedBy:e},n)}!function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"}(_e||(_e={}));var Re=n(44);function we(e,t,n){return t?n?{type:_e.Compound,priorityArgs:{priority:1},first:t,then:n,causedBy:e}:t:n}function Ne(e,t,n,r){if(!e)return ne.NoCommand;var o=ne.Handled;if(Ae(e)){var a=e.component;a.componentType===Re.a.Card&&"ios"===Object(je.a)()&&(fe.a&&Object(i.i)("Switching focus command from Card to Post to workaround iOS platform difference with card container focus"),a.componentType=Re.a.Post),o=function(e,t,n){return t?(fe.a&&Object(i.i)("Calling focus for componentType: "+e.component.componentType),n(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),ne.Handled):function(e){return 1!==e.priorityArgs.priority&&0!==e.priorityArgs.phase}(e)?ne.ShouldRetry:ne.ComponentNotFound}(e,Object(Re.c)(a)?t.getComponentById(a):t.getComponent(a.componentType),r)}else if(function(e){return e.type===_e.DispatchAction&&void 0!==e.action}(e))n.dispatch(e.action);else if(function(e){return e.type===_e.Compound&&void 0!==e.first&&void 0!==e.then}(e)){var s=Ne(e.first,t,n,r),c=Ne(e.then,t,n,r);Object(d.i)().assertConditionTag(s!==ne.ShouldRetry&&c!==ne.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),o}var Me=n(192);function Fe(e,t){return!!(Object(Re.c)(t)?e.getComponentById(t):e.getComponent(t.componentType))}var Le=n(173);function Ve(e){return!!g.F()||!Object(ve.d)(e)&&!e.committedLieId}function Be(e){return function(e){var t=g.n()&&!Oe.b(e);return Te.f(e).nextPopulatedContextDetails!==Le.a.NoComments||Object(he.d)(Te.d(e),t)}(e)&&He(Te.h(e))}function He(e){return g.F()||!Object(ve.d)(e)}function Ue(e,t){if(n=e.componentTreeId.renderContextType,!("win32"===Object(je.a)()||"ios"===Object(je.a)()&&n===De.a.FullPane||"web"===Object(je.a)()&&g.T())&&Object(Pe.b)(n)){var n;if(e.getComponent(Re.a.ClosePaneButton))return ke(void 0,{componentType:Re.a.ClosePaneButton},{priorityArgs:t});Object(d.i)().assertConditionTag(!1,"cant find close button on platform where we should be able to find it",579086371)}}function Ge(e,t,n){var r,o;if(void 0===n&&(n={priority:1}),Object(Pe.b)(e.componentTreeId.renderContextType)){var a=null!==(o=null!==(r=function(e,t,n){if(g.D()&&e.componentTreeId.renderContextType===De.a.FullPane){var r=t.getState();if(g.G()?Te.n(r).newThread:Ve(Te.h(r))){if(e.getComponent(Re.a.NewCommentButton))return ke(void 0,{componentType:Re.a.NewCommentButton},{priorityArgs:n});Object(d.i)().assertConditionTag(!1,"cant find new comment button, but its enabled",579086400)}}}(e,t,n))&&void 0!==r?r:Ue(e,n))&&void 0!==o?o:function(e){if("ios"!==Object(je.a)()&&"web"!==Object(je.a)())return ke(void 0,{componentType:Re.a.CommentsList},{priorityArgs:e})}(n);if(a)return a;Object(d.i)().assertConditionTag("ios"===Object(je.a)()&&e.componentTreeId.renderContextType===De.a.FullPane,"Couldn't find a focus target",576337158)}else Object(d.i)().assertConditionTag(!1,"Shouldn't be called with renderContextType: "+e.componentTreeId.renderContextType,576337157)}var We=function(e){function t(t){var n=e.call(this,t)||this,r=t.nativeEvent,o=r.altKey,a=r.shiftKey,i=r.ctrlKey,s=r.metaKey,c=r.key;return n.altKey=o,n.shiftKey=a,n.ctrlKey=i,n.metaKey=s,n.key=Object(me.f)(c),n}return Object(r.__extends)(t,e),t}(function(){function e(e){this._sourceEvent=e,this.eventPhase=e.eventPhase}return e.prototype.isEventTarget=function(e){return e===this._sourceEvent.target},e.prototype.stopPropagation=function(){this._sourceEvent.stopPropagation()},e.prototype.preventDefault=function(){this._sourceEvent.preventDefault()},e}());function qe(e,t,n,o,a){var i=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(void 0,Object(r.__spread)([e],t))},s=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];var d=i.apply(void 0,Object(r.__spread)([o],s));a(d,o,e(),t,n)};return s.processCommand=i,s}function ze(e,t,n,o,a){var i=function(t,n){var o,i=Object(r.__read)(n),c=i[0],d=i.slice(1),u=c();a(s.apply(void 0,Object(r.__spread)([(o=t,new We(o)),u],d)),u,e(),(function(){}),(function(){}))},s=function(e,a){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(n(a)){var c=Object(me.d)(Object(me.f)(e.key),t),d=o[me.b[c]];return d?d.handler.apply(d,Object(r.__spread)([e,a],i)):void 0}},c=Object.keys(o).map((function(e){return{key:e,eventPhase:o[e].phase}})),d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{onKeyDown:function(t){return i(t,e)},getKeyDownEvents:function(){return c}}};return d.processEvent=s,d}var Ye,Ke,Xe=n(209),Je=n(87),Qe=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startPostIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.model[this.pointer]){var t=Object(Je.b)(this.model[this.pointer]);return e&&e.commentId===t?e:this.model.find((function(e){return e.commentId===t}))}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.model.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.model.length&&e&&e.commentFlags&oe.f.Resolved);else++this.pointer;return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&oe.f.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Ze=n(399),$e=n(102),et=n(239),tt=n(206),nt=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.items=e,this.startItemIndex=t,this.ignoreResolvedThreads=n,this.pointer=0,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t}return e.prototype.getRootCommentForCurrentElement=function(e){if(this.items[this.pointer]){var t=$e.i(this.items[this.pointer]);if(e&&e.commentId===t)return e;for(var n=this.pointer;n>=0;--n){var r=this.items[n];if(Object(tt.a)(r)&&r.commentModel.commentId===t)return r.commentModel}for(n=this.pointer+1;n<this.items.length;++n){r=this.items[n];if(Object(tt.a)(r)&&r.commentModel.commentId===t)return r.commentModel}}},e.prototype.next=function(){var e,t=this.pointer;if(this.pointer<this.items.length-1)if(this.ignoreResolvedThreads)do{++this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer<this.items.length&&e&&e.commentFlags&et.a.Resolved);else++this.pointer;return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e,t=this.pointer;if(this.pointer>0)if(this.ignoreResolvedThreads)do{--this.pointer,e=this.getRootCommentForCurrentElement(e)}while(this.pointer>-1&&e&&e.commentFlags&et.a.Resolved);else--this.pointer;return this.pointer>0||0===this.pointer&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}(),rt=function(){function e(e,t){this.commentStore=e,this.telemetryVisitor=t}return e.prototype.selectThreadInCurrentContext=function(e,t,n,r,o){return xe(e,pe.selectComment(t,n,void 0,r?pe.SelectActionType.ExpandCard:pe.SelectActionType.SelectCard,o))},e.prototype.collapseThreadInCurrentContext=function(e,t,n){return xe(e,pe.collapseCard(t,n))},e.prototype.selectPost=function(e,t,n,r,o){return xe(e,pe.selectComment(t,n,r,pe.SelectActionType.SelectPost,o))},e.prototype.selectFirstThreadInCurrentContext=function(e,t,n,r,o){if(g.mb()){var a=Te.g(this.commentStore.getState(),!0,r),s=Object(he.F)(Te.h(this.commentStore.getState()),!0,r);if(s&&a&&0===a.index)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},s,!1,n)}var c=void 0;o?c=new Ze.a(Te.d(this.commentStore.getState()),-1,o).next().value:c=Te.d(this.commentStore.getState())[0];if(c)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},c.commentId,t,n)},e.prototype.selectLastThreadInCurrentContext=function(e,t,n,r,o){var a=Te.d(this.commentStore.getState());if(g.mb()){var s=Te.g(this.commentStore.getState(),!0,r),c=Object(he.F)(Te.h(this.commentStore.getState()),!0,r);if(c&&s&&s.index===a.length)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},c,!1,n)}if(Object(he.d)(a,o)){var u=new Ze.a(a,a.length,o).previous().value;if(u)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},u.commentId,t,n);Object(d.i)().assertConditionTag(!1,"Unable to find last thread",593278812)}},e.prototype.focusAndCollapseSelectedThread=function(e,t){var n=Te.r(this.commentStore.getState());if(n){if(g.mb()&&Object(he.F)(Te.h(this.commentStore.getState()))===n.selectedCardId)return;var r=Te.j(this.commentStore.getState());if(Object(Ee.a)(n.selectedCardId,r,t)===Ie.a.Expanded)return we(e,ke(e,{componentType:Re.a.Card,id:n.selectedCardId,renderContextType:t}),this.collapseThreadInCurrentContext(e,{renderContextType:t,trackback:i.d.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousThread=function(e,t,n,r,o){var a=this.commentStore.getState(),s=Te.r(a);if(g.kb()&&(!s||r===De.a.DiscreteIntegrated||r===De.a.None&&Oe.e(a)!==V.a.Visible)){if(void 0!==n)return xe(e,pe.selectContent({renderContextType:r,trackback:i.d.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},t.direction,t.iterableContentTypes,!!t.restrictToCurrentContext,!!t.restrictToCurrentContext,s?{contentId:s.selectedCardId,contentType:l.b.CommentThread}:void 0,n));Object(d.i)().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var c=Te.d(a),u=Te.f(a).nextPopulatedContextDetails;if(void 0!==s){var m=Te.g(a,!0,r),f=Object(he.F)(Te.h(a),!0,r),p=void 0;p=g.mb()&&m&&s.selectedCardId===f?m.index+(t.direction===E.d.Next?-1:0):this.getSelectedThreadIndex();var C=new Ze.a(c,p,o),h=t.direction===E.d.Next?C.next():C.previous();if(g.mb()&&f&&m&&s.selectedCardId!==f)if(t.direction===E.d.Next?p<m.index&&(h.done||C.currentIndex()>=m.index):p>=m.index&&(h.done||C.currentIndex()<m.index))return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},f,!1,t.source);if(!h.done)return this.selectThreadInCurrentContext(e,{renderContextType:r,trackback:i.d.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},h.value.commentId,t.expandCard,t.source);if(!t.restrictToCurrentContext)return this.selectAcrossContexts(e,t,r,u,o)}else{if(Object(he.d)(c,o))return this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,r,o);if(!t.restrictToCurrentContext&&u!==Le.a.NoComments)return this.selectAcrossContexts(e,t,r,u,o)}},e.prototype.selectAcrossContexts=function(e,t,n,r,o){return g.n()&&g.kb()&&!Oe.a(this.commentStore.getState())&&Object(d.i)().assertConditionTag(!1,"This method should only be called if pane is closed, DHCs are on, and content navigation is off.",560551957),t.direction===E.d.Next?r===Le.a.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(e,t.expandCard,t.source,n,o):xe(e,pe.selectFirstThreadInNextCommentContext({renderContextType:n,trackback:i.d.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):r===Le.a.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(e,t.expandCard,t.source,n,o):xe(e,pe.selectLastThreadInPreviousCommentContext({renderContextType:n,trackback:i.d.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(e,t,n){if(void 0!==Te.r(this.commentStore.getState())){if(!g.b()){var r=Te.d(this.commentStore.getState()),o=this.getSelectedIndex(),a=new Qe(r,o).next(),s=r[o];return!a.done&&a.value.parentId&&a.value.parentId===Object(Je.b)(s)?this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},a.value.parentId,a.value.commentId,Ce.a.SharedComments):void 0}if(n){var c=this.getSelectedIndexFromRenderableItems(n);if(!(c<0)){var u=new nt(n,c).next(),l=n[c],m=$e.i(l);return u.done||$e.i(u.value)!==m?void 0:this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},$e.i(u.value),$e.e(u.value),Ce.a.SharedComments)}Object(d.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777352)}else Object(d.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278855)}else Object(d.i)().assertConditionTag(!1,"Expected selectedComment",593278853)},e.prototype.selectPreviousPostWithinCard=function(e,t,n){if(void 0!==Te.r(this.commentStore.getState()))if(g.b())if(n){var r=this.getSelectedIndexFromRenderableItems(n);if(r<0)Object(d.i)().assertConditionTag(!1,"Selection not found in renderableItems",571777353);else{var o=n[r],a=$e.g(o);if(a)if(!(s=new nt(n,r).previous()).done&&$e.i(s.value)===a)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},$e.i(s.value),$e.e(s.value),Ce.a.SharedComments)}}else Object(d.i)().assertConditionTag(!1,"renderableItems must not be undefined",593278859);else{var s,c=Te.d(this.commentStore.getState()),u=this.getSelectedIndex(),l=c[u];if(l.parentId&&!(s=new Qe(c,u).previous()).done&&Object(Je.b)(s.value)===l.parentId)return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},Object(Je.b)(s.value),s.value.commentId,Ce.a.SharedComments)}else Object(d.i)().assertConditionTag(!1,"Expected selectedComment",593278857)},e.prototype.selectRootPostOfSelectedThread=function(e,t){var n=Te.r(this.commentStore.getState());if(n&&!Object(ye.j)(n.selectionDetails)){var r=void 0;if(g.hb())r=n.selectedCardId;else{var o=this.getSelectedIndex();r=Te.d(this.commentStore.getState())[o].commentId}return this.selectPost(e,{renderContextType:t,trackback:i.d.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},r,r,Ce.a.SharedComments)}},e.prototype.focusAndSelectSiblingThread=function(e,t){if(!(t<0)){var n,r=Te.d(this.commentStore.getState()).filter((function(e){return!e.parentId}));if(0!==r.length)if(!(t-1<0&&t+1>=r.length))return n=t-1>=0?t-1:t+1,we(void 0,ke(void 0,{componentType:Re.a.Card,id:r[n].commentId,renderContextType:e}),xe(void 0,pe.selectComment({renderContextType:e,trackback:i.d.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},r[n].commentId,void 0,pe.SelectActionType.SelectCard,Ce.a.SharedComments)))}},e.prototype.getSelectedIndex=function(){return Object(he.t)(Te.d(this.commentStore.getState()),Te.r(this.commentStore.getState()))},e.prototype.getSelectedThreadIndex=function(){var e=this.commentStore.getState();return Object(he.K)(Te.d(e),Te.r(e))},e.prototype.getSelectedIndexFromRenderableItems=function(e){var t=Te.r(this.commentStore.getState());if(!t)return-1;var n=Object(ye.b)(t);return e.findIndex((function(e){return Object(tt.a)(e)?e.commentModel.commentId===n:e.historyItem.records[0].recordId===n}))},e}(),ot=function(){function e(e,t){var n,r,o,a=this;this.isRTL=e,this.telemetryVisitor=t,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=(n=50,r=[_e.FocusComponent],(o=function(e,t,a,s,c){if(!r||!e||-1===r.indexOf(e.type)||3===e.priorityArgs.priority)return e&&-1!==(null==r?void 0:r.indexOf(e.type))&&(fe.a&&(null==e?void 0:e.type)===_e.FocusComponent&&Object(i.i)("Executing non-debounced focus command "+JSON.stringify(e)),void 0!==o.pendingCommand&&clearTimeout(o.pendingCommand),o.pendingCommand=void 0),void s(e,Ne(e,t,a,c));void 0!==o.pendingCommand&&clearTimeout(o.pendingCommand),fe.a&&e.type===_e.FocusComponent&&Object(i.i)("Caching debounced command "+JSON.stringify(e)),o.pendingCommand=setTimeout((function(){fe.a&&e.type===_e.FocusComponent&&Object(i.i)("Executing debounced command "+JSON.stringify(e)),s(e,Ne(e,t,a,c)),o.pendingCommand=void 0}),n)}).pendingCommand=void 0,o),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(e){var t=e?Object(Me.d)(e):"";!a.pendingOnComponentFocusedRequest||""!==t&&t===Object(Me.d)(a.pendingOnComponentFocusedRequest.targetedComponent)||(fe.a&&Object(i.i)("Pending component focused request cleared."),clearTimeout(a.pendingOnComponentFocusedRequest.token),a.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(e){a.clearPendingOnComponentFocusedRequest(e)},this.commandExecuteCallback=function(e,t){e&&Ae(e)&&(t===ne.ShouldRetry?a.focusToRetry={command:e,timestamp:Date.now()}:t===ne.Handled&&(a.focusToRetry=void 0))},this.commentContentsKeyDown=ze((function(){return a.commentStore}),this.isRTL,(function(e){var t=Te.h(a.commentStore.getState());if(g.mb()){var n=Object(he.H)(t);if(n&&e.isFocusOnOrWithin({componentType:Re.a.CardEditor,id:n,renderContextType:t.drafts[t.cardIdToDraftIdMap[n]].renderContextType}))return!1;var r=Object(he.I)(t);if(r&&e.isFocusOnOrWithin({componentType:Re.a.PostEditor,id:r,renderContextType:t.drafts[t.postIdToDraftIdMap[r]].renderContextType}))return!1}else if(Object(ve.c)(t))return!1;return!e.isFocusOn({componentType:Re.a.GhostCard})&&!e.isFocusOn({componentType:Re.a.NewCommentButton})}),{ArrowDown:{handler:function(e,t,n){var r=a.onDownKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:me.a.Bubbling},ArrowUp:{handler:function(e,t,n){var r=a.onUpKey(e,t,n?n():void 0);return r&&(r.stopPropagation=!0,r.preventDefault=!0),r},phase:me.a.Bubbling},ArrowRight:{handler:function(e,t){if(t.componentTreeId.renderContextType!==De.a.HalfPane){var n=a.onRightKey(e,t);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:me.a.Bubbling},ArrowLeft:{handler:function(e,t){if(t.componentTreeId.renderContextType!==De.a.HalfPane){var n=a.onLeftKey(e,t.componentTreeId.renderContextType);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:me.a.Bubbling},Home:{handler:function(e,t){if(t.componentTreeId.renderContextType===De.a.FullPane){var n=a.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!0,Ce.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:me.a.Capturing},End:{handler:function(e,t){if(t.componentTreeId.renderContextType===De.a.FullPane){var n=a.selectionCommandFactory.selectLastThreadInCurrentContext(e,!0,Ce.a.SharedComments,t.componentTreeId.renderContextType,!1);return n&&(n.stopPropagation=!0,n.preventDefault=!0),n}},phase:me.a.Capturing},F12:{handler:function(e,t){var n=e.altKey?a.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:me.a.None},Escape:{handler:function(e,t){var n=g.p()&&"win32"===Object(je.a)()?a.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:me.a.None}},this.commandExecutor),this.focusCommentCardCommand=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n=Te.h(a.commentStore.getState()),r=Object(he.J)(n),o=void 0;return(o=a.checkForRetryOfEditorFocus(e,n))||!g.mb()&&(null==r?void 0:r.threadId)===t&&(o=a.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n))?o:ke(void 0,{componentType:Object(Me.c)(t,n),id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:e.componentTreeId.renderContextType===De.a.DiscreteIntegrated})}),this.commandExecutor),this.focusCommentPostCommand=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n=Te.h(a.commentStore.getState());if(!g.mb()&&n.postIdToDraftIdMap[t]){var r=a.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,n);if(r)return r}return ke(void 0,{componentType:Re.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})}),this.commandExecutor),this.focusCommentPaneCommand=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e){if(Object(Pe.b)(e.componentTreeId.renderContextType)){var t=Te.h(a.commentStore.getState()),n=Te.r(a.commentStore.getState()),r=void 0;if(r=a.checkForRetryOfEditorFocus(e,t))return r;if(!e.isFocusWithinPane()||e.isFocusOn({componentType:Re.a.PaneRoot})){if(!g.mb()&&(r=a.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t)))return r;if(r=a.checkForCommentSelectionFocus(e.componentTreeId.renderContextType,n,t))return r;if(!g.D()&&!e.getComponent(Re.a.ClosePaneButton)){var o=Te.d(a.commentStore.getState());return o.length>0?a.focusCommentCardCommand.processCommand(e,o[0].commentId):void Object(d.i)().assertConditionTag("win32"===Object(je.a)()||"ios"===Object(je.a)()&&e.componentTreeId.renderContextType===De.a.FullPane,"Shouldn't be reached on current config",575239243)}return Ge(e,a.commentStore)}}else Object(d.i)().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242)}),this.commandExecutor),this.commentCardMounted=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n,r=Te.h(a.commentStore.getState()),o={componentType:Object(Me.c)(t.id,r),id:t.id,renderContextType:e.componentTreeId.renderContextType};if(n=a.handleFocusRetry(e,o,r,1))return n;if(t.selected&&!e.isFocusWithin(o)){var i=Object(Pe.b)(e.componentTreeId.renderContextType);if((!i||e.isFocusWithinPane())&&(i||e.isFocusWithinAny(Re.a.Card)||e.isFocusWithinAny(Re.a.DraftCard)))return a.focusCommentCardCommand.processCommand(e,t.id)}}),this.commandExecutor),this.commentCardEditorMounted=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return a.handleFocusRetry(e,{componentType:Re.a.CardEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Te.h(a.commentStore.getState()),1)}),this.commandExecutor),this.commentPostMounted=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return a.handleFocusRetry(e,{componentType:Re.a.Post,id:t,renderContextType:e.componentTreeId.renderContextType},Te.h(a.commentStore.getState()),1)}),this.commandExecutor),this.commentPostEditorMounted=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){return a.handleFocusRetry(e,{componentType:Re.a.PostEditor,id:t,renderContextType:e.componentTreeId.renderContextType},Te.h(a.commentStore.getState()),1)}),this.commandExecutor),this.commentPanePropsUpdated=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,n){var r=void 0;if(r=a.checkForRetryCommandOnPropsUpdated(e,n.draftState,!1))return r;var o=t.draftState,i=n.draftState,s=t.selectedComment,c=n.selectedComment;return(r=a.checkForDiscard(e,o,i,s,c))||(r=a.checkForHalfPaneFullTransition(e,t,n))?r:e.isFocusWithinPane()?(r=a.checkForLowFidelityWarning(e,s,c))||(r=a.checkForSelectionChange(e,i,s,c))||(r=a.checkForCardPendingChange(e,t.cardViewStates,n.cardViewStates,i))||(r=a.checkForReplyFinished(e,c,t.draftState,n.draftState,c&&n.cardViewStates[c.selectedCardId]))?r:a.checkForLowFidelityWarning(e,s,c):void 0}),this.commandExecutor),this.discreteCommentCardRootRefMounted=function(e){},this.discreteCommentCardPropsUpdated=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t,n){var r=void 0;return(r=a.checkForRetryCommandOnDiscreteCardPropsUpdated(e,n))||(r=a.checkForDiscard(e,t.draftState,n.draftState,t.selectedState,n.selectedState))?r:e.isFocusWithinAny(Re.a.Card)||e.isFocusWithinAny(Re.a.DraftCard)?a.shouldFocusFromCardPendingStateChange(t.cardState,n.cardState)?ke(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(Me.b)(n.isDraftThread),id:n.threadId}):(r=a.checkForLowFidelityWarning(e,t.selectedState,n.selectedState))||(r=a.checkForSelectionChange(e,n.draftState,t.selectedState,n.selectedState))||(r=a.checkForReplyFinished(e,n.selectedState,t.draftState,n.draftState,n.cardState))?r:a.checkForLowFidelityWarning(e,t.selectedState,n.selectedState):void 0}),this.commandExecutor),this.paneContainerKeyDown=ze((function(){return a.commentStore}),this.isRTL,(function(e){return!!Object(Pe.b)(e.componentTreeId.renderContextType)||(Object(d.i)().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)}),{Escape:{handler:function(e,t){return xe(e,pe.requestClosePane({renderContextType:t.componentTreeId.renderContextType,trackback:i.d.reserveTag(575239245),telemetryVisitor:a.telemetryVisitor}))},phase:me.a.Capturing},Tab:{handler:function(e,t){return a.paneContainerTabHandling(e,t)},phase:me.a.None}},this.commandExecutor),this.commentEditorKeyDown=ze((function(){return a.commentStore}),this.isRTL,(function(){return!0}),{F12:{handler:function(e,t){var n=e.altKey?a.handleMoveFocusEvent(e,t):void 0;return n&&(n.stopPropagation=!0),n},phase:me.a.None}},this.commandExecutor),this.onUserAction=qe((function(){return a.commentStore}),this.commandExecuteCallback,this.commandOnWillFocusCallback,(function(e,t){var n;switch(t.userAction){case Xe.a.RequestNewCommentFromHost:if(!Object(Pe.b)(e.componentTreeId.renderContextType))return;return Ge(e,a.commentStore);case Xe.a.CancelReplyDraft:return ke(void 0,{componentType:Re.a.Card,id:t.cardId,renderContextType:e.componentTreeId.renderContextType});case Xe.a.DeleteThread:case Xe.a.CancelNewThreadDraft:if(!Object(Pe.b)(e.componentTreeId.renderContextType))return;if(e.componentTreeId.renderContextType===De.a.HalfPane&&t.userAction===Xe.a.CancelNewThreadDraft)return;return null!==(n=Ge(e,a.commentStore,{priority:3,phase:0}))&&void 0!==n?n:a.selectionCommandFactory.focusAndSelectSiblingThread(e.componentTreeId.renderContextType,t.threadIndex);case Xe.a.ResolveThread:if("android"!==Object(je.a)()&&"ios"!==Object(je.a)())return;return ke(void 0,{componentType:Re.a.ReopenThreadButton,id:t.cardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Object(i.m)(t)}}),this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(e,t){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(t,500);this.pendingOnComponentFocusedRequest={callback:t,token:n,targetedComponent:e},fe.a&&Object(i.i)("Pending component focused request added for "+Object(Me.d)(e)+".")},e.prototype.initialize=function(e,t){if(this._commentStore)throw new w.a("FocusManager already initialized",i.d.reserveTag(575239239),-2130957489);this._commentStore=e,this.selectionCommandFactory=null!=t?t:new rt(e,this.telemetryVisitor)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new w.a("FocusManager not initialized",i.d.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(e){this.draftToFocus={draftId:e,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(e,t,n,r){var o;if(o=this.checkForRetryOfEditorFocus(e,n))return o;if(this.focusToRetry&&t&&this.shouldRetryFocusForPhase(this.focusToRetry,r)){var a=Date.now()-this.focusToRetry.timestamp;if(a>15e3)return Object(d.i)().assertConditionTag(!1,"Took too long to mount component for focus retry: "+a+" ms",575239241),void(this.focusToRetry=void 0);var i=this.focusToRetry.command.component;if(Object(Re.b)(i,t)){var s=this.focusToRetry.command;return this.focusToRetry=void 0,s}}},e.prototype.shouldArrowNavigatePosts=function(e,t,n){if(Object(Ee.a)(e.selectedCardId,t,n.componentTreeId.renderContextType)===Ie.a.Collapsed)return!1;if(e.selectedCardId===Object(he.F)(Te.h(this.commentStore.getState())))return!1;var r={componentType:Re.a.Post,id:Object(ye.b)(e),renderContextType:n.componentTreeId.renderContextType};return n.isFocusOnOrWithin(r)},e.prototype.onDownKey=function(e,t,n){if(Te.k(this.commentStore.getState())){var r=g.n()&&!Oe.a(this.commentStore.getState()),o=Te.r(this.commentStore.getState()),a=Te.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===De.a.DiscreteIsolated)return;var i={direction:E.d.Next,source:Ce.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,E.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectNextPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==De.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,t.componentTreeId.renderContextType,r);Object(d.i)().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249)}},e.prototype.onUpKey=function(e,t,n){if(Te.k(this.commentStore.getState())){var r=g.n()&&!Oe.a(this.commentStore.getState()),o=Te.r(this.commentStore.getState()),a=Te.j(this.commentStore.getState());if(o){if(!this.shouldArrowNavigatePosts(o,a,t)){if(t.componentTreeId.renderContextType===De.a.DiscreteIsolated)return;var i={direction:E.d.Previous,source:Ce.a.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(e,i,E.c.Keyboarding,t.componentTreeId.renderContextType,r)}return this.selectionCommandFactory.selectPreviousPostWithinCard(e,t.componentTreeId.renderContextType,n)}if(t.componentTreeId.renderContextType!==De.a.DiscreteIsolated)return this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,t.componentTreeId.renderContextType,r);Object(d.i)().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250)}},e.prototype.onRightKey=function(e,t){if(Te.k(this.commentStore.getState())){var n=Te.r(this.commentStore.getState());if(!g.mb()||!n||n.selectedCardId!==Object(he.F)(Te.h(this.commentStore.getState()))){var r=this.selectionCommandFactory.selectRootPostOfSelectedThread(e,t.componentTreeId.renderContextType);return r||(n&&Object(ye.j)(n.selectionDetails)&&t.isFocusOn({componentType:Re.a.Card,id:n.selectedCardId,renderContextType:t.componentTreeId.renderContextType})&&(r=this.focusCommentPostCommand.processCommand(t,n.selectionDetails.selectedPostId)),r||void 0)}}},e.prototype.onLeftKey=function(e,t){if(Te.k(this.commentStore.getState()))return this.selectionCommandFactory.focusAndCollapseSelectedThread(e,t)},e.prototype.onTabKeyInPane=function(e,t){return void 0===Te.r(this.commentStore.getState())&&Te.k(this.commentStore.getState())?this.selectionCommandFactory.selectFirstThreadInCurrentContext(e,!1,Ce.a.SharedComments,t,!1):g.mb()?void 0:this.checkForActiveEditorFocus(e,t,Te.h(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var e=Te.t(this.commentStore.getState());return e&&!e.isInCurrentContext},e.prototype.logEditorRetryError=function(e,t,n){var o,a,i;null===(a=(o=Object(d.i)()).logDiagnosticTrace)||void 0===a||a.call(o,Object(le.a)(Ye||(Ye=Object(r.__makeTemplateObject)(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),n,d.h.Info,d.c.ProductServiceUsage,this.telemetryVisitor,Object(d.l)("RenderContextType",t.componentTreeId.renderContextType,d.d.SystemMetadata),Object(d.l)("IsDraftInCurrentContext",!!e&&e.isInCurrentContext,d.d.SystemMetadata),Object(d.l)("DraftRenderContextType",null!==(i=null==e?void 0:e.renderContextType)&&void 0!==i?i:De.a.None,d.d.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(e,t){var n=this;if(void 0!==this.draftToFocus){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:_e.PreserveFocus,priorityArgs:{priority:1}};var o=t.drafts[this.draftToFocus.draftId],a=Date.now()-this.draftToFocus.timestamp;if(a>15e3)return Object(d.i)().assertConditionTag(!1,"Took too long to focus draft editor: "+a+" ms, expected draft still exists: "+!!o,575239251),this.draftToFocus=void 0,void this.logEditorRetryError(o,e,i.d.reserveTag(556607431));if(o&&o.renderContextType===e.componentTreeId.renderContextType){var s=this.checkForActiveEditorFocus(void 0,e.componentTreeId.renderContextType,t,{priority:3,phase:0});if(s&&Fe(e,s.component))return this.draftToFocus=Object(r.__assign)(Object(r.__assign)({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout((function(){return n.draftToFocus=void 0})),this.clearPendingOnComponentFocusedRequest(),s;this.logEditorRetryError(o,e,i.d.reserveTag(556794947))}else this.logEditorRetryError(o,e,i.d.reserveTag(556794945))}},e.prototype.checkForActiveEditorFocus=function(e,t,n,r){if(void 0===r&&(r={priority:1}),!this.isDraftInOtherContext()){var o=Object(he.I)(n);if(o)return ke(e,{componentType:Re.a.PostEditor,id:o,renderContextType:t},{priorityArgs:r});var a=Object(he.H)(n);return a?ke(e,{componentType:Re.a.CardEditor,id:a,renderContextType:t},{priorityArgs:r}):void 0}},e.prototype.handleMoveFocusEvent=function(e,t){var n=Te.r(this.commentStore.getState()),r=n?{contentId:null==n?void 0:n.selectedCardId,contentType:l.b.CommentThread}:void 0;return xe(e,pe.moveFocusToCanvas({renderContextType:t.componentTreeId.renderContextType,trackback:i.d.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},r))},e.prototype.checkForCommentSelectionFocus=function(e,t,n){if(g.mb()||!this.isDraftInOtherContext())return t&&t.selectedCardId?ke(void 0,{componentType:Object(Me.c)(t.selectedCardId,n),id:t.selectedCardId,renderContextType:e},{priorityArgs:{priority:2,phase:1}}):void 0},e.prototype.checkForDiscard=function(e,t,n,r,o){if("web"!==Object(je.a)()&&r&&o){var a=r.selectionDetails,i=o.selectionDetails;if(Object(ve.j)(t)&&!Object(ve.c)(n))return this.focusCommentCardCommand.processCommand(e,o.selectedCardId);if(Object(ye.j)(a)===Object(ye.j)(i)&&r.selectedCardId===o.selectedCardId&&Object(ve.m)(t,n)){if(!Object(ye.j)(a)||!Object(ye.j)(i))return ke(void 0,{componentType:Re.a.CardEditor,id:o.selectedCardId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(a.selectedPostId===i.selectedPostId)return ke(void 0,{componentType:Re.a.PostEditor,id:i.selectedPostId,renderContextType:e.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(e,t){if("win32"!==Object(je.a)()){var n=this.commentStore.getState(),r=Object(he.M)(Te.n(n),Te.w(n));if(!Object(ge.a)({commentData:Te.d(n),pendingCommentLoad:Te.o(n),virtualized:r}))return(d=ke(e,{componentType:Re.a.ClosePaneButton})).stopPropagation=!0,d.preventDefault=!0,d;var o=t.getComponent(Re.a.ClosePaneButton),a=t.getComponent(Re.a.NewCommentButton),i=!g.n()&&Object(ve.c)(Te.h(n))||!a?o:a;if(g.i()){var s=Te.r(n),c=Te.h(n),d=void 0;return s?g.mb()||t.isFocusWithin({componentType:Object(Me.c)(s.selectedCardId,c),id:s.selectedCardId,renderContextType:t.componentTreeId.renderContextType})||(d=this.checkForActiveEditorFocus(e,t.componentTreeId.renderContextType,c)):i&&e.isEventTarget(i)&&!e.shiftKey&&(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType)),d&&(d.stopPropagation=!0,d.preventDefault=!0),d}if(o&&e.isEventTarget(o)&&e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d;if(i&&e.isEventTarget(i)&&!e.shiftKey)return(d=this.onTabKeyInPane(e,t.componentTreeId.renderContextType))&&(d.preventDefault=!0,d.stopPropagation=!0),d}},e.prototype.checkForSelectionChange=function(e,t,n,r){if(r&&((!n||Object(ye.b)(n)!==Object(ye.b)(r)||Object(ye.j)(n.selectionDetails)!==Object(ye.j)(r.selectionDetails))&&(this.clearPendingOnComponentFocusedRequest(),(g.mb()||!Object(ve.d)(t))&&!e.isFocusOn({componentType:Re.a.NextCommentButton})&&!e.isFocusOn({componentType:Re.a.PreviousCommentButton})))){if(!Object(ye.j)(r.selectionDetails)){if(e.isFocusOnOrWithin({componentType:g.o()&&r.selectedCardId!==(null==n?void 0:n.selectedCardId)?Object(Me.c)(r.selectedCardId,t):Re.a.CardEditor,id:r.selectedCardId,renderContextType:e.componentTreeId.renderContextType},g.o()))return;return this.focusCommentCardCommand.processCommand(e,r.selectedCardId)}if(!e.isFocusOnOrWithin({componentType:Re.a.Post,id:r.selectionDetails.selectedPostId,renderContextType:e.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(e,r.selectionDetails.selectedPostId)}},e.prototype.checkForReplyFinished=function(e,t,n,r,o){var a=Object(he.H)(n),i=Object(he.H)(r);if(o&&o.pending!==be.a.Editor)return a&&!i&&(null==t?void 0:t.selectedCardId)===a&&e.isFocusWithin({componentType:Re.a.Card,id:a,renderContextType:e.componentTreeId.renderContextType})?this.focusCommentCardCommand.processCommand(e,a):void 0},e.prototype.checkForHalfPaneFullTransition=function(e,t,n){if(e.componentTreeId.renderContextType===De.a.HalfPane&&Object(o.j)(n.displayConfigurationState)&&n.displayConfigurationState.displayMode===o.e.Normal&&(!Object(o.j)(t.displayConfigurationState)||t.displayConfigurationState.displayMode===o.e.Variable))return ke(void 0,{componentType:Re.a.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(e,t){return!!e&&(e.pending!==t.pending&&t.pending!==be.a.Editor)},e.prototype.checkForCardPendingChange=function(e,t,n,r){var o=this,a=Object.entries(n).find((function(e){var n=t[e[0]];return o.shouldFocusFromCardPendingStateChange(n,e[1])}));if(a)return ke(void 0,{renderContextType:e.componentTreeId.renderContextType,componentType:Object(Me.c)(a[0],r),id:a[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(e,t,n){var r=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&Fe(e,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(e,r,t,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(e,t){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Object(Re.c)(this.focusToRetry.command.component)||!Object(Re.d)(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===t.threadId),r=this.draftToFocus&&(t.cardRelativeDraftingState===Se.a.InCard||t.cardRelativeDraftingState===Se.a.InChildPost);if(n||r)return this.checkForRetryCommandOnPropsUpdated(e,t.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(e,t,n){if(n&&(g.i()?Object(ye.h)(n):Object(ye.g)(n))){var r=t?Object(ye.b)(t):void 0,o=Object(ye.b)(n);if(o!==r||n.selectionDetails.lowFidelityWarningType!==(null==t?void 0:t.selectionDetails.lowFidelityWarningType))return ke(void 0,{componentType:Re.a.Post,renderContextType:e.componentTreeId.renderContextType,id:o})}},e.prototype.shouldRetryFocusForPhase=function(e,t){return 1!==e.command.priorityArgs.priority&&0!=(e.command.priorityArgs.phase&t)},e}(),at=n(149),it=n(568),st=function(){return function(e){return function(t){return Object(O.unstable_batchedUpdates)((function(){return e(t)}))}}},ct=function(){return function(e){return function(t){var n="string"==typeof t.type?t.type:t.name||"Unknown Action",r=Object(i.k)(i.b.Redux,n),o=e(t);return null==r||r.end(),o}}},dt=n(346),ut=n(129),lt=n(107),mt=n(405),ft=n(164),pt=n(326);!function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.UIAAnnotationPattern=256]="UIAAnnotationPattern"}(Ke||(Ke={}));var Ct=n(296),gt=n(390),ht=n(627),bt=n(202),vt=n(261),yt=n(281);function Tt(e,t,n,o){if(g.b()){var a=Object(r.__assign)({},e),i=(Object(vt.a)(t),Object(r.__assign)({},t)),s=!1,c=!1,u=!1;if(n.changes.forEach((function(n){var l,m,f,p,C,g,h,b;if(n.type!==ut.d.Unknown){var v=n.model.commentId;switch(n.type){case ut.d.Delete:if(delete a[v],void 0!==e[v])if(Object.keys(e).includes(v)){if(Object(vt.a)(i)){var y=e[v].id;delete i[y]}else try{for(var T=Object(r.__values)(e[v].history),O=T.next();!O.done;O=T.next()){var I=O.value;try{for(var S=(f=void 0,Object(r.__values)(I.records)),_=S.next();!_.done;_=S.next()){var D=_.value;delete i[D.recordId]}}catch(e){f={error:e}}finally{try{_&&!_.done&&(p=S.return)&&p.call(S)}finally{if(f)throw f.error}}}}catch(e){l={error:e}}finally{try{O&&!O.done&&(m=T.return)&&m.call(T)}finally{if(l)throw l.error}}c=!0}break;case ut.d.Load:case ut.d.Insert:case ut.d.Modify:Object(d.i)().assertConditionTag(n.type===ut.d.Modify||!a[n.model.commentId],"Task should not already be populated on initial load",554836097);var E=n.task;if(E){if(!function(e){return 0===e.history.length||e.history[0].records.length>0&&e.history[0].records[0].type===yt.a.Create}(E))return void Object(d.i)().assertConditionTag(!1,"Invalid task payload - dropping task data",554836098);0===E.history.length?u=!0:Object(vt.a)(i)&&(i[E.id]=i[E.id]?Object(r.__assign)({},i[E.id]):{});try{for(var j=Object(r.__values)(E.history),P=j.next();!P.done;P=j.next()){I=P.value;try{for(var x=(h=void 0,Object(r.__values)(I.records)),A=x.next();!A.done;A=x.next()){D=A.value;Object(vt.a)(t)&&Object(vt.a)(i)?t[E.id]&&t[E.id][D.recordId]||(s=!0,i[E.id][D.recordId]=Object(he.s)(Object(he.n)(D.time,void 0,o.dataCulture))):t[D.recordId]||(s=!0,i[D.recordId]=Object(he.s)(Object(he.n)(D.time,void 0,o.dataCulture)))}}catch(e){h={error:e}}finally{try{A&&!A.done&&(b=x.return)&&b.call(x)}finally{if(h)throw h.error}}}}catch(e){C={error:e}}finally{try{P&&!P.done&&(g=j.return)&&g.call(j)}finally{if(C)throw C.error}}a[v]=E}else if(""===n.model.parentId&&a[v]){var k=a[v];Object(vt.a)(i)?delete i[k.id]:k.history.forEach((function(e){return e.records.forEach((function(e){return delete i[e.recordId]}))})),delete a[v],c=!0}}}else Object(d.i)().assertConditionTag(!1,"Unknown change type",554836096)})),c||s||u)return{updatedTasks:a,updatedHistoryRecordViewState:i}}}function Ot(e){if(e){var t={};if(void 0!==e.isReadOnly&&(t.isReadOnly=e.isReadOnly),void 0!==e.nextPopulatedContextDetails&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),void 0!==e.commentThreadCounts&&(t.commentThreadCounts=e.commentThreadCounts||void 0),Object.keys(t).length)return t}}var It=n(146),St=n(263),_t=n(485),Dt=n(350),Et=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e[n]);return t};function jt(e){return At(Object(Re.c)(e)?Object(Me.a)(e):Object(Me.e)(e.componentType))}function Pt(e){var t=document.activeElement;return!!e&&t===e}function xt(e,t,n){var r=document.activeElement,o=t!==Re.a.CardEditor&&t!==Re.a.PostEditor&&!n;return!!e&&(r&&e.contains(r)||o&&function(e){return e===document.body||null===e||0===Object.keys(e).length}(r))}function At(e){var t=document.getElementById(e);return null!=t?t:void 0}var kt=function(){function e(e,t,n){this.componentTreeId={renderContextType:e,contextIdentifier:t}}return e.prototype.getComponent=function(e){return At(Object(Me.e)(e))},e.prototype.getComponentById=function(e){return At(Object(Me.a)(e))},e.prototype.isEventTarget=function(e,t){return e===t},e.prototype.isFocusOn=function(e){return Pt(jt(e))},e.prototype.isFocusWithin=function(e){return xt(jt(e),e.componentType)},e.prototype.isFocusOnOrWithin=function(e,t){var n=jt(e);return Pt(n)||xt(n,e.componentType,t)},e.prototype.isFocusWithinAny=function(e){var t=void 0;switch(e){case Re.a.Card:t=Et(document.querySelectorAll("[id*='"+I.h({id:"",renderContextType:this.componentTreeId.renderContextType},!1)+"']"));break;case Re.a.DraftCard:t=Et(document.querySelectorAll("[id*='"+I.h({id:"",renderContextType:this.componentTreeId.renderContextType},!0)+"']"));break;case Re.a.PostEditor:t=Et(document.querySelectorAll("[id*='"+I.v(I.G({id:"",renderContextType:this.componentTreeId.renderContextType}))+"']"));break;case Re.a.CardEditor:t=Et(document.querySelectorAll("[id*='"+I.v(I.e({id:"",renderContextType:this.componentTreeId.renderContextType}))+"']"));break;case Re.a.Post:t=Et(document.querySelectorAll("[id*='"+I.I({id:"",renderContextType:this.componentTreeId.renderContextType})+"']"))}if(t)for(var n=0;n<t.length;++n){if(xt(t[n],e))return!0}return!1},e.prototype.isFocusWithinPane=function(){return xt(document.getElementById(I.y()),Re.a.PaneRoot)},e.prototype.getCurrentlyFocused=function(){return this.isFocusWithinPane()?[document.activeElement]:[]},e}();function Rt(e,t){switch(void 0===e&&(e={extensions:{}}),void 0===t&&(t=pe.EMPTY_ACTION),t.type){case"ADD_CONTENT_EXTENSION":return function(e,t){var n;Object(d.i)().assertConditionTag(void 0===e[t.payload.extension.provider.scope.renderMode],"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var o=t.payload.extension;return Object(r.__assign)(Object(r.__assign)({},e),{extensions:Object(r.__assign)(Object(r.__assign)({},e.extensions),(n={},n[t.payload.extension.provider.scope.renderMode]={controller:o,priority:o.priority},n))})}(e,t);case"REMOVE_CONTENT_EXTENSION":return function(e,t){var n,o,a=Object(r.__assign)({},e.extensions);try{for(var i=Object(r.__values)(t.payload.renderModes),s=i.next();!s.done;s=i.next()){var c=s.value;delete a[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{extensions:a})}(e,t);case"UPDATE_EXTENSION_PRIORITY":return function(e,t){var n=Object(r.__assign)({},e.extensions);for(var o in t.payload.updates)n[o]&&(n[o]=Object(r.__assign)(Object(r.__assign)({},n[o]),{priority:t.payload.updates[o]}));return Object(r.__assign)(Object(r.__assign)({},e),{extensions:n})}(e,t);default:return e}}function wt(e){return{commentData:[],cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Le.a.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,virtualized:!1,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Object(ve.h)(),atMentionState_deprecated:{capability:_t.a.Unknown},capabilities_deprecated:{resolve:!0},modelCapabilities:Object(he.r)(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}}}function Nt(e,t,n,r){return function(e,t,n,r){return{paneState:{viewContainer:e,componentTree:new kt(Object(Ct.a)(e.containerType),r),visibilityState:t?V.a.Visible:V.a.Closed,initializationStatus:Dt.a.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:{extensions:{}},commentState:wt(n)}}(e,t,n,r)}var Mt={isRightToLeft:!1,dataCulture:"",uiCulture:""};function Ft(e,t){void 0===e&&(e=wt(Mt)),void 0===t&&(t=dt.a);var n=function(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return function(e,t){var n=he.P(t.payload.commentId);if(n===e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:n})}(e,t);case"APPLY_COMMENT_CHANGES":return function(e,t){var n,o,a,s,c;if(!t.payload.changes.length)return e;var u,l={commentData:Object(r.__spread)(e.commentData),cardViewState:Object(r.__assign)({},e.cardViewState),postViewState:Object(r.__assign)({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},m=e.createdCommentLie,f=!!he.F(e.draftState,!0),p=null==m?void 0:m.index;try{for(var C=Object(r.__values)(t.payload.changes),h=C.next();!h.done;h=C.next())if((u=h.value).type===lt.b.Load&&(u=void 0!==l.postViewState[u.model.commentId]?Object(r.__assign)(Object(r.__assign)({},u),{type:lt.b.Modify}):Object(r.__assign)(Object(r.__assign)({},u),{type:lt.b.Insert})),u.type===lt.b.Insert){if((v=u.model.parentId)&&(l.cardViewState[v]=Object(r.__assign)(Object(r.__assign)({},l.cardViewState[v]),{pending:be.a.None})),l.commentData.splice(u.index,0,u.model),u.tempId){if(!v)(b={})[u.model.commentId]=he.j(u.tempId),l.cardViewState=Object(r.__assign)(Object(r.__assign)({},he.T(l.cardViewState,[u.tempId])),b);l.postViewState=Object(r.__assign)(Object(r.__assign)({},he.U(l.postViewState,[u.tempId])),he.x([u.model],l.expandedComments,e.localizationDetails)),l.draftState.committedLieId===u.tempId&&(l.draftState=Object(r.__assign)(Object(r.__assign)({},l.draftState),{committedLieId:void 0}),p=void 0),l.selectedComment&&l.selectedComment.selectedCardId===u.tempId&&(l.selectedComment=he.m(Object(Je.b)(u.model)),u.model.parentId||(l.expandedComments=he.a(l.expandedComments,l.selectedComment,l.draftState)))}else{var b;Object(d.i)().assertConditionTag(!l.postViewState[u.model.commentId],"Received insert for existing comment "+u.model.commentId,594122589),(b={})[u.model.commentId]=he.j(void 0),l.cardViewState=Object(r.__assign)(Object(r.__assign)({},l.cardViewState),b),l.postViewState=Object(r.__assign)(Object(r.__assign)({},l.postViewState),he.x([u.model],l.expandedComments,e.localizationDetails))}f&&void 0!==p&&u.index<=p&&p++}else if(u.type===lt.b.Modify){if((O=l.commentData[u.index]).commentId===u.model.commentId){l.commentData[u.index]=u.model;var v=Object(Je.b)(u.model);l.cardViewState[v]=Object(r.__assign)(Object(r.__assign)({},l.cardViewState[v]),{pending:be.a.None,loadState:{state:It.a.Loaded}});var y=O.displayDate===u.model.displayDate&&O.date===u.model.date?l.postViewState[u.model.commentId].displayDate:he.n(u.model.date,u.model.displayDate,e.localizationDetails.dataCulture);if(l.postViewState=Object(r.__assign)(Object(r.__assign)({},l.postViewState),((a={})[u.model.commentId]=Object(r.__assign)(Object(r.__assign)({},l.postViewState[u.model.commentId]),{pending:St.a.None,displayDate:y}),a)),u.model.commentFlags&et.a.Resolved&&!(O.commentFlags&et.a.Resolved)){var T=l.draftState;l.selectedComment&&l.selectedComment.selectedCardId===u.model.commentId&&(l.selectedComment=he.m(l.selectedComment.selectedCardId)),l.draftState=he.S(l.draftState,u.model.commentId,l.commentData),g.Q()?Object(bt.c)(T,l.draftState,1,2,i.d.reserveTag(539297114)):Object(bt.d)(T,l.draftState,1,2),l.expandedComments=he.W(u.model.commentId,l.expandedComments,l.draftState,l.selectedComment)}}else Object(d.i)().assertConditionTag(!1,"Found changeIndex mismatch",593762526),Object(i.i)("changeIndex did not match comment for "+u.model.commentId)}else if(u.type===lt.b.Delete){var O;if((O=l.commentData[u.index]).commentId===u.model.commentId&&l.commentData.splice(u.index,1),l.highlightedCommentId===u.model.commentId&&(l.highlightedCommentId=void 0),l.topVisibleThreadId===u.model.commentId&&(l.topVisibleThreadId=void 0),l.cardViewState=Object(r.__assign)({},he.T(l.cardViewState,[u.model.commentId])),l.postViewState=Object(r.__assign)({},he.U(l.postViewState,[u.model.commentId])),u.model.commentId===l.selectedThreadIdBeforeCommentSession){var I=u.index;l.commentData.length?(I>=l.commentData.length&&(I=l.commentData.length-1),l.selectedThreadIdBeforeCommentSession=Object(Je.b)(l.commentData[I])):l.selectedThreadIdBeforeCommentSession=void 0}f&&void 0!==p&&u.index<p&&p--}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=C.return)&&o.call(C)}finally{if(n)throw n.error}}f&&(void 0===p?m=void 0:m&&p!==m.index&&(m=Object(r.__assign)(Object(r.__assign)({},m),{index:p})));l.draftState=he.db(l.draftState,e.cardViewState,l.cardViewState,e.postViewState,l.postViewState,2,2),l.selectedComment&&!Object(ve.l)(l.draftState)&&(l.cardViewState[l.selectedComment.selectedCardId]?Object(ye.j)(l.selectedComment.selectionDetails)&&!l.postViewState[l.selectedComment.selectionDetails.selectedPostId]&&(l.selectedComment=he.m(l.selectedComment.selectedCardId)):l.selectedComment=void 0);var S=Tt(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:m,draftState:l.draftState,selectedComment:l.selectedComment,expandedComments:he.X(l.expandedComments,l.cardViewState,l.draftState),commentData:l.commentData,cardViewState:l.cardViewState,postViewState:l.postViewState,highlightedCommentId:l.highlightedCommentId,topVisibleThreadId:l.topVisibleThreadId,selectedThreadIdBeforeCommentSession:l.selectedThreadIdBeforeCommentSession,tasks:null!==(s=null==S?void 0:S.updatedTasks)&&void 0!==s?s:e.tasks,historyRecordViewState:null!==(c=null==S?void 0:S.updatedHistoryRecordViewState)&&void 0!==c?c:e.historyRecordViewState})}(e,t);case"LOAD_COMMENT":return function(e,t){var n,o,a,i,s,c,d,u=Object(r.__spread)(e.commentData,t.payload.commentData),l=he.M(e.modelCapabilities,e.virtualized),m=he.Q(e,u,l),f=m.pendingCommentLoad,p=m.selectedComment,C=m.expandedComments;d=he.k(t.payload.commentData,l?It.a.Placeholder:It.a.Loaded);var h={},b={};if(g.b()&&t.payload.tasks)try{for(var v=Object(r.__values)(t.payload.tasks),y=v.next();!y.done;y=v.next()){var T=y.value;Object(vt.a)(b)&&0!==T.history.length&&(b[T.id]={});try{for(var O=(a=void 0,Object(r.__values)(T.history)),I=O.next();!I.done;I=O.next()){var S=I.value;try{for(var _=(s=void 0,Object(r.__values)(S.records)),D=_.next();!D.done;D=_.next()){var E=D.value;Object(vt.a)(b)?b[T.id][E.recordId]=he.s(he.n(E.time,void 0,e.localizationDetails.dataCulture)):b[E.recordId]=he.s(he.n(E.time,void 0,e.localizationDetails.dataCulture))}}catch(e){s={error:e}}finally{try{D&&!D.done&&(c=_.return)&&c.call(_)}finally{if(s)throw s.error}}}}catch(e){a={error:e}}finally{try{I&&!I.done&&(i=O.return)&&i.call(O)}finally{if(a)throw a.error}}h[T.commentId]=T}}catch(e){n={error:e}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}return Object(r.__assign)(Object(r.__assign)({},e),{commentData:u,pendingCommentLoad:f,selectedComment:p,expandedComments:C,localizationDetails:e.localizationDetails,cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),d),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),he.x(t.payload.commentData,C,e.localizationDetails)),tasks:h,historyRecordViewState:b})}(e,t);case"VIRTUALIZE_COMMENTS":return function(e,t){var n=Object(gt.c)(t.payload.threadInfo.map((function(e){return e.threadId}))),o=Object(r.__spread)(e.commentData,n);if(!he.M(e.modelCapabilities,e.virtualized))throw new w.a("virtualizeCommentsReducer requires virtualization",i.d.reserveTag(589103643),-2130957500);var a=he.Q(e,o,!0),s=a.pendingCommentLoad,c=a.selectedComment,d=a.expandedComments;return Object(r.__assign)(Object(r.__assign)({},e),{commentData:o,pendingCommentLoad:s,selectedComment:c,expandedComments:d,cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),he.L(t.payload.threadInfo)),postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),he.x(n,d,e.localizationDetails)),localizationDetails:e.localizationDetails})}(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return function(e,t){var n;if(!Object(ve.c)(e.draftState))return e;var o=he.F(e.draftState);if(!o)return e;var a,i=he.T(e.cardViewState,[o]),s=he.U(e.postViewState,[o]),c=!g.gb();(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)!==o?a=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(a={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},c=!0);var d=he.V(e.draftState,o);return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:void 0,selectedComment:a,expandedComments:a&&c?he.a(e.expandedComments,a,d):he.R(e.expandedComments,a,d),cardViewState:i,postViewState:s,selectedThreadIdBeforeCommentSession:void 0,draftState:d})}(e);case"CANCEL_COMMENT_POST_EDIT":return function(e,t){var n=he.z(e,t.payload.commentId),o=he.ab(e.draftState,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:he.R(e.expandedComments,n,o),selectedThreadIdBeforeCommentSession:void 0,draftState:o})}(e,t);case"CANCEL_COMMENT_REPLY":return function(e,t){var n=he.V(e.draftState,t.payload.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{expandedComments:he.R(e.expandedComments,e.selectedComment,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}(e,t);case"COLLAPSE_CARD":return function(e,t){var n=he.J(e.draftState);if((null==n?void 0:n.threadId)===t.payload.cardId)return e;var o=he.C(t.payload.cardId,e.selectedComment,e.draftState);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:o,expandedComments:he.W(t.payload.cardId,e.expandedComments,e.draftState,o)})}(e,t);case"SELECT_COMMENT":return function(e,t){var n=!1,o=e.selectedComment;if(!he.bb(e.draftState,o,t))return e;if(!t.payload.selectedCard)throw new w.a($.d,i.d.reserveTag(589103644),-2130957536);var a=void 0,s=he.fb(e.selectedComment,t);if(!g.gb()){e.commentData.filter((function(e){return Object(Je.b)(e)===s.selectedCardId})).forEach((function(t){e.postViewState[t.commentId].displayDate||(a||(a=Object(r.__assign)({},e.postViewState)),a[t.commentId]={displayDate:e.postViewState[t.commentId].displayDate||he.n(t.date,t.displayDate,e.localizationDetails.dataCulture),displayingErrorUI:e.postViewState[t.commentId].displayingErrorUI,pending:St.a.None},n=!0)}))}var c=Object(pe.shouldSelectActionExpandCard)(t.payload.selectType)?he.a(e.expandedComments,s,e.draftState):he.R(e.expandedComments,s,e.draftState);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:s,expandedComments:c,postViewState:g.gb()?e.postViewState:n&&a?a:e.postViewState})}(e,t);case"REQUEST_THREAD_RESOLVE":return function(e,t){var n;return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:Object(r.__assign)(Object(r.__assign)({},e.cardViewState),(n={},n[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Card,loadState:{state:It.a.Loaded}}),n)),selectedComment:he.A(e.selectedComment,t)})}(e,t);case"RELOAD_COMMENTS":return function(e,t){var n,o,a,s,c={},u={},l=e.selectedComment,m=e.expandedComments,f=l&&Object(ye.j)(l.selectionDetails),p=!1,C=!1,h=!1,b=e.selectedThreadIdBeforeCommentSession,v=e.draftState,y=he.M(e.modelCapabilities,e.virtualized),T=null===(n=he.J(v))||void 0===n?void 0:n.threadId,O={};e.commentData.forEach((function(e){O[e.commentId]=e}));var I=!1,S=!1;t.payload.comments.forEach((function(n){if(n.commentId===e.highlightedCommentId&&(I=!0),n.commentId===e.topVisibleThreadId&&(S=!0),l&&(n.commentId===l.selectedCardId&&(C=!0),l.selectedCardId===Object(Je.b)(n)&&Object(ye.j)(l.selectionDetails)&&l.selectionDetails.selectedPostId===n.commentId&&(p=!0)),n.commentId in O){if(""===n.parentId){e.cardViewState[n.commentId]&&Object(d.i)().assertConditionTag(e.cardViewState[n.commentId].pending!==be.a.Delete,"Card pending delete remained after a reload.",593762527);var o=e.cardViewState[n.commentId];if(!o||o.pending!==be.a.None||y){var a=null==o?void 0:o.loadState;u[n.commentId]=Object(r.__assign)(Object(r.__assign)({},o),{pending:be.a.None,loadState:a&&a.state===It.a.Placeholder?{state:It.a.Placeholder,initialItemCount:a.initialItemCount}:{state:It.a.NeedsReload}})}else u[n.commentId]=o}if(e.postViewState[n.commentId]&&Object(d.i)().assertConditionTag(e.postViewState[n.commentId].pending!==St.a.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[n.commentId]&&e.postViewState[n.commentId].pending===St.a.None?c[n.commentId]=e.postViewState[n.commentId]:c[n.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[n.commentId]),{pending:St.a.None}),n.commentFlags&et.a.Resolved&&(!O[n.commentId]||!(O[n.commentId].commentFlags&et.a.Resolved))){if(l&&l.selectedCardId===n.commentId&&(l=he.m(l.selectedCardId)),n.commentId===T){var s=v;v=he.S(v,n.commentId,t.payload.comments),g.Q()?Object(bt.c)(s,v,1,1,i.d.reserveTag(539297115)):Object(bt.d)(s,v,1,1)}m=he.W(n.commentId,m,v,l)}b&&b===n.commentId&&(h=!0)}else{if(""===n.parentId){var f=n.commentId,_=y?{state:It.a.Placeholder,initialItemCount:1}:{state:It.a.Loaded};u[n.commentId]=he.u(f,_)}c[n.commentId]=he.l(g.gb()&&m.includes(Object(Je.b)(n))?he.n(n.date,n.displayDate,e.localizationDetails.dataCulture):n.displayDate)}})),s=he.b(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),v=Object(r.__assign)(Object(r.__assign)({},v),{committedLieId:void 0});var _=he.F(v);_&&(l&&_===l.selectedCardId&&(C=!0),u[_]=e.cardViewState[_],c[_]=e.postViewState[_]);v=he.db(v,e.cardViewState,u,e.postViewState,c,1,1),Object(ve.l)(v)||(C?f&&!p&&l&&!y&&(l={selectedCardId:l.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):l=void 0);if(!h&&b){var D=e.commentData.findIndex((function(e){return e.commentId===b}));if(D<0&&(Object(d.i)().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),D=0),t.payload.comments.length){D>=t.payload.comments.length&&(D=t.payload.comments.length-1);var E=t.payload.comments[D];b=Object(Je.b)(E)}else b=void 0}var j=function(e,t,n,o){var a,i,s,c,d,u,l,m,f;if(g.b()&&n.tasks){var p=!1,C=!1,h=!1,b={},v={},y=new Set,T=Object.keys(e);n.comments.forEach((function(e){""===e.parentId&&y.add(e.commentId)}));try{for(var O=Object(r.__values)(T),I=O.next();!I.done;I=O.next()){var S=I.value;if(!y.has(S)){C=!0;break}}}catch(e){a={error:e}}finally{try{I&&!I.done&&(i=O.return)&&i.call(O)}finally{if(a)throw a.error}}T.length!==(null===(f=n.tasks)||void 0===f?void 0:f.length)&&(C=!0);try{for(var _=Object(r.__values)(n.tasks),D=_.next();!D.done;D=_.next()){var E=D.value;0===E.history.length?h=!0:Object(vt.a)(v)&&(v[E.id]={});try{for(var j=(d=void 0,Object(r.__values)(E.history)),P=j.next();!P.done;P=j.next()){var x=P.value;try{for(var A=(l=void 0,Object(r.__values)(x.records)),k=A.next();!k.done;k=A.next()){var R=k.value;Object(vt.a)(t)&&Object(vt.a)(v)?t[E.id]&&t[E.id][R.recordId]?v[E.id][R.recordId]=t[E.id][R.recordId]:(p=!0,v[E.id][R.recordId]=Object(he.s)(Object(he.n)(R.time,void 0,o.dataCulture))):t[R.recordId]?v[R.recordId]=t[R.recordId]:(p=!0,v[R.recordId]=Object(he.s)(Object(he.n)(R.time,void 0,o.dataCulture)))}}catch(e){l={error:e}}finally{try{k&&!k.done&&(m=A.return)&&m.call(A)}finally{if(l)throw l.error}}}}catch(e){d={error:e}}finally{try{P&&!P.done&&(u=j.return)&&u.call(j)}finally{if(d)throw d.error}}b[E.commentId]=E}}catch(e){s={error:e}}finally{try{D&&!D.done&&(c=_.return)&&c.call(_)}finally{if(s)throw s.error}}if(C||p||h)return{updatedTasks:b,updatedHistoryRecordViewState:v}}}(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return Object(r.__assign)(Object(r.__assign)({},e),{draftState:v,commentData:Object(r.__spread)(t.payload.comments),cardViewState:u,postViewState:c,selectedComment:l,expandedComments:he.X(m,u,v),pendingCommentLoad:void 0,highlightedCommentId:I?e.highlightedCommentId:void 0,topVisibleThreadId:S?e.topVisibleThreadId:void 0,createdCommentLie:s,selectedThreadIdBeforeCommentSession:b,tasks:null!==(o=null==j?void 0:j.updatedTasks)&&void 0!==o?o:e.tasks,historyRecordViewState:null!==(a=null==j?void 0:j.updatedHistoryRecordViewState)&&void 0!==a?a:e.historyRecordViewState})}(e,t);case"REQUEST_REOPEN_THREAD":return function(e,t){var n,o=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Card}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:o})}(e,t);case"REQUEST_DELETE_POST":return function(e,t){var n,o=Object(r.__assign)(Object(r.__assign)({},e.postViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{pending:St.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:o})}(e,t);case"REQUEST_DELETE_THREAD":return function(e,t){var n,o=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.payload.commentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.payload.commentId]),{pending:be.a.Delete}),n));return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:o})}(e,t);case"DISPATCH_LOAD_THREADS":return function(e,t){var n=Object(r.__assign)({},e.cardViewState);return t.payload.threadIds.forEach((function(e){var t=n[e].loadState;n[e]=Object(r.__assign)(Object(r.__assign)({},n[e]),{loadState:t.state===It.a.Placeholder?{state:It.a.Loading,initialItemCount:t.initialItemCount}:{state:It.a.Loading}})})),Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:n})}(e,t);case"BEGIN_DRAFTING_SUCCESS":return function(e,t){var n,o,a,s,c;if(he.G(e.draftState))throw new w.a("Draft already active!",i.d.reserveTag(589103640),-2130957551);var u=e.selectedThreadIdBeforeCommentSession,l=t.payload.draftDetails;switch(l.sessionConfiguration.sessionType){case"CREATE":var m=Object(r.__assign)(Object(r.__assign)({},he.e(l.sessionConfiguration.draftId)),{author:l.author,anchorHintText:l.anchorHintText}),f=he.B(e.commentData,l),p=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[l.sessionConfiguration.draftId]={commentDraft:l,isDraftEmpty:!0,isInCurrentContext:!0,pendingState:ve.a.None,renderContextType:t.payload.draftRenderContextType,threadId:l.sessionConfiguration.draftId},n)),cardIdToDraftIdMap:Object(r.__assign)(Object(r.__assign)({},e.draftState.cardIdToDraftIdMap),(o={},o[l.sessionConfiguration.draftId]=l.sessionConfiguration.draftId,o)),pendingDraft:void 0});return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:{index:l.insertIndex,newComment:m},cardViewState:Object(r.__assign)(Object(r.__assign)({},he.T(e.cardViewState,[Object(I.x)()])),he.o(m)),postViewState:Object(r.__assign)(Object(r.__assign)({},he.U(e.postViewState,[Object(I.x)()])),he.p(m)),selectedComment:f,expandedComments:he.a(e.expandedComments,f,p),selectedThreadIdBeforeCommentSession:u,draftState:p});case"EDIT":case"REPLY":if(!Object(pt.b)(l.sessionConfiguration)&&!Object(pt.c)(l.sessionConfiguration))throw Object(d.i)().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new w.a($.c,i.d.reserveTag(589103642),-2130957532);var C=void 0;C=!e.selectedComment||Object(pt.c)(l.sessionConfiguration)&&l.sessionConfiguration.threadId!==e.selectedComment.selectedCardId||ft.e(l.sessionConfiguration)&&(!Object(ye.j)(e.selectedComment.selectionDetails)||l.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId)?he.B(e.commentData,l):Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})});var g=e.draftState.cardIdToDraftIdMap,h=e.draftState.postIdToDraftIdMap,b="",v=!1,y=!1;if(ft.f(l.sessionConfiguration))g=Object(r.__assign)(Object(r.__assign)({},g),((a={})[l.sessionConfiguration.threadId]=l.sessionConfiguration.draftId,a)),b=l.sessionConfiguration.threadId,y=!0;else if(ft.e(l.sessionConfiguration)){var T=l.sessionConfiguration.commentId;h=Object(r.__assign)(Object(r.__assign)({},h),((s={})[T]=l.sessionConfiguration.draftId,s)),v=!0,e.commentData.some((function(e){if(e.commentId===T){var t=Object(ht.d)(e.commentBody);return y=0===t.length||"web"===Object(je.a)()&&"\n"===t,b=Object(Je.b)(e),!0}return!1}))}else Object(i.m)(l.sessionConfiguration);var O=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(c={},c[l.sessionConfiguration.draftId]={commentDraft:l,isDraftEmpty:y,isInCurrentContext:!0,pendingState:ve.a.None,renderContextType:t.payload.draftRenderContextType,threadId:b},c)),cardIdToDraftIdMap:g,postIdToDraftIdMap:h,pendingDraft:void 0}),S=he.T(e.cardViewState,[Object(I.x)()]),_=he.U(e.postViewState,[Object(I.x)()]);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:C,expandedComments:v?he.a(e.expandedComments,C,O):he.R(e.expandedComments,C,O),selectedThreadIdBeforeCommentSession:u,draftState:O,cardViewState:S,postViewState:_,createdCommentLie:void 0});default:return e}}(e,t);case"BEGIN_DRAFTING_FAILURE":return function(e,t){if(void 0===e.selectedComment)return Object(d.i)().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var n=void 0;"CREATE"!==t.payload.beginDraftingParams.sessionType?n=Object(r.__assign)(Object(r.__assign)({},e.selectedComment),{selectionDetails:Object(r.__assign)(Object(r.__assign)({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(n={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var o=he.T(e.cardViewState,[Object(I.x)()]),a=he.U(e.postViewState,[Object(I.x)()]),i=Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:void 0});return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:he.R(e.expandedComments,n,i),selectedThreadIdBeforeCommentSession:void 0,cardViewState:o,postViewState:a,createdCommentLie:void 0,draftState:i})}(e,t);case"SESSION_REQUEST_STARTED":return function(e,t){var n,o=void 0,a=e.cardViewState,i=e.postViewState;if(e.createdCommentLie)return Object(d.i)().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(ft.f(t.payload.params))n=t.payload.params.threadId;else if(ft.e(t.payload.params)){var s=t.payload.params.commentId,c=e.commentData.find((function(e){return e.commentId===s}));if(!c)return Object(d.i)().assertConditionTag(!1,"Could not lock selection on missing comment "+s,593764357),e;n=Object(Je.b)(c)}else{n=Object(I.x)();var u=he.e(n);o={index:-1,newComment:u},a[n]&&Object(d.i)().assertConditionTag(!1,"Unexpectedly already found card view state for lie when starting session request",593764358),a=Object(r.__assign)(Object(r.__assign)({},a),he.o(u)),i[n]&&Object(d.i)().assertConditionTag(!1,"Unexpectedly already found post view state for lie when starting session request",593764359),i=Object(r.__assign)(Object(r.__assign)({},i),he.p(u))}var l=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(l=e.selectedComment.selectedCardId);var m=Object(r.__assign)(Object(r.__assign)({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),f=he.E(e.selectedComment,t,n),p=Object(ye.j)(f.selectionDetails)||f.selectedCardId===Object(I.x)()?he.a(e.expandedComments,f,m):e.expandedComments;return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:i,cardViewState:a,selectedThreadIdBeforeCommentSession:l,selectedComment:f,expandedComments:p,draftState:m,createdCommentLie:o})}(e,t);case"COMMENT_CONTEXT_CHANGED":return function(e,t){var n,o=Object(ve.h)(),a={},s={},c=void 0,u=void 0,l=void 0,m=he.F(e.draftState),f=!!e.createdCommentLie;n=t.payload.contextDetails?Object(r.__assign)(Object(r.__assign)({},Ot(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):{nextPopulatedContextDetails:Le.a.Unknown,isReadOnly:g.D()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var p=t.payload.contextDrafts;if(p){var C=he.Y(e.draftState);if(Object(ve.e)(C)>0){var h={},b=void 0,v=void 0,y=!g.mb();if(Object(ve.f)(C).forEach((function(t){var n,o=p.find((function(e){return e.draftId===t}));h[t]=Object(r.__assign)(Object(r.__assign)({},C.drafts[t]),{isInCurrentContext:!!o}),m===t&&(f=!!o,o&&(b=o.insertIndex,v=o.anchorHintText)),!y&&o&&h[t].threadId===(null===(n=e.selectedComment)||void 0===n?void 0:n.selectedCardId)&&(y=!0)})),o=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:h}),u=e.createdCommentLie,y&&(c=e.selectedComment),u&&m&&f){Object(d.i)().assertConditionTag(void 0!==b,"Index unknown for lie in latest context",587309136);var T=null!=b?b:0;T!==u.index&&(u=Object(r.__assign)(Object(r.__assign)({},u),{index:T})),void 0!==v&&v!==u.newComment.anchorHintText&&(u=Object(r.__assign)(Object(r.__assign)({},u),{newComment:Object(r.__assign)(Object(r.__assign)({},u.newComment),{anchorHintText:v})})),a=he.v(m),s=he.w(m),u.index>-1&&(a[m].pending=be.a.None,s[m].pending=St.a.None)}}else l=null!=l?l:-1}else l=null!=l?l:4;n.isReadOnly&&(f&&(u=void 0),o=he.Z(o),l=null!=l?l:5);g.Q()?Object(bt.c)(e.draftState,o,l,4,i.d.reserveTag(539297116)):Object(bt.b)(e.draftState,o,2);return Object(r.__assign)(Object(r.__assign)({},e),{virtualized:!!t.payload.virtualized,commentData:[],cardViewState:a,postViewState:s,selectedComment:c,expandedComments:he.R(e.expandedComments,c,o),pendingCommentLoad:0===t.payload.numberOfComments?void 0:{numberOfComments:t.payload.numberOfComments,numberOfThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex},contextState:n,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?he.P(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:u,selectedThreadIdBeforeCommentSession:void 0,draftState:o,tasks:{},historyRecordViewState:{}})}(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}(e,t);case"SHOW_LOW_FIDELITY_WARNING":return function(e,t){var n,o=t.payload,a=o.commentId,i=o.lowFidelityWarningType,s=e.commentData.find((function(e){return e.commentId===a}));if(!s)return Object(d.i)().assertConditionTag(!1,"Comment not found",593762530),e;if(Object(ve.d)(e.draftState))return Object(d.i)().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var c=e.expandedComments;i===ye.a.DeleteThread?n={selectedCardId:a,selectionDetails:{lowFidelityWarningType:i}}:(n={selectedCardId:Object(Je.b)(s),selectionDetails:{selectedPostId:a,lowFidelityWarningType:i}},c=he.a(c,n,e.draftState));return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:n,expandedComments:c})}(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return function(e,t){var n=e.selectedComment;if(!n||void 0===n.selectionDetails.lowFidelityWarningType)return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:Object(r.__assign)(Object(r.__assign)({},n),{selectionDetails:{lowFidelityWarningType:void 0}})})}(e);case"CLEAR_COMMENT_SELECTION":return function(e,t){if(!he.bb(e.draftState,e.selectedComment,t))return e;return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:void 0})}(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return function(e,t){if(void 0!==t.payload.commentId&&t.payload.commentId!==e.highlightedCommentId)return e;return Object(r.__assign)(Object(r.__assign)({},e),{highlightedCommentId:void 0})}(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{topVisibleThreadId:t.payload.threadId})}(e,t);case"UPDATE_CONTEXT_DETAILS":return function(e,t){var n=!1,o=Object(r.__assign)({},e.contextState),a=e.createdCommentLie,s=e.draftState,c=void 0;void 0!==t.payload.contextState.commentThreadCounts&&(n=!0,o.commentThreadCounts=t.payload.contextState.commentThreadCounts);void 0!==t.payload.contextState.nextPopulatedContextDetails&&(n=!0,o.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails);void 0!==t.payload.contextState.isReadOnly&&(n=!0,o.isReadOnly=t.payload.contextState.isReadOnly,o.isReadOnly&&(s=he.Z(e.draftState),c=null!=c?c:5,he.F(e.draftState,!0)&&(a=void 0)));if(!n)return e;g.Q()?Object(bt.c)(e.draftState,s,c,5,i.d.reserveTag(539297117)):Object(bt.b)(e.draftState,s,3);return Object(r.__assign)(Object(r.__assign)({},e),{draftState:s,contextState:o,createdCommentLie:a})}(e,t);case"BEGIN_PROCESSING_COMMIT":return function(e,t){var n;if(!Object(ve.b)(e.draftState))return Object(d.i)().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var o=e.draftState,a=he.J(e.draftState);a&&(o=Object(r.__assign)(Object(r.__assign)({},o),{drafts:Object(r.__assign)(Object(r.__assign)({},o.drafts),(n={},n[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:ve.a.Commit}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:o})}(e);case"COMMIT_FAILURE":return function(e,t){var n;if(!Object(ve.i)(e.draftState))return Object(d.i)().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var o=e.draftState,a=he.J(e.draftState);a&&(o=Object(r.__assign)(Object(r.__assign)({},o),{drafts:Object(r.__assign)(Object(r.__assign)({},o.drafts),(n={},n[a.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},a),{pendingState:ve.a.None,savedDraftContent:void 0!==t.payload.commitText?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:a.savedDraftContent}),n))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:o})}(e,t);case"BEGIN_PROCESSING_DISCARD":return function(e){var t;if(!Object(ve.b)(e.draftState)&&!Object(ye.g)(e.selectedComment))return Object(d.i)().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var n=e.draftState,o=he.J(e.draftState);o&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:ve.a.Discard}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"CANCEL_DISCARD":return function(e){var t;if(!Object(ve.j)(e.draftState))return Object(d.i)().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var n=e.draftState,o=he.J(e.draftState);o&&(n=Object(r.__assign)(Object(r.__assign)({},n),{drafts:Object(r.__assign)(Object(r.__assign)({},n.drafts),(t={},t[o.commentDraft.sessionConfiguration.draftId]=Object(r.__assign)(Object(r.__assign)({},o),{pendingState:ve.a.None}),t))}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e);case"LOAD_PERSONA_ICON_PROPERTIES":return function(e,t){if(0===Object.keys(t.payload.personaIconPropertiesMap).length)return e;var n=Object(r.__assign)(Object(r.__assign)({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return Object(r.__assign)(Object(r.__assign)({},e),{personaIconPropertiesMap:n})}(e,t);case"COMMIT_DRAFT":return function(e,t){var n=he.G(e.draftState);if(void 0===n)return Object(d.i)().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(n.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return function(e,t){if(!e.createdCommentLie)return e;var n=he.F(e.draftState);if(!n)return e;var o=t.temporaryCommentId;if(!o)throw Object(d.i)().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new w.a($.c,i.d.reserveTag(589103637),-2130957545);var a=Object(r.__assign)(Object(r.__assign)({},e.createdCommentLie.newComment),{commentId:o,commentBody:t.commentBody}),s=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),he.v(o)),c=Object(r.__assign)(Object(r.__assign)({},e.postViewState),he.w(o)),u=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},l=he.V(e.draftState,n);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:u,expandedComments:he.a(e.expandedComments,u,l),createdCommentLie:Object(r.__assign)(Object(r.__assign)({},e.createdCommentLie),{newComment:a}),cardViewState:s,postViewState:c,selectedThreadIdBeforeCommentSession:void 0,draftState:Object(r.__assign)(Object(r.__assign)({},l),{committedLieId:o})})}(e,t.payload.data);case"REPLY":return function(e,t){var n;if(!t.parentId)throw new w.a($.d,i.d.reserveTag(589103638),-2130957536);var o=Object(r.__assign)(Object(r.__assign)({},e.cardViewState),((n={})[t.parentId]=Object(r.__assign)(Object(r.__assign)({},e.cardViewState[t.parentId]),{pending:be.a.Editor,loadState:{state:It.a.Loaded}}),n)),a=he.m(t.parentId),s=he.V(e.draftState,t.parentId);return Object(r.__assign)(Object(r.__assign)({},e),{cardViewState:o,selectedComment:a,expandedComments:he.R(e.expandedComments,a,s),selectedThreadIdBeforeCommentSession:void 0,draftState:s})}(e,t.payload.data);case"EDIT":return function(e,t){var n,o=he.z(e,t.commentId),a=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.commentId]),{pending:St.a.Post}),i=he.ab(e.draftState,t.commentId);return Object(r.__assign)(Object(r.__assign)({},e),{postViewState:Object(r.__assign)(Object(r.__assign)({},e.postViewState),(n={},n[t.commentId]=a,n)),selectedComment:o,expandedComments:he.R(e.expandedComments,o,i),selectedThreadIdBeforeCommentSession:void 0,draftState:i})}(e,t.payload.data);default:throw new w.a("Unexpected session type for commit",i.d.reserveTag(589103639),-2130957532)}}(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{atMentionState_deprecated:{capability:t.payload.capability},modelCapabilities:Object(r.__assign)(Object(r.__assign)({},e.modelCapabilities),{atMention:t.payload.capability})})}(e,t);case"SAVE_DRAFT":return function(e,t){var n,o=e.draftState.drafts;if(void 0===o[t.payload.draftId])return Object(d.i)().assertConditionTag(!Object(ve.c)(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var a=Object(r.__assign)(Object(r.__assign)({},o),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},o[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:a})})}(e,t);case"DRAFT_EMPTINESS_CHANGED":return function(e,t){var n,o=e.draftState.drafts;if(void 0===o[t.payload.draftId])return Object(d.i)().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var a=Object(r.__assign)(Object(r.__assign)({},o),((n={})[t.payload.draftId]=Object(r.__assign)(Object(r.__assign)({},o[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:a})})}(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return function(e,t){var n=he.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return void 0!==t.payload.draftId&&t.payload.draftId!==n?r.renderContextType:t.payload.isClaimingLock&&r.renderContextType===De.a.None?t.actionDetail.renderContextType:t.payload.isClaimingLock||r.renderContextType!==t.actionDetail.renderContextType?r.renderContextType:De.a.None}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=he.eb(e.draftState,(function(n){var r=e.draftState.drafts[n];return Object(Pe.b)(r.renderContextType)?Object(Ct.a)(t.payload.viewContainer.containerType):r.renderContextType}));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:n})}(e,t);case"DISPLAY_DRAFT_WARNING":return function(e,t){var n,o,a=he.G(e.draftState);if(void 0===a)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var i=a.sessionConfiguration.draftId,s=e.draftState.drafts;if(!s[i])return Object(d.i)().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var c=s[i].draftWarningState,u=Object(r.__assign)(Object(r.__assign)({},s[i]),{draftWarningState:{warningCounter:c?c.warningCounter+1:0,type:t.payload.draftWarningType}}),l=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=u,n)),m=g.mb()&&(Object(pt.b)(u.commentDraft.sessionConfiguration)||(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId)!==u.threadId)?he.D(u):e.selectedComment,f=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:l});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:f,selectedComment:m,expandedComments:he.R(e.expandedComments,m,f)})}(e,t);case"UPDATE_CAPABILITIES":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{capabilities_deprecated:t.payload.capabilities})}(e,t);case"UPDATE_MODEL_STATE":return function(e,t){var n={atMention:t.payload.modelCapabilityFlags&Ke.AtMentionKnown?t.payload.modelCapabilityFlags&Ke.AtMentionEnabled?ut.b.Enabled:ut.b.Disabled:ut.b.Unknown,newThread:!!(t.payload.modelCapabilityFlags&Ke.NewThread),resolve:!!(t.payload.modelCapabilityFlags&Ke.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&Ke.Virtualized),tasks:t.payload.modelCapabilityFlags&Ke.TasksKnown?t.payload.modelCapabilityFlags&Ke.TasksEnabled?mt.a.Enabled:mt.a.Disabled:mt.a.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&Ke.PresentLinkToComment),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&Ke.UIAAnnotationPattern)};return Object(r.__assign)(Object(r.__assign)({},e),{modelCapabilities:n})}(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return function(e,t){var n,o=he.G(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var a=o.sessionConfiguration;if(Object(pt.b)(a))return e;var i=e.draftState.drafts[a.draftId];if(!i)return Object(d.i)().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var s=i.currentMentionees,c={};for(var u in s)c[u]={mentionee:Object(r.__assign)({},s[u].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(u)};var l=i.selectedTaskAssignee;if(l){var m=Object(re.e)(l);c[m]&&c[m].stillInDraft||(l=void 0)}var f=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[a.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[a.draftId]),{currentMentionees:c,selectedTaskAssignee:l}),n))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:f})}(e,t);case"ADD_TO_CURRENT_MENTIONEES":return function(e,t){var n,o=he.G(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var a=o.sessionConfiguration;if(Object(pt.b)(a))return e;var i=e.draftState.drafts[a.draftId];if(!i)return Object(d.i)().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var s=i.currentMentionees,c=Object(re.e)(t.payload.mentionee);if(s&&s[c])return e;var u={};for(var l in s)u[l]={mentionee:Object(r.__assign)({},s[l].mentionee),stillInDraft:s[l].stillInDraft};u[c]={mentionee:Object(r.__assign)({},t.payload.mentionee),stillInDraft:!0};var m=Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts),(n={},n[a.draftId]=Object(r.__assign)(Object(r.__assign)({},e.draftState.drafts[a.draftId]),{currentMentionees:u}),n))});return Object(r.__assign)(Object(r.__assign)({},e),{draftState:m})}(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEE":return function(e,t){var n,o=he.G(e.draftState);if(void 0===o)return Object(d.i)().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var a=o.sessionConfiguration;if(Object(pt.b)(a))return e;var i=a.draftId,s=e.draftState.drafts;if(!s[i])return Object(d.i)().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=Object(r.__assign)(Object(r.__assign)({},s),((n={})[i]=Object(r.__assign)(Object(r.__assign)({},s[i]),{selectedTaskAssignee:t.payload.selectedAssignee}),n));return Object(r.__assign)(Object(r.__assign)({},e),{draftState:Object(r.__assign)(Object(r.__assign)({},e.draftState),{drafts:c})})}(e,t);case"POPULATE_SMART_REPLY":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{draftState:he.q(e.draftState,t.payload)})}(e,t);case"SHOW_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),o=Object(r.__assign)({},e.postViewState);return o[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:o})}(e,t);case"CLEAR_POST_ERROR_STATE":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),o=Object(r.__assign)({},e.postViewState);return o[t.payload.commentId]=n,Object(r.__assign)(Object(r.__assign)({},e),{postViewState:o})}(e,t);case"UPDATE_DRAFT_THREAD":return function(e,t){if(!e.createdCommentLie)return e;if(he.F(e.draftState)!==t.payload.draftId)return Object(d.i)().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(void 0===t.payload.anchorHintText&&void 0===t.payload.insertIndex)return e;var n=e.createdCommentLie;void 0!==t.payload.insertIndex&&t.payload.insertIndex!==n.index&&(n=Object(r.__assign)(Object(r.__assign)({},n),{index:t.payload.insertIndex}));void 0!==t.payload.anchorHintText&&t.payload.anchorHintText!==n.newComment.anchorHintText&&(n=Object(r.__assign)(Object(r.__assign)({},n),{newComment:Object(r.__assign)(Object(r.__assign)({},n.newComment),{anchorHintText:t.payload.anchorHintText})}));return Object(r.__assign)(Object(r.__assign)({},e),{createdCommentLie:n})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){var n=e.draftState,o=e.selectedComment,a=e.expandedComments;if(t.payload.visibilityState!==V.a.Visible&&!g.n()&&(n=he.Y(n),e.selectedComment&&0===Object.keys(n.drafts).length&&Object.keys(e.draftState.drafts).length>0)){var i=he.H(e.draftState);i&&(o=he.m(i),a=he.R(e.expandedComments,o,n))}n=he.eb(n,(function(n){var r=e.draftState.drafts[n];return he.cb(r.renderContextType,t.payload.visibilityState)})),g.Q()||Object(bt.b)(e.draftState,n,1);return Object(r.__assign)(Object(r.__assign)({},e),{selectedComment:o,expandedComments:a,draftState:n})}(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{suggestionsDetails:t.payload.details})}(e,t);default:return e}}(e,t);return function(e,t){var n,o,a=t;if(g.gb()){var i="android"===Object(je.a)()||"ios"===Object(je.a)(),s=null===(n=a.selectedComment)||void 0===n?void 0:n.selectedCardId,c=he.F(a.draftState);if(s&&s!==c&&(i?s!==(null===(o=e.selectedComment)||void 0===o?void 0:o.selectedCardId):a.expandedComments.includes(s)&&!e.expandedComments.includes(s)))(d=he.g(s,a.postViewState,a.commentData,a.localizationDetails))&&(a=Object(r.__assign)(Object(r.__assign)({},a),{postViewState:d}));var d,u=he.F(e.draftState);if(u&&u!==c&&(i||a.expandedComments.includes(u)))(d=he.g(u,a.postViewState,a.commentData,a.localizationDetails))&&(a=Object(r.__assign)(Object(r.__assign)({},a),{postViewState:d}))}return a}(e,n)}function Lt(){Object(d.i)().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function Vt(e,t){switch(void 0===e&&(e={viewContainer:{closeView:Lt,openView:Lt,containerType:k.b.FullPane,moveFocusToCanvas_donotuse:Lt},componentTree:new kt(De.a.FullPane,a.a),visibilityState:V.a.Closed,initializationStatus:Dt.a.NotInitialized,viewContainerDisplayConfiguration:void 0}),void 0===t&&(t=pe.EMPTY_ACTION),t.type){case"VIEW_CONTAINER_CHANGED":return function(e,t){var n=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:t.payload.viewContainer,componentTree:n?new kt(Object(Ct.a)(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return function(e,t){if(t.payload.displayConfiguration===e.viewContainerDisplayConfiguration)return e;return Object(r.__assign)(Object(r.__assign)({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:t.payload.visibilityState!==V.a.Closed||g.u()?e.initializationStatus:Dt.a.NotInitialized,visibilityState:t.payload.visibilityState})}(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return function(e,t){var n=Object(r.__assign)(Object(r.__assign)({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return Object(r.__assign)(Object(r.__assign)({},e),{viewContainer:n})}(e,t);case"BEGIN_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:Dt.a.Initializing})}(e);case"END_VIEW_INIT":return function(e){return Object(r.__assign)(Object(r.__assign)({},e),{initializationStatus:Dt.a.Initialized})}(e);default:return e}}var Bt=void 0;function Ht(e,t){void 0===t&&(t=dt.a),Bt||(Bt=Object(at.combineReducers)({paneState:Vt,contentExtensions:Rt,commentState:Ft}));var n=Bt(e,t);return n}var Ut=n(130);var Gt=function(){return{threadIdRequests:new Map,sequenceId:0}};function Wt(e){return e&&(e.loadState.state===It.a.Placeholder||e.loadState.state===It.a.NeedsReload)}var qt=function(e,t,n){return void 0===n&&(n=20),o=function(e){return function(t,n){var o,a,i=Te.c(e.getState());try{for(var s=Object(r.__values)(n),c=s.next();!c.done;c=s.next()){var d=c.value;Wt(i[d])&&t.threadIdRequests.set(d,t.sequenceId++)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}return t}}(e),a=function(e,t,n){return function(o){for(var a=Array.from(o.threadIdRequests.entries()).sort((function(e,t){var n=Object(r.__read)(e,2),o=(n[0],n[1]),a=Object(r.__read)(t,2);return a[0],o-a[1]})),s=[],c=Te.c(e.getState()),d=a.pop();d&&s.length<n;d=a.pop()){var u=Object(r.__read)(d,1)[0];o.threadIdRequests.delete(u),Wt(c[u])&&s.push(u)}if(s.length&&e.dispatch(Object(pe.dispatchLoadThreads)({renderContextType:De.a.None,telemetryVisitor:t,trackback:i.d.reserveTag(594888212)},{threadIds:s})),o.threadIdRequests.size>0)return o}}(e,t,n),c=500,l=(s=Gt)(),m=function(){var e=a(l);e?(l=e,u=setTimeout(m,c)):(l=s(),u=void 0)},(f=function(e){l=o(l,e),u||d||(u=setTimeout(m,0)),u||(u=setTimeout(m,d||c))}).reset=function(){void 0!==u&&(clearTimeout(u),l=s(),u=void 0)},f;var o,a,s,c,d,u,l,m,f},zt=n(275),Yt=n(719);function Kt(e,t,n){var r=e.getState(),o=Yt.a(r)[l.e.Isolated];return!!o&&(n(t),o.controller.triggerUpdate(),!0)}function Xt(e,t,n,r){return"CREATE"===r&&Kt(e,t,n)}function Jt(e,t){return 0===Te.f(t).lastContextChangeIncrement?l.d.Disabled:e===l.e.TaskPane||e===l.e.TaskPaneItem?Oe.a(t)?l.d.Primary:l.d.Disabled:Te.o(t)?l.d.Disabled:Jt(l.e.TaskPane,t)!==l.d.Primary?l.d.Primary:e===l.e.Integrated?l.d.Disabled:l.d.Secondary}function Qt(e,t){var n=Yt.a(e)[t];n&&(n.controller.priority=n.priority)}var Zt=n(189),$t=n(501),en=n(709);function tn(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:"ApplyCommentChangesAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"BEGIN_PROCESSING_COMMIT":return{name:"BeginProcessingCommitAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_CREATE_THREAD":return{name:"CancelCommentCreateThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_POST_EDIT":return{name:"CancelCommentPostEditAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CANCEL_COMMENT_REPLY":return{name:"CancelCommentReplyAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CLEAR_COMMENT_SELECTION":return{name:"ClearCommentSelectionAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"COLLAPSE_CARD":return{name:"CollapseCardAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"COMMIT_DRAFT":return{name:"CommitDraftAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"DISPLAY_DRAFT_WARNING":return{name:"DisplayDraftWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"RELOAD_COMMENTS":return{name:"ReloadCommentsAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_POST":return{name:"DeletePostAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_DELETE_THREAD":return{name:"DeleteThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent,logDocumentMetadata:d.f.Basic};case"DISPATCH_LOAD_THREADS":return{name:"LoadThreadsAction",aggregationMode:d.a.OnSuccess,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_REOPEN_THREAD":return{name:"ReopenThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"REQUEST_THREAD_RESOLVE":return{name:"ResolveThreadAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent,logDocumentMetadata:d.f.Basic};case"SELECT_COMMENT":return{name:"SelectCommentAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:"SelectFirstThreadInNextCommentContextAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:"SelectLastThreadInPreviousCommentContextAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SESSION_REQUEST_STARTED":return{name:"SessionRequestStartedAndLockSelectionAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"SHOW_LOW_FIDELITY_WARNING":return{name:"ShowLowFidelityWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"CLEAR_LOW_FIDELITY_WARNING":return{name:"ClearLowFidelityWarningAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:"UpdateDraftRenderContext",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};case"PRESENT_LINK_TO_COMMENT":return{name:"PresentLinkToCommentAction",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent};default:return}}var nn=function(){return function(e){return function(t){try{return e(t)}catch(e){if(void 0===tn(t)){var n=Object(d.i)().createActivityObject("ExceptionMiddlewareCatch",t.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);n.addDataField("OperationType",t.type,d.d.SystemMetadata),n.addDataField("Trackback",t.actionDetail.trackback,d.d.SystemMetadata),n.failTag(593278723,Object(Zt.a)(e))}!function(e){if(Object($t.a)(e))throw e;if(!Object(w.b)(e))throw Object(d.i)().assertConditionTag(!1,"Unknown error encountered, rethrowing: "+Object(i.l)(e),593278724),e;switch(e.errorCode){case-2130957565:case-2130957551:throw e;case-2130957536:return;default:Object(d.i)().assertConditionTag(!1,"Unexpected error: Name: "+e.name+" errorCode: "+e.errorCode+" Tag: "+e.tag+" internalDetails: "+Object(i.l)(e),e.tag)}}(e)}}}};var rn=n(174),on=n(625),an=n(2050);function sn(e){return void 0!==e&&0!=(e.commentFlags&o.c.Resolved)}function cn(e,t){e.addDataField("IsCommentResolved",t,d.d.SystemMetadata)}var dn;function un(e){e.timerHandle&&clearTimeout(e.timerHandle)}!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"}(dn||(dn={}));var ln=function(){function e(e){var t=this;this.telemetryVisitor=e,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(o.activity.failTag(n,void 0!==r?r:-2130957541),un(o),delete t.performanceActivities[e])},this.timeoutTracker=function(e,n,r){var o=t.performanceActivities[e];o&&(un(o),o.activity.addDataField("Timeout",!0,d.d.SystemMetadata),n.failOnTimeout?o.activity.failTag(r,-2130957491):o.activity.successTag(r),delete t.performanceActivities[e])}}return e.prototype.beginTracking=function(e,t,n,r,o){var a=this;void 0===o&&(o={timeout:5e3,failOnTimeout:!0});var s=r||Object(d.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);s.addDataField("OperationType",n,d.d.SystemMetadata),this.performanceActivities.hasOwnProperty(e)&&(Object(d.i)().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(e,i.d.reserveTag(595907678)));var c={activity:s,expectedChangeType:t};c.timerHandle=setTimeout((function(){return a.timeoutTracker(e,o,i.d.reserveTag(575484417))}),o.timeout),this.performanceActivities[e]=c},e.prototype.updateTrackerId=function(e,t){if(e!==t){this.performanceActivities.hasOwnProperty(t)&&(Object(d.i)().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(t,i.d.reserveTag(595132705)));var n=this.performanceActivities[e];n&&(this.performanceActivities[t]=n,delete this.performanceActivities[e])}},e.prototype.failAllTrackers=function(e,t){var n=this;Object.keys(this.performanceActivities).forEach((function(r){var o=n.performanceActivities[r];un(o),o.activity.failTag(e,void 0!==t?t:-2130957541)})),this.performanceActivities={}},e.prototype.endTracker=function(e,t,n){var r=this.performanceActivities[e];r&&(un(r),r.activity.addDataField("ExpectedChangeArrived",r.expectedChangeType===t?dn.Yes:dn.No,d.d.SystemMetadata),r.activity.successTag(n),delete this.performanceActivities[e])},e.prototype.endAllTrackers=function(e){for(var t in this.performanceActivities){var n=this.performanceActivities[t];un(n),n.activity.addDataField("ExpectedChangeArrived",dn.Unknown,d.d.SystemMetadata),n.activity.successTag(e)}this.performanceActivities={}},e.prototype.getTracker=function(e,t){var n=this.performanceActivities[e];if(n&&n.expectedChangeType===t)return n},e}(),mn=function(){function e(e){this.telemetryVisitor=e,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(e){var t=Object(ye.b)(e);this.activity&&t!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",d.d.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),this.activity||this.selectedCommentId||(this.activity=Object(d.i)().createActivityObject(this.trackerActivityName,this.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent),this.selectedCommentId=t)},e.prototype.endTrackingIfWarningDismissed=function(e,t){var n=Object(ye.b)(t);!this.activity||n===this.selectedCommentId&&Object(ye.h)(t)||(this.activity.addDataField("OperationType",e.type,d.d.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function fn(e,t){t?e.addDataField("AffectingTaskMetadata",!0,d.d.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,d.d.SystemMetadata)}function pn(e,t,n){var r=t.find((function(e){return e.commentId===n})),o=(null==r?void 0:r.parentId)||(null==r?void 0:r.commentId);t.some((function(e){return(e.commentId===o||e.parentId===o)&&0!=(e.commentFlags&ut.e.IsNew)}))&&o&&e.addDataField("CommentIsNew",o,d.d.SystemMetadata)}var Cn=function(e){var t=new ln(e),n=new mn(e),o=Object(an.a)((function(e){Object(d.i)().createActivityObject("PostButtonTeachingCallout",e.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent).successTag(573687565)}));return function(e){return function(a){return function(s){var c,u,l=function(){var t,n,r,o,i,c,u=tn(s);if(!u)return Object(d.i)().assertConditionTag(!1,"Event name not defined for action type: "+s.type,595616738),a(s);var l=Object(d.i)().createActivityObject(u.name,s.actionDetail.telemetryVisitor,u.aggregationMode,u.diagnosticLevel);l.addDataField("Trackback",s.actionDetail.trackback,d.d.SystemMetadata),l.addDataField("RenderContextType",s.actionDetail.renderContextType,d.d.SystemMetadata),u.logDocumentMetadata&&l.addDocumentMetadata(u.logDocumentMetadata);var m,f=function(e,t){l.addDataField("CommentId",t,d.d.SystemMetadata);var n=Object(he.h)(e,t);n.valid&&(l.addDataField("MatchesCommentAuthor",n.matchesCurrentUser,d.d.SystemMetadata),l.addDataField("ThreadCreationDeltaMs",n.timeElapsed,d.d.SystemMetadata)),pn(l,e,t)},p=e.getState(),C=zt.b(e.getState());switch(s.type){case"COMMENT_CONTEXT_CHANGED":l.addDataField("NumberOfThreads",s.payload.numberOfThreads,d.d.SystemMetadata),s.payload.virtualized||l.addDataField("NumberOfComments",s.payload.numberOfComments,d.d.SystemMetadata);break;case"COMMIT_DRAFT":var g=function(e){if("COMMIT_DRAFT"===e.type)return{name:"CommitDraft"+Object(en.b)(e.payload)+"Action",aggregationMode:d.a.None,diagnosticLevel:d.b.NecessaryServiceDataEvent}}(s);if(!g)return Object(d.i)().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),a(s);var h=Object(d.i)().createActivityObject(g.name,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);h.addDataField("RenderContextType",s.actionDetail.renderContextType,d.d.SystemMetadata),h.successTag(595903074);var b=ft.b[s.payload.sessionType];l.addDataField("SessionType",b,d.d.SystemMetadata),"REPLY"===s.payload.sessionType&&pn(l,Te.d(p),s.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":l.addDataField("DraftWarningType",s.payload.draftWarningType,d.d.SystemMetadata),l.addDataField("DraftWarningReason",s.payload.draftWarningReason,d.d.SystemMetadata);var v=Object(he.J)(p.commentState.draftState);v&&(l.addDataField("IsDraftInCurrentContext",v.isInCurrentContext,d.d.SystemMetadata),l.addDataField("DraftId",v.commentDraft.sessionConfiguration.draftId,d.d.SystemMetadata));break;case"UPDATE_DRAFT_RENDER_CONTEXT":l.addDataField("IsClaimingDraftLock",s.payload.isClaimingLock,d.d.SystemMetadata),l.addDataField("IsUpdatingAllDraftLocks",!s.payload.draftId,d.d.SystemMetadata);break;case"SELECT_COMMENT":l.addDataField("SelectType",pe.SelectActionType[s.payload.selectType],d.d.SystemMetadata),l.addDataField("ActionSource",Ce.a[s.payload.source],d.d.SystemMetadata);var y=Te.r(p),T=!(!y||y.selectedCardId!==s.payload.selectedCard);l.addDataField("IsCurrentCard",T,d.d.SystemMetadata),T||pn(l,Te.d(p),s.payload.selectedCard),s.payload.source!==Ce.a.Canvas&&(m=s.payload.selectType,Object(pe.shouldSelectActionExpandCard)(m))&&cn(l,sn(Te.e(p,s.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":fn(l,s.payload.isTask),f(Te.d(p),s.payload.commentId);var O=void 0;if(s.payload.isTask){O="REQUEST_THREAD_RESOLVE"===s.type?"ResolveThreadWithTask":"ReopenThreadWithTask",l.addDataField(O,!0,d.d.SystemMetadata,d.e.Critical);var I=null===(r=null===(n=null===(t=C[s.payload.commentId])||void 0===t?void 0:t.history[0])||void 0===n?void 0:n.records[0])||void 0===r?void 0:r.time;l.addDataField("TaskCreationTimeDeltaMs",I?Date.now()-I.getTime():0,d.d.SystemMetadata,d.e.Critical)}cn(l,sn(Te.e(p,s.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(fn(l,s.payload.isTask),s.payload.isTask){l.addDataField("DeleteThreadWithTask",!0,d.d.SystemMetadata,d.e.Critical);I=null===(c=null===(i=null===(o=C[s.payload.commentId])||void 0===o?void 0:o.history[0])||void 0===i?void 0:i.records[0])||void 0===c?void 0:c.time;l.addDataField("TaskCreationTimeDeltaMs",I?Date.now()-I.getTime():0,d.d.SystemMetadata,d.e.Critical)}cn(l,sn(Te.e(p,s.payload.commentId))),f(Te.d(p),s.payload.commentId);break;case"REQUEST_DELETE_POST":f(Te.d(p),s.payload.commentId)}try{var S=e.getState(),_=a(s),D=e.getState(),E=Te.h(S),j=Te.h(D);switch(s.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var P=s.payload.draftId?E.drafts[s.payload.draftId]:Object(he.J)(E),x=s.payload.draftId?j.drafts[s.payload.draftId]:Object(he.J)(j),A=void 0!==P&&void 0!==x&&P.renderContextType!==x.renderContextType;l.addDataField("DidDraftLockUpdate",A,d.d.SystemMetadata)}return l.successTag(595616739),_}catch(e){throw l.failTag(595616768,Object(Zt.a)(e,-2130957541)),e}};switch(s.type){case"BEGIN_PROCESSING_COMMIT":var m=Object(d.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);try{l()}catch(e){throw m.failTag(595687567,Object(Zt.a)(e,-2130957541)),e}if(!(p=Te.t(e.getState()))){m.failTag(595687569,-2130957541);break}var f=p.commentDraft.sessionConfiguration;t.beginTracking(f.draftId,ft.a[f.sessionType],f.sessionType,m);break;case"COMMIT_FAILURE":var p=Te.t(e.getState());Object(d.i)().assertConditionTag(!!p,"Draft should exist when failing a commit.",595132701),p&&t.failTracker(p.commentDraft.sessionConfiguration.draftId,i.d.reserveTag(595132702)),a(s);break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":t.beginTracking(s.payload.commentId,lt.a.Modify,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.d.reserveTag(595907670),Object(Zt.a)(e,-2130957541)),e}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":t.beginTracking(s.payload.commentId,lt.a.Delete,s.type);try{l()}catch(e){throw t.failTracker(s.payload.commentId,i.d.reserveTag(595907671),Object(Zt.a)(e,-2130957541)),e}break;case"COMMENT_CONTEXT_CHANGED":try{a(s)}catch(e){throw t.failAllTrackers(i.d.reserveTag(595731294),Object(Zt.a)(e,-2130957541)),e}break;case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":if(("LOAD_COMMENT"===s.type?s.payload.commentData:s.payload.threadInfo).length>0&&!t.getTracker("LoadCommentTracker",lt.a.Load)){m=Object(d.i)().createActivityObject(t.trackerActivityName,s.actionDetail.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);t.beginTracking("LoadCommentTracker",lt.a.Load,s.type,m,{timeout:1e6,failOnTimeout:!1})}a(s);break;case"RELOAD_COMMENTS":try{l()}catch(e){throw t.failAllTrackers(i.d.reserveTag(595907672),Object(Zt.a)(e,-2130957541)),e}t.endAllTrackers(i.d.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var C=t.getTracker("LoadCommentTracker",lt.a.Load);C&&(s.payload.commentId&&C.activity.addDataField("AssociatedCommentId",s.payload.commentId,d.d.SystemMetadata),C.activity.addDataField("RenderContextType",s.payload.renderContextType,d.d.SystemMetadata),t.endTracker("LoadCommentTracker",lt.a.Load,i.d.reserveTag(595646476))),a(s);break;case"APPLY_COMMENT_CHANGES":try{l()}catch(e){throw t.failAllTrackers(i.d.reserveTag(595907674),Object(Zt.a)(e,-2130957541)),e}try{for(var g=Object(r.__values)(s.payload.changes),h=g.next();!h.done;h=g.next()){var b=h.value;if(b.type===lt.a.Load||b.type===lt.a.Unknown)break;if(b.type!==lt.a.Delete&&b.type!==lt.a.Modify){if(b.type===lt.a.Insert){void 0!==b.tempId&&""===b.model.parentId&&Object(bt.a)(b.tempId,b.model.commentId,s.actionDetail.telemetryVisitor);var v=b.tempId||b.model.parentId;void 0!==v&&t.endTracker(v,b.type,i.d.reserveTag(595857620))}}else t.endTracker(b.model.commentId,b.type,i.d.reserveTag(595907675))}}catch(e){c={error:e}}finally{try{h&&!h.done&&(u=g.return)&&u.call(g)}finally{if(c)throw c.error}}break;case"COMMIT_DRAFT":p=Te.t(e.getState());if(l(),s.payload.data.temporaryCommentId&&p){var y=void 0;switch((f=p.commentDraft.sessionConfiguration).sessionType){case"CREATE":!function(e,t,n){Object(bt.a)(e,t,n)}(f.draftId,s.payload.data.temporaryCommentId,s.actionDetail.telemetryVisitor),y=s.payload.data.temporaryCommentId;break;case"REPLY":y=s.payload.data.temporaryCommentId;break;case"EDIT":y=f.commentId;break;case"METADATA":y=f.threadId;break;default:Object(i.m)(f)}y&&t.updateTrackerId(f.draftId,y)}break;case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"CLEAR_COMMENT_SELECTION":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":l();break;case"SHOW_LOW_FIDELITY_WARNING":l();var T=Te.r(e.getState());T&&n.beginTracking(T);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":var O="";switch(s.payload.visibilityState){case V.a.Closed:O="ViewContainerClosed";break;case V.a.Hidden:O="ViewContainerHidden";break;case V.a.Visible:O="ViewContainerVisible";break;default:Object(i.m)(s.payload.visibilityState)}var I=Object(d.i)().createActivityObject(O,s.actionDetail.telemetryVisitor,d.a.Always,d.b.NecessaryServiceDataEvent);a(s),I.successTag(592241220);break;case"DRAFT_EMPTINESS_CHANGED":var S=Te.h(e.getState()).drafts[s.payload.draftId].commentDraft.sessionConfiguration.sessionType;S!==ut.c&&S!==ut.h||o(s),a(s);break;default:a(s)}var _=Te.r(e.getState());_&&n.endTrackingIfWarningDismissed(s,_)}}}},gn=n(259),hn=n(386),bn=n(391),vn=n(442),yn=function(e,t){return function(e){return function(n){return function(r){switch(r.type){case"REQUEST_SHOW_PANE":(a=Oe.d(e.getState())).openView();break;case"REQUEST_CLOSE_PANE":(a=Oe.d(e.getState())).closeView();break;case"MOVE_FOCUS_TO_CANVAS":if(!g.kb())(a=Oe.d(e.getState())).moveFocusToCanvas_donotuse();break;case"REQUEST_MODAL_CONFIRMATION":(a=Oe.d(e.getState())).invokeModalConfirmationDialog?a.invokeModalConfirmationDialog(r.payload.onConfirm,r.payload.onCancel,r.payload.displayStrings):(Object(d.i)().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),a.closeView());break;case"READY_TO_RENDER":(a=Oe.d(e.getState())).onReadyToRender&&a.onReadyToRender();break;case"RESOLVE_ATMENTION_CAPABILITY":if(g.x()){var o=r.payload.capability===_t.a.Enabled;t.initializeController(o)}break;case"BEGIN_DRAFTING_SUCCESS":var a=Oe.d(e.getState());Object(hn.a)(a)&&"CREATE"===r.payload.draftDetails.sessionConfiguration.sessionType&&On(e.dispatch,r.actionDetail,{displayMode:gn.a.Variable,desiredHeight:0}),Tn(e.getState(),a);break;case"DISPLAY_DRAFT_WARNING":Tn(e.getState());break;case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":if(r.payload.closeOnDiscard){a=Oe.d(e.getState());return n(r),void a.closeView()}break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(g.u()&&"ios"===Object(je.a)()&&r.payload.visibilityState===V.a.Closed){var s=Te.h(e.getState());Object(ve.c)(s)&&(c=e.dispatch,u=r.actionDetail,c(Object(bn.a)(u,Ce.a.SharedComments,!0)).catch(Object(S.a)(i.d.reserveTag(546104259))))}}var c,u,l=e.getState(),m=n(r),f=e.getState();return function(e,t,n,r){var o=Oe.d(r);if(!Object(hn.a)(o))return;var a=Te.h(r),i=Te.h(n),s=Object(ve.c)(a),c=Object(ve.c)(i),d=Te.g(r),u=Te.g(n);if(s!==c||!Object(hn.a)(Oe.d(n))||!d&&u){if(!s)return d?void On(e,t,{displayMode:gn.a.Variable,desiredHeight:0}):void On(e,t,{displayMode:gn.a.Normal});var l=Te.r(r);if(l&&l.selectedCardId===Object(he.F)(a))return;On(e,t,{displayMode:gn.a.FullScreen})}}(e.dispatch,r.actionDetail,l,f),m}}}};function Tn(e,t){(function(e){var t=Oe.e(e);return g.u()&&(g.n()?t===V.a.Hidden:t!==V.a.Visible)})(e)&&(t||Oe.d(e)).openView()}function On(e,t,n){e(Object(vn.a)(t,n)).catch(Object(S.a)(i.d.reserveTag(578426776)))}function In(e,t,n,o,a,s,c,u){var m=Object(at.compose)(Object(at.applyMiddleware)(ct,st,it.default,nn,Cn(o),function(e,t){return function(n){var r=qt(n,t);return function(t){return function(o){var a=n.getState();switch(o.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":r.reset();break;case"COMMIT_DRAFT":var s=zt.b(a),c=Te.t(a);if(void 0!==c){var u=c.commentDraft;if(o.payload.metadataUpdates&&o.payload.metadataUpdates.Task){var l=void 0;u.sessionConfiguration.sessionType!==Ut.a&&u.sessionConfiguration.sessionType!==Ut.b&&(l=s[u.sessionConfiguration.threadId]&&s[u.sessionConfiguration.threadId].id),o.payload.metadataUpdates.Task.taskId=l,u.updateProperties("Task",o.payload.metadataUpdates.Task)}o.payload.data.temporaryCommentId=u.commit(o.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":return he.M(Te.n(a),Te.w(a))?void r(o.payload.threadIds):void Object(d.i)().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);case"DISPATCH_LOAD_THREADS":if(!he.M(Te.n(a),Te.w(a)))return;e.loadThreads(o.payload.threadIds);break;case"HIGHLIGHT_COMMENT":o.payload.actionSource===Ce.a.SharedComments&&e.highlightComment(o.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var m=Te.h(a);if(Object(ve.d)(m))return;e.deleteComment(o.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":g.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=zt.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:100,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),e.commit(),e.endDrafting()})).catch(Object(S.a)(i.d.reserveTag(593768922))):e.setThreadResolvedState(o.payload.commentId,!0);break;case"REQUEST_REOPEN_THREAD":g.b()?e.beginDraftingAsync({sessionType:"METADATA",threadId:o.payload.commentId}).then((function(e){var t=zt.b(a)[o.payload.commentId];t&&e.updateProperties("Task",{type:"Task",completion:0,taskId:t.id}),e.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),e.commit(),e.endDrafting()})).catch(Object(S.a)(i.d.reserveTag(593768924))):e.setThreadResolvedState(o.payload.commentId,!1);break;case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":e.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":e.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":e.presentLinkToComment(o.payload.commentId)}var f=t(o),p=n.getState(),C=Te.r(a),h=Te.r(p),b=void 0;switch("LOAD_COMMENT"===o.type||"VIRTUALIZE_COMMENTS"===o.type||"SELECT_COMMENT"===o.type&&o.payload.source!==Ce.a.SharedComments||!h||h.selectedCardId===(null==C?void 0:C.selectedCardId)||h.selectedCardId===Object(I.x)()||(b=h.selectedCardId),o.type){case"CLEAR_COMMENT_HIGHLIGHT":o.payload.actionSource===Ce.a.SharedComments&&void 0!==a.commentState.highlightedCommentId&&void 0===p.commentState.highlightedCommentId&&e.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(g.F()&&!g.kb()){var v=Te.t(p);v&&(b=v.threadId)}}return b&&e.selectComment(b),f}}}}(e,o),function(e){return function(t){return function(n){return function(r){var o=t.getState().commentState.draftState.drafts;n(r);var a=t.getState().commentState.draftState.drafts;Object.keys(o).forEach((function(t){if(void 0===a[t]){if(Object(g.Q)()){var n=Object(d.i)().createActivityObject("EndDraftingCalledOnAction",e,d.a.None,d.b.NecessaryServiceDataEvent);n.addDataField("ActionName",r.type,d.d.SystemMetadata),n.successTag(539313865)}o[t].commentDraft.endDrafting()}}))}}}}(o),function(e){return function(t){return function(n){return function(r){var o,a,i=t.getState(),s=n(r),c=t.getState();switch(r.type){case"BEGIN_DRAFTING_SUCCESS":var d=Te.h(c),u=r.payload.draftDetails.sessionConfiguration.draftId;(l=d.drafts[u])&&e.setDeferredActiveEditorFocusCommand(u);break;case"DISPLAY_DRAFT_WARNING":if(r.payload.draftWarningType===rn.a.CommitFailed)break;var l;d=Te.h(c);(l=Object(he.G)(d))&&e.setDeferredActiveEditorFocusCommand(l.sessionConfiguration.draftId)}return(null===(o=Te.r(c))||void 0===o?void 0:o.selectedCardId)===(null===(a=Te.r(i))||void 0===a?void 0:a.selectedCardId)&&Te.h(c)===Te.h(i)||e.clearPendingOnComponentFocusedRequest(),s}}}}(c),yn(0,u),function(e){return function(t){return function(t){return function(n){switch(n.type){case"DISPLAY_DRAFT_WARNING":if(!g.F())break;var r=on.f(e,n.payload.draftWarningType);Object(G.b)(n.payload.draftWarningType===rn.a.ReturnToDraft?e.formatString(230,r):r)}return t(n)}}}}(s),function(e){return function(t){return function(n){return function(o){var a,s,c;switch(o.type){case"ADD_CONTENT_EXTENSION":o.payload.extension.priority=Jt(o.payload.extension.provider.scope.renderMode,t.getState());break;case"REMOVE_CONTENT_EXTENSION":try{for(var d=Object(r.__values)(o.payload.renderModes),u=d.next();!u.done;u=d.next()){var m=u.value,f=Yt.a(t.getState())[m];f&&f.controller.unregisterExtension()}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}break;case"UPDATE_EXTENSION_PRIORITY":n(o),Qt(t.getState(),l.e.TaskPane),Qt(t.getState(),l.e.TaskPaneItem),Qt(t.getState(),l.e.Integrated),Qt(t.getState(),l.e.Isolated);break;case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(Kt(t,o,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":return n(o),void t.dispatch(Object(pe.updateExtensionPriority)({renderContextType:De.a.None,telemetryVisitor:e,trackback:i.d.reserveTag(594834319)},(c={},c[l.e.TaskPane]=Jt(l.e.TaskPane,t.getState()),c[l.e.TaskPaneItem]=Jt(l.e.TaskPaneItem,t.getState()),c[l.e.Integrated]=Jt(l.e.Integrated,t.getState()),c[l.e.Isolated]=Jt(l.e.Isolated,t.getState()),c)));case"BEGIN_DRAFTING_SUCCESS":if(Xt(t,o,n,o.payload.draftDetails.sessionConfiguration.sessionType))return;break;case"BEGIN_DRAFTING_FAILURE":if(Xt(t,o,n,o.payload.beginDraftingParams.sessionType))return;break;case"UPDATE_DRAFT_RENDER_CONTEXT":if(o.payload.isClaimingLock||o.actionDetail.renderContextType===De.a.DiscreteIsolated)break;var p=Te.t(t.getState());if(p&&Xt(t,o,n,p.commentDraft.sessionConfiguration.sessionType))return}return n(o)}}}}(o),function(e){return function(t){return function(n){return function(r){var o;if(!g.kb())return n(r);var a=t.getState(),i=n(r),s=t.getState();switch(r.type){case"DISPLAY_DRAFT_WARNING":var c=Te.r(a),d=Te.r(s),u=!d||d.selectedCardId===(null==c?void 0:c.selectedCardId);if(g.F()&&u){var m=Te.t(s);m&&e.bringContentIntoView({contentIdentifier:{contentId:m.threadId,contentType:l.b.CommentThread}})}break;case"SELECT_COMMENT":var f=Te.r(s);r.payload.source===Ce.a.SharedComments&&r.payload.selectType!==pe.SelectActionType.Polite&&Object(Pe.b)(r.actionDetail.renderContextType)&&f&&e.bringContentIntoView({contentIdentifier:{contentId:f.selectedCardId,contentType:l.b.CommentThread}});break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":if(Oe.a(s))break;var p=Te.t(s),C=p&&p.isInCurrentContext&&(null===(o=Te.r(s))||void 0===o?void 0:o.selectedCardId)===p.threadId?p.threadId:void 0;C&&e.bringContentIntoView({contentIdentifier:{contentId:C,contentType:l.b.CommentThread}});break;case"SELECT_CONTENT":e.selectNextOrPreviousContent(r.payload);break;case"MOVE_FOCUS_TO_CANVAS":e.moveFocus({region:E.a.Canvas,resource:r.payload.resource})}return i}}}}(a))),f=Object(at.createStore)(Ht,n,m);return c.initialize(f),f}var Sn=n(385),_n=n(132),Dn=n(175),En=n(131),jn=n(103),Pn=n(97),xn=n(432),An=function(){function e(e,t){this.commentStore=e,this.commandFactory=new rt(this.commentStore,t)}return e.prototype.selectNextOrPreviousThread=function(e,t,n){var r=g.n()&&!Oe.a(this.commentStore.getState()),o=Oe.c(this.commentStore.getState());return Ne(this.commandFactory.selectNextOrPreviousThread(void 0,e,t,n,r),o,this.commentStore,(function(){}))===ne.Handled},e.prototype.selectAcrossContexts=function(e,t){var n=Oe.c(this.commentStore.getState()),r=Te.f(this.commentStore.getState()),o=g.n()&&!Oe.a(this.commentStore.getState());Ne(this.commandFactory.selectAcrossContexts(void 0,{direction:e,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:void 0},t,r.nextPopulatedContextDetails,o),n,this.commentStore,(function(){}))},e}(),kn=n(1039),Rn=n(819),wn={PostHeight:69,ExpandButtonHeight:26,ReplyDraftHeight:44,TaskTopper:29};function Nn(e){var t=e.itemCount,n=e.readOnly,r=e.isTask,o=wn.PostHeight;return t>1&&(o+=wn.PostHeight+0),t>2&&(o+=wn.ExpandButtonHeight+0),n||(o+=wn.ReplyDraftHeight+0),r&&(o+=wn.TaskTopper),o}function Mn(e,t){return function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(o,n),o.prototype.render=function(){var n=Object(r.__assign)(Object(r.__assign)({},t),this.props);return T.createElement(e,n)},o}(T.PureComponent)}var Fn=n(1023);function Ln(e,t){return function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return Object(r.__extends)(o,n),o.prototype.render=function(){return T.createElement(Fn.a,{store:t},T.createElement(e,Object(r.__assign)({},this.props)))},o}(T.PureComponent)}var Vn,Bn=function(){function e(e){var t=this;this.internalHandler=e,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isProcessingEvents?t.internalHandler.apply(t,Object(r.__spread)(e)):t.eventQueue.push(e)}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var e,t;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=Object(r.__values)(this.eventQueue),o=n.next();!o.done;o=n.next()){var a=o.value;this.handler.apply(this,Object(r.__spread)(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.eventQueue=[]}},e}();!function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"}(Vn||(Vn={}));var Hn,Un=n(584),Gn=n(165),Wn=n(221),qn=n(351),zn=(i.d.reserveTag(595723983),i.d.reserveTag(595723984),i.d.reserveTag(574456150)),Yn=i.d.reserveTag(574456151),Kn=i.d.reserveTag(574456152),Xn=i.d.reserveTag(574456153),Jn=n(869),Qn=function(){function e(e,t){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),e&&(this.mockId=e),t&&(this.mockContents=t)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}(),Zn=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(e){this.mockContents=e},e.prototype.getId=function(){return this.mockId},e}();!function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"}(Hn||(Hn={}));var $n=function(){function e(e){this.mockContents="",this.mockId="",e&&(this.mockId=e)}return e.prototype.getId=function(){return this.mockId},e}(),er=function(){function e(e,t){var n=this;this.viewManager=e,this.mockUIDriver=t,this.pendingActionReason=Hn.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(){var e=n.commentStore.getState();return Oe.a(e)?Oe.c(e):n.viewManager.getComponentTreeForRenderMode(l.e.Integrated)},this.getCompleteHostableCommentCardRendererOwnProps=function(e){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getHostableCommentCardRendererProps(l.e.Integrated)),{resource:{id:e},componentInstanceId:Object(s.a)()})},this.getCompletePaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(e){var t=n.commentStore.getState(),r=n.commentStore.dispatch;return Oe.a(t)?Object(Un.b)(r,n.getCompletePaneOwnProps()):Object(Un.a)(r,n.getCompleteHostableCommentCardRendererOwnProps(e))},this.getNewThreadDraftId=function(){return Object(he.F)(Te.h(n.commentStore.getState()),!0)},this.getParentId=function(e){var t=n.commentStore.getState(),r=Te.d(t),a=r.findIndex((function(t){return t.commentId===e}));return Object(o.i)(r[a])},this.invokeModalDialog=function(e,t,r){var o={renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,trackback:i.d.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},a=n.commentStore.dispatch,s=n.getCompletePaneOwnProps(),c=Object(Un.b)(a,s),d=n.commentStore.getState(),u=Te.r(d);switch(e){case Gn.a.CancelNewDraft:case Gn.a.CancelReplyDraft:case Gn.a.CancelPostEdit:return c.discardDraftAsync(o,Ce.a.SharedComments,!1);case Gn.a.DeleteThread:return u&&c.requestDeleteThread(o,u.selectedCardId),Promise.resolve(En.a.Handled);case Gn.a.ClosePaneDraft:return Wn.p({ownProps:s,dispatchProps:c,componentTree:n.getActiveComponentTree(),draftState:Te.h(d),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(En.a.Handled);default:Object(i.m)(e)}},this.updateEventProcessingState=function(e){var t=Te.o(n.previousStoreState),r=Te.o(e);!t&&r&&n.pauseProcessing(),t&&!r&&n.beginProcessing()},this.handleStoreUpdate=function(){var e=n.commentStore.getState(),t=Te.h(e),r=Te.h(n.previousStoreState);!Object(ve.d)(t)&&n.pendingActionReason===Hn.NeedNotDrafting&&n.pendingAction&&(Object(d.i)().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Hn.None);var o=Object(ve.b)(t),a=Object(ve.b)(r);o&&!a&&n.pendingActionReason===Hn.NeedDrafting&&n.pendingAction&&(Object(d.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Hn.None),n.updateEventProcessingState(e),n.previousStoreState=e},this.onDrafting=function(e){var t=Object(d.i)().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);Object(ve.b)(Te.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!1,d.d.SystemMetadata),e(),t.successTag(592269460)):(t.addDataField("ActionDeferred",!0,d.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Hn.NeedDrafting,t.successTag(592269461))},this.onNotDrafting=function(e){var t=Object(d.i)().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);Object(ve.d)(Te.h(n.commentStore.getState()))?(t.addDataField("ActionDeferred",!0,d.d.SystemMetadata),n.pendingAction=e,n.pendingActionReason=Hn.NeedNotDrafting,t.successTag(592269462)):(t.addDataField("ActionDeferred",!1,d.d.SystemMetadata),e(),t.successTag(592269463))},this.runAction=function(e,t){switch(e){case Hn.NeedDrafting:return n.onDrafting(t);case Hn.NeedNotDrafting:return n.onNotDrafting(t);case Hn.None:return t()}},this.onMockUIAction=new Bn((function(e){var t=Object(d.i)().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);t.addDataField("MockUIActionType",e.actionType,d.d.SystemMetadata);try{switch(e.actionType){case Vn.CreateThread:!function(e){return e.actionType===Vn.CreateThread&&void 0!==e.content}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464):n.runAction(Hn.NeedDrafting,(function(){return n.onCreateOrReply(new Qn(n.getNewThreadDraftId(),e.content))}));break;case Vn.CancelCreateThread:!function(e){return e.actionType===Vn.CancelCreateThread}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelCreateThread(new Qn(n.getNewThreadDraftId()))}));break;case Vn.StartReplySession:!function(e){return e.actionType===Vn.StartReplySession&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466):n.runAction(Hn.NeedNotDrafting,(function(){return n.onStartReplySession(new Qn(e.threadId))}));break;case Vn.CancelReplySession:!function(e){return e.actionType===Vn.CancelReplySession&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelReplySession(new Qn(e.threadId))}));break;case Vn.PostReply:!function(e){return e.actionType===Vn.PostReply&&void 0!==e.threadId&&void 0!==e.content}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468):n.runAction(Hn.NeedDrafting,(function(){return n.onCreateOrReply(new Qn(e.threadId,e.content))}));break;case Vn.DeleteComment:!function(e){return e.actionType===Vn.DeleteComment&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469):n.runAction(Hn.NeedNotDrafting,(function(){return n.onDeleteComment(e.commentId)}));break;case Vn.DeleteThread:!function(e){return e.actionType===Vn.DeleteThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470):n.runAction(Hn.NeedNotDrafting,(function(){return n.onDeleteThread(e.threadId)}));break;case Vn.ResolveThread:!function(e){return e.actionType===Vn.ResolveThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471):n.runAction(Hn.NeedNotDrafting,(function(){return n.onResolveThread(e.threadId)}));break;case Vn.ReopenThread:!function(e){return e.actionType===Vn.ReopenThread&&void 0!==e.threadId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472):n.runAction(Hn.NeedNotDrafting,(function(){return n.onReopenThread(e.threadId)}));break;case Vn.StartEditSession:!function(e){return e.actionType===Vn.StartEditSession&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473):n.runAction(Hn.NeedNotDrafting,(function(){return n.onStartEditSession(e.commentId)}));break;case Vn.CancelEditSession:!function(e){return e.actionType===Vn.CancelEditSession&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474):n.runAction(Hn.NeedDrafting,(function(){return n.onCancelEditSession(new Zn(e.commentId))}));break;case Vn.PostEdit:if(function(e){return e.actionType===Vn.PostEdit&&void 0!==e.commentId&&void 0!==e.content}(e)){var r=new Zn(e.commentId);r.setContents(e.content),n.runAction(Hn.NeedDrafting,(function(){return n.onPostEdit(r)}))}else Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Vn.SelectComment:!function(e){return e.actionType===Vn.SelectComment&&void 0!==e.commentId}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504):n.runAction(Hn.NeedNotDrafting,(function(){return n.onSelectComment(new $n(e.commentId))}));break;case Vn.ClosePane:n.onClosePane();break;case Vn.ClickGhostCard:!function(e){return e.actionType===Vn.ClickGhostCard}(e)?Object(d.i)().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505):n.runAction(Hn.NeedNotDrafting,(function(){return n.onGhostCommentClicked()}));break;default:Object(i.m)(e.actionType)}}catch(e){return void t.failTag(592269507,Object(Zt.a)(e))}t.successTag(592269508)})),this.onStartEditSession=function(e){var t=n.commentStore.getState();Wn.E({trackback:i.d.reserveTag(592269509),id:e,data:n.getRenderableItems(t),selectedComment:Te.r(t),renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(e,t){Wn.m({componentTree:n.getActiveComponentTree(),focusManager:n.viewManager.getFocusManager(),trackback:i.d.reserveTag(592269510),id:e,renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:t})},this.onClosePane=function(){var e=n.commentStore.getState();if(Oe.b(e)){var t=n.commentStore.dispatch;Object(Un.b)(t,n.getCompletePaneOwnProps()).requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:De.a.None,trackback:i.d.reserveTag(592269511)})}else Object(d.i)().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(e){var t=e.getId(),r=n.commentStore.getState(),a=Te.h(r),s=Object(he.J)(a),c=s&&"CREATE"===s.commentDraft.sessionConfiguration.sessionType?{type:"CREATE"}:{type:"REPLY",parentId:t};Wn.c({trackback:i.d.reserveTag(592269513),commentCardRef:e,draftState:a,areMentionsEnabled:Object(he.i)(Te.n(r),Te.a(r))===o.b.Enabled,session:c,componentTree:n.getActiveComponentTree(),dispatchProps:n.getDispatchProps(t),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:Jn.a.Programmatic,selectedTaskAssignee:s&&s.selectedTaskAssignee}).catch(Object(S.a)(i.d.reserveTag(592269514)))},this.onCancelCreateThread=function(e){var t=e.getId(),r=n.getDispatchProps(t),o=n.commentStore.getState(),a=Te.r(o),s=Te.h(o),c=Oe.b(o),d=n.getActiveComponentTree().componentTreeId.renderContextType,u=Te.s(o),l=(null==a?void 0:a.selectedCardId)===e.getId()&&Object(qn.b)(c,d,s,a,u),m=$e.f(n.getRenderableItemThreads(o,n.getActiveComponentTree()),t);Wn.e({trackback:i.d.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:r,closeOnDiscard:l,cardId:t,draftState:s,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:m})},this.onGhostCommentClicked=function(){Oe.b(n.commentStore.getState())||Object(d.i)().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(E.d.Next,n.getActiveComponentTree().componentTreeId.renderContextType)},this.onPostEdit=function(e){var t=n.commentStore.getState(),r=n.getParentId(e.getId());Wn.C({trackback:i.d.reserveTag(592269518),id:e.getId(),data:n.getRenderableItems(t),draftState:Te.h(t),contentPromise:e.getContentsAsync(),atMentionsEnabled:Object(he.i)(Te.n(t),Te.a(t))===o.b.Enabled,componentTree:n.getActiveComponentTree(),actionDispatchers:n.getDispatchProps(r),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:Jn.a.Programmatic}).catch(Object(S.a)(i.d.reserveTag(592269519)))},this.onCancelEditSession=function(e){var t=n.commentStore.getState(),r=Te.h(t),o=Te.r(t),a=Oe.b(t),s=Te.s(t),c=Object(qn.b)(a,n.getActiveComponentTree().componentTreeId.renderContextType,r,o,s),d=n.getRenderableItems(t),u=n.getParentId(e.getId()),l=n.getDispatchProps(u);Wn.z({trackback:i.d.reserveTag(592269521),commentId:e.getId(),setContents:e.setContents.bind(e),data:d,draftState:r,shouldClosePaneAfterDiscardDraft:c,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,dispatchProps:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onCancelReplySession=function(e){var t=n.commentStore.getState(),r=Te.r(t),o=Te.h(t),a=e.getId(),s=n.getDispatchProps(a),c=Oe.b(t),d=n.getActiveComponentTree().componentTreeId.renderContextType,u=Te.s(n.commentStore.getState()),l=(null==r?void 0:r.selectedCardId)===e.getId()&&Object(qn.b)(c,d,o,r,u);Wn.e({trackback:i.d.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(),dispatchProps:s,closeOnDiscard:l,cardId:e.getId(),draftState:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(e){var t=n.commentStore.getState(),r=Te.r(t),o=n.getDispatchProps(e);Wn.d({trackback:i.d.reserveTag(592269523),id:e,data:n.getRenderableItems(t),selectedComment:r,componentTree:n.getActiveComponentTree(),invokeModalDialog:n.invokeModalDialog,dispatchProps:o,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!zt.b(t)[e],threadIndex:$e.f(n.getRenderableItemThreads(t,n.getActiveComponentTree()),e),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(e){var t=n.commentStore.getState(),r=Te.r(t),o=n.getParentId(e),a=n.getDispatchProps(o);Wn.D({trackback:i.d.reserveTag(592269524),id:e,data:n.getRenderableItems(t),selectedComment:r,renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,actionDispatchers:a,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})},this.onSelectComment=function(e){var t,r=n.commentStore.getState(),o=Te.g(r,!0),a=n.getNewThreadDraftId(),s=n.getRenderableItems(r),c=e.getId(),u=c===a?o&&{commentModel:o.newComment}:s.find((function(e){return $e.e(e)===c}));if(u&&Object(tt.a)(u)){var l=u,m=n.getDispatchProps(null!==(t=l.commentModel.parentId)&&void 0!==t?t:l.commentModel.commentId),f=Te.r(r),p=Te.h(r),C=n.getActiveComponentTree(),g=Object(Ee.a)($e.i(u),Te.j(r),C.componentTreeId.renderContextType);Wn.J({trackback:i.d.reserveTag(592269526),renderableItem:u,selectedComment:f,cardCollapsedState:g,dispatchProps:m,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:C,draftState_deprecated:p}).catch(Object(S.a)(i.d.reserveTag(590123734)))}else Object(d.i)().assertConditionTag(!1,"Selection coming from an unknown post?",592269525)},this.onStartReplySession=function(e){Wn.a({trackback:i.d.reserveTag(592269527),threadId:e.getId(),renderContextType:n.getActiveComponentTree().componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(e.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getRenderableItems=Te.z(),this.getRenderableItemThreads=Te.y(this.getRenderableItems)}return e.prototype.initialize=function(){var e=Object(d.i)().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),e.successTag(Kn)},e.prototype.teardown=function(){var e,t=Object(d.i)().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);null===(e=this.registrationToken)||void 0===e||e.unsubscribe(),this.unsubscribeStoreListener(),t.successTag(Xn)},e.prototype.beginProcessing=function(){var e=this,t=Object(d.i)().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.startProcessingActionsPending=setTimeout((function(){e.onMockUIAction.startProcessing(),e.startProcessingActionsPending=void 0,t.successTag(zn)}),100)},e.prototype.pauseProcessing=function(){var e=Object(d.i)().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),d.a.None,d.b.FullEvent);this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),e.successTag(Yn)},e.prototype.onReopenThread=function(e,t){Wn.l({trackback:i.d.reserveTag(592269528),id:e,renderContextType:this.getActiveComponentTree().componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(e),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:t})},e}(),tr=n(718);var nr=n(700);function rr(e,t,n,r){return function(o){return Object(l.f)().registerExtension(t,n,r).then((function(t){return o(Object(nr.a)(e,t)),t}))}}var or=n(579);var ar,ir=n(564),sr=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(e,t,n){this.hostableComponentRegistry.has(e)||this.hostableComponentRegistry.set(e,new Map);var r=this.hostableComponentRegistry.get(e);n?r.set(t,n):r.delete(t)},e.prototype.getComponent=function(e,t){var n=this.hostableComponentRegistry.get(e);if(n)return n.get(t)},e}(),cr=function(e){function t(t){var n=e.call(this,t)||this;return t.initializeImmediately&&n.beginInitialization(),n}return Object(r.__extends)(t,e),t}(function(){function e(e){var t=this,n=e.apiContext,r=e.viewProvider,o=e.commentAPI,a=e.peopleAPI,c=e.localizationAPI,d=e.themeAPI,u=e.focusManager,m=e.lppManager,f=e.initializationReason,p=e.commentStore,C=e.viewStrategyFactory,h=e.mockUIDriver;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(e){t.commentStore.dispatch(pe.onInitialRender({renderContextType:De.a.None,trackback:i.d.reserveTag(595646478),telemetryVisitor:t.telemetryVisitor},{commentId:e.commentId,renderContextType:e.renderContextType})),Object(Pe.b)(e.renderContextType)&&t.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Object(an.a)((function(){P.sendCodeMarker({context:t.apiContext,type:D.DataReceived,assertTag:i.d.reserveTag(595731293)})})),this.getComponentTree=function(e){switch(e){case De.a.None:Object(i.n)(!1,"Unexpected render context type:"+e,i.d.reserveTag(589088338));case De.a.FullPane:case De.a.HalfPane:return t.getComponentTreeForRenderMode(l.e.TaskPaneItem);case De.a.DiscreteIntegrated:return t.getComponentTreeForRenderMode(l.e.Integrated);case De.a.DiscreteIsolated:return t.getComponentTreeForRenderMode(l.e.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:t.commentAPI,localizationAPI:t.localizationAPI,peopleAPI:t.peopleAPI,focusManager:t.focusManager,telemetryVisitor:t.telemetryVisitor,onInitialRender:t.onInitialRender,correlationId:t.correlationId,lppManager:t.lppManager}},this.setComponentRef=function(e,n,r){t.viewManagerRefRegistry.registerComponent(e,n,r)},this.onSuggestionsDetailsChange=function(e){t.commentStore.dispatch(pe.updateSuggestionsDetails({renderContextType:De.a.None,trackback:i.d.reserveTag(592492758),telemetryVisitor:t.telemetryVisitor},e))},this.internalInterruptableCommandHandler=function(e){return t.activeViewStrategy.handleCommentInterruptableCommand(e,t.commentStore.dispatch,t.commentStore.getState)},this.apiContext=n,this.viewProvider=r,this.commentAPI=o,this.peopleAPI=a,this.localizationAPI=c,this.themeAPI=d,this.focusManager=u,this.lastInitializationReason=f,this.viewStrategyFactory=C,this.mockUIDriver=h,this.telemetryVisitor=L.getTelemetryVisitor(this.apiContext),this.correlationId=L.getCorrelationId(this.apiContext)||Object(s.a)(),this.lppManager=m,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new An(p,this.telemetryVisitor);var b=p.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(b.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor),this.commentStore=p,this.discreteIntegratedComponentTree=new kt(De.a.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new kt(De.a.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new sr,g.n()&&this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new er(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var e,t;(0,this.commentStore.dispatch)((e={renderContextType:De.a.None,trackback:i.d.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},t=this.commentAPI,function(n){var r=Object(d.i)().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);return t.checkAtMentionCapability().then((function(t){r.addDataField("AtMentionsEnabled",t,d.d.SystemMetadata),r.successTag(595903522),n(Object(or.a)(e,t?ut.b.Enabled:ut.b.Disabled))}),(function(t){r.failTag(595903523,Object(Zt.a)(t,-2130957528)),n(Object(or.a)(e,ut.b.Disabled))}))})).catch(Object(S.a)(i.d.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var e,t;this.initialized||(this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),g.n()||this.registerActions(),void 0!==this.commentAPI.registerForInterruptableCommands&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),g.n()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),g.l()&&g.G()||(this.commentStore.dispatch(pe.updateCapabilities_deprecated({renderContextType:De.a.None,trackback:i.d.reserveTag(595732560),telemetryVisitor:this.telemetryVisitor},{resolve:this.commentAPI.resolveSupported()})),g.G()&&this.commentStore.dispatch(pe.updateModelCapabilities({renderContextType:De.a.None,trackback:i.d.reserveTag(595685378),telemetryVisitor:this.telemetryVisitor},this.commentAPI.resolveSupported()?Ke.Resolve:Ke.None,he.f))),this.peopleAPI.capabilities&xn.a.GetSuggestionsDetails&&(this.commentStore.dispatch((e={renderContextType:De.a.None,trackback:i.d.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},t=this.peopleAPI,function(n){if(!(t.capabilities&xn.a.GetSuggestionsDetails))return Promise.resolve();var r=Object(d.i)().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,d.a.OnSuccess,d.b.NecessaryServiceDataEvent);return t.getSuggestionsDetails?t.getSuggestionsDetails().then((function(t){r.successTag(592492760),n(Object(tr.a)(e,t))}),(function(e){r.failTag(592492761,-2130957495)})):(r.failTag(592492759,-2130957494),Promise.resolve())})).catch(Object(S.a)(i.d.reserveTag(592492754))),Object(d.i)().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(e){!this.initialLoadComplete&&e&&void 0===Te.o(e)&&Te.k(e)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(e){var t,n=this;return e.subscribe((function(){var r=e.getState();if(g.n()){var o=Te.o(r);o!==t&&(t=o,n.onChange(r))}}))},e.prototype.onFirstLoadComplete=function(){var e=this;Object(d.i)().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach((function(t){e.onCommentUIAction(t)})),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Dn.a.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Dn.a.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(e){switch(e){case l.e.Integrated:return this.discreteIntegratedComponentTree;case l.e.Isolated:return this.discreteIsolatedComponentTree;case l.e.TaskPane:case l.e.TaskPaneItem:return Oe.c(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId})},e.prototype.getHostableCommentCardRendererProps=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(e),setComponentRef:function(n,r){t.setComponentRef(e,n,r)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(e,t,n){var o=this,a=Ln(Mn(n.HostableCommentCardRendererContainer,Object(r.__assign)({},this.getHostableCommentCardRendererProps(e))),this.commentStore),i=_(t,this.apiContext),s=Object(y.c)().registerComponent(i,a);return s.onComponentCommand.subscribe((function(t){o.processHostableComponentCommand(t,e)})),{componentController:s,contextAwareName:i}},e.prototype.initializeContentExtensions=function(){var e=this;Object(ir.c)("ExtensionAwareCommentPaneContainer").then((function(t){var n;if(void 0!==t){var o=Ln(Mn(t.ExtensionAwareCommentPane,Object(r.__assign)(Object(r.__assign)({},e.getPaneOwnProps()),{extensionRenderMode:l.e.Integrated,themeAPI:e.themeAPI})),e.commentStore),a=_("SharedCommentPane",e.apiContext);e.commentPaneComponentController=Object(y.c)().registerComponent(a,o),g.T()&&e.commentStore.dispatch(rr({renderContextType:De.a.None,trackback:i.d.reserveTag(573384478),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,a,{renderMode:l.e.TaskPane,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:void 0})).catch(Object(S.a)(i.d.reserveTag(573384479)))}Object(ir.c)("HostableCommentCardRendererContainer").then((function(t){if(void 0!==(n=t)){var r=e.registerCommentCardHostableComponent(l.e.Integrated,"DiscreteIntegratedCommentCard",n),o=r.componentController,a=r.contextAwareName;e.discreteIntegratedComponentController=o;var s=e.registerCommentCardHostableComponent(l.e.Isolated,"DiscreteIsolatedCommentCard",n),c=s.componentController,d=s.contextAwareName;e.discreteIsolatedComponentController=c;var u=e.registerCommentCardHostableComponent(l.e.TaskPaneItem,"TaskPaneItemCommentCard",n),m=u.componentController,f=u.contextAwareName;e.commentPaneItemComponentController=m,e.commentStore.dispatch(rr({renderContextType:De.a.None,trackback:i.d.reserveTag(574428426),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,a,{renderMode:l.e.Integrated,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(S.a)(i.d.reserveTag(595645980))),e.commentStore.dispatch(rr({renderContextType:De.a.None,trackback:i.d.reserveTag(595616916),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,d,{renderMode:l.e.Isolated,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize(),isContentAvailable:function(t){var n=e.commentStore.getState(),r=Object(Rn.c)(t,Te.d(n),Te.c(n)),o=Te.h(n);return Object(Rn.a)(t,Object(Rn.b)(t,Te.d(n),r,Te.g(n,!0),o.drafts[t],Object(he.F)(o)),o,De.a.DiscreteIsolated,Object(kn.a)(t,De.a.DiscreteIsolated,o))}})).catch(Object(S.a)(i.d.reserveTag(595645982))),e.commentStore.dispatch(rr({renderContextType:De.a.None,trackback:i.d.reserveTag(546174344),telemetryVisitor:e.telemetryVisitor},l.b.CommentThread,f,{renderMode:l.e.TaskPaneItem,priority:l.d.Disabled,instanceId:e.apiContext,componentDimensions:e.getAverageCardSize()})).catch(Object(S.a)(i.d.reserveTag(546174345)))}})).catch(Object(S.a)(i.d.reserveTag(595645984)))})).catch(Object(S.a)(i.d.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:259,height:Nn({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(e,t){var n=this;switch(e.command){case"Focus":return void setTimeout((function(){var r;return null===(r=n.viewManagerRefRegistry.getComponent(t,e.details.componentInstanceId))||void 0===r?void 0:r.focus()}));case"UpdateComponentDataProps":break;default:return void Object(d.i)().assertConditionTag(!1,"Unexpected command type",593786644)}},e.prototype.teardownContentExtensions=function(){var e,t,n,o,a=[l.e.Integrated,l.e.Isolated,l.e.TaskPaneItem];g.T()&&a.push(l.e.TaskPane),this.commentStore.dispatch(pe.removeContentExtensions.apply(pe,Object(r.__spread)([{renderContextType:De.a.None,trackback:i.d.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],a))),null===(e=this.commentPaneComponentController)||void 0===e||e.unregister(),null===(t=this.commentPaneItemComponentController)||void 0===t||t.unregister(),null===(n=this.discreteIntegratedComponentController)||void 0===n||n.unregister(),null===(o=this.discreteIsolatedComponentController)||void 0===o||o.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Dn.a.AddComment),this.commentAPI.unregisterForAction(Dn.a.NextThread),this.commentAPI.unregisterForAction(Dn.a.PreviousThread),this.commentAPI.unregisterForAction(Dn.a.DeleteThread),this.commentAPI.unregisterForAction(Dn.a.BackKeyPressed),this.commentAPI.unregisterForAction(Dn.a.ShowHideCommentPane),void 0!==this.commentAPI.unregisterForInterruptableCommands&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&xn.a.GetSuggestionsDetails&&(Object(d.i)().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),g.n()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(e){this.commentUIActionListeners.push(e)},e.prototype.unregisterComponentUIActionListener=function(e){var t=this.commentUIActionListeners.indexOf(e);t>-1&&this.commentUIActionListeners.splice(t,1)},e.prototype.registerInterruptableCommandListener=function(e){this.commentInterruptableCommandListeners.push(e)},e.prototype.unregisterComponentInterruptableCommandListener=function(e){var t=this.commentInterruptableCommandListeners.indexOf(e);t>-1&&this.commentInterruptableCommandListeners.splice(t,1)},e.prototype.onCommentUIAction=function(e){var t,n;if(g.n()&&e.actionBehavior===Sn.a.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(e),!0;try{for(var o=Object(r.__values)(this.commentUIActionListeners),a=o.next();!a.done;a=o.next()){var i=(0,a.value)(e);if(i!==jn.a.NotHandled)return i===jn.a.Success}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this.activeViewStrategy.processCommentUIAction(e,this.commentStore.dispatch,this.commentStore.getState)===jn.a.Success},e.prototype.onCommentEventReceived=function(e,t){var n=Object(i.k)(i.b.Comments,_n.a[e]);this.activeViewStrategy.processCommentEvent(e,t,this.commentStore.dispatch,this.commentStore.getState),null==n||n.end(),g.n()&&!this.initialLoadComplete&&e===_n.a.CommentContextChanged&&Pn.b(t)&&0===t.numberOfComments&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(e){var t=Promise.resolve(En.a.Unhandled);return this.commentInterruptableCommandListeners.reduce((function(t,n){return t.then((function(t){return t!==En.a.Unhandled?Promise.resolve(t):n(e)}))}),t)},e.prototype.onViewContainerEvent=function(e){var t=this,n=this.commentStore.dispatch;switch(e.eventType){case B.a.VisibilityChanged:return void n(pe.viewContainerVisibilityChanged({renderContextType:De.a.None,trackback:i.d.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},e.viewContainerVisibilityState));case B.a.ViewContainerChanged:return n(pe.viewContainerChanged({renderContextType:De.a.None,trackback:i.d.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},e.newViewContainer)),void(this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(e.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor));case B.a.FocusTriggered:return void(g.T()&&g.O()?setTimeout((function(){t.focusManager.focusCommentPaneCommand(Oe.c(t.commentStore.getState()))})):this.focusManager.focusCommentPaneCommand(Oe.c(this.commentStore.getState())));case B.a.FoldableLayoutStateChanged:n(pe.viewContainerFoldableLayoutStateChanged({renderContextType:De.a.None,trackback:i.d.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},e.newFoldableLayoutState))}},e}()),dr=function(){function e(e,t){}return e.prototype.getAccountID=function(){return""},e.prototype.getLPPController=function(){},e.prototype.ensureLPPController=function(){throw new Error("ensureLPPController not supported in Web")},e.prototype.initializeController=function(e){},e.prototype.isInitialized=function(){return!1},e.prototype.isOnline=function(){return!1},e.prototype.refreshLPPController=function(){},e}(),ur=n(975),lr=function(){function e(){this.maxAcceptableInterval=3e3,this.lastHeartbeatReceived=0,this.timerStarted=!1}return e.prototype.heartbeatReceived=function(){var e,t,n=this;this.lastHeartbeatReceived=Date.now(),null===(t=(e=Object(d.i)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(le.a)(ar||(ar=Object(r.__makeTemplateObject)(["Native HeartbeatReceived"],["Native HeartbeatReceived"]))),i.d.reserveTag(540361865),d.h.Info,d.c.ProductServiceUsage,Object(d.j)(d.g.ReviewedAsNotNecessary),Object(d.l)("HeartbeatTimestamp",this.lastHeartbeatReceived,d.d.SystemMetadata)),this.timerStarted||(this.timerStarted=!0,setInterval((function(){n.checkHeartbeatInterval()}),this.maxAcceptableInterval))},e.prototype.checkHeartbeatInterval=function(){var e=Date.now()-this.lastHeartbeatReceived;e>this.maxAcceptableInterval&&Object(d.i)().assertConditionTag(!1,"Max heartbeat interval exceeded: "+e,561071552)},e}(),mr=n(188),fr=n(359),pr=n(439),Cr=n(360),gr=n(382),hr=n(247),br=function(){function e(e,t,n,r,o){this.localizationAPI=e,this.peopleAPI=t,this.commentAPI=n,this.selectionManager=r,this.telemetryVisitor=o,this.getDraftRenderContextType=Te.x(),this.getRenderableItems=Te.z()}return e.prototype.processCommentEvent=function(e,t,n,r){var o,a=r();switch(e){case _n.a.CommentContextChanged:if(!Pn.b(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912090);n(pe.commentContextChanged({renderContextType:De.a.None,trackback:i.d.reserveTag(595912089),telemetryVisitor:this.telemetryVisitor},t));break;case _n.a.CommentsChanged:if(!Pn.i(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912091);break;case _n.a.LoadComments:if(!Pn.j(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912092);break;case _n.a.CommentSelected:if(!Pn.h(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912096);if(t.commentId){var s=void 0;if(void 0!==Te.c(a)[t.commentId])s=Object(Cr.a)(t.commentId,Ce.a.Canvas,{selectType:t.selectionReason&&"ContentNavigation"===t.selectionReason.type&&t.selectionReason.contentNavigationReason===E.c.Keyboarding?pe.SelectActionType.SelectCard:pe.SelectActionType.ExpandCard});else{var c=Te.d(a).find((function(e){return e.commentId===t.commentId}));if(void 0===c)return;s=Object(Cr.a)(c.parentId,Ce.a.Canvas,{selectType:pe.SelectActionType.SelectPost,selectedPost:t.commentId})}n(Object(Cr.b)(void 0,{renderContextType:De.a.None,trackback:i.d.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},s,!1)).catch(Object(S.a)(i.d.reserveTag(579744150)))}else n(pe.clearCommentSelection({renderContextType:De.a.None,trackback:i.d.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));break;case _n.a.CommentContextReload:if(!Pn.d(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912097);break;case _n.a.CommentHighlighted:if(!Pn.f(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912128);t.commentId?n(pe.highlightComment({renderContextType:De.a.None,trackback:i.d.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},t.commentId,Ce.a.Canvas)):n(pe.clearCommentHighlight({renderContextType:De.a.None,trackback:i.d.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},Ce.a.Canvas,void 0));break;case _n.a.NextPopulatedContextDetailsUpdated:if(!Pn.l(t)||!t.contextDetails.nextPopulatedContextDetails)return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912130);n(pe.nextPopulatedContextDetailsUpdated({renderContextType:De.a.None,trackback:i.d.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},t.contextDetails.nextPopulatedContextDetails));break;case _n.a.CommentHostCapabilitiesChanged:Pn.g(t)?n(pe.updateCapabilities_deprecated({renderContextType:De.a.None,trackback:i.d.reserveTag(595732558),telemetryVisitor:this.telemetryVisitor},t.capabilities)):Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595732559);break;case _n.a.ModelCapabilitiesChanged:Pn.k(t)?n(pe.updateModelCapabilities({renderContextType:De.a.None,trackback:i.d.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},t.modelCapabilityFlags,t.richTextCapabilityFlags)):Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595616784);break;case _n.a.CommentError:if(!Pn.e(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",595912131);break;case _n.a.ReturnToDraftRequested:Pn.m(t)&&n(pe.displayDraftWarning({draftWarningType:rn.a.ReturnToDraft,draftWarningReason:hr.a.HostRequest},{renderContextType:De.a.None,trackback:i.d.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break;case _n.a.UpdateDraftThread:Pn.o(t)?n(pe.updateDraftThread({renderContextType:De.a.None,trackback:i.d.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},t)):Object(d.i)().assertConditionTag(!1,"Invalid eventPayload",594023372);break;case _n.a.SmartReplyPopulated:if(!Pn.n(t))return void Object(d.i)().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);n(pe.populateSmartReply({renderContextType:De.a.None,trackback:i.d.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},t));break;case _n.a.NativeHeartbeat:this.heartbeatHelper||(this.heartbeatHelper=new lr),null===(o=this.heartbeatHelper)||void 0===o||o.heartbeatReceived();break;default:return void Object(d.i)().assertConditionTag(!1,"Deprecated event detected.",595912132)}},e.prototype.processCommentUIAction=function(e,t,n,r){var o=this,a=n();switch(e.actionType){case Dn.a.ShowHideCommentPane:return jn.c(e.actionBehavior)?Oe.b(a)?jn.a.Success:jn.a.Fail:(jn.d(e.actionBehavior)&&(Oe.b(a)?t(pe.requestClosePane({renderContextType:De.a.None,trackback:i.d.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):t(pe.requestShowPane({renderContextType:De.a.None,trackback:i.d.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),jn.a.Success);case Dn.a.AddComment:if(jn.b(e.actionBehavior)){if(!Ve(Te.h(a)))return jn.a.Fail}else if(jn.d(e.actionBehavior)){var s={renderContextType:De.a.None,trackback:i.d.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return t(Object(fr.a)(s,this.commentAPI,{sessionType:"CREATE"},!(!r||!r.retainSelectionOnAddComment),this.peopleAPI)).catch(Object(S.a)(i.d.reserveTag(592314376))),jn.a.Success}return jn.a.Success;case Dn.a.NextThread:if(Object(d.i)().assertConditionTag(!jn.c(e.actionBehavior),"This action type does not support toggled status",595899713),jn.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:E.d.Next,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:[l.b.CommentThread]},E.c.HostAction,De.a.None)}),t,g.mb()?void 0:hr.a.NextThread,i.d.reserveTag(591729749));else if(jn.b(e.actionBehavior))return Be(a)?jn.a.Success:jn.a.Fail;return jn.a.Success;case Dn.a.PreviousThread:if(Object(d.i)().assertConditionTag(!jn.c(e.actionBehavior),"This action type does not support toggled status",595899714),jn.d(e.actionBehavior))this.handleActionOrReturnToDraft((function(){return o.selectionManager.selectNextOrPreviousThread({direction:E.d.Previous,source:Ce.a.SharedComments,expandCard:!0,iterableContentTypes:[l.b.CommentThread]},E.c.HostAction,De.a.None)}),t,g.mb()?void 0:hr.a.PreviousThread,i.d.reserveTag(591729750));else if(jn.b(e.actionBehavior))return Be(a)?jn.a.Success:jn.a.Fail;return jn.a.Success;case Dn.a.DeleteThread:if(Object(d.i)().assertConditionTag(!jn.c(e.actionBehavior),"This action type does not support toggled status",595899715),jn.b(e.actionBehavior)){if(!function(e){return!!e.selectedComment&&He(e.draftState)}(a.commentState))return jn.a.Fail}else jn.d(e.actionBehavior)&&this.handleActionOrReturnToDraft((function(){var e=Te.r(a);e&&t(pe.requestDeleteThread({renderContextType:De.a.None,trackback:i.d.reserveTag(591738706),telemetryVisitor:o.telemetryVisitor},e.selectedCardId))}),t,hr.a.DeleteThread,i.d.reserveTag(591729751));return jn.a.Success}return jn.a.NotHandled},e.prototype.beginDraftingHelper=function(e,t,n,r){return e(Object(fr.a)({renderContextType:De.a.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,t,!1,this.peopleAPI)).catch(Object(S.a)(r)).then((function(){return o.f.Handled}))},e.prototype.handleCommentInterruptableCommand=function(e,t,n){switch(e.type){case"CreateComment":return this.beginDraftingHelper(t,{sessionType:"CREATE"},i.d.reserveTag(574371082),i.d.reserveTag(574371083));case"EditComment":var r=n(),a=this.getRenderableItems(r),s=Te.r(r),c=Object($e.a)(a,e.commentId);return c?Object(Wn.K)({comment:c,threads:a,selectedComment:s,warningType:ye.a.Edit})?(t(pe.showLowFidelityWarning({renderContextType:De.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(593000206)},e.commentId,ye.a.Edit)),Promise.resolve(o.f.Handled)):this.beginDraftingHelper(t,{sessionType:"EDIT",commentId:e.commentId},i.d.reserveTag(593000207),i.d.reserveTag(593000208)):(Object(d.i)().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(o.f.Handled));case"ReplyComment":return this.beginDraftingHelper(t,{sessionType:"REPLY",threadId:e.threadId},i.d.reserveTag(593000209),i.d.reserveTag(593000210));case"DiscardDraft":var u=n();if(e.mode===ur.a.TryAutoDiscard)return t(Object(pr.a)({renderContextType:De.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(575411521)},Ce.a.Canvas)).then((function(e){return e.draftDiscardResult}));s=Te.r(u);if(e.mode===ur.a.Dialog&&Object(gr.a)(Te.h(u))===mr.a.CannotAutoDiscard)return Oe.a(u)?Promise.resolve(o.f.Unhandled):Promise.resolve(o.f.Canceled);var l=Object(qn.b)(Oe.e(u)===V.a.Visible,Object(Ct.a)(Oe.d(u).containerType),Te.h(u),s,Te.s(u));return t(Object(bn.a)({renderContextType:De.a.None,telemetryVisitor:this.telemetryVisitor,trackback:i.d.reserveTag(575411522)},Ce.a.Canvas,l,void 0));default:return Promise.resolve(o.f.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(e,t,n,r){t(Object(pr.a)({renderContextType:De.a.None,trackback:r,telemetryVisitor:this.telemetryVisitor},Ce.a.SharedComments,n)).then((function(t){void 0!==n&&t.draftDiscardBehavior!==mr.a.NoDraft&&t.draftDiscardResult!==o.f.Handled||e()})).catch(Object(S.a)(i.d.reserveTag(591738704)))},e}(),vr=n(707),yr=n(708),Tr=n(710),Or=n(114),Ir=n(716),Sr=n(717);function _r(e,t,n,r){return function(o,a){var s=a();r&&o(r);var c=r?r.actionDetail.telemetryVisitor:t;if(n){if(void 0!==n.topVisibleThreadId&&o(Object(Ir.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953696)},n.topVisibleThreadId||void 0)),void 0!==n.selectedCommentId){var d=Te.r(s);if(n.selectedCommentId)if(d&&d.selectedCardId===n.selectedCommentId)if(Object(ye.j)(d.selectionDetails)){var u=d.selectionDetails.selectedPostId,l=a();Te.d(l).find((function(e){return e.commentId===u}))?o(Object(Or.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953698)},n.selectedCommentId,u,Or.a.SelectPost,Ce.a.Canvas)):o(Object(Or.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953699)},n.selectedCommentId,void 0,Or.a.ExpandCard,Ce.a.Canvas))}else o(Object(Or.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953697)},n.selectedCommentId,void 0,Or.a.SelectCard,Ce.a.Canvas));else o(Object(Or.b)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953728)},n.selectedCommentId,void 0,Or.a.ExpandCard,Ce.a.Canvas));else{var m=!0;if(g.eb())if(d){var f=Te.h(s),p=f.cardIdToDraftIdMap[d.selectedCardId];m=!p||"CREATE"!==f.drafts[p].commentDraft.sessionConfiguration.sessionType}else m=!1;m&&o(Object(yr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953729)}))}}void 0!==n.highlightedCommentId&&(n.highlightedCommentId?o(Object(Tr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953730)},n.highlightedCommentId,Ce.a.Canvas)):o(Object(vr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(578586722)},Ce.a.Canvas,void 0)));var C=Ot(n);C&&o(Object(Sr.a)({renderContextType:e,telemetryVisitor:c,trackback:i.d.reserveTag(595953732)},C))}}}var Dr=n(21),Er=n(392);var jr=n(711),Pr=n(712);function xr(e,t,n){return function(r){Pn.p(t)?r(Object(Pr.a)(Object(Dr.a)(e,i.d.reserveTag(595137280)),t.threads)):(g.J()&&r(Object(Er.a)(Object(Dr.a)(e,i.d.reserveTag(595137282)),t.comments,t.tasks,n)),r(Object(jr.a)(Object(Dr.a)(e,i.d.reserveTag(595137283)),t.comments,t.tasks)))}}var Ar=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.focusManager=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,r){switch(e){case _n.a.CommentsChanged:Pn.i(t)&&n(_r(De.a.None,this.telemetryVisitor,t.contextDetails,Object(pe.applyCommentChanges)({renderContextType:De.a.None,trackback:i.d.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},t.changes)));break;case _n.a.LoadComments:Pn.j(t)&&n(xr({renderContextType:De.a.None,trackback:i.d.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI));break;case _n.a.CommentContextReload:Pn.d(t)&&n((o={renderContextType:De.a.None,trackback:i.d.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},a=t,s=this.peopleAPI,c=this.telemetryVisitor,function(e,t){var n=[];Object(Pn.c)(a)?(Object(d.i)().assertConditionTag(!t||Object(he.M)(Te.n(t()),Te.w(t())),"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),n=Object(gt.a)(a.commentIds,(function(){return t().commentState}))):n=a.comments;var r=Object(Pn.c)(a)?[]:a.tasks;e(_r(o.renderContextType,c,a.contextDetails,Object(pe.reloadComments)(Object(Dr.a)(o,i.d.reserveTag(595953694)),{comments:n,tasks:r}))),g.J()&&e(Object(Er.a)(Object(Dr.a)(o,i.d.reserveTag(595932895)),n,r,s)).catch(Object(S.a)(i.d.reserveTag(595645974)))}))}var o,a,s,c;this.commonViewStrategy.processCommentEvent(e,t,n,r)},e.prototype.processCommentUIAction=function(e,t,n){if(e.actionType===o.d.AddComment&&e.actionBehavior!==o.a.CheckEnabled){var r=n();Oe.b(r)&&this.focusManager.onUserAction(r.paneState.componentTree,{userAction:Xe.a.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(e,t,n)},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}();var kr=n(713);var Rr=function(){function e(e,t,n,r){this.commonViewStrategy=e,this.peopleAPI=t,this.lastInitializationReason=n,this.telemetryVisitor=r}return e.prototype.processCommentEvent=function(e,t,n,o){switch(e){case _n.a.CommentsChanged:Pn.i(t)&&n((a=t,s=this.telemetryVisitor,function(e,t){var n,o,c,u=t(),l=!1,m=a.contextDetails;if(""===(null==m?void 0:m.selectedCommentId)&&(m=Object(r.__assign)(Object(r.__assign)({},m),{selectedCommentId:void 0})),e(_r(De.a.None,s,m,Object(pe.applyCommentChanges)({renderContextType:De.a.None,trackback:i.d.reserveTag(595953743),telemetryVisitor:s},a.changes))),!a.contextDetails||!a.contextDetails.selectedCommentId){var f=Te.r(u),p=f?f.selectedCardId:void 0,C=t(),g=Te.r(C),h=Te.d(u),b=Te.d(C);if(p){if(p&&a.changes.some((function(e){return e.type===lt.a.Delete&&e.model.commentId===p}))){var v=h.findIndex((function(e){return e.commentId===p}));try{for(var y=Object(r.__values)(a.changes),T=y.next();!T.done;T=y.next()){var O=T.value;switch(O.type){case lt.a.Insert:O.index<=v&&++v;break;case lt.a.Delete:O.index<v&&--v;break;case lt.a.Modify:case lt.a.Unknown:case lt.a.Load:break;default:Object(i.m)(O)}}}catch(e){n={error:e}}finally{try{T&&!T.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}if(g)throw new w.a($.l,i.d.reserveTag(589103626),-2130957551);if(b.length){var I=v;I===b.length&&(I=b.length-1);var S=b[I],_=Object(Je.b)(S);e(Object(pe.selectComment)({renderContextType:De.a.None,trackback:i.d.reserveTag(595953744),telemetryVisitor:s},_,void 0,Or.a.ExpandCard,Ce.a.SharedComments)),l=!0}}}else!h.length&&b.length&&(e(Object(pe.selectComment)({renderContextType:De.a.None,trackback:i.d.reserveTag(595947723),telemetryVisitor:s},b[0].commentId,void 0,Or.a.ExpandCard,Ce.a.SharedComments)),l=!0);Object(d.i)().assertConditionTag(l||0===b.length||""!==(null===(c=a.contextDetails)||void 0===c?void 0:c.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}));break;case _n.a.LoadComments:Pn.j(t)&&(o().paneState.initializationStatus===Dt.a.Initialized||this.lastInitializationReason!==R.a.NewThread?n(function(e,t,n,r){return function(o,a){o(xr({renderContextType:e,trackback:i.d.reserveTag(595899530),telemetryVisitor:r},t,n));var s=a(),c=Object(he.M)(Te.n(s),Te.w(s)),d=Te.d(s);Object(ge.a)({commentData:d,pendingCommentLoad:Te.o(s),virtualized:c})&&d.length&&!Te.r(s)&&o(Object(pe.selectComment)({renderContextType:e,trackback:i.d.reserveTag(595953680),telemetryVisitor:r},d[0].commentId,void 0,Or.a.ExpandCard,Ce.a.SharedComments))}}(De.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor)):n(xr({renderContextType:De.a.None,trackback:i.d.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},t,this.peopleAPI)));break;case _n.a.CommentContextReload:Pn.d(t)&&n(function(e,t,n,o){return function(a,s){var c,u,l=s(),m=!1,f=[];Object(Pn.c)(t)?(Object(d.i)().assertConditionTag(Object(he.M)(Te.n(l),Te.w(l)),"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),f=Object(gt.a)(t.commentIds)):f=t.comments;var p=t.contextDetails;""===(null==p?void 0:p.selectedCommentId)&&(p=Object(r.__assign)(Object(r.__assign)({},p),{selectedCommentId:void 0}));var C=Object(Pn.c)(t)?[]:t.tasks;a(_r(e,o,p,Object(kr.a)({renderContextType:e,telemetryVisitor:o,trackback:i.d.reserveTag(595953677)},{comments:f,tasks:C}))),g.J()&&a(Object(Er.a)({renderContextType:e,telemetryVisitor:o,trackback:i.d.reserveTag(595162892)},f,C,n)).catch(Object(S.a)(i.d.reserveTag(595645962)));var h=null===(c=Te.r(l))||void 0===c?void 0:c.selectedCardId,b=Te.d(l),v=s(),y=Te.d(v);if(h){if(!Te.r(v)){var T=b.findIndex((function(e){return e.commentId===h}));if(T<0)return;if(y.length){var O=T;O===y.length&&(O=y.length-1);var I=Object(Je.b)(y[O]);a(Object(pe.selectComment)({renderContextType:e,telemetryVisitor:o,trackback:i.d.reserveTag(595953678)},I,void 0,Or.a.ExpandCard,Ce.a.SharedComments)),m=!0}}}else!b.length&&y.length&&(a(Object(pe.selectComment)({renderContextType:e,telemetryVisitor:o,trackback:i.d.reserveTag(595947722)},y[0].commentId,void 0,Or.a.ExpandCard,Ce.a.SharedComments)),m=!0);Object(d.i)().assertConditionTag(m||0===y.length||""!==(null===(u=t.contextDetails)||void 0===u?void 0:u.selectedCommentId),"Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}(De.a.HalfPane,t,this.peopleAPI,this.telemetryVisitor))}var a,s;this.commonViewStrategy.processCommentEvent(e,t,n,o)},e.prototype.processCommentUIAction=function(e,t,n){return this.commonViewStrategy.processCommentUIAction(e,t,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(e,t,n){return this.commonViewStrategy.handleCommentInterruptableCommand(e,t,n)},e}(),wr=function(){function e(){}return e.prototype.createViewStrategy=function(e,t,n,r,o,a,i,s){var c=new br(t,n,r,o,s);switch(e.containerType){case k.a.HalfPane:return new Rr(c,n,i,s);case k.a.FullPane:return new Ar(c,n,a,s)}},e}();function Nr(e){if(void 0===e.hostCommentAPI)throw new w.a("'hostCommentAPI' was not supplied",i.d.reserveTag(589103634),-2130957511);if(void 0===e.peopleAPI)throw new w.a("'peopleAPI' was not supplied",i.d.reserveTag(589103635),-2130957511);if(void 0===e.viewContainerProvider)throw new w.a("'viewContainerProvider' was not supplied",i.d.reserveTag(589103636),-2130957511);var t=Object(E.f)(e.apiContext),n=Object(m.a)(),r=e.themeAPI||new ue,o=e.hostCommentAPI;o=new se(e.hostCommentAPI);var a=L.getTelemetryVisitor(e.apiContext),s=new ot(n.getLocaleInfo().isRightToLeft,a),c=new dr(e.peopleAPI,e.correlationId||"");g.x()&&c.initializeController(!1);var d=In(o,e.viewContainerProvider,Nt(e.viewContainerProvider.getViewContainer(),e.paneVisible,n.getLocaleInfo(),e.apiContext),L.getTelemetryVisitor(e.apiContext),t,n,s,c);return new cr({apiContext:e.apiContext,viewProvider:e.viewContainerProvider,commentAPI:o,peopleAPI:e.peopleAPI,localizationAPI:n,themeAPI:r,focusManager:s,lppManager:c,initializationReason:e.initializationReason,commentStore:d,viewStrategyFactory:new wr,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver})}function Mr(e,t,r,o,h,b,v,y,O){try{try{if(ee())return void Object(d.i)().assertConditionTag(!1,"View manager singleton cannot be instantiated more than once!",595891844)}catch(e){if(!Object(w.b)(e))throw e}F=Nr,Object(c.b)({appSettings:v||{},mapping:J.a}),Object(d.k)(Z,t),Object(d.i)().assertConditionTag(!!v,"appSettings should not be undefined",595616278);var I=Object(m.b)(h);Object(u.c)(I.getLocaleInfo().isRightToLeft),function(e){var t=n(1569),r=n(1570),o=Object(u.a)()?n(1571):n(1572),a=n(1573),i=n(1574),s=n(1575),c=n(1576),d=n(1577),l=n(1578),m=n(1579),f=n(1102),p={HintBarEllipses_16:T.createElement(t,null),CancelGlyph:T.createElement(r,null),NewComment:T.createElement(o,null),CancelGlyph_TaskPane:T.createElement(a,null),Send2_Fluent:T.createElement(i,null),Delete_Fluent:T.createElement(s,null),Edit_Fluent:T.createElement(c,null),Checkmark_Fluent:T.createElement(d,null),CommentReopen_Fluent:T.createElement(l,null),Error:T.createElement(m,null),ReopenThread:T.createElement(f,null)};if(e||g.b()){var C=n(1580),h=n(1581),b=n(1582),v=n(1583),y=n(1102),O=n(1584),I=n(1585);p.TaskAssign=T.createElement(C,null),p.TaskComplete=T.createElement(h,null),p.TaskDelete=T.createElement(b,null),p.TaskEdit=T.createElement(v,null),p.TaskReopen=T.createElement(y,null),p.TaskStatusCircleCheckmark=T.createElement(O,null),p.ChevronDown12=T.createElement(I,null)}if(e||g.a()){var S=n(1586),_=n(1587);p.CommentLikeEmpty=T.createElement(S,null),p.CommentLikeSolid=T.createElement(_,null)}if(e||g.A()){var D=n(1588);p.LinkToComment=T.createElement(D,null)}Object(Q.hb)({icons:p})}();var _=e,D=Object(s.a)(),E=(j=a.a,new U(j,o));L.ensureViewManager({apiContext:a.a,displayMode:C.c.FullPane,foldableLayoutState:C.a.Indeterminate,initializationReason:b||R.a.PaneOpen,correlationId:D,viewContainerProvider:E,peopleAPI:r,hostCommentAPI:_,paneVisible:!1,initializeImmediately:!1}),Object(f.b)(y),g.bb()&&O&&p.a.setThemeAPI(O),Y(),Object(l.f)().onExtensionFirstRequested.subscribe((function(e){e.contentType===l.b.CommentThread&&e.instanceId===l.c&&te()}))}catch(e){throw Object(S.a)(i.d.reserveTag(594367139))(e),e}var j}Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),String.prototype.includes||(String.prototype.includes=function(e,t){if(e instanceof RegExp)throw TypeError("first argument must not be a RegExp");return-1!==this.indexOf(e,void 0===t?0:t)}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(Element.prototype.matches.call(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var Fr=n(258),Lr=n(99),Vr=n(1024);function Br(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object(Lr.a)();Mr.apply(void 0,Object(r.__spreadArray)(Object(r.__spreadArray)([],e),[n]))}n.d(t,"instantiate",(function(){return Br})),n.d(t,"initializeRuntime",(function(){return te})),n.d(t,"setWebpackPublicPath",(function(){return Fr.a})),n.d(t,"ScreenReaderNotifierManagerFactoryGlobal",(function(){return G.a})),n.d(t,"RichContentEditAPIFactoryGlobal",(function(){return Vr.a}))},184:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return C})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return b}));var r=n(7),o=n(5),a=n(96),i=n(1234),s=n(51),c=n(17);function d(e){return!!e&&void 0!==e.EmailAddresses}function u(e){return e?d(e)?e.Name:e.DisplayName:""}function l(e){if(!e)return"";if(!d(e))return Object(o.i)().assertConditionTag(!c.x()||Object(i.b)(Object(a.a)()),"LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return Object(o.i)().assertConditionTag("win32"===Object(a.a)(),"UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new s.a("UserPrincipalName and EmailAddresses, both not available",r.d.reserveTag(589103706),-2130957499)}function m(e){return e.UserId?e.UserId:f(e)}function f(e){return void 0!==e.DisplayName?e.DisplayName:(Object(o.i)().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function p(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function C(e){return 0===Object.keys(e).length&&Object(o.i)().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function g(e,t){if(e.size!==t.size)return!0;var n=!1;return e.forEach((function(e){t.has(e)||(n=!0)})),n}function h(e,t){return t.forEach((function(t){t.UserId&&e[t.UserId]?delete e[t.UserId]:t.Email&&e[t.Email]&&delete e[t.Email]})),e}function b(e){var t={};for(var n in e)e[n].stillInDraft&&(t[n]=e[n]);return t}},185:function(e,t,n){"use strict";var r,o=n(0),a=o.createContext(void 0);function i(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&(!!(t=e)&&void 0!==t.focus&&void 0!==t.blur);var t}!function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"}(r||(r={}));var s=n(88),c=n(1028),d=n(1);s.c.Tab,s.a.AtTarget,s.c.Tab,s.a.AtTarget;var u=n(388);function l(e){return e.isFocusOn?u.a.FocusOn:e.isFocusWithin?u.a.FocusWithin:u.a.Unfocused}n(1031),function(){function e(e,t,n,r,a){this.nodeId=e,this.nodeData=t,this.tabbable=n,this.onFocusStateChange=r,this.focusState=a,this.registrationRef=o.createRef(),this.innerComponentRef=o.createRef()}e.prototype.onEffect=function(e,t,n,r){this.nodeData=e,this.tabbable=t,this.onFocusStateChange=n;var o=this.focusState;this.focusState=r,l(o)!==l(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return Object(d.__generator)(this,(function(e){switch(e.label){case 0:return[4,this];case 1:return e.sent(),[2]}}))},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return l(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===u.a.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.focus()},e.prototype.blur=function(){var e;null===(e=this.innerComponentRef.current)||void 0===e||e.blur()}}();var m=function(){var e=this;this.root=null,this.getRoot=function(){return e.root},this.setRoot=function(t){e.root=t}};!function(){function e(e){var t=this;this.viewTreeMap=new Map,e&&e.viewTreeMap.forEach((function(e,n){return t.viewTreeMap.set(n,e)}))}e.prototype.updateIdForViewTree=function(e,t){var n=this.viewTreeMap.get(e);return!!n&&(this.viewTreeMap.set(t,n),this.viewTreeMap.delete(e),!0)},e.prototype.getOrCreateViewTreeById=function(e){var t=this.viewTreeMap.get(e);return t||(t=new m,this.viewTreeMap.set(e,t)),t},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(e){var t,n,r;try{for(var o=Object(d.__values)(this.viewTreeMap.values()),a=o.next();!a.done;a=o.next()){var i=null===(r=a.value.getRoot())||void 0===r?void 0:r.getDescendantById(e);if(i)return i}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}}();!function(){function e(){var e=this;this.ref=o.createRef(),this.focus=function(){e.ref&&e.ref.current&&e.ref.current.focus()},this.blur=function(){e.ref&&e.ref.current&&e.ref.current.blur()},this.getFocusState=function(){return e.ref&&e.ref.current?e.ref.current.getFocusState():s.b.Unfocused},this.getNextTabTarget=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.getNextTabTarget(t,n)},this.isTabbable=function(){return!(!e.ref||!e.ref.current)&&e.ref.current.isTabbable()},this.getChildNodes=function(){return e.ref&&e.ref.current?e.ref.current.getChildNodes():[]},this.addChildNode=function(t,n){if(e.ref&&e.ref.current)return e.ref.current.addChildNode(t,n)},this.getId=function(){return e.ref&&e.ref.current?e.ref.current.getId():""},this.getData=function(){if(e.ref&&e.ref.current)return e.ref.current.getData()},this.getDescendantById=function(t){if(e.ref&&e.ref.current)return e.ref.current.getDescendantById(t)},this.getIterator=function(){return e.ref&&e.ref.current?e.ref.current.getIterator():{next:function(){return{done:!0,value:e}}}}}Object.defineProperty(e.prototype,"disabled",{get:function(){return!(!this.ref.current||!this.ref.current.disabled)},enumerable:!1,configurable:!0})}();var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationToken=void 0,t.onFocusStateChange=function(e){t.registrationToken&&t.registrationToken.onFocusStateChange(e)},t}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,(function(){return e.props.position})))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return o.Children.only(this.props.children)},t}(o.PureComponent);!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.registrationHelperRef=o.createRef(),t.onFocusStateChange=function(e){t.registrationHelperRef.current&&t.registrationHelperRef.current.onFocusStateChange(e)},t}Object(d.__extends)(t,e),t.prototype.render=function(){var e=this;return o.createElement(a.Consumer,null,(function(t){return o.createElement(f,{parentNode:t,node:e.props.node,ref:e.registrationHelperRef,position:e.props.position},e.props.children)}))}}(o.PureComponent);n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(function(){return s.c})),n.d(t,"c",(function(){return s.d})),n.d(t,"d",(function(){return c.a})),n.d(t,"f",(function(){return c.b}))},188:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"}(r||(r={}))},189:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(51),o=n(501);function a(e,t){return Object(r.b)(e)?e.errorCode:Object(o.a)(e)?e.SDXHostAPIErrorCode:void 0===t?-2147467259:t}},192:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u}));n(1),n(185);var r=n(16),o=n(77),a=n(44);function i(e){var t="";return Object(a.e)(e.componentType)?t=s(e.componentType):Object(a.c)(e)&&(t=c(e)),t}function s(e){switch(e){case a.a.ClosePaneButton:return o.k();case a.a.NextCommentButton:return o.E();case a.a.PreviousCommentButton:return o.M();case a.a.GhostCard:return o.z();case a.a.NewCommentButton:return o.D();case a.a.PaneRoot:return o.y();case a.a.CommentsList:return o.p()}}function c(e){switch(e.componentType){case a.a.Card:return o.h(e,!1);case a.a.DraftCard:return o.h(e,!0);case a.a.PostEditor:return o.v(o.G(e));case a.a.CardEditor:return o.v(o.e(e));case a.a.Post:return o.I(e);case a.a.DiscreteHostedCommentRoot:return o.r(e);case a.a.ReopenThreadButton:return o.c(e,o.O())}}function d(e){return e?a.a.DraftCard:a.a.Card}function u(e,t){return d(Object(r.F)(t)===e)}},202:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return C})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r,o,a=n(1),i=n(7),s=n(1013),c=n(5),d=n(575),u=n(576),l=n(505),m=n(17),f=n(46);function p(e,t,n,r,o){if(-1!==n&&Object(f.e)(t)<Object(f.e)(e)){var a=Object(c.i)().createActivityObject("SilentDraftDiscard",Object(c.j)(c.g.GlobalAPI),c.a.None,c.b.NecessaryServiceDataEvent);a.addDataField("DiscardReason",null!=n?n:0,c.d.SystemMetadata),a.addDataField("Source",r,c.d.SystemMetadata),a.successTag(o)}}function C(e,t,n,o){var m,p;Object(f.e)(t)<Object(f.e)(e)&&(null===(p=(m=Object(c.i)()).logDiagnosticTrace)||void 0===p||p.call(m,Object(s.a)(r||(r=Object(a.__makeTemplateObject)(["SilentDiscardOnMerge"],["SilentDiscardOnMerge"]))),i.d.reserveTag(545630305),u.a.Info,d.a.ProductServiceUsage,Object(c.j)(c.g.GlobalAPI),Object(l.b)("MergeSource",o,c.d.SystemMetadata),Object(l.b)("DiscardReason",n,c.d.SystemMetadata)))}function g(e,t,n){var r,m;Object(f.e)(t)<Object(f.e)(e)&&(null===(m=(r=Object(c.i)()).logDiagnosticTrace)||void 0===m||m.call(r,Object(s.a)(o||(o=Object(a.__makeTemplateObject)(["SilentDiscardOnViewChange"],["SilentDiscardOnViewChange"]))),i.d.reserveTag(545630306),u.a.Info,d.a.ProductServiceUsage,Object(c.j)(c.g.GlobalAPI),Object(l.b)("ViewChangeSource",n,c.d.SystemMetadata)))}function h(e,t,n){if(m.B()){var r=Object(c.i)().createActivityObject("MarkCommentCreation",n,c.a.None,c.b.NecessaryServiceDataEvent);r.addDataField("DraftId",e,c.d.SystemMetadata),r.addDataField("CommentId",t,c.d.SystemMetadata),r.addDocumentMetadata(c.f.Basic),r.successTag(591152859)}}},2050:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1);function o(e){var t=e;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t&&t.apply(void 0,Object(r.__spread)(e)),t=void 0}}},206:function(e,t,n){"use strict";function r(e){return!!e&&!!e.commentModel}function o(e){return!!e&&!!e.historyItem}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},207:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(12),o=n(3),a=n(152),i=n(420),s=n(169),c={TASK_ASSIGNER_CHECKED_BOX:"#605E5C",TASK_BORDER_FOCUS:"#797775",TASK_BORDER:"#252423",TASK_CHECKBOX_COLOR:"#31752F",TASK_CHECKBOX_COLOR_COMPLETED_HOVER:"#255924",TASK_CHECKMARK_COLOR:"#31752F",TASK_DISABLED:"#A19F9D",TASK_TEXT:"#252423"},d="10px",u=Object(r.c)((function(e,t){var n,r,d,u=Object(o.db)(!t&&{color:c.TASK_TEXT,selectors:{":hover":{selectors:{".ms-Checkbox-text":Object(o.db)({color:c.TASK_TEXT,selectors:(n={},n[o.l]={color:"HighlightText"},n)},e&&{color:Object(i.a)().primary})}}}}),l={alignItems:"center",border:"1px solid transparent",borderRadius:"3px",borderSpacing:"2px",height:"16px",overflow:"hidden",padding:"3px",selectors:(r={":hover":s.l},r[o.l]={color:"ButtonText"},r)},m=Object(o.db)({borderRadius:s.c,boxSizing:"content-box",height:"14px",textAlign:"center",width:"14px"},t&&{borderColor:c.TASK_DISABLED}),f={selectors:(d={},d["."+a.a+" &:focus + .ms-Checkbox-label:before"]={outline:"none"},d["."+a.a+" &:focus + .ms-Checkbox-label"]={borderColor:c.TASK_BORDER_FOCUS},d["."+a.a+" &:focus + label"]=s.k,d["."+a.a+" &:focus + label .ms-Checkbox-text"]=s.k,d)};return Object(o.cb)({root:u,label:l,checkbox:m,input:f})})),l=Object(r.c)((function(){return{CHECKMARK_ICON_TOPPER:{iconName:"TaskStatusCircleCheckmark",style:{height:"7px",width:"10px",transform:"translateY(-7.5px)"}},CHECKMARK_ICON_ASSIGNER:{iconName:"TaskStatusCircleCheckmark",style:{height:"10px",transform:"translateY(-1px)",width:"14px"}}}}))},209:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"}(r||(r={}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(1);function o(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{trackback:t})}function a(e,t,n){return{type:e,payload:t,actionDetail:n}}},221:function(e,t,n){"use strict";var r=n(7),o=n(5),a=n(246),i=n(142),s=n(239),c=n(131),d=n(87),u=n(184),l=n(259),m=n(241),f=n(62),p=n(51),C=n(17);function g(e,t,n,r,a){if(!C.mb()){var i=Object(o.i)().createActivityObject("SelectionAttemptWhileDrafting",n,o.a.None,o.b.NecessaryServiceDataEvent);i.addDataField("Trackback",r,o.d.SystemMetadata),i.addDataField("RenderContextType",a,o.d.SystemMetadata),i.addDataField("SelectionAttemptType",e,o.d.SystemMetadata),i.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,o.d.SystemMetadata),i.addDataField("DraftId",t.commentDraft.sessionConfiguration.draftId,o.d.SystemMetadata),i.successTag(590206682)}}var h,b=n(27),v=n(52),y=n(360),T=n(234),O=n(16),I=n(46),S=n(53),_=n(291),D=n(231);!function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"}(h||(h={}));var E=h,j=n(188),P=n(165),x=n(23),A=n(192),k=n(209),R=n(720),w=n(351),N=n(721),M=n(96),F=n(127),L=n(102);function V(e){var t=e.comment,n=e.threads,r=e.selectedComment,o=e.warningType,a=!t.parentId,i=!!(t.commentFlags&s.a.LowFidelity);if(!r)return!(!a||o!==S.a.DeleteThread||!i&&!L.j(n,t.commentId))||C.i()&&i&&a;var c=i||a&&(o===S.a.DeleteReply||o===S.a.DeleteThread)&&L.j(n,t.commentId),d=Object(S.j)(r.selectionDetails)?r.selectionDetails.selectedPostId:r.selectedCardId;return!(!c||d===t.commentId&&r.selectionDetails.lowFidelityWarningType===o)}function B(e){var t=e.result,n=e.localizationAPI;t===T.a.Success&&Object(a.b)(n.getString(67))}function H(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,c=e.renderContextType,d=e.actionDispatchers,u=e.telemetryVisitor,l=e.localizationAPI,m=L.a(i,n);m?V({comment:m,threads:i,selectedComment:s,warningType:S.a.DeleteReply})?d.showLowFidelityWarning({renderContextType:c,telemetryVisitor:u,trackback:r.d.reserveTag(593826118)},n,S.a.DeleteReply):(Object(a.b)(l.getString(65)),d.requestDeleteComment({renderContextType:c,telemetryVisitor:u,trackback:t},n)):Object(o.i)().assertConditionTag(!1,"Comment not found",593826117)}function U(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=L.a(r,n);c?i.showPostErrorUI({renderContextType:a,telemetryVisitor:s,trackback:t},c.commentId):Object(o.i)().assertConditionTag(!1,"Comment not found",593875075)}function G(e){var t=e.trackback,n=e.id,r=e.data,a=e.renderContextType,i=e.actionDispatchers,s=e.telemetryVisitor,c=L.a(r,n);c?i.clearPostErrorUI({renderContextType:a,telemetryVisitor:s,trackback:t},c.commentId):Object(o.i)().assertConditionTag(!1,"Comment not found",593875076)}function W(e){var t=e.trackback,n=e.id,a=e.data,i=e.selectedComment,s=e.renderContextType,c=e.actionDispatchers,d=e.telemetryVisitor,u=L.a(a,n);u?V({comment:u,threads:a,selectedComment:i,warningType:S.a.Edit})?c.showLowFidelityWarning({renderContextType:s,telemetryVisitor:d,trackback:r.d.reserveTag(593826120)},n,S.a.Edit):c.requestEditCommentSession({renderContextType:s,telemetryVisitor:d,trackback:t},n):Object(o.i)().assertConditionTag(!1,"Comment not found",593826119)}function q(e){var t=e.trackback,n=e.id,a=e.data,i=e.draftState,s=e.contentPromise,c=e.atMentionsEnabled,u=e.componentTree,l=e.actionDispatchers,m=e.telemetryVisitor,C=e.localizationAPI,g=e.commitSource;if(Object(I.i)(i))return Promise.resolve();if(!i.postIdToDraftIdMap[n])return Object(o.i)().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new p.a("Post draft to commit not found",r.d.reserveTag(587850403),-2130957492));var h=L.a(a,n);return h?l.commitCommentAndFocus({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},(function(){return s}),{commentId:n,type:"EDIT",previousCommentBody:h.commentBody},c,u,Object(d.b)(h),g).then((function(e){B({result:e,localizationAPI:C})})).catch(Object(f.a)(r.d.reserveTag(593826122))):(Object(o.i)().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new p.a("Comment not found in model",r.d.reserveTag(587850432),2130957505)))}function z(e){var t=e.trackback,n=e.renderableItem,o=e.selectedComment,a=e.cardCollapsedState,i=e.dispatchProps,s=e.telemetryVisitor,c=e.componentTree,d=e.draftState_deprecated,u=e.shouldFocusAfter,l=L.i(n),m=L.e(n);return i.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:s,trackback:r.d.reserveTag(593237586)},v.a.SharedComments,void 0).then((function(e){if(C.mb()||e.draftDiscardBehavior!==j.a.CannotAutoDiscard||o&&Object(S.j)(o.selectionDetails)&&o.selectionDetails.selectedPostId===m){var n=a===_.a.Collapsed,p=n&&(C.o()||(null==o?void 0:o.selectedCardId)===l);i.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:s,trackback:t},Object(y.a)(l,v.a.SharedComments,n?{selectType:b.SelectActionType.ExpandCard}:{selectType:b.SelectActionType.SelectPost,selectedPost:m}),u||p).catch(Object(f.a)(r.d.reserveTag(590104649)))}else{var h=Object(O.J)(d);h&&g(2,h,s,r.d.reserveTag(590206683),c.componentTreeId.renderContextType)}}),Object(f.a)(r.d.reserveTag(593032901)))}function Y(e){var t=e.trackback,n=e.commentId,i=e.setContents,s=e.data,d=e.draftState,u=e.shouldClosePaneAfterDiscardDraft,l=e.onWillDiscardCallback,m=e.renderContextType,p=e.dispatchProps,C=e.telemetryVisitor,g=e.localizationAPI;Object(N.a)();var h=L.a(s,n);d.postIdToDraftIdMap[n]&&h?(Object(a.b)(g.getString(66)),p.discardDraftAsync({renderContextType:m,telemetryVisitor:C,trackback:t},v.a.SharedComments,u,l).then((function(e){e===c.a.Handled&&h&&i&&i(h.commentBody)})).catch(Object(f.a)(r.d.reserveTag(593826127)))):Object(o.i)().assertConditionTag(!1,"Cannot find comment post to cancel '"+n+"'",593826126)}function K(e){var t=e.cardProps,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardMounted(n,t)}))}function X(e){var t=e.cardId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentCardEditorMounted(n,t)}))}function J(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostMounted(n,t)}))}function Q(e){var t=e.postId,n=e.componentTree,r=e.focusManager;setTimeout((function(){return r.commentPostEditorMounted(n,t)}))}function Z(e){var t=e.trackback,n=e.threadId,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function $(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.collapseCard({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function ee(e){var t=e.trackback,n=e.commentCardRef,o=e.dispatchProps,a=e.telemetryVisitor,i=e.componentTree,s=e.options,c=e.focusManager,d=e.isDraftThread,u={componentType:Object(A.b)(d),id:n.getId(),renderContextType:i.componentTreeId.renderContextType};c.postOnComponentFocusedRequest(u,(function(){m.a&&Object(r.i)("Handling card focus with polite selection on "+n.getId()),i.isFocusOnOrWithin(u)&&te({trackback:t,commentCardRef:n,dispatchProps:o,telemetryVisitor:a,componentTree:i,options:s})}))}function te(e){var t,n=e.trackback,o=e.commentCardRef,a=e.dispatchProps,i=e.telemetryVisitor,s=e.componentTree,c=e.options,d=!1,u=c.selectActionType;switch(u){case b.SelectActionType.ExpandCard:var l=c,m=l.selectRootPost&&(C.mb()||!l.relativeDraftingState);d=l.shouldFocusAfter,t=m?{selectType:b.SelectActionType.SelectPost,selectedPost:o.getId()}:{selectType:b.SelectActionType.ExpandCard};break;case b.SelectActionType.SelectCard:case b.SelectActionType.Polite:t={selectType:u};break;default:Object(r.m)(u)}var p=Object(y.a)(o.getId(),v.a.SharedComments,t);c.selectActionType===b.SelectActionType.ExpandCard&&a.discardDraftIfEmpty({renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(571281760)},v.a.SharedComments,void 0).then((function(e){if(!C.mb()&&e.draftDiscardBehavior===j.a.CannotAutoDiscard&&c.relativeDraftingState===D.a.InOtherCard){var t=Object(O.J)(c.draftState);t&&g(1,t,i,r.d.reserveTag(571281761),s.componentTreeId.renderContextType)}})).catch(Object(f.a)(r.d.reserveTag(571281762))),a.selectComment(s,{renderContextType:s.componentTreeId.renderContextType,telemetryVisitor:i,trackback:n},p,d).catch(Object(f.a)(r.d.reserveTag(571340118)))}function ne(e){var t=e.trackback,n=e.commentCardRef,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;e.shouldHighlightCard?o.highlightComment({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId()):o.clearCommentHighlight({renderContextType:r,telemetryVisitor:a,trackback:t},n.getId())}function re(e){var t=e.trackback,n=e.focusManager,a=e.componentTree,i=e.cardId,s=e.isCardLie,c=e.newHeight,d=e.renderContextType,u=e.selectedComment,m=e.dispatchProps,p=e.telemetryVisitor;if(d===x.a.HalfPane){if(void 0===c)return Object(o.i)().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);u&&u.selectedCardId===i&&s&&!Object(O.O)(i)&&m.requestDisplayConfiguration({renderContextType:d,telemetryVisitor:p,trackback:t},{displayMode:l.a.Variable,desiredHeight:c}).then((function(){n.focusCommentPaneCommand(a)})).catch(Object(f.a)(r.d.reserveTag(593826130)))}}function oe(e){var t=e.trackback,n=e.id,r=e.draftState,o=e.renderContextType,a=e.dispatchProps,s=e.telemetryVisitor;if(!C.H()){var c=r.drafts[r.cardIdToDraftIdMap[n]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===i.g&&a.discardDraftAsync({renderContextType:o,telemetryVisitor:s,trackback:t},v.a.SharedComments,!1)}}function ae(e){var t,n=e.trackback,s=e.showDiscardDialog,d=e.invokeModalDialog,u=e.componentTree,l=e.dispatchProps,m=e.closeOnDiscard,p=e.cardId,C=e.draftState,g=e.telemetryVisitor,h=e.localizationAPI,b=e.focusManager,y=e.lieIndex,T=C.cardIdToDraftIdMap[p];if(T){Object(N.a)();var O=void 0;s&&(O=Object(w.a)(C,u,d));var I=(null===(t=C.drafts[T])||void 0===t?void 0:t.commentDraft.sessionConfiguration.sessionType)===i.g,S=function(e){var t=e.componentTree,n=e.focusManager,r=e.lieIndex,o=e.cardId,a=e.isReplyDraft,i=e.discardCallback;return function(e,s){if(i){return i((function(){return n.onUserAction(t,{userAction:k.a.CancelNewThreadDraft,threadIndex:r}),e?e():c.a.Unhandled}),s)}return e?(a?n.onUserAction(t,{userAction:k.a.CancelReplyDraft,cardId:o}):n.onUserAction(t,{userAction:k.a.CancelNewThreadDraft,threadIndex:r}),Promise.resolve(e())):Promise.resolve(c.a.Unhandled)}}({componentTree:u,focusManager:b,lieIndex:y,cardId:p,isReplyDraft:I,discardCallback:O});Object(a.b)(h.getString(I?64:103)),l.discardDraftAsync({renderContextType:u.componentTreeId.renderContextType,telemetryVisitor:g,trackback:n},v.a.SharedComments,m,S).then((function(e){e===c.a.Handled&&(I?b.onUserAction(u,{userAction:k.a.CancelReplyDraft,cardId:p}):b.onUserAction(u,{userAction:k.a.CancelNewThreadDraft,threadIndex:y}))}),Object(f.a)(r.d.reserveTag(592840735)))}else Object(o.i)().assertConditionTag(!1,"Card draft to cancel not found",588853382)}function ie(e){var t=e.trackback,n=e.commentCardRef,a=e.draftState,i=e.areMentionsEnabled,s=e.session,c=e.componentTree,d=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,m=e.commitSource,g=e.selectedTaskAssignee;if(Object(I.i)(a))return Promise.resolve();var h=n.getId();if(!a.cardIdToDraftIdMap[h])return Object(o.i)().assertConditionTag(!1,"Card draft to commit not found, card ID "+h,588853383),Promise.reject(new p.a("Card draft to commit not found",r.d.reserveTag(587850433),-2130957492));var b=void 0;return C.b()&&g&&(b={Task:{type:"Task",assignee:g}}),d.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:c.componentTreeId.renderContextType},n.getContentsAsync,s,i,c,h,m,b).then((function(e){B({result:e,localizationAPI:l})})).catch(Object(f.a)(r.d.reserveTag(593826134)))}function se(e){var t=e.trackback,n=e.id,r=e.renderContextType,o=e.dispatchProps,i=e.telemetryVisitor,s=e.localizationAPI,c=e.isTask;Object(a.b)(s.getString(125)),o.requestReopenThread({renderContextType:r,telemetryVisitor:i,trackback:t},n,c)}function ce(e){var t=e.componentTree,n=e.focusManager,r=e.trackback,o=e.id,i=e.renderContextType,s=e.dispatchProps,c=e.telemetryVisitor,d=e.localizationAPI,u=e.isTask;Object(a.b)(d.getString(124)),n.onUserAction(t,{userAction:k.a.ResolveThread,cardId:o}),s.requestResolveThread({renderContextType:i,telemetryVisitor:c,trackback:r},o,u)}function de(e){var t=e.trackback,n=e.id,i=e.data,s=e.selectedComment,d=e.componentTree,u=e.invokeModalDialog,l=e.dispatchProps,m=e.telemetryVisitor,p=e.localizationAPI,C=e.focusManager,g=e.isTask,h=e.threadIndex;if(e.shouldCheckForLowFidelity){var b=L.a(i,n);if(!b)return void Object(o.i)().assertConditionTag(!1,"Comment not found",593605342);if(V({comment:b,threads:i,selectedComment:s,warningType:S.a.DeleteThread}))return void l.selectCommentCardAndShowLowFidelityWarning({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:r.d.reserveTag(593605343)},b.commentId,S.a.DeleteThread)}if(d.componentTreeId.renderContextType===x.a.HalfPane&&u){u(P.a.DeleteThread,(function(){return function(e){var t=e.dispatchProps,n=e.componentTree,a=e.selectedComment,i=e.telemetryVisitor;if(a)return t.requestDeleteThread({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:i,trackback:r.d.reserveTag(592840775)},a.selectedCardId),c.a.Handled;return Object(o.i)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),c.a.Unhandled}({dispatchProps:l,componentTree:d,selectedComment:s,telemetryVisitor:m})}),(function(){return c.a.Canceled})).then((function(e){e===c.a.Handled&&C.onUserAction(d,{userAction:k.a.DeleteThread,threadIndex:h})})).catch(Object(f.a)(r.d.reserveTag(595632546)))}else Object(a.b)(p.getString(63)),C.onUserAction(d,{userAction:k.a.DeleteThread,threadIndex:h}),Object(F.a)(d.componentTreeId.renderContextType)?setTimeout((function(){l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,g)}),100):l.requestDeleteThread({renderContextType:d.componentTreeId.renderContextType,telemetryVisitor:m,trackback:t},n,g)}function ue(e){ce({componentTree:e.componentTree,focusManager:e.focusManager,trackback:e.trackback,id:e.id,renderContextType:e.renderContextType,dispatchProps:e.dispatchProps,telemetryVisitor:e.telemetryVisitor,localizationAPI:e.localizationAPI,isTask:!0})}function le(e){var t=e.failTag,n=e.successTag,r=e.person,a=e.dispatchProps,i=e.telemetryVisitor,s=e.renderContextType,c=e.trackback,d=Object(o.i)().createActivityObject("CheckUserAccess",i,o.a.None,o.b.NecessaryServiceDataEvent),l={UserId:Object(u.e)(r),Provider:R.b,DisplayName:Object(u.d)(r),Email:Object(u.e)(r)};a.checkUserAccess(l).then((function(e){var t;d.addDataField("UserCanWrite",e.UserCanWrite,o.d.SystemMetadata),d.addDataField("UserCanReview",null!==(t=null==e?void 0:e.UserCanReview)&&void 0!==t&&t,o.d.SystemMetadata),d.successTag(n)}),(function(e){d.failTag(t,-2130957562)})),a.addToCurrentMentionees({telemetryVisitor:i,trackback:c,renderContextType:s},r)}function me(e){var t=e.trackback,n=e.contentId,r=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,i=e.actionDispatchers,s=e.telemetryVisitor,c=a[n];c&&i.draftEmptinessChanged({renderContextType:o,telemetryVisitor:s,trackback:t},c,r)}function fe(e){var t=e.trackback,n=e.id,o=e.editor,a=e.renderContextType,i=e.draftIdMap,s=e.draftMap,c=e.actionDispatchers,d=e.telemetryVisitor,u=i[n];if(u){var l=s[u];Object(r.n)(l,"Draft should be defined if draftId exists!",r.d.reserveTag(587850434)),l.pendingState===I.a.None&&c.saveDraft({renderContextType:a,telemetryVisitor:d,trackback:t},u,{editorContent:o.getContentsAsync(),editorCursorPosition:o.getCursorPositionAsync()})}}function pe(e){var t=e.trackback,n=e.emailsStillInDraft,r=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:r,telemetryVisitor:a,trackback:t},n)}function Ce(e){var t=e.trackback,n=e.renderContextType,r=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;r.updateSelectedTaskAssignee({renderContextType:n,telemetryVisitor:o,trackback:t},a)}function ge(e){var t=e.selectedState,n=e.renderContextType,a=e.dispatchProps,i=e.telemetryVisitor;t&&Object(S.h)(t)?a.clearLowFidelityWarning({renderContextType:n,telemetryVisitor:i,trackback:r.d.reserveTag(573612046)}):Object(o.i)().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658)}function he(e){var t=e.selectedState,n=e.onCardDelete,r=e.onPostDelete,a=e.onPostEdit;if(t)if(!Object(S.j)(t.selectionDetails)||Object(S.d)(t)){if(Object(S.e)(t))return void n(i=t.selectedCardId);if(Object(S.f)(t))return void Object(o.i)().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662)}else{var i=t.selectionDetails.selectedPostId;if(Object(S.c)(t))return void r(i);if(Object(S.f)(t))return void a(i)}else Object(o.i)().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661)}function be(e){var t=e.ownProps,n=e.dispatchProps,a=e.componentTree,i=e.draftState,s=e.invokeModalDialog;if(a.componentTreeId.renderContextType!==x.a.HalfPane&&Object(I.b)(i)&&!C.n()){n.discardDraftAsync({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:r.d.reserveTag(592840770)},v.a.SharedComments,!0,Object(w.a)(i,a,s,P.a.ClosePaneDraft)).then((function(e){e===c.a.Canceled?Object(N.c)():e===c.a.Unhandled&&Object(o.i)().assertConditionTag(e!==c.a.Unhandled,"Unhandled request to discard on close pane",592840769)})).catch(Object(f.a)(r.d.reserveTag(592840771)))}else!function(e){var t=e.dispatchProps,n=e.componentTree,a=e.telemetryVisitor,i=Object(o.i)().createActivityObject("ClosePane",a,o.a.None,o.b.NecessaryServiceDataEvent);i.addDataField("PaneCloseResult",E.NoDialog,o.d.SystemMetadata),i.successTag(592840773),t.requestClosePane({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:a,trackback:r.d.reserveTag(592840774)})}({dispatchProps:n,componentTree:a,telemetryVisitor:t.telemetryVisitor})}function ve(e,t,n,r,o){n.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:r,trackback:e},L.i(t))}function ye(e,t,n,r){if(!Object(I.d)(r)||C.mb()||"win32"===Object(M.a)()){var o=L.i(e);n.focusCommentCardCommand(t,o)}}function Te(e,t,n,r,o,a,i){o.requestUpdateCommentReactions({renderContextType:r,telemetryVisitor:a,trackback:e},t,i,n)}function Oe(e,t,n,r,o){r.requestPresentLinkToComment({renderContextType:n,telemetryVisitor:o,trackback:e},t)}n.d(t,"K",(function(){return V})),n.d(t,"D",(function(){return H})),n.d(t,"G",(function(){return U})),n.d(t,"A",(function(){return G})),n.d(t,"E",(function(){return W})),n.d(t,"C",(function(){return q})),n.d(t,"J",(function(){return z})),n.d(t,"z",(function(){return Y})),n.d(t,"k",(function(){return K})),n.d(t,"h",(function(){return X})),n.d(t,"I",(function(){return J})),n.d(t,"F",(function(){return Q})),n.d(t,"a",(function(){return Z})),n.d(t,"b",(function(){return $})),n.d(t,"i",(function(){return ee})),n.d(t,"n",(function(){return te})),n.d(t,"j",(function(){return ne})),n.d(t,"f",(function(){return re})),n.d(t,"g",(function(){return oe})),n.d(t,"e",(function(){return ae})),n.d(t,"c",(function(){return ie})),n.d(t,"l",(function(){return se})),n.d(t,"m",(function(){return ce})),n.d(t,"d",(function(){return de})),n.d(t,"o",(function(){return ue})),n.d(t,"t",(function(){return le})),n.d(t,"q",(function(){return me})),n.d(t,"x",(function(){return fe})),n.d(t,"u",(function(){return pe})),n.d(t,"y",(function(){return Ce})),n.d(t,"r",(function(){return ge})),n.d(t,"s",(function(){return he})),n.d(t,"p",(function(){return be})),n.d(t,"B",(function(){return ve})),n.d(t,"H",(function(){return ye})),n.d(t,"w",(function(){return Te})),n.d(t,"v",(function(){return Oe}))},23:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"}(r||(r={})),t.a=r},231:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"}(r||(r={}))},232:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.HalfPane="half-pane",e.FullPane="full-pane"}(r||(r={})),t.b=r},234:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"}(r||(r={})),t.a=r},239:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted"}(r||(r={}))},241:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));n(96);var r="sharedcommentsdemo"===Object({NODE_ENV:"production"}).TEST_PAGE,o=!1},242:function(e,t,n){"use strict";var r,o=n(385),a=n(485),i=n(107);!function(e){e[e.FailedToCommit=1]="FailedToCommit"}(r||(r={}));var s=n(132),c=n(239),d=n(130),u=n(175),l=n(131),m=(n(173),n(1026));n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"c",(function(){return d.a})),n.d(t,"j",(function(){return d.d})),n.d(t,"i",(function(){return d.c})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"k",(function(){return m.a}))},246:function(e,t,n){"use strict";var r=n(640),o=new r.a;n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return r.c})),n.d(t,"b",(function(){return r.b}))},247:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"}(r||(r={}))},259:function(e,t,n){"use strict";var r;function o(e){if(!e)return!1;var t=e;return void 0!==t.displayMode&&"string"==typeof t.displayMode}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"}(r||(r={}))},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(17);function o(e){return Object(r.lb)()}},263:function(e,t,n){"use strict";var r;function o(e){return void 0!==e.pending||void 0!==e.displayingErrorUI}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"}(r||(r={}))},27:function(e,t,n){"use strict";n.r(t);var r=n(21),o=n(700);function a(e,t){return Object(r.b)("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}function i(e,t){return Object(r.b)("APPLY_COMMENT_CHANGES",{changes:t},e)}var s=n(701),c=n(702),d=n(703),u=n(704),l=n(705);function m(e,t){return Object(r.b)("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}function f(e,t,n){return Object(r.b)("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:n},e)}function p(e,t,n){return Object(r.b)("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:n},e)}var C=n(706),g=n(707),h=n(708);function b(e){return Object(r.b)("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}function v(e,t){return Object(r.b)("CLEAR_POST_ERROR_STATE",{commentId:t},e)}function y(e,t){return Object(r.b)("COLLAPSE_CARD",{cardId:t},e)}function T(e,t){return Object(r.b)("COMMENT_CONTEXT_CHANGED",t,e)}var O=n(709),I=n(438);function S(e,t){return Object(r.b)("DISPATCH_LOAD_THREADS",t,e)}var _=n(389);function D(e,t,n){return Object(r.b)("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:n},e)}var E=n(346),j=n(577),P=n(710),x=n(711),A=n(578),k=n(712);function R(e,t){return Object(r.b)("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}function w(e,t){return Object(r.b)("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}function N(e,t){return Object(r.b)("ON_INITIAL_RENDER",t,e)}function M(e,t){return Object(r.b)("POPULATE_SMART_REPLY",t,e)}function F(e,t){return Object(r.b)("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}function L(e,t){return Object(r.b)("QUEUE_LOAD_THREADS",t,e)}function V(e){return Object(r.b)("READY_TO_RENDER",{},e)}var B=n(713);function H(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.b)("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}function U(e){return Object(r.b)("REQUEST_CLOSE_PANE",{},e)}function G(e,t){return Object(r.b)("REQUEST_DELETE_POST",{commentId:t},e)}function W(e,t,n){return Object(r.b)("REQUEST_DELETE_THREAD",{commentId:t,isTask:n},e)}function q(e,t,n,o){return Object(r.b)("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:n,displayStrings:o},e)}function z(e,t,n){return Object(r.b)("REQUEST_REOPEN_THREAD",{commentId:t,isTask:n},e)}function Y(e){return Object(r.b)("REQUEST_SHOW_PANE",{},e)}function K(e,t,n){return Object(r.b)("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:n},e)}var X=n(579);function J(e,t){return Object(r.b)("SAVE_DRAFT",t,e)}var Q=n(114);function Z(e,t,n,o,a,i,s){return Object(r.b)("SELECT_CONTENT",{selectDirection:t,from:i,reason:s,iterableContentTypes:n,restrictToCurrentContext:o,preventLooping:a},e)}function $(e){return Object(r.b)("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}function ee(e){return Object(r.b)("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var te=n(714),ne=n(715);function re(e,t){return Object(r.b)("SHOW_POST_ERROR_STATE",{commentId:t},e)}var oe=n(716);function ae(e,t){return Object(r.b)("UPDATE_CAPABILITIES",{capabilities:t},e)}var ie=n(717);function se(e,t,n){return Object(r.b)("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:n},e)}function ce(e,t){return Object(r.b)("UPDATE_DRAFT_THREAD",t,e)}function de(e,t){return Object(r.b)("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}function ue(e,t){return Object(r.b)("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}function le(e,t,n){return Object(r.b)("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:n},e)}function me(e,t){return Object(r.b)("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}var fe=n(718);function pe(e,t){return Object(r.b)("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}function Ce(e,t){return Object(r.b)("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}function ge(e,t){return Object(r.b)("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}n.d(t,"chainActionDetails",(function(){return r.a})),n.d(t,"createAction",(function(){return r.b})),n.d(t,"addContentExtension",(function(){return o.a})),n.d(t,"addToCurrentMentionees",(function(){return a})),n.d(t,"applyCommentChanges",(function(){return i})),n.d(t,"beginDraftingFailure",(function(){return s.a})),n.d(t,"beginDraftingSuccess",(function(){return c.a})),n.d(t,"beginProcessingCommit",(function(){return d.a})),n.d(t,"beginProcessingDiscard",(function(){return u.a})),n.d(t,"beginViewInitialization",(function(){return l.a})),n.d(t,"cancelCommentCreateThread",(function(){return m})),n.d(t,"cancelCommentPostEdit",(function(){return f})),n.d(t,"cancelCommentReply",(function(){return p})),n.d(t,"cancelDiscard",(function(){return C.a})),n.d(t,"clearCommentHighlight",(function(){return g.a})),n.d(t,"clearCommentSelection",(function(){return h.a})),n.d(t,"clearLowFidelityWarning",(function(){return b})),n.d(t,"clearPostErrorUI",(function(){return v})),n.d(t,"collapseCard",(function(){return y})),n.d(t,"commentContextChanged",(function(){return T})),n.d(t,"commitDraft",(function(){return O.a})),n.d(t,"getCommitDraftSessionType",(function(){return O.b})),n.d(t,"commitFailure",(function(){return I.a})),n.d(t,"dispatchLoadThreads",(function(){return S})),n.d(t,"displayDraftWarning",(function(){return _.a})),n.d(t,"draftEmptinessChanged",(function(){return D})),n.d(t,"emptyAction",(function(){return E.b})),n.d(t,"EMPTY_ACTION",(function(){return E.a})),n.d(t,"endViewInitialization",(function(){return j.a})),n.d(t,"highlightComment",(function(){return P.a})),n.d(t,"loadComment",(function(){return x.a})),n.d(t,"loadPersonaIconProperties",(function(){return A.a})),n.d(t,"loadVirtualizedComments",(function(){return k.a})),n.d(t,"moveFocusToCanvas",(function(){return R})),n.d(t,"nextPopulatedContextDetailsUpdated",(function(){return w})),n.d(t,"onInitialRender",(function(){return N})),n.d(t,"populateSmartReply",(function(){return M})),n.d(t,"requestPresentLinkToComment",(function(){return F})),n.d(t,"queueLoadThreads",(function(){return L})),n.d(t,"readyToRender",(function(){return V})),n.d(t,"reloadComments",(function(){return B.a})),n.d(t,"removeContentExtensions",(function(){return H})),n.d(t,"requestClosePane",(function(){return U})),n.d(t,"requestDeletePost",(function(){return G})),n.d(t,"requestDeleteThread",(function(){return W})),n.d(t,"requestModalConfirmation",(function(){return q})),n.d(t,"requestReopenThread",(function(){return z})),n.d(t,"requestShowPane",(function(){return Y})),n.d(t,"requestThreadResolve",(function(){return K})),n.d(t,"resolveAtMentionCapability",(function(){return X.a})),n.d(t,"saveDraft",(function(){return J})),n.d(t,"SelectActionType",(function(){return Q.a})),n.d(t,"shouldSelectActionExpandCard",(function(){return Q.c})),n.d(t,"selectComment",(function(){return Q.b})),n.d(t,"selectContent",(function(){return Z})),n.d(t,"selectFirstThreadInNextCommentContext",(function(){return $})),n.d(t,"selectLastThreadInPreviousCommentContext",(function(){return ee})),n.d(t,"sessionRequestStartedAndLockSelection",(function(){return te.a})),n.d(t,"showLowFidelityWarning",(function(){return ne.a})),n.d(t,"showPostErrorUI",(function(){return re})),n.d(t,"topVisibleThreadChanged",(function(){return oe.a})),n.d(t,"updateCapabilities_deprecated",(function(){return ae})),n.d(t,"updateContextState",(function(){return ie.a})),n.d(t,"updateDraftRenderContext",(function(){return se})),n.d(t,"updateDraftThread",(function(){return ce})),n.d(t,"updateExtensionPriority",(function(){return de})),n.d(t,"updateMentioneesStillInDraft",(function(){return ue})),n.d(t,"updateModelCapabilities",(function(){return le})),n.d(t,"updateSelectedTaskAssignee",(function(){return me})),n.d(t,"updateSuggestionsDetails",(function(){return fe.a})),n.d(t,"viewContainerChanged",(function(){return pe})),n.d(t,"viewContainerFoldableLayoutStateChanged",(function(){return Ce})),n.d(t,"viewContainerVisibilityChanged",(function(){return ge}))},275:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(17),o={},a=function(e){return Object(r.b)()?e.commentState.tasks:o},i=function(e){return e.commentState.historyRecordViewState}},281:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"}(r||(r={}))},282:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"}(r||(r={}))},291:function(e,t,n){"use strict";var r;!function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"}(r||(r={})),t.a=r},296:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),o=n(232),a=n(23);function i(e){switch(e){case o.b.HalfPane:return a.a.HalfPane;case o.b.FullPane:return a.a.FullPane;default:Object(r.m)(e)}}},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(130);function o(e){return e.sessionType===r.a}function a(e){return e.sessionType===r.d&&void 0!==e.threadId}function i(e){return e.sessionType===r.b&&void 0!==e.commentId}},346:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(7),o=n(5),a=n(23),i=n(21);function s(e){return Object(i.b)("",{},e)}var c=s({renderContextType:a.a.None,telemetryVisitor:Object(o.j)(o.g.ReviewedAsNotNecessary),trackback:r.d.reserveTag(595735680)})},350:function(e,t,n){"use strict";var r;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(r||(r={})),t.a=r},351:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var r=n(382),o=n(16),a=n(188),i=n(23),s=n(1105),c=function(e,t,n,r,a){return e&&t===i.a.HalfPane&&void 0===a&&(!r||r.selectedCardId===Object(o.F)(n,!0,t))},d=function(e,t,n,o){if(n&&Object(r.a)(e)===a.a.CannotAutoDiscard){var i=null!=o?o:Object(s.a)(e,t.componentTreeId.renderContextType);return function(e,t){return n(i,e,t)}}}},359:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r=n(7),o=n(5),a=n(129),i=n(130),s=n(164),c=n(109),d=n(188),u=n(23),l=n(296),m=n(127),f=n(564),p=n(62),C=n(51),g=n(189),h=n(119),b=n(17),v=n(16),y=n(46),T=n(14),O=n(65),I=n(21),S=n(52),_=n(701),D=n(702),E=n(346),j=n(714),P=n(439),x=n(392);function A(e,t,n,A,k){return function(R,w){var N=w(),M=Object(o.i)().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),F=s.b[n.sessionType];return M.addDataField("SessionType",F,o.d.SystemMetadata),M.addDataField("Trackback",e.trackback,o.d.SystemMetadata),M.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),M.addDataField("PaneVisibilityState",O.e(N),o.d.SystemMetadata),b.b()||n.sessionType!==i.c?(Object(v.i)(T.n(N),T.a(N))===a.b.Enabled&&Object(f.a)().catch(Object(p.a)(r.d.reserveTag(591397600))),R(Object(P.a)(e,S.a.SharedComments,s.c(n))).catch((function(e){return Object(p.a)(r.d.reserveTag(591397602))(e),{draftDiscardResult:a.g.Unhandled,draftDiscardBehavior:d.a.CannotAutoDiscard}})).then((function(a){var i,d;M.addDataField("DraftDiscardBehavior",a.draftDiscardBehavior,o.d.SystemMetadata);var f=w(),p=T.h(f);return Object(y.d)(p)||T.g(f)&&s.d(n)?(M.addDataField("SessionAlreadyRequested",!0,o.d.SystemMetadata),M.addDataField("DraftRenderContextType",null!==(d=null===(i=Object(v.J)(p))||void 0===i?void 0:i.renderContextType)&&void 0!==d?d:u.a.None,o.d.SystemMetadata),M.successTag(591397633),Promise.resolve(R(E.a))):(M.addDataField("SessionAlreadyRequested",!1,o.d.SystemMetadata),R(Object(j.a)(Object(I.a)(e,r.d.reserveTag(591397634)),n,A)),t.beginDraftingAsync(n).then((function(t){if(void 0===t.sessionConfiguration)throw new C.a(h.c,r.d.reserveTag(589103630),-2130957532);s.d(n)&&b.J()&&R(Object(x.a)(Object(I.a)(e,r.d.reserveTag(591397635)),[],[],k,t.author)),M.addDataField("DraftId",t.sessionConfiguration.draftId,o.d.SystemMetadata);var a=w(),i=function(e,t,n){if(t!==c.a.Closed&&e!==u.a.DiscreteIsolated)return Object(l.a)(n);if(!Object(m.b)(e))return e;if(b.n()&&t===c.a.Closed)return u.a.None;return Object(l.a)(n)}(e.renderContextType,O.e(a),O.d(a).containerType);return M.addDataField("DraftRenderContextType",i,o.d.SystemMetadata),Object(o.i)().assertConditionTag(i===e.renderContextType||e.renderContextType===u.a.None,"Requested starting a draft in RenderContextType:"+e.renderContextType+" but had to lock to RenderContextType:"+i+" based on pane state",554714642),M.successTag(591397640),R(Object(D.a)(Object(I.a)(e,r.d.reserveTag(591397641)),t,i))})).catch((function(t){return(t.message||t).includes("LegacyConvertDialog")?M.successTag(591397643):M.failTag(591397642,Object(g.a)(t)),R(Object(_.a)(Object(I.a)(e,r.d.reserveTag(591397644)),n,t))})))}))):(M.failTag(591397599,-2130957513),Promise.resolve(R(E.a)))}}},360:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(1),o=n(7),a=n(5),i=n(192),s=n(44),c=n(241),d=n(53),u=n(14),l=n(21),m=n(114);function f(e,t,n,r){return function(f,p){f(Object(l.b)("SELECT_COMMENT",n,t));var C=p(),g=Object(u.r)(C);return r&&g&&g.selectedCardId===n.selectedCard&&(n.selectType!==m.a.SelectPost||Object(d.j)(g.selectionDetails)&&g.selectionDetails.selectedPostId===n.selectedPost)?e?new Promise((function(n){return setTimeout((function(){var r;if(Object(d.j)(g.selectionDetails))r={componentType:s.a.Post,id:g.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var l=Object(u.h)(C).drafts[g.selectedCardId],m=!!l&&"CREATE"===l.commentDraft.sessionConfiguration.sessionType;r={componentType:Object(i.b)(m),id:g.selectedCardId,renderContextType:t.renderContextType}}var f=e.getComponentById(r);f?(c.a&&Object(o.i)("Focusing comment "+r.id+" with render context type "+r.renderContextType+" after selection."),f.focus()):Object(a.i)().assertConditionTag(!1,"Couldn't find focus target after select: "+JSON.stringify(r),590104655),n()}))})):(Object(a.i)().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function p(e,t,n){return Object(r.__assign)({selectedCard:e,source:t},n)}},373:function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},378:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(291),o=n(23);function a(e,t,n){return n===o.a.HalfPane||t.includes(e)?r.a.Expanded:r.a.Collapsed}},382:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(129),o=n(188),a=n(46),i=n(16);function s(e){if(!Object(a.c)(e))return o.a.NoDraft;if(!function(e){var t=Object(i.H)(e),n=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(null==n?void 0:n.isDraftEmpty)}(e))return o.a.CannotAutoDiscard;var t=Object(i.J)(e);return t&&Object(r.k)(t.commentDraft.sessionConfiguration)?o.a.CannotAutoDiscard:o.a.CanAutoDiscard}},385:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"}(r||(r={}))},386:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(232);function o(e){return e.containerType===r.b.HalfPane}},387:function(e,t,n){"use strict";var r;!function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"}(r||(r={})),t.a=r},388:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"}(r||(r={}))},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("DISPLAY_DRAFT_WARNING",e,t)}},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1),o=n(97),a=n(16),i=n(627);function s(e,t){for(var n=null==t?void 0:t(),r=[],a=0,i=void 0;a<e.length;){if(e[a].type===o.a.Thread){var s=e[a].id;i=s,r.push(d(s,void 0,n))}else r.push(d(e[a].id,i,n));a++}return r}function c(e){return e.map((function(e){return d(e,void 0,void 0)}))}function d(e,t,n){var o=void 0;n&&(o=n.commentData.find((function(t){return t.commentId===e})));return o||Object(r.__assign)(Object(r.__assign)({},Object(a.e)(e)),{parentId:null!=t?t:""})}function u(){var e=new i.a;return e.insert(""),e.toJSON()}},391:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(7),o=n(5),a=n(27),i=n(130),s=n(131),c=n(17),d=n(16),u=n(46),l=n(53),m=n(14),f=n(21),p=n(704),C=n(706);function g(e,t,n,g){return function(h,b){var v,y,T=b(),O=Object(o.i)().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),I=m.h(T),S=m.r(T),_=Object(u.i)(I);O.addDataField("Trackback",e.trackback,o.d.SystemMetadata),O.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),O.addDataField("CommitPendingAttemptedCancel",_,o.d.SystemMetadata),O.addDataField("ActionSource",t,o.d.SystemMetadata);var D=function(e,t,n){var s=m.t(e),c=m.r(e);if(!s)return c&&Object(l.j)(c.selectionDetails)&&Object(l.h)(c)?{cancelAction:a.cancelCommentPostEdit(Object(f.a)(n,r.d.reserveTag(593278744)),c.selectionDetails.selectedPostId,t),sessionType:i.b}:-2130957522;var d=s.commentDraft.sessionConfiguration.sessionType;switch(s.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:a.cancelCommentCreateThread(Object(f.a)(n,r.d.reserveTag(593278745)),t),sessionType:d};case"REPLY":return{cancelAction:a.cancelCommentReply(Object(f.a)(n,r.d.reserveTag(593278746)),s.commentDraft.sessionConfiguration.threadId,t),sessionType:d};case"EDIT":return{cancelAction:a.cancelCommentPostEdit(Object(f.a)(n,r.d.reserveTag(593278747)),s.commentDraft.sessionConfiguration.commentId,t),sessionType:d};default:return Object(o.i)().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}(T,n,e);if("number"==typeof D)return O.failTag(r.d.reserveTag(593278749),D),Promise.resolve(s.a.Handled);var E=D.sessionType,j=D.cancelAction;if(O.addDataField("ActiveSessionType",E,o.d.SystemMetadata),c.I()){var P=Object(d.J)(I),x=(null==P?void 0:P.currentMentionees)?Object.keys(P.currentMentionees).length:0;O.addDataField("NumberOfMentionsAdded",x,o.d.SystemMetadata)}return _||!Object(u.b)(I)&&!Object(l.g)(S)?(O.addDataField("DraftId","NoActiveDraft",o.d.SystemMetadata),O.addDataField("DiscardUnnecessary",!0,o.d.SystemMetadata),O.successTag(593278755),Promise.resolve(s.a.Unhandled)):(O.addDataField("DiscardUnnecessary",!1,o.d.SystemMetadata),O.addDataField("DraftId",null!==(y=null===(v=Object(d.J)(I))||void 0===v?void 0:v.commentDraft.sessionConfiguration.draftId)&&void 0!==y?y:"InvalidDraftState",o.d.SystemMetadata),h(Object(p.a)(Object(f.a)(e,r.d.reserveTag(593278750)))),g?g((function(){return h(j),O.addDataField("CancelledByUser",!1,o.d.SystemMetadata),O.successTag(593278751),s.a.Handled}),(function(){return O.addDataField("CancelledByUser",!0,o.d.SystemMetadata),O.successTag(593278752),h(Object(C.a)(Object(f.a)(e,r.d.reserveTag(593278753)))),s.a.Canceled})):(h(j),O.successTag(593278754),Promise.resolve(s.a.Handled)))}}},392:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(7),o=n(62),a=n(17),i=n(611),s=n(14),c=n(578);function d(e,t,n,d,u){return function(l,m){var f=Object(i.c)(t,n,s.p(m()),u);if(a.P()&&0===f.length)return Promise.resolve();if(d.getPersonaIconPropertiesArray)d.getPersonaIconPropertiesArray(f).then((function(t){l(Object(c.a)(e,Object(i.b)(t)))})).catch(Object(o.a)(r.d.reserveTag(595645964)));else{var p=Object(i.a)(f);l(Object(c.a)(e,Object(i.b)(p)))}return Promise.resolve()}}},399:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(242),o=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1),this.model=e,this.startThreadIndex=t,this.pointer=0,this.ignoreResolvedThreads=!1,t>e.length?this.pointer=e.length:this.pointer=t<0?-1:t,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var e=this.pointer;if(this.pointer<this.model.length-1)do{++this.pointer}while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.f.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&e<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var e=this.pointer;if(this.pointer>0)do{--this.pointer}while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&r.f.Resolved));return this.pointer>0||0===this.pointer&&e>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()},405:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},41:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},a={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",WARNING_RED:"#A80000",REST_RESOLVED_BODY:o.GRAY_20,RESOLVED_CARD_TEXT:o.GRAY_130,ACTIVE_COMMENT_TEXT:o.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},i=Object(r.__assign)(Object(r.__assign)({},o),a)},420:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r,o=n(7),a=n(5),i=n(51);function s(e){if(r)throw Object(a.i)().assertConditionTag(!1,"WebAppColors cannot be re-initialized.",578647955),new i.a("WebAppColors cannot be re-initialized.",o.d.reserveTag(577610271),-2130957508);r=e}function c(){if(!r)throw Object(a.i)().assertConditionTag(!1,"WebAppColors is not initialized",578647956),new i.a("WebAppColors is not initialized",o.d.reserveTag(577610272),-2130957509);return r}},432:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"}(r||(r={})),t.a=r},438:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("COMMIT_FAILURE",{commitText:t},e)}},439:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(7),o=n(5),a=n(131),i=n(188),s=n(382),c=n(46),d=n(174),u=n(14),l=n(21),m=n(389),f=n(391);function p(e,t,n){return function(p,C){var g=C(),h=u.h(g),b=Object(o.i)().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,o.a.None,o.b.NecessaryServiceDataEvent),v=Object(c.i)(h);b.addDataField("Trackback",e.trackback,o.d.SystemMetadata),b.addDataField("RenderContextType",e.renderContextType,o.d.SystemMetadata),b.addDataField("CommitPendingAttemptedCancel",v,o.d.SystemMetadata),b.addDataField("ActionSource",t,o.d.SystemMetadata);var y=Object(s.a)(h);return b.addDataField("DraftDiscardBehavior",y,o.d.SystemMetadata),y===i.a.CanAutoDiscard?p(Object(f.a)(e,t,!1)).then((function(e){return b.successTag(539754957),{draftDiscardResult:e,draftDiscardBehavior:y}})):(void 0!==n&&y===i.a.CannotAutoDiscard&&(b.addDataField("DraftWarningReason",n,o.d.SystemMetadata),p(Object(m.a)({draftWarningType:d.a.ReturnToDraft,draftWarningReason:n},Object(l.a)(e,r.d.reserveTag(591728722))))),b.successTag(539754958),Promise.resolve({draftDiscardResult:a.a.Canceled,draftDiscardBehavior:y}))}}},44:function(e,t,n){"use strict";var r;function o(e){return e===r.ClosePaneButton||e===r.NextCommentButton||e===r.PreviousCommentButton||e===r.GhostCard||e===r.NewCommentButton||e===r.PaneRoot||e===r.CommentsList}function a(e){return(t=e.componentType)===r.CardEditor||t===r.PostEditor||t===r.Card||t===r.Post||t===r.DraftCard||t===r.DiscreteHostedCommentRoot||t===r.ReopenThreadButton;var t}function i(e){switch(e){case r.CardEditor:case r.Card:case r.DraftCard:case r.DiscreteHostedCommentRoot:case r.ReopenThreadButton:return!0;case r.PostEditor:case r.Post:return!1}}function s(e,t){return a(e)&&a(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList"}(r||(r={}))},442:function(e,t,n){"use strict";var r=n(7),o=n(259),a=n(386),i=n(62),s=n(51),c=n(65),d=n(21);function u(e,t){return function(n,u){var l=c.d(u());return Object(a.a)(l)&&Object(o.b)(t)?l.setDisplayConfiguration(t).then((function(t){return n(function(e,t){return Object(d.b)("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}(e,t)),Promise.resolve(t)})).catch((function(e){return function(e){return Object(i.a)(r.d.reserveTag(578426816))(e),Promise.resolve(void 0)}(e)})):Promise.reject(new s.a("Not half pane or half pane configuration",r.d.reserveTag(577610273),-2130957557))}}n.d(t,"a",(function(){return u}))},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"b",(function(){return C})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return b}));var r,o=n(1),a=n(17);function i(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,smartReplies:e.smartReplies}}function s(e){return Object.keys(e.drafts)}function c(e){var t=0;for(var n in e.drafts)e.drafts.hasOwnProperty(n)&&++t;return t}function d(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function u(e){return c(e)>0}function l(e){return u(e)||f(e)}function m(e){return!a.mb()&&l(e)}function f(e){return void 0!==e.pendingDraft}function p(e,t){var n,r;try{for(var a=Object(o.__values)(s(e)),i=a.next();!i.done;i=a.next()){var c=i.value;if(e.drafts[c].pendingState===t)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}function C(e){return p(e,r.None)}function g(e){return p(e,r.Commit)}function h(e){return p(e,r.Discard)}function b(e,t){return h(e)&&C(t)}!function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"}(r||(r={}))},473:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=261;function o(){return r}function a(e){r=e}},485:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(r||(r={}))},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(87);function o(e){return!e.pendingCommentLoad||e.pendingCommentLoad.numberOfComments===e.commentData.length||!!e.virtualized&&(0!==e.commentData.length&&(void 0===e.pendingCommentLoad.selectedThreadIndex||e.pendingCommentLoad.selectedThreadIndex>=e.pendingCommentLoad.numberOfThreads||e.pendingCommentLoad.selectedThreadIndex<e.commentData.filter(r.a).length))}},501:function(e,t,n){"use strict";function r(e){return"object"==typeof e&&void 0!==e.message&&void 0!==e.SDXHostAPIErrorCode}n.d(t,"a",(function(){return r}))},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1),o=n(7),a=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.tag=n,o.errorCode=r,o.name="CommentError",o}return Object(r.__extends)(t,e),t.prototype.stringify=function(){return Object(o.e)(this.tag,this.stack,"Error "+((e=this.errorCode)>4294967295||e<-4294967296?"dword_out_of_range("+e+")":"0x"+(e<0?4294967295+e+1:e).toString(16)),this.innerException);var e},t}(o.c);function i(e){return Object(o.g)(e,"CommentError")}},52:function(e,t,n){"use strict";var r;!function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"}(r||(r={})),t.a=r},53:function(e,t,n){"use strict";var r;function o(e){return e.selectionDetails.lowFidelityWarningType===r.Edit}function a(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteReply}function i(e){return e.selectionDetails.lowFidelityWarningType===r.DeleteThread}function s(e){return a(e)||i(e)}function c(e){return!!e&&(o(e)||a(e))}function d(e){return!!e&&(s(e)||o(e))}function u(e){return void 0!==e.selectedPostId}function l(e){return u(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function m(e,t){return!!t&&u(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&d(t)}n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return m})),function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"}(r||(r={}))},535:function(e,t,n){"use strict";var r;!function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"}(r||(r={})),t.a=r},545:function(e,t,n){var r=n(546),o=n(373),a=n(908),i=n(1538),s=n(1089),c=function(e,t,n){var d,u,l,m,f=e&c.F,p=e&c.G,C=e&c.S,g=e&c.P,h=e&c.B,b=p?r:C?r[t]||(r[t]={}):(r[t]||{}).prototype,v=p?o:o[t]||(o[t]={}),y=v.prototype||(v.prototype={});for(d in p&&(n=t),n)l=((u=!f&&b&&void 0!==b[d])?b:n)[d],m=h&&u?s(l,r):g&&"function"==typeof l?s(Function.call,l):l,b&&i(b,d,l,e&c.U),v[d]!=l&&a(v,d,m),g&&y[d]!=l&&(y[d]=l)};r.core=o,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},546:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},564:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var r=n(7),o=n(5),a=!1,i=!1;function s(){var e;return i||(e=Object(o.i)().createActivityObject("LPPLazyLoad",Object(o.j)(o.g.GlobalAPI),o.a.None,o.b.NecessaryServiceDataEvent),i=!0),Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,1879)).then((function(t){return e&&e.successTag(570832851),t})).catch((function(t){e&&e.failTag(570832852,-2130957488),i=!1}))}function c(){var e;return a||(e=Object(o.i)().createActivityObject("AtMentionLazyLoad",Object(o.j)(o.g.GlobalAPI),o.a.None,o.b.NecessaryServiceDataEvent),a=!0),Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,1885)).then((function(t){return e&&e.successTag(591677089),t})).catch((function(t){e&&e.failTag(595895121,-2130957515),a=!1}))}function d(e){var t,a=Object(o.i)().createActivityObject("SharedCommentsUILazyLoad",Object(o.j)(o.g.GlobalAPI),o.a.None,o.b.NecessaryServiceDataEvent);switch(a.addDataField("ContainerName",e,o.d.SystemMetadata),e){case"ExtensionAwareCommentPaneContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(24)]).then(n.bind(null,1880))}),a);break;case"HostableCommentCardRendererContainer":t=u((function(){return Promise.all([n.e(0),n.e(1),n.e(24)]).then(n.bind(null,1884))}),a);break;default:Object(r.m)(e)}return t.then((function(e){return a.successTag(595731075),e}),(function(e){a.failTag(595734544,-2130957504)}))}function u(e,t,n){void 0===n&&(n=3);return new Promise((function(r,a){e().then((function(e){t.addDataField("DelayLoadRetryCount",n,o.d.SystemMetadata),r(e)}),(function(o){setTimeout((function(){1!==n?u(e,t,n-1).then(r,a):a(o)}),500)}))}))}},577:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("END_VIEW_INIT",{},e)}},578:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}},579:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}},583:function(e,t,n){"use strict";n(103);var r=n(97),o=n(87),a=n(326);n(281);n.d(t,"b",(function(){return r.b})),n.d(t,"d",(function(){return r.o})),n.d(t,"a",(function(){return o.b})),n.d(t,"c",(function(){return a.a}))},584:function(e,t,n){"use strict";var r=n(1),o=n(7),a=n(62),i=n(27),s=n(52),c=n(359),d=n(5),u=n(189);var l,m=n(1013),f=n(130),p=n(164);!function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"}(l||(l={}));var C,g=n(291),h=n(378),b=n(720),v=function(){function e(e){this.rawDelta=e,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return void 0===this._deserializedDelta&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var e,t,n=this;this._deserializedDelta=JSON.parse(this.rawDelta),null===(t=null===(e=this._deserializedDelta)||void 0===e?void 0:e.ops)||void 0===t||t.forEach((function(e){var t;if(null==e?void 0:e.attributes){e.attributes.link&&(n._NumHyperlinks+=1);var r=e.attributes.atmention,o=e.optional;!r||void 0!==o&&void 0!==o.atmention||null===(t=n._users)||void 0===t||t.push({UserId:r.email,Provider:b.b}),(e.attributes.weight||e.attributes.italic||e.attributes.underline)&&(n._hasRichTextFormatting=!0)}}))},e}(),y=n(51),T=n(501),O=n(17),I=n(234),S=n(16),_=n(46),D=n(247),E=n(174),j=n(14),P=n(275),x=n(703),A=n(438),k=n(389);function R(e,t,n,a,s,c,u){return function(b,y){var T,R,M=Object(d.i)().createActivityObject("CommitComment",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);M.addDocumentMetadata(d.f.Basic);var F=p.b[s.type],L=y(),V=P.b(L),B=j.t(L);if(void 0===B||B.commentDraft.sessionConfiguration.sessionType!==s.type)return M.failTag(593278784,-2130957522),Promise.resolve(I.a.CommitFailed);var H="",U=!1;switch(s.type){case f.b:H=s.commentId;break;case f.d:H=s.parentId,U=!0;break;case f.a:B&&(H=B.commentDraft.sessionConfiguration.draftId||"")}var G=j.j(L),W=!U||Object(h.a)(H,G,e.renderContextType)===g.a.Expanded;if(M.addDataField("IsCardExpanded",W,d.d.SystemMetadata),(null==u?void 0:u.Task)&&!Object(S.c)(L.commentState.modelCapabilities)&&(Object(d.i)().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),u.Task=void 0),(O.b()&&s.type===f.a||O.c()&&s.type===f.d)&&(M.addDataField("IsPreExistingTask",!!V[H],d.d.SystemMetadata,d.e.Critical),M.addDataField("AffectingTaskMetadata",!!(null==u?void 0:u.Task),d.d.SystemMetadata,d.e.Critical)),M.addDataField("SessionType",F,d.d.SystemMetadata),s.type!==f.a){var q=Object(S.h)(j.d(L),H);q.valid&&(M.addDataField("MatchesCommentAuthor",q.matchesCurrentUser,d.d.SystemMetadata),M.addDataField("ThreadCreationDeltaMs",q.timeElapsed,d.d.SystemMetadata))}M.addDataField("AssociatedCommentId",H,d.d.SystemMetadata),M.addDataField("AtMentionsEnabled",n,d.d.SystemMetadata),M.addDataField("Trackback",e.trackback,d.d.SystemMetadata),M.addDataField("RenderContextType",e.renderContextType,d.d.SystemMetadata),M.addDataField("CommitSource",c,d.d.SystemMetadata);var z=j.h(L);return Object(_.i)(z)?(null===(R=(T=Object(d.i)()).logDiagnosticTrace)||void 0===R||R.call(T,Object(m.a)(C||(C=Object(r.__makeTemplateObject)(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),o.d.reserveTag(556827598),d.h.Info,d.c.ProductServiceUsage,e.telemetryVisitor,Object(d.l)("DraftId",B.commentDraft.sessionConfiguration.draftId,d.d.SystemMetadata)),Promise.resolve(I.a.CommitPending)):(b(Object(x.a)(i.chainActionDetails(e,o.d.reserveTag(593278785)))),a().then((function(r){if(!n){var a=N(b,s,r,0,M,o.d.reserveTag(593278786),o.d.reserveTag(593278787),e,u);return Promise.resolve(a)}var i=new v(r),c=i.Mentions;M.addDataField("NumberOfMentionsAdded",c.length,d.d.SystemMetadata);var m=Object(d.i)();if(O.h()&&c.length>0&&m.logFloodgateActivity&&m.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),M.addDataField("NumberOfHyperlinks",i.NumHyperlinks,d.d.SystemMetadata),M.addDataField("CreateCommentWithRichFormatting",i.HasRichTextFormatting,d.d.SystemMetadata),!c.length){a=N(b,s,r,0,M,o.d.reserveTag(593278788),o.d.reserveTag(593278789),e,u);return Promise.resolve(a)}return t.grantUsersAccess(c).then((function(t){var n=function(e){var t=e.OperationResult;return"boolean"==typeof t?t:t===l.Success}(t),a=function(e){return!!e.Details&&e.Details.Canceled}(t);if(M.addDataField("AllUsersGrantedAccess",n,d.d.SystemMetadata),M.addDataField("ShareDialogCanceled",a,d.d.SystemMetadata),t.OperationResult===l.FailedSilently)return Object(o.i)("Check Access Phase failed - share dialog not shown"),M.failTag(593278790,-2130957561),w(b,r,E.a.GrantAccessFailedSilently,o.d.reserveTag(593278791),o.d.reserveTag(593278792),e),Promise.resolve(I.a.ShareFailed);if(a)return Object(o.i)("Share dialog was canceled by user"),M.successTag(593278793),w(b,r,E.a.GrantAccessCanceled,o.d.reserveTag(593278794),o.d.reserveTag(554801174),e),Promise.resolve(I.a.ShareFailed);if(!n)return Object(o.i)("Not all users have been granted access - going back to initial state"),M.successTag(593278795),w(b,r,E.a.GrantAccessCanceled,o.d.reserveTag(593278796),o.d.reserveTag(554784648),e),Promise.resolve(I.a.ShareFailed);var i=N(b,s,r,c.length,M,o.d.reserveTag(593278797),o.d.reserveTag(593278798),e,u);return Promise.resolve(i)}),(function(t){return M.failTag(593278799,-2130957561),Object(o.i)("Grant Users Access has failed",Object(o.l)(t)),w(b,r,E.a.GrantAccessFailedSilently,o.d.reserveTag(593278800),o.d.reserveTag(554784393),e),Promise.resolve(I.a.ShareFailed)}))}),(function(t){return M.failTag(593278801,-2130957539),b(Object(A.a)(i.chainActionDetails(e,o.d.reserveTag(593278802)),void 0)),Object(o.i)("getCommentBody failed",Object(o.l)(t)),O.F()&&b(Object(k.a)({draftWarningReason:D.a.CommitFailure,draftWarningType:E.a.CommitFailed},i.chainActionDetails(e,o.d.reserveTag(593278803)))),Promise.resolve(I.a.CommitFailed)})))}}function w(e,t,n,r,o,a){e(Object(A.a)(i.chainActionDetails(a,r),t)),e(Object(k.a)({draftWarningType:n,draftWarningReason:D.a.GrantUsersAccessFailure},i.chainActionDetails(a,o)))}function N(e,t,n,r,a,s,c,l,m){var p=function(e,t,n,r,a){try{switch(t.type){case"CREATE":e(i.commitDraft(i.chainActionDetails(r,o.d.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:n},metadataUpdates:a}));break;case"EDIT":e(i.commitDraft(i.chainActionDetails(r,o.d.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:n,commentId:t.commentId}}));break;case"REPLY":e(i.commitDraft(i.chainActionDetails(r,o.d.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:n,parentId:t.parentId},metadataUpdates:a}));break;default:return Object(d.i)().assertConditionTag(!1,"Unexpected session type '"+t.type+"'",593278807),e(Object(A.a)(i.chainActionDetails(r,o.d.reserveTag(593278808)),n)),-2130957532}}catch(t){if(!Object(y.b)(t)&&!Object(T.a)(t))throw t;return e(Object(A.a)(i.chainActionDetails(r,o.d.reserveTag(593278809)),n)),O.F()&&e(Object(k.a)({draftWarningReason:D.a.CommitFailure,draftWarningType:E.a.CommitFailed},i.chainActionDetails(r,o.d.reserveTag(593278810)))),Object(u.a)(t)}return}(e,t,n,l,m);return p?(a.failTag(c,p),I.a.CommitFailed):r?(t.type===f.a?(a.addDataField("CreateThreadWithMentions",!0,d.d.SystemMetadata,d.e.Critical),m&&m.Task&&a.addDataField("CreateThreadWithTaskAssigned",!0,d.d.SystemMetadata,d.e.Critical)):t.type===f.d&&(a.addDataField("CreateReplyWithMentions",!0,d.d.SystemMetadata,d.e.Critical),m&&m.Task&&a.addDataField("CreateReplyWithTaskAssigned",!0,d.d.SystemMetadata,d.e.Critical)),a.successTag(s),I.a.Success):(a.successTag(s),I.a.Success)}var M=n(439),F=n(391),L=n(259),V=n(387),B=n(23),H=n(705),U=n(577),G=n(442);var W=n(114),q=n(715);var z=n(360);function Y(e,t){return{requestDeleteComment:function(t,n){e(i.requestDeletePost(t,n))},requestDeleteThread:function(t,n,r){e(i.requestDeleteThread(t,n,r))},requestReopenThread:function(t,n,r){e(i.requestReopenThread(t,n,r))},requestResolveThread:function(t,n,r){e(i.requestThreadResolve(t,n,r))},requestEditCommentSession:function(n,r){e(Object(c.a)(n,t.commentAPI,{sessionType:"EDIT",commentId:r},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362624)))},requestReplyCommentSession:function(n,r){e(Object(c.a)(n,t.commentAPI,{sessionType:"REPLY",threadId:r},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(574362625)))},commitCommentAndFocus:function(n,r,o,a,i,s,c,d){return e(R(n,t.peopleAPI,a,r,o,c,d)).then((function(e){return e===I.a.Success&&t.focusManager.focusCommentCardCommand(i,s),e}))},discardDraftAsync:function(t,n,r,o){return e(Object(F.a)(t,n,r,o))},discardDraftIfEmpty:function(t,n,r){return e(Object(M.a)(t,n,r))},showLowFidelityWarning:function(t,n,r){e(i.showLowFidelityWarning(t,n,r))},clearLowFidelityWarning:function(t){e(i.clearLowFidelityWarning(t))},saveDraft:function(t,n,r){e(i.saveDraft(t,{draftId:n,draftContent:r}))},clearCommentHighlight:function(t,n){e(i.clearCommentHighlight(t,s.a.SharedComments,n))},checkUserAccess:function(e){return t.peopleAPI.checkUserAccess(e)},updateMentioneesStillInDraft:function(t,n){e(i.updateMentioneesStillInDraft(t,n))},addToCurrentMentionees:function(t,n){e(i.addToCurrentMentionees(t,n))},updateSelectedTaskAssignee:function(t,n){e(i.updateSelectedTaskAssignee(t,n))},displayDraftWarning:function(t,n,r){e(i.displayDraftWarning({draftWarningType:n,draftWarningReason:r},t))},showPostErrorUI:function(t,n){e(i.showPostErrorUI(t,n))},clearPostErrorUI:function(t,n){e(i.clearPostErrorUI(t,n))},selectCommentCardAndShowLowFidelityWarning:function(t,n,r){e(function(e,t,n){return function(r,o){var a,i=o();(null===(a=j.r(i))||void 0===a?void 0:a.selectedCardId)!==t&&r(Object(W.b)(e,t,void 0,W.a.ExpandCard,s.a.SharedComments)),r(Object(q.a)(e,t,n))}}(t,n,r))},draftEmptinessChanged:function(t,n,r){e(i.draftEmptinessChanged(t,r,n))},selectComment:function(t,n,r,o){return e(Object(z.b)(t,n,r,o))},collapseCard:function(t,n){e(i.collapseCard(t,n))},requestUpdateCommentReactions:function(n,r,o,a){e(function(e,t,n,r,o){return function(){var a=Object(d.i)().createActivityObject("CommentReaction",e.telemetryVisitor,d.a.None,d.b.NecessaryServiceDataEvent);t.beginDraftingAsync(n).then((function(e){e.updateProperties("Reaction",{type:"Reaction",reactionType:r,isActive:o}),e.commit(),e.endDrafting(),a.successTag(587317280)})).catch((function(e){a.failTag(587317281,Object(u.a)(e))}))}}(n,t.commentAPI,{sessionType:"METADATA",threadId:r},o,a))},requestPresentLinkToComment:function(t,n){e(i.requestPresentLinkToComment(t,n))}}}function K(e,t){return Object(r.__assign)(Object(r.__assign)({},Y(e,t)),{highlightComment:function(t,n){e(i.highlightComment(t,n,s.a.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Object(c.a)(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(Object(a.a)(o.d.reserveTag(592314377)))},queueLoadThreads:function(t,n){e(i.queueLoadThreads(t,{threadIds:n}))},requestClosePane:function(t){e(i.requestClosePane(t))},requestDisplayConfiguration:function(t,n){return e(Object(G.a)(t,n))},readyToRender:function(t){e(i.readyToRender(t))},requestModalConfirmation:function(t,n,r,o){e(i.requestModalConfirmation(t,n,r,o))},initializeView:function(n){e(function(e,t,n,r,i){return function(s){return s(Object(H.a)({renderContextType:e,trackback:o.d.reserveTag(595899542),telemetryVisitor:i})),t===V.a.NewThread?(e===B.a.HalfPane&&s(Object(G.a)({renderContextType:e,trackback:o.d.reserveTag(595899543),telemetryVisitor:i},{displayMode:L.a.Variable,desiredHeight:0})).catch(Object(a.a)(o.d.reserveTag(595645966))),s(Object(c.a)({renderContextType:e,trackback:o.d.reserveTag(595898586),telemetryVisitor:i},n,{sessionType:"CREATE"},!1,r)).then((function(){s(Object(U.a)({renderContextType:e,trackback:o.d.reserveTag(595899545),telemetryVisitor:i}))}))):s(Object(U.a)({renderContextType:e,trackback:o.d.reserveTag(595899546),telemetryVisitor:i}))}}(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(t,n){e(i.updateDraftRenderContext(t,n))}})}function X(e,t){return Object(r.__assign)(Object(r.__assign)({},Y(e,t)),{updateRenderLockForDraft:function(t,n,r){e(i.updateDraftRenderContext(t,n,r))},highlightComment:function(n){e(i.highlightComment(n,t.resource.id,s.a.SharedComments))},requestDisplayConfiguration:function(n,r){return t.componentTree.componentTreeId.renderContextType!==B.a.HalfPane?Promise.resolve(void 0):e(Object(G.a)(n,r))},queueLoadThread:function(n){return e(i.queueLoadThreads(n,{threadIds:[t.resource.id]}))}})}n.d(t,"b",(function(){return K})),n.d(t,"a",(function(){return X}))},585:function(e,t,n){"use strict";var r=n(697),o=(n(386),n(259)),a=(n(282),n(232));n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return o.a})),n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return a.a}))},611:function(e,t,n){"use strict";var r=n(1);var o=n(184),a=n(41);function i(e,t,n,a){var i;return function(e,t){var n={};return e.filter((function(e){var r=Object(o.f)(e);return!(!r||n[r]||d(t,e))&&(n[r]=!0)}))}(function e(t){return t.reduce((function(t,n){return Array.isArray(n)?t.push.apply(t,Object(r.__spread)(e(n))):t.push(n),t}),[])}([e.map((function(e){return e.author})),null!==(i=null==t?void 0:t.map((function(e){return e.history.map((function(e){return e.records[0].user}))})))&&void 0!==i?i:[],null!=a?a:[]]),n)}function s(e){return e.reduce((function(e,t){var n=function(e){if(!e.authorID&&!e.authorName)return;return e.authorID||e.authorName}(t);return n?(e[n]=t,e):e}),{})}function c(e){var t=[];return e.forEach((function(e){t.push({authorName:e.DisplayName||"",authorID:e.UserId,authorColor:a.a.COMMENTS_PURPLE,authorImageURL:""})})),t}function d(e,t){var n=Object(o.f)(t);if(n){var r=e[n];return void 0!==r?r:t.DisplayName&&e[t.DisplayName]?e[t.DisplayName]:void 0}}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}))},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),o=n(5),a=n(51),i=function(e){return function(t){Object(a.b)(t)?Object(o.i)().assertConditionTag(!1,t.message,e):Object(o.i)().assertConditionTag(!1,"Unknown error "+Object(r.l)(t),e)}}},625:function(e,t,n){"use strict";var r=n(7),o=n(1271),a=n(5),i=n(173),s=n(184),c=n(51),d=n(119),u=n(17),l=n(174),m=n(53),f=n(535),p=n(231);n(165),n(23);function C(e,t,n){var o=n&&u.i()?t-1:t-2;if(o<1)throw new c.a(d.f,r.d.reserveTag(589103692),-2130957559);var a=u.i();return 1===o?a?e.getString(106):e.getString(9):a?e.formatString(107,String(o)):e.formatString(10,String(o))}function g(e,t){switch(t){case i.a.AtFinishNextCommentIsFirst:return e.getString(8);case i.a.AtStartNextCommentIsFirst:return e.getString(6);case i.a.MoreCommentsUpcoming:case i.a.DocumentHasComments:return e.getString(7);case i.a.OnlyCommentsInCurrent:case i.a.NoComments:case i.a.Unknown:return"";default:Object(r.m)(t)}}function h(e,t,n,r){return n?t?e.getString(16):e.getString(17):u.F()&&void 0!==r&&r!==p.a.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function b(e,t){switch(t){case l.a.ReturnToDraft:return e.getString(110);case l.a.GrantAccessFailedSilently:return e.getString(134);case l.a.GrantAccessCanceled:return e.getString(234);case l.a.CommitFailed:return e.getString(135);case l.a.None:return Object(a.i)().assertConditionTag(!1,"Invalid DraftWarningType: "+t,595686755),""}}function v(e,t){return void 0===t&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function y(e,t){return t?Object(m.f)(t)?e.getString(35):Object(m.c)(t)?e.getString(36):"":""}n.d(t,"r",(function(){return C})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"a",(function(){return O})),n.d(t,"e",(function(){return I})),n.d(t,"c",(function(){return S})),n.d(t,"j",(function(){return _})),n.d(t,"m",(function(){return D})),n.d(t,"n",(function(){return E})),n.d(t,"q",(function(){return j})),n.d(t,"p",(function(){return P})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return A})),n.d(t,"k",(function(){return k})),n.d(t,"o",(function(){return R}));var T=Object(o.a)((function(){try{(new Date).toLocaleDateString("i")}catch(e){return"RangeError"===e.name}return!1}));function O(e,t){var n=(!u.t()||!!t)&&T();try{if(n){var r={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,r)}return Object(a.i)().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: "+T()+", locale Exists: "+!!t,595882385),e.toLocaleDateString()}catch(n){return Object(a.i)().assertConditionTag(!1,"LocaleDateString conversion failed: "+n.name+", locale Exists: "+!!t+", doesToLocaleDateStringSupportsLocales: "+T()+", Date: "+e.toString(),595953050),""}}function I(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function S(e,t){switch(e){case f.a.Draft:case f.a.DraftPreCommitPending:return t.getString(16);default:return t.getString(89)}}function _(e){return e.getString(122)}function D(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Object(s.g)(e))}function E(e,t,n){return e.IsCurrentUser?t?n.getString(132):n.getString(131):t?n.formatString(130,Object(s.g)(e)):n.formatString(129,Object(s.g)(e))}function j(e){return e.formatString(111,e.getString(133))}function P(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function x(e,t,n,r){var o,a=t===f.a.Draft||t===f.a.DraftPreCommitPending;return null!==(o=A(e,n,r))&&void 0!==o?o:a?e.getString(173):e.getString(174)}function A(e,t,n){var r=Object(s.d)(n);if(r)return e.formatString(t?179:178,r)}function k(e,t){return e?t.getString(176):t.getString(126)}function R(e,t,n){return e?n.getString(180):(null==t?void 0:t.DisplayName)?n.formatString(114,t.DisplayName):n.getString(181)}},627:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s}));n(7),n(51);var r,o=function(){function e(){this.ops=[]}return e.prototype.insert=function(e,t,n){return this.ops.push({insert:e,attributes:t,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();function a(e,t,n){return{fullName:e,email:t,resolveState:n}}function i(e){return s(JSON.parse(e))}function s(e){return e.ops?e.ops.map((function(e){return e.insert})).join(""):""}!function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"}(r||(r={}))},637:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},638:function(e,t,n){e.exports=!n(639)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},639:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},640:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var r,o=n(5);function a(e){r=e}function i(e){r?r.announceToScreenReader(e):Object(o.i)().assertConditionTag(!1,"announceToScreenReader not registered",595632534)}var s=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(e){e&&a(e)},e}(),c=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new s),this.screenReaderNotifierManagerInstance},e}()},65:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(109),o=function(e){return e.paneState.visibilityState===r.a.Visible},a=function(e){return e.paneState.visibilityState!==r.a.Closed},i=function(e){return e.paneState.visibilityState},s=function(e){return e.paneState.componentTree},c=function(e){return e.paneState.viewContainer}},697:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"}(r||(r={}))},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={LivePersonaPicker:{webSettingName:"LivePersonaPicker",dependencies:[]},PersonaFeature:{webSettingName:"PersonaColor",dependencies:[]},NewCommentButton:{webSettingName:"NewCommentButton",dependencies:[]},DiscreteHostedComments:{webSettingName:"DiscreteHostedComments",dependencies:["NewDraftingUI"]},CommentsFluentUI:{webSettingName:"CommentsFluentUI",dependencies:[]},RenderDHCInPane:{dependencies:[]},CommentTasks:{webSettingName:"CommentTasks",dependencies:["CommentsFluentUI"]},NoDiscardOnFocusLoss:{webSettingName:"NoDiscardOnFocusLoss",dependencies:[]},NewDraftingUI:{webSettingName:"DiscreteHostedComments",dependencies:[]},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure",dependencies:[]},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},NewModelState:{webSettingName:"NewModelState",dependencies:[]},HeadlessBoot:{dependencies:[]},HyperlinksInComments:{webSettingName:"HyperlinksInComments",dependencies:[]},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText",dependencies:[]},ContentNavigation:{webSettingName:"ContentNavigation",dependencies:[]},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey",dependencies:[]},ExtendedDrafting:{webSettingName:"ExtendedDrafting",dependencies:["NewDraftingUI"]},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb",dependencies:[]},SmartReplies:{webSettingName:"SmartReplies",dependencies:[]},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",dependencies:[]},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration",dependencies:["NewModelState"]},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions",dependencies:[]},CommentReactions:{webSettingName:"CommentReactions",dependencies:[]},LinkToComment:{webSettingName:"LinkToComment",dependencies:[]},WebThemeIntegration:{webSettingName:"WebThemeIntegration",dependencies:[]},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText",dependencies:[]},QuickEdit:{dependencies:[]},QuillInitializationTelemetry:{webSettingName:"QuillInitializationTelemetry",dependencies:[]},CtrlEnterTip:{webSettingName:"CtrlEnterTip",dependencies:["CommentsFluentUI"]},LPPVerboseLogging:{dependencies:[]},FluentSVRefreshWin32:{dependencies:[]},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},UnresponsivePaneWorkaround:{dependencies:[]},DiagnosticHeartbeat:{dependencies:[]},EnableExperimentalLists:{dependencies:[]}}},700:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("ADD_CONTENT_EXTENSION",{extension:t},e)}},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:n},e)}},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:n},e)}},703:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("BEGIN_PROCESSING_COMMIT",{},e)}},704:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("BEGIN_PROCESSING_DISCARD",{},e)}},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("BEGIN_VIEW_INIT",{},e)}},706:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("CANCEL_DISCARD",{},e)}},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:n},e)}},708:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e){return Object(r.b)("CLEAR_COMMENT_SELECTION",{},e)}},709:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(21);function o(e,t){return Object(r.b)("COMMIT_DRAFT",t,e)}function a(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}},710:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("HIGHLIGHT_COMMENT",{commentId:t,actionSource:n},e)}},711:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("LOAD_COMMENT",{commentData:t,tasks:n},e)}},712:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}},713:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("RELOAD_COMMENTS",t,e)}},714:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:n},e)}},715:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t,n){return Object(r.b)("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:n},e)}},716:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}},717:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}},718:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21);function o(e,t){return Object(r.b)("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}},719:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n(7),o=n(28),a=function(e){return e.contentExtensions.extensions},i=function(e,t){var n=a(e)[t];return void 0!==n&&n.priority!==o.d.Disabled},s=function(e,t){if(!t)return!1;switch(t.renderMode){case o.e.Integrated:case o.e.TaskPaneItem:return void 0!==(n=a(e)[t.renderMode])&&n.priority!==o.d.Disabled;case o.e.Isolated:var n;return void 0!==(n=a(e)[t.renderMode])&&n.controller.provider.getExtension(t.threadId).priority!==o.d.Disabled;default:Object(r.m)(t)}}},720:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r="O365",o="@"},721:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(77);function o(){}function a(){var e=document.getElementById(r.y());e&&e.focus()}function i(e){if(e&&e.target){var t=e.target.closest(".ql-editor");null!==t&&"true"===t.contentEditable||e.preventDefault()}}},764:function(e,t,n){"use strict";var r=n(7),o=n(5),a=n(51),i=n(119),s=function(){function e(e){this.localizationDetails=e}return e.prototype.isMac=function(){return window&&window.navigator&&window.navigator.userAgent.indexOf("Macintosh")>0},e.prototype.getLocaleInfo=function(){return{isRightToLeft:this.localizationDetails.isRightToLeft||!1,uiCulture:this.localizationDetails.uiCulture||"en-us",dataCulture:this.localizationDetails.dataCulture||"en-us"}},e.prototype.getString=function(e){var t=this.getStringOrUndefined(e);if(void 0===t)throw new a.a(i.j,r.d.reserveTag(589103688),-2130957554);return t},e.prototype.getStringOrUndefined=function(e){switch(e){case 1:return CommentPaneStrings.EditButtonText;case 2:return CommentPaneStrings.DeleteButtonText;case 120:return CommentPaneStrings.ContextMenuEditButtonText;case 121:return CommentPaneStrings.ContextMenuDeleteButtonText;case 3:return CommentPaneStrings.ResolveThreadButtonText;case 4:return CommentPaneStrings.ReopenThreadButtonText;case 5:return CommentPaneStrings.DeleteThreadButtonText;case 6:return CommentPaneStrings.GoToFirstCommentGhostCardText;case 7:return CommentPaneStrings.GoToNextCommentGhostCardText;case 8:return CommentPaneStrings.ReturnToFirstCommentGhostCardText;case 9:return CommentPaneStrings.View1MoreReplyExpandButtonText;case 10:return CommentPaneStrings.ViewNMoreRepliesExpandButtonText;case 106:return CommentPaneStrings.OneMoreReplyExpandButtonText;case 107:return CommentPaneStrings.NMoreRepliesExpandButtonText;case 11:return CommentPaneStrings.ReplyBoxPlaceholderText;case 12:return CommentPaneStrings.ReplyBoxPlaceholderTextNoMentions;case 13:return CommentPaneStrings.EmptyPaneMessage;case 14:return CommentPaneStrings.SaveButtonText;case 15:return CommentPaneStrings.CancelButtonText;case 16:return CommentPaneStrings.NewThreadPlaceholderText;case 17:return CommentPaneStrings.NewThreadPlaceholderTextNoMentions;case 21:return CommentPaneStrings.NormalPostA11yLabel;case 145:return CommentPaneStrings.NewNormalPostA11yLabel;case 122:return CommentPaneStrings.NormalPostBodyA11yLabel;case 22:return CommentPaneStrings.ResolvedPostA11yLabel;case 136:return CommentPaneStrings.NewResolvedPostA11yLabel;case 23:return CommentPaneStrings.EditingPostA11yLabel;case 25:return CommentPaneStrings.ReadOnlyPostA11yLabel;case 137:return CommentPaneStrings.NewReadOnlyPostA11yLabel;case 26:return CommentPaneStrings.LowFidelityWarningPostA11yLabel;case 27:return CommentPaneStrings.NormalCardA11yLabel;case 29:return CommentPaneStrings.ResolvedCardA11yLabel;case 30:return CommentPaneStrings.ReadOnlyCardA11yLabel;case 28:return CommentPaneStrings.DraftCardA11yLabel;case 31:return CommentPaneStrings.PaneA11yLabel;case 32:return CommentPaneStrings.ListA11yLabel;case 18:return CommentPaneStrings.PaneHeaderLabel;case 19:return CommentPaneStrings.CloseButtonTitle;case 20:return CommentPaneStrings.ClosePaneA11yLabel;case 35:return CommentPaneStrings.LowFidelityWarningOnEdit;case 36:return CommentPaneStrings.LowFidelityWarningOnDelete;case 37:return CommentPaneStrings.ProceedButtonText;case 38:return CommentPaneStrings.PostSaveA11yLabel;case 39:return CommentPaneStrings.PostCancelEditA11yLabel;case 40:return CommentPaneStrings.PostEditA11yLabel;case 41:return CommentPaneStrings.PostDeleteA11yLabel;case 42:return CommentPaneStrings.PostProceedEditA11yLabel;case 43:return CommentPaneStrings.PostCancelDeleteA11yLabel;case 45:return CommentPaneStrings.CardContextMenuA11yLabel;case 123:return CommentPaneStrings.PostContextMenuA11yLabel;case 46:return CommentPaneStrings.CardCancelDraftA11yLabel;case 47:return CommentPaneStrings.PostCancelDraftA11yLabel;case 48:return CommentPaneStrings.SendButtonText;case 49:return CommentPaneStrings.CardSendReplyA11yLabel;case 83:return CommentPaneStrings.CardPostCommentA11yLabel;case 55:return this.isMac()?CommentPaneStrings.ReplyBoxA11yDescription_Mac:CommentPaneStrings.ReplyBoxA11yDescription;case 56:return CommentPaneStrings.EditorBoxA11yDescription;case 57:return CommentPaneStrings.PeoplePickerSearching;case 58:return CommentPaneStrings.PeoplePickerTypeToSearch;case 59:return CommentPaneStrings.PeoplePickerSearchDirectory;case 60:return CommentPaneStrings.PeoplePickerTopNResults;case 61:return CommentPaneStrings.PeoplePickerNoResultsFound;case 62:return CommentPaneStrings.PeoplePickerSuggestedContactsHeader;case 73:return CommentPaneStrings.PeoplePickerLoading;case 63:return CommentPaneStrings.DeleteCommentThreadA11yUpdate;case 64:return CommentPaneStrings.CancelledReplyA11yUpdate;case 103:return CommentPaneStrings.CancelledCommentDraftA11yUpdate;case 65:return CommentPaneStrings.DeletedCommentPostA11yUpdate;case 66:return CommentPaneStrings.CancelledEditingA11yUpdate;case 67:return CommentPaneStrings.CommentPostedA11yUpdate;case 124:return CommentPaneStrings.ResolveCommentThreadA11yUpdate;case 125:return CommentPaneStrings.ReopenCommentThreadA11yUpdate;case 68:return CommentPaneStrings.DiscardDialogTitle;case 69:return CommentPaneStrings.DiscardDialogBody;case 70:return CommentPaneStrings.DiscardDialogAbandon;case 71:return CommentPaneStrings.DiscardDialogResume;case 88:return CommentPaneStrings.EditCommentEditorA11yLabel;case 89:return CommentPaneStrings.ReplyCommentEditorA11yLabel;case 91:return CommentPaneStrings.NewCommentButtonText;case 92:return CommentPaneStrings.NewCommentButtonA11yLabel;case 108:return CommentPaneStrings.ReplyBoxDisabledPlaceholderText;case 230:return CommentPaneStrings.FocusMovedToUnpostedDraftA11yUpdate;case 110:return this.isMac()?CommentPaneStrings.PostDraftWarningText_Mac:CommentPaneStrings.PostDraftWarningText;case 111:return CommentPaneStrings.TaskHeaderAssignedToText;case 112:return CommentPaneStrings.TaskFooterAssignText;case 113:return CommentPaneStrings.TaskFooterReassignText;case 114:return CommentPaneStrings.TaskItemAssignedToText;case 115:return CommentPaneStrings.TaskItemReassignedToText;case 116:return CommentPaneStrings.TaskItemCompletedText;case 117:return CommentPaneStrings.TaskItemReopenedText;case 118:return CommentPaneStrings.TaskItemScheduleText;case 119:return CommentPaneStrings.TaskItemUnknownText;case 184:return CommentPaneStrings.RetryButtonText;case 183:return CommentPaneStrings.ContentErrorMessage;case 126:return CommentPaneStrings.ResolveTaskButtonText;case 127:return CommentPaneStrings.TaskHeaderAssignedToYouText;case 128:return CommentPaneStrings.TaskAssignerPeoplePickerA11yLabel;case 129:return CommentPaneStrings.TaskHeaderCheckboxA11yLabel;case 130:return CommentPaneStrings.TaskHeaderResolvedCheckboxA11yLabel;case 131:return CommentPaneStrings.TaskHeaderAssignedToYouCheckboxA11yLabel;case 132:return CommentPaneStrings.TaskHeaderAssignedToYouResolvedCheckboxA11yLabel;case 133:return CommentPaneStrings.TaskHeaderUnassigned;case 134:return CommentPaneStrings.FailedToCommitMentionText;case 234:return CommentPaneStrings.FailedToCommitMentionShareCanceledText;case 135:return CommentPaneStrings.CommitErrorMessage;case 165:return CommentPaneStrings.NormalCardTaskToYouA11yLabel;case 166:return CommentPaneStrings.ReadOnlyCardTaskToYouA11yLabel;case 167:return CommentPaneStrings.ResolvedCardResolvedTaskToYouA11yLabel;case 168:return CommentPaneStrings.CardResolvedTaskToYouA11yLabel;case 160:return CommentPaneStrings.NormalCardTaskA11yLabel;case 161:return CommentPaneStrings.ReadOnlyCardTaskA11yLabel;case 163:return CommentPaneStrings.ResolvedCardResolvedTaskA11yLabel;case 164:return CommentPaneStrings.CardResolvedTaskA11yLabel;case 169:return CommentPaneStrings.NormalCardTaskUnassignedA11yLabel;case 170:return CommentPaneStrings.ReadOnlyCardTaskUnassignedA11yLabel;case 171:return CommentPaneStrings.ResolvedCardResolvedTaskUnassignedA11yLabel;case 172:return CommentPaneStrings.CardResolvedTaskUnassignedA11yLabel;case 173:return this.isMac()?CommentPaneStrings.PostCommentTooltip_Mac:CommentPaneStrings.PostCommentTooltip;case 174:return this.isMac()?CommentPaneStrings.SendButtonTooltip_Mac:CommentPaneStrings.SendButtonTooltip;case 175:return CommentPaneStrings.CancelButtonTooltip;case 176:return CommentPaneStrings.ReopenTaskTooltip;case 177:return CommentPaneStrings.NewCommentButtonTooltip;case 178:return CommentPaneStrings.CommitButtonAssignTooltip;case 179:return CommentPaneStrings.ReplyButtonReassignTooltip;case 180:return CommentPaneStrings.TaskAssignedToYouTooltip;case 181:return CommentPaneStrings.TaskUnassignedTooltip;case 182:return CommentPaneStrings.TaskAssignerChevronTooltip;case 203:return CommentPaneStrings.SmartReplyPickerHeader;case 204:return CommentPaneStrings.TaskUnassignedHistoryString;case 202:return CommentPaneStrings.TaskHeaderResolved;case 197:return CommentPaneStrings.ResolvedCommentCardLabel;case 206:return CommentPaneStrings.DeleteTaskButtonText;case 207:return CommentPaneStrings.LinkToCommentButtonText;case 227:return CommentPaneStrings.PeoplePickerSuggestionSelectedA11yUpdate;case 229:return CommentPaneStrings.TruncationUIReadMoreText;case 231:return CommentPaneStrings.CommentLikeA11yLabel;case 232:return CommentPaneStrings.TaskHistoryItemA11yLabelDesktop;case 223:return CommentPaneStrings.DraftCardA11yLabelDesktop;case 225:return CommentPaneStrings.LoadingCardA11yLabelDesktop;case 216:return CommentPaneStrings.CardA11yLabelDesktopUnassignedTask;case 217:return CommentPaneStrings.CardA11yLabelDesktopUnassignedCompletedTask;case 219:return CommentPaneStrings.CardA11yLabelDesktopOneReplyModifier;case 221:return CommentPaneStrings.CardA11yLabelDesktopLoadingModifier;case 222:return CommentPaneStrings.CardA11yLabelDesktopDraftModifier;case 226:return CommentPaneStrings.A11yLabelSubstringDelimiterDesktop;case 224:return CommentPaneStrings.DraftCardA11yLabelDesktopHintText;case 209:return CommentPaneStrings.NewPostA11yLabelDesktop;case 208:return CommentPaneStrings.PostA11yLabelDesktop;case 210:return CommentPaneStrings.PendingPostA11yLabelDesktop;case 214:return CommentPaneStrings.CardA11yLabelDesktopAssignedTask;case 215:return CommentPaneStrings.CardA11yLabelDesktopAssignedCompletedTask;case 211:return CommentPaneStrings.CardA11yLabelDesktopBaseThread;case 212:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadWithTask;case 213:return CommentPaneStrings.CardA11yLabelDesktopBaseThreadResolved;case 218:return CommentPaneStrings.CardA11yLabelDesktopAnchorHintModifier;case 220:return CommentPaneStrings.CardA11yLabelDesktopMultipleRepliesModifier;case 239:return CommentPaneStrings.CommentLikePluralA11yLabel;case 240:return CommentPaneStrings.CommentLikeDescriptionA11yLabel;case 233:return CommentPaneStrings.CtrlEnterHint;default:return}},e.prototype.getStringWithStandardPlaceholders=function(e){return this.getString(e)},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(e){return this.getStringOrUndefined(e)},e.prototype.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.toFormattedString(this.getString(e),t)},e.prototype.toFormattedString=function(e,t){for(var n="",r=0;;){var a=e.indexOf("{",r),i=e.indexOf("}",r);if(a<0&&i<0){n+=e.slice(r);break}if(i>0&&(i<a||a<0))n+=e.slice(r,i+1),r=i+2;else if(n+=e.slice(r,a),r=a+1,"{"!==e.charAt(r)){if(i<0)break;var s=e.substring(r,i),c=s.indexOf(":"),d=t[parseInt(c<0?s:s.substring(0,c),10)];null==d&&(Object(o.i)().assertConditionTag(!1,"Incorrect substitution provided to string",562937946),d=""),n+=d,r=i+1}else n+="{",r++}return n},e}();n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var c=void 0;function d(){if(!c)throw new a.a(i.g,r.d.reserveTag(589103748),-2130957552);return c}function u(e){return Object(o.i)().assertConditionTag(void 0===c,"LocalizationAPI has already been initialized",589103749),void 0===c&&(c=new s(e)),c}},77:function(e,t,n){"use strict";n(7),n(5),n(23);function r(e){return"_"+e.renderContextType+"_"+e.id}function o(e){return"cardEditor"+r(e)}function a(e){return"postEditor"+r(e)}function i(e){return"editorRoot_"+e}function s(e){return"postRoot"+r(e)}function c(e,t){return t?"draftCardRoot"+r(e):"cardRoot"+r(e)}function d(){return"GhostCard"}function u(e){return"replyBoxDescription"+r(e)}function l(e){return"editorBoxDescription"+r(e)}function m(e){return"sendReplyButton"+r(e)}function f(e){return"cancelReplyButton"+r(e)}function p(e){return"cardContextMenu"+r(e)}function C(e){return"postContextMenu"+r(e)}function g(e){return"renderableItemList"+r(e)}function h(e,t){return"actionBarButton_"+t+r(e)}function b(e){return"editorFocusContainer_"+e}function v(e){return"draftCancelButton"+r(e)}function y(e){return"innerReplyBoxContainer"+r(e)}function T(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function O(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function I(e){return"viewMoreReply"+r(e)}function S(e){return"postTimeStamp"+r(e)}function _(e,t){return""+t.replace(/\s/g,"")+r(e)}function D(e,t){return""+t.replace(/\s/g,"")+r(e)}function E(e){return"anchorHintText"+r(e)}function j(e){return"lowFidelityWarning"+r(e)}function P(){return"CommentsListScrollView"}function x(){return"CommentsList"}function A(){return"EmptyCreatedCommentLie"}function k(){return"NewCommentButton"}function R(e){return"taskAssignerCheckbox"+r(e)}function w(e){return"cardTaskFooterPickerButton"+r(e)}function N(e){return"cardTaskTopperCheckbox"+r(e)}function M(e){return"cardTaskTopperDiv"+r(e)}function F(e){return"taskAssignerDiv"+r(e)}function L(){return"TaskChevronIcon"}function V(e){return"postWarning"+r(e)}function B(e){return"draftWarning"+r(e)}function H(e){return"postingTip"+r(e)+";"}function U(e){return"truncationOverlay"+e}function G(){return"next-thread-button"}function W(){return"previous-thread-button"}function q(e){return"loadingPlaceholder"+r(e)}function z(e){return"DiscreteHostedCommentRoot"+r(e)}function Y(e){return"CommentLikeButton"+r(e)}function K(){return"ReopenThread"}function X(){return"suggestion-list"}function J(){return"lppSuggestionListId"}function Q(e){return"smartReplyHeader_"+e}function Z(e){return"likeButtonDescription_"+e}function $(e){return"likeButtonUserList_"+e}function ee(e,t){return e+"_"+t}n.d(t,"e",(function(){return o})),n.d(t,"G",(function(){return a})),n.d(t,"w",(function(){return i})),n.d(t,"I",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"z",(function(){return d})),n.d(t,"Q",(function(){return u})),n.d(t,"u",(function(){return l})),n.d(t,"R",(function(){return m})),n.d(t,"P",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"H",(function(){return C})),n.d(t,"N",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"v",(function(){return b})),n.d(t,"s",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"y",(function(){return T})),n.d(t,"k",(function(){return O})),n.d(t,"Y",(function(){return I})),n.d(t,"J",(function(){return S})),n.d(t,"q",(function(){return _})),n.d(t,"c",(function(){return D})),n.d(t,"b",(function(){return E})),n.d(t,"C",(function(){return j})),n.d(t,"o",(function(){return P})),n.d(t,"p",(function(){return x})),n.d(t,"x",(function(){return A})),n.d(t,"D",(function(){return k})),n.d(t,"T",(function(){return R})),n.d(t,"V",(function(){return w})),n.d(t,"i",(function(){return N})),n.d(t,"j",(function(){return M})),n.d(t,"U",(function(){return F})),n.d(t,"W",(function(){return L})),n.d(t,"K",(function(){return V})),n.d(t,"t",(function(){return B})),n.d(t,"L",(function(){return H})),n.d(t,"X",(function(){return U})),n.d(t,"E",(function(){return G})),n.d(t,"M",(function(){return W})),n.d(t,"f",(function(){return q})),n.d(t,"r",(function(){return z})),n.d(t,"m",(function(){return Y})),n.d(t,"O",(function(){return K})),n.d(t,"F",(function(){return X})),n.d(t,"A",(function(){return J})),n.d(t,"S",(function(){return Q})),n.d(t,"B",(function(){return Z})),n.d(t,"n",(function(){return $})),n.d(t,"l",(function(){return ee}))},79:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,o=n(7),a=n(69),i=n(51);function s(){if(!r)try{r=Object(a.a)()}catch(e){throw new i.a("FeatureGateAPI not initialized",o.d.reserveTag(589103629),-2130957531)}return r}},819:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var r,o=n(1),a=n(7),i=n(1013),s=n(5),c=n(28),d=n(399),u=n(87),l=n(16),m=n(46),f=n(231),p=n(23);function C(e,t,n){for(var r,o,a=new d.a(t,-1);!(o=a.next()).done;){var i=o.value.commentId,s=n[i];if((null==s?void 0:s.alternateId)===e||i===e)break}return null===(r=o.value)||void 0===r?void 0:r.commentId}function g(e,t,n,c,d,l){var m,f;if(c&&l===e)return{thread:[c.newComment],isDraftThread:!0,draftThreadState:d};Object(s.i)().assertConditionTag(!d||!d.isInCurrentContext||"CREATE"!==d.commentDraft.sessionConfiguration.sessionType,"Bad Store State, missing lie for new draft requested.",579372370);var p=n||e,C=t.filter((function(e){return Object(u.b)(e)===p}));return C.length>0&&void 0===Object(u.a)(C[0])&&(null===(f=(m=Object(s.i)()).logDiagnosticTrace)||void 0===f||f.call(m,Object(i.a)(r||(r=Object(o.__makeTemplateObject)(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),a.d.reserveTag(540575834),s.h.Info,s.c.ProductServiceUsage,Object(s.j)(s.g.ReviewedAsNotNecessary)),C=[]),{thread:C,isDraftThread:!1,draftThreadState:void 0}}function h(e,t,n,r,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===p.a.None||t.draftThreadState.renderContextType===r?c.a.Enabled_ForcePrimary:c.a.Disabled;if(t.isDraftThread||t.thread.length>0)return o===f.a.InCard||o===f.a.InChildPost?c.a.Enabled_ForcePrimary:c.a.Enabled_Default;if(Object(m.k)(n))return c.a.Disabled;var a=Object(l.J)(n);return a&&a.threadId===e?c.a.Disabled:c.a.Invalid}},869:function(e,t,n){"use strict";var r;!function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"}(r||(r={})),t.a=r},87:function(e,t,n){"use strict";function r(e){return""===e.parentId?e:void 0}function o(e){return e.parentId||e.commentId}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},88:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(r||(r={}));var o,a=n(388),i=n(1027);!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"}(o||(o={})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return o}))},908:function(e,t,n){var r=n(1532),o=n(1537);e.exports=n(638)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},909:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},910:function(e,t,n){var r=n(373),o=n(546),a=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(1540)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},911:function(e,t,n){var r=n(1092);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},912:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},913:function(e,t,n){var r=n(1095)("unscopables"),o=Array.prototype;null==o[r]&&n(908)(o,r,{}),e.exports=function(e){o[r][e]=!0}},96:function(e,t,n){"use strict";function r(){return"web"}n.d(t,"a",(function(){return r}))},97:function(e,t,n){"use strict";function r(e){return void 0!==e.numberOfComments&&void 0!==e.numberOfThreads}function o(e){return void 0!==e.comments||void 0!==e.threads}function a(e){return void 0!==e.threads&&void 0===e.comments}var i;function s(e){return void 0!==e.comments||void 0!==e.commentIds}function c(e){return void 0!==e.commentIds}function d(e){return void 0!==e.changes}function u(e){return void 0!==e.commentId}function l(e){return void 0!==e.commentId}function m(e){return void 0!==e.contextDetails}function f(e){return void 0!==e.capabilities}function p(e){return void 0!==e.modelCapabilityFlags}function C(e){return void 0!==e.errorType}function g(e){return void 0!==e.draftId}function h(e){return void 0!==e.draftId}function b(e){return void 0!==e.commentId&&void 0!==e.smartReplies}n.d(t,"b",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"p",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"l",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return C})),n.d(t,"m",(function(){return g})),n.d(t,"o",(function(){return h})),n.d(t,"n",(function(){return b})),function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"}(i||(i={}))},975:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"}(r||(r={}))}},[[1790,2,0,1]]]);
//# sourceMappingURL=sharedComments.min.js.map