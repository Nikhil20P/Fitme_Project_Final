(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1012:function(D,F,b){function a(m,r,t,k,u,w,v,A,y,x,z,J,B,C){B=void 0===B?!1:B;C=void 0===C?null:C;m=c.call(this,m,u.DisplayName,t,w,v?2:0,x,k,r,A,z)||this;m.m6e=!1;m.gge=null;m.zdf=u;m.Aei=y;m.Hei=J;m.Iei=B;m.Tei=C;return m}b.d(F,"a",function(){return a});D=b(0);var d=b(194);b=b(881);var c=b.a;Cm(a,c);a.lYg=function(m,r,t,k){m=new a(d.a.create().toString(),null,null,null,m,r,!1,!1,!1,t,!1,!0);m.Aac(1,k);return m};a.mYg=
function(m,r,t,k,u){m=new a(d.a.create().toString(),k,null,null,m,r,!1,!1,!1,t,!1,!0);m.Aac(1,u);return m};Jl.Object.defineProperties(a.prototype,{commentBody:{configurable:!0,enumerable:!0,get:function(){return this.text&&0<this.text.length?this.text[0]:""},set:function(m){this.text[0]=m}},authorIdentity:{configurable:!0,enumerable:!0,get:function(){return this.zdf.UserId}},IRc:{configurable:!0,enumerable:!0,get:function(){return this.zdf.Provider}},mhe:{configurable:!0,enumerable:!0,get:function(){return this.anchor?
this.anchor.toString():""}},L0h:{configurable:!0,enumerable:!0,get:function(){return this.Aei}},isCurrentUser:{configurable:!0,enumerable:!0,get:function(){return this.Hei}},P6h:{configurable:!0,enumerable:!0,get:function(){return this.Iei}},Znj:{configurable:!0,enumerable:!0,get:function(){return this.Tei}}});Object(D.a)(a,"ExcelThreadedComment",b.a,[624])},1125:function(D,F,b){function a(){}b.d(F,"a",function(){return a});D=b(0);a.znb="CommentPaneTextbox";a.Sre="CommentDeleteButton";a.Zre="CommentSaveButton";
a.Yre="CommentReplyButton";a.Rre="CommentCancelButton";a.aXc="CommentTextEntry";a.INg="TaskPaneClose";a.ENg="CommentPaneCloseButton";a.ZWc="CommentTabHelp";Object(D.a)(a,"CommentManagerConstants",null,[])},1278:function(D,F,b){function a(B){this.yea=this.gy=this.Cz=null;this.zeb=0;this.lBa=this.Ez=this.hc=null;this.n9d=!1;this.SAc=null;this.kYc=!0;this.Oa=B;this.Rg()}b.d(F,"a",function(){return a});D=b(0);var d=b(37),c=b(1279),m=b(275),r=b(5),t=b(185),k=b(369),u=b(985),w=b(589),v=b(579),A=b(986),
y=b(183),x=b(128),z=b(111),J=b(29);a.prototype.dispose=function(){this.Cz&&(this.Cz.dispose(),this.Cz=null);this.gy&&(this.gy.dispose(),this.gy=null);this.yea&&(this.yea.dispose(),this.yea=null)};a.prototype.selectComment=function(B,C){C=void 0===C?1:C;var H=this.gy.Bs(B);!H||2===this.mode&&1!==H.commentType||(this.gy.selectComment(H),this.yea.highlightComment(H,!0),this.Cz.selectComment(H,C),1===C&&this.sharedCommentsEnabled&&this.Ez.selectComment(B))};a.prototype.qN=function(){var B=this.gy.qN();
B&&(this.yea.highlightComment(B,!0),this.Cz.selectComment(B),this.sharedCommentsEnabled&&this.Ez.selectComment(B.id))};a.prototype.jR=function(){var B=this.gy.jR();B&&(this.yea.highlightComment(B,!0),this.Cz.selectComment(B),this.sharedCommentsEnabled&&this.Ez.selectComment(B.id))};a.prototype.FLf=function(B){B?this.selectComment(B,0):this.Cz.Mqd&&this.oJ().mf.ql(this.Cz.Mqd)};a.prototype.ru=function(){this.gy.ru();this.sharedCommentsEnabled&&this.Ez.selectComment(null)};a.prototype.paneClosing=function(){this.l3g||
(2===this.zeb?(this.ru(),this.deleteComment(this.gy.Jr)):this.ru())};a.prototype.gkb=function(B){if(1===this.mode){c.a.GVg(B);B=CommonUIStrings.l_NewCommentError;var C=new x.StandardDialog;C.lc=0;C.hza(CommonUIStrings.l_DefaultDialogTitle,B,null)}};a.prototype.addComment=function(B){this.mode&&(this.gy.hog(B),this.Cz.uGf(B),B.commentType&&!this.xki&&this.selectComment(B.id),this.Oa.processAction(J.a.Vre,2))};a.prototype.editComment=function(B,C){1===this.mode&&B&&(this.gy.W1c(B,C),this.Cz.pGf(B),
this.selectComment(B.id))};a.prototype.THg=function(B){this.gy.fUc();this.Cz.pGf(B)};a.prototype.addReply=function(B,C){1===this.mode&&(B=this.gy.NRg(B,C),this.Cz.uGf(B),this.selectComment(B.id,0),this.Oa.processAction(J.a.commentReply,2))};a.prototype.deleteComment=function(B){if(1!==this.mode)if(2===this.mode){if(1!==B.commentType)return;this.mode=1}else return;this.WSf&&1!==B.commentType?(this.lBa=B,B=new x.StandardDialog,B.lc=4,B.$la(2),B.QTf(CommonUIStrings.l_DefaultDialogTitle,this.O0g,Object(d.a)(this,
this.S0g,"deleteDialogHandler"))):this.R1b(B)};a.prototype.Rg=function(){var B=this;this.Oa.Jf(J.a.xNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.Jf(J.a.yNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.Jf(J.a.zNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.$b(J.a.VWc,z.a.frame,t.ActionManager.Wf);this.Oa.$b(J.a.commentDelete,z.a.frame,t.ActionManager.Wf);this.Oa.$b(J.a.Tre,z.a.frame,t.ActionManager.Wf);this.Oa.Jf(J.a.BNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.Jf(J.a.CNg,z.a.frame,t.ActionManager.Wf,64);
this.Oa.$b(J.a.Vre,z.a.frame,t.ActionManager.Wf);this.Oa.$b(J.a.Wre,z.a.frame,t.ActionManager.Wf);this.Oa.$b(J.a.commentReply,z.a.frame,t.ActionManager.Wf);this.Oa.Jf(J.a.FNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.Jf(J.a.HNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.Jf(J.a.GNg,z.a.frame,t.ActionManager.Wf,64);this.Oa.$b(J.a.ase,z.a.frame,t.ActionManager.Wf);this.Oa.$b(J.a.f6a,z.a.frame,function(){B.f6a();return 32})};a.prototype.S0g=function(B){1===B?this.R1b(this.lBa):(this.lBa&&this.selectComment(this.lBa.id),
this.lBa=null)};a.prototype.R1b=function(B){var C=B.Hj;1===B.commentType?this.Oa.processAction(J.a.VWc,2):this.Oa.processAction(J.a.commentDelete,2);this.lBa=null;this.sharedCommentsEnabled||this.ru();B=this.gy.deleteComment(B);this.Cz.fBd(B);for(var H=0;H<B.length;H++)B[H].dispose();this.FLf(C)};a.prototype.aZb=function(B,C){this.mode&&(this.Oa.processAction(C?J.a.Tre:J.a.ase,2),this.gy.aZb(B,C))};a.prototype.AFa=function(B){this.gy.AFa(B);this.mode=1;this.Oa.processAction(J.a.Wre,2)};a.prototype.zFa=
function(B){this.gy.zFa(B);this.mode=1};a.prototype.eXc=function(B,C){this.gy.POi(B,C)};a.prototype.z6=function(B,C,H,W,S){return this.Cz.z6(B,C,H,W,S)};a.prototype.pbb=function(B,C,H,W,S){return this.Cz.pbb(B,C,H,W,S)};a.prototype.oJ=function(){var B=this,C=this.hc.tJ(m.AFrame.Ho);if(!C){var H=this.hc.Wh(m.AFrame.Ho);C=new k.DOMFocusListing(function(){return B.Wg.Lr});C.fOa=!0;C.xn(3);C.xn(2);C.xn(4);C.xn(1);C.xn(6);C.xn(5);this.hc.uga(function(){return B.Wg.Lr},H,C);C=this.hc.tJ(m.AFrame.Ho);C.bEb();
C.eV=!0;C.IFa=!0;H.Kk(this.hc.j1);H.Kk(this.hc.k1)}return C};a.prototype.f6a=function(){var B=this;y.UISurfaces.eM().then(function(C){var H=Object.assign(new u.a,{target:'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new A.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});H=C.callout(H);var W=Object.assign(new v.a,{expirationOptions:Object.assign(new w.a,{displayTimeoutSeconds:10,onExpire:Object(d.a)(B,
B.dismiss,"dismiss")})});B.SAc=C.addNotification(H,W)})};a.prototype.dismiss=function(){var B=this;y.UISurfaces.eM().then(function(C){C.removeNotification(B.SAc);return B.SAc=null})};Jl.Object.defineProperties(a.prototype,{Wg:{configurable:!0,enumerable:!0,get:function(){return this.Cz}},model:{configurable:!0,enumerable:!0,get:function(){return this.gy}},l_g:{configurable:!0,enumerable:!0,get:function(){return r.AFrameworkApplication.iRf}},fpj:{configurable:!0,enumerable:!0,get:function(){return r.AFrameworkApplication.$Id}},
O0g:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DeleteCommentConfirm}},fXf:{configurable:!0,enumerable:!0,get:function(){return!1}},l3g:{configurable:!0,enumerable:!0,get:function(){return!1}},xki:{configurable:!0,enumerable:!0,get:function(){return!1}},mqb:{configurable:!0,enumerable:!0,get:function(){return this.Ez},set:function(B){this.Ez=B}},mode:{configurable:!0,enumerable:!0,get:function(){return this.zeb},set:function(B){B!==this.zeb&&(this.zeb=B,-1!==this.zeb&&(this.Cz.O5a(),
this.gy.O5a()))}},sharedCommentsEnabled:{configurable:!0,enumerable:!0,get:function(){return this.n9d},set:function(B){this.n9d=B}},uSi:{configurable:!0,enumerable:!0,get:function(){return!1}},WSf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Jl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Pa||(a.factory?a.Pa=a.factory():null)},set:function(B){a.Pa=B}}});a.Pa=null;a.factory=null;Object(D.a)(a,"CommentManager",null,[672,673,7])},1279:function(D,
F,b){function a(){this.ff=null;this.Mi=[];this._changes=[];this.mO=this.jfa=this.sl=null}b.d(F,"a",function(){return a});D=b(0);var d=b(5),c=b(679);a.prototype.initialize=function(m){this.ff=m};a.prototype.dispose=function(){for(var m=this.Mi.length,r=0;r<m;r++)this.Mi[r].dispose();this.Mi=[]};a.prototype.O5a=function(){this.sl&&this.sl.O5a();this.jfa&&this.jfa.O5a()};a.prototype.selectComment=function(m){this.ru();m.$Oa=1;this.sl=m;if(m.Hj)for(var r=Array.indexOf(this.Mi,m)-1;0<=r;r--){var t=this.Mi[r];
if(t.id===m.Hj){t.$Oa=2;this.jfa=t;break}}d.AFrameworkApplication.za&&d.AFrameworkApplication.za.Za.sC&&c.ShyRibbon.iT(1,0)};a.prototype.qN=function(){if(!this.Mi.length)return null;var m=this.sl?this.Zrb(this.sl,!0):this.Mi[0];this.selectComment(m);return m};a.prototype.jR=function(){if(!this.Mi.length)return null;var m=this.sl?this.l7b(this.sl,!0):this.Mi[this.Mi.length-1];this.selectComment(m);return m};a.prototype.ru=function(){this.sl&&(this.sl.$Oa=0,this.sl=null);this.jfa&&(this.jfa.$Oa=0,this.jfa=
null)};a.prototype.W1c=function(m,r){this.ff.mode=3;m.commentType=2;m.OFb=0;m.Br=r;this.mO=m};a.prototype.fUc=function(){this.mO=null;this.ff.mode=1};a.prototype.NRg=function(m,r){var t=this.Bs(m);this.ff.mode=2;this.mO=m=b(977).Comment.j0b(d.AFrameworkApplication.userName,m,t.jtb,r);for(r=this.Mi.length-1;0<=r;r--)if(t=this.Mi[r],t.Hj===m.Hj||t.id===m.Hj){Array.insert(this.Mi,r+1,m);break}return m};a.prototype.AFa=function(m){this.ese(m,2)};a.prototype.zFa=function(m){this.ese(m,4)};a.prototype.deleteComment=
function(m){for(var r=[],t=Array.indexOf(this.Mi,m);t<this.Mi.length;){var k=this.Mi[t];if(k.id===m.id||k.Hj===m.id)Array.removeAt(this.Mi,t),Array.add(r,k);else break}this.IDb(r,3);-1<Array.indexOf(r,this.mO)&&(this.mO=null,this.ff.mode=1);return r};a.prototype.aZb=function(m,r){for(var t=[],k=Array.indexOf(this.Mi,m);k<this.Mi.length;){var u=this.Mi[k];if(u.id===m.id||u.Hj===m.id)u.done=r,Array.add(t,u),k++;else break}this.IDb(t,r?0:1)};a.prototype.Hrb=function(){return Array.clone(this.Mi)};a.prototype.wcd=
function(){return!!this.Mi&&!!this.Mi.length};a.prototype.Bs=function(m){for(var r=0;r<this.Mi.length;r++){var t=this.Mi[r];if(t.id===m)return t}return null};a.prototype.Zrb=function(m,r){m=Array.indexOf(this.Mi,m);return m===this.Mi.length-1?r?this.Mi[0]:null:this.Mi[m+1]};a.prototype.l7b=function(m,r){return(m=Array.indexOf(this.Mi,m))?this.Mi[m-1]:r?this.Mi[this.Mi.length-1]:null};a.prototype.ese=function(m,r){var t=[];m.commentType=0;Array.add(t,m);this.IDb(t,r);this.mO=null};a.GVg=function(m){return b(977).Comment.j0b(d.AFrameworkApplication.userName,
null,b(977).Comment.wDi,m)};Jl.Object.defineProperties(a.prototype,{Hya:{configurable:!0,enumerable:!0,get:function(){return this.sl}},Jr:{configurable:!0,enumerable:!0,get:function(){return this.mO}}});Object(D.a)(a,"CommentModel",null,[7,762])},1378:function(D,F,b){function a(Ha){var ca=nb.call(this)||this;ca.oi=null;ca.Wg=null;ca.$=Ha;ca.fc();return ca}function d(Ha,ca,Ra){Ha=ib.call(this,Ha)||this;Ha.nwb=!1;Ha.M8e=!1;Ha.jr=0;Ha.Ava=!1;Ha.KBa=null;Ha.$=ca;Ha.taskPaneManager=Ra;ba.a(ca).$g(Ha);
Ha.$.yn(Object(X.a)(Ha,Ha.Yd,"onWorkbookClosing"));Y.a.Sd(Ha.$)&&(Ha.isVisible=!1);return Ha}function c(){this.type="SharedCommentsTaskPaneProps";this.focusCallback=null}function m(){}function r(Ha){Ha=P.call(this,Ha)||this;Ha.oY=null;Ha.Rd();return Ha}function t(Ha,ca,Ra){this.excelCommentManager=Ha;this.commentTaskPane=ca;this.$=Ra}b.r(F);D=b(514);F=b(881);var k=b(977),u=b(1012),w=b(907),v=b(0),A=b(210),y=b(800),x=b(15),z=b(5),J=b(679),B=b(372),C=b(172),H=b(20),W=b(50),S=b(29),N=b(52);t.prototype.dispose=
function(){this.commentTaskPane=this.excelCommentManager=null};t.prototype.$c=function(Ha,ca){Ha=!0;switch(ca){case 467845448:case -1667294294:case -189526492:case -1213022552:Ha=this.excelCommentManager.isCommentOperationEnabled(t.$Oe(ca));break;case 557817481:Ha=this.excelCommentManager.mZg&&w.a.qt(this.$);break;case 2041505397:Ha=!this.excelCommentManager.hasCommentAtActiveCell&&w.a.qt(this.$);break;case -560890829:Ha=!this.excelCommentManager.hasCommentAtActiveCell;break;case -865270283:Ha=!!this.excelCommentManager.Jl&&
this.excelCommentManager.Jl.dZe;break;case 1627476102:Ha=this.excelCommentManager.Jl.mC;break;case -1565161385:Ha=this.excelCommentManager.Jl.mC&&w.a.qt(this.$)}return!Ha};t.prototype.executeCommand=function(Ha,ca){var Ra=!1;Ha=new A.a;Ha.add(557817481);Ha.add(2041505397);Ha.add(-560890829);Ha.add(-865270283);Ha.add(634192287);Ha.add(2023967433);Ha.add(1627476102);Ha.add(-2078523262);Ha.add(-1565161385);var ua=ca.command;switch(ua){case -1460047381:this.$.workbookContext.NavigationContentFound||(Ra=
B.a.yI.notificationBar.Pra(CommonUIStrings.l_CommentDeepLinkingCommentNotExists,!1),Ra.image=0,B.a.yI.notificationBar.CI(Ra));(Ra=H.g(this.$).Cc(null))?(this.excelCommentManager.upc(Ra.range),this.$.workbookContext.NavigationContentFound&&this.excelCommentManager.Ufj()):(x.ULS.sendTraceTag(594043928,12,50,"Deep linking to the comments pane since the target cell was not found"),this.z6(ca,!0,this.$.workbookContext.NavigationContentFound));Ra=!0;break;case 600686207:case 999391620:this.z6(ca,!1,!1);
Ra=!0;break;case -1667294294:Ra=this.excelCommentManager.KWf(t.$Oe(ua),ca);break;case 467845448:this.excelCommentManager.P0g(ca);Ra=!0;break;case -189526492:this.excelCommentManager.fGb(!0);Ra=!0;break;case -1213022552:this.excelCommentManager.fGb(!1);Ra=!0;break;case 557817481:this.excelCommentManager.WJi();Ra=!0;break;case 2041505397:case -560890829:!this.excelCommentManager.Jl.mC&&w.a.qt(this.$)?this.excelCommentManager.Jl.vZc():this.excelCommentManager.Jl.mC&&this.excelCommentManager.Jl.p3b();
Ra=!0;break;case -865270283:this.excelCommentManager.Jl.x0c();Ra=!0;break;case 634192287:case 2023967433:this.excelCommentManager.Jl.Bmh(634192287===ua);Ra=!0;break;case 1627476102:this.excelCommentManager.Jl.Sgj();Ra=!0;break;case -2078523262:this.excelCommentManager.Jl.showOrHideAllNotes();Ra=!0;break;case -1565161385:this.excelCommentManager.Jl.AQg(),Ra=!0}Ha.contains(ua)&&z.AFrameworkApplication.za.Za.sC&&J.ShyRibbon.iT(1,2);return Ra?N.Task.Ua(!0):C.a(ua)};t.prototype.Jc=function(Ha,ca){switch(ca.command){case -1460047381:case 600686207:case 999391620:case -1667294294:case 467845448:case -189526492:case -1213022552:case 557817481:case 2041505397:case -560890829:case -865270283:case 634192287:case 2023967433:case 1627476102:case -2078523262:case -1565161385:Ha=
!0;break;default:Ha=!1}return Ha};t.prototype.gd=function(){return!1};t.prototype.z6=function(Ha,ca,Ra){this.Mdi(Ha,ca,Ra);this.excelCommentManager.xI.b_(S.a.pbb,null,2,null,null)};t.prototype.Mdi=function(Ha,ca,Ra){var ua={};ua.a=this.$.Ba.UserSessionId;ua.b=1===Ha.method&&!Ha.tabName;ua.c=!this.commentTaskPane.isVisible;ua.d=ca;ua.e=Ra;W.b().Se(31,ua)};t.$Oe=function(Ha){switch(Ha){case -1667294294:return 1;case 467845448:return 3;case -189526492:return 4;case -1213022552:return 5;default:return 0}};
Object(v.a)(t,"CommentPaneCommandHandler",null,[159,7]);var T=b(58),fa=b(405),Y=b(43),L=b(35),P=y.a;Cm(r,P);r.prototype.Rd=function(){var Ha=this;if(!this.oY){this.oY=T.GetServiceTaskFactory.create(this.$.ea,89,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ICommentTaskPane");var ca=T.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary"),Ra=fa.a(this.$),ua=null,ta=new A.a;ta.add(ca);ta.add(this.oY);ta.add(Ra);ua=T.GetServiceTaskFactory.Xa(this.$.ea,349,350,this.vb,
"Microsoft.Office.Excel.WebUI.Client.OAuth.IOAuthManagerWrapper");ta.add(ua);L.TaskExtensions.Da(L.TaskExtensions.Fe(ta.toArray(),this.ma),function(){var db=Ha.oY.result;Y.a.Sd(Ha.$)||Ra.result.aQ(db);Ha.Hd([new t(db.excelCommentManager,db,Ha.$)])},this.ma)}};r.la=function(Ha){Ha.ea.La(81,new r(Ha))};Object(v.a)(r,"CommentPaneCommandHandlerFactory",y.a,[]);y=b(211);var ea=b(1274),X=b(37),ja=b(227);m.fah="ewa-ctp";m.t2="CommentPane";Object(v.a)(m,"CssClassNames",null,[]);var R=b(4),ba=b(254);Object(v.a)(c,
"ExcelSharedCommentsTaskPaneProps",null,[]);var ha=b(855),oa=b(241),Sa=b(11),ma=b(1),na=b(16),xa=b(808),Oa=b(65),ib=ja.a;Cm(d,ib);d.prototype.YF=function(Ha){this.get_events().addHandler("commentTaskPaneRemoved",Ha)};d.prototype.BH=function(Ha){this.get_events().removeHandler("commentTaskPaneRemoved",Ha)};d.prototype.EB=function(Ha){this.addHandler("commentTaskPaneVilibilityChanged",Ha)};d.prototype.XC=function(Ha){this.removeHandler("commentTaskPaneVilibilityChanged",Ha)};d.prototype.Uv=function(){};
d.prototype.YB=function(){};d.prototype.ln=function(){return Y.a.Sd(this.$)?this.Ava&&!this.$.Tj:(this.Ava||!ma.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")&&1<this.taskPaneManager.mz.length)&&!this.$.Tj};d.prototype.Ep=function(){return this.Ava};d.prototype.UE=function(Ha){this.excelCommentManager.sri(Ha)};d.prototype.dispose=function(){this.$&&this.$.Xo(Object(X.a)(this,this.Yd,"onWorkbookClosing"));this.KBa=this.taskPaneManager=this.$=null;ib.prototype.dispose.call(this)};
d.prototype.Ye=function(Ha,ca){return this.excelCommentManager.setFocus(Ha,ca)};d.prototype.Lh=function(Ha){return Sa.DOMElementExtensions.jf(this.Nb,Ha)};d.prototype.vi=function(){};d.prototype.ei=function(){};d.prototype.LG=function(Ha,ca){var Ra=Sa.DOMElementExtensions.Cl(this.domElement.querySelectorAll(this.gq));return Ha.Ga.target===Ra&&Ha.Ga.shiftKey&&(Ha=Sa.DOMElementExtensions.Iy(ca.querySelectorAll(this.gq)))?(Sa.DOMElementExtensions.setFocus(Ha),!0):!1};d.prototype.Rf=function(Ha){this.Ava=
Ha;var ca=this.taskPaneManager;if(Y.a.Sd(this.$))Ha?ca.QQ("CommentTaskPane",this.GK):ca.hideTaskPane("CommentTaskPane");else{var Ra=Sa.DOMElementExtensions.isVisible(ca.gD),ua=1===ca.mz.length&&!!ca.Dg&&ca.Dg.taskPane===this;Ha&&!Ra?(ca.$o(),x.ULS.sendTraceTag(35418885,12,50,"Comment pane opened.")):!Ha&&ua?(ca.$o(),this.raiseEvent("commentTaskPaneVilibilityChanged")):this.isVisible=Ha;Ha&&0<ca.mz.length&&(!ca.Dg||7!==ca.Dg.taskPane.xg||ca.isCollapsed)&&ca.$C(this,!0);this.$.If()}};d.prototype.Yd=
function(Ha,ca){ca.Yg||(this.excelCommentManager.endCommentSession(!0),this.excelCommentManager.EYa())};d.hzg=function(Ha,ca){var Ra=null;Ha.Zb&&(Ra=Ha.Zb.yi("ComponentAttach","AttachCommentTaskPane"),Ra.start());var ua=Ha.Mb,ta=document.getElementById(ua+R.a.$Wc);ta||(ta=d.wDg(Ha),Y.a.Sd(Ha)||(ua=document.getElementById(ua+R.a.HQ),void 0!==ua&&null!==ua?ua.appendChild(ta):x.ULS.sendTraceTag(545124618,0,10,"CommentTaskPane.AttachCommentTaskPane: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",
Ha.rE)));ua=Ha.ea;ca=ua.Ea(52,void 0)||ua.La(52,new d(ta,Ha,ca));ca.excelCommentManager||(ta=H.g(Ha),ca.KBa=ha.ExcelCommentManager.la(Ha,ta,ta.ga,ca,Ha.fa));Ra&&Ra.stop();return ca};d.wDg=function(Ha){return xa.a("div",Ha.Mb+R.a.$Wc,m.fah)};Jl.Object.defineProperties(d.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Y.a.Sd(this.$)?this.M8e:Object(Oa.a)(d.prototype,this,"isVisible")},set:function(Ha){if(Y.a.Sd(this.$))this.M8e=Ha,this.nwb&&this.raiseEvent("commentTaskPaneVilibilityChanged");
else{var ca=Object(Oa.a)(d.prototype,this,"isVisible");Object(Oa.b)(d.prototype,this,"isVisible",Ha);ca!==Ha&&this.raiseEvent("commentTaskPaneVilibilityChanged")}}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},he:{configurable:!0,enumerable:!0,get:function(){return oa.a.JNg}},xg:{configurable:!0,enumerable:!0,get:function(){return 7}},Rj:{configurable:!0,enumerable:!0,get:function(){return"ewanov_comments"}},oC:{configurable:!0,enumerable:!0,get:function(){return na.a.instance.da(1003)}},
titleText:{configurable:!0,enumerable:!0,get:function(){return na.a.instance.da(1003)}},Il:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.FK.offsetHeight}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){return this.KBa}},gq:{configurable:!0,enumerable:!0,
get:function(){return Sa.DOMElementExtensions.gq+",div[tabindex]"}},Z$h:{configurable:!0,enumerable:!0,get:function(){var Ha=this;return this.taskPaneManager.Ata(this.Nb,this.titleText,this.Il,this.isResizable,function(){Ha.nwb=!0;Ha.isVisible=!0},function(){Ha.isVisible=!1;Ha.nwb=!1},function(){Ha.isVisible=!0},function(){Ha.isVisible=!1},this.Il)}},GK:{configurable:!0,enumerable:!0,get:function(){var Ha=this;return Y.a.o8e(this.$)?Object.assign(new ea.a,{title:this.titleText,width:this.Il,hideHeader:!1,
location:2,contentProps:Object.assign(new c,{focusCallback:function(){Ha.raiseEvent("commentTaskPaneVilibilityChanged")}}),enableResize:this.isResizable,onOpen:function(){Ha.nwb=!0;Ha.isVisible=!0},onClose:function(){Ha.isVisible=!1;Ha.nwb=!1},onShow:function(){Ha.isVisible=!0},onHide:function(){Ha.isVisible=!1},minResizeWidth:this.Il}):this.Z$h}}});Object(v.a)(d,"CommentTaskPane",ja.a,[120,7,224,135]);var sb=b(48),nb=y.a;Cm(a,nb);a.prototype.Eai=function(){var Ha=T.GetServiceTaskFactory.create(this.$.ea,
203,this.ma,this.vb,"System.IDisposable"),ca=T.GetServiceTaskFactory.create(this.$.ea,155,this.ma,this.vb,"System.Dictionary");return this.$.PRf?[Ha,ca,sb.a.loadScript(45,4,this.vb,void 0,void 0,89)]:[Ha,ca]};a.prototype.create=function(){var Ha=this;L.TaskExtensions.Da(L.TaskExtensions.ts(L.TaskExtensions.Fe(this.Eai(),this.ma),function(){return Ha.FC},this.ma),function(){Ha.Jb(Ha.Wg)},this.ma,3)};a.prototype.dispose=function(){this.Wg=this.oi=this.$=null;nb.prototype.dispose.call(this)};a.la=function(Ha){Ha.ea.La(89,
new a(Ha))};Jl.Object.defineProperties(a.prototype,{FC:{configurable:!0,enumerable:!0,get:function(){var Ha=this;this.oi||(this.oi=L.TaskExtensions.Da(fa.a(this.$),function(ca){Ha.Wg=d.hzg(Ha.$,ca.result)},this.ma,3));return this.oi}}});Object(v.a)(a,"CommentTaskPaneFactory",y.a,[]);var Gb=b(12);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.CommentPane");Type.registerNamespace("_Ewa");D.a.Xi(".ewa-ctp .CommentPane{background-color:#fff;overflow:auto;z-index:991}.ewa-ctp .CommentPane p{margin:0}.ConvertCommentText{max-width:300px}");
Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.CommentsSmartReply");F.a.prototype.toString=k.Comment.prototype.toString;u.a.prototype.toString=k.Comment.prototype.toString;w.a.prototype.toString=k.Comment.prototype.toString;(function(){Gb.a.Ja(function(Ha){a.la(Ha);r.la(Ha)})})()},855:function(D,F,b){function a(qa,tb,rc,kd,Td,qe,Ne,Ja,ob){var Nb=ih.call(this,rc)||this;Nb.BUb=[Pb.a.idle,Pb.a.OOa,Pb.a.Bca];Nb.Qa=new kb.a;Nb.a1b=0;Nb.Fkd=!1;Nb.kXd=!1;Nb.lXd=!1;Nb.OFd=!1;
Nb.eKd=!1;Nb.s2=null;Nb.bSd=null;Nb.lYf=null;Nb.yyc=null;Nb.jCc=null;Nb.wx=null;Nb.vHa=null;Nb.F_b=dc.a.nil;Nb.owf=null;Nb.pwf=null;Nb.rCb=0;Nb.qCb=null;Nb.yGa=!1;Nb.LNd=null;Nb.Lx=null;Nb.correlationId=0;Nb.wb=kd;Nb.gridView=Td;Nb.ga=qe;Nb.commentTaskPane=Ne;Nb.fa=Ja;Nb.Oq=ob;Nb.DYa=qa;Nb.wii=new ja;Nb.dFj='{ "ops" : [';Nb.v9h='"ops" : [';Nb.TSg();Nb.Xub(tb);Nb.mode=kd.isEditMode?1:0;Nb.mode||Nb.DYa.classList.add("Interactive");Nb.DYa&&Nc.KeyInputManager.instance.qa(Pc.a.Rb,Nb.DYa,Object(Cb.a)(Nb,
Nb.gqf,"onPaneKeyDown"));Nb.ga.WF(Object(Cb.a)(Nb,Nb.uh,"onActiveCellChanged"));Nb.Eba=null;Nb.activeSheet=kd.Aa.sa;qa=0;for(tb=Nb.BUb.length;hf.a(Nb.wb)&&qa<tb;++qa)hf.a(Nb.wb).NP(Nb.BUb[qa]).np(Object(Cb.a)(Nb,Nb.NM,"onIdleActivityStatusChanged"));Nb.wb.Aa.Vf(Object(Cb.a)(Nb,Nb.Ii,"onActiveSheetChanged"));Nb.wb.Aa.MX(Object(Cb.a)(Nb,Nb.zC,"onSheetDeleted"));Nb.fa.BD(Object(Cb.a)(Nb,Nb.PM,"onLatestStateIdChanged"));Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:3298264_LoadOnDemandShouldResetCommentVersion")&&
Nb.fa.DO(Object(Cb.a)(Nb,Nb.rq,"onLoadOnDemandOccurred"));Nb.wb.Nk(Object(Cb.a)(Nb,Nb.sd,"onWorkbookOpened"));Nb.commentTaskPane.EB(Object(Cb.a)(Nb,Nb.Wy,"onPaneVisibilityChanged"));Nb.F3e()&&Nb.kga();Nb.Oa.$b(Ed.a.CYa,Fd.a.frame,Object(Cb.a)(Nb,Nb.CYa,"commentActivitySelected"));Nb.Oa.$b(Ed.a.UGa,Fd.a.frame,Object(Cb.a)(Nb,Nb.UGa,"doesCommentExist"));Nb.Oa.$b(Ed.a.f6a,Fd.a.frame,function(){Nb.f6a();return 32});Nb.T4e=Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5604492_FixNextOrPreviousCommentGotoBug");
return Nb}function d(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}function c(qa,tb){var rc=Sb.call(this)||this;rc.notes=new tf.a(!1);rc.$=qa;rc.gIe=tb;return rc}function m(qa,tb,rc){var kd=this;this.tCb=this.hba=this.S9d=this.R_e=this.CJb=this.ska=this.e6a=null;this.Daa=this.pCa=!1;this.M5b=new tf.a(!1);this.Cnd=this.Fnd=null;this.excelCommentManager=qa;this.gridView=Lg.g(qa.$);this.ga=this.gridView.ga;this.Lx=tb;this.behaviorsFactory=rc;this.gridView.$.Aa.rL(Object(Cb.a)(this,
this.Kwa,"onActiveSheetChanging"));this.gridView.$.Aa.fWa(Object(Cb.a)(this,this.enf,"onFreezeUnfreezePanesChanged"));this.gridView.$.Aa.Pee(Object(Cb.a)(this,this.sjf,"onActiveSheetDirectionChanged"));this.gridView.$.Aa.pPc(Object(Cb.a)(this,this.tjf,"onActiveSheetLockChanged"));this.gridView.$.yn(Object(Cb.a)(this,this.Yd,"onWorkbookClosing"));this.gridView.LX(Object(Cb.a)(this,this.Ks,"onAfterAllBlocksUpdated"));this.gridView.$.zD(Object(Cb.a)(this,this.kk,"onContentAreaResized"));this.p6d=new tf.a(!1);
$b.a(this.gridView.$,function(Td){kd.Cnd=Td.jP(Ce.a.hji,!1,!0)})}function r(qa,tb,rc,kd,Td){kd=void 0===kd?null:kd;Td=void 0===Td?!1:Td;var qe=Uf.call(this,document.createElement(qc.a.div))||this;qe.fmg=new tf.a(!1);qe.behaviorsFactory=rc;for(rc=1;4>=rc;rc++)qe.ZUh(qa,tb,kd,Td,rc);qe.khb=tb.id;return qe}function t(){this.Lcc=!1;this.dimensions=t.c0c}function k(qa,tb,rc,kd,Td,qe){kd=void 0===kd?null:kd;Td=void 0===Td?!1:Td;qe=void 0===qe?1:qe;var Ne=dh.call(this,document.createElement(qc.a.div))||
this;Ne.Lid=!1;Ne.zWe=0;Ne.Yja=null;Ne.qfc=null;Ne.gridView=Lg.g(qa);Ne.khb=tb.id;var Ja=document.createElement(qc.a.textArea);Ne.CNd=Ne.Ud.Kd(Ja);Sys.UI.DomElement.addCssClass(Ne.Bl,eg.a.aFe);Sys.UI.DomElement.addCssClass(Ja,eg.a.Ech);ve.a.qt(qa)||(Ja.readOnly=!0);Ne.Bl.tabIndex=0;Ne.Bl.appendChild(Ja);Ne.Wg=Ne.gridView.Yf(qe);Ne.Wg.mli.appendChild(Ne.Bl);Ne.Vqb=rc.$Fa(Ne.Bl,Ne.gridView,0);Ne.Vqb.Cfe(Object(Cb.a)(Ne,Ne.Pmf,"onFloatieContainerResizeRequested"));Ne.yRa(tb.text.toString());Ne.QGb(tb.anchor);
kd&&Ne.Dyj(kd);Ne.Bl.dir=qa.isChromeRtl?pc.a.rtl:pc.a.v5a;Tc.DOMElementExtensions.xo(Ne.Bl,Yg.a.tje);Ne.Bl.setAttribute(Yg.a.Fyg,uc.a.instance.da(837));Td&&Ja.setAttribute(Yg.a.Av,uc.a.instance.da(838));Ne.pQi();Ne.JAd();$b.a(Ne.gridView.$,function(ob){Ne.Yja=ob.jP(Ce.a.aZi,!1,!0)});$b.a(Ne.gridView.$,function(ob){Ne.qfc=ob.jP(Ce.a.Enh,!1,!0)});return Ne}function u(qa){var tb=Pd.call(this)||this;tb.soh=qa;return tb}function w(qa,tb,rc,kd){this.fH=null;this.OWb=!1;this.pXd=this.ox=this.NY=null;this.hgb=
!1;this.DZd=null;this.yPb=!1;this.ypb=null;this.HUd=this.fTf=!1;this.A1c=0;this.L5b=null;this.Wvd=this.dxc=!1;this.excelCommentManager=qa;this.commentTaskPane=tb;this.$=rc;this.gridView=kd;this.t9b=new Sys.UI.Bounds(0,0,0,0);this.commentTaskPane.EB(Object(Cb.a)(this,this.Wy,"onPaneVisibilityChanged"))}function v(){this.contentId=null;this.containerContentType=0}function A(){this.y=this.x=this.height=this.width=0}function y(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=
this.anchorRight=this.anchorLeft=null}function x(qa,tb){this.containerType="full-pane";this.identifier=null;this.commentTaskPane=qa;this.identifier=tb}function z(qa,tb,rc,kd,Td,qe,Ne,Ja,ob,Nb,Jc){qa=ea.call(this,qa,rc,kd,Td,qe)||this;qa.Fba=null;qa.yFa=null;qa.fRb=null;qa.k8=null;qa.Kbf=null;qa.hUd=!1;qa.usc=!1;qa.L$a=!1;qa.Xg=rc;qa.hc=Td;qa.excelCommentManager=Ne;qa.cSd=new P(Xa.AFrameworkApplication.$j,"CommentPane");qa.$=Ja;qa.$.zD(Object(Cb.a)(qa,qa.kk,"onContentAreaResized"));qa.commentTaskPane=
ob;qa.commentTaskPane.EB(Object(Cb.a)(qa,qa.Wy,"onPaneVisibilityChanged"));qa.taskManager=tb;qa.Rmg=qa.DRg();qa.Zbe=new L;qa.mqb=Nb;qa.ga=Jc;return qa}function J(qa,tb){this.ubg=qa;this.jy=tb}function B(qa,tb,rc,kd){var Td=C.call(this)||this;Td.$=qa;Td.Zvf=rc;Td.excelCommentManager=tb;Td.mqb=kd;Td.x8i();Td.HPf();return Td}function C(){this.Pn=null;this.Ddb=this.Dhg=this.rzc=this.N$d=this.bbe=this.ihb=this.K7d=!1}function H(qa,tb){this.LWd=qa;this.augmentationLoopManager=tb;return this}function W(qa){this.LWd=
qa}function S(){var qa=wf.call(this)||this;qa.CommentId=null;qa.DomainName=null;qa.ConfidenceLevel=0;qa.ResultSets=null;qa.ElapsedTime=null;qa.H_=Object.assign(new ff.a,{T_:S.getTypeName(),B_:S.ve()});return qa}function N(){var qa=Ye.call(this)||this;qa.commentId=null;qa.comment=null;qa.H_=Object.assign(new ff.a,{T_:N.getTypeName(),B_:N.ve()});return qa}function T(qa,tb){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.canvasActionId=
qa;this.canvasContextId=tb}function fa(qa,tb){this.emg=qa;this.Ez=tb}function Y(qa,tb,rc,kd){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=qa;this.appLocale=tb;this.uiCulture=rc;this.dataCulture=kd}function L(){this.$Kc=this.YTd=!1;this.jVa=this.Pn=this.b0d=this.e3d=this.Zae=this.e6d=this.P$d=this.KWd=this.xq=this.GSb=null}function P(qa,tb){qa=Hb.call(this,qa)||this;qa.qEj=tb;return qa}function ea(qa,tb,rc,kd,Td){this.qO=this.wq=this.bCa=this.ff=null;
this.aBc=this.iUd=!1;this.WTb=null;this.gUd=!1;this.lWd=this.x4d=null;this.X7=this.tBe=!1;this.k8=this.V5d=this.GIc=null;this.Oa=qa;this.Xg=tb;this.qe=rc;this.hc=kd;this.KF=Td;this.poa=Nc.KeyInputManager.El(Vd.a.kAa,0)}function X(qa,tb){this.jUb=qa;this.inputMethod=tb}function ja(){}function R(qa,tb,rc,kd,Td,qe,Ne){qa=ba.call(this,qa,tb,rc,kd,Td,qe)||this;qa.anchorHintText=null;qa.anchorHintText=Ne;return qa}function ba(qa,tb,rc,kd,Td,qe,Ne){this.date=this.author=this.commentBody=this.parentId=this.commentId=
null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=qa;this.parentId=tb;this.commentBody=rc;this.author=kd;this.date=Td;this.commentFlags=qe;this.usersByReactionType=void 0===Ne?null:Ne}function ha(){this.pef=(new oa(!0,!0,!0)).OSg()}function oa(qa,tb,rc){this.Kbg=qa;this.MVd=tb;this.zfg=void 0===rc?!1:rc}function Sa(){this.A$a=this.Pab=!1}function ma(){this.A$a=this.Pab=!1}function na(qa,tb){this.Ndg=qa;this.tfg=tb;this.A$a=this.Pab=!1}function xa(){this.c$=CommonUIStrings.l_Ellipsis}
function Oa(){Oa.BRb=null}function ib(qa,tb){this.Znb=qa;this.d6f=tb}function sb(){}function nb(qa,tb,rc,kd,Td,qe,Ne){this.kPb=qa;this.YIc=tb;this.Yea=rc;this.Bag=kd;this.Jeb=Td;this.Heb=qe;this.Ieb=Ne}function Gb(){}function Ha(){}function ca(qa){this.extensions=qa}function Ra(qa){var tb=new ua(qa.UserId,qa.Provider,qa.DisplayName,qa.Email);tb.IsCurrentUser=qa.IsCurrentUser;return tb}function ua(qa,tb,rc,kd){this.IsCurrentUser=!1;this.UserId=qa;this.Provider=void 0===tb?"":tb;this.DisplayName=void 0===
rc?"":rc;this.Email=void 0===kd?"":kd}function ta(qa,tb,rc,kd){this.id=qa;this.commentId=tb;this.currentState=rc;this.history=kd}function db(qa,tb,rc,kd,Td){this.XEc=!1;if(1!==tb.type)throw Error.argument("createRecord");this.Jeb=rc;this.Heb=kd;this.Ieb=Td;this.A4d=1;this.kPb=qa;this._state=new qb(!1,this.Jeb,[],new za,this.Ieb,this.Heb);this._history=[];this.yve(tb)}function Ta(){this.commentId=null}function qb(qa,tb,rc,kd,Td,qe){this.isLossy=qa;this.title=tb;this.assignees=rc;this.schedule=kd;this.completion=
Td;this.priority=qe}function za(){this.endDate=this.startDate=null}function Ia(qa,tb){this.sfg=new ud.a(function(){return tb.Qza(qa.value)})}function va(qa,tb,rc,kd,Td){this.priority=this.completion=-1;this.type=qa;this.user=tb;this.time=rc;this.recordId=kd;this.isLossy=void 0===Td?!1:Td}function Ua(){this.k9d=this.r$d=!1;this.xlg=[]}function Kb(qa,tb,rc,kd){var Td=Vc.call(this)||this;Td.dXd=0;Td.pHb=null;Td.oCc="";Td.excelCommentManager=qa;Td.$=tb;Td.ga=rc;Td.fa=kd;Td.YMa=0;return Td}function ia(qa,
tb,rc,kd,Td,qe){this.commentType=0;this.parentCommentId=this.commentId=this.anchor=this.content=null;this.isResolved=!1;this.commentType=qa;this.content=tb;this.anchor=rc;this.commentId=kd;this.parentCommentId=Td;this.isResolved=qe}function E(qa,tb){this.excelCommentManager=qa;this.$=tb}function fb(){}function Za(qa,tb,rc,kd,Td,qe,Ne,Ja,ob){this.Kf=qa;this.UQf=tb;this.nbj=rc;this.taskManager=kd;this.$=Td;this.Fba=qe;this.Ae=Ne;this.yFa=Ja;this.$re=void 0===ob?null:ob}function ec(qa,tb,rc,kd,Td){this.Email=
this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=qa;this.Provider=void 0===tb?"":tb;this.DisplayName=void 0===rc?"":rc;this.Email=void 0===kd?"":kd;this.IsCurrentUser=void 0===Td?!1:Td}function zc(){var qa=Ab.call(this)||this;qa.updatedDraftSessionConfiguration=null;return qa}function Ab(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}function vb(){return this}function kc(){}function td(){this.NXd=
{};this.NXd.ops=[]}function Oc(qa,tb,rc,kd){qa=id.call(this,qa)||this;qa.yA=null;qa.Kf=tb;qa.P8a=kd;qa.commentId=rc;qa.Mf=qa.mU();tb=qa.V8c();qa.$la(1);qa.Dc(1,uc.a.instance.Ya(429));qa.initializeAndShow(tb,Object(Cb.a)(qa,qa.yQg,"convertLegacyCommentDialogHandler"),null);(tb=document.getElementById("ConvertHelpLinkId"))?(qa.yA=wb.a.create(tb),qa.yA.C1(Object(Cb.a)(qa,qa.qba,"onHelpLinkClick"))):eb.ULS.sendTraceTag(38856353,0,10,"ConvertLegacyComment Dialog help link not found.");eb.ULS.sendTraceTag(25249739,
0,50,"ConvertLegacyComment Dialog opened.");return qa}function tc(){}function sc(qa,tb,rc,kd,Td,qe,Ne,Ja){Ja=qa.Ra(1,void 0===Ja?null:Ja);Ja.activeCell=tb;Ja.findNext=rc;return yb.i(qa,"FindNextOrPreviousComment",Ja,kd,Td,qe,Ne,4)}function ic(qa,tb,rc,kd,Td,qe,Ne,Ja,ob,Nb){Nb=qa.Ra(9,void 0===Nb?null:Nb);Nb.options=tb;Nb.content=rc;Nb.anchor=kd;Nb.commentId=Td;return yb.i(qa,"ApplyComment",Nb,qe,Ne,Ja,ob,0)}function Ga(qa,tb,rc,kd,Td,qe,Ne,Ja,ob,Nb,Jc){var bd={};this.Mce=(bd.CancelCommentCreateThreadAction=
Ed.a.vId,bd.CommitComment=Ed.a.wId,bd.CommitDraftAction=Ed.a.xId,bd.CommitDraftCreateAction=Ed.a.erc,bd.CommitDraftEditAction=Ed.a.frc,bd.CommitDraftReplyAction=Ed.a.drc,bd.CreateReplyAction=Ed.a.drc,bd.CreateReplyWithMentions=Ed.a.yId,bd.CreateReplyWithTaskAssigned=Ed.a.zId,bd.CreateThreadAction=Ed.a.erc,bd.CreateThreadWithMentions=Ed.a.AId,bd.CreateThreadWithTaskAssigned=Ed.a.BId,bd.DeletePostAction=Ed.a.CId,bd.DeleteThreadAction=Ed.a.DId,bd.DeleteThreadWithTask=Ed.a.EId,bd.DiscardDraftAsync=Ed.a.FId,
bd.PresentLinkToCommentAction=Ed.a.VQf,bd.ResolveThreadAction=Ed.a.JId,bd.ResolveThreadWithTask=Ed.a.KId,bd.ReopenThreadAction=Ed.a.GId,bd.ReopenThreadWithTask=Ed.a.HId,bd.RequestInitCommentSession=Ed.a.IId,bd.SelectCommentAction=Ed.a.LId,bd.UpdateCommentBodyAction=Ed.a.frc,bd);this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=qa;this.appVersion=tb;this.releaseAudience=
rc;this.releaseChannel=kd;this.sessionId=Td;this.ring=qe;this.dataCenter=Ne;this.disableUpload=Ja;this.sovereignEnvironmentName=void 0===Jc?null:Jc;this.Oa=ob;this.h6d=void 0===Nb?null:Nb;this.GWh()}function cb(){}function Tb(qa,tb){this.CommentId=qa;this.ResolveState=tb}function Bb(){}function nc(qa,tb){this.Oa=qa;this.odb=tb;this.zyc=new Gc;qa=Ml(this.odb);for(tb=qa.next();!tb.done;tb=qa.next())tb=tb.value,this.zyc.ja(tb.value.canvasActionId,tb.key),tb=tb.value,tb.withFlags?this.Oa.Jf(tb.canvasActionId,
tb.canvasContextId,Object(Cb.a)(this,this.actionHandler,"actionHandler"),97):this.Oa.$b(tb.canvasActionId,tb.canvasContextId,Object(Cb.a)(this,this.actionHandler,"actionHandler"))}function Gc(){return ae.call(this)||this}function La(){this.actionBehavior=this.actionType=0}function Wa(qa){qa=Hb.call(this,qa)||this;qa.e8d=0;return qa}function wa(){this.tasks=this.comments=null}function Da(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=
!1;this.contextDrafts=null}function Va(qa){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=qa}function Jb(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.contextDrafts=this.smartReplies=null}function Hb(qa){this.tod=
!1;this.fV=new hc.a;this.Uei=qa}function Mb(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}function Ub(qa,tb){this.type=0;this.payload=null;this.type=qa;this.payload=tb}function pb(qa){this.Gei=qa;this.Cei=[]}function gb(){}b.r(F);var Qa=b(0),eb=b(15),xb=b(1278),dc=b(194),Nc=b(120),Pc=b(13),Fd=b(111),Ea=b(1347),Xa=b(5),hc=b(210),Xb=b(404);gb.beginDraftingAsync="OSC:BDA";gb.Unh="OSC:FEQ";gb.selectComment="OSC:SC";Object(Qa.a)(gb,"CommentTaskNames",null,[]);Jl.Object.defineProperties(pb.prototype,
{handler:{configurable:!0,enumerable:!0,get:function(){return this.Gei}},aU:{configurable:!0,enumerable:!0,get:function(){return this.Cei}}});Object(Qa.a)(pb,"RegisteredListener",null,[]);Object(Qa.a)(Ub,"OfficeSharedCommentsEvent",null,[911]);Object(Qa.a)(Mb,"ViewContainerEvent",null,[911]);var Ic=b(296);Hb.prototype.XPi=function(qa){qa=new pb(qa);this.fV.add(qa)};Hb.prototype.h1f=function(qa){for(var tb=0;tb<this.fV.count;++tb)if(this.fV.oa(tb).handler===qa){this.fV.removeAt(tb);break}};Hb.prototype.y_=
function(qa){function tb(){if(Xa.AFrameworkApplication.Ng)eb.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(var kd=0;kd<rc.fV.count;++kd)for(var Td=rc.fV.oa(kd);0<Td.aU.length;){var qe=Array.dequeue(Td.aU);if(Object(Xb.a)(Mb,qe)){var Ne=Td.handler;Ne(qe)}else Object(Xb.a)(Ub,qe)&&(Ne=Td.handler,Ne(qe.type,qe.payload))}}var rc=this;(void 0===qa?0:qa)?tb():this.tod||(this.tod=!0,Ic.a.dWa(this.Uei,function(){tb();rc.tod=!1},gb.Unh))};Object(Qa.a)(Hb,
"GenericEventHost",null,[]);Object(Qa.a)(Jb,"BasicEventPayload",null,[912]);Object(Qa.a)(Va,"CommentContextDetails",null,[]);Object(Qa.a)(Da,"ContextChangeWithSelectedThreadIndex",null,[912]);Object(Qa.a)(wa,"LoadCommentsNoVirtualization",null,[912]);Cm(Wa,Hb);Wa.prototype.mQi=function(qa,tb,rc,kd,Td,qe,Ne){Ne=void 0===Ne?0:Ne;qa=new pb(qa);qe&&Array.enqueue(qa.aU,this.Iue(qe,this.e8d));qe=tb?tb.length:0;Array.enqueue(qa.aU,this.Nue(qe,rc,kd,Ne));qe&&Array.enqueue(qa.aU,this.qve(tb,Td));this.fV.add(qa);
this.y_()};Wa.prototype.l1f=function(qa){this.h1f(qa)};Wa.prototype.V3i=function(qa,tb,rc,kd,Td){this.gja(this.Nue(qa,tb,rc,void 0===kd?0:kd,void 0===Td?null:Td));this.y_()};Wa.prototype.W3i=function(qa,tb,rc,kd,Td,qe){this.gja(this.aTg(qa,tb,rc,kd,void 0===Td?0:Td,void 0===qe?null:qe));this.y_()};Wa.prototype.X3i=function(qa,tb,rc){this.gja(this.dTg(qa,tb,rc));this.y_()};Wa.prototype.q4i=function(qa,tb){this.gja(this.qve(qa,tb));this.y_()};Wa.prototype.selectComment=function(qa){this.gja(this.ewe(qa,
6));this.y_()};Wa.prototype.highlightComment=function(qa){this.gja(this.ewe(qa,7));this.y_()};Wa.prototype.Fxj=function(qa,tb){this.gja(this.NVg(qa,tb));this.y_()};Wa.prototype.Axj=function(qa){this.gja(this.Iue(qa,this.e8d));this.y_()};Wa.prototype.Jwd=function(qa,tb){this.gja(this.PXg(qa,tb));this.y_()};Wa.prototype.Iue=function(qa,tb){tb=void 0===tb?0:tb;var rc=new Jb;rc.modelCapabilityFlags=qa;rc.richTextCapabilityFlags=tb;return new Ub(12,rc)};Wa.prototype.Nue=function(qa,tb,rc,kd,Td){Td=void 0===
Td?null:Td;var qe=new Jb;qe.numberOfComments=qa;qe.numberOfThreads=tb;qe.contextDetails=Object.assign(new Va(rc),{nextPopulatedContextDetails:kd});qe.contextDrafts=Td;return new Ub(0,qe)};Wa.prototype.aTg=function(qa,tb,rc,kd,Td,qe){qe=void 0===qe?null:qe;var Ne=new Da;Ne.numberOfComments=qa;Ne.numberOfThreads=tb;Ne.selectedThreadIndex=rc;Ne.contextDetails=Object.assign(new Va(kd),{nextPopulatedContextDetails:Td});Ne.contextDrafts=qe;return new Ub(0,Ne)};Wa.prototype.dTg=function(qa,tb,rc){var kd=
new Jb;kd.comments=qa;kd.numberOfThreads=tb;kd.tasks=rc;return new Ub(2,kd)};Wa.prototype.qve=function(qa,tb){var rc=new wa;rc.comments=qa;rc.tasks=tb;return new Ub(1,rc)};Wa.prototype.ewe=function(qa,tb){var rc=new Jb;rc.commentId="";qa&&(rc.commentId=qa);return new Ub(tb,rc)};Wa.prototype.NVg=function(qa,tb){var rc=new Jb;rc.changes=[];rc.contextDetails=Object.assign(new Va(tb),{nextPopulatedContextDetails:qa});return new Ub(10,rc)};Wa.prototype.PXg=function(qa,tb){var rc=new Jb;rc.commentId=qa;
rc.smartReplies=tb;return new Ub(15,rc)};Wa.prototype.gja=function(qa){for(var tb=0;tb<this.fV.count;++tb)Array.enqueue(this.fV.oa(tb).aU,qa)};Object(Qa.a)(Wa,"OfficeSharedCommentsEventHost",Hb,[802]);var Qc=b(98),Cb=b(37);Object(Qa.a)(La,"CommentUIActionPayload",null,[]);var $c=b(249),ae=$c.ScriptSharpLegacyMap;Cm(Gc,ae);Object(Qa.a)(Gc,"UIntDictionary",$c.ScriptSharpLegacyMap,[]);nc.prototype.ZNa=function(qa,tb){this.odb.tb(qa)&&(this.odb.oa(qa).registeredCallback=tb)};nc.prototype.b_=function(qa,
tb,rc,kd,Td){return this.actionHandler(qa,tb,rc,kd,Td)};nc.prototype.actionHandler=function(qa,tb,rc,kd,Td){if(this.zyc.tb(qa)){var qe=this.zyc.oa(qa);if(!this.odb.tb(qe))return 8;var Ne=this.odb.oa(qe);if(Ne.preCallback){var Ja=Ne.preCallback(qa,tb,rc,kd,Td);if(2!==Ja)return Ja}if(!Ne.registeredCallback)return 1===rc?8:2;qe=Object.assign(new La,{actionType:qe});1===rc&&(qe.actionBehavior=1);qe=Ne.registeredCallback(qe);return Ne.postCallback?Ne.postCallback(qe,qa,tb,rc,kd,Td):qe?32:8}return 2};Object(Qa.a)(nc,
"OfficeSharedCommentsActionHost",null,[874]);var Mc=b(569);Bb.$7b=function(qa){return qa===Bb.create?0:qa===Bb.reply?1:qa===Bb.edit?2:qa===Bb.metadata?3:null};Bb.create="CREATE";Bb.reply="REPLY";Bb.edit="EDIT";Bb.metadata="METADATA";Object(Qa.a)(Bb,"CommentSessionType",null,[]);Object(Qa.a)(Tb,"CommentProperties",null,[]);var Hd=b(24),Nd=b(275),ge=b(371),Ed=b(29),Zc=b(185);Object(Qa.a)(cb,"CommentActivityData",null,[]);var he=b(145);Ga.prototype.GWh=function(){this.Oa.$b(Ed.a.vId,Fd.a.frame,Zc.ActionManager.Wf);
this.Oa.$b(Ed.a.wId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.xId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.drc,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.yId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.zId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.erc,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.AId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.BId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.CId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.DId,Fd.a.frame,Zc.ActionManager.Wf);
this.Oa.$b(Ed.a.EId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.FId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.VQf,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.JId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.KId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.GId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.HId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.IId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.LId,Fd.a.frame,Zc.ActionManager.Wf);this.Oa.$b(Ed.a.frc,Fd.a.frame,Zc.ActionManager.Wf)};
Ga.prototype.sendULSTrace=function(qa,tb,rc,kd){eb.ULS.sendTraceTag(qa,tb,rc,kd)};Ga.prototype.recordActivity=function(qa){this.Mce[qa]&&this.Oa.processAction(this.Mce[qa],2)};Ga.prototype.sendOtelEvent=function(qa){he.a.sendOtelEvent(qa)};Ga.prototype.recordPerfData=function(qa,tb){this.h6d&&(qa=Object.assign(new cb,{durationMs:tb,name:qa}),this.h6d.E8a(qa))};Object(Qa.a)(Ga,"OfficeSharedCommentsTelemetry",null,[]);var Ke=b(100),Ue=b(82),Pb=b(6),kb=b(36),yb=b(81),Ma=b(86),jd=b(368),Zd=b(140),Zb=
b(142);Jl.Object.defineProperties(tc,{JQg:{configurable:!0,enumerable:!0,get:function(){return Zd.a.jj(tc.Bte,Zb.a.Ya(427),Zb.a.da(1254))}},mQg:{configurable:!0,enumerable:!0,get:function(){return Zd.a.jj(tc.Bte,Zb.a.Ya(428),Zb.a.da(1254))}}});tc.Bte="<div class='WACDialogRowNoBreak' id='CCHeaderId'> <label id='ConvertTextContentId' class='ConvertCommentText WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='CCHeaderId'> <a id='ConvertHelpLinkId' class='ConvertHelpLink' href=\"#\" target='_self' >{1}</a> </div>";
Object(Qa.a)(tc,"ConvertLegacyCommentDialogHtml",null,[]);var wb=b(577),gc=b(9),uc=b(16),id=jd.a;Cm(Oc,id);Oc.prototype.dispose=function(){this.yA&&this.yA.jca(Object(Cb.a)(this,this.qba,"onHelpLinkClick"));Ma.a.rc([this.yA]);this.yA=null;id.prototype.dispose.call(this)};Oc.prototype.yQg=function(qa){1===qa?(eb.ULS.sendTraceTag(25249740,0,50,"ConvertLegacyCommentDialog Continue button pressed."),void 0!==this.P8a&&null!==this.P8a&&this.P8a("InitCommentSession was cancelled by LegacyConvertDialog (Convert Comments)."),
this.Kf.upgradeLegacyComments(this.commentId)):(eb.ULS.sendTraceTag(25249741,0,50,"ConvertLegacyCommentDialog Cancel button pressed."),void 0!==this.P8a&&null!==this.P8a&&this.P8a("InitCommentSession was cancelled by LegacyConvertDialog (Cancel)."))};Oc.prototype.qba=function(){gc.HelperMethods.y5(this.$.uF,"XLWAEndUser_CommentsConvertLegacy",this.$.yR)};Oc.prototype.mU=function(){return this.commentId?tc.JQg:tc.mQg};Oc.prototype.V8c=function(){return uc.a.instance.Ya(this.commentId?425:426)};Jl.Object.defineProperties(Oc.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"ConvertLegacyCommentDialog"}}});Object(Qa.a)(Oc,"ConvertLegacyCommentDialog",jd.a,[]);var Wc=b(881);td.prototype.insertHyperLink=function(qa,tb){var rc={};rc.link=tb.link;this.C9i(rc,tb);Array.add(this.NXd.ops,this.Jve(qa,rc))};td.prototype.Jve=function(qa,tb){var rc={};rc.insert=qa;rc.attributes=tb;return rc};td.prototype.C9i=function(qa,tb){this.p$a(tb.weight>=td.Rhi,qa,"weight",tb.weight);this.p$a(tb.italic,qa,"italic",!0);this.p$a(tb.underline,
qa,"underline",!0);this.p$a(tb.strikethrough,qa,"strikethrough",!0);this.p$a(!!tb.highlight,qa,"highlight",tb.highlight);this.p$a(!!tb.color,qa,"color",tb.color)};td.prototype.p$a=function(qa,tb,rc,kd){qa&&(tb[rc]=kd)};td.DPe=function(qa){return Sys.Serialization.JavaScriptSerializer.deserialize(qa,!0)};td.Rhi=700;Object(Qa.a)(td,"DeltaFormatCreator",null,[797]);kc.LEh=function(qa){if(""===qa)return"";var tb=0,rc="";try{for(var kd=td.DPe(qa),Td=Ml(kd.ops),qe=Td.next();!qe.done;qe=Td.next()){var Ne=
qe.value;if(kc.TZh(Ne))tb||(rc+=kc.Bzh(Ne.attributes.atmention.fullName)),tb+=1;else{var Ja=Ne.insert?Ne.insert:"";" "!==Ja&&0<Ja.length&&(tb=0,rc+=Ja)}}}catch(ob){eb.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return rc};kc.jwh=function(qa){qa=kc.LEh(qa);return 0<qa.length&&qa.split(" ").length<=kc.Egi?qa:null};kc.Bzh=function(qa){var tb="";qa&&(qa=qa.split(" "),0<qa.length&&(tb=qa[0]));return tb};kc.TZh=function(qa){return!!qa.attributes&&
!!qa.attributes.atmention};Jl.Object.defineProperties(kc,{Egi:{configurable:!0,enumerable:!0,get:function(){return 50}}});Object(Qa.a)(kc,"BaseCommentSmartReplyHelpers",null,[]);Cm(vb,kc);vb.A8c=function(qa,tb,rc){if(!qa)return null;qa=qa.text&&0<qa.text.length?qa.text[0]:"";tb=!tb||!tb.Hj||""===tb.Hj;return 0<qa.length&&tb&&(void 0===rc||!rc)?kc.jwh(qa):null};Object(Qa.a)(vb,"CommentSmartReplyHelpers",kc,[]);Object(Qa.a)(Ab,"InitCommentSessionResult",null,[]);Cm(zc,Ab);Object(Qa.a)(zc,"BeginDraftingHostResult",
Ab,[]);var pd=b(587);Object(Qa.a)(ec,"OfficeSharedCommentUser",null,[]);var Yd=b(88),be=b(43),me=b(92),Gd=b(1),Rd=b(95);Za.prototype.beginDraftingAsync=function(qa){var tb=this;if(!qa)return new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915327))});var rc=new zc;var kd=Bb.$7b(qa.sessionType);if(void 0===kd||null===kd)return new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915317))});var Td=this.Kf.mode;if(1!==Td)return eb.ULS.sendTraceTag(40481676,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
Td),new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915325))});!kd&&this.Kf.hasCommentAtActiveCell&&(eb.ULS.sendTraceTag(40747414,12,50,"Converting Create into Reply"),kd=this.Kf.OB,qa.sessionType=Bb.reply,qa.threadId=kd.Hj?kd.Hj:kd.id,rc.updatedSessionParams=qa,kd=1);Ke.FocusManager.instance().Ij(Nd.AFrame.Ho);switch(kd){case 0:kd=this.g0b(rc,function(){rc.insertIndex=tb.Kf.KTh(qa)});break;case 1:if(!qa.threadId||!qa.threadId.length)return new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915324))});var qe=
this.Ae.Bs(qa.threadId);if(qe&&qe.done)return new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915320))});if(this.Kf.kid(qa.threadId))return this.CHi(qa.threadId);var Ne=Gd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",!1),Ja=Ne?this.Ae.Zrb(qe,!1):null;kd=this.g0b(rc,function(){rc.insertIndex=tb.Kf.oUh(qa.threadId,qa);if(Ne&&tb.$re&&qe){var ob=vb.A8c(qe,Ja,qe.isCurrentUser);ob&&tb.$re.invoke(qa.threadId,ob)}});break;case 2:if(!qa.commentId||!qa.commentId.length)return new Promise(function(ob,
Nb){Nb(Ic.a.ys(-2130915324))});if(!this.Ae.Bs(qa.commentId))return new Promise(function(ob,Nb){Nb(Ic.a.ys(-2130915323))});kd=this.g0b(rc,function(){rc.insertIndex=tb.Kf.MTh(qa.commentId,qa)});break;case 3:eb.ULS.shipAssertTag(51230682,12,this.Kf.Dvb,"Metadata session type start without document tasks enabled.");if(this.Kf.kid(qa.threadId))throw new Oc(this.$,this.Kf,qa.threadId,null),Ic.a.ys(-2130915316);kd=this.g0b(rc,function(){rc.insertIndex=tb.Kf.ZTh(qa.threadId,qa)});break;default:return new Promise(function(ob,
Nb){Nb(Ic.a.ys(-2130915322))})}return kd};Za.prototype.commit=function(qa,tb,rc){var kd=this.Ae.Jr;if(!kd)throw eb.ULS.sendTraceTag(42321353,12,10,"VSO3351297: InvalidCommentDataState- Commiting a draft when InProgressComment is null"),Ic.a.ys(-2130915320);var Td=kd.Br;if(!Td)throw eb.ULS.sendTraceTag(42321354,12,10,"VSO3351297: InvalidCommentDataState- Commiting a draft when DraftSessionConfiguration is null"),Ic.a.ys(-2130915320);var qe=Bb.$7b(Td.sessionType);if(void 0===qe||null===qe)throw Ic.a.ys(-2130915317);
if(qa!==Td.draftId)throw Ic.a.ys(-2130915327);tb&&(tb.endsWith('\\n"}]}')?tb=tb.substring(0,tb.length-6)+'"}]}':eb.ULS.sendTraceTag(591210308,12,10,"Comment delta text is expected to end with a newline character."));kd.text=3===qe?null:[tb];rc&&rc.Task&&this.Kf.eXc(kd,rc.Task);switch(qe){case 0:this.Kf.AFa(kd);this.y_f(rc);this.x_f();break;case 1:this.Kf.AFa(kd);this.y_f(rc);this.x_f();break;case 2:this.Kf.zFa(kd);break;case 3:eb.ULS.shipAssertTag(51230683,12,!tb,"Metadata session type has comment text.");
kd.m6e=!0;this.Kf.PNg(kd,rc.Resolve);break;default:throw Ic.a.ys(-2130915322);}return kd.id};Za.prototype.endCommentSession=function(qa){var tb=this.Ae.Jr;if(tb&&tb.Br&&tb.Br.draftId!==qa)throw Ic.a.ys(-2130915327);this.Kf.endCommentSession(!1)};Za.prototype.deleteComment=function(qa){this.Kf.U0g(qa)};Za.prototype.selectComment=function(qa){var tb=this.Ae.Jr;if(!be.a.ZG()&&tb&&tb.Br){var rc=this.Ae.eU;""!==rc&&rc!==this.A1a(this.$.Aa.sa)?this.Kf.CXf(dc.a.Qra(rc)):(tb.Br.draftId===qa||tb.Br.threadId===
qa)&&this.Kf.qpc(tb.id,0)}else be.a.ZG()&&this.Kf.Ygd(qa)?this.Kf.Sji():this.Kf.qpc(qa,0)};Za.prototype.highlightComment=function(){};Za.prototype.setThreadResolvedState=function(qa,tb){if(this.Kf.kid(qa))throw new Oc(this.$,this.Kf,qa,null),Ic.a.ys(-2130915316);this.Kf.setThreadResolvedState(qa,tb)};Za.prototype.selectFirstThreadInNextCommentContext=function(){this.Kf.selectFirstThreadInNextCommentContext()};Za.prototype.selectLastThreadInPreviousCommentContext=function(){this.Kf.selectLastThreadInPreviousCommentContext()};
Za.prototype.presentLinkToComment=function(qa){var tb={SourceControlId:"LinkToComment"};tb.navId=this.Kyh(qa);qa=new me.a(869186573,2,this.$.jd,this.Kf.commentTaskPane.isVisible?12:9,null);this.$.Na.Xb(qa,tb)};Za.prototype.Kyh=function(qa){var tb=this.A1a(this.$.Aa.sa);qa=btoa("10_{"+qa+"}_"+tb);qa=qa.replace(RegExp("\\+","g"),"-");qa=qa.replace(RegExp("\\/","g"),"_");return qa=qa.replace(RegExp("\\=+$","g"),"")};Za.prototype.registerForCommentEvents=function(qa){var tb=this;this.yFa.YRe().then(function(rc){tb.UQf.mQi(qa,
tb.Kf.x8b(),tb.Kf.x$c(),!tb.Kf.mode,tb.Kf.UDh(),rc,tb.Kf.gZa)})};Za.prototype.unregisterForCommentEvents=function(qa){this.UQf.l1f(qa)};Za.prototype.registerForAction=function(qa,tb){this.nbj.ZNa(qa,tb)};Za.prototype.unregisterForAction=function(){};Za.prototype.loadThreads=function(){eb.ULS.sendTraceTag(40481677,12,10,"LoadThreads incorrectly called on unsupported platform.")};Za.prototype.checkAtMentionCapability=function(){return this.$.Acc()?new Promise(function(qa){qa(!1)}):this.Fba?this.Fba.atMentionsEnabledAsync():
(eb.ULS.sendTraceTag(36516832,12,10,"AtMentionEnabled called before initialization."),new Promise(function(qa){qa(!1)}))};Za.prototype.resolveSupported=function(){return!0};Za.prototype.DHi=function(qa){var tb=this.Ae.Jr;if(tb&&tb.Br){var rc=Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5703292_ExcelPlumbEmailThroughCG")?pd.a.DHa(tb.authorIdentity||""):"";tb=new ec(tb.authorIdentity,tb.IRc,tb.author,rc,!0);qa.author=tb}qa.authorName=Xa.AFrameworkApplication.userName;qa.authorIdentity=""};Za.prototype.g0b=
function(qa,tb){var rc=this;return new Promise(function(kd,Td){Ic.a.dWa(rc.taskManager,function(){try{tb()}catch(qe){Td(qe);return}rc.DHi(qa);kd(qa)})})};Za.prototype.CHi=function(qa){var tb=null,rc=new Promise(function(kd,Td){tb=Td});new Oc(this.$,this.Kf,qa,tb);return rc};Za.prototype.A1a=function(qa){return(qa=Object(Ue.a)(Rd.a,qa))?qa.sheetId:null};Za.prototype.y_f=function(qa){if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5065546_CommentsTasksFpsIsEnabled")&&qa&&qa.Task)try{var tb=Yd.a.instance.yc("Common.ISystemInitiatedFeedback");
tb&&tb.execute(function(rc){rc.logActivity("ExcelWebCommitTaskActivity","CommentsTasksFpsIsEnabled")})}catch(rc){eb.ULS.sendTraceTag(558662086,12,10,"Exception thrown while triggering ExcelWebCommitTaskActivity. Exception: {0}",rc)}};Za.prototype.x_f=function(){if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:4995535_CommentsFpsIsEnabled"))try{var qa=Yd.a.instance.yc("Common.ISystemInitiatedFeedback");qa&&qa.execute(function(tb){tb.logActivity("ExcelWebCommitNewCommentActivity","CommentsFpsIsEnabled")})}catch(tb){eb.ULS.sendTraceTag(561571797,
12,10,"Exception thrown while triggering ExcelWebCommitNewCommentActivity. Exception: {0}",tb)}};Object(Qa.a)(Za,"ExcelCommentAPI",null,[764,765]);Object(Qa.a)(fb,"ExcelCommentAnchorInfo",null,[763]);E.prototype.initialize=function(){};E.prototype.dispose=function(){this.$=this.excelCommentManager=null};E.prototype.highlightComment=function(qa){!qa||this.excelCommentManager.V_h(qa)||qa.commentType&&1!==qa.commentType&&!be.a.ZG()||(this.excelCommentManager.upc(qa.anchor),qa.focus())};E.createInstance=
function(qa,tb,rc,kd,Td){return new E(qa,tb,rc,kd,Td)};Object(Qa.a)(E,"ExcelCommentHintManager",null,[760,7]);var Yf=b(1279),mg=b(198),zf=b(1012);ia.prototype.getContent=function(){return this.content};Object(Qa.a)(ia,"MacroRecorderWorkbookCommentedPayload",null,[115]);var Ce=b(110),ne=b(46),Bf=b(160),Le=b(303),gd=b(273),$b=b(108),Fc=b(50),Vc=Yf.a;Cm(Kb,Vc);Kb.prototype.hog=function(qa){this.bkb(qa,!0)};Kb.prototype.bkb=function(qa,tb){tb&&(this.ff.mode=2,this.mO=qa);if(qa.Hj)for(tb=this.Mi.length-
1;0<=tb;tb--){var rc=this.Mi[tb];if(rc.Hj===qa.Hj||rc.id===qa.Hj){Array.insert(this.Mi,tb+1,qa);break}}else tb=qa.anchor,eb.ULS.shipAssertTag(50464415,12,!!tb,"Fail to get valid range for newly inserted comment!"),tb=this.ZOe(tb),Array.insert(this.Mi,~tb,qa)};Kb.prototype.sda=function(qa,tb){Array.clear(this.Mi);this.Mi=qa;this.pHb&&Array.clear(this.pHb);this.pHb=tb;this.sl&&(this.sl=this.Bs(this.sl.id));this.jfa&&(this.jfa=this.Bs(this.jfa.id));this.ixj()};Kb.prototype.sad=function(){return this.pHb?
Array.clone(this.pHb):[]};Kb.prototype.dwj=function(qa,tb,rc,kd){this.sda(qa,tb);this.DOg(rc,!!qa&&0<qa.length,kd)};Kb.prototype.Tbd=function(qa){var tb=null;this.ga.ya.TU&&(tb=this.excelCommentManager.OB,!tb&&this.excelCommentManager.Jl.mC&&eb.ULS.shipAssertTag(557057479,12,!1,"Not expecting to reach here when there is a separate button for DeleteNote."));this.applyComment(3,tb,qa)};Kb.prototype.IDb=function(qa,tb){if(this.YMa)eb.ULS.sendTraceTag(572822307,12,15,"RecordChanges: Attempting to commit a note/comment change while another operation is in progress.");
else{var rc=Object(Ue.a)(Wc.a,qa[0]);if(1!==rc.commentType||3!==tb){switch(tb){case 3:1<qa.length&&rc.Hj&&(rc=Object(Ue.a)(Wc.a,this.Bs(rc.Hj)));qa=3;break;case 2:qa=1;break;case 4:qa=(qa=Object(Ue.a)(624,rc))&&qa.m6e?7:2;break;case 0:case 1:qa=6;break;default:return}this.applyComment(qa,rc,null)}}};Kb.prototype.POi=function(qa,tb){if(this.excelCommentManager.Dvb){var rc=!tb.taskId;if(!rc||qa.Br.sessionType===Bb.create||Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:4017579_DocumentTasksCreateFromReply")&&
qa.Br.sessionType===Bb.reply){var kd=null;qa.Br.sessionType!==Bb.metadata&&(kd=qa.id);tb=Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:4084663_DocumentTasksDefaultTitleEnabled")&&qa.text&&0<qa.text.length?this.excelCommentManager.u4c.Sif.$Me(kd,tb,rc,qa.text[0]):this.excelCommentManager.u4c.Sif.$Me(kd,tb,rc);qa.gge=tb}else eb.ULS.shipAssertTag(51230684,12,!1,"Attempted to create task with invalid session type : "+qa.Br.sessionType)}};Kb.prototype.qN=function(){return this.fGb(!0)};Kb.prototype.jR=
function(){return this.fGb(!1)};Kb.prototype.qIa=function(qa){return 0<this.Mi.length&&(eb.ULS.shipAssertTag(50464416,12,!!qa,"invalid comment range"),qa=this.ZOe(qa),0<=qa)?((qa=this.Mi[qa])&&qa.Hj&&(qa=this.Bs(qa.Hj)),qa):null};Kb.prototype.ZOe=function(qa){return Kb.xRe(qa,this.Mi)};Kb.prototype.$rb=function(qa){var tb=0;qa&&(tb=Array.indexOf(this.Mi,qa));return tb};Kb.prototype.Yge=function(qa){qa&&(qa=this.Bs(qa))&&(qa.OFb=2);this.ff.mode=1;this.YMa=0};Kb.prototype.fGb=function(qa){if(!this.Mi.length)return null;
var tb=null;if(this.sl||(tb=this.Mi[qa?0:this.Mi.length-1]).Xac){var rc=this.sl||tb;tb=rc;do tb=qa?this.Zrb(tb,!0):this.l7b(tb,!0);while(tb&&tb.Xac&&tb!==rc)}this.selectComment(tb);return tb};Kb.prototype.applyComment=function(qa,tb,rc){var kd=this;tb&&(tb.OFb=1);this.ff.mode=4;this.YMa=qa;var Td=tb&&tb.text&&0<tb.text.length?tb.text[0]:null,qe=tb?ne.q(tb.anchor,this.$):ne.r(this.ga.ya.selectedRanges,this.$),Ne=tb?tb.id:null,Ja=tb?tb.done:!1,ob=null;tb&&void 0!==tb.Hj&&null!==tb.Hj&&0<tb.Hj.length&&
(ob=tb.Hj);var Nb=Object(Ue.a)(624,tb);eb.ULS.shipAssertTag(51230685,12,!tb||tb.I3a||!!Nb,"Apply threaded comment operation must have a threaded comment or a note");var Jc=Nb?this.excelCommentManager.u4c.urj(Nb.gge):null;Nb=new Bf.a(181,0,function(bd,Yc,Db){var mc=kd.$.ra.xa,le=ob;bd=gd.b(bd,Object(Cb.a)(kd,kd.hoi,"onApplyThreadedCommentSuccessCallback"));Yc=gd.a(Yc,Object(Cb.a)(kd,kd.Gjf,"onApplyCommentFailedCallback"));var hd=tb?tb.id:null,of=mc.Ra(9,null);of.options=qa;of.content=Td;of.anchor=
qe;of.commentId=Ne;of.parentCommentId=le;of.isResolved=Ja;of.taskHistoryRecords=Jc;return yb.i(mc,"ApplyThreadedComment",of,bd,Yc,Db,hd,0)},1,function(){return new ia(qa,Td,qe,Ne,ob,Ja)});this.$.userOperationManager.oc(Nb,rc)};Kb.prototype.hoi=function(qa,tb,rc){Le.a(qa)?(this.Gjf(null,tb,rc),this.fa.Wo(qa.Errors)):(1===this.YMa&&tb&&eb.ULS.shipAssertTag(50464417,12,!!this.Bs(tb),"can't find the newly created comments."),this.Dbi(this.YMa,tb));this.Yge(tb);this.oCc=""};Kb.prototype.Gjf=function(qa,
tb){if(this.excelCommentManager.yGa||!tb)eb.ULS.shipAssertTag(50464418,12,!!tb||3===this.YMa,"Only comment deletion can pass an invalid commentId.");else switch(qa=this.Bs(tb),this.YMa){case 2:qa?(eb.ULS.shipAssertTag(50464419,12,!!qa,"can't find the edited comments."),qa.text=qa.yoj):Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?(qa={},$b.b(this.$).Jd(Ce.a.cse,(qa.Location="floatie",qa),void 0,!0)):$b.b(this.$).Jd(Ce.a.cse,{},void 0,!0);break;case 1:eb.ULS.shipAssertTag(50464448,
12,!!qa,"can't find the inserted comments.");this.ff.R1b(qa);break;case 3:eb.ULS.shipAssertTag(50464449,12,!qa,"The deleted comment should not exist."),this.excelCommentManager.Bqg(tb)}this.excelCommentManager.pKb(!0);this.Yge(tb)};Kb.prototype.Dbi=function(qa,tb){var rc={};rc.a=this.$.Ba.UserSessionId;rc.b=qa;rc.c=tb;rc.d=this.Mi.length;Fc.b().Se(32,rc)};Kb.prototype.DOg=function(qa,tb,rc){this.dXd=rc?qa||tb?3:2:qa?4:tb?5:1};Kb.prototype.ixj=function(){if(this.mO){var qa=this.Bs(this.mO.id),tb=this.$.Aa.sa,
rc=Bb.$7b(this.mO.Br.sessionType);eb.ULS.shipAssertTag(50464450,12,!(void 0===rc||null===rc),"Invalid comment draft");qa?(eb.ULS.shipAssertTag(50464451,12,2===rc,"Expecting an edit draft"),qa.Br=this.mO.Br,this.mO=qa):tb&&this.eU===tb.sheetId&&this.bkb(this.mO,!1)}};Kb.createInstance=function(qa,tb,rc,kd){return new Kb(qa,tb,rc,kd)};Kb.HVg=function(qa,tb,rc){return Wc.a.j0b(Xa.AFrameworkApplication.userName,qa,tb,rc)};Kb.IVg=function(qa,tb,rc){var kd={};kd.DisplayName=Xa.AFrameworkApplication.userName;
kd.UserId=Xa.AFrameworkApplication.ha.Wa("PresenceUserId");kd.Provider=Xa.AFrameworkApplication.ha.Wa("PresenceProvider");return zf.a.lYg(kd,qa,tb,rc)};Kb.JVg=function(qa,tb,rc,kd){var Td={};Td.DisplayName=Xa.AFrameworkApplication.userName;Td.UserId=Xa.AFrameworkApplication.ha.Wa("PresenceUserId");Td.Provider=Xa.AFrameworkApplication.ha.Wa("PresenceProvider");return zf.a.mYg(Td,qa,tb,rc,kd)};Kb.xRe=function(qa,tb){var rc=new mg.a(tb);return gc.HelperMethods.Uw(rc,0,tb.length,qa,Kb.mOg)};Kb.r$c=function(qa,
tb,rc){qa=Kb.xRe(qa,rc);0<=qa?qa+=tb?1:-1:(qa=~qa,tb||--qa);return{returnValue:0<=qa&&qa<rc.length?rc[qa]:null,qTh:qa}};Kb.mOg=function(qa,tb){return b(855).ExcelCommentManager.Dnb(qa.anchor,tb)};Jl.Object.defineProperties(Kb.prototype,{gZa:{configurable:!0,enumerable:!0,get:function(){return this.dXd}},eU:{configurable:!0,enumerable:!0,get:function(){return this.oCc},set:function(qa){this.oCc=qa}}});Object(Qa.a)(Kb,"ExcelCommentModel",Yf.a,[761,762]);var ud=b(675);Ua.prototype.Qza=function(qa){for(var tb=
Ml(this.xbb),rc=tb.next();!rc.done;rc=tb.next())qa=rc.value.Qza(qa);return qa};Jl.Object.defineProperties(Ua.prototype,{xbb:{configurable:!0,enumerable:!0,get:function(){return this.xlg}},Pab:{configurable:!0,enumerable:!0,get:function(){return this.r$d},set:function(qa){this.r$d=qa;for(var tb=Ml(this.xbb),rc=tb.next();!rc.done;rc=tb.next())rc.value.Pab=qa}},A$a:{configurable:!0,enumerable:!0,get:function(){return this.k9d},set:function(qa){this.k9d=qa;for(var tb=Ml(this.xbb),rc=tb.next();!rc.done;rc=
tb.next())rc.value.A$a=qa}}});Object(Qa.a)(Ua,"AggregateCommentTaskPersonTransformer",null,[934]);Object(Qa.a)(va,"HistoryRecord",null,[]);Ia.prototype.zxh=function(){return new Date};Ia.prototype.Kra=function(qa,tb,rc){if(!qa)throw eb.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");var kd=dc.a.create().toString();rc=new va(qa,this.sfg.value,rc,kd,!1);rc.commentId=tb;eb.ULS.sendTraceTag(42796192,
327,50,"History Record Generated. [RecordType: {0}]",qa);return rc};Object(Qa.a)(Ia,"HistoryRecordFactory",null,[935]);Object(Qa.a)(za,"CommentTaskSchedule",null,[]);Object(Qa.a)(qb,"CommentTaskState",null,[]);Object(Qa.a)(Ta,"HistoryItem",null,[]);db.prototype.bZa=function(qa,tb){if(1!==qa.type)throw Error.argument("createRecordTemplate");var rc=db.QIh(qa,this.A4d);this.A4d++;return Object.assign(new va(tb,qa.user,qa.time,rc),{commentId:qa.commentId})};db.prototype.yve=function(qa){qa=Object.assign(new Ta,
{commentId:qa.commentId,records:[qa]});this.history.push(qa)};db.prototype.YNe=function(qa){for(var tb=-1,rc=0;rc<this.state.assignees.length;rc++)if(this.kPb.equals(this.state.assignees[rc],qa)){tb=rc;break}return tb};db.prototype.Rbj=function(qa){var tb=this.F$e,rc=tb.records[tb.records.length-1];return this.kPb.equals(rc.user,qa.user)&&tb.commentId===qa.commentId&&rc.time.getTime()===qa.time.getTime()?!0:!1};db.prototype.izj=function(qa){switch(qa.type){case 2:-1===this.YNe(qa.assignee)&&this.state.assignees.push(qa.assignee);
break;case 3:var tb=this.YNe(qa.assignee);0<=tb&&this.state.assignees.splice(tb,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=qa.schedule;break;case 6:this.state.completion=qa.completion;break;case 9:this.state.title=qa.title;break;case 10:this.state.priority=qa.priority;break;case 0:this.state.isLossy=!0;break;case 1:eb.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.XEc=!0;break;case 8:this.XEc=!1;break;case -1:eb.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}qa.isLossy&&(this.state.isLossy=!0);this.Rbj(qa)?this.F$e.records.push(qa):this.yve(qa)};db.prototype.WAh=function(qa){if(!qa)return this.history;var tb=Array.clone(this.history),rc=tb[0],kd=rc.records.shift(),Td=this.bZa(kd,4);rc.records.unshift(Td);!qa.PYe&&this.PYe&&(Td=this.bZa(kd,6),Td.completion=this.Ieb,rc.records.unshift(Td));!qa.OYe&&this.OYe&&(Td=this.bZa(kd,10),Td.priority=this.Heb,rc.records.unshift(Td));
!qa.QYe&&this.QYe&&(Td=this.bZa(kd,5),Td.schedule=new za,rc.records.unshift(Td));!qa.RYe&&this.RYe&&(Td=this.bZa(kd,9),Td.title=this.Jeb,rc.records.unshift(Td));qa.isDeleted&&(qa=this.bZa(kd,8),rc.records.unshift(qa));return tb};db.QIh=function(qa,tb){return"Synthesized-"+qa.recordId+"-"+tb};Jl.Object.defineProperties(db.prototype,{F$e:{configurable:!0,enumerable:!0,get:function(){return this.history[this.history.length-1]}},PYe:{configurable:!0,enumerable:!0,get:function(){return this.state.completion===
this.Ieb}},OYe:{configurable:!0,enumerable:!0,get:function(){return this.state.priority===this.Heb}},QYe:{configurable:!0,enumerable:!0,get:function(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}},RYe:{configurable:!0,enumerable:!0,get:function(){return this.state.title===this.Jeb}},isDeleted:{configurable:!0,enumerable:!0,get:function(){return this.XEc}},state:{configurable:!0,enumerable:!0,
get:function(){return this._state}},history:{configurable:!0,enumerable:!0,get:function(){return this._history}}});Object(Qa.a)(db,"CommentTaskStateBuilder",null,[]);var Ge=b(1242);Object(Qa.a)(ta,"CommentTaskItem",null,[]);Object(Qa.a)(ua,"CommentTaskPerson",null,[933]);var ce=b(1231);b(262);Object(Qa.a)(ca,"ExtensionList",null,[]);Ha.clone=function(qa){qa=Ha.iMg(qa.extensions);return new ca(qa)};Ha.Lqe=function(qa){return qa?Ha.clone(qa):null};Ha.isEmpty=function(qa){return!qa.extensions||!qa.extensions.count};
Ha.na=function(qa){return!qa||Ha.isEmpty(qa)};Ha.iMg=function(qa){if(!qa)return null;var tb=new ce.a;qa.forEach(function(rc,kd){tb.add(rc,kd);return!0});return tb};Object(Qa.a)(Ha,"ExtensionListExtensions",null,[]);Gb.clone=function(qa){var tb=Ra(qa.user);tb=new va(qa.type,tb,qa.time,qa.recordId,qa.isLossy);tb.commentId=qa.commentId;tb.anchorExtensionList=Ha.Lqe(qa.anchorExtensionList);tb.recordExtensionList=Ha.Lqe(qa.recordExtensionList);qa.assignee&&(tb.assignee=Ra(qa.assignee));if(qa.schedule){var rc=
qa.schedule,kd=new za;kd.startDate=rc.startDate;kd.endDate=rc.endDate;tb.schedule=kd}tb.completion=qa.completion;tb.title=qa.title;tb.priority=qa.priority;tb.undoId=qa.undoId;return tb};Object(Qa.a)(Gb,"HistoryRecordExtensions",null,[]);nb.prototype.gYg=function(qa,tb,rc,kd){kd=void 0===kd?null:kd;if(!qa)throw eb.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!tb)throw eb.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");
if(!rc||!rc.length)throw eb.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==rc[0].type)throw eb.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Td=[],qe=null,Ne=this.IJi(rc);rc=Ml(rc);for(var Ja=rc.next();!Ja.done;Ja=rc.next())if(Ja=Ja.value,!Ne.contains(Ja.recordId)){var ob=this.BVe(Ja.commentId,kd);Ja=this.qsh(Ja,ob);if(1===Ja.type)qe=new db(this.kPb,Ja,
this.Jeb,this.Heb,this.Ieb),Td.push(qe);else if(qe)qe.izj(Ja);else throw eb.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");}Ne=null;rc=[];if(qe)for(qe.isDeleted||(Ne=qe.state),qe=null,Td=Ml(Td),Ja=Td.next();!Ja.done;Ja=Td.next())Ja=Ja.value,qe=Ja.WAh(qe),Array.addRange(rc,qe),qe=Ja;Td=this.BVe(tb,
kd);Ne&&(Ne.completion=this.COg(tb,kd,Ne.completion));return new ta(qa,Td,Ne,rc)};nb.prototype.$Me=function(qa,tb,rc,kd){kd=void 0===kd?null:kd;if(!tb)throw eb.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(rc&&!qa)throw eb.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");var Td=[],qe=this.Yea.zxh();if(rc){var Ne=this.Yea.Kra(1,qa,qe);Td.push(Ne)}Ne=null;if(tb.assignee){rc||(Ne=this.Yea.Kra(4,
qa,qe),Td.push(Ne));var Ja=this.Yea.Kra(2,qa,qe);Ne=this.YIc.Qza(tb.assignee);Ja.assignee=Ne;Td.push(Ja)}tb.title?(kd=this.Yea.Kra(9,qa,qe),kd.title=tb.title,Td.push(kd)):rc&&kd&&(Ja=this.Yea.Kra(9,qa,qe),Ja.title=this.Bag.TJh(kd,Ne),Td.push(Ja));if(tb.schedule){if(tb.schedule.startDate>tb.schedule.endDate)throw eb.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");kd=this.Yea.Kra(5,qa,qe);kd.schedule=tb.schedule;Td.push(kd)}if(void 0!==tb.completion&&
null!==tb.completion){kd=tb.completion;if(0>kd||100<kd)throw eb.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");rc||eb.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",kd);rc=this.Yea.Kra(6,qa,qe);rc.completion=kd;Td.push(rc)}if(void 0!==tb.priority&&null!==tb.priority){tb=tb.priority;if(0>tb||10<tb)throw eb.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");qa=this.Yea.Kra(10,
qa,qe);qa.priority=tb;Td.push(qa)}return Td};nb.prototype.IJi=function(qa){for(var tb=new Ge.a,rc=new Ge.a,kd=qa.length-1;0<=kd;kd--){var Td=qa[kd],qe=rc.contains(Td.recordId);qe||-1!==Td.type||(rc.contains(Td.undoId)?eb.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):rc.add(Td.undoId));if(qe||-1===Td.type)tb.contains(Td.recordId)?eb.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
tb.add(Td.recordId)}return tb};nb.prototype.qsh=function(qa,tb){var rc=Gb.clone(qa);rc.commentId=tb;rc.user=this.YIc.Qza(qa.user);rc.assignee=this.YIc.Qza(qa.assignee);return rc};nb.prototype.COg=function(qa,tb,rc){var kd=rc;if(qa&&tb){var Td=tb.Ec(qa);tb=Td.value;Td.returnValue?(kd=tb.ResolveState?100:100===rc?0:rc,kd!==rc&&eb.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",qa)):eb.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",
qa)}return kd};nb.prototype.BVe=function(qa,tb){var rc=qa;qa&&tb&&(rc=tb.Ec(qa),tb=rc.value,rc.returnValue?rc=tb.CommentId:(eb.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",qa),rc=qa));return rc};Object(Qa.a)(nb,"CommentTaskTranslatorImpl",null,[936]);sb.initialize=function(qa){sb.Ai=qa;Sys.UI.DomElement.addCssClass(sb.Ai,"HtmlScratchPad");sb.oHd(!1)};sb.reset=function(){sb.Ai=null};sb.cHh=function(){var qa=sb.t4f.WordBreakUtils;
qa||(qa=sb.Ai.ownerDocument.createElement("div"),sb.Ai.appendChild(qa),sb.t4f.WordBreakUtils=qa);return qa};sb.lBg=function(){sb.VMb++;1===sb.VMb&&sb.oHd(!0)};sb.v8g=function(){sb.VMb--;sb.VMb||sb.oHd(!1)};sb.oHd=function(qa){qa?Sys.UI.DomElement.removeCssClass(sb.Ai,"Hidden"):Sys.UI.DomElement.addCssClass(sb.Ai,"Hidden")};Jl.Object.defineProperties(sb,{isInitialized:{configurable:!0,enumerable:!0,get:function(){return!!sb.Ai}}});sb.Ai=null;sb.t4f={};sb.VMb=0;Object(Qa.a)(sb,"HtmlScratchPadProvider",
null,[]);var Ae=b(30);Object(Qa.a)(ib,"WordBreak",null,[]);Object(Qa.a)(function(){this.wordCount=0},"WordCountFromWordBreaksResult",null,[]);Oa.prototype.GQe=function(qa,tb){var rc=void 0===rc?!1:rc;tb=this.FQe(qa,tb,rc);return tb&&(tb.d6f||(tb=this.FQe(qa,tb.Znb,rc),tb))?tb.Znb:qa.length};Oa.prototype.dOe=function(qa,tb){var rc=void 0===rc?!1:rc;tb=this.cOe(qa,tb,rc);return tb&&(tb.d6f||(tb=this.cOe(qa,tb.Znb,rc),tb))?tb.Znb:0};Oa.prototype.FQe=function(qa,tb,rc){return this.gAh(qa,tb,qa.length,
void 0===rc?!1:rc)};Oa.prototype.cOe=function(qa,tb,rc){return this.cuh(qa,tb,void 0===rc?!1:rc)};Oa.prototype.gAh=function(qa,tb,rc,kd){kd=void 0===kd?!1:kd;if(tb>=rc-1)return null;for(var Td=tb;Td<rc;){var qe=this.Gia(qa,Td);switch(qe){case 2:return qa=this.lOe(qa,tb,!0),!qa||qa.Znb>=rc?null:qa;case 3:case 1:case 0:case 5:case 6:if(Td>=rc-1)return null;var Ne=Td+1,Ja=this.Gia(qa,Ne);if(qe!==Ja&&this.vRf(qe,Ja,kd)&&(2!==Ja||!Oa.jXf))return new ib(Ne,Ja)}Td+=1}return null};Oa.prototype.cuh=function(qa,
tb,rc){rc=void 0===rc?!1:rc;if(1>=tb)return null;for(var kd=tb;0<kd;){var Td=this.Gia(qa,kd-1);switch(Td){case 2:return(qa=this.lOe(qa,tb,!1))?qa:null;case 3:case 1:case 0:case 5:case 6:if(1>=kd)return null;var qe=kd-1,Ne=this.Gia(qa,qe-1);if(Td!==Ne&&this.vRf(Td,Ne,rc)&&(2!==Ne||!Oa.jXf))return new ib(qe,Td)}--kd}return null};Oa.prototype.vRf=function(qa,tb,rc){return(void 0===rc?0:rc)?!(3===qa&&1===tb||1===qa&&3===tb):5===qa&&3!==tb||3===qa&&5!==tb||1===qa||6===qa||!qa};Oa.prototype.O8g=function(){Oa.YAa||
(Oa.YAa=sb.cHh(),Oa.YAa.className="WACWordBreakSurface")};Oa.prototype.kwj=function(qa){Oa.bX!==qa&&(Oa.YAa.innerText=qa,Oa.bX=qa)};Oa.prototype.lOe=function(qa,tb,rc){this.O8g();this.kwj(qa);var kd=-1,Td=!1;Hd.a.MMd?(kd=this.Foj(tb,rc),tb!==kd&&(Td=!0)):Hd.a.mXf&&(kd=this.zMi(tb,rc),tb!==kd&&(Td=!0));Td||(kd=this.Nki(tb,rc));Td=-1;rc?kd>=Oa.bX.length?kd=-1:kd===tb?Td=4:kd<tb&&(kd=-1):(0>=kd&&(kd=-1),kd>=tb&&(kd=-1));if(-1===kd)return null;-1===Td&&(Td=this.Gia(qa,kd));return new ib(kd,Td)};Oa.prototype.Foj=
function(qa,tb){Xa.AFrameworkApplication.Sm.Jub(Oa.tTd);Oa.Tpa||(Oa.Tpa=document.body.createTextRange());Oa.Tpa.moveToElementText(Oa.YAa);Oa.Tpa.collapse();Oa.Tpa.move("character",qa);tb?Oa.Tpa.moveEnd("word",1):Oa.Tpa.moveStart("word",-1);var rc=Oa.Tpa.text.length;rc=tb?qa+rc:qa-rc;if(0>rc||rc>Oa.bX.length)rc=qa;return rc=this.Vte(qa,rc,tb)};Oa.prototype.zMi=function(qa,tb){Xa.AFrameworkApplication.Sm.Jub(Oa.tTd);sb.lBg();var rc=Oa.YAa.firstChild,kd=Oa.YAa.ownerDocument.createRange();kd.setStart(rc,
qa);kd.setEnd(rc,qa);kd.expand("word");var Td=tb?kd.endOffset:kd.startOffset;Td===qa&&!tb&&0<qa&&(kd.setStart(rc,qa-1),kd.setEnd(rc,qa-1),kd.expand("word"),Td=kd.startOffset);Td=this.Vte(qa,Td,tb);sb.v8g();return Td};Oa.prototype.Vte=function(qa,tb,rc){return qa===tb?tb:rc?this.oRg(qa,tb):this.nRg(qa,tb)};Oa.prototype.oRg=function(qa,tb){for(var rc=!1;qa<tb;qa++){var kd=this.Gia(Oa.bX,qa);if(rc){if(1===kd||!kd)return Xa.AFrameworkApplication.Sm.Jub(Oa.uTd),qa}else 2===kd&&(rc=!0)}return tb};Oa.prototype.nRg=
function(qa,tb){var rc=!1;for(--qa;qa>=tb;qa--){var kd=this.Gia(Oa.bX,qa);if(rc){if(1===kd||!kd)return Xa.AFrameworkApplication.Sm.Jub(Oa.uTd),qa+1}else 2===kd&&(rc=!0)}return tb};Oa.prototype.Nki=function(qa,tb){return tb?this.Pki(qa):this.Oki(qa)};Oa.prototype.Pki=function(qa){for(var tb=qa;tb<Oa.bX.length&&2===this.Gia(Oa.bX,tb)&&!Ae.a.o4e(Ae.a.charCodeAt(Oa.bX,tb));)tb++;tb===qa&&(tb++,this.N3e(tb)&&tb++);return tb};Oa.prototype.Oki=function(qa){for(var tb=qa;0<tb&&2===this.Gia(Oa.bX,tb-1)&&!Ae.a.o4e(Ae.a.charCodeAt(Oa.bX,
tb-1));)tb--;tb===qa&&(tb--,this.N3e(tb)&&tb--);return tb};Oa.prototype.N3e=function(qa){return Ae.a.f3h(Oa.bX,qa-1)};Oa.prototype.Gia=function(qa,tb){qa=qa.charAt(tb).toString();return this.IZh(qa)?3:this.Y7h(qa)?0:this.y4h(qa)?1:this.z4h(qa)?5:this.K1h(qa)?6:2};Oa.prototype.IZh=function(qa){return Ae.a.HZh(qa.charAt(0))};Oa.prototype.Y7h=function(qa){Oa.jNc||(Oa.jNc=RegExp("[\\u0000-\\u001F]|\\u0020|[\\u007F-\\u009F]|\\u00A0|[\\u2000-\\u200B]|\\u202F|\\u205F|\\u2420|[\\u2422-\\u2424]|\\u3000|\\uFF02"));
return Oa.jNc.test(qa)};Oa.prototype.y4h=function(qa){Oa.BRb||(Oa.BRb=RegExp("[!-&]|[\\(-\\.]|/|[:-@]|[\\[-`]|[{-~]|\u00a1|\u00a6|\u00a7|\u00a9|\u00ab|\u00ac|\u00ae|\u00b0|\u00b1|[\u00b4-\u00b7]|\u00bb|\u00bf|\u00d7|\u00f7|\u01c3|\u037e|[\u2012-\u2015]|[\u201a-\u2022]|[\u2024-\u2026]|\\u202F|\u2030|\u2039|\u203a|\u203c|\u203d|\u2048|\u2049|\\u2060|\u2103|\u2105|\u2106|\u2109|\u2116|\u2122|\u2211|\u2212|\u221a|\u221e|\u222b|\u2248|\u2260|\u2264|\u2265|\\u25A1|\\u25AA|\\u25AB|\u25ca|\u25cf|\u25e6|[\u2639-\u263b]|\u2762|\\uFEFF|\uff01|\uff0e|\uff1b|\uff1f|\uff61"));
return Oa.BRb.test(qa)};Oa.prototype.z4h=function(qa){return"'"===qa||"\u2018"===qa||"\u2019"===qa};Oa.prototype.K1h=function(qa){return"\ue000"===qa};Jl.Object.defineProperties(Oa,{jXf:{configurable:!0,enumerable:!0,get:function(){return Hd.a.MMd||Hd.a.mXf}},instance:{configurable:!0,enumerable:!0,get:function(){Oa.Pa||(Oa.Pa=new Oa);return Oa.Pa}}});Oa.uTd=10265;Oa.tTd=10266;Oa.jNc=null;Oa.BRb=null;Oa.YAa=null;Oa.bX="";Oa.Tpa=null;Oa.Pa=null;Object(Qa.a)(Oa,"WordBreakUtils",null,[879]);xa.prototype.TJh=
function(qa,tb){if(!qa)throw eb.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var rc=td.DPe(qa)}catch(Nb){throw eb.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var kd=qa=0,Td=0,qe=RegExp("\\s+","g"),Ne=new Sys.StringBuilder;rc=Ml(rc.ops);for(var Ja=rc.next();!Ja.done;Ja=rc.next()){Ja=Ja.value;if(Ja.attributes&&Ja.attributes.atmention&&Ja.attributes.atmention.email&&
tb){var ob=Ja.attributes.atmention.email;0<ob.length&&(ob===tb.UserId||ob===tb.Email||ob===pd.a.DHa(tb.UserId))&&(kd=qa,Td=kd+Ja.insert.length)}Ja=Ja.insert.replace(qe," ");qa+=Ja.length;Ne.append(Ja)}!Td&&tb&&eb.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",tb.Provider);tb=Ne.toString().trimEnd();qa=tb.length;255<qa?(qe=(255-(Td-kd))/2,0>kd-qe?(qa=Oa.instance.dOe(tb,255-this.c$.length),Td=tb.substring(0,qa)+this.c$,qa="Trimmed End"):Td+qe>qa?(kd=Oa.instance.GQe(tb,qa-
255+this.c$.length),Td=this.c$+tb.substring(kd,qa),qa="Trimmed Start"):(kd=Oa.instance.GQe(tb,kd-qe+this.c$.length),qa=Oa.instance.dOe(tb,Td+qe-this.c$.length),Td=this.c$+tb.substring(kd,qa)+this.c$,qa="Trimmed Both")):(qa="No Trim",Td=tb);eb.ULS.sendTraceTag(592998804,327,50,qa);return Td};Object(Qa.a)(xa,"ContentExtractor",null,[]);na.prototype.Qza=function(qa){if(!qa)return null;if(void 0===qa.UserId||null===qa.UserId)throw eb.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),
Error.argumentType();if(qa.IsCurrentUser||!this.Ndg.equals(this.tfg.value,qa))return qa;qa=Ra(qa);qa.IsCurrentUser=!0;return qa};Object(Qa.a)(na,"EnsureIsCurrentUserSetTransformer",null,[934]);ma.prototype.Qza=function(qa){if(!qa)return null;if(void 0===qa.UserId||null===qa.UserId)return qa;if(!qa.Email||""===qa.Email){var tb;if(tb=pd.a.DHa(qa.UserId))return qa=Ra(qa),qa.Email=tb,qa}return qa};Object(Qa.a)(ma,"RestoreEmailTransformer",null,[934]);Sa.prototype.Qza=function(qa){if(!qa)return null;if(void 0!==
qa.UserId&&null!==qa.UserId)return qa;switch(this.Pab?this.A$a?2:1:0){case 0:if(void 0===qa.UserId||null===qa.UserId)throw eb.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");qa=Ra(qa);break;case 1:if(void 0===qa.Id||null===qa.Id)throw eb.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===qa.Email||null===qa.Email)throw eb.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");
var tb=Sa.Ivf(qa.Id,qa.Email,null);if(!tb||""===tb)throw eb.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var rc=Xa.AFrameworkApplication.ha.Wa("HostAuthType")||"";if("aad"!==rc.toLowerCase()||tb.startsWith("S::")){if("msa"===rc.toLowerCase())throw eb.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");eb.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",rc)}else throw eb.ULS.sendTraceTag(593368211,
327,10,"Unexpected UserID format"),Error.argument("userId");qa=new ua(tb,"AD",qa.DisplayName,qa.Email);break;case 2:if(void 0===qa.UserPrincipalName||null===qa.UserPrincipalName)throw eb.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==qa.SuggestionSubtype&&null!==qa.SuggestionSubtype)if("OrganizationUser"===qa.SuggestionSubtype)tb="AD";else throw eb.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
qa.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw eb.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");rc=Sa.Ivf(qa.Id,qa.UserPrincipalName,qa.AadObjectId);if(!rc||""===rc)throw eb.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===tb&&!rc.startsWith("S::"))throw eb.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
qa=new ua(rc,tb,qa.Name,qa.UserPrincipalName);break;default:throw eb.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return qa};Sa.Ivf=function(qa,tb,rc){if(!tb||""===tb)return eb.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),qa;if(rc&&""!==rc)return"S::"+tb+"::"+rc;if(!qa||""===qa)return eb.ULS.sendTraceTag(593368217,327,50,"Missing ID"),qa;if(qa.startsWith("S::"))return qa;if(-1!==qa.indexOf("@")){rc=qa.split("@");if(dc.a.isValid(rc[0]))return"S::"+
tb+"::"+rc[0];eb.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return qa};Object(Qa.a)(Sa,"UserIdCanonicalizationTransformer",null,[934]);oa.prototype.OSg=function(){var qa=new pd.a,tb=new ud.a(oa.fxh),rc=new Ua;this.MVd&&(rc.xbb.push(new Sa),rc.xbb.push(new ma));this.Kbg&&rc.xbb.push(new na(qa,tb));rc.Pab=this.MVd;rc.A$a=this.zfg;tb=new Ia(tb,rc);var kd=new xa;return new nb(qa,rc,tb,kd,oa.t0g,oa.j0g,oa.k0g)};oa.fxh=function(){var qa=new ua(Xa.AFrameworkApplication.ha.Wa("PresenceUserId")||
"",Xa.AFrameworkApplication.ha.Wa("PresenceProvider")||"",Xa.AFrameworkApplication.userName||"");qa.IsCurrentUser=!0;return qa};oa.t0g="";oa.j0g=5;oa.k0g=0;Object(Qa.a)(oa,"CommentTaskTranslatorFactory",null,[916]);ha.prototype.Arj=function(qa,tb){for(var rc=qa.HistoryRecords.length,kd=Array(rc),Td=0;Td<rc;++Td)kd[Td]=ha.TQg(qa.HistoryRecords[Td]);try{return this.pef.gYg(qa.TaskId,qa.AnchorId,kd,tb)}catch(qe){return eb.ULS.sendTraceTag(50918081,12,10,"TranslateToSharedCommentTaskItem Failed due to [{0}]",
qe.message),null}};ha.prototype.urj=function(qa){for(var tb=qa?qa.length:0,rc=Array(tb),kd=0;kd<tb;++kd)rc[kd]=this.trj(qa[kd]);return rc};ha.prototype.trj=function(qa){var tb={};tb.AnchorId=qa.commentId;qa.assignee&&(tb.Assignee={},tb.Assignee.UserId=qa.assignee.UserId,tb.Assignee.Provider=qa.assignee.Provider,tb.Assignee.DisplayName=qa.assignee.DisplayName);qa.schedule&&(tb.DueDate=qa.schedule.endDate?qa.schedule.endDate.getTime():null,tb.StartDate=qa.schedule.startDate?qa.schedule.startDate.getTime():
null);tb.Id=qa.recordId;tb.Priority=qa.priority;tb.Progress=qa.completion;tb.Time=qa.time.getTime();tb.Title=qa.title;switch(qa.type){case 2:tb.Type=2;break;case 1:tb.Type=1;break;case 7:tb.Type=8;break;case 10:tb.Type=7;break;case 6:tb.Type=6;break;case 8:tb.Type=9;break;case 5:tb.Type=5;break;case 9:tb.Type=10;break;case 3:tb.Type=3;break;case 4:tb.Type=4;break;default:eb.ULS.shipAssertTag(51230686,12,!1,"Unexpected task history type: "+qa.type)}tb.UndoId=null;return tb};ha.VQg=function(qa){switch(qa){case 0:return 0;
case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 7;case 10:return 9;case 9:return 8;case 11:return-1;default:return 0}};ha.TQg=function(qa){var tb=null;qa.User&&(tb=new ua(qa.User.UserId,qa.User.Provider,qa.User.DisplayName));tb=new va(ha.VQg(qa.Type),tb,new Date(qa.Time),qa.Id);tb.commentId=qa.AnchorId;qa.Assignee&&(tb.assignee=new ua(qa.Assignee.UserId,qa.Assignee.Provider,qa.Assignee.DisplayName));if(qa.StartDate||qa.DueDate)tb.schedule=
new za,tb.schedule.startDate=qa.StartDate?new Date(qa.StartDate):null,tb.schedule.endDate=qa.DueDate?new Date(qa.DueDate):null;tb.priority=qa.Priority;tb.completion=qa.Progress;tb.title=qa.Title;qa.UndoId&&(tb.undoId=qa.UndoId);return tb};Jl.Object.defineProperties(ha.prototype,{Sif:{configurable:!0,enumerable:!0,get:function(){return this.pef}}});Object(Qa.a)(ha,"ExcelCommentTaskTranslator",null,[759]);Object(Qa.a)(ba,"OfficeSharedCommentModel",null,[]);Cm(R,ba);Object(Qa.a)(R,"ExcelOfficeSharedComment",
ba,[]);ja.prototype.yrj=function(qa,tb,rc){if(!qa)return null;var kd=0;qa.X8e&&(kd|=4);if(tb||rc&&qa.I3a)kd|=1;qa.done&&(kd|=8);qa.L0h&&(kd|=16);tb=Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5703292_ExcelPlumbEmailThroughCG")?pd.a.DHa(qa.authorIdentity||""):"";tb=new ec(qa.authorIdentity?qa.authorIdentity:"",qa.IRc?qa.IRc:"",qa.author?qa.author:"",tb?tb:"",qa.isCurrentUser);return new R(qa.id,qa.Hj?qa.Hj:"",qa.commentBody,tb,qa.date,kd,qa.mhe?qa.mhe:"")};ja.prototype.zrj=function(qa,tb,rc){var kd=
new hc.a;if(qa){qa=Ml(qa);for(var Td=qa.next();!Td.done;Td=qa.next())Td=Td.value,1!==Td.commentType&&kd.add(this.yrj(Td,tb,rc))}return kd.toArray()};Object(Qa.a)(ja,"ExcelSharedCommentModelTranslator",null,[758]);var Ob=b(1125),ac=b(808),fc=b(904);Object(Qa.a)(X,"ActionDataWithInputMethod",null,[]);var Uc=b(162),Vd=b(90),ld=b(426),Od=b(552),De=b(475),Yb=b(137),sa=b(163),hb=b(85);ea.prototype.initialize=function(qa,tb){this.ff=qa;this.V5d=tb;qa=this.eWg();this.BDi.appendChild(qa);this.Rg()};ea.prototype.dispose=
function(){this.wHb&&this.wq&&(this.Xg.Ca(Pc.a.click,this.wq,Object(Cb.a)(this,this.Uj,"onClosePaneClick")),this.qe.jv(this.wq,this.lWd));this.wRf&&this.qO&&(this.Xg.Ca(Pc.a.click,this.qO,Object(Cb.a)(this,this.Vtd,"onNewCommentClick")),this.qe.jv(this.qO,this.x4d));this.Wg&&this.Xg.Ca(Pc.a.click,this.Wg,Object(Cb.a)(this,this.ru,"clearSelection"));var qa=this.hc.Wh(Nd.AFrame.Ho);qa.Kk(this.poa);qa.Kk(Ke.FocusManager.instance().j1);qa.Kk(Ke.FocusManager.instance().k1);this.qO=this.GIc=this.wq=this.k8=
null};ea.prototype.gTf=function(){this.Lr.innerText="";var qa=ac.a("div","","CommentPaneEmpty1");qa.innerText=this.X7g;this.Lr.appendChild(qa);this.ff.mode&&(qa=ac.a("div","","CommentPaneEmpty2"),qa.innerText=this.Y7g,this.Lr.appendChild(qa))};ea.prototype.oR=function(){this.Lr.innerText="";var qa=ac.a("div","","CommentPaneEmpty1");qa.innerText=CommonUIStrings.l_CommentPaneError;this.Lr.appendChild(qa)};ea.prototype.Bgj=function(){this.Lr.innerText="";var qa=ac.a("div","","");qa.style.textAlign="center";
var tb=document.createElement("img");tb.className="CommentPaneLoading";tb.src=Uc.a.yra("progress.gif");qa.appendChild(tb);tb=ac.a("div","","CommentPaneLoadingText");tb.innerText=CommonUIStrings.l_CommentLoading;qa.appendChild(tb);this.Lr.appendChild(qa)};ea.prototype.showComments=function(qa){hb.a.bnb(this.Lr);if(qa.length)for(var tb=0;tb<qa.length;tb++){var rc=qa[tb],kd=tb?qa[tb-1]:null;(!tb||kd.jtb<rc.jtb)&&this.Lr.appendChild(this.u0b());this.Lr.appendChild(rc.render())}else this.gTf();this.aBc=
!0;this.fna();this.WTb&&(this.WTb.focus(),this.WTb=null)};ea.prototype.selectComment=function(qa){this.aBc?qa.focus():this.WTb=qa};ea.prototype.f4e=function(qa,tb){return!qa||!tb||qa.jtb!==tb.jtb};ea.prototype.uGf=function(qa){var tb=this.ff.model.l7b(qa,!1),rc=this.ff.model.Zrb(qa,!1);tb||rc||hb.a.bnb(this.Lr);tb=this.f4e(tb,qa);var kd=this.f4e(rc,qa),Td=null;rc&&(Td=rc.Pi,kd&&(Td=Td.previousSibling));this.vGf(qa,Td,tb&&kd)};ea.prototype.pGf=function(qa){var tb=qa.Pi.nextSibling;this.Lr.removeChild(qa.Pi);
this.vGf(qa,tb,!1)};ea.prototype.Nni=function(qa){ea.nqe(qa.element);ea.UDf(qa.element)};ea.prototype.yjf=function(qa){qa.element.style.marginTop="";ea.UDf(qa.element)};ea.prototype.fBd=function(qa){for(var tb=[],rc=null,kd=null,Td=0;Td<qa.length;Td++){rc=qa[Td];Td||(kd=rc.Pi.previousSibling);if(Td===qa.length-1){var qe=rc.Pi.nextSibling;kd&&Sys.UI.DomElement.containsCssClass(kd,"CommentGroupDivider")&&(!qe||Sys.UI.DomElement.containsCssClass(qe,"CommentGroupDivider"))&&Array.add(tb,kd)}rc=rc.Pi;
Array.add(tb,rc)}kd=0;if(qa=rc.nextSibling){kd=qa.offsetTop;for(Td=0;Td<tb.length;Td++)tb[Td].style.display="none";kd=qa.offsetTop-kd;for(Td=0;Td<tb.length;Td++)tb[Td].style.display=""}ea.Gwg(tb,qa,kd,Object(Cb.a)(this,this.Oni,"onAfterFadeOut"),Object(Cb.a)(this,this.yjf,"onAfterMove"))};ea.prototype.Rg=function(){this.Oa.$b(Ed.a.W$,Fd.a.frame,Object(Cb.a)(this,this.W$,"hideCommentPane"));this.Oa.$b(Ed.a.editComment,Fd.a.frame,Object(Cb.a)(this,this.editComment,"editComment"));this.Oa.$b(Ed.a.qN,
Fd.a.frame,Object(Cb.a)(this,this.qN,"selectNextComment"));this.Oa.$b(Ed.a.jR,Fd.a.frame,Object(Cb.a)(this,this.jR,"selectPrevComment"));this.Oa.Jf(Ed.a.kDb,Fd.a.frame,Object(Cb.a)(this,this.kDb,"queryToggleCommentPane"),96);this.Oa.$b(Ed.a.YWc,Fd.a.frame,Object(Cb.a)(this,this.Ure,"commentMoveFocusForTabsHandler"));this.Oa.$b(Ed.a.XWc,Fd.a.frame,Object(Cb.a)(this,this.Ure,"commentMoveFocusForTabsHandler"))};ea.prototype.Oni=function(qa){qa.element.parentNode&&qa.element.parentNode.removeChild(qa.element);
this.Lr.childNodes.length||this.gTf()};ea.prototype.O5a=function(){this.fna()};ea.prototype.eWg=function(){var qa=ac.a("div",this.DNg,"CommentPane"),tb=ac.a("label",Ob.a.ZWc,Ob.a.ZWc);tb.innerText=CommonUIStrings.l_CommentTabHelp;qa.appendChild(tb);this.wHb&&(tb=this.hG(),qa.appendChild(tb));this.wRf&&(tb=this.eZc(),qa.appendChild(tb));tb=ac.a("div","CommentPaneSurface","CommentPaneSurface");this.ff.kYc||(Sys.UI.DomElement.addCssClass(qa,"DisableSelection"),qa.setAttribute("Unselectable","on"));qa.appendChild(tb);
this.k8=qa;this.GIc=tb;this.fna();this.kma();this.Xg.qa(Pc.a.click,qa,Object(Cb.a)(this,this.ru,"clearSelection"));this.Bgj();return qa};ea.prototype.hG=function(){var qa=ac.b("div","CommentPaneHeader","CommentPaneHeader"),tb=ac.b("span","CommentPaneTitle","PaneTitle CommentPaneTitle UIFontLight");tb.innerText=CommonUIStrings.L_OpenCommentPane;var rc=fc.a.zb("CloseCommentPane","CommentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);Sys.UI.DomElement.addCssClass(rc,Xa.AFrameworkApplication.isRtl?
"FloatLeft":"FloatRight");this.Xg.qa(Pc.a.click,rc,Object(Cb.a)(this,this.Uj,"onClosePaneClick"));this.lWd=this.qe.Qr(rc,Object(Cb.a)(this,this.Uj,"onClosePaneClick"),Vd.a.Vh);qa.appendChild(tb);qa.appendChild(rc);this.wq=rc;return qa};ea.prototype.eZc=function(){this.bCa=ac.b("div","CommentPaneControls","CommentPaneControls");var qa=fc.a.zb("CommentPaneNewComment","CommentPaneNewComment",CommonUIStrings.l_CommentNewCommentButton,"CommentNew_16x16x32");this.bCa.appendChild(qa);this.Xg.qa(Pc.a.click,
qa,Object(Cb.a)(this,this.Vtd,"onNewCommentClick"));this.x4d=this.qe.Qr(qa,Object(Cb.a)(this,this.Vtd,"onNewCommentClick"),Vd.a.Vh);this.qO=qa;return this.bCa};ea.prototype.u0b=function(){var qa=ac.a("div","","CommentGroupDivider");this.iUd||Sys.UI.DomElement.addCssClass(qa,"CommentGroupDividerFirst");this.iUd=!0;qa.innerText="";return qa};ea.prototype.fna=function(){this.ff.mode&&-1!==this.ff.mode?(Sys.UI.DomElement.removeCssClass(this.Lr,"ReadOnly"),this.bCa&&(this.bCa.style.display="inline-block"),
this.wbc||4===this.ff.mode?(Sys.UI.DomElement.addCssClass(this.Lr,"CommentInProgress"),Sys.UI.DomElement.removeCssClass(this.Lr,"Interactive"),this.qO&&this.YOf(!1)):(Sys.UI.DomElement.addCssClass(this.Lr,"Interactive"),Sys.UI.DomElement.removeCssClass(this.Lr,"CommentInProgress"),this.qO&&this.YOf(this.aBc))):(this.bCa&&(this.bCa.style.display="none"),Sys.UI.DomElement.addCssClass(this.Lr,"ReadOnly"))};ea.prototype.YOf=function(qa){fc.a.r$a(this.qO,qa)};ea.prototype.kma=function(){var qa=this,tb=
this.hc.Wh(Nd.AFrame.Ho);tb.parent=Nd.AFrame.HO;this.Xg.VVa(Nd.AFrame.Ho,this.Wg);tb.cEa(function(){var rc=qa.qO.disabled&&qa.wq?qa.wq:qa.qO;rc.focus();qa.ff.oJ().mf.ql(rc);qa.ff.oJ().mf.xn(5)});tb.FOc(function(){2!==qa.ff.mode&&3!==qa.ff.mode&&qa.ff.ru()});this.KF.UVa(Nd.AFrame.Ho);tb.bindAction(Nc.KeyInputManager.El(Vd.a.scb,0),Ed.a.jR);tb.bindAction(Nc.KeyInputManager.El(Vd.a.jAa,0),Ed.a.qN);tb.bindAction(this.poa,Ed.a.W$)};ea.prototype.WBf=function(qa){qa.Kk(this.hc.j1);qa.Kk(this.hc.k1);qa.bindAction(this.hc.j1,
Ed.a.YWc);qa.bindAction(this.hc.k1,Ed.a.XWc)};ea.prototype.Ure=function(qa){var tb=this.ff.oJ().mf.Ei,rc=this.ff.model.Hya;if(!tb){tb=document.activeElement;this.Wg.contains(tb)||(tb=rc?rc.Pi:this.ff.Wg.Mqd);if(!tb)return 4;this.ff.oJ().mf.ql(tb)}return qa===Ed.a.YWc?this.vwa(tb,rc):qa===Ed.a.XWc?this.gMa(tb,rc):2};ea.prototype.vwa=function(qa,tb){var rc=this.wbc;if(qa===this.qO&&this.ff.model.wcd()&&!this.wbc)return this.ff.qN(),32;if(tb&&qa===tb.Pi)this.ff.oJ().mf.ql(qa.firstChild);else if(-1!==
qa.className.indexOf(Ob.a.Sre)){if(tb){if(this.ff.model.Zrb(tb,!1))return this.ff.qN(),32;rc||this.ff.model.ru();this.ff.oJ().mf.ql(tb.Pi)}}else{if(-1!==qa.className.indexOf(Ob.a.aXc))return this.ff.oJ().mf.ql(tb.bse.W0i),32;-1!==qa.className.indexOf(Ob.a.Zre)&&this.ff.oJ().mf.ql(tb.Pi)}this.ff.oJ().vwa();return 32};ea.prototype.gMa=function(qa,tb){if(qa===this.qO)return this.ff.oJ().gMa(),32;if(tb)if(qa===tb.Pi)if(qa=this.wbc,this.ff.model.l7b(tb,!1)){if(!qa)return this.ff.jR(),(tb=this.ff.model.Hya.bse.N0g)&&
this.ff.oJ().mf.ql(tb),32}else qa||this.ff.ru();else{if(-1!==qa.className.indexOf(Ob.a.Yre)||-1!==qa.className.indexOf(Ob.a.Rre))return this.ff.oJ().mf.ql(tb.Pi),32}else if((-1!==qa.className.indexOf(Ob.a.INg)||-1!==qa.className.indexOf(Ob.a.ENg))&&this.ff.model.wcd())return this.ff.jR(),32;this.ff.oJ().gMa();return 32};ea.prototype.Uj=function(){this.Oa.processAction(Ed.a.W$,2);return!0};ea.prototype.ru=function(){this.hc.Ij(Nd.AFrame.Ho);this.ff&&2!==this.ff.mode&&3!==this.ff.mode&&this.ff.ru();
return!0};ea.prototype.Vtd=function(){if(this.qO.disabled)return!0;this.DOc();return!0};ea.prototype.DOc=function(){this.hc.Ij(Nd.AFrame.Ho);this.ff.gkb(null)};ea.prototype.gkb=function(qa,tb,rc,kd,Td){1!==rc&&(this.isVisible?this.DOc():(qa=0,Object(Xb.a)(X,Td)&&(qa=Td.inputMethod),Td=new X(Td,qa),this.UUb=!0,this.Oa.Pe(Ed.a.z6,2,Td)))};ea.prototype.editComment=function(qa,tb,rc,kd,Td){if(1===rc)return 1===this.ff.mode?32:8;if(this.isVisible){qa=this.ff.model.Bs(Td);if(!qa)return 8;qa.Zsd()}else this.tBe=
!0,this.Oa.Pe(Ed.a.z6,2,Td);return 32};ea.prototype.qN=function(qa,tb,rc){if(1===rc)return 32;this.ff.qN();return 32};ea.prototype.jR=function(qa,tb,rc){if(1===rc)return 32;this.ff.jR();return 32};ea.prototype.vGf=function(qa,tb,rc){var kd=qa.render(),Td=[],qe=0,Ne=0;tb?(Ne=tb.offsetTop,this.Lr.insertBefore(kd,tb)):this.Lr.appendChild(kd);Array.add(Td,kd);rc&&(rc=this.u0b(),this.Lr.insertBefore(rc,kd),Array.add(Td,rc));tb&&(qe=tb.offsetTop-Ne);ea.Kwg(Td,tb,qe,Object(Cb.a)(this,this.Nni,"onAfterFadeIn"),
Object(Cb.a)(this,this.yjf,"onAfterMove"));qa.commentType&&qa.focus()};ea.Kwg=function(qa,tb,rc,kd,Td){for(var qe=0;qe<qa.length;qe++){var Ne=qa[qe];tb?Yb.WacAirSpace.yK(Ne,"WAC_DelayShowClass"):Yb.WacAirSpace.yK(Ne,"Shared_BasicClass");Ne=new De.a(Ne);Ne.Sz(0,1);Yb.WacAirSpace.animate(Ne,null,kd)}tb&&(qa=ea.fQe(tb),tb.style.position="relative",Yb.WacAirSpace.yK(tb,"Shared_BasicClass"),tb=new Od.a(tb),tb.Aqa(qa-rc,qa),Yb.WacAirSpace.animate(tb,null,Td))};ea.Gwg=function(qa,tb,rc,kd,Td){for(var qe=
0;qe<qa.length;qe++){var Ne=qa[qe];Yb.WacAirSpace.yK(Ne,"Shared_BasicClass");Ne=new ld.a(Ne);Ne.Sz(1,0);Yb.WacAirSpace.animate(Ne,null,kd)}tb&&(qa=ea.fQe(tb),tb.style.position="relative",Yb.WacAirSpace.yK(tb,"WAC_DelayMoveClass"),tb=new Od.a(tb),tb.Aqa(qa,rc+qa),Yb.WacAirSpace.animate(tb,null,Td))};ea.UDf=function(qa){var tb=qa.className;if(tb){tb=tb.split(" ");for(var rc=0;rc<tb.length;rc++){var kd=tb[rc];kd.startsWith(Yb.WacAirSpace.Ykb)&&Sys.UI.DomElement.removeCssClass(qa,kd)}}};ea.fQe=function(qa){qa=
sa.a.kA(qa);var tb=0;qa&&qa.marginTop&&(tb=parseInt(qa.marginTop),tb=isNaN(tb)?0:tb);return tb};ea.nqe=function(qa){Hd.a.$G?qa.style.filter="":qa.style.opacity=""};Jl.Object.defineProperties(ea.prototype,{UUb:{configurable:!0,enumerable:!0,get:function(){return this.gUd},set:function(qa){(this.gUd=qa)||this.DOc()}},DNg:{configurable:!0,enumerable:!0,get:function(){return"CommentPane"}},isVisible:{configurable:!0,enumerable:!0,get:function(){return this.X7},set:function(qa){this.X7=qa}},Lr:{configurable:!0,
enumerable:!0,get:function(){return this.GIc}},Mqd:{configurable:!0,enumerable:!0,get:function(){return this.qO}},P4b:{configurable:!0,enumerable:!0,get:function(){return this.KF}},BDi:{configurable:!0,enumerable:!0,get:function(){return this.V5d}},Wg:{configurable:!0,enumerable:!0,get:function(){return this.k8}},wHb:{configurable:!0,enumerable:!0,get:function(){return!0}},wRf:{configurable:!0,enumerable:!0,get:function(){return!0}},X7g:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_CommentPaneEmpty1}},
Y7g:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_CommentPaneEmpty2}},wbc:{configurable:!0,enumerable:!0,get:function(){return 2===this.ff.mode||3===this.ff.mode}}});Object(Qa.a)(ea,"CommentPane",null,[7,742]);Cm(P,Hb);P.prototype.eRi=function(qa){this.XPi(qa)};P.prototype.Wuj=function(qa){this.h1f(qa)};P.prototype.M$i=function(qa){qa=this.XSg(qa);for(var tb=0;tb<this.fV.count;++tb)Array.enqueue(this.fV.oa(tb).aU,qa);this.y_(!0)};P.prototype.XSg=function(qa){var tb=new Mb;
tb.eventType=3;tb.viewContainerVisibilityState=qa;return tb};P.prototype.yoh=function(){for(var qa=this.LYg(),tb=0;tb<this.fV.count;++tb)Array.enqueue(this.fV.oa(tb).aU,qa);this.y_(!0)};P.prototype.LYg=function(){var qa=new Mb;qa.eventType=2;return qa};Object(Qa.a)(P,"ViewContainerEventHost",Hb,[899]);L.prototype.initialize=function(qa,tb,rc,kd,Td,qe,Ne,Ja,ob){this.xq=qa;this.KWd=tb;this.P$d=rc;this.e6d=void 0===kd?null:kd;this.Zae=void 0===Td?null:Td;this.e3d=void 0===qe?null:qe;this.b0d=void 0===
Ne?null:Ne;this.Pn=void 0===Ja?null:Ja;this.YTd=!0;this.jVa=void 0===ob?null:ob};L.prototype.o0g=function(){sharedComments.setWebpackPublicPath(Xa.AFrameworkApplication.bda)};L.prototype.LXh=function(qa){var tb=this;qa=void 0===qa?null:qa;var rc=void 0===rc?null:rc;if(!this.YTd)return eb.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise(function(kd,Td){Td(Ic.a.ys(-2130915313))});if(this.$Kc)return eb.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(function(){});this.GSb||(Xa.AFrameworkApplication.ha.ta("DynamicBundlesIsEnabled")?this.GSb=appResourceLoader.loadChunk("sharedComments"):this.GSb=this.xq.loadScript("sharedComments"));return this.GSb.then(function(){qa?qa():tb.o0g();tb.$Kc||(tb.jVa&&tb.jVa.execute(function(kd){kd.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),rc&&rc(),
sharedComments.instantiate(tb.KWd,tb.P$d,tb.e6d,tb.Zae,tb.e3d,tb.b0d,tb.Pn));tb.$Kc=!0})};Object(Qa.a)(L,"CommentActivationManager",null,[918]);Object(Qa.a)(Y,"LocalizationDetails",null,[]);var cc=b(525);fa.prototype.getViewContainer=function(){return this.emg};fa.prototype.registerForViewContainerEvents=function(qa){this.Ez.eRi(qa)};fa.prototype.unregisterForViewContainerEvents=function(qa){this.Ez.Wuj(qa)};Object(Qa.a)(fa,"ViewContainerProvider",null,[915]);Object(Qa.a)(T,"CommentUIAction",null,
[]);var xc=b(207),vd=b(143),Xd=b(161),Je=b(1001),ff=b(804),Ye=Je.a;Cm(N,Ye);N.getTypeName=function(){return"AugLoop_SmartReply_CommentSmartReplySignal"};N.ve=function(){return["AugLoop_Signals_Signal"]};Object(Qa.a)(N,"CommentSmartReplySignal",Je.a,[]);var Pe=b(831),wf=Pe.a;Cm(S,wf);S.getTypeName=function(){return"AugLoop_SmartReply_SmartReply"};S.ve=function(){return["AugLoop_Core_Annotation"]};Object(Qa.a)(S,"SmartReply",Pe.a,[]);var lf=b(1E3),kg=b(1108);W.prototype.Jve=function(qa,tb){return Object.assign(new kg.a,
{parentPath:["Signal",N.getTypeName()],items:[Object.assign(new lf.a,{body:Object.assign(new N,{commentId:qa,comment:tb})})]})};W.prototype.Jwd=function(qa){var tb=new hc.a;if(qa&&qa.CommentId&&qa.ResultSets&&0<qa.ResultSets.length&&qa.ResultSets[0].Documents&&0<qa.ResultSets[0].Documents.length){for(var rc=Ml(qa.ResultSets[0].Documents),kd=rc.next();!kd.done;kd=rc.next())tb.add(kd.value.Caption);0<tb.count&&this.LWd.Jwd(qa.CommentId,tb.toArray())}else eb.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")};
W.prototype.getTypeName=function(){return S.getTypeName()};Object(Qa.a)(W,"BaseCommentSmartReplyProvider",null,[787]);var Bg=b(832);Cm(H,W);H.prototype.initialize=function(){if(this.augmentationLoopManager){var qa=this.getTypeName();this.augmentationLoopManager.activateAnnotation(qa);this.augmentationLoopManager.E8(qa,Object(Cb.a)(this,this.IMh,"handleAnnotationEvent"))}};H.prototype.invoke=function(qa,tb){this.augmentationLoopManager&&this.augmentationLoopManager.NWf(Object.assign(new N,{commentId:qa,
comment:tb}))};H.prototype.IMh=function(qa,tb){(qa=tb.PX)&&Bg.a.gua(qa)===this.getTypeName()&&1===tb.operationType?this.Jwd(qa):eb.ULS.sendTraceTag(544318882,12,10,"Invalid annotation event for smart replies")};Object(Qa.a)(H,"CommentSmartReplyProvider",W,[]);C.prototype.HHh=function(){this.Pn||(eb.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.HPf());return this.Pn};C.prototype.YRe=function(){var qa=this;return new Promise(function(tb,
rc){qa.Ddb?tb(qa.ZRe()):qa.gNf().then(function(){tb(qa.ZRe())}).catch(function(kd){rc(kd)})})};C.prototype.ZRe=function(){this.Ddb||eb.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");var qa=33;this.rzc&&(qa|=2);this.K7d&&(qa|=8);this.bbe&&(qa|=16);this.ihb&&(qa|=4);this.N$d&&(qa|=64);this.Dhg&&(qa|=128);return qa};Object(Qa.a)(C,"OfficeSharedCommentsAppCapabilities",null,[743]);Cm(B,C);B.prototype.HPf=
function(){var qa=this.excelCommentManager.Dvb;this.Pn={};this.Pn.LivePersonaPicker="true";this.Pn.PersonaColor="true";this.Pn.NewCommentButton="true";this.Pn.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.$.Ba.DisabledChangeGatesInSharedComments;this.Pn.CommentsFluentUI="true";this.Pn.CommentTasks=qa.toString();this.Pn.CommentTasksFromReply=(qa&&Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:4017579_DocumentTasksCreateFromReply")).toString();this.Pn.CommentsFluentUIV2="true";this.Pn.AtMentionFloodgateSurvey=
this.$.Ba.AtMentionFloodgateSurveyEnabled.toString();this.Pn.DiscreteHostedComments="true";this.Pn.LogDraftCommentIdPair="true";this.Pn.NewModelState="true";this.Pn.NewResolvedCardDesignInWeb="true";this.Pn.HyperlinksInComments=Gd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CommentHyperlinksDataModel",!1).toString();this.Pn.HyperlinksWithDisplayText=Gd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CommentHyperlinksDataModel",!1).toString();this.Pn.NewBorderAndFocusLookInWeb=
"true";this.Pn.ExtendedDrafting="true";this.Pn.NewSelectionInteractions=be.a.ZG().toString();this.Pn.SmartReplies=Gd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",!1).toString();this.Pn.PersonaIconImageForWeb="true";this.Pn.TaskPaneWithNewInfrastructure=be.a.o8e(this.$).toString();this.Pn.LinkToComment=be.a.Y5e().toString();this.Pn.NoDiscardOnFocusLoss=be.a.W_h().toString();this.Pn.WebThemeIntegration=be.a.V7h().toString()};B.prototype.x8i=function(){this.N$d=this.excelCommentManager.Dvb;
this.bbe=!1;this.ihb=this.K7d=!0;this.gNf()};B.prototype.gNf=function(){var qa=this;return new Promise(function(tb,rc){qa.$.Acc()?(qa.rzc=!1,qa.Ddb=!0,tb(!1)):qa.Zvf?qa.Zvf.atMentionsEnabledAsync().then(function(kd){qa.rzc=kd;qa.Ddb=!0;tb(qa.Ddb)}):(eb.ULS.sendTraceTag(579392965,0,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),rc(Ic.a.ys(-2130915320)))})};B.prototype.anh=function(){var qa=this;this.YRe().then(function(tb){qa.mqb.Axj(tb)})};
Jl.Object.defineProperties(B.prototype,{yki:{configurable:!0,enumerable:!0,get:function(){return this.ihb},set:function(qa){this.ihb!==qa&&(this.ihb=qa,this.anh())}}});Object(Qa.a)(B,"ExcelSharedCommentsAppCapabilities",C,[]);Jl.Object.defineProperties(J.prototype,{contextId:{configurable:!0,enumerable:!0,get:function(){return 1}},Dzb:{configurable:!0,enumerable:!0,get:function(){return null}},qbc:{configurable:!0,enumerable:!0,get:function(){return!1}},Ubc:{configurable:!0,enumerable:!0,get:function(){return!1}},
q1c:{configurable:!0,enumerable:!0,get:function(){return this.ubg}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.jy}}});Object(Qa.a)(J,"NextOrPrevCommentContext",null,[171]);var Qf=b(529),Ug=b(58),Kf=b(141),Of=b(35),hh=b(26),Eg=b(339);Cm(z,ea);z.prototype.dispose=function(){this.$&&this.$.AH(Object(Cb.a)(this,this.kk,"onContentAreaResized"));this.k8&&this.Xg.Ca(Pc.a.click,this.k8,Object(Cb.a)(this,this.ru,"clearSelection"));this.commentTaskPane&&this.commentTaskPane.XC(Object(Cb.a)(this,
this.Wy,"onPaneVisibilityChanged"));var qa=this.hc.Wh(Nd.AFrame.Ho);qa.Kk(Ke.FocusManager.instance().j1);qa.Kk(Ke.FocusManager.instance().k1);this.fRb=this.k8=this.Fba=this.commentTaskPane=this.$=this.excelCommentManager=null;ea.prototype.dispose.call(this)};z.prototype.initialize=function(qa,tb){this.ff=qa;this.fRb=tb;qa=this.fWg();this.fRb.appendChild(qa);this.Rg();this.Xg.e6(Pc.a.click,this.fRb,Object(Cb.a)(this,this.Ric,"onParentDivClick"),null,!0);this.k8.style.display="flex";this.Kbf=new Y(Xa.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,Xa.AFrameworkApplication.uiCulture,Xa.AFrameworkApplication.dataCulture);qa=Yd.a.instance.yc("Common.App.People.IExternalPeopleAPI");this.OUh(qa)};z.prototype.OUh=function(qa){var tb=this;cc.a.uq(qa).continueWith(function(rc){tb.Fba=rc.result;Gd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartRepliesIsEnabled",!1)?(tb.q1e(tb.Fba),tb.aVh(function(kd){tb.excelCommentManager.u1e(tb.Fba,tb.yFa,kd);tb.w1e()})):(tb.q1e(tb.Fba),tb.excelCommentManager.u1e(tb.Fba,
tb.yFa,null),tb.w1e())})};z.prototype.setWebpackPublicPath=function(){Qf.a(this.$)};z.prototype.w1e=function(){var qa=this;Of.TaskExtensions.Da(Ug.GetServiceTaskFactory.Xa(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider"),function(tb){qa.Zbe.initialize(tb.result.xq,qa.excelCommentManager.s2,qa.excelCommentManager.lYf,qa.Fba,new fa(qa.excelCommentManager.bSd,qa.cSd),qa.Kbf,null,qa.yFa.HHh());qa.Zbe.LXh(Object(Cb.a)(qa,qa.setWebpackPublicPath,"setWebpackPublicPath")).then(function(){qa.gfd()})},
this.$.ea.ma,3)};z.prototype.aVh=function(qa){var tb=this;Of.TaskExtensions.Da(Ug.GetServiceTaskFactory.Xa(this.$.ea,328,327,1,"Microsoft.Office.Excel.WebUI.Client.AugmentationLoop.IAugmentationLoopManager"),function(rc){(rc=rc.result)?(eb.ULS.sendTraceTag(544318880,12,50,"ExcelSharedCommentPane::InitializeCommentSmartReplyProvider - AugmentationLoopManager instantiated."),rc=new H(tb.mqb,rc),rc.initialize(),qa(rc)):(eb.ULS.sendTraceTag(544318881,12,10,"ExcelSharedCommentPane::InitializeCommentSmartReplyProvider - Failed to instantiate AugmentationLoopManager."),
qa(null))},this.$.ma,3)};z.prototype.q1e=function(qa){this.yFa=new B(this.$,this.excelCommentManager,qa,this.mqb)};z.prototype.gfd=function(){this.L$a=!0;this.excelCommentManager.dfd();this.EOc?(this.EOc=!1,this.excelCommentManager.xI.b_(Ed.a.$5a,null,2,null,null)):this.usc?this.excelCommentManager.xI.b_(Ed.a.pbb,null,2,null,null):this.z1e();var qa=this.excelCommentManager.s2;qa&&qa.checkAtMentionCapability().then(function(kd){kd&&(kd=Yd.a.instance.yc("Common.ISystemInitiatedFeedback"))&&kd.execute(function(Td){Td.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")})});var tb=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI(),rc=Ug.GetServiceTaskFactory.Xa(this.$.ea,269,270,2,"Common.App.SafeLinks.ISafeLinksManager");Of.TaskExtensions.Da(rc,function(){tb.registerSafelinksNavigator(Object(Cb.a)(rc.result,rc.result.Tza,"tryNavigate"))},this.$.ma,3)};z.prototype.setFocus=function(){this.gnh&&this.cSd.yoh()};z.prototype.selectComment=function(){this.isVisible&&this.hc.Ij(Nd.AFrame.Ho)};z.prototype.Rg=
function(){this.Oa.$b(Ed.a.W$,Fd.a.frame,Object(Cb.a)(this,this.W$,"hideCommentPane"));this.Oa.$b(Ed.a.editComment,Fd.a.frame,Object(Cb.a)(this,this.editComment,"editComment"));this.Oa.$b(Ed.a.DPd,Fd.a.frame,Object(Cb.a)(this,this.M0f,"undoOrRedoAction"));this.Oa.$b(Ed.a.ECf,Fd.a.frame,Object(Cb.a)(this,this.M0f,"undoOrRedoAction"));this.Oa.Jf(Ed.a.kDb,Fd.a.frame,Object(Cb.a)(this,this.kDb,"queryToggleCommentPane"),96)};z.prototype.Uj=function(qa){var tb=new me.a(999391620,2,this.$.jd,30,null),rc=
{};this.$.Na.Xb(tb,(rc.event=qa.Ga,rc),qa.Ga);return!0};z.prototype.Wy=function(){this.cSd.M$i(this.commentTaskPane.isVisible?3:1);if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5015813_SyncNewCommentButtonWithRibbon")){var qa=Xd.a(this.$);qa&&(this.commentTaskPane.isVisible?qa.Utg(Object(Cb.a)(this,this.XXe,"handlePollForStateAndUpdatePerformedEvent")):qa.ZUi(Object(Cb.a)(this,this.XXe,"handlePollForStateAndUpdatePerformedEvent")))}};z.prototype.XXe=function(){var qa=vd.b(this.$).Km("-1667294294");
this.yFa.yki=qa};z.prototype.gkb=function(qa,tb,rc,kd,Td){var qe=this;this.commentTaskPane.isVisible?this.excelCommentManager.upc(Td):this.ff.model.wcd()||this.L$a||(this.EOc=!0);this.hc.Ij(Nd.AFrame.Ho);this.L$a&&(this.excelCommentManager.hasCommentAtActiveCell?Ic.a.dWa(this.taskManager,function(){qe.excelCommentManager.xI.b_(Ed.a.$5a,tb,rc,kd,Td)}):this.excelCommentManager.xI.b_(Ed.a.$5a,tb,rc,kd,Td));eb.ULS.sendTraceTag(35418884,12,50,"Comment pane opened. Source={0}. Method={1}",kd.oP,kd.DT)};
z.prototype.z6=function(qa,tb,rc,kd,Td){if(1===rc)return 32;eb.ULS.sendTraceTag(36988121,12,50,"New Comment Pane opened.");qa=this.ff.mode;if(4===qa||2===qa||3===qa)return 32;qa=null;this.$.Zb&&(qa=this.$.Zb.yi("ModelUpdate","CommentPaneRender"),qa.start());this.isVisible=!0;this.UUb&&Td?(this.excelCommentManager.upc(Td),this.UUb=!1):(this.setFocus(),this.hc.Ij(Nd.AFrame.Ho),this.excelCommentManager.hasCommentAtActiveCell&&(Td=this.excelCommentManager.OB)&&this.ff.selectComment(Td.id,1));qa&&qa.stop();
return 32};z.prototype.pbb=function(qa,tb,rc,kd,Td){return this.isVisible?this.W$(qa,tb,rc,kd,Td):this.z6(qa,tb,rc,kd,Td)};z.prototype.W$=function(qa,tb,rc){1!==rc&&(this.commentTaskPane.Rf(!1),this.isVisible=!1,this.excelCommentManager.tMh());return 32};z.prototype.fBd=function(){};z.prototype.kDb=function(){return 32};z.prototype.fWg=function(){var qa=ac.a("div",this.WWc,this.WWc);this.k8=qa;this.Oaj();return qa};z.prototype.Oaj=function(){var qa=this,tb=this.hc.Wh(Nd.AFrame.Ho);tb.parent=Nd.AFrame.HO;
tb.pQ=!0;tb.W3f=!0;this.Xg.VVa(Nd.AFrame.Ho,this.k8,tb.W3f);tb.cEa(function(){qa.setFocus()});tb.FOc(function(){2===qa.ff.mode||3===qa.ff.mode||qa.excelCommentManager.hasCommentAtActiveCell||qa.ff.ru()});this.KF.UVa(Nd.AFrame.Ho);tb.bindAction(Nc.KeyInputManager.El(Vd.a.LTd,Nc.KeyInputManager.Kre),Ed.a.DPd);tb.bindAction(Nc.KeyInputManager.El(Vd.a.KTd,Nc.KeyInputManager.Kre),Ed.a.ECf)};z.prototype.kk=function(){};z.prototype.Ric=function(){this.hc.Ij(Nd.AFrame.Ho);return!1};z.prototype.Q5e=function(qa){return!!qa&&
qa.I3a&&(new Kf.a(this.$.Aa)).vj};z.prototype.DRg=function(){var qa=new Eg.a,tb=new T(Ed.a.$5a,Fd.a.frame);tb.preCallback=Object(Cb.a)(this,this.aPg,"confirmEnableInsert");var rc=new T(Ed.a.qN,Fd.a.frame);rc.preCallback=Object(Cb.a)(this,this.Pse,"confirmCommentSelection");rc.postCallback=Object(Cb.a)(this,this.ILe,"focusSelectedCommentInPane");var kd=new T(Ed.a.jR,Fd.a.frame);kd.preCallback=Object(Cb.a)(this,this.Pse,"confirmCommentSelection");kd.postCallback=Object(Cb.a)(this,this.ILe,"focusSelectedCommentInPane");
var Td=new T(467845448,Fd.a.frame);Td.preCallback=Object(Cb.a)(this,this.$Og,"confirmEnableDelete");qa.ja(0,tb);qa.ja(1,rc);qa.ja(2,kd);qa.ja(3,Td);tb=new T(Ed.a.pbb,Fd.a.frame);tb.preCallback=Object(Cb.a)(this,this.cgj,"showHideActionPreCallback");tb.postCallback=Object(Cb.a)(this,this.bgj,"showHideActionPostCallback");qa.ja(6,tb);return qa};z.prototype.cgj=function(qa,tb,rc){return 1===rc?this.L$a?2:32:2!==rc||this.L$a?2:(this.usc=!0,32)};z.prototype.bgj=function(qa,tb,rc,kd){return this.usc&&2===
kd&&qa?(this.usc=!1,this.z1e(),32):2};z.prototype.$Og=function(qa,tb,rc){return 1===rc?this.excelCommentManager.f4()?8:this.excelCommentManager.BPh()?this.Q5e(this.excelCommentManager.OB)||this.excelCommentManager.f4()?8:32:8:2};z.prototype.aPg=function(qa,tb,rc){return 1===rc&&(qa=this.excelCommentManager.OB,(tb=(!qa||!qa.X8e)&&this.excelCommentManager.Zge(this.excelCommentManager.mode)&&!this.Q5e(qa))&&qa&&qa.isResolved&&(tb=!1),this.excelCommentManager.Jl&&this.excelCommentManager.Jl.mC||!tb)?
8:this.isVisible||1!==rc||this.L$a?2:32};z.prototype.Pse=function(qa,tb,rc){return 1!==rc&&!this.excelCommentManager.hasCommentAtActiveCell&&this.excelCommentManager.lZg&&2===rc?(tb=Object(Ue.a)(J,tb),this.excelCommentManager.g3i(qa===Ed.a.qN,tb?tb.q1c:!1),32):2};z.prototype.ILe=function(qa,tb,rc,kd){tb=(tb=Object(Ue.a)(J,rc))?tb.q1c:!1;qa&&2===kd&&tb&&(this.excelCommentManager.setFocus(!0,!1),this.hc.Ij(Nd.AFrame.Ho));return qa?32:8};z.prototype.M0f=function(qa){if(this.excelCommentManager.f4())return 2;
qa=new me.a(qa===Ed.a.DPd?-1502853784:-111689794,1,2,6,null);this.$.Na.Xb(qa);return 32};z.prototype.z1e=function(){var qa=this;Ic.a.dWa(Xa.AFrameworkApplication.$j,function(){qa.excelCommentManager.hasCommentAtActiveCell&&qa.excelCommentManager.qpc(qa.excelCommentManager.OB.id,1);Ic.a.dWa(qa.taskManager,function(){qa.setFocus();qa.hc.Zj(Nd.AFrame.Ho);qa.$.workbookContext.NavigationContentFound&&(Fc.b().aba(hh.a.Ta.we.m,Fc.a),xc.a.instance.log())})})};z.createInstance=function(qa,tb,rc,kd,Td,qe,Ne,
Ja,ob,Nb,Jc){return new z(qa,tb,rc,kd,Td,qe,Ne,Ja,ob,Nb,Jc)};Jl.Object.defineProperties(z.prototype,{WWc:{configurable:!0,enumerable:!0,get:function(){return"CommentPane"}},EOc:{configurable:!0,enumerable:!0,get:function(){return this.hUd},set:function(qa){this.hUd=qa}},gnh:{configurable:!0,enumerable:!0,get:function(){return document.getElementById(Ic.a.oSh)}}});Object(Qa.a)(z,"ExcelSharedCommentPane",ea,[750,742]);var ng=b(128);x.prototype.openView=function(){this.commentTaskPane.Rf(!0)};x.prototype.closeView=
function(){this.commentTaskPane.Rf(!1)};x.prototype.invokeModalConfirmationDialog=function(qa,tb,rc){var kd=new ng.StandardDialog;rc||(eb.ULS.sendTraceTag(36513357,12,10,"InvokeModalConfirmationDialog: No localized strings provided."),rc=new Ea.a("","","",""));kd.lc=1;kd.Dc(1,rc.confirmButton);kd.Dc(0,rc.cancelButton);kd.Hl(rc.title,rc.body,1,function(Td){1===Td?qa():tb()})};Object(Qa.a)(x,"ExcelViewContainerAPI",null,[751,752]);var eg=b(28),Yg=b(4),Ud=b(63),Tc=b(11),qg=b(7),Lg=b(20),de=b(34);Object(Qa.a)(y,
"IContentAnchorPosition",null,[]);Object(Qa.a)(A,"IViewportInfo",null,[]);Object(Qa.a)(v,"ContainerContentDescriptor",null,[]);var tg=b(333);w.prototype.dispose=function(){this.gridView&&(this.mDe(),this.gridView.Ha.Yq(Object(Cb.a)(this,this.Zg,"onBlockCacheConsistent")));this.commentTaskPane&&this.commentTaskPane.XC(Object(Cb.a)(this,this.Wy,"onPaneVisibilityChanged"));this.$&&this.$.AH(Object(Cb.a)(this,this.kk,"onContentAreaResized"));this.NY&&Nc.KeyInputManager.instance.Ca(Pc.a.Rb,this.NY,Object(Cb.a)(this,
this.Rmf,"onFloatingContainerKeyDown"));this.NY=this.ox=this.fH=this.gridView=this.$=this.excelCommentManager=null};w.prototype.dfd=function(){var qa=this;this.Jai(function(tb){tb.continueWith(function(){qa.NY=document.createElement("div");Sys.UI.DomElement.addCssClass(qa.NY,eg.a.gch);Tc.DOMElementExtensions.xo(qa.NY,Yg.a.SWa);Lg.g(qa.$).Pi.appendChild(qa.NY);qa.zge();Nc.KeyInputManager.instance.qa(Pc.a.Rb,qa.NY,Object(Cb.a)(qa,qa.Rmf,"onFloatingContainerKeyDown"));qa.fH=floatingContainerManager.FloatingContainerManagerFactoryGlobal.getIsolatedFloatingContainerManagerInstanceWithCallback(Object(Cb.a)(qa,
qa.Lri,"onFloatingContainerChangedCallback"));qa.Vvc();qa.$.zD(Object(Cb.a)(qa,qa.kk,"onContentAreaResized"));qa.gridView.Ha.Xp(Object(Cb.a)(qa,qa.Zg,"onBlockCacheConsistent"));qa.RRg();qa.fH.setFloatingContainerParentElement(qa.NY)})})};w.prototype.moh=function(){if(this.o3a){var qa=new v;qa.containerContentType=0;qa.contentId=this.aM;this.fH.focusContainer(qa)}};w.prototype.Vvc=function(){var qa=Lg.g(this.$).Pi;qa=this.tge(new Sys.UI.Bounds(qa.clientLeft,qa.clientTop,qa.clientWidth,qa.clientHeight));
qa=Object.assign(new A,{x:qa.x,y:qa.y,width:de.a(this.$).Ci(qa.width),height:de.a(this.$).Ci(qa.height)});this.fH.updateViewport(qa,this.gridView.rtl);this.dxc=!1};w.prototype.Uhc=function(){this.excelCommentManager.ILi();if(!be.a.ZG()&&this.Evb||this.o3a)eb.ULS.sendTraceTag(42563140,12,10,"Another draft is already shown");else if(this.PWa){var qa=this.excelCommentManager.model.Jr;if(qa){var tb=Bb.$7b(qa.Br.sessionType);if(void 0===tb||null===tb)eb.ULS.sendTraceTag(42563142,12,10,"Invalid comment draft");
else{this.eTf();this.ztc();var rc=!tb;tb=rc?qa.Br.draftId:qa.Hj||qa.id;if(this.yaa&&w.Fqa(this.UD,tb))this.UD=null,this.aM=tb,qa=new v,qa.containerContentType=0,qa.contentId=tb,this.fH.cancelDeleteContainerRequest(qa),Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5473527_MakeFloatingContainerStickyForNewDraft")&&this.fH.setContainerStickyState(qa,!0);else if(!this.commentTaskPane.isVisible||be.a.ZG()&&this.Evb){var kd=this.k7b(tb,this.$8c(qa));kd||(eb.ULS.sendTraceTag(42563143,12,50,"IContentAnchorPosition is null"),
kd=this.Dxh(tb));this.aM=tb;rc&&(this.ypb=qa.id);this.dxc&&this.Vvc();be.a.ZG()&&this.Wvd?(this.fH.addAndShowContainer(kd,!0),this.Wvd=!1):this.fH.addContainer(kd)}}}else eb.ULS.sendTraceTag(42563141,12,10,"InProgressComment is null")}else this.fTf=!0};w.prototype.RRg=function(){this.ox=document.createElement("div");Sys.UI.DomElement.addCssClass(this.ox,eg.a.jeh);this.NY.appendChild(this.ox);this.A1c=this.ox.clientWidth;Tc.DOMElementExtensions.setVisible(this.ox,!1);var qa=document.createElement("div");
Sys.UI.DomElement.addCssClass(qa,eg.a.keh);this.ox.appendChild(qa);qa=document.createElement("div");Sys.UI.DomElement.addCssClass(qa,eg.a.W$g);this.ox.appendChild(qa)};w.prototype.p2f=function(){if(this.mbc(Ud.d(this.$.sa))){var qa=this.excelCommentManager.model.Jr;if(qa){var tb=this.$8c(qa);qa=this.YOe(tb);tb=this.gridView.Cc(tb);if(qa&&tb&&this.gridView.vZ(tb.range)){var rc=this.gridView.rtl?qa.x:qa.x+qa.width-this.A1c,kd=0;tb.hasAutoFilter&&30>(tb.sM?tb.cell.Sub:tb.height)&&(rc=this.gridView.rtl?
rc+17:rc-17);be.a.Jm()&&this.gridView.rtl&&(kd=this.t9b.width-rc);this.ox&&de.a(this.$).ZOf(this.ox);this.ox&&(be.a.Jm()?(this.gridView.rtl?Tc.DOMElementExtensions.updatePosition(this.ox,Math.max(kd-this.A1c,this.gridView.JH),Math.max(qa.y,this.gridView.XI),!0,!0):Tc.DOMElementExtensions.updatePosition(this.ox,Math.max(rc,this.gridView.JH),Math.max(qa.y,this.gridView.XI),!0),this.ox.style.position="absolute"):Sys.UI.DomElement.setLocation(this.ox,Math.max(rc,this.gridView.JH),Math.max(qa.y,this.gridView.XI)),
Tc.DOMElementExtensions.S6(this.ox,this.gridView.rtl,eg.a.Z$g,eg.a.Y$g),Tc.DOMElementExtensions.setVisible(this.ox,!0))}else Tc.DOMElementExtensions.setVisible(this.ox,!1)}}};w.prototype.eTf=function(){this.NY&&!Tc.DOMElementExtensions.isVisible(this.ox)&&(Tc.DOMElementExtensions.setVisible(this.ox,!0),this.p2f())};w.prototype.Lpi=function(qa){Tc.DOMElementExtensions.setVisible(this.ox,!1);if(this.Evb)if(this.yaa&&this.Cua(this.UD,!1),this.ypb){var tb=new v;tb.containerContentType=0;tb.contentId=
this.aM;qa?(this.fH.deleteContainer(tb),this.gridView.K_()):(this.fH.changeContentId(tb,this.ypb),this.UD=this.ypb,this.qva=!0);this.ypb=this.aM=null;this.ztc()}else this.UD=this.aM,this.qva=!0,this.aM=null;else this.commentTaskPane.isVisible||eb.ULS.sendTraceTag(42563144,12,15,"No draft currently shown")};w.prototype.glf=function(qa){if(-1===this.gridView.ga.selectionType)if(!qa||qa.Hj)eb.ULS.sendTraceTag(42563145,12,50,"Mouseenter on an comment thread");else{if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var tb=
{};$b.b(this.$).Jd(Ce.a.iLe,(tb.Location="floatie",tb))}else $b.b(this.$).Jd(Ce.a.iLe,{});this.kTf(qa,!0,!1)}};w.prototype.Mpi=function(qa){if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var tb={};$b.b(this.$).Jd(Ce.a.jLe,(tb.Location="floatie",tb))}else $b.b(this.$).Jd(Ce.a.jLe,{});this.Cua(qa,!0)};w.prototype.Jpi=function(){be.a.ZG()&&this.Dfj();this.ETc()};w.prototype.Dfj=function(){this.mbc(Ud.d(this.$.sa))&&!this.o3a&&this.Uhc()};w.prototype.msc=function(qa,
tb){!qa||qa.Hj?eb.ULS.sendTraceTag(50340814,12,15,"Attemping to show invalid comment thread"):this.PWa?this.kTf(qa,!1,tb):this.L5b=qa.id};w.prototype.p_a=function(){this.yaa&&this.Cua(this.UD,!1)};w.prototype.L8g=function(){this.aM&&this.Cua(this.aM,!1);this.UD&&this.Cua(this.UD,!1)};w.prototype.kTf=function(qa,tb,rc){var kd=qa.id;if(this.yaa){if(tb&&this.qva||!tb&&w.Fqa(this.UD,kd)||Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5610930_DontShowDraftFloatieIfAlreadyShown")&&this.o3a&&w.Fqa(this.aM,
kd))return;w.Fqa(this.UD,kd)||this.Cua(this.UD,tb)}(qa=this.k7b(kd,qa.anchor))?(this.dxc&&this.Vvc(),tb?this.fH.requestAddContainerWithDelay(qa):this.fH.addAndShowContainer(qa,rc),tb||(this.qva=!0)):eb.ULS.sendTraceTag(42284257,12,15,"ShowFloatingCommentThread: Could not get anchor bounds")};w.prototype.Cua=function(qa,tb){if(!qa)eb.ULS.sendTraceTag(50357011,12,15,"Attempting to hide an invalid comment");else if(!tb||!this.qva){var rc=new v;rc.containerContentType=0;rc.contentId=qa;tb?this.fH.requestDeleteContainerWithDelay(rc):
this.fH.deleteContainer(rc)}};w.prototype.Jai=function(qa){Of.TaskExtensions.Da(Ug.GetServiceTaskFactory.Xa(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider"),function(tb){qa(tg.c(tb.result.xq.loadScript("floatingContainerManager")))},this.$.ea.ma,3)};w.prototype.ETc=function(){if(this.yaa){var qa=this.excelCommentManager.model.Bs(this.UD);if(!qa){eb.ULS.sendTraceTag(51495325,12,10,"currentlyShownNonDraftThreadId is null");return}(qa=this.k7b(qa.id,qa.anchor))&&this.fH.updateContainer(qa)}if(this.o3a&&
this.mbc(Ud.d(this.$.sa))){qa=this.excelCommentManager.model.Jr;if(!qa){eb.ULS.sendTraceTag(42563146,12,10,"InProgressComment is null");return}(qa=this.k7b(this.aM,this.$8c(qa)))&&this.fH.updateContainer(qa)}this.p2f()};w.prototype.$8c=function(qa){if(qa.Hj&&0<qa.Hj.length){var tb=this.excelCommentManager.model.Bs(qa.Hj);return tb?tb.anchor:qa.anchor}return qa.anchor};w.prototype.k7b=function(qa,tb){return(tb=this.YOe(tb))?this.dPe(tb,qa):null};w.prototype.dPe=function(qa,tb){var rc=new y;rc.anchorLeft=
de.a(this.$).Ci(qa.x);rc.anchorTop=de.a(this.$).Ci(qa.y);rc.anchorRight=de.a(this.$).Ci(qa.x+qa.width);rc.anchorBottom=de.a(this.$).Ci(qa.y+qa.height);rc.containerContentType=0;rc.contentId=tb;return rc};w.prototype.Dxh=function(qa){var tb=Lg.g(this.$).Pi;tb=this.tge(new Sys.UI.Bounds(this.gridView.rtl?tb.clientWidth:tb.clientLeft,tb.clientTop,0,0));return this.dPe(new Sys.UI.Bounds(tb.x,tb.y,0,0),qa)};w.prototype.YOe=function(qa){qa=this.gridView.Ax(qa)||qa;qa.isSingle||(qa=ne.A(this.gridView.hs.YPe(qa)).topRight);
qa=this.gridView.Cc(qa);if(!qa||!qa.cell.Fj)return null;qa=this.gridView.getCellBounds(qa.cell);this.t9b=Tc.DOMElementExtensions.getBoundingClientRect(this.gridView.Pi);return new Sys.UI.Bounds(qa.x-this.t9b.x,qa.y-this.t9b.y,qa.width,qa.height)};w.prototype.tge=function(qa){if(!Ud.b(this.$.sa))return qa;var tb=this.gridView.rtl?qa.x:qa.x+this.gridView.JH,rc=qa.y+this.gridView.XI;return Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5198843_FloatingCommentHeaderDimensions")?new Sys.UI.Bounds(tb,rc,
qa.width-this.gridView.JH,qa.height-this.gridView.XI):new Sys.UI.Bounds(tb,rc,this.gridView.rtl?qa.width-this.gridView.JH:qa.width,qa.height)};w.prototype.Zg=function(){this.N3f()};w.prototype.buf=function(){this.ETc()};w.prototype.kk=function(){this.N3f();this.zge()};w.prototype.zge=function(){de.a(this.$).Mqc(this.NY)};w.prototype.N3f=function(){this.Evb||this.yaa?(this.Vvc(),this.ETc()):this.dxc=!0};w.prototype.Rmf=function(qa){return qa.Ga.keyCode===Vd.a.LK&&this.yaa?(this.Cua(this.UD,!1),this.gridView.K_(),
!0):!1};w.prototype.Pnf=function(qa,tb){this.yaa&&this.qva&&(this.Cua(this.UD,!1),!tb.qo&&Tc.DOMElementExtensions.rQe(tb.Wb,eg.a.X$g,!0)&&(qa=this.ovh(tb.clientPoint),qa=this.excelCommentManager.qIa(qa),this.glf(qa)))};w.prototype.ovh=function(qa){qa=this.gridView.X6b(qa).lFa;return this.gridView.kc.M3a(qa)?this.gridView.Ax(qa):qa};w.prototype.Wy=function(){this.commentTaskPane.isVisible||!this.excelCommentManager.model.Jr||this.Evb||this.Uhc()};w.prototype.Lri=function(qa){var tb=qa.contentId;switch(qa.containerChangeType){case 0:this.Ori(tb);
break;case 1:this.Mri(tb);break;case 2:w.Fqa(tb,this.aM)?this.p_a():this.yaa&&(this.qva=!0);break;case 3:this.Nri()}};w.prototype.Ori=function(qa){w.Fqa(qa,this.aM)?this.yPb=!0:(this.UD=qa,this.ztc())};w.prototype.Mri=function(qa){w.Fqa(qa,this.aM)?this.yPb=!1:w.Fqa(qa,this.UD)?(this.UD=null,this.ztc()):eb.ULS.sendTraceTag(50377756,12,15,"A comment has been hidden that we're not currently tracking as being shown")};w.prototype.Nri=function(){this.HUd=!0;this.fTf&&this.Uhc();if(this.L5b){var qa=this.excelCommentManager.model.Bs(this.L5b);
qa?(this.msc(qa,!0),this.L5b=null):eb.ULS.sendTraceTag(595141731,12,15,"Comment not found")}};w.prototype.ro=function(qa,tb){tb.sa!==tb.lK&&(be.a.ZG()?this.L8g():this.p_a(),Tc.DOMElementExtensions.setVisible(this.ox,!1))};w.prototype.Ii=function(qa,tb){(qa=Object(Ue.a)(Rd.a,tb.sa))&&this.mbc(qa.sheetId)&&this.eTf()};w.prototype.mbc=function(qa){var tb=Object(Ue.a)(b(855).ExcelCommentManager,this.excelCommentManager);return!tb||!tb.Ae.Jr||""!==tb.Ae.eU&&tb.Ae.eU!==qa?!1:!0};w.prototype.ztc=function(){this.yaa||
this.excelCommentManager.model.Jr?this.l9g():this.mDe()};w.prototype.l9g=function(){this.OWb||(this.gridView.view.nt(Object(Cb.a)(this,this.buf,"onVisibleGridAreaChanged")),this.$.Aa.rL(Object(Cb.a)(this,this.ro,"onActiveItemChanging")),this.$.Aa.Vf(Object(Cb.a)(this,this.Ii,"onActiveSheetChanged")),this.OWb=!0)};w.prototype.mDe=function(){this.OWb&&(this.gridView.view.Tr(Object(Cb.a)(this,this.buf,"onVisibleGridAreaChanged")),this.$.Aa.yH(Object(Cb.a)(this,this.ro,"onActiveItemChanging")),this.$.Aa.wg(Object(Cb.a)(this,
this.Ii,"onActiveSheetChanged")),this.OWb=!1)};w.Fqa=function(qa,tb){return qg.a.equals(qa,tb,!0)};Jl.Object.defineProperties(w.prototype,{PWa:{configurable:!0,enumerable:!0,get:function(){return this.HUd}},yaa:{configurable:!0,enumerable:!0,get:function(){return!!this.UD}},aM:{configurable:!0,enumerable:!0,get:function(){return this.DZd},set:function(qa){this.DZd=qa;this.o3a=!!qa}},Evb:{configurable:!0,enumerable:!0,get:function(){return!!this.aM}},o3a:{configurable:!0,enumerable:!0,get:function(){return this.yPb},
set:function(qa){this.yPb=qa}},qva:{configurable:!0,enumerable:!0,get:function(){return this.hgb},set:function(qa){!this.hgb&&qa?(this.hgb=!0,this.gridView.ga.mWa(Object(Cb.a)(this,this.Pnf,"onGridPointerDown"))):this.hgb&&!qa&&(this.hgb=!1,this.gridView.ga.e9a(Object(Cb.a)(this,this.Pnf,"onGridPointerDown")))}},UD:{configurable:!0,enumerable:!0,get:function(){return this.pXd},set:function(qa){this.pXd=qa;qa||(this.qva=!1)}}});Object(Qa.a)(w,"FloatingCommentManager",null,[7]);var ve=b(907),tf=b(32),
lg=b(40),Og=b(167),Fa=b(276),lb=b(227),pc=b(281),qc=b(204),Md=b(59),Pd=Sys.EventArgs;Cm(u,Pd);Object(Qa.a)(u,"DismissFloatingNoteEventArgs",Sys.EventArgs,[]);var ee=b(946),xf=b(104),Se=b(68),cf=b(460),dh=lb.a;Cm(k,dh);k.prototype.sVb=function(qa){this.addHandler("DismissFloatingNote",qa)};k.prototype.anc=function(qa){this.removeHandler("DismissFloatingNote",qa)};k.prototype.Ckb=function(qa){this.addHandler("OnFloatingNoteMouseEnter",qa)};k.prototype.jnc=function(qa){this.removeHandler("OnFloatingNoteMouseEnter",
qa)};k.prototype.Dkb=function(qa){this.addHandler("OnFloatingNoteMouseLeave",qa)};k.prototype.knc=function(qa){this.removeHandler("OnFloatingNoteMouseLeave",qa)};k.prototype.BPc=function(qa){this.addHandler("OnFloatingNotePointerDown",qa)};k.prototype.kCd=function(qa){this.removeHandler("OnFloatingNotePointerDown",qa)};k.prototype.Itg=function(qa){this.addHandler("OnFloatingNoteTextInput",qa)};k.prototype.QUi=function(qa){this.removeHandler("OnFloatingNoteTextInput",qa)};k.prototype.Jtg=function(qa){this.addHandler("OnFloatingNoteTextScrolled",
qa)};k.prototype.RUi=function(qa){this.removeHandler("OnFloatingNoteTextScrolled",qa)};k.prototype.Ctg=function(qa){this.addHandler("OnFloatingNoteResized",qa)};k.prototype.KUi=function(qa){this.removeHandler("OnFloatingNoteResized",qa)};k.prototype.zVb=function(qa){this.addHandler("OnFloatingNoteTextEdited",qa)};k.prototype.lnc=function(qa){this.removeHandler("OnFloatingNoteTextEdited",qa)};k.prototype.wtg=function(qa){this.addHandler("OnFloatingNoteGotFocus",qa)};k.prototype.IUi=function(qa){this.removeHandler("OnFloatingNoteGotFocus",
qa)};k.prototype.dispose=function(){this.Vqb&&(this.Vqb.JUi(Object(Cb.a)(this,this.Pmf,"onFloatieContainerResizeRequested")),this.Vqb.dispose(),this.Vqb=null);this.Bl&&(this.EA&&(lg.a.rla(this.EA),this.CNd.ZB(),Ma.a.rc([this.CNd]),this.Bl.removeChild(this.EA)),lg.a.rla(this.Bl),this.tc.ZB(),Tc.DOMElementExtensions.rg(this.Bl));this.gridView=this.khb=null;dh.prototype.dispose.call(this)};k.prototype.focus=function(){if(this.EA){if(this.EA.value){var qa=this.EA.value.length;cf.a(this.EA,qa,qa)}Tc.DOMElementExtensions.setFocus(this.EA,
!1)}};k.prototype.QGb=function(qa){var tb=this;this.gridView.q0(qa)?(qa=this.gridView.Ax(qa)||qa,qa=this.gridView.Mg(qa,this.Wg.paneType,void 0,void 0,!Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5694393_FixNextOrPreviousNoteGotoBug"))||Md.a.g3,Tc.DOMElementExtensions.updatePosition(this.Bl,qa.bottomRight.x,qa.topLeft.y,!0,this.gridView.rtl)):this.qfc&&(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?this.qfc(function(){var rc={};return rc.PaneType=tb.Wg.paneType.toString(),
rc.Location="floatie",rc}):this.qfc(function(){var rc={};return rc.PaneType=tb.Wg.paneType.toString(),rc}))};k.prototype.yRa=function(qa){this.oMa!==qa&&(this.EA.value=qa)};k.prototype.OQd=function(qa){this.Mhf!==qa&&(this.EA.scrollTop=qa)};k.prototype.Dyj=function(qa){qa=new ee.a(qa.width,qa.height,!1,!1);this.RDd(qa)};k.prototype.RDd=function(qa){var tb=this;if(qa.height!==this.Bl.clientHeight||qa.width!==this.Bl.clientWidth)qa.height=Math.max(qa.height,30),qa.width=Math.max(qa.width,30),this.gridView.rtl&&
Sys.UI.DomElement.setLocation(this.Bl,this.Bl.offsetLeft-(qa.width-this.Bl.clientWidth),this.Bl.offsetTop),Tc.DOMElementExtensions.wF(this.Bl,qa.height),Tc.DOMElementExtensions.vq(this.Bl,qa.width),this.Yja&&(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?this.Yja(function(){var rc={};return rc.IsRTL=tb.gridView.rtl,rc.Location="floatie",rc}):this.Yja(function(){var rc={};return rc.IsRTL=tb.gridView.rtl,rc}))};k.prototype.setActive=function(){Sys.UI.DomElement.addCssClass(this.Bl,
eg.a.A3c)};k.prototype.FOf=function(){Sys.UI.DomElement.removeCssClass(this.Bl,eg.a.A3c)};k.prototype.pQi=function(){Og.a.instance.qa(Pc.a.AV,this.Bl,Object(Cb.a)(this,this.mwi,"onNoteMouseEnter"));Og.a.instance.qa(Pc.a.$y,this.Bl,Object(Cb.a)(this,this.nwi,"onNoteMouseLeave"));Og.a.instance.qa(Pc.a.pointerDown,this.Bl,Object(Cb.a)(this,this.owi,"onNotePointerDown"));Fa.a.instance.qa(Pc.a.click,this.domElement,Object(Cb.a)(this,this.jwi,"onNoteClick"));Fa.a.instance.qa(Pc.a.Dj,this.domElement,Object(Cb.a)(this,
this.kwi,"onNoteDoubleClick"));this.tc.la("contextmenu",function(qa){Se.g(qa,!1)});this.CNd.la("blur",Object(Cb.a)(this,this.pwi,"onNoteTextElementBlur"));this.tc.la("blur",Object(Cb.a)(this,this.Kri,"onFloatieContainerElementBlur"));lg.a.addHandler(this.EA,Pc.a.scroll,Object(Cb.a)(this,this.twi,"onNoteTextScrolled"));lg.a.addHandler(this.EA,Pc.a.focus,Object(Cb.a)(this,this.qwi,"onNoteTextElementFocused"))};k.prototype.JAd=function(){Nc.KeyInputManager.instance.qa(Pc.a.Rb,this.EA,Object(Cb.a)(this,
this.lli,"noteTextElement_OnKeyDown"));Nc.KeyInputManager.instance.qa(Pc.a.Rb,this.Bl,Object(Cb.a)(this,this.Dnh,"floatieContainerElement_OnKeyDown"));lg.a.addHandler(this.EA,Pc.a.input,Object(Cb.a)(this,this.rwi,"onNoteTextElementInput"));lg.a.addHandler(this.EA,Pc.a.RFd,Object(Cb.a)(this,this.swi,"onNoteTextElementSelectStart"))};k.prototype.Pmf=function(qa,tb){this.RDd(tb);Tc.DOMElementExtensions.eo(this.Bl)!==this.Bl&&Tc.DOMElementExtensions.setFocus(this.Bl,!0);this.raiseEvent("OnFloatingNoteResized",
tb)};k.prototype.mwi=function(){this.raiseEvent("OnFloatingNoteMouseEnter");return!0};k.prototype.nwi=function(){this.raiseEvent("OnFloatingNoteMouseLeave");return!0};k.prototype.owi=function(qa){this.gridView.ga.Sa.jG(null);Se.g(qa.Ga,!1);this.raiseEvent("OnFloatingNotePointerDown");return!1};k.prototype.jwi=function(qa){this.gridView.ga.Sa.jG(null);Se.g(qa.Ga,!1);return!1};k.prototype.kwi=function(qa){Se.g(qa.Ga,!1);return!1};k.prototype.lli=function(qa){if(qa.Ga.keyCode===Vd.a.LK||qa.Ga.keyCode===
Vd.a.hB)return Tc.DOMElementExtensions.setFocus(this.Bl,!0),!0;!qa.Ga.shiftKey||qa.Ga.keyCode!==Vd.a.lAa&&qa.Ga.keyCode!==Vd.a.scb&&qa.Ga.keyCode!==Vd.a.YKb&&qa.Ga.keyCode!==Vd.a.jAa||qa.Ga.stopPropagation();return!1};k.prototype.Dnh=function(qa){return qa.Ga.keyCode===Vd.a.LK?(this.gridView.focus(),!0):qa.Ga.keyCode===Vd.a.hB?(Tc.DOMElementExtensions.setFocus(this.EA),!0):!1};k.prototype.pwi=function(qa){this.Lid&&(this.raiseEvent("OnFloatingNoteTextEdited"),this.Lid=!1);this.lAf(qa.rawEvent)};k.prototype.Kri=
function(qa){this.lAf(qa.rawEvent)};k.prototype.twi=function(){this.raiseEvent("OnFloatingNoteTextScrolled")};k.prototype.rwi=function(){this.Lid=!0;this.raiseEvent("OnFloatingNoteTextInput")};k.prototype.swi=function(qa){qa.stopPropagation()};k.prototype.qwi=function(){this.setActive();this.raiseEvent("OnFloatingNoteGotFocus");this.zWe=xf.toTimestamp(new Date).m};k.prototype.lAf=function(qa){if(!this.Bl.contains(qa.relatedTarget)){if(50>xf.toTimestamp(new Date).m-this.zWe)if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var tb=
{};$b.b(this.gridView.$).Jd(Ce.a.kLe,(tb.Location="floatie",tb.callstack=Error().stack,tb),void 0,!0)}else tb={},$b.b(this.gridView.$).Jd(Ce.a.kLe,(tb.callstack=Error().stack,tb),void 0,!0);this.FOf();this.raiseEvent("DismissFloatingNote",new u(qa.relatedTarget))}};Jl.Object.defineProperties(k.prototype,{jba:{configurable:!0,enumerable:!0,get:function(){return this.khb}},oMa:{configurable:!0,enumerable:!0,get:function(){return this.EA.value}},Mhf:{configurable:!0,enumerable:!0,get:function(){return this.EA.scrollTop}},
r3a:{configurable:!0,enumerable:!0,get:function(){return!!this.EA&&Tc.DOMElementExtensions.eo(this.Bl)===this.EA}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Wg.paneType}},dimensions:{configurable:!0,enumerable:!0,get:function(){return new Sys.UI.Bounds(0,0,this.Bl.clientWidth,this.Bl.clientHeight)}},Bl:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},EA:{configurable:!0,enumerable:!0,get:function(){return this.Bl?this.Bl.firstChild:null}}});Object(Qa.a)(k,
"FloatingNoteControl",lb.a,[774,7]);t.w0h=function(qa){return qa.height===t.c0c.height&&qa.width===t.c0c.width};t.c0c=new Sys.UI.Bounds(0,0,210,150);Object(Qa.a)(t,"FloatingNoteState",null,[]);var df=b(109),Uf=lb.a;Cm(r,Uf);r.prototype.sVb=function(qa){this.addHandler("DismissFloatingNote",qa)};r.prototype.anc=function(qa){this.removeHandler("DismissFloatingNote",qa)};r.prototype.Ckb=function(qa){this.addHandler("OnFloatingNoteMouseEnter",qa)};r.prototype.jnc=function(qa){this.removeHandler("OnFloatingNoteMouseEnter",
qa)};r.prototype.Dkb=function(qa){this.addHandler("OnFloatingNoteMouseLeave",qa)};r.prototype.knc=function(qa){this.removeHandler("OnFloatingNoteMouseLeave",qa)};r.prototype.BPc=function(qa){this.addHandler("OnFloatingNotePointerDown",qa)};r.prototype.kCd=function(qa){this.removeHandler("OnFloatingNotePointerDown",qa)};r.prototype.zVb=function(qa){this.addHandler("OnFloatingNoteTextEdited",qa)};r.prototype.lnc=function(qa){this.removeHandler("OnFloatingNoteTextEdited",qa)};r.prototype.dispose=function(){var qa=
this;tf.a.forEach(this.Np.Lu,function(tb){tb=tb.value;tb.QUi(Object(Cb.a)(qa,qa.Pkf,"onChildFloatingNoteControlTextInput"));tb.RUi(Object(Cb.a)(qa,qa.Qkf,"onChildFloatingNoteControlTextScrolled"));tb.anc(Object(Cb.a)(qa,qa.Ikf,"onChildFloatingNoteControlDismissed"));tb.jnc(Object(Cb.a)(qa,qa.Kkf,"onChildFloatingNoteControlMouseEnter"));tb.knc(Object(Cb.a)(qa,qa.Lkf,"onChildFloatingNoteControlMouseLeave"));tb.kCd(Object(Cb.a)(qa,qa.Mkf,"onChildFloatingNoteControlPointerDown"));tb.KUi(Object(Cb.a)(qa,
qa.Nkf,"onChildFloatingNoteControlResized"));tb.lnc(Object(Cb.a)(qa,qa.Okf,"onChildFloatingNoteControlTextEdited"));tb.IUi(Object(Cb.a)(qa,qa.Jkf,"onChildFloatingNoteControlGotFocus"));tb.dispose()});this.khb=null;Uf.prototype.dispose.call(this)};r.prototype.focus=function(){this.Np.Xf(0).focus()};r.prototype.QGb=function(qa){tf.a.forEach(this.Np.Lu,function(tb){tb.value.QGb(qa)})};r.prototype.yRa=function(qa){tf.a.forEach(this.Np.Lu,function(tb){tb.value.yRa(qa)})};r.prototype.OQd=function(qa){tf.a.forEach(this.Np.Lu,
function(tb){tb.value.OQd(qa)})};r.prototype.ZUh=function(qa,tb,rc,kd,Td){qa=new k(qa,tb,this.behaviorsFactory,rc,kd,Td);this.Np.add(Td.toString(),qa);qa.Itg(Object(Cb.a)(this,this.Pkf,"onChildFloatingNoteControlTextInput"));qa.Jtg(Object(Cb.a)(this,this.Qkf,"onChildFloatingNoteControlTextScrolled"));qa.sVb(Object(Cb.a)(this,this.Ikf,"onChildFloatingNoteControlDismissed"));qa.Ckb(Object(Cb.a)(this,this.Kkf,"onChildFloatingNoteControlMouseEnter"));qa.Dkb(Object(Cb.a)(this,this.Lkf,"onChildFloatingNoteControlMouseLeave"));
qa.BPc(Object(Cb.a)(this,this.Mkf,"onChildFloatingNoteControlPointerDown"));qa.Ctg(Object(Cb.a)(this,this.Nkf,"onChildFloatingNoteControlResized"));qa.zVb(Object(Cb.a)(this,this.Okf,"onChildFloatingNoteControlTextEdited"));qa.wtg(Object(Cb.a)(this,this.Jkf,"onChildFloatingNoteControlGotFocus"))};r.prototype.Pkf=function(qa){this.yRa(qa.oMa)};r.prototype.Qkf=function(qa){this.OQd(qa.Mhf)};r.prototype.Ikf=function(qa,tb){df.b(this.Np.values,function(rc){return rc.domElement.contains(tb.soh)})||(tf.a.forEach(this.Np.Lu,
function(rc){rc.value.FOf()}),this.raiseEvent("DismissFloatingNote"))};r.prototype.Kkf=function(){this.raiseEvent("OnFloatingNoteMouseEnter")};r.prototype.Lkf=function(){this.raiseEvent("OnFloatingNoteMouseLeave")};r.prototype.Mkf=function(){this.raiseEvent("OnFloatingNotePointerDown")};r.prototype.Nkf=function(qa,tb){var rc=qa.paneType;tf.a.forEach(this.Np.Lu,function(kd){kd=Object(Ue.a)(k,kd.value);kd.paneType!==rc&&kd.RDd(tb)})};r.prototype.Okf=function(){this.raiseEvent("OnFloatingNoteTextEdited")};
r.prototype.Jkf=function(){tf.a.forEach(this.Np.Lu,function(qa){qa.value.setActive()})};Jl.Object.defineProperties(r.prototype,{Np:{configurable:!0,enumerable:!0,get:function(){return this.fmg}},jba:{configurable:!0,enumerable:!0,get:function(){return this.khb}},oMa:{configurable:!0,enumerable:!0,get:function(){return this.Np.Xf(0).oMa}},r3a:{configurable:!0,enumerable:!0,get:function(){return df.b(this.Np.values,function(qa){return qa.r3a})}},dimensions:{configurable:!0,enumerable:!0,get:function(){return this.Np.Xf(0).dimensions}}});
Object(Qa.a)(r,"MultiPanesFloatingNoteControl",lb.a,[774,7]);var bf=b(44),If=b(42),vf=b(106);m.prototype.dispose=function(){this.gridView&&(this.gridView.$Q(Object(Cb.a)(this,this.Ks,"onAfterAllBlocksUpdated")),this.gridView.$&&(this.gridView.$.Xo(Object(Cb.a)(this,this.Yd,"onWorkbookClosing")),this.gridView.$.Aa.yH(Object(Cb.a)(this,this.Kwa,"onActiveSheetChanging")),this.gridView.$.Aa.X8a(Object(Cb.a)(this,this.enf,"onFreezeUnfreezePanesChanged")),this.gridView.$.Aa.cCd(Object(Cb.a)(this,this.tjf,
"onActiveSheetLockChanged")),this.gridView.$.Aa.lFf(Object(Cb.a)(this,this.sjf,"onActiveSheetDirectionChanged")),this.gridView.$.AH(Object(Cb.a)(this,this.kk,"onContentAreaResized"))));this.CJb=this.Lx=this.ga=this.gridView=null;this.e6a&&(this.e6a.dispose(),this.e6a=null);this.ska&&(this.ska.dispose(),this.ska=null);this.k$b();this.p6d=null};m.prototype.R3a=function(qa){return!!qa&&!!this.gridView.q0(qa.anchor)};m.prototype.zcc=function(qa){if(!qa)return!0;qa=qa.anchor;qa=this.gridView.Ax(qa)||qa;
return this.gridView.hs.mj(qa)};m.prototype.FEh=function(qa){return this.yV.getItem(qa)};m.prototype.v9c=function(qa){return this.M5b.getItem(qa)};m.prototype.vwe=function(qa,tb,rc){rc=void 0===rc?!1:rc;if(rc===this.pCa&&t.w0h(tb))this.M5b.remove(qa);else{var kd=this.v9c(qa);kd||(kd=new t,this.M5b.add(qa,kd));kd.dimensions=tb;kd.Lcc=rc}};m.prototype.K1f=function(qa){this.M5b.forEach(function(tb){tb.value.Lcc=qa})};m.prototype.u1f=function(){this.nE.jnc(Object(Cb.a)(this,this.$nf,"onHoveredFloatingNoteMouseEnter"));
this.nE.knc(Object(Cb.a)(this,this.aof,"onHoveredFloatingNoteMouseLeave"));this.nE.kCd(Object(Cb.a)(this,this.bof,"onHoveredFloatingNoteOnPointerDown"));this.nE.anc(Object(Cb.a)(this,this.Znf,"onHoveredFloatingNoteDismiss"))};m.prototype.D0c=function(){this.nE&&(this.u1f(),this.nE.dispose(),this.nE=null)};m.prototype.dpb=function(){this.fv&&(this.dse(this.fv),this.fv.anc(Object(Cb.a)(this,this.Vsf,"onSoftPinnedFloatingNoteDismiss")),this.fv.lnc(Object(Cb.a)(this,this.iic,"onFloatingNoteTextEdited")),
this.vwe(this.fv.jba,this.fv.dimensions),this.fv.dispose(),this.fv=null)};m.prototype.E0c=function(qa,tb){tb=void 0===tb?!1:tb;var rc=this.yV.getItem(qa);rc&&(this.Lx.Y2f(rc.jba,rc.oMa),rc.lnc(Object(Cb.a)(this,this.iic,"onFloatingNoteTextEdited")),this.vwe(rc.jba,rc.dimensions,!tb),rc.dispose(),this.yV.remove(qa),this.gridView.focus())};m.prototype.k$b=function(qa){var tb=this;qa=void 0===qa?!1:qa;this.D0c();this.dpb();this.yV.forEach(function(rc){tb.E0c(m.ySe(rc),qa)})};m.prototype.aPi=function(){var qa=
this;this.yV.forEach(function(tb){qa.hAd(m.Gzh(tb),function(){qa.E0c(m.ySe(tb))})})};m.prototype.eAd=function(){this.hba?this.fv.QGb(this.hba.anchor):this.hAd(this.fv,Object(Cb.a)(this,this.dpb,"destroySoftPinnedFloatingNote"));this.aPi();this.hAd(this.nE,Object(Cb.a)(this,this.r$b,"hideHoveredNoteImmediately"));this.hBf();this.tCb&&this.$1c(this.tCb)};m.prototype.Fli=function(){this.eAd()};m.prototype.vZc=function(){this.gridView.hs.mj(this.ga.ya.activeCell)||(this.hba=ve.a.PVg(this.wUb,this.excelCommentManager),
this.dxd(this.hba),$b.b(this.gridView.$).Jd(Ce.a.vZc,this.Dn(),void 0,!0))};m.prototype.p3b=function(){this.R3a(this.aK)?this.zcc(this.aK)||(this.yV.tb(this.aK.id)?this.FEh(this.aK.id).focus():this.dxd(this.aK),$b.b(this.gridView.$).Jd(Ce.a.p3b,this.Dn(),void 0,!0)):this.$1c(ne.v(this.aK.anchor,this.gridView.$))};m.prototype.x0c=function(){this.Lx.x0c(this.ga.ya)};m.prototype.Bmh=function(qa){this.dpb();this.Lx.Cmh(qa,this.wUb,Object(Cb.a)(this,this.$1c,"editNoteAtRange"));$b.b(this.gridView.$).Jd(Ce.a.Q5c,
this.Dn(),void 0,!0)};m.prototype.$1c=function(qa){var tb=this,rc=this.gridView.$.sa.sheetName!==qa.SheetName,kd=Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5694393_FixNextOrPreviousNoteGotoBug"),Td=ne.D(qa);this.gridView.ui(qa,Td,kd?Td:this.wUb,null,kd?0:60,vf.a.Q5c,void 0,void 0,void 0,void 0,!0);rc||this.Daa||!this.mC||!this.R3a(this.aK)?($b.b(this.gridView.$).Jd(Ce.a.Amh,this.Dn(),void 0,!0),this.tCb=qa,this.Fnd&&Ma.a.Ia(this.Fnd),this.Fnd=bf.a.instance.create(function(){if(tb.tCb)if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var qe=
{};$b.b(tb.gridView.$).Jd(Ce.a.uKe,(qe.isDifferentSheet=rc,qe.isRecreatingInstancesRequired=tb.Daa,qe.HasNoteAtActiveCell=tb.mC,qe.IsNoteInLoadedRange=tb.R3a(tb.aK),qe.Location="floatie",qe),void 0,!0)}else qe={},$b.b(tb.gridView.$).Jd(Ce.a.uKe,(qe.isDifferentSheet=rc,qe.isRecreatingInstancesRequired=tb.Daa,qe.HasNoteAtActiveCell=tb.mC,qe.IsNoteInLoadedRange=tb.R3a(tb.aK),qe),void 0,!0)},1500,If.a.jli,!0,!0)):(this.p3b(),this.tCb=null)};m.prototype.Sgj=function(){var qa=b(855).ExcelCommentManager;
if(!this.mC)eb.ULS.sendTraceTag(592541398,12,10,"Show/Hide Note button is expected to be disabled when no note at active cell");else if(!this.zcc(this.aK)){this.Nne();this.dpb();var tb=this.aK;this.yV.tb(tb.id)?(this.E0c(tb.id,!0),$b.b(this.gridView.$).Jd(Ce.a.cRh,this.Dn(),void 0,!0)):(this.Hxf(this.aK),$b.b(this.gridView.$).Jd(Ce.a.qPh,this.Dn(),void 0,!0));this.gridView.focus();qa.iLf(this.yV.tb(tb.id)?841:842,this.gridView.$)}};m.prototype.showOrHideAllNotes=function(){var qa=b(855).ExcelCommentManager;
(this.pCa=!this.pCa)?(this.K1f(!0),this.hBf(),$b.b(this.gridView.$).Jd(Ce.a.Xej,this.Dn(),void 0,!0)):(this.k$b(!0),this.K1f(!1),$b.b(this.gridView.$).Jd(Ce.a.Wej,this.Dn(),void 0,!0));this.gridView.$.If();this.gridView.focus();qa.iLf(this.pCa?839:840,this.gridView.$)};m.prototype.AQg=function(){this.mC?(new Oc(this.gridView.$,this.excelCommentManager,this.aK.id,null),$b.b(this.gridView.$).Jd(Ce.a.convertNote,this.Dn(),void 0,!0)):eb.ULS.sendTraceTag(574739536,12,10,"Convert Note button is expected to be disabled when no note at active cell")};
m.prototype.iwi=function(qa,tb){(tb=this.Lx.w8b(tb))?this.yV.tb(tb.id)||this.fv||(qa?this.Wtd(tb):this.Nic()):eb.ULS.sendTraceTag(592541397,12,50,"ECM.OnNoteCellHoverChange: Mouse hover triggered for null comment at cell with notch. Comments might not have been loaded yet.")};m.prototype.Wtd=function(qa){var tb=this;if(this.Yvb){if(qa.id===this.nE.jba){this.EYb();return}this.CJb=qa.id}$b.b(this.gridView.$).Jd(Ce.a.Wtd,this.Dn());this.e6a=bf.a.instance.create(function(){tb.pKd(qa);tb.CJb=null},200,
If.a.kli,!0,!1)};m.prototype.Nic=function(){var qa=this;this.CJb?this.Yvb&&this.CJb===this.nE.jba?this.iUc():($b.b(this.gridView.$).Jd(Ce.a.Nic,this.Dn()),this.ska=bf.a.instance.create(function(){qa.r$b()},250,If.a.Lhf,!0,!1)):this.Yvb?($b.b(this.gridView.$).Jd(Ce.a.Nic,this.Dn()),this.ska=bf.a.instance.create(function(){qa.r$b()},250,If.a.Lhf,!0,!1)):this.iUc()};m.prototype.pKd=function(qa){this.Yvb&&(this.D0c(),this.EYb());this.QHi(qa);$b.b(this.gridView.$).Jd(Ce.a.pKd,this.Dn(),void 0,!0)};m.prototype.r$b=
function(){this.Yvb&&this.D0c()};m.prototype.Nne=function(){this.EYb();this.iUc()};m.prototype.EYb=function(){this.ska&&this.ska.cancel()};m.prototype.iUc=function(){this.e6a&&this.e6a.cancel()};m.prototype.$nf=function(){this.EYb()};m.prototype.aof=function(){this.ska&&this.ska.Zq()};m.prototype.bof=function(){this.nrj()};m.prototype.Znf=function(){this.r$b()};m.prototype.Vsf=function(){this.dpb()};m.prototype.iic=function(qa){this.dse(qa)};m.prototype.nrj=function(){this.u1f();this.fv=this.nE;this.nE=
null;this.QWf();$b.b(this.gridView.$).Jd(Ce.a.tjj,this.Dn(),void 0,!0)};m.prototype.QWf=function(){this.fv.sVb(Object(Cb.a)(this,this.Vsf,"onSoftPinnedFloatingNoteDismiss"));this.fv.zVb(Object(Cb.a)(this,this.iic,"onFloatingNoteTextEdited"))};m.prototype.QHi=function(qa){this.nE=this.WYc(qa);this.nE.Ckb(Object(Cb.a)(this,this.$nf,"onHoveredFloatingNoteMouseEnter"));this.nE.Dkb(Object(Cb.a)(this,this.aof,"onHoveredFloatingNoteMouseLeave"));this.nE.BPc(Object(Cb.a)(this,this.bof,"onHoveredFloatingNoteOnPointerDown"));
this.nE.sVb(Object(Cb.a)(this,this.Znf,"onHoveredFloatingNoteDismiss"))};m.prototype.dxd=function(qa){eb.ULS.shipAssertTag(572560404,12,!this.fv,"Should not have two soft pinned floaties on the grid.");this.fv=this.WYc(qa);this.QWf();this.fv.focus()};m.prototype.Hxf=function(qa){var tb=this.WYc(qa);tb.zVb(Object(Cb.a)(this,this.iic,"onFloatingNoteTextEdited"));this.yV.add(qa.id,tb)};m.prototype.WYc=function(qa){var tb=this;eb.ULS.shipAssertTag(572289239,12,!this.yV.tb(qa.id)&&(!this.fv||this.fv.jba!==
qa.id),"Should not have more than one floating note with the same ID.");var rc=this.v9c(qa.id);rc=rc?rc.dimensions:null;return this.gridView.$a.lj?(this.Cnd&&this.Cnd(function(){return tb.Dn()}),new r(this.gridView.$,qa,this.behaviorsFactory,rc,!!this.hba)):new k(this.gridView.$,qa,this.behaviorsFactory,rc,!!this.hba)};m.prototype.hAd=function(qa,tb){if(qa){var rc=this.Lx.t$c(qa.jba);rc&&this.R3a(rc)&&!this.zcc(rc)?(qa.QGb(rc.anchor),qa.r3a||qa.yRa(rc.text.toString())):tb()}};m.prototype.dse=function(qa){this.hba?
(this.hba.text=[qa.oMa],this.Lx.KVg(this.hba),this.hba=null):this.Lx.Y2f(qa.jba,qa.oMa)};m.prototype.hBf=function(){for(var qa=Ml(this.Lx.notes.values),tb=qa.next();!tb.done;tb=qa.next()){tb=tb.value;var rc=this.v9c(tb.id);!this.yV.tb(tb.id)&&(this.pCa?!rc||rc.Lcc:rc&&rc.Lcc)&&this.R3a(tb)&&!this.zcc(tb)&&this.Hxf(tb)}};m.prototype.Kwa=function(qa,tb){tb.sa!==tb.lK&&this.k$b()};m.prototype.enf=function(){this.Daa=!0};m.prototype.sjf=function(){this.Daa=!0};m.prototype.tjf=function(){this.Daa=!0};
m.prototype.Yd=function(){this.Daa=!0};m.prototype.Ks=function(){var qa=null;this.Daa&&(this.Daa=!1,this.fv&&this.fv.r3a&&(qa=this.Lx.t$c(this.fv.jba),$b.b(this.gridView.$).Jd(Ce.a.w1g,this.Dn(),void 0,!0)),this.k$b());this.eAd();eb.ULS.shipAssertTag(571602498,12,!this.Daa);this.Lx.Fcd&&$b.b(this.gridView.$).Jd(Ce.a.lwi,this.Dn());qa&&this.dxd(qa)};m.prototype.kk=function(){this.eAd()};m.prototype.Dn=function(){if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var qa=
{};return qa.Location="floatie",qa}return{}};m.ySe=function(qa){return qa.key};m.Gzh=function(qa){return qa.value};Jl.Object.defineProperties(m.prototype,{wUb:{configurable:!0,enumerable:!0,get:function(){var qa=this.gridView.Ax(this.ga.ya.activeCell);return qa?qa.topLeft:this.ga.ya.activeCell}},mC:{configurable:!0,enumerable:!0,get:function(){return!!this.aK}},aK:{configurable:!0,enumerable:!0,get:function(){return this.Lx.w8b(this.wUb)}},dZe:{configurable:!0,enumerable:!0,get:function(){return b(855).ExcelCommentManager.ije(this.Lx.notes.values,
this.ga.ya.selectedRanges)}},P0h:{configurable:!0,enumerable:!0,get:function(){return!!this.fv&&this.fv.r3a||ge.a.any(this.yV.values,function(qa){return qa.r3a})}},f6h:{configurable:!0,enumerable:!0,get:function(){return this.pCa}},Yvb:{configurable:!0,enumerable:!0,get:function(){return!!this.nE}},yV:{configurable:!0,enumerable:!0,get:function(){return this.p6d}},fv:{configurable:!0,enumerable:!0,get:function(){return this.S9d},set:function(qa){this.Nne();this.S9d=qa}},nE:{configurable:!0,enumerable:!0,
get:function(){return this.R_e},set:function(qa){this.R_e=qa}}});Object(Qa.a)(m,"NoteManager",null,[749,7]);var Dg=b(74),Pf=b(519),gg=b(127),Sb=Dg.a;Cm(c,Sb);c.prototype.dispose=function(){this.notes=null;Sb.prototype.dispose.call(this)};c.prototype.t$c=function(qa){return this.Fcd&&qa?this.notes.getItem(qa):null};c.prototype.w8b=function(qa){return this.Fcd&&(qa=this.zSe(qa),0<=qa)?this.notes.Xf(qa):null};c.prototype.sda=function(qa){var tb=this;this.notes.clear();if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5558834_SkipDuplicatedNoteId")){qa=
Ml(qa);for(var rc=qa.next();!rc.done;rc=qa.next())rc=rc.value,this.notes.hasOwnProperty(rc.id)?eb.ULS.sendTraceTag(540914048,12,15,"Note id already exists!"):this.notes.add(rc.id,rc)}else qa.forEach(function(kd){tb.notes.add(kd.id,kd)});this.notes.Wsc(function(kd,Td){return b(855).ExcelCommentManager.Dnb(kd.anchor,Td.anchor)})};c.prototype.Y2f=function(qa,tb){qa=this.t$c(qa);qa?tb!==qa.text.toString()&&(qa.text=[tb],this.gIe.IDb([qa],4),$b.b(this.$).Jd(Ce.a.SNg,this.Dn(),void 0,!0)):eb.ULS.sendTraceTag(588890946,
12,15,"UpdateNoteText: the note we're tring to edit doesn't exist.")};c.prototype.KVg=function(qa){this.Sxg(qa)};c.prototype.Sxg=function(qa){var tb=this;if(qa){var rc=new Bf.a(182,0,function(kd,Td,qe){return ic(tb.$.ra.xa,1,qa.text[0],ne.q(qa.anchor,tb.$),-1,gd.b(kd,Object(Cb.a)(tb,tb.boi,"onApplyNoteSuccessCallback")),gd.a(Td,Object(Cb.a)(tb,tb.Hjf,"onApplyNoteFailedCallback")),qe,qa.id)},1);this.$.userOperationManager.oc(rc,null)}};c.prototype.boi=function(qa,tb,rc){Le.a(qa)?(this.Hjf(null,tb,
rc),this.$.fa.Wo(qa.Errors)):(eb.ULS.shipAssertTag(579089048,12,0<=qa.Result,"Invalid note id (insert order) provided by server when inserting new note into note model."),$b.b(this.$).Jd(Ce.a.WYg,this.Dn(),void 0,!0),this.$.If(),Lg.g(this.$).focus())};c.prototype.Hjf=function(qa,tb){eb.ULS.sendTraceTag(579089047,12,10,"Failed to create a note. {0}",tb)};c.prototype.x0c=function(qa){var tb=this;if(qa.TU){var rc=this.w8b(qa.selectedRanges[0]);rc?(this.gIe.IDb([rc],3),$b.b(this.$).Jd(Ce.a.c1g,this.Dn(),
void 0,!0)):eb.ULS.sendTraceTag(557057478,12,15,"DeleteNotesInSelectedRanges: the note we're tring to delete doesn't exist.")}else{var kd=function(Td){Td&&Le.a(Td)&&(eb.ULS.sendTraceTag(557057477,12,50,"Delete notes succeeded but received warning message."),tb.$.fa.Wo(Td.Errors));$b.b(tb.$).Jd(Ce.a.Z0g,tb.Dn(),void 0,!0)};rc=function(Td,qe,Ne){return ic(tb.$.ra.xa,3,null,ne.r(qa.selectedRanges,tb.$),-1,gd.b(Td,kd),gd.a(qe,Object(Cb.a)(tb,tb.Cqi,"onDeleteNotesFailedCallback")),Ne,null)};rc=Gd.EwaSettings.wc()?
new Bf.a(182,0,rc,65):new Pf.a(182,0,rc,1);this.$.userOperationManager.oc(rc,null)}};c.prototype.Cqi=function(qa){eb.ULS.sendTraceTag(561821143,12,10,"Failed to delete one or more notes in the selected ranges.");qa&&this.$.fa.Wo(gg.a.Eg(qa.data))};c.prototype.Cmh=function(qa,tb,rc){var kd=Kb.r$c(tb,qa,this.notes.values).returnValue;if(kd)for(tb=null,kd=this.zSe(kd.anchor);qa?kd<this.notes.count:0<=kd;kd+=qa?1:-1)if(tb=this.notes.Xf(kd).anchor,tb=Lg.g(this.$).Ax(tb)||tb,!Lg.g(this.$).hs.mj(tb)){rc(ne.v(tb,
this.$));return}this.findNextOrPreviousNoteCrossSheet(qa,tb,rc)};c.prototype.findNextOrPreviousNoteCrossSheet=function(qa,tb,rc){function kd(Ja,ob,Nb){var Jc=qe.$.ra.xa,bd=ne.o(tb,qe.$);Ja=gd.b(Ja,Td);ob=gd.a(ob,Object(Cb.a)(qe,qe.Kmf,"onFindNextOrPreviousNoteCrossSheetFailedCallback"));var Yc=Jc.Ra(1,null);Yc.activeCell=bd;Yc.findNext=qa;return yb.i(Jc,"FindNextOrPreviousNoteCrossSheet",Yc,Ja,ob,Nb,null,4)}function Td(Ja,ob,Nb){Ja&&Ja.Result&&!Le.a(Ja)?(Ja=Ja.Result,Ja.SheetName===qe.$.activeItemName&&
tb.equals(ne.D(Ja))&&!qe.w8b(tb)?Lg.g(qe.$).focus():rc(Ja)):qe.Kmf(null,ob,Nb)}var qe=this;var Ne=Gd.EwaSettings.wc()?new Bf.a(590,0,kd,80):new Pf.a(590,0,kd,16);this.$.userOperationManager.oc(Ne,null)};c.prototype.Kmf=function(){eb.ULS.sendTraceTag(574365953,12,10,"Failed to find next/previous note.")};c.prototype.zSe=function(qa){var tb=new mg.a(this.notes.values);return gc.HelperMethods.Uw(tb,0,this.notes.count,qa,function(rc,kd){return b(855).ExcelCommentManager.Dnb(rc.anchor,kd)})};c.prototype.Dn=
function(){if(Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var qa={};return qa.Location="floatie",qa}return{}};Jl.Object.defineProperties(c.prototype,{Fcd:{configurable:!0,enumerable:!0,get:function(){return!!this.notes&&0<this.notes.count}}});Object(Qa.a)(c,"NoteModel",Dg.a,[748,7]);var Hc=b(25),ed=b(365),Id=b(27),hf=b(64);Object(Qa.a)(d,"CurrentContextDraft",null,[]);var Hf=b(41),Cg=b(107),uf=b(65);b.d(F,"ExcelCommentManager",function(){return a});var ih=xb.a;
Cm(a,ih);a.prototype.rtg=function(qa){this.Qa.addHandler(a.Lsd,qa)};a.prototype.GUi=function(qa){this.Qa.removeHandler(a.Lsd,qa)};a.prototype.ILi=function(){this.Qa.raiseEvent(a.Lsd)};a.prototype.dispose=function(){this.DYa&&Nc.KeyInputManager.instance.Ca(Pc.a.Rb,this.DYa,Object(Cb.a)(this,this.gqf,"onPaneKeyDown"));this.ga&&this.ga.gN(Object(Cb.a)(this,this.uh,"onActiveCellChanged"));this.wb&&(this.wb.Aa.wg(Object(Cb.a)(this,this.Ii,"onActiveSheetChanged")),this.wb.Aa.h6(Object(Cb.a)(this,this.zC,
"onSheetDeleted")),this.fa.VC(Object(Cb.a)(this,this.PM,"onLatestStateIdChanged")),this.wb.nl(Object(Cb.a)(this,this.sd,"onWorkbookOpened")),Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:3298264_LoadOnDemandShouldResetCommentVersion")&&this.fa.WV(Object(Cb.a)(this,this.rq,"onLoadOnDemandOccurred")));this.commentTaskPane&&this.commentTaskPane.XC(Object(Cb.a)(this,this.Wy,"onPaneVisibilityChanged"));for(var qa=0,tb=this.BUb.length;this.wb&&qa<tb;++qa)hf.a(this.wb).NP(this.BUb[qa]).Kp(Object(Cb.a)(this,
this.NM,"onIdleActivityStatusChanged"));this.wx=this.fa=this.commentTaskPane=this.ga=this.gridView=this.wb=null;this.vHa&&(this.vHa.dispose(),this.vHa=null);this.Lx&&(this.Lx.dispose(),this.Lx=null);this.Oa.TC(Ed.a.CYa,Fd.a.frame,Object(Cb.a)(this,this.CYa,"commentActivitySelected"));this.Oa.TC(Ed.a.UGa,Fd.a.frame,Object(Cb.a)(this,this.UGa,"doesCommentExist"));ih.prototype.dispose.call(this)};a.prototype.TSg=function(){var qa=this;this.Ez=new Wa(Qc.a.instance);this.Cz=this.pwf=z.createInstance(this.Oa,
Qc.a.instance,Xa.AFrameworkApplication.za.nz,Xa.AFrameworkApplication.za.oz,Xa.AFrameworkApplication.za.Te,Xa.AFrameworkApplication.za.jda,this,this.wb,this.commentTaskPane,this.Ez,this.ga);this.yyc=new nc(this.Oa,this.Cz.Rmg);this.jCc=new ha;this.bSd=new x(this.commentTaskPane,this.Cz.WWc);this.lYf=this.iYg();this.wx=new w(this,this.commentTaskPane,this.wb,this.gridView);this.gy=this.owf=Kb.createInstance(this,this.wb,this.ga,this.fa);this.yea=E.createInstance(this,this.wb,this.gridView,this.ga,
this.commentTaskPane);this.hc=this.Oq;this.Lx=new c(this.wb,this.Ae);Of.TaskExtensions.Da(Ug.GetServiceTaskFactory.Xa(this.wb.ea,389,390,0,"Microsoft.Office.Excel.WebUI.Client.IBehaviorsFactory"),function(tb){qa.vHa=new m(qa,qa.Lx,tb.result)},this.wb.ea.ma,3)};a.prototype.BPh=function(){return a.ije(this.Ae.Hrb(),this.ga.ya.selectedRanges)};a.prototype.Xub=function(qa){this.t2.initialize(this,this.DYa);this.Ae.initialize(this);this.yea.initialize(qa)};a.prototype.V_h=function(qa){return!!qa&&qa===
this.OB};a.prototype.KWf=function(qa,tb){eb.ULS.shipAssertTag(50464411,12,1===qa||2===qa&&this.hasCommentAtActiveCell||3===qa,"ExcelCommentManager.SubmitCommentAction: we can't submit a delete/edit operation if there is no comment in the active selection.");var rc=!0,kd=1!==qa?this.OB:null;switch(qa){case 3:this.Ae.Tbd(tb);break;case 2:this.t2.editComment(Ed.a.editComment,null,2,null,kd.id);break;case 1:qa=new Mc.a;qa.oP=tb.qf;qa.DT=tb.method;this.t2.gkb(Ed.a.$5a,null,2,qa,this.ga.ya.activeCell.clone());
break;default:rc=!1}return rc};a.prototype.setFocus=function(qa,tb){tb||this.t2.setFocus();return!tb};a.prototype.gkb=function(qa){if(1===this.mode){qa=Kb.HVg(this.ga.ya.activeCell,this,qa);var tb=new fb;this.addComment(qa,tb);this.wb.If()}};a.prototype.AFa=function(qa){this.iIa("ExcelCommentManager::CommitNewComment",qa);ih.prototype.AFa.call(this,qa);this.mode=4};a.prototype.zFa=function(qa){this.iIa("ExcelCommentManager::CommitEditComment",qa);ih.prototype.zFa.call(this,qa);this.mode=4};a.prototype.selectComment=
function(qa,tb){tb=void 0===tb?1:tb;this.p3g(qa);if(be.a.ZG()){var rc=this.Ae.Bs(qa);rc&&(this.Ae.selectComment(rc),this.yea.highlightComment(rc,!0),this.t2.selectComment(rc,tb),1===tb&&(this.Ygd(qa)?this.Ez.selectComment(this.pyh()):this.Ez.selectComment(qa)))}else ih.prototype.selectComment.call(this,qa,tb)};a.prototype.PNg=function(qa,tb){tb&&(qa.done=tb.isResolved);ih.prototype.zFa.call(this,qa);this.mode=4};a.prototype.eXc=function(qa,tb){ih.prototype.eXc.call(this,qa,tb);this.mode=4};a.prototype.KTh=
function(qa){qa=void 0===qa?null:qa;this.tPa();qa=Kb.IVg(this.ga.ya.activeCell,this,qa);this.iIa("ExcelCommentManager::InitCreateCommentSession",qa);this.Ae.bkb(qa,!0);this.urd();return this.Ae.$rb(qa)};a.prototype.oUh=function(qa,tb){qa=Kb.JVg(this.model.Bs(qa).anchor,this,qa,void 0===tb?null:tb);this.iIa("ExcelCommentManager::InitReplyCommentSession",qa);this.Ae.bkb(qa,!0);this.urd();return this.Ae.$rb(qa)};a.prototype.MTh=function(qa,tb){tb=void 0===tb?null:tb;qa=this.model.Bs(qa);qa.Aac(2,tb);
this.iIa("ExcelCommentManager::InitEditCommentSession",qa);this.Ae.W1c(qa,tb);this.urd();return this.Ae.$rb(qa)};a.prototype.ZTh=function(qa,tb){qa=this.model.Bs(qa);this.Ae.W1c(qa,tb);return this.Ae.$rb(qa)};a.prototype.uXc=function(){var qa=this.Ae.Jr;qa&&qa.Br?this.endCommentSession(!0):eb.ULS.sendTraceTag(40481678,12,10,"Attempting to discard when there is no active draft!")};a.prototype.endCommentSession=function(qa){this.wx&&this.wx.Lpi(this.f4());this.f4()&&(this.iIa("ExcelCommentManager::EndCommentSession",
this.Ae.Jr),this.Ae.fUc(),this.Ae.eU="",this.pKb(!0),be.a.ZG()&&qa&&this.c6b());be.a.ZG()||(this.Ae.fUc(),this.c6b())};a.prototype.WJi=function(){new Oc(this.wb,this,null,null)};a.prototype.upgradeLegacyComments=function(qa){var tb=this;if(this.wb&&hf.a(this.wb)&&this.wb.ra){var rc=new Bf.a(124,0,function(kd,Td,qe){var Ne=tb.wb.ra.xa;kd=gd.b(kd,Object(Cb.a)(tb,tb.aBi,"onUpgradeLegacyCommentSuccessCallback"));Td=gd.a(Td,Object(Cb.a)(tb,tb.Utf,"onUpgradeLegacyCommentFailedCallback"));var Ja=tb.correlationId,
ob=Ne.Ra(9,null);ob.commentId=qa;return yb.i(Ne,"UpgradeLegacyComments",ob,kd,Td,qe,Ja,0)});this.wb.userOperationManager.oc(rc,null)}};a.prototype.kid=function(qa){return(qa=this.model.Bs(qa))?qa.I3a:!1};a.prototype.Zuj=function(){this.ru()};a.prototype.R1b=function(qa){this.iIa("ExcelCommentManager::DeleteCommentConfirmed",qa);if(qa){this.lBa=null;this.ru();qa=this.Ae.deleteComment(qa);this.t2.fBd(qa);for(var tb=0;tb<qa.length;tb++)qa[tb].dispose()}};a.prototype.P0g=function(qa){if(this.ga.ya.TU&&
this.commentTaskPane.isVisible){var tb=this.OB;tb?this.xI.b_(467845448,null,2,null,tb.id):this.Ae.Tbd(qa)}else this.Ae.Tbd(qa)};a.prototype.U0g=function(qa){(qa=this.model.Bs(qa))&&this.deleteComment(qa)};a.prototype.qpc=function(qa,tb){tb=void 0===tb?0:tb;if(!tb){var rc=this.model.Bs(qa);rc?this.gsc(rc.anchor,!1):eb.ULS.sendTraceTag(557057411,12,15,"SelectExcelComment: comment is null, which means we will fail to select it")}this.selectComment(qa,tb)};a.prototype.p3g=function(qa){!this.commentTaskPane.isVisible&&
this.wx&&this.U_h(qa)&&this.p_a()};a.prototype.U_h=function(qa){return!!this.Ae.Jr&&this.Ae.Jr.id===qa};a.prototype.$2i=function(qa){var tb=this;this.selectComment(qa,1);Ic.a.dWa(Qc.a.instance,function(){tb.tPa()})};a.prototype.EYa=function(){var qa=[];this.Ae.eU===Ud.d(this.wb.sa)&&this.Ae.Jr&&(qa=0,this.Ae.Jr.Br.sessionType===Bb.create&&(qa=this.Ae.$rb(this.Ae.Jr)),qa=[Object.assign(new d,{draftId:this.Ae.Jr.Br.draftId,insertIndex:qa})]);this.c6b(qa)};a.prototype.KNg=function(){var qa=this.x8b();
this.Ez?(this.Ez.Fxj(this.gZa,!this.mode),this.Ez.X3i(qa,this.x$c(),this.Ae.sad())):eb.ULS.sendTraceTag(35418883,12,10,"Event host should not be null.")};a.prototype.x8b=function(){return Array.clone(this.wii.zrj(this.model.Hrb(),!this.wb.isEditMode,(new Kf.a(this.wb.Aa)).vj))};a.prototype.UDh=function(){return this.Ae.sad()};a.prototype.x$c=function(){var qa=this.x8b(),tb=0;qa=Ml(qa);for(var rc=qa.next();!rc.done;rc=qa.next())rc=rc.value,rc.parentId&&rc.parentId.length||tb++;return tb};a.prototype.isCommentOperationEnabled=
function(qa){if(!this.Zge(this.mode)||this.wb.lg.get(1)||1!==this.ga.Ze)return!1;var tb=!1;switch(qa){case 3:tb=8!==this.xI.b_(Ed.a.commentDelete,null,1,null,null);break;case 1:tb=8!==this.xI.b_(Ed.a.$5a,null,1,null,null);break;case 4:tb=8!==this.xI.b_(Ed.a.qN,null,1,null,null);break;case 5:tb=8!==this.xI.b_(Ed.a.jR,null,1,null,null)}return tb};a.prototype.Zge=function(qa){return 1===qa||2===qa||3===qa};a.prototype.f4=function(){return!!this.Ae.Jr};a.prototype.MFb=function(){""===this.Ae.eU&&(this.Ae.eU=
Ud.d(this.wb.sa))};a.prototype.pKb=function(qa){if(qa||!this.Iac)this.xbf(),this.KNg();this.e2f(qa)};a.prototype.e2f=function(qa){qa||!this.Iac?(this.OFd||this.d2f(),this.commentTaskPane.Ava&&this.OFd&&(this.PWf(!0),this.OFd=!1),this.wx&&this.wx.Jpi()):this.yGa=!0;this.Oai()};a.prototype.upc=function(qa){this.gridView.ui(ne.v(qa,this.wb),qa,null,null,60,vf.a.Fih,void 0,void 0,void 0,void 0,!0)};a.prototype.Bqg=function(qa){if(qa=this.kJh(qa))qa=this.twe(qa),this.Ae.bkb(qa,!1)};a.prototype.sri=function(qa){!qa||
this.commentTaskPane.isVisible?(this.hasCommentAtActiveCell&&this.selectComment(this.OB.id,1),(qa=this.model.Hya)&&qa.focus()):this.cWf()};a.prototype.qIa=function(qa){return this.Ae.qIa(qa)};a.prototype.u1e=function(qa,tb,rc){this.s2=new Za(this,this.Ez,this.yyc,Qc.a.instance,this.wb,qa,this.Ae,tb,void 0===rc?null:rc)};a.prototype.fGb=function(qa){var tb=new J(!0,this.gridView);qa?this.xI.b_(Ed.a.qN,tb,2,null,null):this.xI.b_(Ed.a.jR,tb,2,null,null)};a.prototype.jTf=function(){be.a.ZG()&&this.i4e()&&
this.wx.moh();var qa=be.a.ZG()?this.i4e():this.f4();this.commentTaskPane.isVisible||qa||this.dKd()};a.prototype.i4e=function(){var qa=this.Ae.Hya;return qa?this.Ygd(qa.id):!1};a.prototype.g3i=function(qa,tb){var rc=Kb.r$c(this.ga.ya.activeCell,qa,this.Ae.Hrb()).returnValue;rc?(qa=rc.anchor,this.gsc(qa,tb),tb=this.T4e?null:this.ga.ya.activeCell,this.gridView.ui(ne.v(qa,this.wb),qa,tb,null,60,vf.a.Eih,void 0,void 0,void 0,void 0,!0)):this.PFd(qa,tb)};a.prototype.selectFirstThreadInNextCommentContext=
function(){this.PFd(!0,!1)};a.prototype.selectLastThreadInPreviousCommentContext=function(){this.PFd(!1,!1)};a.prototype.setThreadResolvedState=function(qa,tb){this.aZb(this.model.Bs(qa),tb)};a.prototype.tMh=function(){this.gridView.setFocus()};a.prototype.dfd=function(){this.wx.dfd()};a.prototype.elf=function(qa,tb,rc){tb=new Hc.Range(tb+1,rc+1,tb+1,rc+1,!1,!1);(rc=this.Ae.qIa(tb))?this.wx.PWa?qa?this.wx.glf(rc):this.wx.Mpi(rc.id):eb.ULS.sendTraceTag(42484868,12,50,"OnCommentCellHoverChange: floating comments not yet initialized"):
this.vHa&&this.vHa.iwi(qa,tb)};a.prototype.Tfj=function(qa){this.wx.PWa&&(qa=this.Ae.qIa(qa))&&this.wx.msc(qa,!1)};a.prototype.Ufj=function(){this.dKd()};a.prototype.dKd=function(){this.OB?this.wx.msc(this.OB,!0):this.Eba?this.eKd=!0:eb.ULS.sendTraceTag(594593109,12,15,"Trying to show a comment at the active cell for deep linking when none exists")};a.prototype.p_a=function(){this.wx.PWa&&this.wx.p_a()};a.prototype.CXf=function(qa){var tb=this.activeSheet;if(tb&&dc.a.Qra(tb.sheetId).equals(qa))return!0;
qa=this.wUe(qa);if(!qa)return!1;qa.activate(!0);return!0};a.prototype.Sji=function(){if(this.Ae.Jr){var qa=this.sUe();this.wb.activeItemName===qa.SheetName?this.qpc(this.oyh()):this.ahf(qa,this.gridView)}};a.prototype.Ygd=function(qa){var tb=this.Ae.Jr;if(!tb||!tb.Br)return!1;var rc=tb.Br;return rc.draftId===qa||rc.threadId===qa||tb.id===qa||tb.Hj===qa};a.prototype.Oai=function(){var qa=[],tb=null;this.activeSheet&&this.activeSheet.IL&&(tb=this.activeSheet.IL.ObjectMetadataArray);if(tb){tb=Ml(tb);
for(var rc=tb.next();!rc.done;rc=tb.next())rc=rc.value,rc.IsLegacy&&(rc=new ve.a(rc.CommentId,rc.Author.DisplayName,rc.Text,new Hc.Range(rc.AnchorRow+1,rc.AnchorColumn+1,rc.AnchorRow+1,rc.AnchorColumn+1,!1,!1),rc.IsTextLocked?2:0,this),Array.add(qa,rc))}this.lXd=0<qa.length;eb.ULS.shipAssertTag(572829779,12,!!this.Lx,"LoadLegacyNotesData: not expecting NoteModel to be null");this.Lx&&this.Lx.sda(qa);this.Jl&&this.Jl.Fli();this.yGa=!1};a.prototype.xbf=function(){var qa=null,tb=null;this.activeSheet&&
this.activeSheet.IL&&(tb=this.activeSheet.IL.ObjectMetadataArray,qa=this.activeSheet.IL);var rc=[],kd=null,Td=[];if(tb){kd=[];tb=Ml(tb);for(var qe=tb.next();!qe.done;qe=tb.next()){qe=qe.value;var Ne=this.twe(qe);if(!Ne.I3a&&(Array.add(kd,qe),Ne.commentBody.startsWith(this.v9h)&&(Ne.commentBody="{ "+Ne.commentBody),"}"!==this.YBh(Ne.commentBody)&&(Ne.commentBody+="}"),Array.add(rc,Ne),this.Dvb&&qe.DocumentTaskObject)){var Ja=new Cg.a;Ja.add(Ne.id,new Tb(Ne.id,Ne.isResolved));qe=this.jCc.Arj(qe.DocumentTaskObject,
Ja);Array.add(Td,qe)}}}this.LNd=kd;qa?(kd=qa.HasCommentsInSheetBefore||be.a.ZG()&&this.n5g(),qa=qa.HasCommentsInSheetAfter||be.a.ZG()&&this.o5g(),this.Ae.dwj(rc,Td,kd,qa)):this.Ae.sda(rc,Td);this.yGa=!1;this.kXd=0<rc.length};a.prototype.CUe=function(qa){for(var tb=0,rc=this.wb.Aa.count;tb<rc;++tb){var kd=this.wb.Aa.getItem(tb);if(Ud.d(kd)===qa)return kd}return null};a.prototype.mBh=function(qa){return(qa=this.CUe(qa))?qa.index:-1};a.prototype.a9c=function(){var qa=-1;if(!this.Ae.Jr||""===this.Ae.eU)return qa;
qa=this.mBh(this.Ae.eU);0>qa&&eb.ULS.shipAssertTag(540367050,12,!1,"ExcelCommentManager.GetDraftSheetIndex: there should be a known sheet index for a valid sheet ID!");return qa};a.prototype.n5g=function(){var qa=this.a9c();return 0<=qa&&qa<this.activeSheet.index};a.prototype.o5g=function(){var qa=this.a9c();return 0<=qa&&qa>this.activeSheet.index};a.prototype.pyh=function(){var qa=this.Ae.Jr;return qa&&qa.Br?qa.Hj||qa.Br.commentId||qa.Br.draftId:null};a.prototype.oyh=function(){var qa=this.Ae.Jr;
return qa&&qa.Br?qa.Hj||qa.Br.commentId||qa.id:null};a.prototype.Rg=function(){};a.prototype.PWf=function(qa){var tb=null;this.t2.UUb?tb=this.ga.ya.activeCell.clone():this.t2.tBe&&(tb=this.OB,eb.ULS.shipAssertTag(50464413,12,!!tb,"ExcelCommentManager.SubmitShowCommentPaneAction: active cell should have a comment to edit!"),tb=tb.id);qa?this.t2.z6(Ed.a.z6,null,2,null,tb):this.t2.W$(Ed.a.W$,null,2,null,null)};a.prototype.kJh=function(qa){if(this.LNd&&qa)for(var tb=Ml(this.LNd),rc=tb.next();!rc.done;rc=
tb.next())if(rc=rc.value,rc.CommentId===qa)return rc;return null};a.prototype.gqf=function(qa){var tb=!1;Hd.a.hh&&window.focus();113===qa.Ga.keyCode&&qa.Ga.shiftKey&&(qa=new me.a(-1667294294,1,this.wb.jd,6,null),tb=this.KWf(1,qa));return tb};a.prototype.uh=function(){this.cWf();this.d2f()};a.prototype.d2f=function(){if(this.commentTaskPane.isVisible||this.wx.PWa){var qa=this.OB;qa?this.Ae.Hya&&qa.id===this.Ae.Hya.id||this.selectComment(qa.id,1):this.Ae.Hya&&this.Zuj();this.wb.If()}};a.prototype.F3e=
function(){return this.fa.pc&&!this.wb.userOperationManager.operationCount&&Ud.i(this.activeSheet)};a.prototype.Ii=function(qa,tb){this.activeSheet!==tb.sa&&(this.activeSheet=tb.sa)&&(this.Xnc(),this.xbf(),this.EYa(),this.e2f(!0))};a.prototype.zC=function(qa,tb){qa=tb.item;!qa||""!==this.Ae.eU&&Ud.d(qa)!==this.Ae.eU||this.c6b()};a.prototype.oHh=function(){var qa=this.model.Hrb(),tb=-1;var rc=this.Ae.Hya;if(!rc)return tb;rc=rc.Hj&&0<rc.Hj.length?rc.Hj:rc.id;var kd=!1;qa=Ml(qa);for(var Td=qa.next();!Td.done;Td=
qa.next())if(Td=Td.value,!(Td.Hj&&0<Td.Hj.length)&&(tb+=1,rc===Td.id)){kd=!0;break}return kd?tb:-1};a.prototype.c6b=function(qa){qa=void 0===qa?null:qa;var tb=this.x8b(),rc=!this.mode,kd=this.x$c(),Td=this.oHh();0<=Td&&Td<kd?this.Ez.W3i(tb.length,kd,Td,rc,this.gZa,qa):this.Ez.V3i(tb.length,kd,rc,this.gZa,qa);this.Ez.q4i(tb,this.Ae.sad())};a.prototype.NM=function(qa){switch(qa.At){case 1:this.qCb||this.Xnc()}};a.prototype.PM=function(){this.Xnc()};a.prototype.Xnc=function(){this.F3e()&&(this.bY(),
this.kga())};a.prototype.rq=function(){this.sK();this.Xnc()};a.prototype.sK=function(){for(var qa=0,tb=this.wb.Aa.count;qa<tb;++qa){var rc=this.wb.Aa.getItem(qa);rc&&rc.IL&&(rc.IL.Version=a.qC)}};a.prototype.bY=function(){this.Eba&&(gg.a.gv(this.Eba.ou),this.Eba=null)};a.prototype.kga=function(){this.wb&&hf.a(this.wb)&&this.wb.ra&&(hf.a(this.wb).iKa?this.Eba||(this.correlationId+=1,this.Eba=yb.y(this.wb.ra.xa,3,this.activeSheet.name,this.version,Object(Cb.a)(this,this.ssi,"onGetCommentsComplete"),
Object(Cb.a)(this,this.tsi,"onGetCommentsFailed"),null,this.correlationId)):this.bY())};a.prototype.ssi=function(qa,tb){if(this.Eba&&tb===this.correlationId){this.Eba=null;if(Id.a.eh(qa.Errors))this.Fkd&&Id.a.Z8(qa.Errors)&&this.wb.fa.P6c();else if((qa=qa.Result)||this.version===a.qC)this.activeSheet.IL=qa,this.pKb(!1);this.Fkd=!1;this.F_b!==dc.a.nil?(32!==this.$gf(this.F_b)&&eb.ULS.sendTraceTag(578101907,12,15,"ExcelCommentManager.OnGetCommentsComplete: Deferred comment selection failed - comment may not exist."),
this.F_b=dc.a.nil):this.eKd&&(this.dKd(),this.eKd=!1)}};a.prototype.tsi=function(qa){this.Eba=null;10===qa.data.status?this.kga():8!==qa.data.status&&14!==qa.data.status&&404!==qa.data.httpStatus&&502!==qa.data.httpStatus&&503!==qa.data.httpStatus&&eb.ULS.sendTraceTag(594886745,12,10,"Comment infomation couldn't be retrieved. RequestStatus is {0}. Http Status is {1}.",qa.data.status,qa.data.httpStatus)};a.prototype.Wy=function(){this.Fkd=this.commentTaskPane.Ava;this.PWf(this.commentTaskPane.Ava)};
a.prototype.sd=function(){this.activeSheet&&this.activeSheet.IL&&(this.activeSheet.IL.Version=a.qC);this.mode=this.wb.isEditMode?1:0;this.commentTaskPane.Rf(!this.wb.Tj&&this.commentTaskPane.Ava)};a.prototype.urd=function(){this.wx&&this.wx.Uhc()};a.prototype.tPa=function(){this.setFocus(!0,!1);this.Oq.Ij(Nd.AFrame.Ho)};a.prototype.twe=function(qa){var tb=null;qa.DocumentTaskObject&&!ge.a.na(qa.DocumentTaskObject.HistoryRecords)&&qa.DocumentTaskObject.HistoryRecords[0].User&&(tb=qa.DocumentTaskObject.HistoryRecords[0].User.DisplayName);
return new zf.a(qa.CommentId,qa.ParentCommentId,qa.Text,qa.DateTime?new Date(qa.DateTime):null,qa.Author,new Hc.Range(qa.AnchorRow+1,qa.AnchorColumn+1,qa.AnchorRow+1,qa.AnchorColumn+1,!1,!1),qa.IsTextLocked,qa.IsLegacy,Gd.EwaSettings.ka(152)?qa.IsEditRestricted:!1,this,qa.IsResolved,qa.IsCurrentUser,!!qa.DocumentTaskObject,tb)};a.prototype.aBi=function(qa,tb,rc){Le.a(qa)?(this.Utf(null,tb,rc),this.fa.Wo(qa.Errors)):(this.pKb(!0),this.Vcf(!0))};a.prototype.Utf=function(){this.pKb(!0);this.Vcf(!1)};
a.prototype.Vcf=function(qa){var tb={};tb.a=this.wb.Ba.UserSessionId;tb.b=qa;Fc.b().Se(33,tb)};a.prototype.PFd=function(qa,tb){this.f4()?(this.MFb(),this.hte(qa)):this.MLf(qa,tb)};a.prototype.Osd=function(qa){this.uXc();this.hte(qa)};a.prototype.hte=function(qa){this.EYa();this.MLf(qa,!1)};a.prototype.MLf=function(qa,tb){var rc=this,kd=this.wb.ra.xa.dc(),Td=this.model.Hrb();var qe=Td&&Td.length?ne.o((qa?Td[Td.length-1]:Td[0]).anchor,this.wb):ne.o(this.ga.ya.activeCell,this.wb);this.rCb=qa?2:1;Gd.EwaSettings.wc()?
this.qCb=ed.a(this.wb.userOperationManager,function(Ne,Ja,ob){return sc(rc.wb.ra.xa,qe,qa,gd.b(Ne,Object(Cb.a)(rc,rc.Jmf,"onFindNextOrPreviousCommentCrossSheetWebMethodSuccess")),gd.a(Ja,Object(Cb.a)(rc,rc.htd,"onFindNextOrPreviousCommentCrossSheetWebMethodFailed")),ob,new J(tb,rc.gridView),kd)},function(Ne){return new Bf.a(509,0,Ne,80)},null):this.qCb=ed.a(this.wb.userOperationManager,function(Ne,Ja,ob){return sc(rc.wb.ra.xa,qe,qa,gd.b(Ne,Object(Cb.a)(rc,rc.Jmf,"onFindNextOrPreviousCommentCrossSheetWebMethodSuccess")),
gd.a(Ja,Object(Cb.a)(rc,rc.htd,"onFindNextOrPreviousCommentCrossSheetWebMethodFailed")),ob,new J(tb,rc.gridView),kd)},function(Ne){return new Pf.a(509,0,Ne,16)},null)};a.prototype.OHh=function(){var qa=this.CUe(this.Ae.eU);return qa?qa.sheetName:null};a.prototype.sUe=function(){var qa=ne.v(this.Ae.Jr.anchor,this.wb);qa.SheetName=this.OHh()||qa.SheetName;return qa};a.prototype.jdj=function(qa){var tb=this.a9c();if(!qa||!this.rCb||0>tb)return!1;var rc=2===this.rCb,kd=this.wb.Aa.getItemByName(qa.SheetName);
return kd&&tb!==this.activeSheet.index?tb===kd.index?(qa=a.Dnb(this.Ae.Jr.anchor,ne.D(qa)),rc&&0>=qa||!rc&&0<=qa):rc?tb<kd.index&&!(tb<this.activeSheet.index&&this.activeSheet.index<kd.index)||tb>this.activeSheet.index&&this.activeSheet.index>=kd.index:tb>kd.index&&!(tb>this.activeSheet.index&&this.activeSheet.index>kd.index)||tb<this.activeSheet.index&&this.activeSheet.index<=kd.index:!1};a.prototype.Jmf=function(qa,tb,rc){qa&&qa.Result&&!Le.a(qa)?(this.qCb=null,rc=tb.gridView,eb.ULS.shipAssertTag(50464414,
12,Object(Xb.a)(189,rc),"ExcelCommentManager.OnFindNextOrPreviousCommentCrossSheetWebMethodSuccess: the userContext is null or not an IGridView."),this.lcf(!0),qa=qa.Result,be.a.ZG()&&this.jdj(qa)&&(qa=this.sUe(),this.wx.Wvd=!0),this.ahf(qa,rc,tb.q1c),this.rCb=0):this.htd(null,tb,rc)};a.prototype.ahf=function(qa,tb,rc){var kd=this;rc=void 0===rc?!1:rc;var Td=null;Td=function(){kd.wb.Aa.wg(Td);kd.gsc(ne.D(qa),rc)};this.wb.activeItemName===qa.SheetName?this.gsc(ne.D(qa),rc):this.wb.Aa.Vf(Td);var qe=
this.T4e?null:this.ga.ya.activeCell;tb.ui(qa,ne.D(qa),qe,null,60,vf.a.Dih,void 0,void 0,void 0,void 0,!0)};a.prototype.gsc=function(qa,tb){var rc=this,kd=null;kd=function(Td,qe){rc.gridView.uFf(kd);if(qe.FWe){if((Td=rc.gridView.Cc(qa))&&Td.cell.Fj)rc.jTf();else{var Ne=null;Ne=function(Ja){Ja.mg.contains(qa)&&(rc.gridView.dnc(Ne),rc.jTf())};rc.gridView.uVb(Ne)}tb&&rc.hasCommentAtActiveCell&&rc.$2i(rc.OB.id)}else eb.ULS.sendTraceTag(557463176,12,15,"Failed to navigate to the next or previous comment")};
this.gridView.$ee(kd)};a.prototype.htd=function(){this.qCb=null;this.rCb=0;this.lcf(!1)};a.prototype.lcf=function(qa){var tb={};tb.a=this.wb.Ba.UserSessionId;tb.b=qa;Fc.b().Se(34,tb)};a.prototype.iYg=function(){var qa="Unknown",tb="Unknown";try{var rc=Hf.b(Xa.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());qa=rc.Ring||"Unknown";tb=rc.WACDatacenter||"Unknown"}catch(kd){eb.ULS.sendTraceTag(38917640,12,10,"Error fetching session start info from app settings. Threw {0}",kd)}rc=this.wb.Ba.LokiComplianceEnvironment;
return new Ga("Excel",Xa.AFrameworkApplication.buildVersion,null,null,this.wb.Ba.UserSessionId,qa,tb,!this.wb.Ba.AriaLoggingIsEnabled,this.Oa,null,rc&&""!==rc?rc:Xa.AFrameworkApplication.ha.Wa("SovereignEnvironmentName"))};a.prototype.YBh=function(qa){for(var tb=qa.length-1;0<=tb;tb--){var rc=qa.charAt(tb);if(" "!==rc&&"\n"!==rc&&"\t"!==rc&&"\r"!==rc)return rc}return"\x00"};a.prototype.iIa=function(qa,tb){tb?eb.ULS.sendTraceTag(42472410,12,50,"VSO3351297: InvalidCommentDataState- "+qa+". Id: "+tb.id+
", Type: "+tb.commentType):eb.ULS.sendTraceTag(42472409,12,10,"VSO3351297: InvalidCommentDataState- "+qa+". inProgressComment is null")};a.prototype.cWf=function(){this.Iac&&(this.mode=1)};a.prototype.CYa=function(qa,tb,rc,kd,Td){if(!Td)return eb.ULS.sendTraceTag(593257421,12,10,"actionData is null"),8;qa=Td.NavigationId;tb=this.sDh(qa);if(isNaN(tb))return eb.ULS.sendTraceTag(593257420,12,10,"Unable to extract nav type from navigation id"),8;11<tb&&eb.ULS.sendTraceTag(593257419,12,15,"Unexpected navigation type, type={0}",
tb);tb=this.xUe(qa);if(tb.equals(dc.a.nil))return eb.ULS.sendTraceTag(593257418,12,10,"Unable to extract sheet id from navigation id"),8;if(!this.CXf(tb))return eb.ULS.sendTraceTag(593257417,12,15,"Destination sheet no longer exists"),8;qa=this.ePe(qa);return qa.equals(dc.a.nil)?(eb.ULS.sendTraceTag(593257416,12,10,"Unable to extract content id from navigation id"),8):this.activeSheet.IL?this.$gf(qa):(this.F_b=qa,32)};a.prototype.UGa=function(qa,tb,rc,kd,Td){if(!Td)return eb.ULS.sendTraceTag(589641476,
12,10,"DoesCommentExist: actionData is null"),8;qa=Td.NavigationId;if(!qa)return eb.ULS.sendTraceTag(589641475,12,10,"DoesCommentExist: navigation ID is null"),8;tb=this.xUe(qa);if(tb.equals(dc.a.nil))return eb.ULS.sendTraceTag(589641474,12,10,"DoesCommentExist: Failed to parse sheet ID from navigation ID"),8;tb=this.wUe(tb);if(!tb)return eb.ULS.sendTraceTag(589641473,12,50,"DoesCommentExist: Sheet not found from Sheet ID; Sheet has been deleted"),8;qa=this.ePe(qa);if(qa.equals(dc.a.nil))return eb.ULS.sendTraceTag(589641472,
12,10,"DoesCommentExist: Failed to parse content ID from navigation ID"),8;if(tb.IL){tb=Ml(tb.IL.ObjectMetadataArray);for(rc=tb.next();!rc.done;rc=tb.next())if(qa.equals(dc.a.Qra(rc.value.CommentId)))return 32;eb.ULS.sendTraceTag(589641443,12,50,"DoesCommentExist: Comment has been deleted");return 8}return 32};a.prototype.$gf=function(qa){qa=qa.toString();if(qg.a.na(qa))return eb.ULS.sendTraceTag(588324864,12,10,"NavigateToCommentById: contentId is null"),8;var tb=Object(Ue.a)(Wc.a,this.Ae.Bs(qa));
if(!tb)return eb.ULS.sendTraceTag(588323043,12,15,"NavigateToFloatingCommentThread: comment does not exist"),8;tb.Hj&&(tb=Object(Ue.a)(Wc.a,this.Ae.Bs(tb.Hj)));this.selectComment(qa,1);this.wx.msc(tb,!0);return 32};a.prototype.wUe=function(qa){for(var tb=this.wb.Aa.items,rc=0;rc<tb.length;++rc)if(tb[rc]&&dc.a.Qra(tb[rc].sheetId).equals(qa))return tb[rc];return null};a.prototype.sDh=function(qa){return(qa=this.X4c(qa,0))?parseInt(qa):Number.NaN};a.prototype.ePe=function(qa){qa=this.X4c(qa,1);return qg.a.na(qa)?
dc.a.nil:dc.a.Qra(qa)};a.prototype.xUe=function(qa){qa=this.X4c(qa,2);return qg.a.na(qa)?dc.a.nil:dc.a.Qra(qa)};a.prototype.X4c=function(qa,tb){if(qg.a.na(qa))return null;qa=qa.split("_");return qa.length<tb+1?null:qa[tb]};a.Dnb=function(qa,tb){return qa.top!==tb.top?qa.top-tb.top:qa.left-tb.left};a.iLf=function(qa,tb){Of.TaskExtensions.Da(Ug.GetServiceTaskFactory.Xa(tb.ea,211,212,0,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),function(rc){rc=rc.result;rc.setEnabled(!0);rc.readText(uc.a.instance.da(qa))},
tb.ma,3)};a.ije=function(qa,tb){if(!(qa&&qa.length&&tb&&tb.length))return!1;tb=Ml(tb);for(var rc=tb.next();!rc.done;rc=tb.next()){rc=rc.value;var kd=Kb.r$c(rc.topLeft,!0,qa).qTh;if(!(0>kd))for(kd=0<kd?kd-1:kd;kd<qa.length;kd++){var Td=qa[kd].anchor;if(0<a.Dnb(Td,rc.bottomRight))break;if(rc.oe(Td))return!0}}return!1};a.la=function(qa,tb,rc,kd,Td){tb=a.createInstance(qa,tb,rc,kd,Td);xb.a.instance=tb;return qa.ea.La(65,tb)};a.createInstance=function(qa,tb,rc,kd,Td){var qe=kd.Nb;return new a(qe,qe,Xa.AFrameworkApplication.Hb,
qa,tb,rc,kd,Td,Ke.FocusManager.instance())};Jl.Object.defineProperties(a.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.a1b},set:function(qa){this.a1b=qa;this.wb.If()}},xI:{configurable:!0,enumerable:!0,get:function(){return this.yyc}},u4c:{configurable:!0,enumerable:!0,get:function(){return this.jCc}},Ae:{configurable:!0,enumerable:!0,get:function(){return this.owf}},t2:{configurable:!0,enumerable:!0,get:function(){return this.pwf}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},
Jl:{configurable:!0,enumerable:!0,get:function(){return this.vHa}},hasCommentAtActiveCell:{configurable:!0,enumerable:!0,get:function(){return!!this.OB}},lZg:{configurable:!0,enumerable:!0,get:function(){return this.kXd}},mZg:{configurable:!0,enumerable:!0,get:function(){return this.lXd}},OB:{configurable:!0,enumerable:!0,get:function(){return this.Ae.qIa(this.ga.ya.activeCell)}},version:{configurable:!0,enumerable:!0,get:function(){return this.activeSheet.IL?this.activeSheet.IL.Version:a.qC}},fXf:{configurable:!0,
enumerable:!0,get:function(){return 1===this.mode}},sharedCommentsEnabled:{configurable:!0,enumerable:!0,get:function(){return!0},set:function(qa){Object(uf.b)(a.prototype,this,"sharedCommentsEnabled",qa)}},Iac:{configurable:!0,enumerable:!0,get:function(){return 2===this.mode||3===this.mode}},gZa:{configurable:!0,enumerable:!0,get:function(){return this.Ae.gZa}},i3g:{configurable:!0,enumerable:!0,get:function(){return new Ea.a(uc.a.instance.Ya(430),CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,
CommentPaneStrings.DiscardDialogResume)}},Dvb:{configurable:!0,enumerable:!0,get:function(){var qa=Gd.EwaSettings.ka(155)&&!this.wb.Acc();Gd.EwaSettings.isChangeGateEnabled("OfficeVSO:3999480_ShouldCheckTasksHostIsEnabled")&&(qa=qa&&Xa.AFrameworkApplication.ha.ta("TasksHostIsEnabled"));return qa}},WSf:{configurable:!0,enumerable:!0,get:function(){return!1}}});a.qC=-1;a.Lsd="OnCommentDraftStarted";Object(Qa.a)(a,"ExcelCommentManager",xb.a,[729,7])},881:function(D,F,b){function a(u,w,v,A,y,x,z,J,B,
C){u=k.call(this,u,r.Comment.aXe,w,z,J,void 0===C?!1:C,z?[v]:a.A8c(v),-1)||this;u.yoj=null;u.anchor=A;u.Xre=y;u.ff=x;u.Geg=B;return u}b.d(F,"a",function(){return a});D=b(0);var d=b(100),c=b(275),m=b(194),r=b(977),t=b(7),k=r.Comment;Cm(a,k);a.prototype.focus=function(){this.Xac||this.rBb()};a.prototype.rBb=function(){this.Xac||d.FocusManager.instance().Ij(c.AFrame.Ho)};a.prototype.Aac=function(u,w){this.YW=u;this.ffa=0;this.oOb=w};a.j0b=function(u,w,v,A){u=new a(m.a.create().toString(),u,null,w,0,
v,null,null,!0);u.Aac(1,A);return u};a.A8c=function(u){return t.a.na(u)?[]:u.split("<br/>")||[u]};Jl.Object.defineProperties(a.prototype,{Xac:{configurable:!0,enumerable:!0,get:function(){return 1===(this.Xre&1)}},X8e:{configurable:!0,enumerable:!0,get:function(){return 2===(this.Xre&2)}},I3a:{configurable:!0,enumerable:!0,get:function(){return this.Geg}},isResolved:{configurable:!0,enumerable:!0,get:function(){return this.done}}});Object(D.a)(a,"ExcelComment",r.Comment,[653])},907:function(D,F,b){function a(t,
k,u,w,v,A){t=r.call(this,t,k,u,w,v,A,null,null,!0)||this;t.$=A.$;return t}b.d(F,"a",function(){return a});D=b(0);var d=b(194),c=b(5);F=b(881);var m=b(141),r=F.a;Cm(a,r);a.qt=function(t){return t.isEditMode&&(new m.a(t.Aa)).Ke(1)};a.PVg=function(t,k){return new a(d.a.create().toString(),c.AFrameworkApplication.userName,String.format("{0}:\n",c.AFrameworkApplication.userName),t,0,k)};Object(D.a)(a,"Note",F.a,[652,653])},977:function(D,F,b){function a(L,P,ea,X,ja,R,ba,ha,oa,Sa,ma,na){this.tSb=0;this.ffa=
2;this.YW=0;this.objectId=this.oOb=this.yv=null;this.vj=!1;this._id=L;this.PUd=ea;this.VNb=X;this.WRb=ja;this.Reb=R;this.Oea=ba;this.XZd=ha;this.usersByReactionType=void 0===na?null:na;this.ff=c.a.instance}function d(L){this.pgc=4;this.L6d=0;this.MXd=this.LVd=this.C7d=this.iYd=this.u8d=this.m1=this.rVa=this.Vl=this.KTa=this.d$d=this.IZd=this.JZd=this.tX=this.$ea=this.SBc=this.J7=this.E7=this.pb=this.Xna=this.D0=null;T.a.iQ&&(this.pgc=6);this.cl=L;this.poa=C.KeyInputManager.El(B.a.kAa,0);this.render()}
b.r(F);D=b(0);var c=b(1278),m=b(37),r=b(1125),t=b(808),k=b(904),u=b(275),w=b(5),v=b(162),A=b(366),y=b(573),x=b(276),z=b(13),J=b(100),B=b(90),C=b(120),H=b(112),W=b(87),S=b(85),N=b(49),T=b(24),fa=b(29);d.prototype.dispose=function(){var L=w.AFrameworkApplication.za.nz,P=w.AFrameworkApplication.za.oz;L.Ca(z.a.click,this.pb,Object(m.a)(this,this.qlf,"onContainerClick"));L.Ca(z.a.Dj,this.pb,Object(m.a)(this,this.rlf,"onContainerDoubleClick"));P.Ca(z.a.fe,this.pb,Object(m.a)(this,this.tlf,"onContainerKeyPress"));
this.E7&&(L.Ca(z.a.click,this.E7,Object(m.a)(this,this.x6a,"onDeleteButtonClick")),P.jv(this.E7,this.MXd));this.J7&&(L.Ca(z.a.click,this.J7,Object(m.a)(this,this.Wsd,"onDoneButtonClick")),P.jv(this.J7,this.iYd));this.tX&&(L.Ca(z.a.click,this.tX,Object(m.a)(this,this.fjc,"onSaveButtonClick")),P.jv(this.tX,this.u8d));this.D0&&(L.Ca(z.a.click,this.D0,Object(m.a)(this,this.Cka,"onCancelButtonClick")),P.jv(this.D0,this.LVd));this.$ea&&(L.Ca(z.a.click,this.$ea,Object(m.a)(this,this.kud,"onReplyButtonClick")),
P.jv(this.$ea,this.C7d));this.Vl&&(P.Ca(z.a.Qo,this.Vl,Object(m.a)(this,this.rV,"onKeyEvent")),P.Ca(z.a.fe,this.Vl,Object(m.a)(this,this.rV,"onKeyEvent")),T.a.hh&&(L=w.AFrameworkApplication.za.sJb,L.Ca(z.a.Fnb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent")),L.Ca(z.a.Enb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent")),L.Ca(z.a.Gnb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent"))),y.a.instance.Ca(z.a.paste,this.Vl,Object(m.a)(this,this.onPaste,"onPaste")));this.KTa=this.m1=this.rVa=
this.Vl=this.D0=this.tX=this.SBc=this.J7=this.$ea=this.E7=this.pb=null};d.prototype.focus=function(){J.FocusManager.instance().Ij(u.AFrame.Ho);this.pb.focus();this.cl.Kf.oJ().mf.ql(this.pb)};d.prototype.FLe=function(){J.FocusManager.instance().Ij(r.a.znb);this.Vl.focus();this.cl.Kf.oJ().mf.ql(this.Vl);2===this.cl.commentType&&this.Vl.value&&0<this.Vl.value.length&&N.a.Y9a(this.Vl);var L=this.cl.Kf.Wg.Lr,P=N.a.iGh(L,this.pb);P.y+this.pb.clientHeight>L.scrollTop+L.clientHeight&&(L.scrollTop=P.y+this.pb.clientHeight-
L.clientHeight)};d.prototype.Tmh=function(){Sys.UI.DomElement.removeCssClass(this.pb,"NewOrEditComment");this.D0.style.display="none";this.Vl.style.display="none";J.FocusManager.dPd(this.Vl);J.FocusManager.dPd(this.tX);J.FocusManager.instance().Wh(r.a.znb).Kk(this.poa);J.FocusManager.instance().jOa(r.a.znb);C.KeyInputManager.instance.Ca(z.a.Qo,this.Vl,Object(m.a)(this,this.rV,"onKeyEvent"));C.KeyInputManager.instance.Ca(z.a.fe,this.Vl,Object(m.a)(this,this.rV,"onKeyEvent"));if(T.a.hh){var L=w.AFrameworkApplication.za.sJb;
L.Ca(z.a.Fnb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent"));L.Ca(z.a.Enb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent"));L.Ca(z.a.Gnb,this.Vl,Object(m.a)(this,this.m5,"onCompositionEvent"))}y.a.instance.Ca(z.a.paste,this.Vl,Object(m.a)(this,this.onPaste,"onPaste"));this.Xna.removeChild(this.Vl);this.Xna.removeChild(this.rVa);this.m1=this.rVa=this.Vl=null;this.LQd();this.fna();this.focus()};d.prototype.fna=function(){this.mya(this.d$d,this.JZd,this.IZd,this.J7,this.SBc,this.pb)};d.prototype.render=
function(){var L=t.a("a",this.yQ("cc"),"CommentContainer");W.a.wh(L,W.a.uL,r.a.ZWc);L.tabIndex=0;this.cl.Hj&&(L.className+=" Reply1");var P=t.a("div",this.yQ("ch"),"CommentHeaderRow"),ea=t.a("span",this.yQ("ca"),"CommentAuthor UIFontBold");ea.innerText=this.cl.author;P.appendChild(ea);var X=t.a("span",this.yQ("ct"),"CommentDate");X.innerText=d.n_g(this.cl.date,this.cl.Kf.l_g,this.cl.Kf.fpj);Sys.UI.DomElement.addCssClass(X,w.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");P.appendChild(X);var ja=
t.a("span",this.yQ("ci"),"CommentStatusIcon");P.appendChild(ja);var R=null;this.cl.pKa&&(R=k.a.zb(this.yQ("cl"),r.a.Rre,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(R,w.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),R.tabIndex=0,P.appendChild(R));this.Xna=t.a("div",this.yQ("cn"),"CommentContent");var ba=null,ha=null,oa=null;this.cl.pKa?(ba=t.a("textarea",this.yQ("ce"),r.a.aXc+" UIFont"),ba.rows=this.pgc,ba.cols=50,ba.tabIndex=0,W.a.wh(ba,
"title",CommonUIStrings.l_CommentContent),this.Xna.appendChild(ba),ha=t.a("div","","CommentTextMeasurementContainer"),oa=t.a("textarea","",r.a.aXc+" UIFont"),oa.rows=1,oa.cols=50,oa.style.visibility="hidden",oa.spellcheck=!1,ha.appendChild(oa),this.Xna.appendChild(ha),2===this.cl.commentType&&(ba.value=this.cl.text.join("\n")+"\n")):this.LQd();var Sa=t.a("div","","CommentFooterRow"),ma=t.a("span",this.yQ("cf"),""),na=k.a.zb(this.yQ("cr"),r.a.Yre+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,
"CommentReply_16x16x32",!1);na.tabIndex=0;na.setAttribute(W.a.Wd,W.a.Gq);ma.appendChild(na);var xa=k.a.zb(this.yQ("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);xa.tabIndex=0;var Oa=xa.childNodes[0].childNodes[0];ma.appendChild(xa);var ib=k.a.zb(this.yQ("cx"),r.a.Sre+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);xa.tabIndex=0;ma.appendChild(ib);Sa.appendChild(ma);var sb=t.a("span",this.yQ("cfa"),
""),nb=k.a.zb(this.yQ("cs"),r.a.Zre,CommonUIStrings.l_CommentSaveCommentButton,null);k.a.r$a(nb,!1);nb.tabIndex=0;sb.appendChild(nb);Sa.appendChild(sb);this.mya(ja,ma,sb,xa,Oa,L);this.cl.Kf.kYc||(ea.setAttribute("Unselectable","on"),X.setAttribute("Unselectable","on"));L.appendChild(P);L.appendChild(this.Xna);L.appendChild(Sa);this.pb=L;this.J7=xa;this.SBc=Oa;this.E7=ib;this.$ea=na;this.tX=nb;this.Vl=ba;this.rVa=ha;this.m1=oa;this.D0=R;this.JZd=ma;this.IZd=sb;this.d$d=ja;this.KTa=P;L=w.AFrameworkApplication.za.nz;
P=w.AFrameworkApplication.za.oz;L.qa(z.a.click,this.pb,Object(m.a)(this,this.qlf,"onContainerClick"));L.qa(z.a.Dj,this.pb,Object(m.a)(this,this.rlf,"onContainerDoubleClick"));P.qa(z.a.fe,this.pb,Object(m.a)(this,this.tlf,"onContainerKeyPress"));this.J7&&(L.qa(z.a.click,this.J7,Object(m.a)(this,this.Wsd,"onDoneButtonClick")),this.iYd=P.Qr(this.J7,Object(m.a)(this,this.Wsd,"onDoneButtonClick"),B.a.Vh));this.$ea&&(L.qa(z.a.click,this.$ea,Object(m.a)(this,this.kud,"onReplyButtonClick")),this.C7d=P.Qr(this.$ea,
Object(m.a)(this,this.kud,"onReplyButtonClick"),B.a.Vh));this.tX&&(L.qa(z.a.click,this.tX,Object(m.a)(this,this.fjc,"onSaveButtonClick")),this.u8d=P.Qr(this.tX,Object(m.a)(this,this.fjc,"onSaveButtonClick"),B.a.Vh));this.E7&&(L.qa(z.a.click,this.E7,Object(m.a)(this,this.x6a,"onDeleteButtonClick")),this.MXd=P.Qr(this.E7,Object(m.a)(this,this.x6a,"onDeleteButtonClick"),B.a.Vh));this.D0&&(L.qa(z.a.click,this.D0,Object(m.a)(this,this.Cka,"onCancelButtonClick")),this.LVd=P.Qr(this.D0,Object(m.a)(this,
this.Cka,"onCancelButtonClick"),B.a.Vh));ba&&(P.qa(z.a.Qo,ba,Object(m.a)(this,this.rV,"onKeyEvent")),P.qa(z.a.fe,ba,Object(m.a)(this,this.rV,"onKeyEvent")),T.a.hh&&(L=w.AFrameworkApplication.za.sJb,L.qa(z.a.Fnb,ba,Object(m.a)(this,this.m5,"onCompositionEvent"),null),L.qa(z.a.Enb,ba,Object(m.a)(this,this.m5,"onCompositionEvent"),null),L.qa(z.a.Gnb,ba,Object(m.a)(this,this.m5,"onCompositionEvent"),null)),y.a.instance.qa(z.a.paste,ba,Object(m.a)(this,this.onPaste,"onPaste")),this.Taj())};d.prototype.BPf=
function(L){k.a.r$a(this.tX,L)};d.prototype.yQ=function(L){return L+"_"+this.cl.id};d.prototype.mya=function(L,P,ea,X,ja,R){switch(this.cl.OFb){case 0:case 1:this.bUf(L,0);break;case 2:case 4:L.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(R,"SaveFailure"),Sys.UI.DomElement.addCssClass(R,"NoReply"),this.bUf(L,1)}this.cl.done?(Sys.UI.DomElement.addCssClass(R,"CommentIsDone"),ja.className=A.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(R,"CommentIsDone"),
ja.className=A.getImageClass("CheckboxUnchecked_16x16x32"));this.cl.pKa?(Sys.UI.DomElement.addCssClass(R,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(R,"SelectedComment"),L.style.display="none",P.style.display="none",ea.style.display="inline",this.cl.Kf.mode||(this.BPf(!1),k.a.r$a(this.D0,!1))):(1===this.cl.$Oa?(Sys.UI.DomElement.addCssClass(R,"SelectedComment"),Sys.UI.DomElement.removeCssClass(R,"SelectedParentComment"),P.style.display=1!==this.cl.Kf.mode||3===this.cl.OFb||this.cl.vj?"none":
"inline"):(2===this.cl.$Oa?(Sys.UI.DomElement.removeCssClass(R,"SelectedComment"),Sys.UI.DomElement.addCssClass(R,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(R,"SelectedComment"),Sys.UI.DomElement.removeCssClass(R,"SelectedParentComment")),P.style.display="inline"),ea.style.display="none")};d.prototype.bUf=function(L,P){S.a.anb(L);switch(P){case 0:P=document.createElement("img");P.alt=CommonUIStrings.l_CommentProgressTooltip;P.src=v.a.yra("progress16.gif");L.appendChild(P);break;case 1:P=
A.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),L.appendChild(P)}L.style.display="inline-block"};d.prototype.LQd=function(){S.a.bnb(this.Xna);var L=this.cl.text;1===L.length&&L[0]&&(L=L[0].split("\n"));L=Ml(L);for(var P=L.next();!P.done;P=L.next()){P=P.value;var ea=t.a("p","","CommentContentPara");ea.innerText=P||"\u00a0";this.cl.Kf.kYc||ea.setAttribute("Unselectable","on");this.Xna.appendChild(ea)}};d.prototype.Taj=function(){var L=J.FocusManager.instance().Wh(r.a.znb);
L.parent=u.AFrame.Ho;x.a.instance.VVa(r.a.znb,this.Vl);L.bindAction(C.KeyInputManager.El(B.a.L8f,2),fa.a.doNothing);L.bindAction(this.poa,fa.a.VWc);L.bindAction(C.KeyInputManager.El(B.a.scb,0),fa.a.oha);L.bindAction(C.KeyInputManager.El(B.a.jAa,0),fa.a.oha);L.Kk(J.FocusManager.instance().j1);L.Kk(J.FocusManager.instance().k1)};d.prototype.qlf=function(L){if(this.cl.pKa&&L.Ga.target===this.Vl)return!0;this.cl.rBb();return!0};d.prototype.rlf=function(){this.cl.Zsd();return!0};d.prototype.tlf=function(L){var P=
!1;L.Ga.keyCode===B.a.Vh&&(this.cl.$Oa?this.cl.Zsd():this.cl.rBb(),P=!0);return P};d.prototype.x6a=function(){if(this.E7.disabled)return!0;this.cl.Xhc();return!0};d.prototype.Wsd=function(){if(this.J7.disabled)return!0;this.cl.FAi();return!0};d.prototype.kud=function(){if(this.$ea.disabled)return!0;this.cl.Oxi();return!0};d.prototype.fjc=function(){if(this.tX.disabled)return!0;this.cl.myi(this.Vl.value);return!0};d.prototype.Cka=function(){if(this.D0.disabled)return!0;this.cl.zsd();return!0};d.prototype.rV=
function(L){if(L.Ga.ctrlKey&&L.Ga.keyCode===B.a.Vh)return 0<this.Vl.value.length&&this.fjc(null),!0;if(L.Ga.keyCode===B.a.kAa)return!0;this.onTextEntered(L.eventName===z.a.Qo&&L.Ga.charCode===B.a.Vh);return!1};d.prototype.m5=function(){this.onTextEntered(!1);return!1};d.prototype.onPaste=function(){var L=this,P=new H.a(0,1,0,function(){L.onTextEntered(!1)},1);w.AFrameworkApplication.$j.sh(P);return!1};d.prototype.onTextEntered=function(L){if(this.cl.Kf.mode&&(this.BPf(0<this.Vl.value.length),!T.a.iQ)){this.rVa.clientWidth!==
this.Vl.clientWidth&&(this.rVa.style.width=this.Vl.clientWidth+"px");this.m1.value=this.Vl.value+"___";this.L6d>this.Vl.value.length&&(this.m1.rows=1);for(var P=0,ea=Number.MAX_VALUE;1<=(P=this.m1.scrollHeight-this.m1.clientHeight)&&P<ea;)ea=P,this.m1.rows++;this.m1.rows<this.pgc?this.Vl.rows=this.pgc:(L&&this.m1.rows++,this.Vl.rows=this.m1.rows);this.L6d=this.Vl.value.length}};d.n_g=function(L,P,ea){if(!L||isNaN(L.getDate()))return"";var X=ea,ja=new Date;if(ja.getFullYear()!==L.getFullYear()||ja.getMonth()!==
L.getMonth()||ja.getDate()!==L.getDate())X=String.format(CommonUIStrings.l_CommentLongDateFormat,P,ea);return L.localeFormat(X)};Jl.Object.defineProperties(d.prototype,{Pi:{configurable:!0,enumerable:!0,get:function(){return this.pb}},N0g:{configurable:!0,enumerable:!0,get:function(){return this.E7}},W0i:{configurable:!0,enumerable:!0,get:function(){return this.tX}}});Object(D.a)(d,"CommentViewObject",null,[7,671]);var Y=b(194);b.d(F,"Comment",function(){return a});a.prototype.dispose=function(){this.yv&&
(this.yv.dispose(),this.yv=null)};a.prototype.render=function(){this.yv=new d(this);return this.yv.Pi};a.prototype.O5a=function(){this.yv&&this.yv.fna()};a.prototype.focus=function(){this.rBb();this.yv.focus();this.pKa&&this.yv.FLe()};a.prototype.toString=function(){var L="[null]";this.Oea&&0<this.Oea.length&&(L=30<this.Oea[0].length?this.Oea[0].substr(0,30)+"...":this.Oea[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.PUd||"[null]",this.VNb?this.VNb.toString():
"[null]",this.WRb||"[null]",this.Reb,L)};a.prototype.rBb=function(){2===this.Kf.mode||3===this.Kf.mode?this.pKa&&this.yv.FLe():(J.FocusManager.instance().Ij(u.AFrame.Ho),1!==this.tSb&&this.Kf.selectComment(this._id))};a.prototype.Zsd=function(){this.Kf.fXf&&!this.YW&&(J.FocusManager.instance().Ij(u.AFrame.Ho),this.YW=2,this.ffa=0,this.Kf.editComment(this,null))};a.prototype.$qi=function(){3===this.Kf.mode&&(J.FocusManager.instance().Ij(u.AFrame.Ho),this.YW=0,this.ffa=2,this.Kf.THg(this))};a.prototype.Xhc=
function(){J.FocusManager.instance().Ij(u.AFrame.Ho);this.Kf.deleteComment(this)};a.prototype.FAi=function(){this.Kf.aZb(this,!this.Reb)};a.prototype.Oxi=function(){2!==this.Kf.mode&&(J.FocusManager.instance().Ij(u.AFrame.Ho),this.Kf.addReply(this.WRb||this._id,null))};a.prototype.myi=function(L){J.FocusManager.instance().Ij(u.AFrame.Ho);this.Oea=Array(1);this.Oea[0]=L;1===this.YW?this.Kf.AFa(this):this.Kf.zFa(this)};a.prototype.zsd=function(){J.FocusManager.instance().Ij(u.AFrame.Ho);this.Kf.Wg.Lr&&
this.Kf.Wg.Lr.focus();1===this.YW?(this.Kf.deleteComment(this),this.Kf.FLf(this.Hj)):this.$qi()};a.j0b=function(L,P,ea,X){var ja=Y.a.create().toString();L=new a(ja,a.aXe,L,new Date,P,!1,[],ea,!1,w.AFrameworkApplication.ha.Wa("PresenceUserId"),w.AFrameworkApplication.ha.Wa("PresenceProvider"));L.YW=1;L.ffa=0;L.oOb=X;return L};Jl.Object.defineProperties(a.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id},set:function(L){this._id=L}},author:{configurable:!0,enumerable:!0,get:function(){return this.b8e?
CommonUIStrings.l_RemovedAuthorName:this.PUd}},date:{configurable:!0,enumerable:!0,get:function(){return this.b8e?null:this.VNb},set:function(L){this.VNb=L}},done:{configurable:!0,enumerable:!0,get:function(){return this.Reb},set:function(L){this.Reb!==L&&(this.Reb=L,this.yv&&this.yv.fna())}},jtb:{configurable:!0,enumerable:!0,get:function(){return this.XZd},set:function(L){this.XZd=L}},Hj:{configurable:!0,enumerable:!0,get:function(){return this.WRb},set:function(L){this.WRb=L}},text:{configurable:!0,
enumerable:!0,get:function(){return this.Oea},set:function(L){this.Oea=L;this.yv&&this.yv.LQd()}},$Oa:{configurable:!0,enumerable:!0,get:function(){return this.tSb},set:function(L){this.tSb!==L&&(this.tSb=L,this.yv&&this.yv.fna())}},OFb:{configurable:!0,enumerable:!0,get:function(){return this.ffa},set:function(L){this.ffa===L||!this.ffa&&2===L||3===this.ffa||(this.ffa=L,this.yv&&this.yv.fna())}},commentType:{configurable:!0,enumerable:!0,get:function(){return this.YW},set:function(L){if(this.YW!==
L){var P=this.pKa&&!L;this.YW=L;P&&this.yv&&this.yv.Tmh()}}},pKa:{configurable:!0,enumerable:!0,get:function(){return 1===this.YW||2===this.YW}},b8e:{configurable:!0,enumerable:!0,get:function(){return!!this.ff&&this.ff.uSi}},Pi:{configurable:!0,enumerable:!0,get:function(){return this.yv?this.yv.Pi:null}},Kf:{configurable:!0,enumerable:!0,get:function(){return this.ff}},bse:{configurable:!0,enumerable:!0,get:function(){return this.yv}},Br:{configurable:!0,enumerable:!0,get:function(){return this.oOb},
set:function(L){this.oOb=L}}});a.aXe=null;a.wDi=-1;Object(D.a)(a,"Comment",null,[7,655])}}]);

//# sourceMappingURL=EwaDS.commentpane.js.map