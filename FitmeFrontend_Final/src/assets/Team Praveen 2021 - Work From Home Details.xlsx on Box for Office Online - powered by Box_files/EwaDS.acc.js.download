(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1356:function(D,F,b){function a(Q){var ra=ai.call(this)||this;ra.$=Q;ra.fc();return ra}function d(Q,ra){var mb=$i.call(this)||this;mb.$=Q;mb.gridView=df.g(Q);mb.tableManager=ra;mb.Ix=new x(mb.gridView);mb.qp=new P(mb.gridView);mb.gridView.Sb&&(mb.gridView.Sb.Bsg(Object(gd.a)(mb,mb.Dlb,"attachBehavior")),mb.gridView.Sb.update(!1));Q.ea.La(64,mb);return mb}function c(Q,ra,mb,Qb){return fa.call(this,Q,ra,mb,Qb)||this}function m(Q){var ra=
L.call(this,Q)||this;m.vob(Q,rb.a.Ihh+" "+Xg.a.Zsa);m.vob(Q,rb.a.Hhh+" "+Xg.a.Zsa);m.vob(Q,rb.a.Ehh+" "+Xg.a.Zsa);m.vob(Q,rb.a.Ghh+" "+Xg.a.Zsa);m.vob(Q,Xg.a.Fhh);return ra}function r(Q){var ra=L.call(this,Q)||this;appChrome.renderSpinner(Q);return ra}function t(Q){var ra=L.call(this,Q)||this;t.gob(Q,rb.a.ohh+" "+Xg.a.Zsa);t.gob(Q,rb.a.nhh+" "+Xg.a.Zsa);t.gob(Q,rb.a.khh+" "+Xg.a.Zsa);t.gob(Q,rb.a.mhh+" "+Xg.a.Zsa);t.gob(Q,Xg.a.lhh);return ra}function k(Q,ra,mb,Qb,Sc){Q=w.call(this,Q,ra,mb,Qb,Sc)||
this;zg.a.lfe(Object(gd.a)(Q,Q.QAb,"onLastInputMethodChanged"));Q.Jld=3===zg.a.Yb;Q.qp.etg(Object(gd.a)(Q,Q.Vxi,"onResizeStartedOrEnded"));return Q}function u(Q,ra,mb,Qb,Sc){return w.call(this,Q,ra,mb,Qb,Sc)||this}function w(Q,ra,mb,Qb,Sc){var Ad=L.call(this,Q)||this;Ad.wK=null;Ad.qb=null;Ad.D2=0;Ad.sourceRange=null;Ad.kd=null;Ad.xQa=!1;Ad.gridView=ra;Ad.$=ra.$;Ad.tK=[];Ad.ga=Ad.gridView.ga;Ad.Ix=mb;Ad.qp=Qb;Ad.Y$=Sc;Ad.coloredReferencesManager=Ad.$.ea.Ea(281,void 0);Uc.ULS.shipAssertTag(590751772,
0,!!Ad.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");ra=Ml(Ad.tIf());for(mb=ra.next();!mb.done;mb=ra.next())mb=Ad.qp.Tue(Q,mb.value,Ad.nge(),Object(gd.a)(Ad,Ad.onPointerDown,"onPointerDown")),Array.add(Ad.tK,mb);Q=Ml(Ad.tK);for(ra=Q.next();!ra.done;ra=Q.next())ra=ra.value,Rc.a.instance.qa(Kc.a.AV,ra,Object(gd.a)(Ad.Ix,Ad.Ix.S_e,"hoveringStarted")),Rc.a.instance.qa(Kc.a.$y,ra,Object(gd.a)(Ad.Ix,
Ad.Ix.T_e,"hoveringStopped"));Ad.xWa(Sc);return Ad}function v(Q,ra){var mb=L.call(this,Q)||this;var Qb=document.createElement("div"),Sc=document.createElement("div");Qb.className=ra?S.Khh:S.Mhh;Sc.className=ra?S.Lhh:S.Jhh;Q.appendChild(Qb);Q.appendChild(Sc);return mb}function A(Q,ra,mb,Qb){return fa.call(this,Q,ra,mb,Qb)||this}function y(Q,ra){var mb=L.call(this,Q)||this;mb.Gu=Object(Ye.a)(Si.a,ra.metadata);mb.AJ=document.createElement("div");mb.AJ.id=String.format("{0}-{1}",Q.id,Se.a.soe);mb.AJ.className=
fg.a.DIg;mb.PG=document.createElement("div");mb.PG.id=String.format("{0}-{1}",Q.id,Se.a.FUc);mb.PG.className=fg.a.FUc;mb.AJ.appendChild(mb.PG);Q.appendChild(mb.AJ);Uc.ULS.sendTraceTag(590751775,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Rc.a.instance.qa(Kc.a.AV,mb.AJ,Object(gd.a)(mb,mb.sqf,"onPointerEnter"));Rc.a.instance.qa(Kc.a.$y,mb.AJ,Object(gd.a)(mb,mb.bxa,"onPointerLeave"));Rc.a.instance.qa(Kc.a.pointerDown,mb.AJ,
Object(gd.a)(mb,mb.onPointerDown,"onPointerDown"));Sd.a.instance.qa(Kc.a.click,mb.AJ,Object(gd.a)(mb,mb.XAb,"onMouseClick"));Sd.a.instance.qa(Kc.a.Dj,mb.AJ,Object(gd.a)(mb,mb.onDoubleClick,"onDoubleClick"));return mb}function x(Q){this.gridView=Q;this.y2a=0;this.Whd=this.acc=!1;this.E4=Number.NaN;this.gridView.ga.N8(Object(gd.a)(this,this.sq,"onSelectionStarted"));this.gridView.ga.G1(Object(gd.a)(this,this.Ih,"onSelectionEnded"));this.gridView.ga.Sfe(Object(gd.a)(this,this.Ih,"onSelectionEnded"))}
function z(Q,ra){var mb=L.call(this,Q)||this;mb.ldg=ra;Df.a.instance.qa(Kc.a.click,Q,Object(gd.a)(mb,mb.Nyi,"onSelectionClick"));return mb}function J(Q,ra){var mb=N.call(this,Q)||this;mb.gridView=ra;ra=document.createElement("div");ra.className=Xg.a.Chh;mb.s$=ra;mb.sd(null,null);Q.appendChild(ra);Rc.a.instance.qa(Kc.a.pointerDown,mb.s$,Object(gd.a)(mb,mb.onPointerDown,"onPointerDown"));Df.a.instance.qa(Kc.a.Dj,mb.s$,Object(gd.a)(mb,mb.oba,"onDblClick"));mb.gridView.ga.N8(Object(gd.a)(mb,mb.sq,"onSelectionStarted"));
mb.gridView.ga.G1(Object(gd.a)(mb,mb.Ih,"onSelectionEnded"));mb.gridView.$.Nk(Object(gd.a)(mb,mb.sd,"onWorkbookOpened"));mb.gridView.$.Db.NVb(Object(gd.a)(mb,mb.w5,"onWacDialogOpened"));mb.gridView.$.Db.MVb(Object(gd.a)(mb,mb.v5,"onWacDialogClosed"));ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&(mb.gridView.Iee(Object(gd.a)(mb,mb.rAb,"onComponentRangePickerActiveStateChanged")),mb.gridView.zc.Cm(Object(gd.a)(mb,mb.Lnf,"onGridEditStarted")),mb.gridView.zc.mt(Object(gd.a)(mb,
mb.Knf,"onGridEditEnded")));return mb}function B(Q,ra,mb,Qb,Sc){Q=W.call(this,Q,ra,mb,Sc)||this;Q.$2b=Tc.a.instance.da(2154);Q.$Ae=Tc.a.instance.da(2155);Q.urc=Tc.a.instance.da(2156);Q.gRf=Tc.a.instance.da(2157);Q.Zv=ee.EwaSettings.getBooleanFeatureGate(Mh.a.zpb,!1);Q.tu=null;Q.Tca=null;Q.oQ=!1;Q.isRow=!1;Q.Yh=!1;Q.nQ=!1;Q.WGa=null;Q.NPa=null;Q.Ald=0;Q.aJ=0;Q.tableManager=Qb;Q.tableRange=null;Q.yo={};Q.XG=!1;Q.kZ=!1;Q.lZ=!1;Q.fid=!1;Q.ga.N8(Object(gd.a)(Q,Q.sq,"onSelectionStarted"));Q.ga.G1(Object(gd.a)(Q,
Q.Ih,"onSelectionEnded"));Q.ga.Sfe(Object(gd.a)(Q,Q.dsf,"onSelectionAbort"));Q.ga.ZF(Object(gd.a)(Q,Q.nd,"onSelectionChanged"));return Q}function C(Q,ra){this.destinationRange=this.sourceRange=null;this.sourceRange=Q;this.destinationRange=ra}function H(Q,ra,mb,Qb,Sc,Ad){Q=W.call(this,Q,ra,mb,Sc)||this;Q.wK=null;Q.qb=null;Q.gridView=df.g(Q.$);Q.Ix=Qb;Q.coloredReferencesManager=Q.$.ea.Ea(281,void 0);Uc.ULS.shipAssertTag(590751827,0,!!Q.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
Qb=Ml(Q.eC);for(ra=Qb.next();!ra.done;ra=Qb.next())ra=ra.value,Rc.a.instance.qa(Kc.a.AV,ra,Object(gd.a)(Q.Ix,Q.Ix.S_e,"hoveringStarted")),Rc.a.instance.qa(Kc.a.$y,ra,Object(gd.a)(Q.Ix,Q.Ix.T_e,"hoveringStopped"));Q.xWa(Ad);return Q}function W(Q,ra,mb,Qb){var Sc=N.call(this,Q)||this;Sc.xQa=!1;Sc.E0h=ee.EwaSettings.getBooleanFeatureGate(Mh.a.zpb,!1);Sc.hce=null;Sc.gce=null;Sc.fqa=0;Sc.r2=0;Sc.wdd=0;Sc.XRd=0;Sc.fla=null;Sc.sourceRange=null;Sc.kd=null;Sc.Jba=null;Sc.eC=[];Sc.$=ra;Sc.ga=df.g(Sc.$).ga;
Sc.paneType=mb;Sc.qp=Qb;ra=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1);mb=bf.a.tf;ra=Ml(ra&&!mb?[S.whh,S.qhh,S.shh,S.uhh]:[S.xhh,S.rhh,S.thh,S.vhh]);for(mb=ra.next();!mb.done;mb=ra.next())mb=Sc.qp.Tue(Q,mb.value,[S.phh],Object(gd.a)(Sc,Sc.onPointerDown,"onPointerDown")),Array.add(Sc.eC,mb);Sc.$.Nk(Object(gd.a)(Sc,Sc.sd,"onWorkbookOpened"));Sc.bHd(Sc.$.isEditMode);return Sc}function S(){}function N(Q){var ra=L.call(this,Q)||this;var mb=document.createElement("div");
mb.className=Xg.a.Dhh;Q.appendChild(mb);return ra}function T(Q,ra,mb,Qb){return fa.call(this,Q,ra,mb,Qb)||this}function fa(Q,ra,mb,Qb){var Sc=L.call(this,ra)||this;Sc.llb=!1;Sc.LWb=!1;Sc.Dkd=!1;Sc.KXa=null;Sc.Bkd=!1;Sc.saa=!1;var Ad=mb.$;Sc.jy=mb;Sc.ga=mb.ga;Sc.Y$=Q;Sc.u3i=ra;Sc.paneType=Qb;Q=Sc.domElement.currentStyle;ra="#000000";Q&&(ra=Q.borderTopColor);Sc.SN=new Y(Sc.R5c(),ra,Ad);Sc.vL=new Y(Sc.R5c(),ra,Ad);Sc.Mid=Ad.fa.isNamedObjectViewMode&&1===Ad.workbookContext.NovMode;Sc.SN.bfe(Object(gd.a)(Sc,
Sc.Jtf,"onTopGrippieDrag"));Sc.SN.afe(Object(gd.a)(Sc,Sc.nic,"onGrippieContextMenu"));Sc.SN.cfe(Object(gd.a)(Sc,Sc.oic,"onGrippiePointerUp"));Sc.vL.bfe(Object(gd.a)(Sc,Sc.ikf,"onBottomGrippieDrag"));Sc.vL.afe(Object(gd.a)(Sc,Sc.nic,"onGrippieContextMenu"));Sc.vL.cfe(Object(gd.a)(Sc,Sc.oic,"onGrippiePointerUp"));Q=Ml(Sc.gridView.uo);for(ra=Q.next();!ra.done;ra=Q.next())ra=ra.value,yg.a.instance.qa(Kc.a.Hf,ra.domElement,Object(gd.a)(Sc,Sc.Tnf,"onGridViewTouchStart")),yg.a.instance.qa(Kc.a.Ge,ra.domElement,
Object(gd.a)(Sc,Sc.Snf,"onGridViewTouchEnd"));mb.view.nt(Object(gd.a)(Sc,Sc.jw,"onVisibleAreaChanged"));mb.Hc.Cm(Object(gd.a)(Sc,Sc.vBe,"editStarted"));mb.Sb.Fkb(Object(gd.a)(Sc,Sc.exa,"onSelectionHighlightChanged"));mb.mkb(Object(gd.a)(Sc,Sc.Wjf,"onBeforeActiveItemCleanUp"));Ad.zD(Object(gd.a)(Sc,Sc.Olc,"reDrawGrippies"));mb.Eq(Object(gd.a)(Sc,Sc.Olc,"reDrawGrippies"));Sc.ga.G1(Object(gd.a)(Sc,Sc.Ih,"onSelectionEnded"));Sc.ga.N8(Object(gd.a)(Sc,Sc.sq,"onSelectionStarted"));mb.AD(Object(gd.a)(Sc,
Sc.Uo,"onCurrentSelectionModeChanged"));Sc.ga.rVb(Object(gd.a)(Sc,Sc.Jnf,"onGridContextMenu"));zg.a.lfe(Object(gd.a)(Sc,Sc.QAb,"onLastInputMethodChanged"));eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(Ad.ea,376,377,0,"Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior.IGridHighlightBehaviorEventManager"),function(ye){ye.result.Hug(Object(gd.a)(Sc,Sc.Ktf,"onTouchAutoFillModeSet"))},Ad.ma,3);return Sc}function Y(Q,ra,mb){var Qb=cg.call(this,document.createElement("div"))||this;Qb.e1b=null;
Qb.nLb=!1;Qb.$=mb;mb=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1);var Sc=bf.a.tf;Sys.UI.DomElement.addCssClass(Qb.domElement,!mb||Sc?Xg.a.MHe:Xg.a.LHe);Sys.UI.DomElement.addCssClass(Qb.domElement,Xg.a.w4b);Q.appendChild(Qb.domElement);cf.DOMElementExtensions.setVisible(Qb.domElement,!1);Qb.jJa=document.createElement("div");Sys.UI.DomElement.addCssClass(Qb.jJa,Xg.a.v4b);Qb.jJa.style.borderColor=ra;Qb.domElement.appendChild(Qb.jJa);Rc.a.instance.qa(Kc.a.pointerDown,
Qb.domElement,Object(gd.a)(Qb,Qb.onPointerDown,"onPointerDown"));Rc.a.instance.qa(Kc.a.de,Qb.domElement,Object(gd.a)(Qb,Qb.Hh,"onPointerUp"));yg.a.instance.qa(Kc.a.Ge,Qb.domElement,Object(gd.a)(Qb,Qb.Hh,"onPointerUp"));Rc.a.instance.qa(Kc.a.Jh,Qb.domElement,Object(gd.a)(Qb,Qb.vk,"onPointerMove"));yg.a.instance.qa(Kc.a.Og,Qb.domElement,Object(gd.a)(Qb,Qb.vk,"onPointerMove"));Df.a.instance.qa(Kc.a.click,Qb.domElement,Object(gd.a)(Qb,Qb.Yc,"onClick"));return Qb}function L(Q,ra){return Qg.call(this,Q,
void 0===ra?null:ra)||this}function P(Q){var ra=ag.call(this)||this;ra.Kef=[3];ra.gridView=Q;return ra}function ea(Q,ra){var mb=Tf.call(this)||this;mb.start=Q;mb.Kub=ra;return mb}function X(Q){var ra=xe.call(this)||this;ra.$=Q;ra.fc();return ra}function ja(Q){var ra=re.call(this)||this;Q.ea.La(376,ra);return ra}function R(Q){var ra=yd.call(this)||this;ra.$=Q;ra.fc();return ra}function ba(){this.oEd=ce.AFrameworkApplication.CSd;this.Ngi=ce.AFrameworkApplication.CCj;this.tokens=ce.AFrameworkApplication.CLh();
this.priority=ce.AFrameworkApplication.DSd;this.O7d=this.r9i();this.mNc=ce.AFrameworkApplication.BLh();this.CFc=!1;this.R7d=ce.AFrameworkApplication.CSd;ce.AFrameworkApplication.ha&&(this.CFc=ce.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",!1))&&(this.R7d=ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",ce.AFrameworkApplication.CSd))}function ha(Q,ra,mb,Qb,Sc){var Ad=
this;Qb=void 0===Qb?null:Qb;Sc=void 0===Sc?!1:Sc;this.Dpa=0;this.sfa=this.Oi=null;this.BTb=new Og.a;this.dS=new Og.a;this.Ul=null;this.WPb=!1;this.re=Q;this.B6d=ra;this.B6d.execute(function(ye){ye.km(sa.a.Idd,Object(gd.a)(Ad,Ad.fui,"onHostResponseReceived"))});this.p8=mb;this.cae=new Bd.a("WebServiceCall","TokenRefresh");this.Kj=Qb||new oa(Q);this.cjg=Sc}function oa(Q){this.Ao={};this.WW={};this.xhg={};this.qcf=15;this.J1d=!1;this.jjg=new Date;this.eQb=new Date;this.re=Q;this.sTb=new xc.a(2,2,6E4*
this.qcf,Object(gd.a)(this,this.o6f,"writeMeasures"),135,"SL",!1);this.re.sh(this.sTb);this.VVh()}function Sa(){}function ma(Q,ra){var mb=this;this.documentVisibilityObserver=null;this.Qa=new uf.a;this.Yw=null;this.Jab=this.dib=!1;this.mmc=null;this.XDb=!1;this.Tnd=!0;this.n2d=this.O1d=this.qG=this.jjb=!1;this.XR=null;this.$=Q;this.oOd=ra;this.sAd=Q.Zb.yi("WebServiceCall","refreshToken");this.I5b=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");Jg.a.instance.OPc(Object(gd.a)(this,
this.rYe,"handleTokenExpired"));Jg.a.instance.MPc(Object(gd.a)(this,this.VXe,"handleOnTokenExpiring"));ra=this.$.fa;ra.ak(Object(gd.a)(this,this.ed,"onSessionIdChanged"));ra.BVb(Object(gd.a)(this,this.axa,"onOpenWorkbookFailed"));this.$hi=this.$.Ba.MinTokenLifetimeForRegularExpirationPromptInMin;this.hRf=this.$.Ba.ShortAccessTokenExpirationPromptSeconds;this.GCf=this.$.Ba.RefreshAccessTokenDurationLimitInSec;this.H3f(Q.fa.evf,ce.AFrameworkApplication.qk);Q=new Date;ra={};Uc.ULS.sendTraceTag(39929153,
217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(ra.AccessTokenTtl=ce.AFrameworkApplication.qk,ra.NowGetTime=Q.getTime(),ra.BootTime=ce.AFrameworkApplication.oga,ra.WopiTokenExpiresAfterMinutes=ce.AFrameworkApplication.ASd,ra.WopiTokenTaskItemPriority=ce.AFrameworkApplication.DSd,ra));this.$.ea.ub(291,function(Qb){mb.documentVisibilityObserver=Qb})}function na(Q,ra){this.BTb=Q;this.dS=ra}function xa(){return Oa.apply(this,arguments)||this}function Oa(){}function ib(){}function sb(Q,
ra){this.RDb=!1;this.correlationID=Q;this.YZc=ra;this.Iuc=!1;this.creationTime=Bh.a.Ta.Lb}function nb(Q){var ra=Gb.call(this)||this;ra.Qa=new uf.a;ra.jjb=!1;ra.qG=!1;ra.$=Q;return ra}function Gb(){this.g9d=this.RKc=!1;var Q=ce.AFrameworkApplication.qk;if(!(0>=Q)){this.qk=Q;Q=new Date;var ra={};Uc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(ra.AccessTokenTtl=this.qk,ra.NowGetTime=Q.getTime(),ra.BootTime=ce.AFrameworkApplication.oga,ra));Jg.a.instance.OPc(Object(gd.a)(this,
this.NMa,"onSessionExpiredDetected"));Jg.a.instance.MPc(Object(gd.a)(this,this.jsf,"onSessionExpiringDetected"))}}function Ha(Q){var ra=Ef.call(this)||this;ra.$=Q;ra.fc();return ra}function ca(Q,ra,mb){mb=void 0===mb?null:mb;var Qb=Zf.call(this,ra)||this;Qb.sheetTabActivatePreviousHidden=Tc.a.instance.da(694);Qb.sheetTabActivateNextHidden=Tc.a.instance.da(696);Qb.svgIconProvider=null;Qb.nh=[];Qb.YJ=Array(6);Qb.Aqd=Array(6);Qb.Ik=null;Qb.VId=null;Qb.trc=null;Qb.R$a=null;Qb.prc=null;Qb.SG=null;Qb.cvb=
null;Qb.HPa=null;Qb.isRtl=!1;Qb.Au=0;Qb.NJ=0;Qb.Dnc=!1;Qb.S2b=!1;Qb.Pla=0;Qb.Akc=0;Qb.b3b=null;Qb.Y9=null;Qb.Z2=null;Qb.TL=null;Qb.kC=0;Qb.n9b=0;Qb.ZIb=null;Qb.qxb=-1;Qb.rY=null;Qb.Mjc=0;Qb.gtc=-1;Qb.jla=0;Qb.nsa=new Za;Qb.AFc=!1;Qb.NZ=null;Qb.r9d=null;Qb.WId=null;Qb.XId=null;Qb.Enc=null;Qb.B1d=!1;Qb.Eed=null;Qb.Spd=!1;Qb.q9d=null;Qb.$=Q;Qb.fa=Qb.$.fa;Qb.Qy=mf.a.p6e();Qb.k3b=Qb.Qy&&!ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Qb.im=ee.EwaSettings.ka(535);
Qb.$v=mf.a.Ejd();Qb.q8e=Qb.im;Qb.Y0h=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5717930_EndEditViaSheetChangeTracking");Qb.Qy&&(Qb.B1d=Qb.im&&!bf.a.Iu);Qb.Nji=Qb.$.Ba.SheetTabNavigateButtonLongKeyPressPeriodMS;Qb.Mji=Qb.$.Ba.SheetTabNavigateButtonIntervalPeriodMS;Qb.z5g=Qb.$.Ba.SheetTabDragStartPixelThreshold;Qb.oNa=-1;Qb.nNa=-1;Qb.PXc=!1;Qb.$v&&(Qb.svgIconProvider=mb);Qb.IB=new ze.a(Qb.domElement,3);Qb.im&&Qb.domElement.classList.add(fb.heh);Qb.DVg();Qb.YSg();Qb.EVg();Qb.FWg();Qb.rqc(!0);Qb.sd(null,
null);Q=Qb.$.Aa;Q.Vf(Object(gd.a)(Qb,Qb.Ii,"onActiveSheetChanged"));Q.oVb(Object(gd.a)(Qb,Qb.l5,"onCleared"));Q.MX(Object(gd.a)(Qb,Qb.zC,"onSheetDeleted"));Q.Sfa(Object(gd.a)(Qb,Qb.vBb,"onSheetInserted"));Q.gEa(Object(gd.a)(Qb,Qb.hxa,"onSheetRenamed"));Q.hfe(Object(gd.a)(Qb,Qb.zsf,"onSheetReordered"));Q.kWa(Object(gd.a)(Qb,Qb.Bsf,"onSheetVisibilityChanged"));Q.Nsg(Object(gd.a)(Qb,Qb.Asf,"onSheetTabColorChanged"));Q.pPc(Object(gd.a)(Qb,Qb.ojf,"onActiveItemLockChanged"));Q.efe(Object(gd.a)(Qb,Qb.pjf,
"onActiveItemLockPausedChanged"));Q.ffe(Object(gd.a)(Qb,Qb.qjf,"onActiveItemNamedSheetViewModeChanged"));Q.gfe(Object(gd.a)(Qb,Qb.HMa,"onItemNamedSheetViewSwitched"));Qb.$.Nk(Object(gd.a)(Qb,Qb.sd,"onWorkbookOpened"));Qb.$.zD(Object(gd.a)(Qb,Qb.kk,"onContentAreaResized"));oc.a(Qb.$).$g(Qb);Qb.$.ea.La(32,Qb);ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&Qb.$.fa.ot(Object(gd.a)(Qb,Qb.hg,"onWorkbookMetadataChanged"));Qb.rrc=Qb.Ud.Kd(Qb.domElement);
Qb.rrc.la("keydown",Object(gd.a)(Qb,Qb.onKeyDown,"onKeyDown"));bh.a(Qb.$).Rq()&&Qb.RE(null,new $g.a(!0));bh.a(Qb.$).vg.Tfa(Object(gd.a)(Qb,Qb.RE,"onPartialInteractivityStatusChanged"));df.g(Qb.$).Iee(Object(gd.a)(Qb,Qb.rAb,"onComponentRangePickerActiveStateChanged"));ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Qb.rrc.la("mousedown",function(Sc){Sc.preventDefault()});Sd.a.instance.qa(Kc.a.wC,Qb.domElement,Object(gd.a)(Qb,Qb.p5,"onMouseWheel"));Qb.UId=
Qb.Ud.Kd(Qb.Ik);Qb.UId.la("scroll",Object(gd.a)(Qb,Qb.onScroll,"onScroll"));Qb.Yoj=He.a(function(){Qb.n_()},200,Qb.$.ma,ed.a.Hbj,!0);Qb.$.lE(Se.a.nij);Qb.q8e&&(Qb.q9d=new va(Qb.$,Qb.HPa.domElement));ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&qf.PageLoadTrackingInfo.instance.pOa("sheetTabBar",["sheetTabBar"]);return Qb}function Ra(Q,ra,mb){ra=E.call(this,document.createElement("a"),ra)||this;ra.wga=ee.EwaSettings.ka(535)?rb.a.I3c:rb.a.dfh;mb.zb(ra.domElement,
Tc.a.instance.da(685),0,ra.wga,Tc.a.instance.da(685),h.a.fXc,!0);Q.appendChild(ra.domElement);ra.tc.la("contextmenu",function(Qb){Yg.g(Qb)});return ra}function ua(Q,ra,mb,Qb,Sc,Ad,ye){var Ze=E.call(this,document.createElement("li"),Q)||this;Ze.$Qf=0;Ze.aRf=0;Ze.FWc=0;Ze.GWc=0;Ze.d_c=.5;Ze.QId=!1;Ze.Ssa=!1;Ze.PN=null;Ze.szb=null;Ze.OD=null;Ze.ABc=null;Ze.color=null;Ze.W5e=!1;Ze.Pcc=!1;Ze.l1b="#BEBBB8";Ze.Zyc=null;Ze.zqe=new ta(Ze,Q);Ze.im=Ad;Ze.$v=ye;Ze.Zwb=mf.a.Zwb(Q);Ze.Ngd=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&
!Ze.$v;Ze.im?(Ze.$Qf=Q.Ba.SheetDragReorderDelayInMilliseconds,Ze.aRf=Q.Ba.SheetDragReorderDelayInMillisecondsForTouch,Ze.FWc=18,Ze.GWc=20):(Ze.FWc=19,Ze.GWc=22);Ze.$=Q;Ze.HSb=Qb;Ze.nR=Sc;Ze.j4a=Sc.ahe();Ze.RXg();Ze.KRg();Ze.Ldd=Q.Zb.yi("UserAction",Ze.name);Ze.Rhd=!1;cf.DOMElementExtensions.xo(Ze.domElement,Se.a.ns,null,null);Ze.domElement.appendChild(Ze.anchor);Ze.anchor.appendChild(Ze.OD);Ze.mma=new Og.a;Q=new qb(Ze.sheet,Ze.im,Ze.$v);Ze.mma.add(new db(Ze.$,Q));Ze.$.fa.rHb&&(Q=new za(Ze.sheet,Ze.im,
Ze.$v),Ze.mma.add(new db(Ze.$,Q)));Ze.Ngd||(Q=new Ta(Ze.sheet,Ze.nR.lrc,function(){return Ze.color?ua.VJd(Ze.color):!1},Ze.$v),Ze.szb=new db(Ze.$,Q),Ze.mma.add(Ze.szb));Ze.yva=Ze.nR.yva;Ze.jcb();Ze.SQi();Ze.Jle=new ze.a(Ze.domElement,1);ra.insertBefore(Ze.domElement,mb);pf.a(Ze.$)&&Ze.w3f(!0);return Ze}function ta(Q,ra){var mb=Jd.call(this,Q.domElement)||this;mb.v9d=Q;mb.$=ra;Df.a.instance.qa(Kc.a.Dj,Q.domElement,Object(gd.a)(mb,mb.oba,"onDblClick"));md.a.instance.qa(Q.domElement,Object(gd.a)(mb,
mb.Yk,"onContextMenu"));mb.tc.la("keydown",Object(gd.a)(mb,mb.onKeyDown,"onKeyDown"));return mb}function db(Q,ra){this.Toa=this.M0=this.xza=this.Sj=null;this.g7e=!1;this.ALc=this.Jma=this.ora=this.Gga=this.nra=null;this.$=Q;this.dataSource=ra;this.$v=mf.a.Ejd()}function Ta(Q,ra,mb,Qb){this.sheet=Q;this.altText=Tc.a.instance.da(1823);this.Gqj=ra;this.GSf=mb;this.$v=Qb}function qb(Q,ra,mb){this.im=ra;this.$v=mb;this.sheet=Q;this.altText=Tc.a.instance.da(1899)}function za(Q,ra,mb){this.im=ra;this.$v=
mb;this.sheet=Q;this.altText=Tc.a.instance.da(1900)}function Ia(Q,ra,mb){Q=E.call(this,document.createElement("a"),Q,!0)||this;Q.$qa=ra.zb(Q.domElement,Tc.a.instance.da(491),0,rb.a.Odh,Tc.a.instance.da(491),h.a.CMh,Q.disabled);Sys.UI.DomElement.addCssClass(Q.domElement,fb.Rdh);mb.appendChild(Q.domElement);Q.$.fa.Do(Object(gd.a)(Q,Q.Rh,"onCommandUIGeneratedAndGridInteractive"));Q.QPi();return Q}function va(Q,ra){var mb=e.call(this,document.createElement("div"))||this;mb.$=Q;mb.Xnj=ra;mb.Ssa=!1;mb.GJb=
0;return mb}function Ua(Q,ra){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Q;this.newSheetIndex=ra}function Kb(Q,ra,mb){var Qb=E.call(this,document.createElement("a"),ra)||this;Qb.$=ra;Qb.wga=ee.EwaSettings.ka(535)?rb.a.I3c:rb.a.rGe;Qb.Bme=mb.zb(Qb.domElement,Tc.a.instance.da(489),0,Qb.wga,Tc.a.instance.da(490),h.a.fXc);Q.appendChild(Qb.domElement);Qb.tc.la("contextmenu",function(Sc){Yg.g(Sc)});Qb.tc.la("mouseover",Object(gd.a)(Qb,Qb.YAb,"onMouseOverOrOut"));Qb.tc.la("mouseout",Object(gd.a)(Qb,
Qb.YAb,"onMouseOverOrOut"));Df.a.instance.qa(Kc.a.click,Qb.domElement,Object(gd.a)(Qb,Qb.Yc,"onClick"));Qb.jxb=nf.KeyInputManager.instance.Qr(Qb.domElement,Object(gd.a)(Qb,Qb.Yc,"onClick"),Vf.a.Vh,Vf.a.p0);return Qb}function ia(Q,ra,mb,Qb){Qb=void 0===Qb?!1:Qb;ra=E.call(this,document.createElement("a"),ra,Qb)||this;ra.wga=ee.EwaSettings.ka(535)?rb.a.I3c:rb.a.rGe;ra.$qa=mb.zb(ra.domElement,Tc.a.instance.da(487),0,ra.wga,Tc.a.instance.da(488),h.a.fXc,Qb);Q.appendChild(ra.domElement);ra.tc.la("contextmenu",
function(Sc){Yg.g(Sc)});ee.EwaSettings.ka(535)||(ra.tc.la("mouseover",Object(gd.a)(ra,ra.YAb,"onMouseOverOrOut")),ra.tc.la("mouseout",Object(gd.a)(ra,ra.YAb,"onMouseOverOrOut")));Df.a.instance.qa(Kc.a.click,ra.domElement,Object(gd.a)(ra,ra.Yc,"onClick"));ra.jxb=nf.KeyInputManager.instance.Qr(ra.domElement,Object(gd.a)(ra,ra.Yc,"onClick"),Vf.a.Vh,Vf.a.p0);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(df.g(ra.$).zc.Cm(Object(gd.a)(ra,ra.tk,"onEditStarted")),
df.g(ra.$).zc.mt(Object(gd.a)(ra,ra.Zk,"onEditEnded")));return ra}function E(Q,ra,mb){mb=void 0===mb?!1:mb;Q=og.call(this,Q)||this;Q.$qa=null;Q.V7a=null;Q.$=ra;Q.cX=mb;return Q}function fb(){}function Za(){this.yze=new Wf.a(!0);this.NBc=0}function ec(Q){return Sh.call(this,Q)||this}function zc(Q){this.P5g=Q}function Ab(Q){return ig.call(this,Q)||this}function vb(Q,ra,mb,Qb){this.menuId=null;this.YOa=-1;this.$=Q;this.tableManager=ra;this.namedSheetViewPublic=mb;this.frame=this.$.frame;this.ga=df.g(this.$).ga;
this.ya=this.ga.ya;this.Yv=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1);this.tableStyleManager=Qb;this.tableStyleManager.bug(Object(gd.a)(this,this.itf,"onTableStylesDataLoadSuccess"))}function kc(Q){var ra=fh.call(this,Q)||this;ra.gridView=df.g(Q);ra.ya=ra.gridView.ga.ya;ra.Njc=ra.gridView.kc.Rk(ra.ya.activeCell).usedRange;Q=ra.J3(ra.Njc.toString());ra.initializeAndShow(Tc.a.instance.da(705),Object(gd.a)(ra,ra.Mnj,"tableResizeDialogHandler"),Q);return ra}function td(Q,
ra){Q=oe.call(this,Q)||this;Q.Aza=ra;return Q}function Oc(Q,ra){Q=ub.call(this,Q,Tc.a.instance.da(704))||this;Q.Aza=ra;return Q}function tc(Q,ra,mb){this.twb=!1;this.sharedSheetRange=ra;this.$=Q;this.Ji=this.$.Zb.yi("UserAction","ConvertToRangeManager");this.tableName=mb}function sc(Q,ra){this.hTd=null;this.iTd=0;this.ej=null;this._state=0;this.Cf=Q;this.IAa=ra;this.lu=this.TK;this.moveNext()}function ic(Q){this.tableName=null;this.tableName=Q}function Ga(Q,ra,mb){this.isPivotTable=!1;this.tableRange=
null;this.optionType=0;this.tableRange=Q;this.optionType=ra;this.isPivotTable=mb}function cb(Q){this.originalRange=null;this.originalRange=Q}function Tb(Q,ra){this.newName=this.oldName=null;this.oldName=Q;this.newName=ra}function Bb(Q,ra,mb,Qb){Q=nc.call(this,Q,mb)||this;Q.hasHeaders=!1;Q.isCreation=!1;Q.hasHeaders=ra;Q.isCreation=Qb;return Q}function nc(Q,ra){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=Q;this.tableRange=gg.l(Q.Ranges[0],Q.SheetName);this.styleIndex=ra}
function Gc(Q){this.autoFilterOptions=null;this.autoFilterOptions=Q}function La(Q,ra){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=Q;this.sortType=ra}function Wa(Q){var ra=we.call(this)||this;ra.tableStyleManager=null;ra.$=Q;ra.fc();return ra}function wa(Q,ra,mb){var Qb=Ee.call(this)||this;var Sc={};Qb.wIi=(Sc.height="100%",Sc);Qb.VDb={};Qb.Oad=0;Qb.gGa=0;Qb.lastSyncTime=new Date;Qb.Fca=-1;Qb.$M=null;Qb.ela={};Qb.EK=null;Qb.oF={};Qb.KQa={};Qb.jmc=null;Qb.d7e=!1;Qb.isInitialized=
!1;Qb.A3a=!1;Qb.Pwb=!1;Qb.$oc=null;Qb.ZLe=!1;Qb.LIb=!1;Qb.utc=!1;Qb.$=Q;Qb.Va=ra;Qb.tableManager=mb;Qb.$.ea.La(329,Qb);Qb.BTc=Qb.dsb();Qb.$.Na.hEa(Object(gd.a)(Qb,Qb.htf,"onTableStyleGalleryMenuClosed"));return Qb}function Da(Q,ra,mb,Qb,Sc,Ad){this.headerRow=Q;this.totalRow=ra;this.firstCol=mb;this.lastCol=Qb;this.fR=Sc;this.Qga=Ad}function Va(){}function Jb(){}function Hb(Q){var ra=Wd.call(this)||this;ra.tableManager=null;ra.$=Q;ra.fc();return ra}function Mb(Q){var ra=Pc.call(this,df.g(Q))||this;
ra.xmb=null;ra.Ttc=null;ra.Oma=null;ra.zmb=null;ra.Ehe=!1;ra.b2d=null;ra.RNb=0;ra.n1b=null;ra.$=Q;ra.gridView=df.g(ra.$);ra.$.ea.La(66,ra);ra.yMb={};ra.kXb(null,null);ra.$.Aa&&ra.$.Aa.Vf(Object(gd.a)(ra,ra.fBf,"reAttachTableBehviors"));ra.Gfe(Object(gd.a)(ra,ra.kXb,"attachTableResizeBehavior"));ra.$.fa.B1(Object(gd.a)(ra,ra.i5,"onApplicationModeChanged"));ra.gridView.ga.WF(Object(gd.a)(ra,ra.uh,"onActiveCellChanged"));ra.$.isEditMode&&ra.uh(null,null);return ra}function Ub(Q){var ra=te.call(this,
document.createElement("div"))||this;ra.ZP=!1;ra.Bvf=!1;ra.Zgd=!1;ra.ONc=!1;ra.hGb=null;ra.$=Q;ra.gridView=df.g(ra.$);ra.parentElement=ra.domElement;ra.parentElement.className=pb.meh;ra.eJa=ra.gridView.Pi;ra.dKa=!0;ra.DVh();ra.szg();ra.dob(!1);Uc.ULS.sendTraceTag(595195099,0,50,"TableTotalRowOptions - React Component Created ");return ra}function pb(){}function gb(Q,ra,mb,Qb){var Sc=fe.call(this,Q)||this;Sc.TXf=[6];Sc.LXf=[26];Sc.ur=null;Sc.Ddc=!1;Sc.kwb=!1;Sc.vU=null;Sc.Is=null;Sc.gridView=ra;Sc.$=
ra.$;Sc.tableManager=Qb;Sc.ga=ra.ga;Sc.Sb=ra.Sb;Sc.parentElement=Q;Sc.WEg();bf.a.Sq||bf.a.xja||Rc.a.instance.qa(Kc.a.pointerDown,Sc.vU,Object(gd.a)(Sc,Sc.onPointerDown,"onPointerDown"));Sc.Mn=mb;Sc.Tjd=!1;Sc.UPb=!1;Sc.Qwb=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableResizeReduceCalls",!1);Sc.Qwb?Sc.tableManager.Bee(Object(gd.a)(Sc,Sc.Mhc,"onCancelEditTable")):(Sc.gridView.Hc.Cm(Object(gd.a)(Sc,Sc.lmf,"onEditCellStarted")),Sc.gridView.Hc.mt(Object(gd.a)(Sc,Sc.Twa,"onEditCellEnded")));
ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5821142_addTableResizeInitLogs")&&Uc.ULS.sendTraceTag(537452696,0,50,"TableResizeBehavior::TableResizeBehavior: Initialized");return Sc}function Qa(Q){var ra=Nb.call(this)||this;ra.$=Q;ra.fc();return ra}function eb(Q){this.$=Q;this.yXf={};this.SMd={};var ra=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",mb=this.iRe(ra);mb?(this.iee(mb),this.$.fa.fi?this.dbf():Q.fa.Do(Object(gd.a)(this,
this.Rh,"onCommandUIGeneratedAndGridInteractive")),this.$.ea.La(388,this)):Uc.ULS.sendTraceTag(590918344,0,15,"window[{0}].icons returned null.",ra)}function xb(){}function dc(Q){var ra=Td.call(this)||this;ra.sparklineManager=null;ra.$=Q;ra.fc();return ra}function Nc(Q,ra){Q=Pc.call(this,Q)||this;ra.La(240,Q);return Q}function Pc(Q){var ra=kd.call(this)||this;ra.nS=[];ra.Xae=Q;var mb=Q.Ha;mb.Dq(Object(gd.a)(ra,ra.Le,"onBlockCacheItemChanged"));mb.nqa(Object(gd.a)(ra,ra.Le,"onBlockCacheItemChanged"));
mb.mVb(Object(gd.a)(ra,ra.Le,"onBlockCacheItemChanged"));mb.XF(Object(gd.a)(ra,ra.jm,"onBlockCacheItemEvicted"));Q.$.Aa.rL(Object(gd.a)(ra,ra.ro,"onActiveItemChanging"));Q.$.Ab.rL(Object(gd.a)(ra,ra.ro,"onActiveItemChanging"));mb=Ml(Q.uo);for(var Qb=mb.next();!Qb.done;Qb=mb.next()){Qb=Ml(Qb.value);for(var Sc=Qb.next();!Sc.done;Sc=Qb.next()){Sc=Ml(Sc.value);for(var Ad=Sc.next();!Ad.done;Ad=Sc.next()){Ad=Ad.value;var ye=Q.Ha.Qk(Ad.hashCode);ra.Le(ra,new qa.a(new ih.a(ye,Ad.hashCode),null))}}}return ra}
function Fd(Q){var ra=Cg.call(this)||this;ra.$=Q;ra.fc();return ra}function Ea(Q,ra){this.Ld=!1;this.uY=ra.vT;this.ariaLiveNotifier=Q;this.GSd=new hc(Q,ra);this.uY&&this.uY.eQ?this.xhe():this.Xj()}function Xa(Q,ra,mb){this.$=ra;this.ariaLiveNotifier=Q;this.GSd=new hc(Q,ra);this.R5b=mb.E$c(this.$);this.R5b.Tsg(Object(gd.a)(this,this.Aof,"onKeyboardInteractionStarted"))}function hc(Q,ra){this.$=ra;this.ariaLiveNotifier=Q}function Xb(Q){var ra=Hf.call(this)||this;ra.$=Q;ra.fc();return ra}function Ic(Q,
ra,mb,Qb,Sc){this.bra=this.gridReadoutNotifier=null;this.$=ra;this.ariaLiveNotifier=Q;this.sparklineManager=Qb;this.tableManager=mb;this.MC=new Qc;if(this.w3a=Mc.w3a())ee.EwaSettings.YG()?this.gridReadoutNotifier=Sc:this.gridReadoutNotifier=ra.ea.Ea(244,void 0),Uc.ULS.shipAssertTag(21866445,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Ic.ace=700;this.$Wb=Hc.a.instance.create(Object(gd.a)(this,this.Cni,"onActiveCellTimerFinish"),Ic.ace,ed.a.L3i,
!1);this.Xj()}function Qc(){this.activeItemName=null;this.e8e=!1;this.tableName=null;this.yYa=0;this.Rtc=!1}function Cb(){}function $c(Q){switch(Q){case 1:return 1384;case 2:return 1385;case 3:return 1386;case 4:return 1387;case 5:return 1388;case 6:return 1389;case 7:return 1390;case 8:return 1391;case 9:return 1392;case 10:return 1393;case 11:return 1394;case 12:return 1395;case 13:return 1396;case 14:return 1397;case 15:return 1398;case 16:return 1399;case 17:return 1400;case 18:return 1401;case 19:return 1402;
case 20:return 1403;case 21:return 1404;case 22:return 1407;case 23:return 1405;case 24:return 1406;case 25:return 1408;case 26:return 1409;case 27:return 1410;case 28:return 1411;default:return 1412}}function ae(Q){var ra=vf.call(this)||this;ra.$=Q;ra.fc();return ra}function Mc(Q,ra){this.m_=this.Z5=this.OV=null;this.Tha=ra;this.UWg(Q);this.KHi();ee.EwaSettings.YG()&&Q.ea.La(244,this)}function Hd(Q){var ra=Uf.call(this)||this;ra.$=Q;ra.fc();return ra}function Nd(Q,ra,mb){this.$=Q;this.Uda=document.createElement("div");
this.Uda.setAttribute(Se.a.LO,Se.a.rj);this.Uda.className=xf.a.y3c;ra.insertBefore(this.Uda,mb);this.ifa=document.createElement("div");this.ifa.setAttribute(Se.a.LO,Se.a.rj);this.ifa.className=xf.a.y3c;ra.insertBefore(this.ifa,this.Uda);this.Nfg=Tc.a.instance.Ya(2);this.jga=document.createElement("div");this.jga.setAttribute(Se.a.Wd,Se.a.aga);this.jga.setAttribute(Se.a.bga,Se.a.olb);this.jga.className=xf.a.y3c;ra.insertBefore(this.jga,this.ifa);this.register();this.$.ea.La(211,this)}function ge(Q,
ra){Ud.a.na(ra)||(Q.append(ra),Q.append(Ed.Xnd))}function Ed(Q){this.Moc=Q||""}function Zc(Q){var ra=Pd.call(this)||this;ra.$=Q;ra.fc();return ra}function he(Q){var ra=Md.call(this)||this;ra.vmd=null;ra.$=Q;Uc.ULS.sendTraceTag(544289228,0,50,"NewAndOpenCoreManager created");return ra}function Ke(){return tf.call(this)||this}function Ue(Q){var ra=Lg.call(this)||this;ra.$=Q;ra.fc();return ra}function Pb(Q){var ra=qg.call(this,document.documentElement,Q)||this;ra.pB=0;ra.VAg=[Of.a.eYc,Of.a.rrd,Of.a.e$b,
Of.a.MZf,Of.a.tEd,Of.a.fTc,Of.a.X6c,Of.a.PWe,Of.a.pSc,Of.a.iJb,Of.a.uij,Of.a.Jbd,Of.a.AUc,Of.a.Wqb,Of.a.SId,Of.a.HUc,Of.a.TVf,Of.a.KSc];ra.mBj=[Of.a.e$b,Of.a.a5f,Of.a.$4f,Of.a.b5f];ra.KIi=[Of.a.e$b,Of.a.Dyf,Of.a.Eyf,Of.a.Hyf];ra.RIg=[Of.a.fMe,Of.a.OWe,Of.a.V6c,Of.a.T6c];ra.nIi=[Of.a.eYc,Of.a.rrd,Of.a.fTc,Of.a.X6c,Of.a.pSc,Of.a.iJb,Of.a.Jbd,Of.a.AUc,Of.a.Wqb,Of.a.SId,Of.a.Yxf,Of.a.HUc,Of.a.KSc];var mb=Tc.a.instance.Ya(251);ra.C7i=ra.$.shortcutKeyManager.U7b(mb);ra.mode=0;Q.ea.La(15,ra);eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(Q.ea,
21,137,1,"Postmessage.IHostPostmessenger"),function(Qb){Qb=Qb.result;Qb.vn(sa.a.vjb);Qb.km(sa.a.vjb,Object(gd.a)(ra,ra.jFb,"resumeFocusWithDirection"))},Q.ma);return ra}function kb(){this.mjb=this.h7d=this.pb=null;this.ym=!1}function yb(Q,ra,mb,Qb,Sc,Ad,ye){this.sdb={};this.a1=Q;this.Ffg=ra;this.ypa=new jd(ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.BC.Vgc);this.bqa=new jd(ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.BC.Vgc);this.aig=mb;this.rbe=Qb;this.pmg={};this.iS=new Zd;this.Vcg=Sc;this.FQb="";this.sv=Ad;this.JYd=ye;return this}function Ma(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function jd(Q,ra,mb){this.task=
null;this.uac=Q;this.Lgi=ra;this.taskManager=mb;this.retryCount=this.evb=0;this.kJc=this.Bxb=null}function Zd(){this._state=0;this.k4d=this.m4d=this.l4d=null;this.state=this.bae=0;this.GEc=!1;return this}function Zb(Q,ra,mb,Qb,Sc){this.Vdg=6E4;this.E0e="inactive";this.$be="active";this.kX=!0;this.re=Q;this.Zcg=ra;this.jDc=mb;this.yTb=Qb;this.rb=new ff.a;Sc&&this.Kkj();this.c2d=this.DRe()}function wb(Q,ra){this.sdb={};this.a1=Q;this.mib=new gc(ra,this.gzb.Vgc,"GetMoreInfo");this.ft=new id;return this}
function gc(Q,ra,mb){this.xSb=this.Oi=null;this.aKc=0;this.fjg=Q;this.re=ra;this.PXd=mb}function uc(Q,ra,mb,Qb,Sc,Ad,ye,Ze){this.Oa=Q;this.Ug=ra;this.A9f=mb;this.A0=Qb;this.re=Sc;this.jDc=Ad;this.qdg=ye;this.kTb=Ze}function id(){this._state=0;this.MLc=this.ZIc=null;this.state=0;this.GEc=this.k0d=!1;return this}function Wc(){this._state=0}function pd(){this.sdb={}}function Yd(){this.pb=null}function be(){this.OTa=null}function me(Q){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
ce.AFrameworkApplication.ha.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,ce.AFrameworkApplication.hj)}function Gd(Q){var ra=new Ge.a;ce.AFrameworkApplication.Md.Wl(me(Q),1,null,null,!0,2,function(mb){200===mb.data.httpStatus?ra.setResult("true"===mb.data.pe.toLowerCase()):ra.setResult(!1)},function(){ra.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ra.task}function Rd(Q,ra){this.Oa=Q;this.tMb=ra}function Yf(Q){var ra=Fc.call(this,!1,!1,!0)||this;ra.tMb=Q;return ra}function mg(Q,
ra){this.ID=Q;this.type=ra}function zf(Q,ra){this.value=Q;this.contextId=ra}function Ce(Q,ra,mb,Qb,Sc,Ad,ye,Ze){this.type=Q;this.startTime=null==mb||void 0==mb.value?new zf(mb,null):mb;this.endTime=null==Qb||void 0==Qb.value?new zf(Qb,null):Qb;null!=Sc&&void 0!=Sc.value||new zf(Sc,null);null!=Ad&&void 0!=Ad.value||new zf(Ad,null);this.operationType=Ze}function ne(Q){this.ID=Q}function Bf(){this.Se=[];this.$kb=[];this.BQc=0;this.duration=this.startTime=null;this.s3b={};this.epd=this.Gpd=this.WRc=-1}
b.r(F);var Le=b(0),gd=b(37),$b=b(140),Fc=$b.a;Cm(Yf,Fc);Yf.prototype.start=function(){var Q={},ra={};Q=(ra.id="AccessibilitySettingsDialog",ra.bodyControls=(Q.tooltipPersistenceEnabled=this.tMb.Q_e,Q),ra);this.initializeAndShow("",Object(gd.a)(this,this.PZi,"resultHandler"),Q)};Yf.prototype.PZi=function(Q,ra){1===Q&&(this.tMb.Q_e=ra.tooltipPersistenceEnabled)};Object(Le.a)(Yf,"AccessibilitySettingsDialog",$b.a,[]);var Vc=b(111),ud=b(29);Rd.prototype.Rg=function(){this.Oa.$b(ud.a.Qej,Vc.a.frame,Object(gd.a)(this,
this.Rej,"showAccessibilitySettingsDialogHandler"))};Rd.prototype.Rej=function(){(new Yf(this.tMb)).start();return 32};Object(Le.a)(Rd,"AccessibilitySettingsDialogActor",null,[229]);var Ge=b(139),ce=b(5),Ae=b(242);be.prototype.Lai=function(){var Q=this,ra=new Ge.a;if(this.OTa)ra.setResult(this.OTa);else if(this.V7e()){var mb=Gd("getHoverableRibbonTooltipIsEnabled");mb.continueWith(function(){Q.OTa=mb.result;Ae.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(mb.result);
ra.setResult(mb.result)},8)}else ra.setResult(!1)};be.prototype.V7e=function(){var Q=ce.AFrameworkApplication.ha.ta("IsRoamingServiceEnabled"),ra=ce.AFrameworkApplication.ha.ta("IsAnonymousUser");return Q&&!ra};Jl.Object.defineProperties(be.prototype,{Q_e:{configurable:!0,enumerable:!0,get:function(){return!!this.OTa},set:function(Q){Q!==this.OTa&&(this.OTa=Q,Ae.apiExists("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.V7e()&&ce.AFrameworkApplication.Md.Wl(me("saveHoverableRibbonTooltipIsEnabled"),
2,Q.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(Le.a)(be,"AccessibilitySettingsInfo",null,[222]);var Ob=b(274),ac=b(165);Yd.prototype.$h=function(Q){var ra=this;this.pb=Q;Yd.U4e()&&(this.pb.register(be,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Lc(function(){return new be}).Ac(),this.pb.register(Rd,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Lc(function(){return new Rd(ce.AFrameworkApplication.Hb,
ra.pb.Uh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Ac())};Yd.prototype.init=function(){if(Yd.U4e()){var Q=this.pb.Uh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ra=this.pb.Uh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&ra?(ra.Rg(),Q.Lai()):ac.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}};Yd.prototype.dispose=function(){};Yd.main=function(){Ob.a.instance.oj(new Yd)};
Yd.U4e=function(){Yd.dFc||(Yd.dFc=ce.AFrameworkApplication.ha?ce.AFrameworkApplication.ha.ta("AccessibilitySettingsDialogIsEnabled")&&ce.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AccessibilitySettingsDialogIsEnabled",!1):!1);return Yd.dFc};Jl.Object.defineProperties(Yd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Yd.dFc=null;Object(Le.a)(Yd,"AccessibilitySettingsPackage",null,[8,9]);var fc=b(675),Uc=
b(15);pd.prototype.Ymg=function(Q){this.sdb[Q.id.toString()]=Q};pd.prototype.pli=function(Q){var ra=this.sdb,mb;for(mb in ra)ra[mb].notify(Q,!1);this.sdb={}};pd.prototype.sKi=function(Q,ra){ra&&this.Ymg(ra);return this.trf(Q,ra)};pd.prototype.i2c=function(Q){this.pli(Q)};pd.prototype.hCe=function(Q,ra){Q.notify(ra,!0)};Object(Le.a)(pd,"AEventEmitter",null,[620]);var Vd;(function(Q){Q[Q.notStarted=0]="notStarted";Q[Q.waiting=1]="waiting";Q[Q.shouldRetry=2]="shouldRetry";Q[Q.complete=3]="complete"})(Vd||
(Vd={}));Object(Le.b)("EventResultState",Vd);Jl.Object.defineProperties(Wc.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(Q){var ra={};Uc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(ra.OldState=Vd[this._state],ra.NewState=Vd[Q],ra),"ResultType",this.RTe());this._state=Q}}});Object(Le.a)(Wc,"AEventResult",null,[640]);Cm(id,Wc);id.prototype.RTe=function(){return"GetMoreInfo Result"};Jl.Object.defineProperties(id.prototype,{G5:{configurable:!0,
enumerable:!0,get:function(){return this.ZIc}},rza:{configurable:!0,enumerable:!0,get:function(){return this.MLc}},MXh:{configurable:!0,enumerable:!0,get:function(){return this.k0d}}});Object(Le.a)(id,"GetMoreInfoResult",Wc,[641,640]);var ld=b(75),Od=b(49),De=b(789),Yb=b(523),sa=b(177),hb=b(678),cc=b(590);uc.prototype.EPi=function(){this.Z5a.$b(ud.a.openUrlInNewTab,Vc.a.frame,Object(gd.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.Z5a.$b(ud.a.VMa,Vc.a.frame,Object(gd.a)(this,this.VMa,"openDocumentUrl"));
ce.AFrameworkApplication.sP?this.ucf():this.Z5a.Jf(ud.a.R2b,Vc.a.frame,Object(gd.a)(this,this.R2b,"documentLoaded"),96)};uc.prototype.openUrlInNewTab=function(Q,ra,mb,Qb,Sc){Sc&&Sc.MenuItemId&&(Q={},Uc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(Q.Id=Sc.SourceControlId,Q.AppType=cc.a[this.gba],Q)),Od.a.wf(Sc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};uc.prototype.VMa=function(Q,ra,mb,Qb,Sc){if(Sc&&Sc.MenuItemId){var Ad=ce.AFrameworkApplication.ha.ta("WacInTabOpenMRUIsEnabledForUiHost"),
ye=ce.AFrameworkApplication.ha.ta("UiHostSupportsDocRebootFeatures");Uc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ad,ye);if(Ad&&ye){Q={};Uc.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(Q.Id=Sc.SourceControlId,Q.AppType=cc.a[this.gba],Q));Sc=Sc.MenuItemId.toString();var Ze={};Ze[Yb.a.TNa]="1";Ze[Yb.a.documentUrl]=Sc;Ze[Yb.a.reason]=hb.a.open;Uc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");
ce.AFrameworkApplication.$Y().execute(function(sd){sd.Yj(sa.a.tsa,Ze)})}else this.openUrlInNewTab(Q,ra,mb,Qb,Sc)}return 32};uc.prototype.R2b=function(){this.ucf();return 32};uc.prototype.LLa=function(Q,ra,mb){mb=void 0===mb?"":mb;if(ra&&ra.qE){var Qb=De.a[ra.status];ra=ra.qE.getTime();var Sc=this.Rv()-ra,Ad={};Uc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(Ad.Caller=Q,Ad.RequestStatus=Qb,Ad.ElapsedMs=Sc,Ad.StartTime=ra,Ad.Notes=mb,Ad))}else mb={},Uc.ULS.sendTraceTag(5849680,
202,50,"Attempted to make a request to the WAC server with null request item {0}",(mb.Caller=Q,mb))};uc.prototype.ucf=function(){var Q=ce.AFrameworkApplication.ha.ta("QPGVCI"),ra=ld.a.Jy(document.URL,"wdNewAndOpenCt",Q);if(ra){ra=parseInt(ra);var mb=ld.a.Jy(document.URL,"wdPreviousSession",Q);Q=ld.a.Jy(document.URL,"wdPreviousCorrelation",Q);var Qb=ce.AFrameworkApplication.ha.ta("NAOPLP");if(ce.AFrameworkApplication.sP){var Sc=ce.AFrameworkApplication.sP.getTime();if(!ra||ra>Sc)Qb={},Uc.ULS.sendTraceTag(5849682,
202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(Qb.ClickTimestamp=ra,Qb.DocumentLoadedTime=Sc,Qb.SessionId=mb,Qb.Correlation=Q,Qb));else{var Ad={};Uc.ULS.sendTraceTag(5849683,202,Qb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(Ad.ClickToLoadTime=Sc-ra,Ad.ClickTimestamp=ra,Ad.SessionId=mb,Ad.Correlation=Q,Ad))}}else Sc={},Uc.ULS.sendTraceTag(5849681,202,Qb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
(Sc.ClickTimestamp=ra,Sc.SessionId=mb,Sc.Correlation=Q,Sc))}};uc.iU=function(){return new uc(new fc.a(function(){return ce.AFrameworkApplication.Hb}),new fc.a(function(){return ce.AFrameworkApplication.Md}),new fc.a(function(){return ce.AFrameworkApplication.za}),new fc.a(function(){return ce.AFrameworkApplication.za.Za.Xk}),new fc.a(function(){return ce.AFrameworkApplication.$j}),function(){return(new Date).getTime()},new fc.a(function(){return ce.AFrameworkApplication.za.Za.PZ}),new fc.a(function(){return ce.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
Jl.Object.defineProperties(uc.prototype,{Z5a:{configurable:!0,enumerable:!0,get:function(){return this.Oa.value}},yzb:{configurable:!0,enumerable:!0,get:function(){return this.Ug.value}},hhf:{configurable:!0,enumerable:!0,get:function(){return this.A9f.value}},gba:{configurable:!0,enumerable:!0,get:function(){return this.A0.value}},Vgc:{configurable:!0,enumerable:!0,get:function(){return this.re.value}},Rv:{configurable:!0,enumerable:!0,get:function(){return this.jDc}},PZ:{configurable:!0,enumerable:!0,
get:function(){return this.qdg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.kTb.value}}});Jl.Object.defineProperties(uc,{instance:{configurable:!0,enumerable:!0,get:function(){return uc.Pa||(uc.Pa=uc.iU())}}});uc.Pa=null;Object(Le.a)(uc,"NewAndOpenCommonHelpers",null,[619]);var xc=b(112);gc.prototype.Svg=function(){this.aKc=this.H9a+1};gc.prototype.KDd=function(Q){this.Oi&&(this.re.xp(this.Oi),this.Oi=null);Q&&(this.aKc=0)};gc.prototype.Skj=
function(Q){var ra=this.Ppj;0<=ra?(this.Svg(),this.KDd(!1),this.Oi=new xc.a(4,1,ra,Q,107),this.re.sh(this.Oi)):(this.KDd(!0),Q={},Uc.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(Q.Action=this.PXd,Q)))};Jl.Object.defineProperties(gc.prototype,{H9a:{configurable:!0,enumerable:!0,get:function(){return this.aKc}},Ppj:{configurable:!0,enumerable:!0,get:function(){return this.H9a>=this.KMf.length?-1:this.KMf[this.H9a]}},KMf:{configurable:!0,enumerable:!0,get:function(){if(!this.xSb){var Q=(this.fjg.value||
"0").split(",");this.xSb=[];for(var ra=0;ra<Q.length;ra++){var mb=parseInt(Q[ra]);isNaN(mb)?(mb={},Uc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(mb.Action=this.PXd,mb.Entry=Q[ra],mb))):Array.add(this.xSb,mb)}}return this.xSb}}});Object(Le.a)(gc,"RetryHelper",null,[]);var vd=b(41),Xd=b(30);Cm(wb,pd);wb.prototype.mfi=function(){this.Mod("Document opened")};wb.prototype.jVg=function(Q){var ra=this;return function(){ra.Mod(Q,!0)}};wb.prototype.trf=function(Q,
ra){ra=void 0===ra?null:ra;var mb={};Uc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(mb.Trigger=Q,mb));3===this.ft.state?(ra&&this.hCe(ra,this.ft),ra={},Uc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(ra.Trigger=Q,ra))):this.Mod(Q);return this.ft};wb.prototype.Mod=function(Q,ra){this.mib.KDd(!(void 0===ra?0:ra));1===this.ft.state?(ra={},Uc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
(ra.Trigger=Q,ra.RetryIndex=this.mib.H9a,ra))):(ra={},Uc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(ra.Trigger=Q,ra.RetryIndex=this.mib.H9a,ra)),this.ft.state=1,ra=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.gzb.PZ,ce.AFrameworkApplication.hj),this.gzb.yzb.J8(ra,1,null,null,[wb.m6d,wb.j$d],!1,5,this.lUg(),this.kUg(Q),null))};wb.prototype.lUg=function(){var Q=this;return function(ra){var mb=!1,Qb=!1,Sc=!1;if(ce.AFrameworkApplication.ha.ta("GetMoreInfoDataFromResponseBody"))if(ra.data.pe){var Ad=
vd.d(ra.data.pe);var ye=Ad.xu;Ad.returnValue?ye?(Sc=!0,Q.ft.MLc=ye.StorageServiceDisplayName,Q.ft.ZIc=wb.q9e(ye.PersonalFileStorageUrl)?ye.PersonalFileStorageUrl:"",mb=""===Q.ft.G5&&""!==Q.ft.rza):Uc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Uc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else Uc.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");Sc||((ye=ra.data.responseHeaders)?(Q.ft.MLc=(ye[wb.j$d]||"").toString(),mb=(ye[wb.m6d]||"").toString(),Q.ft.ZIc=wb.q9e(mb)?mb:"",mb=""===mb&&""!==Q.ft.rza):(Uc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Qb=!0));Sc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",Q.mib.H9a,Qb,mb,Sc);
Q.gzb.LLa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ra.data,Sc);Q.cNf(3,mb,Qb)}};wb.prototype.kUg=function(Q){var ra=this;return function(mb){ra.gzb.LLa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",mb.data,"Failure");ra.cNf(2);ra.mib.Skj(ra.jVg(Q))}};wb.prototype.cNf=function(Q,ra,mb){this.ft.state=Q;this.ft.k0d=void 0===ra?!1:ra;this.ft.GEc=void 0===mb?!1:mb;this.i2c(this.ft)};wb.iU=function(){return new wb(new fc.a(function(){return uc.instance}),new fc.a(function(){return ce.AFrameworkApplication.dDh}))};
wb.q9e=function(Q){if(!Q)return Uc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Xd.a.un(Q).startsWith("https://"))return!0;Uc.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};Jl.Object.defineProperties(wb.prototype,{gzb:{configurable:!0,enumerable:!0,get:function(){return this.a1.value}}});Jl.Object.defineProperties(wb,{instance:{configurable:!0,enumerable:!0,get:function(){return wb.Pa||(wb.Pa=wb.iU())}}});wb.m6d=
"PersonalFileStorageUrl";wb.j$d="StorageServiceDisplayName";wb.Pa=null;Object(Le.a)(wb,"GetMoreInfoActor",pd,[]);var Je=b(98),ff=b(94);Zb.prototype.Tce=function(Q){this.rb.addHandler(this.$be,Q)};Zb.prototype.ppg=function(Q){this.rb.addHandler(this.E0e,Q)};Zb.prototype.Kkj=function(){var Q=new xc.a(5,2,this.Vdg,Object(gd.a)(this,this.cTh,"inactiveLoop"),108);this.dTh.sh(Q)};Zb.prototype.cTh=function(){var Q=this.DRe(),ra=this.Rv()-Q;if(ra>this.yuc&&this.kX){var mb={};Uc.ULS.sendTraceTag(5849626,202,
50,"User went inactive {0}",(mb.TimeSinceLastActive=ra,mb));this.kX=!1;this.rb.raiseEvent(this.E0e)}Q-this.c2d>this.yuc&&(this.kX=!0,this.rb.raiseEvent(this.$be));this.c2d=Q};Zb.iU=function(){return new Zb(new fc.a(function(){return Je.a.instance}),function(){return ce.AFrameworkApplication.oaf.getTime()},function(){return(new Date).getTime()},new fc.a(function(){return ce.AFrameworkApplication.yuc}),!0)};Jl.Object.defineProperties(Zb.prototype,{dTh:{configurable:!0,enumerable:!0,get:function(){return this.re.value}},
DRe:{configurable:!0,enumerable:!0,get:function(){return this.Zcg}},Rv:{configurable:!0,enumerable:!0,get:function(){return this.jDc}},yuc:{configurable:!0,enumerable:!0,get:function(){return this.yTb.value}}});Jl.Object.defineProperties(Zb,{instance:{configurable:!0,enumerable:!0,get:function(){return Zb.Pa||(Zb.Pa=Zb.iU())}}});Zb.Pa=null;Object(Le.a)(Zb,"InactivityManager",null,[]);var Ye=b(82),Pe=b(1027);Cm(Zd,Wc);Zd.prototype.RTe=function(){return"MruActor Result"};Jl.Object.defineProperties(Zd.prototype,
{aqd:{configurable:!0,enumerable:!0,get:function(){return this.l4d}},zgf:{configurable:!0,enumerable:!0,get:function(){return this.m4d}},$pd:{configurable:!0,enumerable:!0,get:function(){return this.k4d}},Tpj:{configurable:!0,enumerable:!0,get:function(){return this.bae}}});Object(Le.a)(Zd,"MruResult",Wc,[639,640]);var wf=b(228);jd.prototype.g4h=function(Q,ra){return Q===wf.a.L6c||20===ra||18===ra||3===ra};jd.prototype.m5h=function(Q){return 3===Q||5===Q||6===Q||7===Q||9===Q||10===Q||11===Q||12===
Q||13===Q||14===Q||15===Q||16===Q||23===Q||26===Q||27===Q||28===Q};jd.prototype.reset=function(){this.evb=this.retryCount=0;this.kJc=this.Bxb=null;this.task&&(this.taskManager.xp(this.task),this.task=null)};jd.prototype.SWh=function(Q,ra,mb,Qb){this.kJc=String.format("{0}_{1}",mb,Qb);if(this.retryCount>=this.Lgi)return Uc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.g4h(mb,Qb))return Uc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.m5h(Qb)&&
1<=this.evb)return this.Bxb=mb,!1;ra=Math.max(ra,this.uac*Math.pow(2,this.evb));if(26===Qb)ra=Math.max(ra,3E4);else if(27===Qb||28===Qb)ra=Math.max(ra,6E4);9===Qb||412===mb&&(null==this.Bxb||412!==this.Bxb)?ra=500:this.evb+=1;this.Bxb=mb;this.retryCount+=1;this.task&&this.taskManager.xp(this.task);Uc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ra);this.task=new xc.a(2,1,ra,Q,107);this.taskManager.sh(this.task);return!0};Jl.Object.defineProperties(jd.prototype,{mlc:{configurable:!0,
enumerable:!0,get:function(){return this.kJc}}});Object(Le.a)(jd,"RetryManager",null,[]);var lf=b(93);Object(Le.a)(Ma,"WriteOptions",null,[]);var kg=b(576),Bg=b(176);Cm(yb,pd);yb.prototype.gRi=function(){this.BC.Z5a.$b(ud.a.renameMostRecentlyUsedFileEntry,Vc.a.frame,Object(gd.a)(this,this.YVi,"renameMruEntry"))};yb.prototype.YVi=function(){return this.MSd("Rename")};yb.prototype.ufi=function(){this.Aef("File Opened")};yb.prototype.vfi=function(){this.Aef("IntervalUpdate")};yb.prototype.Aef=function(Q){var ra=
{};Uc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(ra.Trigger=Q,ra));this.MSd(Q)};yb.prototype.I$=function(Q){(Q=Xd.a.I$(Q))&&Q.startsWith(".")&&(Q=Q.substring(1,Q.length));return Q};yb.prototype.TNe=function(){switch(this.BC.gba){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};yb.prototype.xKh=function(Q){var ra=this.Vcg();if(!ra)return null;var mb=new Ma;mb.documentUrl=this.JYd.value?
encodeURI(ra):ra;mb.mruItemId=this.FQb;mb.app=this.TNe();if(ra=this.sv())mb.folderName=ra.breadcrumbFolderName,ra=ra.zn,mb.documentName=Xd.a.Pq(ra),mb.documentExt=this.I$(ra);Q&&(mb.documentName?mb.documentName.length?255<=mb.documentName.length?Q.set("DocumentNameLength","Long"):2084<=mb.documentName.length&&Q.set("DocumentNameLength","VeryLong"):Q.set("DocumentNameLength","0"):Q.set("DocumentNameLength","Null"));return JSON.stringify(mb)};yb.prototype.MSd=function(Q,ra){ra=void 0===ra?!1:ra;if(4===
this.BC.gba&&!ce.AFrameworkApplication.TGa)return 2;var mb=this.xs();mb&&(mb.set("Trigger",Q),mb.set("IsRetry",ra?"true":"false"),mb.set("MruIdSent",this.FQb?"true":"false"),mb.set("URLEncoded",this.JYd.value?"true":"false"));lf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",mb);Q=this.xKh(mb);if(!Q)return ra=!ce.AFrameworkApplication.webEditingEnabled,mb&&(mb.set("WebEditingIsEnabled",ce.AFrameworkApplication.webEditingEnabled?"true":"false"),mb.set("ProtectedFile",ce.AFrameworkApplication.wlc?
"true":"false")),lf.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ra,!1,Object.assign(new Bg.a,{extendedProperties:mb})),2;this.bqa&&!ra&&this.bqa.reset();mb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.BC.PZ,this.localeName);this.rbe?this.xxc["X-FileId"]=ce.AFrameworkApplication.hj:mb+=String.format("&{0}",ce.AFrameworkApplication.hj);ce.AFrameworkApplication.Kb&&(this.xxc["X-Office-AudienceGroup"]=Object(Ye.a)(String,ce.AFrameworkApplication.Kb.AudienceGroup)||"");
this.xxc["X-Timeout"]=ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteTimeout",1E4);return this.BC.yzb.Wl(mb,2,Q,this.xxc,!0,5,Object(gd.a)(this,this.aDj,"writeMruV2EntryOnServerSuccessCallback"),Object(gd.a)(this,this.SYg,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};yb.prototype.aDj=function(Q){this.UXe(Q.data)};yb.prototype.UXe=function(Q){var ra=this.xs();this.bqa&&(ra&&this.bqa.mlc&&(ra.set("LastError",this.bqa.mlc),
ra.set("NumRetries",this.bqa.retryCount.toString())),this.bqa.reset());var mb=Pe.c(Q.pe);mb&&mb.diagnostics_data&&(this.FQb=mb.diagnostics_data.mru_id);Q=+Q.u2-+Q.qE;ra&&ra.set("RequestDuration",Q.toString());lf.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Bg.a,{extendedProperties:ra}))};yb.prototype.SYg=function(Q){if(Q.data.httpStatus===wf.a.Bob)this.UXe(Q.data);else{var ra=Q.data.httpStatus===wf.a.QCb,mb=this.xs();this.cYe(this.bqa,Q,this.IYg(),mb);mb&&(mb.set("StatusCode",Q.data.httpStatus.toString()),
ra||this.qOc(Q.data,mb));lf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Q.data.httpStatus),ra,!1,Object.assign(new Bg.a,{extendedProperties:mb}))}};yb.prototype.IYg=function(){var Q=this;return function(){Q.MSd("Retry",!0)}};yb.prototype.jDh=function(){this.Qfc("Polling")};yb.prototype.iDh=function(){this.Qfc("Retry",!0)};yb.prototype.ofi=function(){this.Qfc("Open")};yb.prototype.nfi=function(){this.Qfc("Activity")};yb.prototype.Qfc=function(Q,ra){ra=void 0===ra?
!1:ra;var mb={};Uc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(mb.Trigger=Q,mb));if(mb=this.xs())mb.set("Trigger",Q),mb.set("IsRetry",ra?"true":"false");lf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",mb);this.ypa&&!ra&&this.ypa.reset();this.mUg(Object(gd.a)(this,this.kDh,"getMruV2FromServerSuccessCallback"),Object(gd.a)(this,this.hDh,"getMruFromServerFailureCallback"))};yb.prototype.qOc=function(Q,ra){Q&&Q.responseHeaders&&(Q=Q.responseHeaders["X-CorrelationId"])&&ra.set("ServerCorrelationId",
Q)};yb.prototype.xs=function(){try{return new Map}catch(Q){return null}};yb.prototype.Aci=function(Q,ra){Q&&(ra&&ra.set("RequestDuration",(+Q.u2-+Q.qE).toString()),lf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Bg.a,{extendedProperties:ra})))};yb.prototype.kDh=function(Q){var ra="",mb=null,Qb=null,Sc=null,Ad=Pe.c(Q.data.pe);Ad&&(mb=Ad.places?Ad.places.items:[],Qb=Ad.documents?Ad.documents.items:[],(Sc=Pe.a(Ad))&&(ra=vd.c(Sc)));ce.AFrameworkApplication.za&&ce.AFrameworkApplication.za.Za.wZ&&
Ae.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ra,!0));ra=this.xs();this.ypa&&(ra&&this.ypa.mlc&&(ra.set("LastError",this.ypa.mlc),ra.set("NumRetries",this.ypa.retryCount.toString())),this.ypa.reset());Sc||mb||Qb?(this.BC.LLa("MruActor.GetMruV2FromServerSuccessCallback",Q.data,"Success"),this.ewc(3,Sc,mb,Qb),this.Aci(Q.data,ra)):(this.BC.LLa("MruActor.GetMruV2FromServerSuccessCallback",Q.data,"Failure: Invalid JSON"),ra&&this.qOc(Q.data,ra),lf.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new Bg.a,{extendedProperties:ra})),this.ewc(3,null,null,null,!0));this.i2c(this.iS)};yb.prototype.cYe=function(Q,ra,mb,Qb){var Sc=0,Ad=0,ye=Pe.c(ra.data.pe);ye&&(null!=ye.response_code&&(Sc=ye.response_code,Qb&&Qb.set("MruResponseCode",Sc.toString()),9===Sc&&(this.FQb="")),ye.error_data&&null!=ye.error_data.retry_after_ms&&(Ad=ye.error_data.retry_after_ms,Qb&&Qb.set("ExpectedRetryAfter",Ad.toString())));Q&&(ra=Q.SWh(mb,Ad,ra.data.httpStatus,Sc),Qb&&(Qb.set("CurrentRetryCount",
Q.retryCount.toString()),Qb.set("RetryScheduled",ra?"true":"false")))};yb.prototype.hDh=function(Q){var ra=Q.data.httpStatus===wf.a.QCb,mb=this.xs();mb&&(mb.set("StatusCode",Q.data.httpStatus.toString()),ra||this.qOc(Q.data,mb));this.BC.LLa("MruActor.GetMruFromServerFailureCallback",Q.data,"Failure");this.ewc(2);this.cYe(this.ypa,Q,Object(gd.a)(this,this.iDh,"getMruFromServerRetryTask"),mb);lf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Q.data.httpStatus),ra,!1,Object.assign(new Bg.a,
{extendedProperties:mb}));this.i2c(this.iS);ce.AFrameworkApplication.za&&ce.AFrameworkApplication.za.Za.wZ&&Ae.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1))};yb.prototype.ewc=function(Q,ra,mb,Qb,Sc){if(3!==this.iS.state||3===Q)this.iS.l4d=void 0===ra?null:ra,this.iS.m4d=void 0===mb?null:mb,this.iS.k4d=void 0===Qb?null:Qb,this.iS.state=Q,this.iS.GEc=void 0===Sc?!1:Sc,this.iS.bae=this.BC.Rv()};yb.prototype.trf=function(Q,ra){var mb={};Uc.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",(mb.Trigger=Q,mb.ResultState=this.iS.state,mb));ra&&3===this.iS.state&&this.hCe(ra,this.iS);return this.iS};yb.prototype.mUg=function(Q,ra){this.ewc(1);var mb={};var Qb=String.format(this.BC.PZ+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.TNe(),this.localeName);this.aig.value||(Qb+="&entity=docs");ce.AFrameworkApplication.Kb&&(mb["X-Office-AudienceGroup"]=Object(Ye.a)(String,ce.AFrameworkApplication.Kb.AudienceGroup)||"");this.rbe?mb["X-FileId"]=
ce.AFrameworkApplication.hj:Qb+=String.format("&{0}",ce.AFrameworkApplication.hj);this.BC.yzb.Wl(Qb,1,null,mb,!0,5,Q,ra,null)};yb.iU=function(){return new yb(new fc.a(function(){return uc.instance}),new fc.a(function(){return kg.a.pJ(ce.AFrameworkApplication.lcid).name}),new fc.a(function(){return ce.AFrameworkApplication.za.Za.Ju}),ce.AFrameworkApplication.ha.ta("MruWriteFileIdInHeader"),function(){return ce.AFrameworkApplication.za.Za.LB},function(){return ce.AFrameworkApplication.zl},new fc.a(function(){return ce.AFrameworkApplication.ha.ta("OICEncodeUrlIsEnabled")}))};
Jl.Object.defineProperties(yb.prototype,{xxc:{configurable:!0,enumerable:!0,get:function(){return this.pmg}},BC:{configurable:!0,enumerable:!0,get:function(){return this.a1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Ffg.value}}});Jl.Object.defineProperties(yb,{instance:{configurable:!0,enumerable:!0,get:function(){return yb.Pa||(yb.Pa=yb.iU())}}});yb.Pa=null;Object(Le.a)(yb,"MruActor",pd,[]);kb.prototype.$h=function(Q){this.pb=Q;Q.register(619,"Common.INewAndOpenCommonHelpers").Ac().Lc(function(){return uc.instance});
Q.register(620,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Ac().Lc(function(){return wb.instance});Q.register(620,"Common.IEventEmitter<Common.IMruResult>").Ac().Lc(function(){return yb.instance})};kb.prototype.init=function(){var Q=this;ce.AFrameworkApplication.ha.Xv(function(){Q.Nub()})};kb.prototype.Nub=function(){this.pb.resolve("Common.INewAndOpenCommonHelpers");this.pb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.pb.resolve("Common.IEventEmitter<Common.IMruResult>");
var Q=!1;uc.instance.EPi();ce.AFrameworkApplication.qka&&(Q=!0);ce.AFrameworkApplication.JBf&&(yb.instance.ofi(),0<ce.AFrameworkApplication.Agf&&this.wde(),this.Saj(),Q=!0);ce.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Q&&wb.instance.mfi();ce.AFrameworkApplication.Bxj&&(Q=yb.instance,Q.gRi(),Q.ufi(),Je.a.instance.sh(this.Cxj))};kb.prototype.Saj=function(){Zb.instance.Tce(Object(gd.a)(yb.instance,yb.instance.nfi,"makeGetMruRequestActivityTrigger"));Zb.instance.Tce(Object(gd.a)(this,
this.wde,"addGetMruFromServerTask"));Zb.instance.ppg(Object(gd.a)(this,this.V0g,"deleteGetMruFromServerTask"))};kb.prototype.V0g=function(){Je.a.instance.xp(this.Bgf)};kb.prototype.wde=function(){Je.a.instance.sh(this.Bgf)};kb.prototype.dispose=function(){this.ym||(this.ym=!0,this.mjb&&(Je.a.instance.xp(this.mjb),this.mjb=null))};Jl.Object.defineProperties(kb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},Bgf:{configurable:!0,enumerable:!0,get:function(){return this.h7d||
(this.h7d=new xc.a(5,2,ce.AFrameworkApplication.Agf,Object(gd.a)(yb.instance,yb.instance.jDh,"getMruFromServerTask"),109))}},Cxj:{configurable:!0,enumerable:!0,get:function(){return this.mjb||(this.mjb=new xc.a(2,2,6E4*ce.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(gd.a)(yb.instance,yb.instance.vfi,"makeUpdateMruTask"),197))}}});Object(Le.a)(kb,"CorePackageManager",null,[8,9,7]);var Qf=b(514);new mg(0,0,0,0,0,0);new mg(1,1,0,0,
0,0);new mg(2,2,0,0,0,0);new mg(3,3,0,0,0,1);new mg(4,3,1,0,1,1);new mg(5,3,0,0,.42,1);new mg(6,3,.83,0,1,1);new mg(7,3,0,0,.58,1);new mg(8,3,.42,0,.58,1);new mg(9,3,.1,.25,.75,.9);new mg(10,3,.1,.9,.2,1);new mg(11,3,.1,.9,.2,1);new mg(12,3,.9,.1,.2,1);new mg(13,3,.4,0,0,1);new mg(14,3,.13,.21,.1,.7);new mg(15,3,.02,.33,.38,.77);new mg(16,3,.57,.17,.95,.75);new mg(17,3,0,.19,.07,.72);new mg(18,3,0,0,.95,.37);new mg(19,3,.66,0,.34,1);new mg(20,3,.8,0,.2,1);Ce.prototype={type:0,startTime:new zf(0,null),
endTime:new zf(0,null),SFj:new zf(0,null),MEj:new zf(0,null),operationType:0};new ne(0,[new Ce(5,0,0,0,null,1,1,0)]);new ne(1,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,50,null,1,1,0)]);new ne(2,[new Ce(1,3,0,167,null,0,1,1),new Ce(2,3,0,167,null,0,1,1)]);new ne(3,[new Ce(3,3,0,167,null,0,1,1),new Ce(4,3,0,167,null,0,1,1)]);new ne(4,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,167,null,1,1,0)]);new ne(5,[new Ce(5,2,0,167,null,0,1,0)]);new ne(6,[new Ce(1,3,0,100,null,0,1,1),new Ce(2,3,0,100,null,0,1,1)]);
new ne(7,[new Ce(3,3,0,100,null,0,1,1),new Ce(4,3,0,100,null,0,1,1)]);new ne(8,[new Ce(5,2,0,100,null,1,1,0)]);new ne(9,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,100,null,1,1,0)]);new ne(10,[new Ce(5,2,0,100,null,0,1,0)]);new ne(11,[new Ce(1,3,0,267,null,0,1,1),new Ce(2,3,0,267,null,0,1,1)]);new ne(12,[new Ce(3,3,0,267,null,0,1,1),new Ce(4,3,0,267,null,0,1,1)]);new ne(13,[new Ce(5,2,0,267,null,1,1,0)]);new ne(14,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,267,null,1,1,0)]);new ne(15,[new Ce(5,2,0,267,
null,0,1,0)]);new ne(16,[new Ce(6,3,0,267,null,0,1,1),new Ce(7,3,0,267,null,0,1,1)]);new ne(17,[new Ce(1,3,0,750,null,0,1,1),new Ce(2,3,0,750,null,0,1,1)]);new ne(18,[new Ce(3,3,0,750,null,0,1,1),new Ce(4,3,0,750,null,0,1,1)]);new ne(19,[new Ce(5,2,0,750,null,1,1,0)]);new ne(20,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,750,null,1,1,0)]);new ne(21,[new Ce(6,3,0,1E3,null,0,1,1),new Ce(7,3,0,1E3,null,0,1,1)]);new ne(22,[new Ce(1,3,0,367,null,0,1,1),new Ce(2,3,0,367,null,0,1,1)]);new ne(23,[new Ce(3,3,
0,367,null,0,1,1),new Ce(4,3,0,367,null,0,1,1)]);new ne(24,[new Ce(5,2,0,367,null,1,1,0)]);new ne(25,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,367,null,1,1,0)]);new ne(26,[new Ce(5,2,0,367,null,0,1,0)]);new ne(27,[new Ce(5,2,0,0,null,1,1,0),new Ce(5,2,0,50,null,0,1,0)]);new ne(28,[new Ce(1,3,0,433,null,0,1,1),new Ce(2,3,0,433,null,0,1,1)]);new ne(29,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,50,null,1,1,0),new Ce(2,3,0,0,null,40,1,1),new Ce(2,3,0,100,null,0,1,1)]);new ne(30,[new Ce(2,0,0,0,null,32,1,
1),new Ce(2,0,0,100,null,32,1,1),new Ce(2,3,101,350,null,0,1,1),new Ce(3,0,0,0,null,0,2,1),new Ce(3,0,0,100,null,0,2,1),new Ce(3,3,101,350,null,0,1,1),new Ce(5,0,0,0,null,0,2,0),new Ce(5,0,0,100,null,1,1,0)]);new ne(31,[new Ce(2,3,0,267,null,32,1,1),new Ce(3,3,0,267,null,0,2,1),new Ce(5,2,0,0,null,1,0,0),new Ce(5,2,0,267,null,0,2,0)]);new ne(32,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,100,null,0,2,0),new Ce(5,2,101,267,null,1,1,0)]);new ne(33,[new Ce(1,10,0,300,null,0,1,1),new Ce(2,10,0,300,null,
0,1,1)]);new ne(34,[new Ce(3,10,0,300,null,0,1,1),new Ce(4,10,0,300,null,0,1,1)]);new ne(35,[new Ce(1,8,0,750,null,0,1,1),new Ce(2,8,0,750,null,0,1,1)]);new ne(36,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,200,null,0,2,0),new Ce(5,3,201,500,null,1,1,0)]);new ne(37,[new Ce(1,2,0,0,null,0,2,1),new Ce(2,2,0,0,null,0,2,1),new Ce(1,2,0,200,null,0,2,1),new Ce(2,2,0,200,null,0,2,1),new Ce(1,3,201,267,null,0,1,1),new Ce(2,3,201,267,null,0,1,1)]);new ne(38,[new Ce(1,3,0,267,null,0,1,1),new Ce(2,3,0,267,null,
0,1,1)]);new ne(39,[new Ce(5,2,0,0,null,0,2,0),new Ce(5,2,0,267,null,1,1,0)]);new ne(40,[new Ce(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(Q){window.setTimeout(Q,16)}}();Bf.prototype={Se:null,Pwg:5,$kb:null,BQc:0,startTime:null,duration:null,s3b:null,
WRc:-1,Gpd:-1,epd:-1};Bf.prototype.Start=function(){this.startTime=new Date;this.s3b={}};Bf.prototype.GetRecentAnimationStats=function(){var Q,ra=[],mb=0;for(Q=Ug.BQc;Q<Ug.Pwg;Q++)null!=Ug.$kb[Q]&&(ra[mb]=Ug.$kb[Q],mb++);for(Q=0;Q<Ug.BQc;Q++)null!=Ug.$kb[Q]&&(ra[mb]=Ug.$kb[Q],mb++);return ra};Bf.prototype.GetAnimationSqmStats=function(){var Q=[];return Q[0]=0>Ug.WRc?0:Ug.WRc,Q[1]=0>Ug.Gpd?0:Ug.Gpd,Q[2]=0>Ug.epd?0:Ug.epd,Q};var Ug=new Bf;var Kf=b(211),Of=b(241),hh=b(1191),Eg=b(143),ng=b(58),eg=b(35),
Yg=b(68),Ud=b(7),Tc=b(16),qg=hh.a;Cm(Pb,qg);Pb.prototype.qV=function(Q){this.$.Gd&65536&&qg.prototype.qV.call(this,Q)};Pb.prototype.DXe=function(Q){if(Ud.a.equals(this.C7i,this.$.shortcutKeyManager.L9c(Q),!1)){var ra=Eg.b(this.$);ra&&ra.canReceiveFocus&&(Yg.g(Q),ra.Ye(!0,!1))}};Jl.Object.defineProperties(Pb.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.pB},set:function(Q){this.pB=Q;switch(Q){case 0:this.Pva=this.VAg;break;case 2:this.Pva=this.mBj;break;case 3:this.Pva=
this.KIi;break;case 4:this.Pva=this.RIg;break;case 5:this.Pva=this.nIi;break;default:Uc.ULS.shipAssertTag(41980873,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(Le.a)(Pb,"EwaAccessibilityManager",hh.a,[]);var Lg=Kf.a;Cm(Ue,Lg);Ue.prototype.create=function(){this.Jb(this.$.ea.Ea(15,void 0)||new Pb(this.$))};Ue.la=function(Q){Q.ea.La(157,new Ue(Q))};Object(Le.a)(Ue,"AccessibilityManagerFactory",Kf.a,[]);var de=b(12),tg=b(137),ve=b(561),tf=ve.a;Cm(Ke,tf);Ke.prototype.dispose=
function(){tg.WacAirSpace.$fd()&&tg.WacAirSpace.Cuc()};Ke.prototype.animate=function(Q,ra,mb,Qb,Sc){Ud.a.na(ra)||tg.WacAirSpace.yK(Q.element,ra);tg.WacAirSpace.animate(Q,Qb,Sc);Ud.a.na(mb)||tg.WacAirSpace.ARi(Q.element,mb)};Object(Le.a)(Ke,"AnimationManager",ve.a,[7]);var lg=b(102),Og=b(210),Fa=b(924),lb=b(525),pc=b(88),qc=b(74),Md=qc.a;Cm(he,Md);he.prototype.YZi=function(){var Q=new Og.a,ra=lb.a.uq(pc.a.instance.yc("Common.IEventEmitter<Common.IMruResult>")),mb=new fc.a(function(){return ra.result});
this.vmd=new fc.a(function(){return new Fa.a(mb.value,null)});if(!this.vmd)return Q;var Qb=this.vmd.value.Ky("NewAndOpenCoreManager",!1);if(!Qb||3!==Qb.state||!Qb.$pd)return Qb?Uc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",Qb.state,!Qb.$pd):Uc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Qb=Qb.$pd;for(var Sc=["xlsx","xlsb","xlsm"],Ad=0;Ad<Qb.length;Ad++){var ye=
Qb[Ad];if(!(0>Array.indexOf(Sc,ye.extension))){var Ze=String.format("{0}.{1}",ye.title,ye.extension),sd=Pe.b(ye,ce.AFrameworkApplication.isRtl);ye=ye.url;if(Ze&&sd&&ye){var pe={};Q.add((pe.FileName=Ze,pe.FriendlyPath=sd,pe.Section="mru",pe.AbsoluteUrl=ye,pe))}else ye||Uc.ULS.sendTraceTag(544289225,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return Q};he.prototype.dispose=function(){Md.prototype.dispose.call(this)};he.fileName="FileName";he.friendlyPath="FriendlyPath";
he.section="Section";he.absoluteUrl="AbsoluteUrl";Object(Le.a)(he,"NewAndOpenCoreManager",qc.a,[625,7]);var Pd=Kf.a;Cm(Zc,Pd);Zc.prototype.create=function(){this.Jb(this.$.ea.Ea(451,void 0)||this.$.ea.La(451,new he(this.$)))};Zc.la=function(Q){Q.ea.La(164,new Zc(Q))};Object(Le.a)(Zc,"NewAndOpenCoreFactory",Kf.a,[]);var ee=b(1),xf=b(28),Se=b(4),cf=b(11),dh=b(235),df=b(20);Ed.r0a=function(Q){Q=Xd.a.gg(Q||"");return new Ed(Q)};Ed.p6b=function(Q){return Ed.r0a(Tc.a.instance.da(Q))};Ed.i7c=function(Q){return new Ed(Tc.a.instance.Ya(Q))};
Ed.Nph=function(Q,ra){for(var mb=[],Qb=1;Qb<arguments.length;++Qb)mb[Qb-1]=arguments[Qb];return Ed.Mph.apply(null,[Tc.a.instance.Eb(Q)].concat(mb))};Ed.Mph=function(Q,ra){for(var mb=[],Qb=1;Qb<arguments.length;++Qb)mb[Qb-1]=arguments[Qb];Qb=mb.length;for(var Sc=Array(Qb),Ad=0;Ad<Qb;Ad++)Sc[Ad]=(mb[Ad]||Ed.mCe).Moc;return new Ed(String.format.apply(null,[Q].concat(Sc)))};Jl.Object.defineProperties(Ed,{mCe:{configurable:!0,enumerable:!0,get:function(){return Ed.HYd||(Ed.HYd=new Ed(""))}},Xnd:{configurable:!0,
enumerable:!0,get:function(){return Ed.s3d||(Ed.s3d=Ed.i7c(2).Moc)}}});Ed.HYd=null;Ed.s3d=null;Object(Le.a)(Ed,"SafeHtml",null,[637]);Nd.prototype.dispose=function(){this.$&&this.unregister();cf.DOMElementExtensions.rg(this.jga);cf.DOMElementExtensions.rg(this.Uda);cf.DOMElementExtensions.rg(this.ifa);this.ifa=this.Uda=this.jga=this.$=null};Nd.prototype.setEnabled=function(Q){this.VNf(this.ifa,Q)};Nd.prototype.$6i=function(){this.VNf(this.Uda,!0)};Nd.prototype.readText=function(Q){this.CDb(Ed.r0a(Q),
!0)};Nd.prototype.PNa=function(Q){this.CDb(Ed.r0a(Q),!1)};Nd.prototype.KBf=function(Q,ra){if(1>ra||Ud.a.na(Q))Uc.ULS.shipAssertTag(18219406,0,!1,"Skiping listbox description readout");else{var mb=new Sys.StringBuilder;Q=String.format(Tc.a.instance.Eb(33),ra,Q);ge(mb,Q);ge(mb,Tc.a.instance.da(818));this.CDb(Ed.r0a(mb.toString()),!1)}};Nd.prototype.xNi=function(Q,ra,mb){if(1>mb||1>ra||ra>mb||Ud.a.na(Q))Uc.ULS.shipAssertTag(18219407,0,!1,"Skipping listbox item readout");else{var Qb=new Sys.StringBuilder;
ge(Qb,Q);Qb.append(String.format(Tc.a.instance.Eb(54),ra,mb));this.CDb(Ed.r0a(Qb.toString()),!1)}};Nd.prototype.HBf=function(Q){Q=this.IGh(Q);this.CDb(Q,!1)};Nd.prototype.CDb=function(Q,ra){if(Q=Q?Q.Moc:null)ra=ra?this.ifa:this.Uda,Ud.a.equals(ra.innerHTML,Q,!1)&&(Q+=Ed.Xnd),ra.innerHTML=Q};Nd.prototype.BDb=function(Q,ra){this.jga.getAttribute(Se.a.bga)!==ra&&this.jga.setAttribute(Se.a.bga,ra);Q=Q?Ed.r0a(Q).Moc:"";this.jga.innerHTML=Q};Nd.prototype.yNi=function(Q,ra,mb,Qb){var Sc=Tc.a.instance.Eb(53);
Uc.ULS.shipAssertTag(19674567,0,!(void 0===Q||null===Q));Uc.ULS.shipAssertTag(19674568,0,!(void 0===ra||null===ra));Uc.ULS.shipAssertTag(19674569,0,!(void 0===mb||null===mb));Uc.ULS.shipAssertTag(19674570,0,!(void 0===Qb||null===Qb));Uc.ULS.shipAssertTag(19674571,0,!(void 0===Sc||null===Sc));Q=String.format(Sc,Q||"",ra||"",mb||"",Qb||"");this.readText(Q)};Nd.prototype.yvj=function(Q){var ra=this.ifa.style;Q?(Q=dh.a.ZXb(Q.cell,ra),ra=Q.CK,ra.top=ra.left=ra.bottom=ra.right=null,Q.W8()):ra.cssText=""};
Nd.prototype.IGh=function(Q){switch(Q){case -1985798686:return Ed.p6b(12);case -911352779:return Ed.p6b(11);case 237279923:return Ed.p6b(13);case -1502853784:return Ed.i7c(81);case -111689794:return Ed.i7c(78);case -287251124:return this.ead(1268,function(ra){return ra.bold});case -1925065947:return this.ead(1269,function(ra){return ra.italic});case 1764140053:return this.ead(1270,function(ra){return ra.underline})}return null};Nd.prototype.register=function(){Uc.ULS.shipAssertTag(18458268,0,!!this.$,
"Can't register to ewaControl's events");this.$&&(Uc.ULS.shipAssertTag(18458269,0,!!this.$.Na,"Can't register to CommandHandlerManager's event"),this.$.Na&&this.$.Na.rkb(Object(gd.a)(this,this.clf,"onCommandExecutionStarted")))};Nd.prototype.unregister=function(){this.$&&this.$.Na.Y8a(Object(gd.a)(this,this.clf,"onCommandExecutionStarted"))};Nd.prototype.clf=function(Q,ra){this.HBf(ra.je.command)};Nd.prototype.VNf=function(Q,ra){var mb=Q===this.Uda;ra?(Q.setAttribute(Se.a.bga,Se.a.UWa),mb&&Q.setAttribute(Se.a.Wd,
Se.a.aga),Q.setAttribute(Se.a.LO,Se.a.pp),Q.removeAttribute(Se.a.LO),Q.innerHTML+=" "):(Q.removeAttribute(Se.a.bga),mb&&Q.removeAttribute(Se.a.Wd),Q.setAttribute(Se.a.LO,Se.a.rj))};Nd.prototype.ead=function(Q,ra){var mb=this.activeCell;if(!mb)return null;ra=ra(mb)?7:8;return Ed.Nph(ra,Ed.p6b(Q))};Jl.Object.defineProperties(Nd.prototype,{cwa:{configurable:!0,enumerable:!0,get:function(){return this.Nfg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return df.g(this.$).Cc(null)}}});Object(Le.a)(Nd,"AriaLiveNotifier",null,[626,607,7]);var Uf=Kf.a;Cm(Hd,Uf);Hd.prototype.create=function(){this.Jb(this.$.ea.Ea(211,void 0)||new Nd(this.$,this.$.yy,this.$.gf))};Hd.la=function(Q){Q.ea.La(212,new Hd(Q))};Object(Le.a)(Hd,"AriaLiveNotifierFactory",Kf.a,[]);var bf=b(24),If=b(204);Mc.prototype.readText=function(Q){this.OV.setAttribute(Se.a.Av,Q);this.Z5.setAttribute(Se.a.Av,Q);this.jnj()};Mc.prototype.dispose=function(){this.m_&&
this.m_.parentNode&&this.m_.parentNode.removeChild(this.m_);this.Z5=this.OV=this.m_=this.Tha=null};Mc.prototype.UWg=function(Q){var ra=Q.Mb+"readoutElementWrapper",mb=Q.Mb+"readoutElement1",Qb=Q.Mb+"readoutElement2";this.m_=document.getElementById(ra);this.m_||(this.m_=document.createElement(If.a.div),this.m_.id=ra,this.OV=document.createElement(If.a.label),this.OV.id=mb,this.Z5=document.createElement(If.a.label),this.Z5.id=Qb,this.OV.style.width="0px",this.OV.style.height="0px",this.Z5.style.width=
"0px",this.Z5.style.height="0px",this.OV.tabIndex=-1,this.Z5.tabIndex=-1,this.m_.appendChild(this.OV),this.m_.appendChild(this.Z5),Q=Q.Mb+Se.a.JXc,ra=document.getElementById(Q),Uc.ULS.shipAssertTag(22115013,3,!!ra,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",Q),ra&&ra.appendChild(this.m_))};Mc.prototype.KHi=function(){this.Tha&&this.OV&&this.Z5&&(this.Tha.setAttribute(Se.a.O1,this.OV.id),this.Tha.setAttribute(Se.a.iRc,String.format("{0} {1}",this.OV.id,
this.Z5.id)))};Mc.prototype.jnj=function(){if(this.isActive){var Q="";cf.DOMElementExtensions.hasAttribute(this.Tha,Se.a.O1)&&(Q=this.Tha.getAttribute(Se.a.O1).toString());this.Tha.setAttribute(Se.a.O1,Q===this.OV.id?this.Z5.id:this.OV.id)}else Uc.ULS.shipAssertTag(22115014,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};Mc.w3a=function(){if(null==Mc.brb)if(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1))Mc.brb=!0,Uc.ULS.sendTraceTag(540037213,
0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Mc.brb=!1,bf.a.IJ||bf.a.Pf)Mc.brb=!0,Uc.ULS.sendTraceTag(22115012,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Mc.brb};Mc.la=function(Q){Mc.w3a()&&Q.ea.La(244,new Mc(Q,df.g(Q).zc.textBox.lf))};Jl.Object.defineProperties(Mc.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.Tha&&document.activeElement===this.Tha}}});
Mc.brb=null;Object(Le.a)(Mc,"FocusBasedReadout",null,[607,7]);var vf=Kf.a;Cm(ae,vf);ae.prototype.create=function(){var Q=this;Mc.w3a()?df.g(this.$).zc.textBox.eT(function(){var ra=Q.$.ea.Ea(244,void 0)||new Mc(Q.$,df.g(Q.$).zc.textBox.lf);Q.Jb(ra)}):this.Jb(null)};ae.la=function(Q){Q.ea.La(315,new ae(Q))};Object(Le.a)(ae,"FocusBasedReadoutFactory",Kf.a,[]);var Dg=b(86),Pf=b(25),gg=b(46),Sb=b(246),Hc=b(44),ed=b(42),Id=b(116);Cb.X$c=function(Q){return Cb.yTe(Q.toString())};Cb.yTe=function(Q){return Cb.dKg.test(Q)?
Q.replace(Cb.lMi,"$1 ").replace(Cb.kMi,' "$1"').trim():Q};Cb.OGf=function(Q){var ra=Q.lastIndexOf("!");return Q.substring(0,-1<ra?ra+1:0)+Cb.yTe(Q.substring(-1<ra?ra+1:0,Q.length))};Jl.Object.defineProperties(Cb,{lMi:{configurable:!0,enumerable:!0,get:function(){return Cb.$6d||(Cb.$6d=RegExp("([A-Z]+)","g"))}},kMi:{configurable:!0,enumerable:!0,get:function(){return Cb.Z6d||(Cb.Z6d=RegExp("([A-Z])","g"))}},dKg:{configurable:!0,enumerable:!0,get:function(){return Cb.$Vd||(Cb.$Vd=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});
Cb.$6d=null;Cb.Z6d=null;Cb.$Vd=null;Object(Le.a)(Cb,"RangeAriaExtensions",null,[]);Object(Le.a)(Qc,"SelectionReadoutState",null,[]);Ic.prototype.dispose=function(){this.$&&this.sm();Dg.a.Ia(this.$Wb);this.sparklineManager=this.$=this.$Wb=null};Ic.prototype.vOe=function(Q,ra,mb){mb=void 0===mb?!0:mb;if(!Q)return"";var Qb=this.$.ea,Sc=new Sys.StringBuilder;this.yxg(Sc,Q,ra);if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Ad=this.tableManager.MIa(Q.range);Ad&&Ad.cKd&&
this.Whe(Sc,Ad);(Ad=this.tableManager.fo(Q.range))&&Ad.xua&&this.Whe(Sc,Ad)}Ad=Q.U$?this.gRe(Q):Q.text;ge(Sc,Ad);Ad=this.$.activeItemName;this.MC.activeItemName!==Ad&&(ge(Sc,Ad),this.MC.activeItemName=Ad);Ad=1===ra.length?gg.K(ra).isSingle?"":Tc.a.instance.da(814):String.format(Tc.a.instance.Eb(30),ra.length);ge(Sc,Ad);Ad=Ml(ra);for(var ye=Ad.next();!ye.done;ye=Ad.next())ye=ye.value,ge(Sc,Cb.X$c(ye)),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4823595_LastSelectedCellInRangeReadoutV2")&&1===ra.length&&
Ic.n7h(ye)&&(ye=df.g(this.$).Ha.Hr(ye.bottomRight),void 0===ye||null===ye||Ud.a.na(ye.text)||(ye=ye.U$?this.fRe(ye,ye.text):ye.text,ge(Sc,ye)));Ad=Q.cell;Ad=this.qEh(Ad.b0i,Ad.aNg);ge(Sc,Ad);this.jxg(Sc,Q);mb&&(Q.X3a?ge(Sc,Tc.a.instance.da(802)):Q.NKa&&ge(Sc,Tc.a.instance.da(803)));if(Q.hasAutoFilter||Q.V3)this.zxg(Sc,Q.hasAutoFilter?Q.cell.oXb:Q.cell.wFi),mb&&ge(Sc,Tc.a.instance.da(805));Sb.c(this.$,Q.range)&&ge(Sc,Tc.a.instance.da(809));this.gxg(Sc,Q);mb=(mb=Qb.Ea(14,void 0))?mb.Lth():"";ge(Sc,
mb);Q.NG&&(mb=df.g(this.$).Ha.Hr(Q.range),mb=!!mb&&mb.YYe,Ic.Wbj(Q)?Ic.hxg(Sc,Q):ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&mb?ge(Sc,Tc.a.instance.da(807)):ge(Sc,Tc.a.instance.da(806)));Q.T$&&(ge(Sc,Tc.a.instance.da(808)),Q.Etb&&ge(Sc,String.format(Tc.a.instance.Eb(16),Q.g_g)),ge(Sc,Q.iconName));Q.Jtb&&(Ad=this.$.ea.Ea(271,void 0),mb="",Ad&&Q.cell.Taf&&(Ad=Ad.tP(Q.cell.Taf))&&Ad.DomainId.Id!==Ic.BCj&&(mb=Ad.Name),Q.cell.LZh?(ge(Sc,String.format(Tc.a.instance.Eb(176),
mb)),ge(Sc,Tc.a.instance.da(1734))):(ge(Sc,String.format(Tc.a.instance.Eb(174),mb)),ge(Sc,Tc.a.instance.da(1733))));this.LPh(Q)&&ge(Sc,Ic.jAh(Q));(Qb=Qb.Ea(231,void 0))&&ge(Sc,Qb.tRe(ra,!0));1===ra.length&&ra[0].isSingle&&Ic.Vbj(Q,ra[0],this.$)&&(ra=this.$.ea.Ea(271,void 0))&&ge(Sc,ra.Wth());Q.LJb&&!Ud.a.na(Q.MJb)&&ge(Sc,Q.MJb);ra=Q.cell.XIg;Ud.a.na(ra)||ge(Sc,ra);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&Q.vva&&Q.BCb&&(Q=Q.mwd)&&(ge(Sc,Tc.a.instance.da(1891)),ge(Sc,
Q));return Sc.toString()};Ic.prototype.Tme=function(Q){this.bra=this.MC;this.MC=Object.assign(new Qc,{activeItemName:this.bra.activeItemName,Rtc:Q?this.bra.Rtc:!1,tableName:Q?this.bra.tableName:"",yYa:Q?this.bra.yYa:-1})};Ic.prototype.OIf=function(){this.bra&&(this.MC=this.bra,this.bra=null)};Ic.prototype.qEh=function(Q,ra){return 2===Q||2===ra?Tc.a.instance.da(835):1===Q||1===ra?Tc.a.instance.da(836):""};Ic.prototype.gRe=function(Q){if(!ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4823595_LastSelectedCellInRangeReadoutV2")){var ra=
Q.cell.HJa;return Q.cell.a2a?String.format(Tc.a.instance.Eb(14),Q.text,ra):String.format(Tc.a.instance.Eb(13),Q.text,Cb.OGf(ra))}return this.fRe(Q.cell,Q.text)};Ic.prototype.Vba=function(){df.g(this.$).isEditing||this.$Wb.Zq()};Ic.prototype.yxg=function(Q,ra,mb){if(mb&&1===mb.length&&mb[0].isSingle){mb="";var Qb=this.tableManager.MIa(ra.range);Qb?(mb=Qb.pivotTableName,this.IQc(Q,mb),this.Yhe(Q,!0,mb,Qb.Hbc?Tc.a.instance.da(797):""),ge(Q,this.tableManager.u5h(Qb,ra.range)?Tc.a.instance.da(799):""),
ge(Q,this.tableManager.S_h(Qb,ra.range)?Tc.a.instance.da(798):"")):(Qb=this.tableManager.fo(ra.range))?(mb=(mb=df.g(this.$).kc.Rk(ra.range))?mb.name:"",this.IQc(Q,mb),this.Yhe(Q,!1,mb,""),ge(Q,this.tableManager.k5e(Qb,ra.range)?Tc.a.instance.da(798):"")):(this.IQc(Q,mb),this.MC.tableName="",this.MC.yYa=-1)}};Ic.prototype.IQc=function(Q,ra){ra===this.MC.tableName||Ud.a.na(this.MC.tableName)||(Q.append(Tc.a.instance.da(this.MC.Rtc?796:795)),ge(Q," "+this.MC.tableName))};Ic.prototype.Yhe=function(Q,
ra,mb,Qb){mb!==this.MC.tableName&&(Q.append(Tc.a.instance.da(ra?794:793)),ge(Q," "+mb),ge(Q,Qb),this.MC.tableName=mb,this.MC.Rtc=ra,this.MC.yYa=-1)};Ic.prototype.Whe=function(Q,ra){var mb=df.g(this.$).ga.ya.activeCell;if(mb.top!==ra.top&&mb.left!==this.MC.yYa){Q.append(Tc.a.instance.da(798));ra=new Pf.Range(ra.top,mb.left,ra.top,mb.left,!0,!0);ge(Q,Cb.X$c(ra));if(ra=df.g(this.$).Cc(ra))ra=ra.U$?this.gRe(ra):ra.text,ge(Q,ra);this.MC.yYa=mb.left}};Ic.prototype.fRe=function(Q,ra){var mb=Q.HJa;return Q.a2a?
String.format(Tc.a.instance.Eb(14),ra,mb):String.format(Tc.a.instance.Eb(13),ra,Cb.OGf(mb))};Ic.prototype.Xj=function(){Uc.ULS.shipAssertTag(19265428,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var Q=df.g(this.$);Uc.ULS.shipAssertTag(19265429,0,!!Q,"Can't register to grid's events");Q&&(Q.Hc.Cm(Object(gd.a)(this,this.sH,"onEditingStarted")),Q.Ha.Xp(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.AD(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q=Q.ga,Uc.ULS.shipAssertTag(19265430,
0,!!Q,"Can't register to selectionManager's events"),Q&&(Q.$F(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.WF(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.Sa.D1(Object(gd.a)(this,this.Vba,"readActiveItemDescription"))))}};Ic.prototype.sm=function(){if(this.$){var Q=df.g(this.$);Q&&(Q.Hc.mm(Object(gd.a)(this,this.sH,"onEditingStarted")),Q.Ha.Yq(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.aF(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q=Q.ga)&&
(Q.bF(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.gN(Object(gd.a)(this,this.Vba,"readActiveItemDescription")),Q.Sa.tla(Object(gd.a)(this,this.Vba,"readActiveItemDescription")))}};Ic.prototype.Cni=function(){if(!df.g(this.$).ga.Sa.Zid){var Q=this.Nsh();this.readText(Q.returnValue,Q.activeCell)}};Ic.prototype.readText=function(Q,ra){this.w3a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(Q):(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(Q),this.ariaLiveNotifier.yvj(ra))};Ic.prototype.sH=function(){var Q=this.activeCell;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5300772_FixA11yReadEditingOnStartEdit")&&this.readText("Editing",Q);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Q&&Q.pJa&&!df.g(this.$).IYe||this.$Wb.cancel()};Ic.prototype.Nsh=function(){var Q=null;var ra=df.g(this.$).ga;if(1!==ra.Ze&&!ra.Sa.nc)return Uc.ULS.sendTraceTag(40632717,
0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",ra.Ze),{returnValue:"",activeCell:Q};switch(ra.Ze){case 2:return{returnValue:this.yvh(ra),activeCell:Q};case 64:var mb=ra.Sa.nc.floatingObject,Qb="";if(ra=ra.Sa.nc.Zr||ra.Sa.nc.$d)Qb=(Qb=ra.firstChild)?cf.DOMElementExtensions.getTextContent(Qb):"";return{returnValue:String.format(Tc.a.instance.Eb(52),Ic.C6b(mb.altText,mb.altTextDescription,mb.name),Qb,mb.altTextDescription),activeCell:Q};case 4:return{returnValue:Ic.ywg(ra.Sa.nc.floatingObject),
activeCell:Q};case 512:return{returnValue:Id.a.SPe(ra.Sa.nc.floatingObject.Q1c),activeCell:Q};case 8:return mb=(mb=ra.Sa.nc.floatingObject)?mb.name:"",{returnValue:String.format(Tc.a.instance.Eb(50),mb),activeCell:Q};case 1:return Q=this.activeCell,{returnValue:this.vOe(Q,ra.ya.selectedRanges),activeCell:Q}}return{returnValue:"",activeCell:Q}};Ic.prototype.yvh=function(Q){var ra=new Sys.StringBuilder;ra.append(Ic.zJg(Q));var mb=this.$.ea.Ea(231,void 0);mb&&ge(ra,mb.tRe(Q.Sa.nc.floatingObject,!1));
return ra.toString()};Ic.prototype.LPh=function(Q){Q=Q.t3e();var ra=!1;this.MC.e8e!==Q&&(this.MC.e8e=Q,ra=!0);return ra};Ic.prototype.jxg=function(Q,ra){if(ra.Otb)if(ra=this.sparklineManager.fIh(ra)){var mb=Tc.a.instance,Qb=mb.da;a:switch(ra.type){case 0:var Sc=790;break a;case 1:Sc=791;break a;default:Sc=792}mb=Qb.call(mb,Sc);ge(Q,String.format(Tc.a.instance.Eb(25),mb));ra=String.format(Tc.a.instance.Eb(24),Cb.X$c(ra.Ojj));ge(Q,ra)}else Uc.ULS.sendTraceTag(20821025,0,15,"No sparkline range was found on a cell with sparkline."),
ge(Q,String.format(Tc.a.instance.Eb(25),""))};Ic.prototype.zxg=function(Q,ra){switch(ra){case 1:case 11:ge(Q,Tc.a.instance.da(810));break;case 6:ge(Q,Tc.a.instance.da(810));ge(Q,Tc.a.instance.da(812));break;case 7:ge(Q,Tc.a.instance.da(810));ge(Q,Tc.a.instance.da(813));break;case 2:ge(Q,Tc.a.instance.da(811));ge(Q,Tc.a.instance.da(812));break;case 3:ge(Q,Tc.a.instance.da(811));ge(Q,Tc.a.instance.da(813));break;default:ge(Q,Tc.a.instance.da(811))}};Ic.prototype.gxg=function(Q,ra){var mb=this.$.ea.Ea(65,
void 0);ra=mb?mb.qIa(ra.range):null;var Qb="",Sc=Object(Ye.a)(624,ra);ra?Qb=!ra.I3a&&Sc&&Sc.P6h?String.format(Tc.a.instance.Eb(29),Sc.Znj):String.format(Tc.a.instance.Eb(23),ra.author):mb&&mb.Jl&&mb.Jl.mC&&(Qb=String.format(Tc.a.instance.Eb(28),mb.Jl.aK.author));ge(Q,Qb)};Ic.ywg=function(Q){return String.format(Tc.a.instance.Eb(51),Ic.C6b(Q.altText,Q.altTextDescription,Q.name),Q.altTextDescription)};Ic.jAh=function(Q){return Tc.a.instance.da(Q.t3e()?800:801)};Ic.C6b=function(Q,ra,mb){return Ud.a.na(Q)&&
Ud.a.na(ra)?mb:Q};Ic.zJg=function(Q){var ra=Q.Sa.nc;Q=ra.floatingObject;var mb=Q.hd,Qb=mb.ChartTitle,Sc=Q.altText,Ad=Q.altTextDescription,ye=!!(mb.Attributes&4);return(ra=ra.getSelectionDescription())?ra:mb.DataRangeForDisplay?String.format(Tc.a.instance.Eb(ye?48:46),Ic.C6b(Sc,Ad,Q.name),Ad,Qb,Tc.a.instance.da($c(mb.ChartCategory)),mb.DataRangeForDisplay):String.format(Tc.a.instance.Eb(ye?49:47),Ic.C6b(Sc,Ad,Q.name),Ad,Qb,Tc.a.instance.da($c(mb.ChartCategory)))};Ic.Wbj=function(Q){return ee.EwaSettings.ka(104)&&
(Q.q3a||Q.Dbc)};Ic.hxg=function(Q,ra){if(!ra.tQa)Uc.ULS.shipAssertTag(41165275,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ra.q3a)ra=ra.tQa.topLeft.toString(),ge(Q,String.format(Tc.a.instance.Eb(26),ra));else if(ra.Dbc){var mb=ra.tQa.yW();ra=(mb.LastColumn-mb.FirstColumn+1).toString();mb=(mb.LastRow-mb.FirstRow+1).toString();ge(Q,String.format(Tc.a.instance.Eb(27),ra,mb))}};Ic.Vbj=function(Q,
ra,mb){return Q.NG||!ee.EwaSettings.ka(141)?!1:(Q=mb.ea.Ea(271,void 0))?Q.qvb(ra):!1};Ic.n7h=function(Q){return Q.top===Q.bottom&&Q.left+1===Q.right||Q.top+1===Q.bottom&&Q.left===Q.right};Jl.Object.defineProperties(Ic.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return df.g(this.$).Cc(null)}}});Ic.BCj=268435712;Ic.ace=500;Object(Le.a)(Ic,"SelectionReadoutHandler",null,[18,7]);var hf=b(52),Hf=Kf.a;Cm(Xb,Hf);Xb.prototype.create=function(){var Q=this,ra=this.$.ea,mb=ng.GetServiceTaskFactory.Xa(ra,
211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier"),Qb=ng.GetServiceTaskFactory.Xa(ra,66,134,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),Sc=ng.GetServiceTaskFactory.Xa(ra,240,239,this.vb,"Microsoft.Office.Excel.WebUI.Client.SparklineManager.ISparklineManager"),Ad=hf.Task.Ua(null);ee.EwaSettings.YG()&&(Ad=ng.GetServiceTaskFactory.Xa(ra,244,315,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IReadoutNotifier"));eg.TaskExtensions.Da(eg.TaskExtensions.Fe([mb,
Qb,Sc,Ad],this.ma),function(){var ye=ra.Ea(226,void 0)||new Ic(mb.result,Q.$,Qb.result,Sc.result,Ad.result);Q.Jb(ye)},this.$.ma,3)};Xb.la=function(Q){Q.ea.La(227,new Xb(Q))};Object(Le.a)(Xb,"SelectionReadoutHandlerFactory",Kf.a,[]);hc.prototype.OBf=function(){var Q=this.Nth();this.ariaLiveNotifier.BDb(Q,Se.a.olb)};hc.prototype.Nth=function(){var Q=new Sys.StringBuilder;this.$.workbookContext&&ge(Q,this.$.workbookContext.WorkbookFileName);ge(Q,Tc.a.instance.da(816));ge(Q,this.Pth());ge(Q,this.Oth());
ge(Q,Tc.a.instance.da(817));return Q.toString()};hc.prototype.Pth=function(){return this.$.isEditMode?Tc.a.instance.da(821):Tc.a.instance.da(822)};hc.prototype.Oth=function(){var Q=this.MBj(),ra=this.$.Aa.sa;Q=1!==Q?String.format(Tc.a.instance.Eb(31),Q):Tc.a.instance.da(815);Q=new Sys.StringBuilder(Q);ra&&!Ud.a.na(ra.sheetName)&&(Q.append(Ed.Xnd),Q.append(String.format(Tc.a.instance.Eb(32),ra.sheetName)));return Q.toString()};hc.prototype.MBj=function(){for(var Q=0,ra=Ml(this.$.Aa.items),mb=ra.next();!mb.done;mb=
ra.next())mb.value.visible&&Q++;return Q};Object(Le.a)(hc,"WorkbookReadout",null,[]);Xa.prototype.dispose=function(){this.R5b&&this.R5b.jUi(Object(gd.a)(this,this.Aof,"onKeyboardInteractionStarted"));this.R5b=this.ariaLiveNotifier=this.$=null};Xa.prototype.Aof=function(){this.GSd.OBf();this.ariaLiveNotifier.setEnabled(!0)};Object(Le.a)(Xa,"EmbeddedWorkbookReadoutHandler",null,[7]);Ea.prototype.dispose=function(){this.sm();this.ariaLiveNotifier=this.uY=null;this.Ld=!0};Ea.prototype.Xj=function(){if(this.uY){this.uY.Eq(Object(gd.a)(this,
this.sV,"onUserAction"));this.uY.Ha.Xp(Object(gd.a)(this,this.sV,"onUserAction"));this.uY.AD(Object(gd.a)(this,this.sV,"onUserAction"));var Q=Object(Ye.a)(189,this.uY);Q&&(Q.Hc.Cm(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.$F(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.WF(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.Sa.D1(Object(gd.a)(this,this.sV,"onUserAction")))}else Uc.ULS.sendTraceTag(20235935,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};Ea.prototype.sm=
function(){if(this.uY){this.uY.Ha.Yq(Object(gd.a)(this,this.sV,"onUserAction"));this.uY.aF(Object(gd.a)(this,this.sV,"onUserAction"));var Q=Object(Ye.a)(189,this.uY);Q&&(Q.Hc.mm(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.bF(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.gN(Object(gd.a)(this,this.sV,"onUserAction")),Q.ga.Sa.tla(Object(gd.a)(this,this.sV,"onUserAction")))}};Ea.prototype.sV=function(){this.Ld||this.xhe()};Ea.prototype.xhe=function(){this.GSd.OBf();this.ariaLiveNotifier.setEnabled(!0);
this.ariaLiveNotifier.$6i();this.dispose()};Object(Le.a)(Ea,"WorkbookReadoutHandler",null,[7]);var Cg=Kf.a;Cm(Fd,Cg);Fd.prototype.create=function(){var Q=this,ra=ng.GetServiceTaskFactory.Xa(this.$.ea,211,212,this.vb,"Microsoft.Office.Excel.WebUI.Client.ScreenReader.IAriaLiveNotifier");if(this.$.p4){var mb=ng.GetServiceTaskFactory.Xa(this.$.ea,12,477,this.vb,"Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory.ISharedUIControlsFactory");eg.TaskExtensions.Da(eg.TaskExtensions.Fe([ra,mb],this.$.ma),
function(){var Qb=new Xa(ra.result,Q.$,mb.result);Q.Jb(Qb)},this.$.ma,3)}else eg.TaskExtensions.Da(ra,function(Qb){Qb=new Ea(Qb.result,Q.$);Q.Jb(Qb)},this.$.ma,3)};Fd.la=function(Q){Q.ea.La(229,new Fd(Q))};Object(Le.a)(Fd,"WorkbookReadoutHandlerFactory",Kf.a,[]);var uf=b(36),ih=b(234),qa=b(352),tb=b(175),rc=b(645),kd=uf.a;Cm(Pc,kd);Pc.prototype.dispose=function(){this.view&&(this.view.Ha.Jp(Object(gd.a)(this,this.Le,"onBlockCacheItemChanged")),this.view.Ha.zH(Object(gd.a)(this,this.jm,"onBlockCacheItemEvicted")),
this.view.Ha.rEb(Object(gd.a)(this,this.Le,"onBlockCacheItemChanged")),this.view.Ha.sEb(Object(gd.a)(this,this.Le,"onBlockCacheItemChanged")),this.view.$.Aa.yH(Object(gd.a)(this,this.ro,"onActiveItemChanging")),this.view.$.Ab.yH(Object(gd.a)(this,this.ro,"onActiveItemChanging")));this.nS=this.Xae=null;kd.prototype.dispose.call(this)};Pc.prototype.eVb=function(Q){Q=this.ezd(Q);var ra=this.view.Ph;if(Q&&0<Q.length&&ra)for(var mb=0,Qb=Q.length;mb<Qb;mb++)ra.contains(this.nS[mb])||Array.add(this.nS,tb.a.MP(Q[mb]))};
Pc.prototype.cEb=function(){var Q;if(this.nS.length&&(Q=this.view.Ph))for(var ra=this.nS.length-1;0<=ra;ra--)Q.contains(this.nS[ra])||Array.removeAt(this.nS,ra)};Pc.prototype.BTe=function(Q){return this.XSe(Q)};Pc.prototype.XSe=function(Q){Q=gg.I(Q,this.nS,!0);return 0<Q.length?Q[0]:null};Pc.prototype.Le=function(Q,ra){var mb,Qb=ra.Qd.block;Q=!1;if(Qb.Fj&&Qb.state&1&&(mb=this.view.Yf(ra.Qd.block.Ie.BlockCachePosition.PaneType).xF(ra.Qd.hash))){Qb=this.ezd(Qb.ye);if(mb=mb.mg)for(var Sc=this.nS.length-
1;0<=Sc;Sc--)mb.contains(this.nS[Sc].bottomRight)&&(Array.removeAt(this.nS,Sc),Q=!0);if(Qb)for(mb=0,Sc=Qb.length;mb<Sc;mb++)Array.add(this.rangeList,tb.a.MP(Qb[mb])),Q=!0;Q&&(ra=this.view.o2.xF(ra.Qd.hash),this.raiseEvent(Pc.fzd,new rc.a(ra)))}};Pc.prototype.jm=function(){this.cEb()};Pc.prototype.ro=function(){this.nS=[]};Jl.Object.defineProperties(Pc.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.nS}},view:{configurable:!0,enumerable:!0,get:function(){return this.Xae}}});
Pc.fzd="lrc";Object(Le.a)(Pc,"LoadedRangeCollection",uf.a,[]);Cm(Nc,Pc);Nc.prototype.fIh=function(Q){for(var ra=Ml(this.rangeList),mb=ra.next();!mb.done;mb=ra.next())if(mb=mb.value,Q.range.contains(mb))return mb;return null};Nc.prototype.ezd=function(Q){return Q.GridBlockModel&&(Q=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(Q.GridBlockModel))?Q.getSparklineRanges():null};Object(Le.a)(Nc,"SparklineManager",Pc,[623]);var Td=Kf.a;Cm(dc,Td);dc.prototype.create=function(){this.Jb(this.sparklineManager||
(this.sparklineManager=new Nc(df.g(this.$),this.$.ea)))};dc.la=function(Q){Q.ea.La(239,new dc(Q))};Object(Le.a)(dc,"SparklineManagerFactory",Kf.a,[]);var qe=b(48),Ne=b(281);xb.GFe="ewa-svg-icon";Object(Le.a)(xb,"CssClassNames",null,[]);var Ja=b(305),ob=b(333);eb.prototype.dispose=function(){this.SMd=null;this.$.fa.Sr(Object(gd.a)(this,this.Rh,"onCommandUIGeneratedAndGridInteractive"))};eb.prototype.fua=function(Q,ra,mb,Qb,Sc){Qb=void 0===Qb?null:Qb;Sc=void 0===Sc?null:Sc;var Ad;(Ad=this.SMd[Q])||
(this.SMd[Q]=Ad=this.rEi(this.yXf[Q]));if(!Ad)return Uc.ULS.shipAssertTag(590918343,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",Q),null;var ye=Ad.cloneNode(!0);if(!ye.style){var Ze=Ja.b(Ad),sd=Ja.b(ye),pe={};pe.iconId=Q;pe.isOriginalNodeStyleNull=void 0===Ad.style||null===Ad.style;pe.isOriginalNodeCurrentStyleNull=void 0===Ad.currentStyle||null===Ad.currentStyle;pe.isClonedNodeCurrentStyleNull=void 0===ye.currentStyle||null===ye.currentStyle;pe.originalNode=Ze.substring(0,
Ze.indexOf(">")+1);pe.clonedNode=sd.substring(0,sd.indexOf(">")+1);Uc.ULS.sendTraceTag(588801239,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(pe))}Q=String.format("height: {0}px; width: {0}px;",ra,mb);ye.setAttribute("style",Q);Sc&&(Q=document.createElement("title"),Q.innerHTML=Sc,ye.insertBefore(Q,ye.childNodes[0]));if(Qb)for(Qb=Ml(Qb),Sc=Qb.next();!Sc.done;Sc=Qb.next())Sys.UI.DomElement.addCssClass(ye,Sc.value);return ye};eb.prototype.haa=function(Q,
ra,mb,Qb,Sc,Ad,ye,Ze){Sc=void 0===Sc?0:Sc;Ad=void 0===Ad?0:Ad;ye=void 0===ye?null:ye;Ze=void 0===Ze?null:Ze;Sc&&Ad||(Ad=cf.DOMElementExtensions.getBoundingClientRect(Qb),Sc=Ad.height,Ad=Ad.width);if(ye=this.fua(Q,ra,mb,ye,Ze))Qb.appendChild(ye),(Qb=cf.DOMElementExtensions.QY(ye,"style",null))?ye.setAttribute("style",Qb+String.format(" margin: {0}px {1}px;",(Sc-ra)/2,(Ad-mb)/2)):Uc.ULS.sendTraceTag(588068257,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
Q);return ye};eb.prototype.Rh=function(){this.dbf();this.$.fa.Sr(Object(gd.a)(this,this.Rh,"onCommandUIGeneratedAndGridInteractive"))};eb.prototype.dbf=function(){var Q=this;eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(this.$.ea,283,284,0,"Common.IDynamicScriptLoaderProvider"),function(ra){ra=ob.c(ra.result.xq.loadScript("excel-uiSlice20-sprite"));eg.TaskExtensions.Da(ra,function(){var mb=Q.iRe("excelUiSlice20Sprite");mb?Q.iee(mb):Uc.ULS.sendTraceTag(574681088,0,15,"window[{0}].icons returned null.",
"excelUiSlice20Sprite")},Q.$.ma,3)},this.$.ea.ma,3)};eb.prototype.iee=function(Q){Q=Ml(Q);for(var ra=Q.next();!ra.done;ra=Q.next())ra=ra.value,ra.type===If.a.wXf&&(this.yXf[ra.id]=ra)};eb.prototype.rEi=function(Q){if(!Q)return null;var ra=Q.viewBox;Q=Q.children;var mb=document.createElementNS(Ne.a.UMd,If.a.wXf);Sys.UI.DomElement.addCssClass(mb,xb.GFe);mb.setAttribute("focusable","false");mb.setAttribute("viewBox",ra);this.tqg(mb,Q);return mb};eb.prototype.tqg=function(Q,ra){ra=Ml(ra);for(var mb=ra.next();!mb.done;mb=
ra.next()){mb=mb.value;var Qb=document.createElementNS(Ne.a.UMd,mb.type),Sc;for(Sc in mb){var Ad=Sc,ye=mb[Sc];"className"===Ad?Qb.setAttribute("class",ye):Qb.setAttribute(Ad,ye)}Q.appendChild(Qb)}};eb.prototype.iRe=function(Q){return(Q=window[Q])?Q.icons:null};Object(Le.a)(eb,"SvgIconProvider",null,[621,7]);var Nb=Kf.a;Cm(Qa,Nb);Qa.prototype.create=function(){var Q=this;eg.TaskExtensions.Da(qe.a.tQ([108],4,this.vb,void 0,void 0,void 0,387),function(){var ra=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?
"excelInitialAppSprite":"excelAppSprite";window[ra]?Q.Jb(Q.$.ea.Ea(388,void 0)||new eb(Q.$)):Uc.ULS.sendTraceTag(575807752,0,50,"window.[{0}] returned null.",ra)},this.ma,3)};Qa.la=function(Q){Q.ea.La(387,new Qa(Q))};Object(Le.a)(Qa,"SvgIconProviderFactory",Kf.a,[]);var Jc=b(404),bd=b(528),Yc=b(232),Db=b(63),mc=b(154),le=b(124),hd=b(9),of=b(334),Rc=b(167),Kc=b(13),yg=b(156),nf=b(120),Kg=b(83),jg=b(229),zg=b(79),hg=b(106),bh=b(39),Nf=b(34),fe=Kg.a;Cm(gb,fe);gb.prototype.dispose=function(){this.qya();
this.Qwb?this.tableManager.XEf(Object(gd.a)(this,this.Mhc,"onCancelEditTable")):this.gridView.Hc&&(this.gridView.Hc.mm(Object(gd.a)(this,this.lmf,"onEditCellStarted")),this.gridView.Hc.Qs(Object(gd.a)(this,this.Twa,"onEditCellEnded")));this.tkd||bf.a.Sq||bf.a.xja||Rc.a.instance.Ca(Kc.a.pointerDown,this.vU,Object(gd.a)(this,this.onPointerDown,"onPointerDown"));if(this.tA){jg.b(this.$,!1);try{this.lv()}catch(Q){Uc.ULS.sendTraceTag(42078529,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",
Q)}}this.parentElement&&this.parentElement.contains(this.vU)&&this.parentElement.removeChild(this.vU);this.vU=this.parentElement=null;fe.prototype.dispose.call(this)};gb.prototype.HVe=function(Q){var ra=Q.bottom-this.Mn.topLeft.bottom-1;return 0<=Q.right-this.Mn.topLeft.right+1&&0<=ra&&Q.bottom>=this.Mn.top&&Q.right>=this.Mn.left?new Pf.Range(this.Mn.top,this.Mn.left,Q.bottom,Q.right,!1,!1):this.Is};gb.prototype.pdd=function(Q){this.Cqc([this.Is],6,void 0===Q?!0:Q);this.Sb.Wr(this.TXf)};gb.prototype.hEb=
function(Q){Q=void 0===Q?!0:Q;this.Sb.ll(this.TXf);this.Cqc([null],6,Q)};gb.prototype.kBd=function(Q){Q=void 0===Q?!0:Q;this.Sb.ll(this.LXf);this.Cqc([null],26,Q)};gb.prototype.uRh=function(){var Q=!1;Q=void 0===Q?!0:Q;var ra=this.Lnj();0<ra.length&&(this.Cqc(ra,26,Q),this.Sb.Wr(this.LXf))};gb.prototype.Lnj=function(){var Q=[];this.Mn.contains(this.Is)&&(this.Mn.right!==this.Is.right&&Q.push(new Pf.Range(this.Mn.top,this.Is.right+1,this.Is.bottom,this.Mn.right,!1,!1)),this.Mn.bottom!==this.Is.bottom&&
Q.push(new Pf.Range(this.Is.bottom+1,this.Mn.left,this.Mn.bottom,this.Mn.right,!1,!1)));return Q};gb.prototype.onPointerDown=function(Q){if(1!==this.$.Na.AG())return!0;Q=Nf.a(this.$).Qe(Q);if(this.tA)return!0;var ra=bh.a(this.$).z5e||bh.a(this.$).Rq();if(this.Tjd||ra)return this.qya(),!0;this.Is=this.Mn;this.kBd();this.pdd();ra=2===Q.Cb&&!Q.qo;var mb=3===Q.Cb;if(ra||mb)Q=this.ga.Pr(Q.clientPoint,Q.Wb,5,void 0,void 0,!0),Q||(Q=this.Is),this.kwb=ra,this.Ddc=mb,this.Is=this.HVe(Q),this.pdd(),ra?this.qQi():
mb&&this.aRi(),jg.b(this.$,!0);return!0};gb.prototype.vk=function(Q){Q=Nf.a(this.$).Qe(Q);if(!this.tA)return!1;if(Q=this.kwb?this.ga.Pr(Q.clientPoint,Q.Wb,5,void 0,void 0,!0):this.ga.Pr(Q.clientPoint,Q.Wb,5,!0,!1,!0))Q=this.HVe(this.WVb(Q)),this.OXb(Q.bottomRight),this.Is.equals(Q)||(this.Is=Q,this.hEb(!1),this.kBd(!1),this.pdd(!1),this.uRh(),this.Sb.update(!1)),this.lwj(this.Is);return!0};gb.prototype.Hh=function(Q){Nf.a(this.$).Qe(Q);if(!this.tA)return!1;this.resizeTable();this.qya();return!0};
gb.prototype.HBb=function(Q){Nf.a(this.$).Qe(Q);if(!this.tA)return Uc.ULS.shipAssertTag(592557912,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.qya();return!0};gb.prototype.resizeTable=function(){if(!this.Is.equals(this.Mn)){var Q=new Pf.Range(this.Mn.top,this.Mn.left,this.Is.bottom,this.Is.right,!1,!1);this.$rj(Q);this.Tjd=!0}};gb.prototype.bxa=function(Q){Nf.a(this.$).Qe(Q);this.qya();return!0};gb.prototype.onKeyDown=function(Q){Nf.a(this.$).Qe(Q);
return!0};gb.prototype.Mhc=function(){this.Qwb?this.tA&&this.qya():this.qya()};gb.prototype.lmf=function(){this.tkd||bf.a.Sq||bf.a.xja||(this.qya(),Rc.a.instance.Ca(Kc.a.pointerDown,this.vU,Object(gd.a)(this,this.onPointerDown,"onPointerDown")),this.vU.classList.add("ewr-table-resize-default-cursor"),this.UPb=this.vU.disabled=!0)};gb.prototype.Twa=function(){this.tkd&&(bf.a.Sq||bf.a.xja||(Rc.a.instance.qa(Kc.a.pointerDown,this.vU,Object(gd.a)(this,this.onPointerDown,"onPointerDown")),this.vU.classList.remove("ewr-table-resize-default-cursor"),
this.UPb=this.vU.disabled=!1),this.UPb=!1)};gb.prototype.WEg=function(){var Q=document.createElement("div");Q.className="ewr-table-resize-handle";var ra=document.createElement("div");ra.className="ewr-table-resize-fillhandle-higher";var mb=document.createElement("div");mb.className="ewr-table-resize-fillhandle-broader";Q.appendChild(ra);Q.appendChild(mb);this.vU=Q;this.parentElement.appendChild(this.vU)};gb.prototype.OXb=function(Q){var ra=this,mb=this.Is.contains(Q),Qb=Q.top,Sc=Q.bottom,Ad=Q.left;
Q=Q.right;var ye=null;if(mb){if(this.gridView.Bja(this.Mn.topLeft)&&!this.Mn.oQa)return;Qb=Math.max(1,Sc-5,this.Mn.top);Ad=Math.max(1,Q-5,this.Mn.left);Sc=Qb;Q=Ad;ye=new Pf.Range(Qb,Ad,Qb,Ad,!1,!1)}else Sc+=5,Q+=5,Qb=Sc,Ad=Q,ye=new Pf.Range(Sc,Q,Sc,Q,!1,!1);this.gridView.Bja(ye)||(this.ur?this.ur.Po||(this.ur=Hc.a.instance.create(function(){ra.gridView.Dt(ye,60,hg.a.QXf)},40,ed.a.RXf)):this.ur=Hc.a.instance.create(function(){ra.gridView.Dt(ye,60,hg.a.QXf)},40,ed.a.RXf))};gb.prototype.WVb=function(Q){var ra=
Q;if(this.gridView.$a.U3){if(!this.gridView.Cc(Q.topLeft)){var mb=this.gridView.$m("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.kJ,this.Is.top!==Q.top?1:2);try{mb.Pk=this.Is.top<Q.top||this.Is.left<Q.left,mb.Ou(Q.topLeft),ra=mb.$$cu().range}finally{mb&&mb.dispose()}}ra.right=ra.left+Q.width-1;ra.bottom=ra.top+Q.height-1}return ra};gb.prototype.Cqc=function(Q,ra,mb){mb=void 0===mb?!0:mb;var Qb=[];Q=Ml(Q);for(var Sc=Q.next();!Sc.done;Sc=Q.next())Qb.push(new of.a(Sc.value,Db.d(this.$.sa)));
this.Sb.Zu(Qb,[ra],!0,void 0,mb)};gb.prototype.qQi=function(){for(var Q=Ml(this.gridView.uo),ra=Q.next();!ra.done;ra=Q.next())Rc.a.instance.qa(Kc.a.Jh,ra.value.domElement,Object(gd.a)(this,this.vk,"onPointerMove"));Rc.a.instance.qa(Kc.a.de,document.documentElement,Object(gd.a)(this,this.Hh,"onPointerUp"));this.rze()};gb.prototype.aRi=function(){for(var Q=Ml(this.gridView.uo),ra=Q.next();!ra.done;ra=Q.next())yg.a.instance.qa(Kc.a.Og,ra.value.domElement,Object(gd.a)(this,this.vk,"onPointerMove"));yg.a.instance.qa(Kc.a.Ge,
document.documentElement,Object(gd.a)(this,this.HBb,"onTouchUp"));this.rze()};gb.prototype.lv=function(){this.kwb&&this.Iuj();this.Ddc&&this.Tuj()};gb.prototype.Iuj=function(){for(var Q=Ml(this.gridView.uo),ra=Q.next();!ra.done;ra=Q.next())Rc.a.instance.Ca(Kc.a.Jh,ra.value.domElement,Object(gd.a)(this,this.vk,"onPointerMove"));Rc.a.instance.Ca(Kc.a.de,document.documentElement,Object(gd.a)(this,this.Hh,"onPointerUp"));this.FCf()};gb.prototype.Tuj=function(){for(var Q=Ml(this.gridView.uo),ra=Q.next();!ra.done;ra=
Q.next())yg.a.instance.Ca(Kc.a.Og,ra.value.domElement,Object(gd.a)(this,this.vk,"onPointerMove"));yg.a.instance.Ca(Kc.a.Ge,document.documentElement,Object(gd.a)(this,this.HBb,"onTouchUp"));this.FCf()};gb.prototype.rze=function(){Rc.a.instance.qa(Kc.a.$y,document.documentElement,Object(gd.a)(this,this.bxa,"onPointerLeave"));this.gridView.zc.y3b(!0);this.Qwb||(nf.KeyInputManager.instance.St(Kc.a.Rb,document.documentElement,Object(gd.a)(this,this.onKeyDown,"onKeyDown"),!0),this.tableManager.Bee(Object(gd.a)(this,
this.Mhc,"onCancelEditTable")))};gb.prototype.FCf=function(){Rc.a.instance.Ca(Kc.a.$y,document.documentElement,Object(gd.a)(this,this.bxa,"onPointerLeave"));this.gridView.zc.y3b(!1);this.Qwb||(nf.KeyInputManager.instance.Ca(Kc.a.Rb,document.documentElement,Object(gd.a)(this,this.onKeyDown,"onKeyDown")),this.tableManager.XEf(Object(gd.a)(this,this.Mhc,"onCancelEditTable")))};gb.prototype.$rj=function(Q){var ra={};Q=(ra.ResizeTableRange=Q,ra.OriginalTableRange=this.Mn,ra);this.$.Re(-1400250766,zg.a.Yb,
30,Q)};gb.prototype.lwj=function(Q){if(!this.Mn.contains(Q)){Q=this.Knj();Q=Ml(Q);for(var ra=Q.next();!ra.done;ra=Q.next())if(this.tableManager.skd(ra.value)){this.gridView.Vi.YA(Se.a.bli);return}}this.gridView.rtl?this.gridView.Vi.YA(Se.a.eki):this.gridView.Vi.YA(Se.a.Imi)};gb.prototype.qya=function(){if(this.tA){jg.b(this.$,!1);try{this.lv()}catch(Q){Uc.ULS.sendTraceTag(42321987,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",Q)}}this.ur&&(this.ur.cancel(),
this.ur.dispose());this.Ddc=this.kwb=!1;this.hEb();this.kBd();jg.b(this.$,!1);this.gridView.Vi.YA(Se.a.kua)};gb.prototype.Knj=function(){var Q=[];this.Mn.right!==this.Is.right&&Q.push(new Pf.Range(this.Mn.top,this.Mn.right+1,this.Is.bottom,this.Is.right,!1,!1));this.Mn.bottom!==this.Is.bottom&&Q.push(new Pf.Range(this.Mn.bottom+1,this.Mn.left,this.Is.bottom,this.Mn.right,!1,!1));return Q};gb.createInstance=function(Q,ra,mb,Qb){if(!ra)return null;var Sc=Q.Sb;Sc.Zu(mb,[27],!0);Sc.Wr(gb.Fnj);mb=Sc.sJ(27,
Q.$a.fk(ra.bottomRight),gb.eyh(ra,mb)).hn;return new gb(mb,Q,ra,Qb)};gb.eyh=function(Q,ra){for(var mb=0;mb<ra.length;mb++)if(ra[mb]&&ra[mb].range&&ra[mb].range.equals(Q))return mb;return 0};Jl.Object.defineProperties(gb.prototype,{tA:{configurable:!0,enumerable:!0,get:function(){return this.kwb||this.Ddc}},tkd:{configurable:!0,enumerable:!0,get:function(){return this.UPb}}});gb.Fnj=[27];Object(Le.a)(gb,"TableResizeBehavior",Kg.a,[]);var ch=b(227);pb.meh="ewa-ttrd-buttonarea";Object(Le.a)(pb,"CssClassNames",
null,[]);var Wg=b(45),qd=b(110),fd=b(92),kh=b(108),Lf=b(255),te=ch.a;Cm(Ub,te);Ub.prototype.dispose=function(){this.$&&this.C1g();this.$=this.gridView=this.parentElement=this.eJa=null;te.prototype.dispose.call(this)};Ub.prototype.Zvh=function(Q){var ra=this.NJh(this.gridView.Cc(null).range);return ra?String.format("=SUBTOTAL({0},{1})",Q,ra):null};Ub.prototype.NJh=function(Q){var ra=df.g(this.$).kc.Rk(Q);if(!ra)return null;ra=mc.a(ra,!1);ra.right=ra.left=Q.left;return ra.toString()};Ub.prototype.DVh=
function(){Ub.EI={};Ub.EI["100"]=Tc.a.instance.da(1036);Ub.EI["101"]=Tc.a.instance.da(1039);Ub.EI["102"]=Tc.a.instance.da(1038);Ub.EI["103"]=Tc.a.instance.da(1043);Ub.EI["104"]=Tc.a.instance.da(1040);Ub.EI["105"]=Tc.a.instance.da(1041);Ub.EI["109"]=Tc.a.instance.da(1037);Ub.EI["107"]=Tc.a.instance.da(1044);Ub.EI["110"]=Tc.a.instance.da(1046);Ub.EI["111"]=Tc.a.instance.da(1097)};Ub.prototype.SDi=function(){var Q=this.gridView.Cc(null);if(Q&&(Q=Q.NG?Q.formulaBarText:null))if("=SUBTOTAL("===Q.substring(0,
10)){if(Q=Q.substring(10,13),Q in Ub.EI)return Q}else return"111";return"100"};Ub.prototype.szg=function(){this.gridView.Ha.Dq(Object(gd.a)(this,this.Le,"onBlockCacheItemChanged"));this.gridView.ga.WF(Object(gd.a)(this,this.uh,"onActiveCellChanged"));this.gridView.Eq(Object(gd.a)(this,this.onContentReady,"onContentReady"));this.gridView.zc.Cm(Object(gd.a)(this,this.wkf,"onCellEditStarted"));this.gridView.zc.mt(Object(gd.a)(this,this.jAb,"onCellEditEnded"))};Ub.prototype.C1g=function(){this.gridView&&
(this.gridView.ga&&(this.gridView.ga.gN(Object(gd.a)(this,this.uh,"onActiveCellChanged")),this.gridView.Ha.Jp(Object(gd.a)(this,this.Le,"onBlockCacheItemChanged"))),this.gridView.Ps(Object(gd.a)(this,this.onContentReady,"onContentReady")),this.gridView.zc&&(this.gridView.zc.mm(Object(gd.a)(this,this.wkf,"onCellEditStarted")),this.gridView.zc.Qs(Object(gd.a)(this,this.jAb,"onCellEditEnded"))),this.z1f())};Ub.prototype.dob=function(Q){this.wwj(Q);this.Uwb&&(this.omj(),this.Jjb?(this.Bvf||this.Dzg(),
this.ONc?this.g4=!1:(this.g4=!0,this.BGf())):(Uc.ULS.sendTraceTag(51513356,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.g4=!1))};Ub.prototype.BGf=function(){var Q=this;appChrome.renderTableTotalRowOptions(this.parentElement,Ub.EI,Ub.EI[this.SDi()].toString(),Math.round(Nf.a(this.$).Ci(17)),function(ra){Uc.ULS.sendTraceTag(51513357,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",ra);if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var mb=
{};mb=(mb.SelectedOption=Ub.EI[ra],mb.FunctionKeyCode=ra,mb.Location="canvas",mb)}else mb={},mb=(mb.SelectedOption=Ub.EI[ra],mb.FunctionKeyCode=ra,mb);kh.b(Q.$).Jd(qd.a.Qnj,mb,null,!0);if("111"===ra)return Q.WYh(),!0;if("100"!==ra){Q.hGb=Q.Zvh(ra);if(!Q.hGb)return Uc.ULS.sendTraceTag(594113797,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;Q.kPa(Q.hGb)}else Q.kPa("");cf.DOMElementExtensions.setFocus(Q.gridView.Hc.textBox.domElement);return!0})};Ub.prototype.WYh=
function(){Uc.ULS.sendTraceTag(594056920,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var Q=new fd.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Na.Xb(Q)};Ub.prototype.Xta=function(Q){if(!Q)return null;var ra=this.gridView.zc.textBox.domElement;var mb=0<cf.DOMElementExtensions.getHeight(ra)&&0<cf.DOMElementExtensions.getWidth(ra)&&0<=ra.offsetTop&&0<=ra.offsetLeft;if(mb)ra=cf.DOMElementExtensions.Xta(ra,this.gridView.Pi);else{ra=this.gridView.getCellBounds(Q.cell);
var Qb=cf.DOMElementExtensions.getBoundingClientRect(this.gridView.Pi);ra=new Sys.UI.Bounds(ra.x-Qb.x,ra.y-Qb.y,ra.width,ra.height)}if(ra)if(mb)2<ra.height&&2<ra.height&&(ra.x+=1,ra.y+=1,ra.height-=2,ra.width-=2);else if(mb=df.g(this.$).nJ(Q.cell))mb=mb.width,Qb=Ud.a.equals(dh.a.O0a(Q.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Qb&&(ra.x=ra.x+ra.width-mb),Q.Ija&&this.gridView.rtl===Qb&&(ra.width=mb);else return null;return ra};Ub.prototype.wwj=function(Q){var ra=this.Jjb;if(ra){var mb=
17>=ra.height?ra.y:ra.y+ra.height-17-2;ra=this.V2h?this.gridView.rtl?ra.x:ra.x+ra.width-(17<ra.height?17:ra.height):this.gridView.rtl?ra.x-(17<ra.height?17:ra.height):ra.x+ra.width;var Qb=Nf.a(this.$).NIa(new Sys.UI.Point(ra,mb));this.parentElement.style.top=hd.HelperMethods.Ub(Qb.y);this.parentElement.style.left=hd.HelperMethods.Ub(Qb.x);Nf.a(this.$).M8i(this.parentElement);Q&&(this.g4=this.gridView.Ndc(new Wg.a(ra,mb)))}else this.g4=!1};Ub.prototype.Dzg=function(){this.eJa.insertBefore(this.parentElement,
this.eJa.firstChild);this.Bvf=!0};Ub.prototype.omj=function(){this.ZP||(this.gridView.view.nt(Object(gd.a)(this,this.qq,"onGridScroll")),this.ZP=!0)};Ub.prototype.z1f=function(){this.ZP&&this.gridView.view&&(this.gridView.view.Tr(Object(gd.a)(this,this.qq,"onGridScroll")),this.ZP=!1)};Ub.prototype.kPa=function(Q){var ra=this.gridView.Hc,mb=this.gridView.Cc(null);mb&&(Q=Object.assign(new Lf.a,{Text:Q}),this.gridView.setCell(Q,mb.range,0,127,null),ra.endEdit(!0,"TableTotalRowOptions.SetCellContent",
0))};Ub.prototype.uh=function(){Sb.c(this.$,this.gridView.ga.ya.activeCell)?(this.dKa=!0,this.dob(!1)):(this.g4=this.dKa=!1,this.z1f())};Ub.prototype.qq=function(){this.dKa?this.dob(!0):this.g4=!1};Ub.prototype.wkf=function(){this.ONc=!0;this.dKa&&(this.g4=!1)};Ub.prototype.onContentReady=function(){this.$.isEditMode?Sb.c(this.$,this.gridView.ga.ya.activeCell)&&(this.dKa=!0,this.dob(!1)):this.g4=!1};Ub.prototype.jAb=function(){this.ONc=!1;this.dKa?this.dob(!1):this.g4=!1};Ub.prototype.Le=function(Q,
ra){this.dKa&&(Q=this.gridView.zvd(ra.Qd.block.Ie.BlockCachePosition.PaneType).xF(ra.Qd.hash))&&(Q.BCd(Object(gd.a)(this,this.rJa,"headerBlockOnUpdatedBlockHtml")),Q.VPc(Object(gd.a)(this,this.rJa,"headerBlockOnUpdatedBlockHtml")))};Ub.prototype.rJa=function(){this.BGf()};Jl.Object.defineProperties(Ub.prototype,{g4:{configurable:!0,enumerable:!0,get:function(){return this.Zgd},set:function(Q){this.Zgd!==Q&&(this.Zgd=this.isVisible=Q)}},Uwb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Gd&
16)}},V2h:{configurable:!0,enumerable:!0,get:function(){var Q=this.gridView.ga.ya.activeCell;return Q.right===Q.Lt}},Jjb:{configurable:!0,enumerable:!0,get:function(){var Q=this.gridView.Cc(null);return Q&&this.gridView.vZ(Q.range)?this.Xta(Q):(Q&&Uc.ULS.sendTraceTag(594890818,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});Ub.Pnj="TableTotalRowDropDownIconButtonId";Ub.EI=null;Object(Le.a)(Ub,"TableTotalRowOptions",ch.a,[7]);Cm(Mb,Pc);Mb.prototype.Gfe=
function(Q){this.addHandler(Pc.fzd,Q)};Mb.prototype.OFf=function(Q){this.removeHandler(Pc.fzd,Q)};Mb.prototype.Bee=function(Q){this.addHandler("tce",Q)};Mb.prototype.XEf=function(Q){this.removeHandler("tce",Q)};Mb.prototype.skd=function(Q){return!!this.XSe(Q)};Mb.prototype.fo=function(Q){return this.RFh(this.BTe(Q))};Mb.prototype.auh=function(Q){return this.BTe(Q)};Mb.prototype.XQi=function(Q){Q?(this.zmb?this.zmb!==Q&&(Dg.a.Ia(this.Oma),this.Oma=null,this.zmb=Q):this.zmb=Q,this.Oma||(this.Oma=le.a.instance.Kd(this.zmb)),
this.Oma.qA("focusin")||this.Oma.la("focusin",Object(gd.a)(this,this.onFocus,"onFocus"))):Uc.ULS.sendTraceTag(594130058,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};Mb.prototype.k5e=function(Q,ra){return Q?Q.xua&&Q.top===ra.top:(Uc.ULS.shipAssertTag(20821026,0,!!Q,"autofilterRange can't be null"),!1)};Mb.prototype.MIa=function(Q){Q=this.xmb?gg.I(Q,this.xmb):this.view.getRangeInformation(Q);return 0<Q.length&&Object(Jc.a)(Yc.PivotTableRange,Q[0])?Q[0]:null};Mb.prototype.S_h=
function(Q,ra){return Q?!Q.Hbc&&!!Q.x9&&Q.x9.oe(ra):(Uc.ULS.shipAssertTag(20821027,0,!!Q,"Pivot table can't be null"),!1)};Mb.prototype.u5h=function(Q,ra){return Q?!Q.Hbc&&!!Q.IOa&&Q.IOa.oe(ra):(Uc.ULS.shipAssertTag(20821056,0,!!Q,"Pivot table can't be null"),!1)};Mb.prototype.eVb=function(Q){Pc.prototype.eVb.call(this,Q);if((Q=hd.HelperMethods.kTe(Q))&&0<Q.length){this.xmb=Array(Q.length);for(var ra=0;ra<Q.length;ra++)this.xmb[ra]=tb.a.MP(Q[ra])}};Mb.prototype.cEb=function(){Pc.prototype.cEb.call(this);
this.xmb=null};Mb.prototype.pRg=function(Q,ra){return this.aue(Q,ra).returnValue};Mb.prototype.aue=function(Q,ra){var mb=this;var Qb=!1;if(!Q||!ra)return{returnValue:!1,VX:Qb};Q=Q.clone();Q.right+=1;Q.left=Q.right;if(!Q.isValidRange)return{returnValue:!1,VX:Qb};if(Q.top<ra.$a.Qi){var Sc=Q.clone();Sc.bottom>=ra.$a.Qi&&(Sc.bottom=ra.$a.Qi-1);if(!function(){var ye=mb.$te(Sc,ra);Qb=ye.VX;return ye}().returnValue)return{returnValue:!1,VX:Qb}}if(Q.bottom>=ra.$a.Qi){var Ad=Q.clone();Ad.top<=ra.$a.Qi&&(Ad.top=
ra.$a.Qi);if(!function(){var ye=mb.$te(Ad,ra);Qb=ye.VX;return ye}().returnValue)return{returnValue:!1,VX:Qb}}return{returnValue:!0,VX:Qb}};Mb.prototype.SXf=function(Q){(Q=this.fo(Q.topLeft))&&Q.toString()in this.SDa&&(this.SDa[Q.toString()].Tjd=!1)};Mb.prototype.dLi=function(){this.raiseEvent("tce")};Mb.prototype.Xh=function(Q,ra){if(!this.Ttc)return!1;switch(ra){case -569786022:case 541421805:if(this.Ttc.g4){var mb=document.getElementById(Ub.Pnj);mb&&Hc.a.instance.create(function(){cf.DOMElementExtensions.ivb(mb,
null)},0,ed.a.Inj,!0,!0)}return!0;default:return!1}};Mb.prototype.dispose=function(){this.oZb(null,null);this.OFf(Object(gd.a)(this,this.kXb,"attachTableResizeBehavior"));this.$.Aa.wg(Object(gd.a)(this,this.fBf,"reAttachTableBehviors"));this.$.Xo(Object(gd.a)(this,this.oZb,"clearAllActiveTableBehaviors"));this.yMb=null;this.$.fa&&this.$.fa.g6(Object(gd.a)(this,this.i5,"onApplicationModeChanged"));this.gridView.ga.gN(Object(gd.a)(this,this.uh,"onActiveCellChanged"));this.Ttc=null;ee.EwaSettings.ka(427)&&
this.Oma&&(Dg.a.Ia(this.Oma),this.Oma=null);Pc.prototype.dispose.call(this)};Mb.prototype.ZOh=function(Q,ra,mb,Qb){var Sc=this.gridView.kc.Rk(new Pf.Range(ra,mb,ra,mb,!1,!1));if(this.n1b=Sc){var Ad=Sc.usedRange,ye=Q.ctrlKey||bf.a.isMac&&Yg.b(Q),Ze=!Q.shiftKey&&ye;Q=Q.shiftKey&&!ye;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(df.g(this.$).ga.selectionType=3);switch(Qb){case 0:this.RNb=0;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ra=this.UZc(Q,Ad.top,mb,Ad.bottom,mb),this.UHd(ra,Ze,Q)):this.VHd(Ad.top,mb,Ad.bottom,mb,mc.d(Sc),mc.g(Sc),Ze);break;case 1:this.RNb=1;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ra=this.UZc(Q,ra,Ad.left,ra,Ad.right),this.UHd(ra,Ze,Q)):this.VHd(ra,Ad.left,ra,Ad.right,!1,!1,Ze);break;case 2:this.RNb=2;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ra=this.UZc(Q,Ad.top,Ad.left,Ad.bottom,Ad.right),this.UHd(ra,
Ze,Q)):this.VHd(Ad.top,Ad.left,Ad.bottom,Ad.right,mc.d(Sc),mc.g(Sc),Ze);break;default:Uc.ULS.shipAssertTag(542752842,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Qb.toString())}ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(df.g(this.$).ga.selectionType=3)}else Uc.ULS.shipAssertTag(542752843,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};Mb.prototype.tcj=function(Q){var ra=
this.n1b.usedRange;return this.p7e(Q)||1!==this.oGa&&this.p7e(new Pf.Range(ra.top,Q.left,ra.bottom,Q.right,!1,!1))?!0:!1};Mb.prototype.ezd=function(Q){return Q.Autofilters};Mb.prototype.kXb=function(){var Q={},ra=this.$$c(),mb;for(mb in ra){var Qb=ra[mb];if(Qb){var Sc=this.VIh(Qb);if(Sc){if(Sc in this.SDa){var Ad=this.SDa[Sc];if(Ad.tA){Ad.Mn.equals(Qb)||(Ad.Mn=Qb);delete this.SDa[Sc];Q[Sc]=Ad;continue}}(Ad=gb.createInstance(df.g(this.$),Qb,this.kth(),this))?Q[Sc]=Ad:Uc.ULS.sendTraceTag(42078495,0,
15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",Qb.GG(!1))}}}this.oZb(null,null);this.yMb=Q};Mb.prototype.oZb=function(){var Q=this.SDa,ra;for(ra in Q){var mb=ra,Qb=Q[ra];Qb&&(Qb.dispose(),delete this.SDa[mb])}this.yMb={}};Mb.prototype.$te=function(Q,ra){var mb=!1;var Qb=ra.$a.fk(Q),Sc=ra.Yf(Qb).Ph;if(!Sc)return Uc.ULS.sendTraceTag(40640599,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",Qb),{returnValue:!1,VX:mb};if(!Sc.Of(Q))return{returnValue:!0,
VX:mb};Q=ra.$m("TableManager.CouldExpandImpl",Q,2);try{for(;Q.$$mn();){if(!Ud.a.na(Q.$$cu().text)||Q.Zn.ZYe)return mb=!0,{returnValue:!1,VX:mb};if(Q.$$cu().sM)return{returnValue:!1,VX:mb}}}finally{Q&&Q.dispose()}return{returnValue:!0,VX:mb}};Mb.prototype.RFh=function(Q){if(!Q)return null;var ra=new bd.AutofilterRange(Q.top,Q.left,Q.bottom,Q.right,null,null,null,Q.id,Q.xua);ra.oQa=Q.oQa;for(var mb=0,Qb=this.rangeList.length;mb<Qb;mb++){var Sc=this.rangeList[mb];Sc.id===Q.id&&Sc!==Q&&this.D4h(Sc)&&
(ra.union(Sc),Sc.oQa&&(ra.oQa=!0))}return ra};Mb.prototype.D4h=function(Q){return!!df.g(this.$).kc.Rk(Q)};Mb.prototype.kth=function(){for(var Q=[],ra=Ml(this.rangeList),mb=ra.next();!mb.done;mb=ra.next())mb=new of.a(this.fo(mb.value.topLeft),Db.d(this.$.sa)),Q.push(mb);return Q};Mb.prototype.$$c=function(){for(var Q={},ra=Ml(this.rangeList),mb=ra.next();!mb.done;mb=ra.next())if(mb=mb.value){var Qb=this.fo(mb.topLeft);Qb&&(Q[Qb.toString()]=this.fo(mb.topLeft))}return Q};Mb.prototype.fBf=function(){this.oZb(null,
null);this.kXb(null,null)};Mb.prototype.onFocus=function(){this.b2d=df.g(this.$).ga.ya.activeCell};Mb.prototype.i5=function(){this.$.isEditMode&&this.uh(null,null)};Mb.prototype.uh=function(){!this.Ehe&&Sb.c(this.$,this.gridView.ga.ya.activeCell)&&this.Uai()};Mb.prototype.Uai=function(){this.$.fa.fi?this.Vub(0):this.$.fa.Do(Object(gd.a)(this,this.JM,"onAppInteractive"))};Mb.prototype.JM=function(){this.Vub(1);this.$.fa.Sr(Object(gd.a)(this,this.JM,"onAppInteractive"))};Mb.prototype.Vub=function(Q){var ra=
this;this.$.HG(function(mb){mb.lIa(Q).then(Object(gd.a)(ra,ra.Pwd,"postAppChromeLoadActions"))})};Mb.prototype.Pwd=function(){this.Ehe=!0;this.Ttc=new Ub(this.$)};Mb.prototype.VIh=function(Q){var ra=this.gridView.kc.Rk(Q);return ra?ra.name:Q.toString()};Mb.prototype.VHd=function(Q,ra,mb,Qb,Sc,Ad,ye){var Ze=Q+(Sc?1:0),sd=mb-(Ad?1:0),pe=this.gridView.inRangePicker||this.gridView.wi,Ve=!1,Li=new Pf.Range(Ze,ra,sd,Qb,!1,!1);if(Sc||Ad)for(Sc=pe?of.a.ZYa(this.gridView.ga.rangePicker.ZM):this.gridView.ga.ya.selectedRanges,
Sc=Ml(Sc),Ad=Sc.next();!Ad.done;Ad=Sc.next()){Ad=Ad.value;Ve=this.Cnb(Ad,Ze,ra,sd,Qb);var Jf=this.Cnb(Ad,Q,ra,mb,Qb);if(pe&&Ve)break;if(!pe&&(Ve||Jf)){this.gridView.ga.updateSelection(Ad,Ad.topLeft,0,1);if(ye&&Jf)return;break}}Ve&&(Li.top=Q,Li.bottom=mb);Q=Li.topLeft;ye?this.gridView.ga.updateSelection(Li,Q,0,1):pe?this.gridView.ga.dD([Li],0,Q,0):this.gridView.ga.updateSelection(Li,Q,0,3)};Mb.prototype.UHd=function(Q,ra,mb){Q&&(mb=mb?df.g(this.$).ga.ya.activeCell:Q.topLeft,ra?this.gridView.ga.updateSelection(Q,
mb,0,1):this.gridView.ga.dD([Q],0,mb,0))};Mb.prototype.UZc=function(Q,ra,mb,Qb,Sc){var Ad=mc.d(this.n1b),ye=mc.g(this.n1b),Ze=ra+(1!==this.oGa&&Ad?1:0),sd=Qb-(1!==this.oGa&&ye?1:0),pe=this.gridView.inRangePicker||this.gridView.wi;if(Q){var Ve=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&pe&&!of.a.ZYa(this.gridView.ga.rangePicker.ZM).length?new Pf.Range(Ze,mb,sd,Sc,!1,!1):pe?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.ya.activeCell;Ve=new Pf.Range(Ve.top<
Ze?Ve.top:Ze,Ve.left<mb?Ve.left:mb,Ve.bottom>sd?Ve.bottom:sd,Ve.right>Sc?Ve.right:Sc,!1,!1)}else Ve=new Pf.Range(Ze,mb,sd,Sc,!1,!1);if(1!==this.oGa&&(Ad||ye)&&(!Q||Q&&this.Cnb(Ve,Ze,mb,sd,Sc)))for(Q=pe?of.a.ZYa(this.gridView.ga.rangePicker.ZM):this.gridView.ga.ya.selectedRanges,Q=Ml(Q),Ad=Q.next();!Ad.done;Ad=Q.next())if(this.Cnb(Ad.value,Ze,mb,sd,Sc)){Ve.top=ra;Ve.bottom=Qb;break}return Ve};Mb.prototype.p7e=function(Q){var ra=this.gridView.inRangePicker||this.gridView.wi?of.a.ZYa(this.gridView.ga.rangePicker.ZM):
this.gridView.ga.ya.selectedRanges;ra=Ml(ra);for(var mb=ra.next();!mb.done;mb=ra.next())if(this.Cnb(mb.value,Q.top,Q.left,Q.bottom,Q.right))return!0;return!1};Mb.prototype.Cnb=function(Q,ra,mb,Qb,Sc){return!!Q&&Q.top===ra&&Q.bottom===Qb&&Q.left===mb&&Q.right===Sc};Jl.Object.defineProperties(Mb.prototype,{SDa:{configurable:!0,enumerable:!0,get:function(){return this.yMb}},Cld:{configurable:!0,enumerable:!0,get:function(){return this.b2d}},oGa:{configurable:!0,enumerable:!0,get:function(){return this.RNb}},
Nj:{configurable:!0,enumerable:!0,get:function(){var Q=df.g(this.$);return Q.kc.Rk(Q.ga.ya.activeCell,!1)}},Rxd:{configurable:!0,enumerable:!0,get:function(){return this.Cld?df.g(this.$).kc.Rk(this.Cld,!1):null}}});Object(Le.a)(Mb,"TableManager",Pc,[618,7]);var Wd=Kf.a;Cm(Hb,Wd);Hb.prototype.create=function(){this.Jb(this.tableManager||(this.tableManager=new Mb(this.$)))};Object(Le.a)(Hb,"TableManagerFactory",Kf.a,[]);var mh=b(113),ug=b(931),ki=b(1394),Hg=b(833),Mg=b(1345),Eh=b(161),Gh=b(81),qi=b(104),
Bh=b(26),Cf=b(179),Yh=b(27),aa=b(303);Object(Le.a)(Jb,"TableStyleElement",null,[]);var ab=b(859),Rb=b(195),Cc=b(84),Bc=b(554);Va.ldf=function(Q,ra){return Va.VXf[Q.Type]-Va.VXf[ra.Type]};Va.b1a=function(Q,ra){try{return appChrome.buildTableStyleGalleryIconNew(Va.zza,Va.Lma,Q,ra)}catch(mb){return null}};Va.K8e=function(Q){return Q&&zg.a.Vd in Q&&(Q=Q[zg.a.Vd],!Ud.a.na(Q))?Ud.a.UH(Q,Se.a.VCb):!1};Va.Era=function(Q){var ra=[],mb=0;Q=Ml(Q);for(var Qb=Q.next();!Qb.done;Qb=Q.next()){Qb=Qb.value;ra[mb]=
{};ra[mb].backgroundColor="white";ra[mb].color="black";for(var Sc in Qb){var Ad=Qb[Sc];switch(Sc){case "background-color":ra[mb].backgroundColor=Ad;break;case "color":ra[mb].color=Ad;break;case "font-size":ra[mb].fontSize=Ad;break;case "border-bottom":ra[mb].borderBottom=Ad;break;case "border-right":ra[mb].borderRight=Ad;break;case "border-left":ra[mb].borderLeft=Ad;break;case "border-top":ra[mb].borderTop=Ad}}mb++}return ra};Va.T_b=function(Q,ra){var mb=[];if(Q&&Q.TableStyleElementsList)for(var Qb=
!Q.Category,Sc=0;Sc<Va.Lma;Sc++)mb.push.apply(mb,Va.Wwh(Q,ra,Qb,Sc));else{if(Va.q0c)return Va.q0c;Q={color:"black","background-color":"white"};for(ra=0;ra<Va.Lma;ra++)for(Qb=0;Qb<Va.zza;Qb++)mb.push(Q);Va.q0c=mb}return mb};Va.WIh=function(Q,ra){if(!Q.TableStyleElementsList)return"";var mb="";Q=Ml(Q.TableStyleElementsList);for(var Qb=Q.next();!Qb.done;Qb=Q.next())if(Qb=Qb.value,!Ud.a.na(Qb.BackgroundColor)&&"#000000"!==Qb.BackgroundColor)switch(Qb.Type){case 0:mb=Qb.BackgroundColor;break;case 5:case 7:if(ra.Qga||
ra.fR)mb=Qb.BackgroundColor;break;case 3:case 4:if(ra.firstCol||ra.lastCol)mb=Qb.BackgroundColor;break;case 2:ra.totalRow&&(mb=Qb.BackgroundColor);break;case 1:ra.headerRow&&(mb=Qb.BackgroundColor)}return mb};Va.UZb=function(Q){Q=new Rb.a(parseInt(String("0x"+Q.substr(1,2))),parseInt(String("0x"+Q.substr(3,2))),parseInt(String("0x"+Q.substr(5,2))));return ab.a.HIa(Q)};Va.eVe=function(Q,ra){if(!Q||!ra)return"";ra=Va.WIh(Q,ra);ra=Ud.a.na(ra)?Tc.a.instance.da(1976)+", ":Va.UZb(ra)+", ";switch(Q.Index){case 0:return ra+
Tc.a.instance.da(1910);case 1:return ra+Tc.a.instance.da(1911);case 2:return ra+Tc.a.instance.da(1912);case 3:return ra+Tc.a.instance.da(1913);case 4:return ra+Tc.a.instance.da(1914);case 5:return ra+Tc.a.instance.da(1915);case 6:return ra+Tc.a.instance.da(1916);case 7:return ra+Tc.a.instance.da(1917);case 8:return ra+Tc.a.instance.da(1918);case 9:return ra+Tc.a.instance.da(1919);case 10:return ra+Tc.a.instance.da(1920);case 11:return ra+Tc.a.instance.da(1921);case 12:return ra+Tc.a.instance.da(1922);
case 13:return ra+Tc.a.instance.da(1923);case 14:return ra+Tc.a.instance.da(1924);case 15:return ra+Tc.a.instance.da(1925);case 16:return ra+Tc.a.instance.da(1926);case 17:return ra+Tc.a.instance.da(1927);case 18:return ra+Tc.a.instance.da(1928);case 19:return ra+Tc.a.instance.da(1929);case 20:return ra+Tc.a.instance.da(1930);case 21:return ra+Tc.a.instance.da(1931);case 22:return ra+Tc.a.instance.da(1932);case 23:return ra+Tc.a.instance.da(1933);case 24:return ra+Tc.a.instance.da(1934);case 25:return ra+
Tc.a.instance.da(1935);case 26:return ra+Tc.a.instance.da(1936);case 27:return ra+Tc.a.instance.da(1937);case 28:return ra+Tc.a.instance.da(1938);case 29:return ra+Tc.a.instance.da(1939);case 30:return ra+Tc.a.instance.da(1940);case 31:return ra+Tc.a.instance.da(1941);case 32:return ra+Tc.a.instance.da(1942);case 33:return ra+Tc.a.instance.da(1943);case 34:return ra+Tc.a.instance.da(1944);case 35:return ra+Tc.a.instance.da(1945);case 36:return ra+Tc.a.instance.da(1946);case 37:return ra+Tc.a.instance.da(1947);
case 38:return ra+Tc.a.instance.da(1948);case 39:return ra+Tc.a.instance.da(1949);case 40:return ra+Tc.a.instance.da(1950);case 41:return ra+Tc.a.instance.da(1951);case 42:return ra+Tc.a.instance.da(1952);case 43:return ra+Tc.a.instance.da(1953);case 44:return ra+Tc.a.instance.da(1954);case 45:return ra+Tc.a.instance.da(1955);case 46:return ra+Tc.a.instance.da(1956);case 47:return ra+Tc.a.instance.da(1957);case 48:return ra+Tc.a.instance.da(1958);case 49:return ra+Tc.a.instance.da(1959);case 50:return ra+
Tc.a.instance.da(1960);case 51:return ra+Tc.a.instance.da(1961);case 52:return ra+Tc.a.instance.da(1962);case 53:return ra+Tc.a.instance.da(1963);case 54:return ra+Tc.a.instance.da(1964);case 55:return ra+Tc.a.instance.da(1965);case 56:return ra+Tc.a.instance.da(1966);case 57:return ra+Tc.a.instance.da(1967);case 58:return ra+Tc.a.instance.da(1968);case 59:return ra+Tc.a.instance.da(1969);default:return Ud.a.na(Q.Name)?"":Q.Name}};Va.FDh=function(Q){return(Q+1)%Va.mSh};Va.dtb=function(Q,ra,mb){mb=
void 0===mb?"":mb;return Q||Ud.a.na(mb)?String.format("{0}, {1}, -version, {2}",Va.e0e,Q.Index.toString(),ra.toString()):String.format("{0}, {1}, -version, {2}",Va.e0e,mb,ra.toString())};Va.Wwh=function(Q,ra,mb,Qb){for(var Sc=[],Ad=0;Ad<Va.zza;Ad++)Sc.push(Va.L8c(Q,ra,mb,Qb,Ad));return Sc};Va.L8c=function(Q,ra,mb,Qb,Sc){var Ad=Q.TableStyleElementsList;Q=new Jb;var ye={};if(!Ad)return ye;for(var Ze=Ml(Ad),sd=Ze.next();!sd.done;sd=Ze.next())if(sd=sd.value,!sd.Type){Q=sd;break}Ze=!Ud.a.na(Q.BackgroundColor);
var pe="";!mb&&Q.TableStyleBorderFromatList&&0<Q.TableStyleBorderFromatList.length&&(pe=Q.TableStyleBorderFromatList[0].Color);ye["background-color"]=Ze?Q.BackgroundColor:"#FFFFFF";Ud.a.na(Q.FontColor)&&(Q.FontColor="#000000");ye.color=Q.FontColor;Va.fpe(Qb,Sc,ye,Q,pe,mb,Ze);Ad=Ml(Ad);for(sd=Ad.next();!sd.done;sd=Ad.next())(sd=sd.value)&&sd.Type&&(2!==sd.Type||Ze||(sd.BackgroundColor=Q.BackgroundColor),Va.mkd(sd,Qb,Sc,ra)&&(Ud.a.na(sd.BackgroundColor)||(ye["background-color"]=sd.BackgroundColor),
ye.color=Ud.a.na(sd.FontColor)?Q.FontColor:sd.FontColor,Va.fpe(Qb,Sc,ye,sd,pe,mb,Ze)));return ye};Va.lU=function(Q,ra,mb,Qb,Sc,Ad){mb&&(Ud.a.na(mb.Color)||mb.Style||(mb.Style=1),mb.Style&&Ud.a.na(mb.Color)&&(Sc?mb.Color="#000000":Ud.a.na(Qb)?mb.Color=Ad?"#FFFFFF":"#000000":mb.Color=Qb),ra[Va.borders[Q]]="1px "+Va.aV[mb.Style]+" "+mb.Color)};Va.mkd=function(Q,ra,mb,Qb){return-1===Q.Type?!1:Va.nkd(Q,ra,mb,Qb)||Va.w6h(Q,ra,mb,Qb)||Va.okd(Q,ra,mb,Qb)};Va.w6h=function(Q,ra,mb,Qb){return!ra&&Qb.headerRow||
ra===Va.Lma-1&&Qb.totalRow?!1:1===ra%2&&5===Q.Type&&Qb.fR&&Qb.headerRow||1<ra&&!!((ra-1)%(Q.BandSize+1))&&6===Q.Type&&Qb.fR&&Qb.headerRow||!(ra%2)&&5===Q.Type&&Qb.fR&&!Qb.headerRow||!!(ra%(Q.BandSize+1))&&6===Q.Type&&Qb.fR&&!Qb.headerRow||!(mb%2)&&7===Q.Type&&Qb.Qga||!!(mb%(Q.BandSize+1))&&8===Q.Type&&Qb.Qga};Va.okd=function(Q,ra,mb,Qb){return ra===Va.Lma-1&&2===Q.Type&&Qb.totalRow||mb===Va.zza-1&&ra===Va.Lma-1&&12===Q.Type&&Qb.totalRow&&Qb.lastCol||!mb&&ra===Va.Lma-1&&11===Q.Type&&Qb.totalRow&&Qb.firstCol||
mb===Va.zza-1&&4===Q.Type&&Qb.lastCol};Va.nkd=function(Q,ra,mb,Qb){return!ra&&1===Q.Type&&Qb.headerRow||!mb&&3===Q.Type&&Qb.firstCol||!mb&&!ra&&9===Q.Type&&Qb.headerRow&&Qb.firstCol||mb===Va.zza-1&&!ra&&10===Q.Type&&Qb.headerRow&&Qb.lastCol};Va.fpe=function(Q,ra,mb,Qb,Sc,Ad,ye){if(Qb.TableStyleBorderFromatList)for(var Ze=Ml(Qb.TableStyleBorderFromatList),sd=Ze.next();!sd.done;sd=Ze.next())if(sd=sd.value,sd.Style)switch(sd.Position){case 0:Q&&12!==Qb.Type&&11!==Qb.Type&&2!==Qb.Type&&5!==Qb.Type&&6!==
Qb.Type||Va.lU(0,mb,sd,Sc,Ad,ye);break;case 1:Q!==Va.Lma-1&&1!==Qb.Type&&10!==Qb.Type&&9!==Qb.Type&&5!==Qb.Type&&6!==Qb.Type||Va.lU(1,mb,sd,Sc,Ad,ye);break;case 2:ra&&12!==Qb.Type&&10!==Qb.Type&&7!==Qb.Type&&8!==Qb.Type&&4!==Qb.Type||Va.lU(2,mb,sd,Sc,Ad,ye);break;case 3:ra!==Va.zza-1&&9!==Qb.Type&&11!==Qb.Type&&3!==Qb.Type&&7!==Qb.Type&&8!==Qb.Type||Va.lU(3,mb,sd,Sc,Ad,ye);break;case 5:ra!==Va.zza-1&&3!==Qb.Type&&4!==Qb.Type&&7!==Qb.Type&&8!==Qb.Type&&Va.lU(3,mb,sd,Sc,Ad,ye);break;case 6:Q!==Va.Lma-
1&&2!==Qb.Type&&1!==Qb.Type&&5!==Qb.Type&&6!==Qb.Type&&Va.lU(1,mb,sd,Sc,Ad,ye)}};Va.ZIh=function(){var Q=Array(12);Q[0]=0;Q[7]=1;Q[8]=2;Q[5]=3;Q[6]=4;Q[4]=5;Q[3]=6;Q[1]=7;Q[2]=8;Q[9]=9;Q[10]=10;Q[11]=11;Q[12]=13;return Q};Va.Lma=5;Va.zza=5;Va.mSh=5;Va.e0e="TableStyleIcon";Va.aV=[null,Cc.a.solid,Cc.a.dashed,Cc.a.dotted,Cc.a.dashed,Cc.a.dotted,Cc.a.dashed,Cc.a.double];Va.borders=[Bc.a.borderTop,Bc.a.borderBottom,Bc.a.borderLeft,Bc.a.borderRight];Va.VXf=Va.ZIh();Va.q0c=null;Object(Le.a)(Va,"TableStyleHelper",
null,[]);Da.prototype.equals=function(Q){return Q?this.headerRow===Q.headerRow&&this.totalRow===Q.totalRow&&this.firstCol===Q.firstCol&&this.lastCol===Q.lastCol&&this.Qga===Q.Qga&&this.fR===Q.fR:!1};Object(Le.a)(Da,"TableStyleOptions",null,[]);var Dd=b(906),Ee=uf.a;Cm(wa,Ee);wa.prototype.$Oh=function(Q){var ra=this.tableManager.Nj;if(!ra)return!1;Q=Q[zg.a.Vd];if(Ud.a.na(Q))return!1;switch(Number.parseInvariant(Q)){case 0:return mc.d(ra);case 1:return mc.c(ra);case 2:return mc.g(ra);case 3:return mc.e(ra);
case 4:return mc.f(ra);case 5:return mc.b(ra);case 6:return ra.hasAutoFilter}return!1};wa.prototype.Zwf=function(Q,ra){if(mh.a.isEmpty(this.oF))return!0;if("PopulateTableMoreStylesMenu"!==Q&&"PopulateTableAccessibleStylesMenu"!==Q)return!1;if(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===Q&&!this.utc)return this.LIb||(this.LIb=!0,this.D1a("accessibilityTab")),!0;this.Pwb=!0;var mb=this.Va.sp("TableStylesMenu"),Qb=this.Va.cA("Ribbon.TableTools.TableStyles.Gallery.Custom",
7,"Size48by48"),Sc=this.Va.cA("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ad=this.Va.cA("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),ye=this.Va.cA("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),Ze=-123538519;if(!Ud.a.na(ra.MenuId))if(Ud.a.contains(ra.MenuId,"FormatAsTable",!0))Ze=753331043,this.A3a=!0;else{var sd=Tc.a.instance.da(1909);var pe=Va.dtb(null,1,"-1");ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?
ye.jt("-1",Ze,"QueryTableStyle",0,"-1",pe,void 0,void 0,sd):ye.jt("-1",Ze,"QueryTableStyle",0,"-1",void 0,void 0,void 0,sd);this.A3a=!1}pe=0;var Ve=this.oF,Li;for(Li in Ve){var Jf=Ve[Li];if(!ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==Q||!Jf.HasStyleViolations){sd=Va.eVe(Jf,this.dsb());var ui=Va.dtb(Jf,this.gGa);if(Jf)switch(Jf.Category){case 0:Qb.jt(Jf.Index.toString(),Ze,"QueryTableStyle",0,Jf.Index.toString(),ui,
void 0,void 0,sd);pe++;break;case 3:Sc.jt(Jf.Index.toString(),Ze,"QueryTableStyle",0,Jf.Index.toString(),ui,void 0,void 0,sd);break;case 2:Ad.jt(Jf.Index.toString(),Ze,"QueryTableStyle",0,Jf.Index.toString(),ui,void 0,void 0,sd);break;case 1:ye.jt(Jf.Index.toString(),Ze,"QueryTableStyle",0,Jf.Index.toString(),ui,void 0,void 0,sd)}}}0<pe&&this.y1(mb,Qb,1877);this.y1(mb,ye,1878);this.y1(mb,Ad,1879);this.y1(mb,Sc,1880);ra.MenuItems=mb.JB();this.isInitialized||(this.isInitialized=!0);return!0};wa.prototype.aPh=
function(Q){var ra=this;Q[ug.a.On]=!1;var mb=Q[zg.a.Vd];if(!Ud.a.na(mb)&&!mh.a.isEmpty(this.oF)){Ud.a.contains(Q.ParentMenuId,"FormatAsTable",!0)?this.A3a=!0:this.A3a=!1;this.A3a||this.m2f();Va.K8e(Q)&&(mb=this.xsb(mb).toString());var Qb=this.dsb();Q[ug.a.Alt]="-1"===mb?Tc.a.instance.da(1909):Va.eVe(this.Nad(mb),Qb);if(mb in this.KQa&&Qb.equals(this.BTc))this.bxf(Q,mb,Qb,!0);else{if(!this.jmc||this.jmc&&!this.jmc.Po)this.ela={},this.jmc=Hc.a.instance.create(function(){ra.aDf();ra.BTc=ra.dsb()},0,
ed.a.Onj,!0,!0);this.Kwd(Qb,Q,mb)}}};wa.prototype.getTableStyleIndexFromName=function(Q){if(Ud.a.na(Q)||mh.a.isEmpty(this.oF))return-1;if(Q in this.oF)return this.oF[Q].Index;this.D1a("getTableStyleIndexFromName");return-1};wa.prototype.ukd=function(){return!!this.EK};wa.prototype.xsb=function(Q){this.$M||this.dTc();return Q in this.$M?this.$M[Q]:-1};wa.prototype.D1a=function(Q){if(this.$.isEditMode)if(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ra=
new Date;if(30<qi.getElapsedSeconds(this.lastSyncTime,ra)||mh.a.isEmpty(this.oF)||this.LIb){var mb=this.$.ra.xa.dc();this.lastSyncTime=ra;ra=(Q=this.LIb&&"accessibilityTab"===Q||"galleryMenuClosed"===Q)?"accessibility":"normal";Gh.s(this.$.ra.xa,Q,Object(gd.a)(this,this.Dnf,"onGetTableStyleSuccess"),Object(gd.a)(this,this.std,"onGetTableStyleFailed"),null,ra,mb)}}else if(mb=new Date,30<qi.getElapsedSeconds(this.lastSyncTime,mb)||mh.a.isEmpty(this.oF))Q=this.$.ra.xa.dc(),this.lastSyncTime=mb,Gh.r(this.$.ra.xa,
Object(gd.a)(this,this.Dnf,"onGetTableStyleSuccess"),Object(gd.a)(this,this.std,"onGetTableStyleFailed"),null,null,Q)};wa.prototype.dispose=function(){this.$M=this.KQa=this.EK=this.oF=null;this.$.Na.c9a(Object(gd.a)(this,this.htf,"onTableStyleGalleryMenuClosed"));Ee.prototype.dispose.call(this)};wa.prototype.bug=function(Q){this.addHandler("RefreshTableStyleGallery",Q)};wa.prototype.eVi=function(Q){this.removeHandler("RefreshTableStyleGallery",Q)};wa.prototype.Dnf=function(Q,ra,mb){var Qb=!1,Sc=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1);if(aa.a(Q))-315732528!==Q.Errors[0].MessageId&&(Uc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",Yh.a.fd(Q.Errors)),this.std(null,ra,mb));else if(Uc.ULS.sendTraceTag(42821708,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Q=Q.Result)&&Q.TableStyleItems.length){mb=60<Q.TableStyleItems.length;var Ad=!1,ye=!1;if(this.EK)for(var Ze=0;60>Ze;++Ze){var sd=Q.TableStyleItems[Ze],pe=this.EK.TableStyleItems[Ze];
if(Sc&&sd.HasStyleViolations!==pe.HasStyleViolations){Qb=ye=!0;break}for(var Ve=0;9>Ve&&!(Ve>=sd.TableStyleElementsList.length);Ve++)if(!Ud.a.equals(sd.TableStyleElementsList[Ve].BackgroundColor,pe.TableStyleElementsList[Ve].BackgroundColor,!1)){Qb=Ad=!0;break}}else for(this.gGa=0,Ze=Ml(Q.TableStyleItems),sd=Ze.next();!sd.done;sd=Ze.next())sd=sd.value,sd.TableStyleElementsList&&sd.TableStyleElementsList.sort(Va.ldf),this.oF[sd.Name]=sd;if(Ad||ye)for(Ad=0;60>Ad;++Ad)ye=Q.TableStyleItems[Ad],this.oF[ye.Name]=
ye;if(mb&&this.EK)for(Uc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",Q.TableStyleItems.length-60),Qb=!0,mb=60;mb<Q.TableStyleItems.length;++mb)Ad=Q.TableStyleItems[mb],Ad.Name in this.oF||Ad.TableStyleElementsList&&Ad.TableStyleElementsList.sort(Va.ldf),this.oF[Ad.Name]=Ad;if(Dd.a(this.oF).length!==Q.TableStyleItems.length)for(Qb=!0,Ad=mb=60;Ad<this.EK.TableStyleItems.length;)mb>=Q.TableStyleItems.length?delete this.oF[this.EK.TableStyleItems[Ad].Name]:
mb>=Q.TableStyleItems.length||!Ud.a.equals(Q.TableStyleItems[mb].Name,this.EK.TableStyleItems[Ad].Name,!1)?delete this.oF[this.EK.TableStyleItems[Ad].Name]:++mb,++Ad;this.EK=Q;this.aDf(Qb);Qb&&this.dTc();Sc&&ra&&("accessibility"===ra?(this.LIb=!1,this.utc=!0):this.utc=!1);this.d7e||(this.M6h()&&this.$.If(),this.d7e=!0);this.Oad=0;this.Pwb||this.ZLe?Sc&&this.utc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.ZLe=!0)}};wa.prototype.std=function(){var Q=
this;Uc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Oad++;5>this.Oad&&Hc.a.instance.create(function(){Q.D1a("getTableStylesFailed")},1E3,ed.a.UXf,!0,!0)};wa.prototype.dTc=function(){var Q={};this.tableManager.Nj&&(this.Fca=this.getTableStyleIndexFromName(this.tableManager.Nj.Stc));for(var ra=1;7>=ra;ra++)Q["preview"+ra]=this.NCh(ra);this.$M=Q};wa.prototype.NCh=function(Q){var ra=this.EK.TableStyleItems.length;ra=4>=this.Fca?this.Fca+Q-1:
4<this.Fca&&this.Fca<ra-4?4===Q?this.Fca:Math.floor(this.Fca+Q-4):this.Fca+Q-1;-1===ra||ra.toString()in this.KQa||(ra=Q-3);return ra};wa.prototype.m2f=function(){if(this.tableManager.Nj){var Q=!1,ra=this.getTableStyleIndexFromName(this.tableManager.Nj.Stc);if(ra!==this.Fca){if(this.$M){var mb=this.$M,Qb;for(Qb in mb)mb[Qb]===ra&&(Q=!0)}this.Fca=ra;Q||mh.a.isEmpty(this.KQa)||this.dTc()}}};wa.prototype.y1=function(Q,ra,mb){var Qb=this.Va.Vc();Qb.yp="Thin";Qb.title=Tc.a.instance.da(mb);Qb.buttons.push(ra);
Q.Fc.push(Qb)};wa.prototype.dsb=function(){var Q=this.tableManager.Nj;return this.A3a||!Q?new Da(!0,!1,!1,!1,!0,!1):new Da(mc.d(Q),mc.g(Q),mc.c(Q),mc.e(Q),mc.f(Q),mc.b(Q))};wa.prototype.aDf=function(Q){Q=void 0===Q?!1:Q;var ra={},mb={},Qb=this.dsb();if(!mh.a.isEmpty(this.oF)&&(this.tableManager.Nj&&this.m2f(),!Qb.equals(this.BTc)||Q||mh.a.isEmpty(this.KQa))){this.gGa=Va.FDh(this.gGa);Q=this.oF;for(var Sc in Q){var Ad=Q[Sc],ye=Va.dtb(Ad,this.gGa);ra[Ad.Index.toString()]=Va.b1a(Va.Era(Va.T_b(Ad,Qb)),
ye);mb[ye]=ra[Ad.Index.toString()];this.UDb(mb)}Sc=Va.dtb(null,this.gGa,"-1");ra["-1"]=Va.b1a(Va.Era(Va.T_b(null,Qb)),Sc);mb[Sc]=ra["-1"];this.UDb(mb);Cf.c(this.KQa,ra,!1)}};wa.prototype.M6h=function(){var Q=Eh.a(this.$);return Q?Q.Hn.wo===Se.a.Slc:!1};wa.prototype.Kwd=function(Q,ra,mb){Number.parseInvariant(mb);"-1"===mb&&Ud.a.contains(ra.ParentMenuId,"FormatAsTable",!0)||this.bxf(ra,mb,Q,!1)};wa.prototype.bxf=function(Q,ra,mb,Qb){var Sc=Va.dtb(null,this.gGa,ra);Va.K8e(Q)?(Sc in this.ela?mb=this.ela[Sc]:
(mb=Va.Era(Va.T_b(this.Nad(ra),mb)),this.ela[Sc]=mb),Q[ug.a.GalleryButtonProps]=Object.assign(new ki.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Sc,Alt:Q[ug.a.Alt],MenuItemId:ra,TableCellStyles:mb,TableStyles:this.wIi})):(Q[Hg.a.Icon]=Sc,Q[ug.a.GalleryButtonProps]=Object.assign(new Mg.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Sc,Alt:Q[ug.a.Alt],MenuItemId:ra}),Qb||(Qb=[],this.Nad(ra),"-1"===ra||Ud.a.contains(Q.ParentMenuId,"FormatAsTable",!0)||(Qb=Va.T_b(this.EK.TableStyleItems[Number.parseInvariant(ra)],
mb)),this.KQa[ra]=Va.b1a(Va.Era(Qb),Sc)))};wa.prototype.UDb=function(Q){var ra=this;if(this.Pwb)this.$oc=function(){ra.UDb(Q)};else{this.$oc=null;var mb=[],Qb;for(Qb in Q){var Sc=Qb;Sc in this.VDb?mb.push(Sc):this.VDb[Sc]=!0}try{0<mb.length&&appChrome.api.unregisterIcons(mb),mh.a.isEmpty(Q)||appChrome.api.registerIconProvider(function(){return Q})}catch(Ad){}}};wa.prototype.Nad=function(Q){Q=Number.parseInvariant(Q);if(-1===Q||!this.EK)return null;if(60<Q)for(var ra=60;ra<this.EK.TableStyleItems.length;++ra){var mb=
this.EK.TableStyleItems[ra];if(mb.Index===Q)return mb}return this.EK.TableStyleItems[Q]};wa.prototype.htf=function(){var Q=this;this.Pwb&&(this.Pwb=!1,this.$oc&&this.$oc(),Hc.a.instance.create(function(){Q.D1a("galleryMenuClosed")},1E3,ed.a.UXf,!0,!0))};Object(Le.a)(wa,"TableStyleManager",uf.a,[617,7]);var we=Kf.a;Cm(Wa,we);Wa.prototype.create=function(){var Q=this,ra=ng.GetServiceTaskFactory.create(this.$.ea,102,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.RibbonControls.IRibbonControlsManager"),
mb=ng.GetServiceTaskFactory.Xa(this.$.ea,66,134,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager");eg.TaskExtensions.Da(hf.Task.WAA(ra,mb),function(){Q.Jb(Q.tableStyleManager||(Q.tableStyleManager=new wa(Q.$,ra.result,mb.result)))},this.$.ma,8)};Object(Le.a)(Wa,"TableStyleManagerFactory",Kf.a,[]);var Be=b(800),We=b(55);Object(Le.a)(La,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[115]);Object(Le.a)(Gc,"MacroRecorderRangeItemFilteredPayload",null,[115]);var bg=b(1045),Ff=b(365),
Ng=b(160),Sg=b(172),vg=b(273);Object(Le.a)(nc,"MacroRecorderTableStyleAppliedPayload",null,[115]);Cm(Bb,nc);Object(Le.a)(Bb,"MacroRecorderRangeFormatedAsTablePayload",nc,[]);Object(Le.a)(Tb,"MacroRecorderTableRenamedPayload",null,[115]);Object(Le.a)(cb,"MacroRecorderTableResizedPayload",null,[115]);Object(Le.a)(Ga,"MacroRecorderTableStyleOptionToggledPayload",null,[115]);Object(Le.a)(ic,"MacroRecorderTableConvertedToRangePayload",null,[115]);sc.prototype.TK=function(){Uc.ULS.sendTraceTag(554997633,
0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.Cf.Ji.Gc);if(this.IAa&&!aa.a(this.IAa)){this.Cf.twb=this.IAa.Result;if(this.Cf.twb)return this.hTd=Yh.a.Ad(3,2,0,710,0,-66108047,"ConvertToRange"),this.ej=bh.a(this.Cf.$).ki(this.hTd).G(),this.ej.isCompleted||(this._state=2,this.ej.LM(Object(gd.a)(this,this.moveNext,"moveNext"))),this.Mxc;this.Cf.Mte();return this.Kcb}return this.v0};sc.prototype.v0=function(){this.Cf.Ji.stop();Uc.ULS.sendTraceTag(554997603,
0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Cf.Ji.Gc);this._state=3};sc.prototype.Kcb=function(){return this.v0};sc.prototype.Mxc=function(){this.iTd=this.ej.Ky();Uc.ULS.sendTraceTag(554997632,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.Cf.Ji.Gc);this.iTd||this.Cf.Lte();return this.Kcb};sc.prototype.dispose=function(){};sc.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.lu=
this.lu()}catch(Q){this.dispose(),this._state=3}};Object(Le.a)(sc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[7]);var vh=b(854);tc.prototype.G7a=function(){var Q=this;this.Ji.start();var ra=this.$.ra.xa.dc();return ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?vh.g(this.$.ra.xa,this.sharedSheetRange,function(mb){Q.showDialog(mb)},null,null,null,ra):vh.g(this.$.ra.xa,
this.sharedSheetRange,function(mb){Q.Cfj(mb)},null,null,null,ra)};tc.prototype.showDialog=function(Q){var ra=this;Uc.ULS.sendTraceTag(41714579,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.Ji.Gc);Q&&!aa.a(Q)&&((this.twb=Q.Result)?(Q=Yh.a.Ad(3,2,0,710,0,-66108047,"ConvertToRange"),eg.TaskExtensions.Da(bh.a(this.$).ki(Q),function(mb){Uc.ULS.sendTraceTag(41714580,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",
ra.Ji.Gc);mb.result||ra.Lte()},this.$.ma,11)):this.Mte());this.Ji.stop();Uc.ULS.sendTraceTag(41714581,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.Ji.Gc)};tc.prototype.Cfj=function(Q){new sc(this,Q)};tc.prototype.Vle=function(){var Q={};Q.IsQueryTable=this.twb;Q.Range=this.sharedSheetRange;return Q};tc.prototype.Lte=function(){var Q=this,ra=this.$.ra.xa;Uc.ULS.sendTraceTag(41461400,0,50,"Convert To Range initiated for Query Table");this.M2e(194,
function(mb,Qb,Sc){return vh.d(ra,Q.Vle(),mb,Qb,Sc,null)});Uc.ULS.sendTraceTag(41461401,0,50,"Convert To Range completed for Query Table")};tc.prototype.Mte=function(){var Q=this,ra=this.$.ra.xa;Uc.ULS.sendTraceTag(41461402,0,50,"Convert To Range initiated for Normal Table");this.M2e(193,function(mb,Qb,Sc){return vh.c(ra,Q.Vle(),mb,Qb,Sc,null)},function(){return new ic(Q.tableName)});Uc.ULS.sendTraceTag(41461403,0,50,"Convert To Range completed for Normal Table")};tc.prototype.M2e=function(Q,ra,mb){mb=
void 0===mb?null:mb;Ff.a(this.$.userOperationManager,ra,function(Qb){return new Ng.a(Q,0,Qb,void 0,mb)},null)};Object(Le.a)(tc,"ConvertToRangeManager",null,[]);var Ag=b(1203),Aa=b(1202),pa=b(1238),ub=pa.a;Cm(Oc,ub);Oc.prototype.Yl=function(){var Q=this,ra=gg.s(this.TB.TableRange);return function(){return new Bb(ra,Q.c2a.checked,Q.Aza,!0)}};Oc.prototype.Ww=function(){var Q=this,ra=gg.s(this.TB.TableRange);return function(mb,Qb,Sc){return vh.f(Q.$.ra.xa,ra,Q.c2a.checked,!1,Q.TB.HasTotalRow,Q.Aza,mb,
Qb,Sc,null)}};Oc.prototype.Mx=function(Q,ra,mb){ub.prototype.Mx.call(this,Q,ra,mb)};Jl.Object.defineProperties(Oc.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Aw:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Le.a)(Oc,"FormatAsTableDialogDeprecated",pa.a,[]);var xd=b(1070),oe=xd.a;Cm(td,oe);td.prototype.Yl=function(){var Q=this,ra=gg.s(this.TB.TableRange);return function(){return new Bb(ra,Q.hasHeaders,Q.Aza,!0)}};td.prototype.Ww=function(){var Q=
this,ra=gg.s(this.TB.TableRange),mb=this.TB.HasTotalRow;return function(Qb,Sc,Ad){return vh.f(Q.$.ra.xa,ra,Q.hasHeaders,!1,mb,Q.Aza,Qb,Sc,Ad,null)}};Jl.Object.defineProperties(td.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Aw:{configurable:!0,enumerable:!0,get:function(){return 215}},$n:{configurable:!0,enumerable:!0,get:function(){return Tc.a.instance.da(704)}}});Object(Le.a)(td,"FormatAsTableReactDialog",xd.a,[]);var sf=b(522),ef=b(91),fh=sf.a;Cm(kc,
fh);kc.prototype.Mnj=function(Q,ra){1===Q&&this.Vrj(gg.D(this.Gvf(ra[kc.vMi])))};kc.prototype.Gvf=function(Q){Q=Q.startsWith("=")?Q.substring(1,Q.length):Q;var ra=gg.Y(Q,this.$.Aa);Q=ra.sheetName;var mb=ra.range;return ra.returnValue&&mb?(mb=gg.v(mb,this.$),mb.SheetName=Ud.a.equals(Q,"",!0)?this.$.sa.name:Q,mb):null};kc.prototype.J3=function(Q){var ra={};return ra.id="ResizeTableDialog",ra.range=Q,ra.getInputErrorIfInvalid=Object(gd.a)(this,this.ysb,"getInputErrorIfInvalid"),ra};kc.prototype.Z9c=
function(Q){Q=this.Gvf(Q);if(!Q)return 1;var ra=gg.D(Q);return Ud.a.equals(Q.SheetName,this.$.sa.sheetName,!0)&&this.Njc.top===ra.top&&this.Njc.oe(ra)?0:2};kc.prototype.ysb=function(Q){Q=this.Z9c(Q);return this.x7c(Q)};kc.prototype.x7c=function(Q){var ra="";switch(Q){case 1:ra=Tc.a.instance.da(72);break;case 2:ra=ef.a.Lq(Tc.a.instance.da(71))}return ra};kc.prototype.Vrj=function(Q){var ra={};Q=(ra.ResizeTableRange=Q,ra.OriginalTableRange=this.Njc,ra);this.$.Re(-1400250766,zg.a.Yb,8,Q)};Jl.Object.defineProperties(kc.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});kc.C2a="id";kc.vMi="range";Object(Le.a)(kc,"ResizeTableDialog",sf.a,[]);var jh=b(910),oh=b(911),Ph=b(133),Zg=b(64);vb.prototype.$c=function(Q,ra){switch(ra){case -544558380:return!(this.tableManager&&this.ya.cQ()&&!this.k3a()&&mc.d(this.tableManager.Nj));case 1544516694:return!(this.tableManager&&(this.ya.cQ()?!this.k3a():this.ya.cKa()));case -697806646:case 323142015:return!this.ya.cQ();case 341449783:case 2128797448:return!(this.tableManager&&
this.tableManager.skd(this.ya.activeCell));case -123538519:return!(this.ya.cQ()&&this.tableStyleManager&&this.tableStyleManager.ukd());case 756677940:return!(ee.EwaSettings.ka(427)&&this.oZh());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.pZh());case 844144422:return!this.ya.cQ()}return!1};vb.prototype.executeCommand=function(Q,ra,mb){var Qb=this;Q=eg.TaskExtensions.um();var Sc=this.$.ra.xa,Ad=null,ye=1,Ze=ra.command,sd=this.$.ra.xa.dc(),pe=null;switch(Ze){case -2058042992:var Ve=
We.a.gi(mb[zg.a.Mj]);vb.iNf(this.$,Ve);Ad=function(wg,qj,Qh){return vh.a(Sc,Ve,null,null,!1,!1,!1,jh.a.eua(Ph.a.JEa,oh.a.clearAutoFilter,wg),qj,Qh,null)};ye=176;pe=function(){return new Gc(Ve)};break;case 504133448:case -798968736:case 477776686:var Li=We.a.gi(mb[zg.a.Mj]),Jf=mb.TopCellAddress;vb.iNf(this.$,Li);var ui=504133448===ra.command?1:-798968736===ra.command?2:3;if(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&Jf&&this.$.isEditMode&&(mb=this.tableManager.fo(Jf),
!this.$.qt([mb],!0,1)))break;Ad=function(wg,qj,Qh){return Gh.hb(Sc,Li,ui,vg.b(wg,Object(gd.a)(Qb,Qb.dAi,"onTableSortSuccessCallback")),qj,Qh,Jf,sd)};ye=177;pe=function(){return new La(Li,ui)};break;case 341449783:case 2128797448:this.YOa=341449783===Ze?0:2;mb=this.toggleTableStyleOption(Sc,sd);Ad=mb.F5f;ye=mb.operationName;pe=mb.Yl;break;case -712419744:this.Yv?this.x2e(mb[Se.a.event]):this.x2e(null);break;case 1868184698:ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",
!1)?new Aa.a(this.$):(mb=new Ag.a(this.$),mb.initialize(),mb.Bf());break;case 844144422:new kc(this.$);break;case 1544516694:case -544558380:mb=mb[zg.a.Vd];Ud.a.na(mb)||(this.YOa=this.YIh(mb),-1!==this.YOa&&(mb=this.toggleTableStyleOption(Sc,sd),Ad=mb.F5f,ye=mb.operationName,pe=mb.Yl));break;case 756677940:if(this.k3a()&&this.h7e()){Uc.ULS.sendTraceTag(594130064,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}var bj=mb.Text,ji=this.TBh();if(ji){Ad=function(wg,qj,Qh){return vh.h(Sc,bj,ji,vg.b(wg,Object(gd.a)(Qb,Qb.cAi,"onTableRenameSuccessful")),vg.a(qj,Object(gd.a)(Qb,Qb.bAi,"onTableRenameFailure")),Qh,sd)};ye=217;var Ei=null;this.tableManager.Nj?Ei=this.tableManager.Nj.name:this.tableManager.Rxd?Ei=this.tableManager.Rxd.name:Uc.ULS.sendTraceTag(594130063,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");
Ei&&(pe=function(){return new Tb(Ei,bj)})}else return Uc.ULS.sendTraceTag(50679901,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),hf.Task.Ua(!1);break;case 323142015:if(this.k3a())break;return(new tc(this.$,this.xNe(),this.tableManager.Nj.name)).G7a();case -1400250766:ye=211;Ad=this.gZi(mb,Sc,sd);var mi=gg.m(mb.OriginalTableRange,this.$.Aa.sa);pe=function(){return new cb(mi)};break;case 1872288872:this.tableManager.dLi();break;case -123538519:var Zh=this.XIh(mb);mb=Ud.a.contains(mb[zg.a.Vd],
Se.a.VCb,!0)||Ud.a.contains(mb[Se.a.PH],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";Uc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",mb,Zh.toString());var gi=this.lUe();gi&&(Ad=function(wg,qj,Qh){return vh.b(Sc,gi,Zh,wg,qj,Qh,null,sd)},pe=function(){return new nc(gi,Zh)},ye=212);break;case 753331043:mb=mb[zg.a.Vd];if(Ud.a.na(mb))break;var gf=Number.parseInvariant(mb);if(this.ya.cQ()){if(Uc.ULS.sendTraceTag(51181321,
0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",gf),sheetMultiRange=this.lUe())Ad=function(wg,qj,Qh){return vh.f(Sc,sheetMultiRange,!1,!1,!1,gf,wg,qj,Qh,null,sd)},pe=function(){return new Bb(sheetMultiRange,!1,gf,!1)},ye=215}else Uc.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",gf),ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new td(this.$,Number.parseInvariant(mb)):
(mb=new Oc(this.$,Number.parseInvariant(mb)),mb.initialize(),mb.Bf());break;case 71074531:var vj=mb.HasHeader,ej=mb.TableRange;Ad=function(wg,qj,Qh){return vh.e(Sc,ej,vj,!1,!1,wg,qj,Qh,null)};pe=function(){return new bg.a(vj,ej)};ye=206;break;default:return Sg.a(Ze)}if(Ad){var Ti=function(wg){return new Ng.a(ye,0,wg,void 0,pe)};if(!this.namedSheetViewPublic||-2058042992!==Ze&&504133448!==Ze&&-798968736!==Ze&&477776686!==Ze)Q=Ff.a(this.$.userOperationManager,Ad,Ti,ra);else{var oj=this;Q=this.namedSheetViewPublic.bQa().continueWith(function(wg){wg.result&&
Ff.a(oj.$.userOperationManager,Ad,Ti,ra)})}}return Q};vb.prototype.toggleTableStyleOption=function(Q,ra){var mb=this,Qb=this.ya.cKa();Uc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Qb?"PivotTable":"table",this.YOa);var Sc=this.xNe();return{F5f:function(Ad,ye,Ze){return vh.j(Q,Sc,mb.YOa,vg.b(Ad,Object(gd.a)(mb,mb.GAi,"onToggleTableStyleOptionSuccessful")),ye,Ze,null,ra)},operationName:196,Yl:function(){return new Ga(Sc,mb.YOa,Qb)}}};vb.prototype.gZi=
function(Q,ra,mb){function Qb(sd){sd.Errors&&Ad.tableManager.SXf(ye)}function Sc(){Ad.tableManager.SXf(ye)}var Ad=this,ye=Q.OriginalTableRange,Ze=gg.m(Q.ResizeTableRange,this.$.Aa.sa);return function(sd,pe,Ve){return vh.i(ra,Ze,vg.b(sd,Qb),vg.a(pe,Sc),Ve,null,mb)}};vb.prototype.XIh=function(Q){var ra=-1;Ud.a.na(Q[zg.a.Vd])||(ra=Q[zg.a.Vd],ra=Ud.a.contains(ra,Se.a.VCb,!0)?this.tableStyleManager.xsb(ra):Number.parseInvariant(Q[zg.a.Vd]));return ra};vb.prototype.Jc=function(Q,ra){Q=!1;switch(ra.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:Q=
!0;break;case 756677940:Q=ee.EwaSettings.ka(427)}return Q};vb.prototype.gd=function(Q,ra,mb){Q=!1;switch(ra){case "PopulateTableMoreStylesMenu":this.menuId=mb.MenuId;this.tableStyleManager.ukd()||this.tableStyleManager.D1a("formatAsTableMenu");Q=this.tableStyleManager.Zwf(ra,mb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=mb.MenuId,this.tableStyleManager.ukd()||this.tableStyleManager.D1a("accessibilityTab"),Q=this.tableStyleManager.Zwf(ra,mb)}return Q};vb.prototype.dispose=function(){this.tableStyleManager.eVi(Object(gd.a)(this,
this.itf,"onTableStylesDataLoadSuccess"))};vb.prototype.itf=function(){this.dca()};vb.prototype.dca=function(){(Ud.a.contains(this.menuId,"Format",!0)||Ud.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.yw(this.menuId)};vb.prototype.xNe=function(){return gg.v(this.ya.activeCell,this.$)};vb.prototype.TBh=function(){var Q=this.tableManager.Cld;return Q?gg.v(Q,this.$):null};vb.prototype.x2e=function(Q){if(this.tableManager){var ra=df.g(this.$),mb=this.ya.activeCell,Qb=this.tableManager.fo(mb),
Sc=null;if(!Qb||Qb.oQa)for(ra=Ml(ra.o2),Qb=ra.next();!Qb.done;Qb=ra.next()){Qb=Ml(Qb.value);for(var Ad=Qb.next();!Ad.done;Ad=Qb.next()){Ad=Ad.value;var ye=Ad.ho;mb.left>=ye[0]&&mb.left<=ye[ye.length-1]&&(Sc=(Ad=Ad.zs(mb).qJ())?cf.DOMElementExtensions.uj(Ad,xf.a.Kge):null)}}else{var Ze=ra.Cc(Pf.Range.xd(Qb.top,mb.left));if(this.Yv){Hc.a.instance.create(function(){Ze.invoke(8,Q)},0,ed.a.JXf,!0,!0);return}Sc=Ze.EIa(56).T2a}Sc&&Hc.a.instance.create(function(){cf.DOMElementExtensions.ivb(Sc,null)},0,ed.a.JXf,
!0,!0)}};vb.prototype.YIh=function(Q){Q=Number.parseInvariant(Q);return-1<Q&&8>=Q?Q:-1};vb.prototype.GAi=function(Q){if(!(this.ya.cKa()||(!ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||aa.a(Q)||this.k3a())&&aa.a(Q)&&this.k3a())){Q=this.ya.activeCell;var ra=this.ya.activeRange,mb=this.tableManager.Nj.usedRange;2===this.YOa&&mc.g(this.tableManager.Nj)&&Q.bottom===mb.bottom&&(ra=ra.Haa?new Pf.Range(ra.top-1,ra.left,ra.bottom-1,ra.right,!1,!0):new Pf.Range(ra.top,
ra.left,ra.bottom-1,ra.right,!1,!0),Q=ra.contains(Q)?Q:Pf.Range.xd(ra.bottom,Q.left),df.g(this.$).ga.updateSelection(ra,Q,0,3))}};vb.prototype.cAi=function(Q){aa.a(Q)?(Uc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.If()):Uc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};vb.prototype.bAi=function(){Uc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");
this.$.If()};vb.prototype.k3a=function(){return!this.tableManager.Nj};vb.prototype.h7e=function(){return this.tableManager.Rxd?!1:(Uc.ULS.sendTraceTag(594130059,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};vb.prototype.pZh=function(){var Q=this.ya.cQ(),ra=this.ya.Eh&&!df.g(this.$).kc.c4a(this.ya.Xd);return Q||ra};vb.prototype.oZh=function(){return this.ya.cQ()||!this.h7e()};vb.prototype.$Ih=function(Q){var ra=[];Q=Ml(Q);for(var mb=Q.next();!mb.done;mb=
Q.next())if((mb=Sb.b(this.$,mb.value))&&mb.length){mb=Ml(mb);for(var Qb=mb.next();!Qb.done;Qb=mb.next())Qb=Qb.value,Qb.usedRange&&!Array.contains(ra,Qb.usedRange)&&Array.add(ra,Qb.usedRange)}return ra};vb.prototype.lUe=function(){var Q=this.ya.selectedRanges,ra=[];if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ra=this.$Ih(Q);else{Q=Ml(Q);for(var mb=Q.next();!mb.done;mb=Q.next())mb=mb.value,df.g(this.$).kc.c4a(mb)&&Array.add(ra,mb)}return ra&&
ra.length?gg.r(ra,this.$):null};vb.prototype.dAi=function(Q,ra){ra&&this.uR(ra);aa.b(Q,-569193796)&&(Zg.a(this.$).ld.AO(-569193796),this.x$h(Q.Errors[0]))};vb.prototype.uR=function(Q){ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(this.$.ea,430,431,1,"Microsoft.Office.Excel.WebUI.Client.PivotTableHandRaise.IPivotTableHandRaiseManager"),function(ra){ra.result.gRa(Q);Uc.ULS.sendTraceTag(541131085,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},
this.$.ma,3)};vb.prototype.x$h=function(Q){var ra=this;eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(this.$.ea,446,447,0,"Microsoft.Office.Excel.WebUI.Client.Sort.ISortUtil"),function(mb){mb.result.QXg(ra.$,Q)},this.$.ma,3)};vb.iNf=function(Q,ra){ra.SheetName=Q.sa.name;ra.NamedObjectView=Q.fa.isNamedObjectViewMode};Object(Le.a)(vb,"TableCommandHandler",null,[159]);var ig=Be.a;Cm(Ab,ig);Ab.prototype.dispose=function(){ig.prototype.dispose.call(this)};Ab.prototype.Rd=function(){var Q=this,ra=ng.GetServiceTaskFactory.create(this.$.ea,
134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),mb=ng.GetServiceTaskFactory.create(this.$.ea,330,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.Tables.ITableStyleManager"),Qb=ng.GetServiceTaskFactory.Xa(this.$.ea,309,310,this.vb,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewPublic");eg.TaskExtensions.Da(hf.Task.WAA(ra,Qb,mb),function(){Q.Hd([new vb(Q.$,ra.result,Qb.result,mb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,
756677940])},this.$.ma,3)};Ab.la=function(Q){Be.a.ie(86,new Ab(Q))};Object(Le.a)(Ab,"TableCommandHandlerFactory",Be.a,[]);zc.prototype.$c=function(){return!1};zc.prototype.executeCommand=function(Q,ra){Q=ra.command;ra=null;switch(Q){case 1243860697:this.P5g.rqj();break;default:ra=Sg.a(Q)}return ra||hf.Task.Ua(!0)};zc.prototype.Jc=function(Q,ra){return 1243860697===ra.command};zc.prototype.gd=function(){return!1};Object(Le.a)(zc,"SheetDropdownMenuCommandHandler",null,[159]);var Sh=Be.a;Cm(ec,Sh);ec.prototype.Rd=
function(){var Q=this;this.$.HG(function(ra){ra.Ned().then(function(){eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(Q.$.ea,32,33,Q.vb,"Microsoft.Office.Excel.WebUI.Client.SheetTabBar.ISheetTabBarControl"),function(mb){Q.Hd([new zc(mb.result.ybj)])},Q.$.ma)})})};ec.la=function(Q){Be.a.ie(392,new ec(Q))};Object(Le.a)(ec,"SheetDropdownMenuCommandHandlerFactory",Be.a,[]);var Ch=b(72),mf=b(43),Sd=b(197),Gf=b(40),Wf=b(32);Za.prototype.Lxg=function(Q,ra){this.yze.add(Q,ra);this.GW()};Za.prototype.GW=
function(){var Q=this;this.NBc=0;Wf.a.forEach(this.yze.Lu,function(ra){Q.NBc=Q.W0c|ra.value})};Jl.Object.defineProperties(Za.prototype,{W0c:{configurable:!0,enumerable:!0,get:function(){return this.NBc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.W0c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.W0c&2)}}});Object(Le.a)(Za,"SheetTabBarDisabledStateManager",null,[]);fb.heh="ewa-stb-uir";fb.rFe="ewa-stb-drag";fb.Sdh=
"ewa-stb-navarea";fb.Tdh="ewa-stb-navarea-dimensions";fb.Vdh="ewa-stb-navbutton";fb.pY="cui-disabled";fb.eha="cui-img-container";fb.Udh="ewa-stb-navareaextra";fb.Pdh="ewa-stb-contentarea";fb.sFe="ewa-stb-left-scrollable";fb.DFe="ewa-stb-right-scrollable";fb.feh="ewa-stb-tabarea";fb.eeh="ewa-stb-sheettabmoveindicator";fb.FFe="ewa-stb-tabs";fb.rnj="tab-active";fb.ynj="tab-inactive";fb.xnj="tab-hover";fb.geh="ewa-stb-tabs-ghost";fb.tnj="tab-anchor-text";fb.dark="dark";fb.light="light";fb.snj="tab-active-text";
fb.vnj="tab-content-container";fb.Anj="tab-text";fb.Ydh="ewa-stb-nsv-inactive";fb.Zdh="ewa-stb-nsv-inactive-svg";fb.Wdh="ewa-stb-nsv-active";fb.Xdh="ewa-stb-nsv-active-svg";fb.cdh="ewa_nsv_margin";fb.Qdh="ewa-stb-disable-scrollbar";fb.J$h="leave-size-fixed-on-tab-hover-old";fb.I$h="leave-size-fixed-on-tab-hover";fb.wFe="ewa-stb-locked-sheet";fb.xFe="ewa-stb-locked-sheet-svg";fb.Rdh="ewa-stb-dropdown-menu-button";fb.k$g="ewa-active-sheet-menu-item";Object(Le.a)(fb,"CssClassNames",null,[]);var f=b(520),
rb=b(18),oc=b(254),cd=b(96),$d=b(519),ze=b(279),He=b(461),Ie=b(95),Me=b(336),rg=b(258),pf=b(367),$g=b(363),Df=b(276),Vf=b(90),og=ch.a;Cm(E,og);E.prototype.dispose=function(){this.V7a=this.$qa=this.$=null;og.prototype.dispose.call(this)};E.prototype.AW=function(Q){this.cX=Q;this.domElement.setAttribute(Se.a.Iqa,Q.toString());cf.DOMElementExtensions.toggleCssClass(this.domElement,f.a.pY,Q)};Jl.Object.defineProperties(E.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.cX}}});
Object(Le.a)(E,"SheetBarButton",ch.a,[]);var h=b(818);Cm(ia,E);ia.prototype.dispose=function(){Df.a.instance.Ca(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));nf.KeyInputManager.instance.jv(this.domElement,this.jxb);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&df.g(this.$)&&df.g(this.$).zc&&(df.g(this.$).zc.mm(Object(gd.a)(this,this.tk,"onEditStarted")),df.g(this.$).zc.Qs(Object(gd.a)(this,this.Zk,"onEditEnded")));E.prototype.dispose.call(this)};
ia.prototype.AW=function(Q){var ra=ia.IRf(this.$);E.prototype.AW.call(this,Q||ra)};ia.prototype.Yc=function(Q){this.disabled||this.$.Re(-1935155518,Q.Cb,30,null);return!0};ia.prototype.YAb=function(Q){Q="mouseover"===Q.type||"focus"===Q.type;var ra=pf.a(this.$)?this.V7a:this.$qa;hd.HelperMethods.kOd(ra,this.wga,this.wga+Se.a.P$b,Q&&!df.g(this.$).inRangePicker)};ia.prototype.tk=function(){this.AW(!0)};ia.prototype.Zk=function(){this.AW(!1)};ia.IRf=function(Q){return!Q.isEditMode||!Q.Aa.count};Object(Le.a)(ia,
"InsertSheetButton",E,[]);Cm(Kb,E);Kb.prototype.dispose=function(){Df.a.instance.Ca(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));nf.KeyInputManager.instance.jv(this.domElement,this.jxb);this.Bme=null;E.prototype.dispose.call(this)};Kb.prototype.Yc=function(Q){this.$.Re(-684145703,Q.Cb,0,null);return!0};Kb.prototype.YAb=function(Q){hd.HelperMethods.kOd(this.Bme,this.wga,this.wga+Se.a.P$b,("mouseover"===Q.type||"focus"===Q.type)&&!df.g(this.$).inRangePicker)};Object(Le.a)(Kb,"InsertTemplateButton",
E,[]);Ua.prototype.getSheetName=function(){return this.sheetName};Object(Le.a)(Ua,"MacroRecorderSheetReorderedPayload",null,[115]);var e=ch.a;Cm(va,e);va.prototype.dispose=function(){this.sm();e.prototype.dispose.call(this)};va.prototype.rqj=function(){this.FGf(!0,"TogglerSheetDropdownMenu")};va.prototype.FGf=function(Q,ra){Uc.ULS.sendTraceTag(588310285,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",ra,Q,this.GJb);Q&&(this.GJb+=1);var mb=
this.$.Zb.Ic("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",ra,Q,this.GJb,this.$.Aa.count));Q=this.FXg();appChrome.renderSheetDropdownMenu(this.domElement,this.Xnj,Q,this.GJb,Object(gd.a)(this,this.Yqi,"onDropdownMenuShow"),Object(gd.a)(this,this.Xqi,"onDropdownMenuDismiss"),function(){mb.stop()},pf.a(this.$))};va.prototype.FXg=function(){for(var Q=this.$.Aa,ra=[],mb=0;mb<Q.count;mb++){var Qb=Object(Ye.a)(Ie.a,
Q.getItem(mb));Qb.ay||(Qb=this.EXg(Qb),ra.push(Qb))}return ra};va.prototype.EXg=function(Q){var ra={};ra.key=Q.name;ra.text=Q.name;ra.onClick=this.GXg(Q);Q.active&&(ra.className=pf.a(this.$)?"ewa-active-sheet-menu-item-present-mode":fb.k$g);return ra};va.prototype.GXg=function(Q){var ra=this;return function(){var mb=new fd.a(-1876836819,0,ra.$.jd,30,null),Qb={};ra.$.Na.Xb(mb,(Qb.SNTA=Q.name,Qb))}};va.prototype.OQ=function(){Uc.ULS.sendTraceTag(588310284,0,50,"SheetDropdownMenu.OnSheetsChanges");this.FGf(!1,
"OnSheetsChanged")};va.prototype.Xj=function(){if(!this.Ssa){var Q=this.$.Aa;Q.Vf(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.oVb(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.MX(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.Sfa(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.gEa(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.hfe(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.kWa(Object(gd.a)(this,this.OQ,"onSheetsChanged"));this.Ssa=!0}};va.prototype.sm=function(){if(this.Ssa){var Q=this.$.Aa;
Q.wg(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.Wmc(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.h6(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.ula(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.lOa(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.CFf(Object(gd.a)(this,this.OQ,"onSheetsChanged"));Q.AEb(Object(gd.a)(this,this.OQ,"onSheetsChanged"));this.Ssa=!1}};va.prototype.Yqi=function(){this.Xj()};va.prototype.Xqi=function(){this.sm()};Object(Le.a)(va,"SheetDropdownMenu",ch.a,[638,7]);
var I=b(346);Cm(Ia,E);Ia.prototype.dispose=function(){this.Auj();E.prototype.dispose.call(this)};Ia.prototype.AW=function(Q){E.prototype.AW.call(this,Q||!this.$.fa.oKa)};Ia.prototype.BZf=function(Q){this.disabled||(Uc.ULS.sendTraceTag(588310283,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",I.a[Q]),this.$.Na.Xb(new fd.a(1243860697,Q,this.$.jd,30,null)))};Ia.prototype.Rh=function(){this.AW(!1);this.$.fa.Sr(Object(gd.a)(this,this.Rh,"onCommandUIGeneratedAndGridInteractive"))};Ia.prototype.QPi=
function(){Df.a.instance.qa(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));nf.KeyInputManager.instance.qa(Kc.a.Rb,this.domElement,Object(gd.a)(this,this.onKeyDown,"onKeyDown"))};Ia.prototype.Auj=function(){Df.a.instance.Ca(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));nf.KeyInputManager.instance.Ca(Kc.a.Rb,this.domElement,Object(gd.a)(this,this.onKeyDown,"onKeyDown"))};Ia.prototype.Yc=function(Q){this.BZf(Q.Cb);return!0};Ia.prototype.onKeyDown=function(Q){return 13===
Q.Ga.keyCode||32===Q.Ga.keyCode?(this.BZf(Q.Cb),!0):!1};Object(Le.a)(Ia,"SheetDropdownMenuAnchor",E,[]);var Z=b(183),Ca=b(135),Na=b(57),Vb=b(212),vc=b(158);za.prototype.KJ=function(){return this.sheet.active};za.prototype.Shd=function(){return this.sheet.isLockPausedInSession};za.prototype.nra=function(){return this.im?rb.a.vFe:this.KJ()?rb.a.uFe:rb.a.tFe};za.prototype.Jma=function(){return this.sheet.vj?h.a.xzf:h.a.muj};za.prototype.RMd=function(){return 13};za.prototype.TMd=function(){return 12};
za.prototype.Gga=function(){return null};za.prototype.ora=function(){return this.im?this.$v?fb.xFe:fb.wFe:null};za.prototype.sOd=function(){return null};za.prototype.xw=function(){return null};za.prototype.ged=function(){return 0};za.prototype.HQc=function(){return!0};Object(Le.a)(za,"LockPausedSheetIconDataSource",null,[642]);qb.prototype.KJ=function(){return this.sheet.active};qb.prototype.Shd=function(){return this.sheet.vj};qb.prototype.nra=function(){return this.im?rb.a.vFe:this.KJ()?rb.a.uFe:
rb.a.tFe};qb.prototype.Jma=function(){return h.a.xzf};qb.prototype.RMd=function(){return 13};qb.prototype.TMd=function(){return 12};qb.prototype.Gga=function(){return null};qb.prototype.ora=function(){return this.im?this.$v?fb.xFe:fb.wFe:null};qb.prototype.sOd=function(){return null};qb.prototype.xw=function(){return null};qb.prototype.ged=function(){return 0};qb.prototype.HQc=function(){return!0};Object(Le.a)(qb,"LockedSheetIconDataSource",null,[642]);Ta.prototype.KJ=function(){return this.sheet.active};
Ta.prototype.Shd=function(){return this.sheet.kf.jQ};Ta.prototype.Gga=function(){return this.$v?this.KJ()?fb.Xdh:fb.Zdh:this.KJ()?fb.Wdh:fb.Ydh};Ta.prototype.nra=function(){return!this.KJ()&&this.GSf()?rb.a.Ofh:rb.a.Nfh};Ta.prototype.Jma=function(){return!this.KJ()&&this.GSf()?h.a.Kbj:h.a.Jbj};Ta.prototype.RMd=function(){return 14};Ta.prototype.TMd=function(){return 16};Ta.prototype.ora=function(){return fb.cdh};Ta.prototype.sOd=function(){return this.sheet.kf.Ojb};Ta.prototype.xw=function(){return this.Gqj};
Ta.prototype.ged=function(){return 8};Ta.prototype.HQc=function(){return!1};Object(Le.a)(Ta,"NamedSeetViewSheetIconDataSource",null,[642]);db.prototype.K2f=function(){if(this.QH&&(this.Sj||this.xza)){if(this.$v){var Q=this.dataSource.Jma();this.Jma!==Q&&(this.xza&&this.xza.parentNode.removeChild(this.xza),this.R1e(),this.Jma=Q)}else Q=this.dataSource.nra(),this.nra!==Q&&(this.PCd(this.Sj,this.nra,Q),this.nra=Q);Q=this.dataSource.Gga();this.Gga!==Q&&(this.$v?this.BWi(this.xza,this.Gga,Q):this.PCd(this.Sj,
this.Gga,Q),this.Gga=Q);Q=this.dataSource.ora();this.ora!==Q&&(this.PCd(this.QH,this.ora,Q),this.ora=Q);this.dataSource.xw()&&!this.dataSource.KJ()&&this.clearToolTip()}};db.prototype.egj=function(Q,ra,mb){this.wWh(Q,ra,mb);cf.DOMElementExtensions.setVisible(this.QH,this.dataSource.Shd())};db.prototype.clearToolTip=function(){var Q=this;eg.TaskExtensions.Da(this.myb,function(){dialogControls.clearToolTip(Q.dataSource.xw())},this.$.ma,3)};db.prototype.wWh=function(Q,ra,mb){this.QH&&this.g7e!==Q&&(this.QH.parentNode.removeChild(this.QH),
this.ora=this.Gga=this.Jma=this.nra=this.ALc=null,this.dataSource.xw()&&(this.tc.detach("mouseover",!0),this.tc.detach("mouseout",!0)));this.QH||(this.ALc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.QH,f.a.eha),Sys.UI.DomElement.addCssClass(this.QH,rb.a.MB),ee.EwaSettings.ka(535)?Q===this.dataSource.HQc()?ra.appendChild(this.QH):ra.insertBefore(this.QH,mb):Q?ra.insertBefore(this.QH,mb):ra.appendChild(this.QH),this.$v?this.R1e():(this.Sj=document.createElement("img"),this.Sj.tabIndex=
-1,this.Sj.alt=this.dataSource.altText,this.QH.appendChild(this.Sj),this.Sj.src=qe.a.Ee(this.dataSource.ged())),this.dataSource.xw()&&(this.tc.la("mouseover",Object(gd.a)(this,this.QE,"onMouseOver"),!0),this.tc.la("mouseout",Object(gd.a)(this,this.uH,"onMouseOut"),!0)),this.g7e=Q)};db.prototype.BWi=function(Q,ra,mb){Q&&(Sys.UI.DomElement.removeCssClass(Q,ra),Sys.UI.DomElement.addCssClass(Q,mb))};db.prototype.PCd=function(Q,ra,mb){ra&&Sys.UI.DomElement.removeCssClass(Q,ra);mb&&Sys.UI.DomElement.addCssClass(Q,
mb)};db.prototype.dispose=function(){Dg.a.Ia(this.M0)};db.prototype.QE=function(){var Q=this;this.dataSource.KJ()&&eg.TaskExtensions.Da(this.myb,function(){dialogControls.renderToolTip(Q.dataSource.xw(),"SheetIconTooltip",Q.dataSource.sOd(),Q.QH,10,!1,!1,1)},this.$.ma,3)};db.prototype.uH=function(){this.dataSource.KJ()&&this.clearToolTip()};db.prototype.R1e=function(){var Q=this.$.ea.Ea(388,void 0);Q?(this.xza=Q.fua(this.dataSource.Jma(),this.dataSource.RMd(),this.dataSource.TMd()))?this.QH.appendChild(this.xza):
Uc.ULS.shipAssertTag(590918346,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.Jma()):Uc.ULS.shipAssertTag(590918347,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Jl.Object.defineProperties(db.prototype,{tc:{configurable:!0,enumerable:!0,get:function(){return this.M0||(this.M0=le.a.instance.Kd(this.QH))}},myb:{configurable:!0,enumerable:!0,get:function(){var Q=this;if(this.Toa)return this.Toa;var ra=new Ge.a;this.$.HG(function(mb){eg.TaskExtensions.Da(mb.Umd(),
function(){ra.setResult(!0)},Q.$.ma,3)});return this.Toa=ra.task}},QH:{configurable:!0,enumerable:!0,get:function(){return this.ALc}}});Object(Le.a)(db,"SheetIcon",null,[7]);var md=b(344),Ld=b(147),Jd=Kg.a;Cm(ta,Jd);ta.prototype.dispose=function(){this.pma&&(Df.a.instance.Ca(Kc.a.Dj,this.pma.domElement,Object(gd.a)(this,this.oba,"onDblClick")),md.a.instance.Ca(this.pma.domElement,Object(gd.a)(this,this.Yk,"onContextMenu")),this.v9d=null);this.$=null;Jd.prototype.dispose.call(this)};ta.prototype.onKeyDown=
function(Q){121===Q.keyCode&&Q.shiftKey&&!this.pma.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.pma.anchor),Yg.g(Q))};ta.prototype.oba=function(Q){if(!this.$.isEditMode||this.pma.disabled)return!0;this.rename(!1,Q.Cb);return!0};ta.prototype.Yk=function(Q){return this.pma.disabled?!0:this.showContextMenu(Q.clientPoint,Q.Cb,Q.Wb)};ta.prototype.showContextMenu=function(Q,ra,mb){this.pma.activate(ra,mf.a.qkd());ra=new fd.a(-1075099431,ra,this.$.jd,30,null);var Qb,Sc={};return!Ld.a(Qb=
this.$.Na.Xb(ra,(Sc.ClientPoint=Q,Sc.Sheet=this.pma.sheet,Sc.Target=mb,Sc)))&&(6!==Qb.status||Qb.result)};ta.prototype.rename=function(Q,ra){this.$.Re(817296323,ra,Q?19:0,null)};Jl.Object.defineProperties(ta.prototype,{pma:{configurable:!0,enumerable:!0,get:function(){return this.v9d}}});Object(Le.a)(ta,"SheetOpsSheetClickHelper",Kg.a,[]);Cm(ua,E);ua.prototype.Qzh=function(){return cf.DOMElementExtensions.canReceiveFocus(this.anchor)?this.anchor:null};ua.prototype.dispose=function(){if(this.Ssa){Rc.a.instance.Ca(Kc.a.pointerDown,
this.domElement,Object(gd.a)(this,this.onPointerDown,"onPointerDown"));nf.KeyInputManager.instance.Ca(Kc.a.Rb,this.domElement,Object(gd.a)(this,this.onKeyDown,"onKeyDown"));nf.KeyInputManager.instance.Ca(Kc.a.Qo,this.domElement,Object(gd.a)(this,this.Nx,"onKeyPress"));Df.a.instance.Ca(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));Rc.a.instance.Ca(Kc.a.AV,this.domElement,Object(gd.a)(this,this.O6a,"onMouseEnter"));Rc.a.instance.Ca(Kc.a.$y,this.domElement,Object(gd.a)(this,this.Ttd,
"onMouseLeave"));if(this.j4a||ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))Rc.a.instance.Ca(Kc.a.de,this.domElement,Object(gd.a)(this,this.Hh,"onPointerUp")),this.yva&&(yg.a.instance.Ca(Kc.a.Ge,this.domElement,Object(gd.a)(this,this.Hh,"onPointerUp")),yg.a.instance.Ca(Kc.a.Og,this.domElement,Object(gd.a)(this,this.UM,"onTouchMove")));this.Ssa=!1;this.l1b="#BEBBB8"}Dg.a.rc([this.zqe,this.Jle]);this.PN=this.OD=this.Zyc=this.nR=this.Jle=this.zqe=null;
if(this.mma){for(var Q=Ml(this.mma),ra=Q.next();!ra.done;ra=Q.next())ra.value.dispose();this.mma=null}this.color=this.HSb=null;E.prototype.dispose.call(this)};ua.prototype.AW=function(Q){Q&&this.gma(!1,!1);E.prototype.AW.call(this,Q)};ua.prototype.vKd=function(Q){if(Na.a.Nf.dH){this.Gze();var ra=ng.GetServiceTaskFactory.Xa(this.$.ea,322,323,1,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewTeachingCallout");eg.TaskExtensions.Da(ra,function(mb){Z.UISurfaces.eM().then(function(Qb){var Sc=
mb.result;Sc.E8i(Qb);Sc.show(Q);return null},function(Qb){Uc.ULS.sendTraceTag(595194386,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Qb);return null})},this.ma,3)}};ua.prototype.Wde=function(){var Q=this;if(this.sheet.active&&this.$.sr){var ra=this.$.sr;if(this.sheet.kf.jQ){if(!this.szb){var mb=new Ta(this.sheet,this.nR.lrc,function(){return Q.color?ua.VJd(Q.color):!1},this.$v);this.szb=new db(this.$,mb);this.mma.add(this.szb)}Sys.UI.DomElement.addCssClass(ra,
rb.a.r4c);ra=ua.o$c(Se.a.Xgf);mb=ua.o$c(Se.a.pqd);var Qb=ua.o$c(Se.a.Qgf),Sc=this.sheet.kf.HJd;this.sheet.kf.HJd=!1;"true"===Qb&&Sc&&this.$.fa.KJd?(Ca.a.tw(Se.a.Qgf,"false",Ca.a.KZ),this.$.fa.KJd=!1,this.vKd(3)):"true"===ra&&"true"===mb&&"true"===Qb?this.$.fa.LJd&&this.$.fa.KHb&&(this.sheet.kf.VU?(ra=1,Ca.a.tw(Se.a.pqd,"false",Ca.a.KZ),this.$.fa.KHb=!1):ra=0,Ca.a.tw(Se.a.Xgf,"false",Ca.a.KZ),this.$.fa.LJd=!1,this.vKd(ra)):this.sheet.kf.VU&&"true"===mb&&"true"===Qb&&this.$.fa.KHb&&(Ca.a.tw(Se.a.pqd,
"false",Ca.a.KZ),this.$.fa.KHb=!1,this.vKd(2))}else this.Gze(),Sys.UI.DomElement.removeCssClass(ra,rb.a.r4c)}};ua.prototype.Gze=function(){if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var Q=this.$.ea.Ea(322,void 0);Q&&Q.dismiss()}else this.$.$jd&&(Q=ng.GetServiceTaskFactory.Xa(this.$.ea,322,323,0,"Microsoft.Office.Excel.WebUI.Client.NamedSheetView.INamedSheetViewTeachingCallout"),eg.TaskExtensions.Da(Q,function(ra){ra.result.dismiss()},this.$.ma,3))};ua.prototype.jcb=function(){this.name=
this.sheet.name;this.domElement.className=this.sheet.active||this.S3a()?fb.rnj:fb.ynj;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?Sys.UI.DomElement.addCssClass(this.PN.parentNode,fb.I$h):Sys.UI.DomElement.addCssClass(this.PN.parentNode,fb.J$h);this.x3f();this.Ngd&&this.Wde();this.fgj();this.D3f();this.Dvc();this.Ngd||this.Wde()};ua.prototype.kzi=function(){this.QId=!0;this.gma(!0,!0,"OnSheetReorderStarted")};ua.prototype.jzi=function(){this.QId=!1;this.gma(!1,void 0,
"OnSheetReorderEnded")};ua.prototype.activate=function(Q,ra){Q=void 0===Q?0:Q;ra=void 0===ra?!1:ra;this.jZb()||(this.sheet.activate(),ra&&df.g(this.$).focus(),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")?(ra={},Q=(ra.InputMethod=I.a[Q],ra.AppMode=this.$.jd,ra.Location="canvas",ra)):(ra={},Q=(ra.InputMethod=I.a[Q],ra.AppMode=this.$.jd,ra)),kh.b(this.$).Jd(qd.a.vbj,Q))};ua.prototype.w3f=function(Q){this.l1b=Q?"#797775":"#BEBBB8";this.d_c=Q?-.5:.5;this.ABc=Q?Vb.a.Bp("#3B3A39"):
Vb.a.Bp("#F5F5F5");this.D3f()};ua.prototype.K5i=function(Q){this.j4a=Q};ua.prototype.Osd=function(Q){Q.uXc();this.Soe(Q)};ua.prototype.Soe=function(Q){Q.EYa();this.sheet.activate()};ua.prototype.fng=function(Q){Q=new fd.a(-1876836819,Q,this.$.jd,30,null);var ra={};return this.$.Na.Xb(Q,(ra.SNTA=this.sheet.name,ra))};ua.prototype.x3f=function(){this.PN.parentNode.setAttribute("sheet-title",this.PN.innerText)};ua.prototype.Dvc=function(){var Q=this.Mth();this.anchor.setAttribute(Se.a.Av,Q);this.anchor.setAttribute(Se.a.cga,
this.sheet.active.toString())};ua.prototype.Mth=function(){var Q=this.sheet.kf.jQ,ra=this.sheet.kf.Ojb,mb=this.sheet.vj,Qb=this.sheet.isLockPausedInSession;return Q&&mb?String.format(Tc.a.instance.Eb(20),this.name,ra):Q&&Qb?String.format(Tc.a.instance.Eb(22),this.name,ra):Q?String.format(Tc.a.instance.Eb(19),this.name,ra):mb?String.format(Tc.a.instance.Eb(18),this.name):Qb?String.format(Tc.a.instance.Eb(21),this.name):this.name};ua.prototype.onKeyDown=function(Q){return 13!==Q.Ga.keyCode||this.disabled?
!1:(this.activateSheet(1),!0)};ua.prototype.Nx=function(Q){return 32!==Q.Ga.charCode||this.disabled?!1:(this.activateSheet(1),!0)};ua.prototype.QE=function(){this.disabled||(this.nR.mzi(this),this.nR.wE||this.gma(!0,void 0,"OnMouseOver"))};ua.prototype.uH=function(){this.disabled||this.gma(!1,void 0,"OnMouseOut")};ua.prototype.O6a=function(){this.nR.wE||(this.Ikj(),this.sheet.v6||df.g(this.$).q9a(this.sheet.sheetName));return!1};ua.prototype.Ttd=function(){this.BCe(!1);return!1};ua.prototype.Yc=function(Q){if(this.disabled)return!0;
var ra=df.g(this.$);this.sheet.active||3!==Q.Cb?this.im?this.activateSheet(Q.Cb):mf.a.qkd()&&ra.focus():(!mf.a.eLa(this.$)&&!this.Zwb||ra.isEditing||ra.wi||ra.ipb(),this.activateSheet(Q.Cb));return 3!==Q.Cb};ua.prototype.onPointerDown=function(Q){var ra=this;if(this.disabled)return!0;this.BCe(!0);df.g(this.$).inRangePicker&&Uc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var mb=3===Q.Cb;if(2===Q.Cb||
mb&&this.yva)this.im?(this.gma(!0,!mb,"OnPointerDown"),mb=hf.Task.delay(mb?this.aRf:this.$Qf).CWR(function(){return!0})):mb=this.activateSheet(Q.Cb),this.j4a&&(this.Pcc=!0,this.nR.Enc=eg.TaskExtensions.Da(mb,function(){ra.Pcc&&ra.nR.ozi(ra,Q)},this.ma,11));return!1};ua.prototype.Hh=function(Q){var ra=this;if(this.disabled||!this.j4a&&ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;var mb=this.nR.wE&&!mf.a.p6e();this.Pcc=!1;this.im&&this.gma(2===
Q.Cb,void 0,"OnPointerUp");this.nR.Enc&&(eg.TaskExtensions.Da(this.nR.Enc,function(){ra.nR.nzi(ra)},this.ma,11),this.nR.Enc=null);return mb};ua.prototype.activateSheet=function(Q){Q=void 0===Q?0:Q;if(mf.a.qkd()){if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.jZb())return hf.Task.Ua(!1);vc.a.current.hR="ActivateSheet";this.sheet.activate();return hf.Task.Ua(!0)}return this.fng(Q)};ua.prototype.D3f=function(){var Q=this.sheet.tabColor;this.color=Ud.a.na(Q)?
this.q0g:Vb.a.Bp(Q);this.W5e=ua.VJd(this.color);this.gma(!1,void 0,"UpdateTabColor")};ua.prototype.gma=function(Q,ra,mb){ra=void 0===ra?!1:ra;mb=void 0===mb?null:mb;if(this.sheet){mb=this.sheet.active;var Qb=this.S3a(),Sc=!Ud.a.na(this.sheet.tabColor),Ad=Vb.a.qF(mb||Qb?Rb.a.white:this.color);this.OD.style.background="";mb||Qb?(Sc?ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.AJa?this.v$i():this.im?this.u$i():this.t$i():this.im||(this.OD.style.backgroundColor=
Ad),this.OD.style.height=this.FWc.toString()+"px"):(this.OD.style.filter="",this.OD.style.backgroundColor=Ad,this.OD.style.height=this.GWc.toString()+"px");this.PN.className=mb?fb.snj:Qb?fb.dark:this.W5e?fb.light:fb.dark;Ad=Ml(this.mma);for(var ye=Ad.next();!ye.done;ye=Ad.next())ye.value.K2f();this.im&&(Q&&!Sc&&(this.OD.style.backgroundColor="#E1DFDD"),cf.DOMElementExtensions.toggleCssClass(this.domElement,fb.xnj,Q),ra?(Sc||(this.OD.style.backgroundColor=this.l1b),this.domElement.style.backgroundColor=
this.l1b):(Sc||(this.OD.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.PN.style.fontWeight=mb||Qb||!this.im&&Q?this.im?"600":"bold":""}else Uc.ULS.sendTraceTag(592192463,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",mb)};ua.prototype.u$i=function(){var Q=this.OD.style,ra=Vb.a.qF(ua.RUc(this.color,this.d_c));Q.background=ra};ua.prototype.t$i=function(){var Q=this.OD.style,ra=Vb.a.qF(ua.RUc(this.color,
1)),mb=Vb.a.qF(ua.RUc(this.color,this.d_c)),Qb="";if(bf.a.Nja)Qb="-webkit-";else if(bf.a.Pf)Qb="-moz-";else if(bf.a.tf){if(Qb="-ms-",!bf.a.G3a){Q.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",ra,mb);return}}else bf.a.I6e&&(Qb="-o-");Q.background=String.format("{0}linear-gradient({1}, {2})",Qb,ra,mb)};ua.prototype.v$i=function(){this.OD.style.background="transparent"};ua.prototype.KRg=function(){this.Zyc=document.createElement("a");this.anchor.removeAttribute("Href");
this.anchor.className=fb.tnj;cf.DOMElementExtensions.xo(this.anchor,Se.a.slb,null,null);this.tabIndex=-1};ua.prototype.RXg=function(){this.OD=document.createElement("span");this.OD.className=fb.vnj;this.PN=document.createElement("span");this.PN.className=fb.Anj;this.PN.dir=this.sheet.rtlName?"rtl":"ltr";this.OD.appendChild(this.PN)};ua.prototype.fgj=function(){for(var Q=this.$.zI,ra=Ml(this.mma),mb=ra.next();!mb.done;mb=ra.next())mb.value.egj(Q,this.OD,this.PN)};ua.prototype.S3a=function(){return df.g(this.$).S3a(this.sheet)};
ua.prototype.Ikj=function(){this.Ldd.start();this.Rhd=!0};ua.prototype.BCe=function(Q){if(this.Rhd){this.Ldd.stop();var ra={};Q=(ra["Sheet index"]=this.sheet.index,ra["Active Sheet"]=this.sheet.active,ra["Hovering time"]=this.Ldd.Gc,ra["Has been clicked"]=Q,ra);Uc.ULS.sendTraceTag(39195022,0,50,vd.c(Q));this.Rhd=!1}};ua.prototype.SQi=function(){Rc.a.instance.qa(Kc.a.pointerDown,this.domElement,Object(gd.a)(this,this.onPointerDown,"onPointerDown"));nf.KeyInputManager.instance.qa(Kc.a.Rb,this.domElement,
Object(gd.a)(this,this.onKeyDown,"onKeyDown"));nf.KeyInputManager.instance.qa(Kc.a.Qo,this.domElement,Object(gd.a)(this,this.Nx,"onKeyPress"));this.tc.la("mouseover",Object(gd.a)(this,this.QE,"onMouseOver"));this.tc.la("mouseout",Object(gd.a)(this,this.uH,"onMouseOut"));Rc.a.instance.qa(Kc.a.AV,this.domElement,Object(gd.a)(this,this.O6a,"onMouseEnter"));Rc.a.instance.qa(Kc.a.$y,this.domElement,Object(gd.a)(this,this.Ttd,"onMouseLeave"));if(this.j4a||ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))Rc.a.instance.qa(Kc.a.de,this.domElement,Object(gd.a)(this,this.Hh,"onPointerUp")),this.yva&&(yg.a.instance.qa(Kc.a.Ge,this.domElement,Object(gd.a)(this,this.Hh,"onPointerUp")),yg.a.instance.qa(Kc.a.Og,this.domElement,Object(gd.a)(this,this.UM,"onTouchMove")));Df.a.instance.qa(Kc.a.click,this.domElement,Object(gd.a)(this,this.Yc,"onClick"));this.Ssa=!0};ua.prototype.UM=function(){if(!this.j4a&&ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;
this.Pcc=!1;this.QId||this.gma(!1,void 0,"OnTouchMove");return!1};ua.prototype.jZb=function(){var Q=this.$.ea.Ea(65,void 0);return Q&&Q.f4()?(Q.MFb(),this.Soe(Q),!0):!1};ua.o$c=function(Q){var ra=Ca.a.get(Q);ra||(Ca.a.tw(Q,"true",Ca.a.KZ),ra=Ca.a.get(Q));return ra};ua.RUc=function(Q,ra){if(1<ra||-1>ra)return Q;var mb=Q.r,Qb=Q.g;Q=Q.b;0<ra?(mb=mb*(1-ra)+255*ra,Qb=Qb*(1-ra)+255*ra,Q=Q*(1-ra)+255*ra):(mb*=1+ra,Qb*=1+ra,Q*=1+ra);return Rb.a.srb(Math.round(mb),Math.round(Qb),Math.round(Q))};ua.VJd=function(Q){return 128>=
(222*Q.r+707*Q.g+71*Q.b)/1E3};Jl.Object.defineProperties(ua.prototype,{q0g:{configurable:!0,enumerable:!0,get:function(){return this.ABc||(this.ABc=Vb.a.Bp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.PN.innerText},set:function(Q){this.PN&&(this.PN.innerText=Q,this.Dvc(),this.x3f())}},sheet:{configurable:!0,enumerable:!0,get:function(){return this.HSb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.Zyc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},
set:function(Q){this.anchor.tabIndex=Q}}});Object(Le.a)(ua,"SheetTabButton",E,[]);Cm(Ra,E);Object(Le.a)(Ra,"WorkbookProtectionButton",E,[]);var je=b(50),qf=b(47),rf=b(53),Zf=ch.a;Cm(ca,Zf);ca.prototype.zb=function(Q,ra,mb,Qb,Sc,Ad,ye){ye=void 0===ye?!1:ye;Q.removeAttribute("Href");Q.setAttribute(Se.a.Wd,Se.a.Gq);Q.className=fb.Vdh;Q.title=ra;Q.tabIndex=0;this.$v&&Ad?mb=this.svgIconProvider.haa(Ad,12,12,Q,24,24):(ra=document.createElement("span"),ra.className=this.im?rb.a.WLg:rb.a.MB,ra.classList.add(f.a.eha),
ra.tabIndex=-1,Q.appendChild(ra),Ad=document.createElement("img"),Ad.src=qe.a.Ee(mb),Ad.className=Qb,Ad.alt=Sc,Ad.tabIndex=-1,ra.appendChild(Ad),mb=Ad);ye&&Q.classList.add(f.a.pY);return mb};ca.prototype.dispose=function(){if(this.$){var Q=this.$.Aa;Q.wg(Object(gd.a)(this,this.Ii,"onActiveSheetChanged"));Q.Wmc(Object(gd.a)(this,this.l5,"onCleared"));Q.h6(Object(gd.a)(this,this.zC,"onSheetDeleted"));Q.ula(Object(gd.a)(this,this.vBb,"onSheetInserted"));Q.lOa(Object(gd.a)(this,this.hxa,"onSheetRenamed"));
Q.CFf(Object(gd.a)(this,this.zsf,"onSheetReordered"));Q.AEb(Object(gd.a)(this,this.Bsf,"onSheetVisibilityChanged"));Q.dUi(Object(gd.a)(this,this.Asf,"onSheetTabColorChanged"));Q.cCd(Object(gd.a)(this,this.ojf,"onActiveItemLockChanged"));Q.zFf(Object(gd.a)(this,this.pjf,"onActiveItemLockPausedChanged"));Q.AFf(Object(gd.a)(this,this.qjf,"onActiveItemNamedSheetViewModeChanged"));Q.BFf(Object(gd.a)(this,this.HMa,"onItemNamedSheetViewSwitched"));this.$.nl(Object(gd.a)(this,this.sd,"onWorkbookOpened"));
this.$.AH(Object(gd.a)(this,this.kk,"onContentAreaResized"));bh.a(this.$)&&bh.a(this.$).vg.vla(Object(gd.a)(this,this.RE,"onPartialInteractivityStatusChanged"));this.nsa&&df.g(this.$).eFf(Object(gd.a)(this,this.rAb,"onComponentRangePickerActiveStateChanged"));Sd.a.instance.Ca(Kc.a.wC,this.domElement,Object(gd.a)(this,this.p5,"onMouseWheel"))}Dg.a.rc(this.Aqd);this.Aqd=null;if(this.YJ)for(Q=0;Q<this.YJ.length;Q++){var ra=cf.DOMElementExtensions.qJ(this.YJ[Q],this.domElement,!1,"a");ra&&Gf.a.rla(ra)}Dg.a.Ia(this.IB);
Dg.a.Ia(this.rrc);Dg.a.Ia(this.UId);this.UId=this.rrc=this.cvb=this.SG=this.IB=null;this.$&&this.Qy&&this.xP(!1);this.Y9=null;this.cHd(null,"Dispose");this.ZIb=this.TL=this.b3b=null;this.TVc();this.R$a=this.trc=this.VId=this.Ik=this.YJ=this.$=this.fa=null;Zf.prototype.dispose.call(this)};ca.prototype.Ye=function(Q,ra){if(!ra){Uc.ULS.shipAssertTag(2472137,0,0<this.nh.length,"There is no sheet tab button.");if(!this.nh.length)return!1;Q=null;for(var mb=Ml(this.nh),Qb=mb.next();!Qb.done&&!(Q=Qb.value.Qzh());Qb=
mb.next());if(!Q)return Uc.ULS.shipAssertTag(18661726,0,!1,"There is no focusable tab element."),!1;cf.DOMElementExtensions.setFocus(Q)}return!ra};ca.prototype.Lh=function(Q){return cf.DOMElementExtensions.jf(this.Nb,Q)};ca.prototype.vi=function(){};ca.prototype.ei=function(){};ca.prototype.reorderSheets=function(Q,ra,mb){if(this.NZ&&this.NZ!==Q){var Qb=this.NZ.index;this.oWi(this.NZ,Q,ra);Q=Q?Q.index-1:ra?this.$.Aa.count-1:0;Qb!==Q&&(this.Adi(Qb,Q,mb),this.F8g(this.NZ.name,Q))}};ca.prototype.zC=
function(Q,ra){this.wsf(ra.item)};ca.prototype.hxa=function(Q,ra){Q=this.$.Aa.sa.index;for(var mb=0,Qb=this.nh.length;mb<Qb;mb++){var Sc=this.XP(mb);if(Sc.name===ra.oldName){Sc.name=ra.newName;this.n_();mb===Q&&this.z_(6);break}}};ca.prototype.Asf=function(Q,ra){(Q=this.Y_a(ra.item))&&Q.jcb()};ca.prototype.Bsf=function(Q,ra){ra.visible?(this.zPa(!1),this.xsf(ra.item)):this.wsf(ra.item)};ca.prototype.NKh=function(Q){Q=this.Lha(Q);return-1!==Q&&this.Au<=Q&&Q<=this.NJ?this.nh[Q].domElement:null};ca.prototype.Ayj=
function(Q){if(this.$v){for(var ra=0;ra<this.YJ.length;ra++){var mb=this.YJ[ra];if(mb&&this.svgIconProvider){var Qb=mb.parentNode;this.HEf(mb);Qb&&(this.YJ[ra]=this.svgIconProvider.haa(Q?this.Wxf[ra]:this.Bqd[ra],12,12,Qb,24,24))}}for(ra=0;ra<this.nh.length;ra++)this.nh[ra].w3f(Q);this.HPa&&this.HPa.$qa&&this.v3f(h.a.DMh,this.HPa,Q);this.SG&&this.SG.$qa&&this.v3f(h.a.aOg,this.SG,Q)}};ca.prototype.v3f=function(Q,ra,mb){ra.V7a||(ra.V7a=this.svgIconProvider.haa(Q,12,12,ra.$qa.parentNode,24,24));ra.V7a&&
(cf.DOMElementExtensions.setVisible(ra.$qa,!mb),cf.DOMElementExtensions.setVisible(ra.V7a,mb))};ca.prototype.ozi=function(Q,ra){var mb=df.g(this.$),Qb=mb.inRangePicker,Sc=hd.HelperMethods.Fm(ra);if(mb.isEditing&&!Qb){if(this.Y0h){var Ad=mb.Zi?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";rg.a(this.$).Vma(Sc.rawEvent,Ad)}mb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}mb=this.yva&&3===ra.Cb;(2!==ra.Cb||Sc.button)&&!mb||Qb||this.wE||bh.a(this.$).Rq()||(mb&&Q.kzi(),this.qxb=
ra.clientPoint.x,this.rY=ra,this.mBg(Q))};ca.prototype.mzi=function(Q){!this.Qy&&this.wE&&this.GKd(Q.sheet,!1)};ca.prototype.nzi=function(Q){this.Qy||(this.wE&&this.reorderSheets(Q.sheet,!1,!0),this.xP());this.n_()};ca.prototype.ahe=function(){return this.$.isEditMode&&!cd.k(this.$.sg)};ca.prototype.n_=function(){var Q=this,ra=hd.HelperMethods.qwa(function(){Q.Ewj();Q.im&&Q.X9i();Q.AHd()});Uc.ULS.sendTraceTag(51446688,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",ra)};
ca.prototype.X9i=function(){var Q=this.NJ===this.nh.length-1;cf.DOMElementExtensions.toggleCssClass(this.R$a,this.$.zI?fb.DFe:fb.sFe,!!this.Au);cf.DOMElementExtensions.toggleCssClass(this.R$a,this.$.zI?fb.sFe:fb.DFe,!Q)};ca.prototype.AHd=function(Q){Q=void 0===Q?!1:Q;var ra=!this.Au,mb=this.NJ===this.nh.length-1;this.WOf(4,this.sheetTabActivatePreviousHidden,!ra);this.WOf(5,this.sheetTabActivateNextHidden,!mb);this.Kqc(0,ra||Q);this.Kqc(1,ra||Q);this.Kqc(2,mb||Q);this.Kqc(3,mb||Q)};ca.prototype.WOf=
function(Q,ra,mb){if(Q=this.YJ[Q]){cf.DOMElementExtensions.setVisible(Q,mb);var Qb=this.kSe(Q);Qb.title="img"===Q.nodeName?Q.alt=0<this.nh.length&&mb?ra:"":Q.title=0<this.nh.length&&mb?ra:"";Qb.tabIndex=mb?0:-1}};ca.prototype.kSe=function(Q){return this.$v?Q.parentNode:Q.parentNode.parentNode};ca.prototype.Kqc=function(Q,ra){if(Q=this.YJ[Q])Q=this.kSe(Q),void 0!==Q&&null!==Q&&(!this.nh.length||ra?(Q.classList.add(f.a.pY),Q.setAttribute(Se.a.Iqa,"true")):(Q.classList.remove(f.a.pY),Q.setAttribute(Se.a.Iqa,
"false")))};ca.prototype.zPa=function(Q){var ra=this.$.zI?this.nh.length-1:0,mb=this.AUe(this.$.zI?0:this.nh.length-1);mb&&(mb.borderRightWidth=Q?"1px":"0");this.Au!==this.NJ&&(mb=this.AUe(ra))&&(mb.borderRightWidth="0")};ca.prototype.fee=function(Q,ra){this.nh||(this.nh=[]);-1===ra?Array.add(this.nh,Q):Array.insert(this.nh,ra,Q)};ca.prototype.E0b=function(Q,ra){var mb=-1,Qb=null;ra||(mb=this.EDh(Q.index),-1!==mb&&(Qb=this.VIa(mb)));Q=new ua(this.$,this.Ik,Qb,Q,this,this.im,this.$v);this.fee(Q,mb);
cf.DOMElementExtensions.setVisible(Q.domElement,!0)};ca.prototype.GKd=function(Q,ra){var mb=this.Y_a(Q);if(mb){this.Eed=Q;this.Spd=ra;Q=mb.domElement;mb=this.isRtl?Q.offsetLeft+(this.Ik.scrollWidth-this.Ik.clientWidth-this.Ik.scrollLeft):Q.offsetLeft-this.Ik.scrollLeft;if(!this.isRtl&&ra||this.isRtl&&!ra)mb+=Q.offsetWidth;this.prc.style.left=hd.HelperMethods.Ub(mb-4);cf.DOMElementExtensions.setVisible(this.prc,!0)}};ca.prototype.e_e=function(){cf.DOMElementExtensions.setVisible(this.prc,!1)};ca.prototype.z_=
function(Q){var ra=this,mb=hd.HelperMethods.qwa(function(){switch(Q){case 0:ra.dpc(0);break;case 1:ra.dpc(ra.Au-1);break;case 2:ra.dpc(ra.Au+1);break;case 3:ra.scrollIntoView(ra.nh.length-1);break;case 4:ra.Au&&1<=ra.nh.length&&(ra.Wbe(ra.Au-1),ra.BFd());break;case 5:ra.NJ!==ra.nh.length-1&&1<=ra.nh.length&&(ra.Wbe(ra.NJ+1),ra.BFd());break;case 6:ra.BFd()}});this.k3b&&this.wE&&this.sKb();Uc.ULS.sendTraceTag(51446689,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",Q,mb)};
ca.prototype.Wbe=function(Q){(Q=this.XP(Q))&&Q.activate()};ca.prototype.Pmh=function(Q){if(!Q.ay)for(var ra=this.$.Aa,mb=0,Qb=0,Sc=ra.count;Qb<Sc;Qb++){var Ad=Object(Ye.a)(Ie.a,ra.getItem(Qb));if(Ad===Q)return mb;Ad.ay||mb++}return-1};ca.prototype.Dmh=function(Q){var ra=this.$.Aa;Q=Q.index+1;for(var mb=ra.count;Q<mb;Q++){var Qb=Object(Ye.a)(Ie.a,ra.getItem(Q));if(!Qb.ay)return Qb}return null};ca.prototype.Lha=function(Q){for(var ra=0;ra<this.nh.length;ra++){var mb=this.XP(ra);if(!mb)Uc.ULS.sendTraceTag(592189569,
0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",ra);else if(mb.sheet===Q)return ra}return-1};ca.prototype.Y_a=function(Q){Q=this.Lha(Q);return this.XP(Q)};ca.prototype.Adi=function(Q,ra,mb){var Qb={};Qb.a=this.$.Ba.UserSessionId;Qb.b=mb;Qb.c=this.S2b;Qb.d=Q;Qb.e=ra;Qb.f=this.$.Aa.count;je.b().Se(2,Qb,mb)};ca.prototype.oWi=function(Q,ra,mb){var Qb=Object(Ye.a)(Me.a,this.$.Aa);ra?(ra=ra.index,ra=Q.index<ra?ra-1:ra):ra=mb?Qb.count-
1:0;Qb.reorderSheet(Q,ra,!0)};ca.prototype.uOf=function(Q){df.g(this.$).Vi.YA(Q)};ca.prototype.mBg=function(Q){if(!this.Dnc){var ra=this.domElement.ownerDocument.body;this.Qy?(Rc.a.instance.qa(Kc.a.Jh,document.documentElement,Object(gd.a)(this,this.OE,"onDocumentPointerMove")),this.yva&&(yg.a.instance.qa(Kc.a.Og,document.documentElement,Object(gd.a)(this,this.OE,"onDocumentPointerMove")),yg.a.instance.qa(Kc.a.Og,this.domElement,Object(gd.a)(this,this.UM,"onTouchMove")))):(Rc.a.instance.qa(Kc.a.Jh,
ra,Object(gd.a)(this,this.OE,"onDocumentPointerMove")),yg.a.instance.qa(Kc.a.Og,ra,Object(gd.a)(this,this.OE,"onDocumentPointerMove")));Rc.a.instance.qa(Kc.a.de,document.documentElement,Object(gd.a)(this,this.JQ,"onDocumentPointerUp"));yg.a.instance.qa(Kc.a.Ge,ra,Object(gd.a)(this,this.JQ,"onDocumentPointerUp"));this.Dnc=!0}this.NZ=Q.sheet;this.S2b=!1;this.Qy?(this.TL=null,this.b3b=Q,this.Y9=Q.domElement,this.cHd(cf.DOMElementExtensions.getBoundingClientRect(this.Y9),"BeginSheetTabButtonDrag")):(Uc.ULS.sendTraceTag(595100060,
0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(fb.rFe),this.domElement.style.cursor="",this.uOf("pointer"))};ca.prototype.xP=function(Q){Q=void 0===Q?!0:Q;if(this.Dnc){this.uOf(Se.a.kua);var ra=this.domElement.ownerDocument.body;this.Qy?(Rc.a.instance.Ca(Kc.a.Jh,document.documentElement,Object(gd.a)(this,this.OE,"onDocumentPointerMove")),this.yva&&(yg.a.instance.Ca(Kc.a.Og,document.documentElement,Object(gd.a)(this,this.OE,
"onDocumentPointerMove")),yg.a.instance.Ca(Kc.a.Og,this.domElement,Object(gd.a)(this,this.UM,"onTouchMove")))):(Rc.a.instance.Ca(Kc.a.Jh,ra,Object(gd.a)(this,this.OE,"onDocumentPointerMove")),yg.a.instance.Ca(Kc.a.Og,ra,Object(gd.a)(this,this.OE,"onDocumentPointerMove")));Rc.a.instance.Ca(Kc.a.de,document.documentElement,Object(gd.a)(this,this.JQ,"onDocumentPointerUp"));yg.a.instance.Ca(Kc.a.Ge,ra,Object(gd.a)(this,this.JQ,"onDocumentPointerUp"));this.AFc=this.Dnc=!1}this.Akc=0;this.S2b=!1;this.Eed=
this.NZ=null;this.Qy?(this.Y9&&(this.Y9.style.visibility="visible",this.Y9=null),this.b3b=null,this.cHd(null,"EndSheetTabButtonDrag"),this.TL&&(this.TL.parentNode&&this.TL.parentNode.removeChild(this.TL),this.TL=null),this.BYi(Q)):(this.domElement.classList.remove(fb.rFe),this.e_e())};ca.prototype.BYi=function(Q){this.hMd(Q);this.kC=this.qxb=-1};ca.prototype.F8g=function(Q,ra){function mb(ye,Ze,sd){var pe=Ad.Ra(9,null);pe.sheetName=Q;pe.newSheetIndex=ra;return Gh.i(Ad,"ReorderSheets",pe,ye,Ze,sd,
null,0)}function Qb(){return new Ua(Q,ra)}var Sc=this.$.ra,Ad=Sc?Sc.xa:null;ee.EwaSettings.wc()?this.$.userOperationManager.oc(new Ng.a(557,0,mb,64,Qb),null):this.$.userOperationManager.oc(new $d.a(557,0,mb,void 0,Qb),null)};ca.prototype.XP=function(Q){return 0<=Q&&Q<this.nh.length?this.nh[Q]:null};ca.prototype.zUe=function(Q){return(Q=this.XP(Q))?Q.sheet:null};ca.prototype.VIa=function(Q){return(Q=this.XP(Q))?Q.domElement:null};ca.prototype.AUe=function(Q){return(Q=this.VIa(Q))?Q.style:null};ca.prototype.EDh=
function(Q){var ra=this.$.Aa;Q+=1;for(var mb=-1,Qb=this.nh?this.nh.length:0;Q<ra.count;){var Sc=Object(Ye.a)(Ie.a,ra.getItem(Q));if(!Sc.ay){for(mb=0;mb<Qb&&this.zUe(mb)!==Sc;mb++);break}Q++}return-1===mb||mb===Qb?-1:mb};ca.prototype.wsf=function(Q){var ra=this.Y_a(Q);ra&&(this.Qy&&this.wE&&(Uc.ULS.sendTraceTag(594625671,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.xP()),this.Ik.removeChild(ra.domElement),ra=Array.indexOf(this.nh,ra),Array.removeAt(this.nh,ra),this.n_(),(!this.isRtl&&ra===this.nh.length||this.isRtl&&!ra)&&this.zPa(!0),this.k3b&&this.wE?Q===this.NZ?(this.xP(),this.z_(6)):this.sKb():this.z_(6))};ca.prototype.xsf=function(Q){var ra=Object(Ye.a)(Ie.a,Q);this.Qy&&this.wE&&(Uc.ULS.sendTraceTag(594625669,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.xP());if(!ra.ay){this.zPa(!1);var mb=this.Lha(Q);-1===mb&&(Uc.ULS.sendTraceTag(592189568,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.E0b(ra,!1),mb=this.Lha(Q));this.kYe(mb,!0)}};ca.prototype.pWi=function(Q,ra){var mb=this.Y_a(Q);mb&&(this.Qy&&this.wE&&!ra&&(Uc.ULS.sendTraceTag(592740950,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.xP()),Q=this.nnj(Q,mb),!ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Qy&&Q&&ra&&Q.jzi())};ca.prototype.nnj=function(Q,ra){var mb=Array.indexOf(this.nh,ra),Qb=this.Pmh(Object(Ye.a)(Ie.a,Q));if(-1===Qb||-1===mb)return null;mb!==Qb||this.Qy?(this.zPa(!1),Qb=ca.lWi(mb,Qb,this.Au,this.NJ),this.Au=Qb.onh,this.NJ=Qb.N9h,ra&&ra.domElement.parentNode===this.Ik&&(this.Ik.removeChild(ra.domElement),Array.removeAt(this.nh,mb)),ra=this.Dmh(Q),mb=this.Lha(ra),
ra=new ua(this.$,this.Ik,this.VIa(mb),Object(Ye.a)(Ie.a,Q),this,this.im,this.$v),this.fee(ra,mb),mb=this.Lha(Q),this.kYe(mb,!1,!this.im)):ra=null;return ra};ca.prototype.r9g=function(){for(var Q=this.nh?this.nh.length:0,ra=this.Au,mb=this.NJ,Qb=0;Qb<Q;Qb++){var Sc=this.XP(Qb),Ad=Qb>=ra;Sc&&(Sc.tabIndex=Ad&&Qb<=mb?0:-1)}};ca.prototype.uvj=function(){for(var Q=this.nh?this.nh.length:0,ra=0;ra<Q;ra++){var mb=this.XP(ra);mb&&mb.jcb()}};ca.prototype.kYe=function(Q,ra,mb){mb=void 0===mb?!0:mb;ra&&Q<=this.Au&&
this.Au++;this.r9g();this.zPa(!0);this.n_();this.k3b&&this.wE?this.sKb():mb&&this.z_(6)};ca.prototype.rqc=function(Q){var ra=this.$.zI;if(Q||this.isRtl!==ra)this.isRtl=ra,this.domElement.classList.remove(this.isRtl?rb.a.yFe:rb.a.EFe),this.domElement.classList.add(this.isRtl?rb.a.EFe:rb.a.yFe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.uvj();Q||this.zPa(!0);for(Q=0;Q<this.YJ.length;Q++)Q&&3!==Q&&(!this.im||4!==Q&&5!==Q)&&this.XOf(Q)};ca.prototype.DVg=function(){var Q=this.VId=document.createElement("div");
Q.className=fb.Sdh;this.im&&Q.classList.add(fb.Tdh);this.domElement.appendChild(Q);this.z0b(Q,1,689,688);this.z0b(Q,2,691,690);this.q8e&&(this.HPa=new Ia(this.$,this,Q));this.im||this.z0b(Q,4,695,694)};ca.prototype.EVg=function(){var Q=this.trc=document.createElement("div");Q.className=fb.Udh;this.domElement.appendChild(Q);this.im||this.z0b(Q,5,697,696);this.wZc()};ca.prototype.FWg=function(){var Q=document.getElementById(Se.a.wbj),ra=document.getElementById(Se.a.xbj);Q&&!ra&&Uc.ULS.sendTraceTag(576239773,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",Q.parentNode.id,!!Q.firstChild,!!document.getElementById(Se.a.OId));if(mf.a.u8e(this.$)&&Q&&ra)this.domElement.appendChild(Q),this.WId=Q.firstChild,this.XId=document.getElementById(Se.a.OId),ra.style.visibility="visible";else{Q=document.createElement("div");ra=document.createElement("div");Q.className=rb.a.ceh;ra.className=
rb.a.aeh;ra.style.display="none";var mb=document.createElement("div");mb.className=rb.a.deh;var Qb=document.createElement("div");Qb.className=rb.a.beh;var Sc=document.createElement("div");Sc.className=rb.a.$dh;ra.appendChild(mb);ra.appendChild(Qb);ra.appendChild(Sc);Q.appendChild(ra);this.domElement.appendChild(Q);this.WId=ra;this.XId=Qb}};ca.prototype.XOf=function(Q){var ra=this.YJ[Q];if(ra)if(this.$v){var mb=ra.parentNode;this.HEf(ra);ra=pf.a(this.$)?this.Wxf[Q]:this.Bqd[Q];this.YJ[Q]=this.svgIconProvider.haa(ra,
12,12,mb,24,24)}else ra.className=this.zqd[Q]};ca.prototype.HEf=function(Q){Q&&Q.parentNode&&Q.parentNode.removeChild(Q)};ca.prototype.YSg=function(){var Q=this.R$a=document.createElement("div");Q.className=fb.Pdh;this.domElement.appendChild(Q);this.HXg(Q)};ca.prototype.HXg=function(Q){var ra=document.createElement("div");ra.className=fb.feh;ra.classList.add(fb.Qdh);this.$.printingEnabled||ra.classList.add(xf.a.KHe);Q.appendChild(ra);this.Ik=document.createElement("ul");cf.DOMElementExtensions.xo(this.Ik,
Se.a.lRc,null,null);this.Ik.className=xf.a.FFe;ra.appendChild(this.Ik);this.wVg();this.r9d=document.createElement("div");this.lrc.id="SheetIconTooltipContainer";ra.appendChild(this.lrc)};ca.prototype.wVg=function(){var Q=document.createElement("div"),ra="<div class='"+rb.a.ZLg+"'>{0}</div>",mb=qe.a.t8c(rb.a.cfh,0,"55_16_N","");Q.innerHTML=String.format(ra,mb);Q.className=fb.eeh;cf.DOMElementExtensions.setVisible(Q,!1);this.prc=Q;this.Ik.appendChild(Q)};ca.prototype.PZc=function(){for(var Q=this.$.Aa,
ra=0,mb=Q.count;ra<mb;ra++){var Qb=Object(Ye.a)(Ie.a,Q.getItem(ra));Qb.ay||(this.E0b(Qb,!0),Qb.active&&Qb.activate())}};ca.prototype.TVc=function(){Dg.a.rc(this.nh);this.nh=[];this.NJ=this.Au=0};ca.prototype.z0b=function(Q,ra,mb,Qb){function Sc(sd){"mouseup"===sd.type&&Ad.Qy&&Ad.wE||Yg.g(sd);Sys.UI.DomElement.containsCssClass(ye,f.a.pY)||(Ze?Ad.bwi(sd,ra):Ad.im||Ad.Epf(sd,ra))}var Ad=this,ye=document.createElement("a");Q.appendChild(ye);Q=this.Bqd[ra];this.YJ[ra]=this.zb(ye,Tc.a.instance.da(Qb),0,
this.zqd[ra],Tc.a.instance.da(mb),Q);if(5===ra||4===ra)cf.DOMElementExtensions.qJ(this.YJ[ra],ye,!1,"span").style.marginTop="10px";this.XOf(ra);mb=this.Aqd[ra]=this.Ud.Kd(ye);Rc.a.instance.qa(Kc.a.pointerDown,ye,function(sd){return sd.ctrlKey&&Ad.sqi(ra)?!0:Ad.Cpf(ra)});Rc.a.instance.qa(Kc.a.de,ye,function(){return Ad.Dpf()});yg.a.instance.qa(Kc.a.Ge,ye,function(){return Ad.Dpf()});Rc.a.instance.qa(Kc.a.pointerOut,ye,function(){return Ad.KVc()});nf.KeyInputManager.instance.qa(Kc.a.Rb,ye,function(sd){return 13!==
sd.Ga.keyCode&&32!==sd.Ga.keyCode||Ad.PXc?!1:(Ad.PXc=!0,Ad.Cpf(ra))});nf.KeyInputManager.instance.qa(Kc.a.fe,ye,function(sd){return 13===sd.Ga.keyCode||32===sd.Ga.keyCode?(Ad.PXc=!1,Ad.KVc()):!1});var Ze=this.ahe();mb.la("mouseover",Sc);mb.la("mouseout",Sc);mb.la("focus",Sc);mb.la("blur",Sc);Ze&&mb.la("mouseup",Sc)};ca.prototype.C4e=function(Q){var ra=!1,mb=this.$.gf;mb&&(ra=Od.a.vA(cf.DOMElementExtensions.getBoundingClientRect(mb),Q.clientPoint));return ra};ca.prototype.r8e=function(Q){return Od.a.vA(cf.DOMElementExtensions.getBoundingClientRect(this.domElement),
Q.clientPoint)||this.C4e(Q)};ca.prototype.Lmh=function(Q){var ra=null,mb=Q.clientPoint,Qb=this.Au;if(this.r8e(Q))for(Qb=this.Au;Qb<=this.NJ;Qb++)if(ra=this.XP(Qb))if(Q=cf.DOMElementExtensions.getBoundingClientRect(ra.domElement),!this.isRtl&&mb.x<Q.x+Q.width||this.isRtl&&mb.x>Q.x)break;return{returnValue:ra,Vej:Qb>this.NJ}};ca.prototype.OE=function(Q){this.wE?(this.rY=Q,this.sKb()):(this.rY&&(this.Akc+=this.rY.clientPoint.x-Q.clientPoint.x),this.rY=Q,Math.abs(this.Akc)>=this.z5g&&this.sKb());return!0};
ca.prototype.UM=function(Q){Q.Ga.preventDefault();return!1};ca.prototype.sKb=function(){if(this.Qy){if(!this.TL){Uc.ULS.sendTraceTag(595100061,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.TL=this.Y9.cloneNode(!0);if(!this.XJf(this.TL,this.Y9,!0,"UpdateDragAndDropState"))return;this.Y9.style.visibility="hidden";this.TL.classList.add(fb.geh);this.TL.style.borderRightWidth="";this.n9b=this.rY.clientPoint.x-this.Z2.width/2;this.TL.style.left=this.n9b+
"px";this.kC=this.Lha(this.NZ);0>this.kC&&Uc.ULS.sendTraceTag(592189539,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.k3b&&(this.kC=this.Lha(this.NZ));var Q=cf.DOMElementExtensions.getBoundingClientRect(this.Ik),ra=Q.x;Q=Q.x+Q.width;var mb=this.rY.clientPoint.x-this.Z2.width/2;mb=Math.min(mb,Q-this.Z2.width);mb=Math.max(mb,ra);this.TL.style.transform="translateX("+Math.abs(mb-this.n9b)*(this.n9b<mb?1:-1)+"px)";var Qb=this.rY.clientPoint.x>this.qxb,Sc=this.rY.clientPoint.x;
mb>=Q-this.Z2.width?(Sc=Q-this.Z2.width/2,this.zFd()||this.jla||(Uc.ULS.sendTraceTag(595100059,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Mjc=this.Ik.scrollLeft,this.jla=window.requestAnimationFrame(Object(gd.a)(this,this.xLf,"scrollToTheRight")))):mb<=ra?(Sc=ra+this.Z2.width/2,this.yFd()||this.jla||(Uc.ULS.sendTraceTag(595100058,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.Mjc=this.Ik.scrollLeft,this.jla=window.requestAnimationFrame(Object(gd.a)(this,this.wLf,"scrollToTheLeft")))):this.jla&&(Uc.ULS.sendTraceTag(592189591,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.hMd());this.rY.clientPoint.x!==this.qxb&&(this.VMd(Qb,Sc),this.qxb=this.rY.clientPoint.x)}else Q=this.Lmh(this.rY),ra=Q.Vej,(Q=Q.returnValue)?this.GKd(Q.sheet,ra):this.e_e();this.AFc=!0};ca.prototype.VMd=function(Q,ra){for(var mb=this,
Qb;function(){var Sc=mb.A5g(ra,Q);Qb=Sc.JYb;return Sc}().returnValue;)this.ZIb=Qb,this.Lwg(Q)};ca.prototype.Lwg=function(Q){if(this.ZIb){var ra=(Q?1:-1)*this.Z2.width;if(Q&&!this.$.zI||!Q&&this.$.zI){var mb=this.Y9;var Qb=this.kC+1;var Sc=!0}else mb=(Qb=this.XP(this.kC+1))?Qb.domElement:null,Qb=this.kC-1,Sc=!1;if(this.XJf(this.ZIb,mb,Sc,"AnimateSheetSwap")){Uc.ULS.sendTraceTag(592189590,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",
this.kC,Qb,this.TId,Q);0<=this.kC&&this.kC<this.nh.length&&0<=Qb&&Qb<this.nh.length?(Q=this.nh[Qb],this.nh[Qb]=this.nh[this.kC],this.nh[this.kC]=Q):(Uc.ULS.sendTraceTag(592189538,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.nh.length,this.kC,Qb),this.xP());this.kC=Qb;var Ad=this.ZIb;Ad.style.transform="translateX("+ra+"px)";window.requestAnimationFrame(function(){Ad.style.transform="translateX(0px)"})}}};ca.prototype.XJf=
function(Q,ra,mb,Qb){function Sc(Ad){return Ad?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",Ad.id,Ad.className,Ad.nodeName):null}try{return this.Ik.insertBefore(Q,ra),!0}catch(Ad){return Q=this.Y_a(this.NZ),Uc.ULS.sendTraceTag(594871898,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Q?Q!==this.b3b?"Changed":"NoChange":"Removed",Qb,Sc(ra),Sc(ra.parentNode),Sc(this.Ik),mb,this.kC,this.TId,Ad),this.xP(),!1}};ca.prototype.A5g=function(Q,ra){var mb=this.$.zI===ra?this.XP(this.kC-1):this.XP(this.kC+1);if(!mb)return{returnValue:!1,JYb:null};mb=mb.domElement;var Qb=cf.DOMElementExtensions.getBoundingClientRect(mb);return this.Z2?ra?{returnValue:Q+this.Z2.width/2>=Qb.x+.5*Qb.width,JYb:mb}:{returnValue:Q-this.Z2.width/2<=Qb.x+.5*Qb.width,JYb:mb}:(Uc.ULS.sendTraceTag(592189589,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.xP(),{returnValue:!1,JYb:mb})};ca.prototype.xLf=function(Q){this.uLf(Q,!0)};ca.prototype.wLf=function(Q){this.uLf(Q,!1)};ca.prototype.uLf=function(Q,ra){var mb=ra?Object(gd.a)(this,this.xLf,"scrollToTheRight"):Object(gd.a)(this,this.wLf,"scrollToTheLeft");if(-1===this.gtc)this.gtc=Q,this.jla=window.requestAnimationFrame(mb);else{Q=Math.floor((Q-this.gtc)/1E3*300);var Qb=this.rFb>this.Vxb?1:-1;this.scrollLeft(Math.abs(this.Ik.scrollLeft-(ra?this.Mjc+Q*Qb:this.Mjc-Q*Qb))*(ra?-1:1));if(Q=this.LQe("ScrollStep"))this.VMd(ra,
Q.x+Q.width/2),ra&&!this.zFd()||!ra&&!this.yFd()?this.jla=window.requestAnimationFrame(mb):(Uc.ULS.sendTraceTag(592189588,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.hMd())}};ca.prototype.zFd=function(){var Q=this.rFb>this.Vxb;return Q&&this.Pla>=this.rFb||!Q&&this.Pla<=this.rFb};ca.prototype.yFd=function(){var Q=this.rFb>this.Vxb;return Q&&this.Pla<=this.Vxb||!Q&&this.Pla>=this.Vxb};ca.prototype.hMd=function(Q){Q=void 0===Q?!0:Q;this.Ik&&(this.Pla=
this.Ik.scrollLeft);window.cancelAnimationFrame(this.jla);this.jla=0;this.gtc=-1;Q&&this.n_()};ca.prototype.JQ=function(Q){if(this.wE&&(this.Qy||this.r8e(Q)))if(this.S2b=this.C4e(Q),this.Qy){var ra;Q=(ra=this.XP(this.kC+1))?ra.sheet:null;this.reorderSheets(Q,this.kC+1===this.TId,!0)}else Q=this.Spd?null:this.Eed,this.reorderSheets(Q,this.Spd,!0);this.xP();return!0};ca.prototype.cHd=function(Q,ra){Q||Uc.ULS.sendTraceTag(592189587,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
ra);this.Z2=Q};ca.prototype.sqi=function(Q){return 2===Q?(this.z_(3),!0):1===Q?(this.z_(0),!0):!1};ca.prototype.Cpf=function(Q){var ra=this;Uc.ULS.shipAssertTag(50385695,0,-1===this.oNa&&-1===this.nNa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.oNa&&(window.clearTimeout(this.oNa),this.oNa=-1);-1!==this.nNa&&(window.clearInterval(this.nNa),this.nNa=-1);this.z_(Q);this.oNa=window.setTimeout(function(){ra.Ykj(Q)},
this.Nji);return!0};ca.prototype.Ykj=function(Q){var ra=this;this.nNa=window.setInterval(function(){ra.z_(Q)},this.Mji)};ca.prototype.Dpf=function(){this.KVc();return!this.Qy||!this.wE};ca.prototype.KVc=function(){window.clearTimeout(this.oNa);window.clearInterval(this.nNa);this.nNa=this.oNa=-1;return!0};ca.prototype.Epf=function(Q,ra){var mb=this.zqd[ra];hd.HelperMethods.kOd(this.YJ[ra],mb,mb+Se.a.P$b,"mouseover"===Q.type||"focus"===Q.type)};ca.prototype.bwi=function(Q,ra){var mb=this.Xbc(ra),Qb=
5===ra;if("mouseup"===Q.type){if(Qb||4===ra)mb||this.reorderSheets(null,Qb,!1),this.xP()}else!this.Qy&&this.wE?(mb||this.GKd(this.zUe(Qb?this.NJ:this.Au),Qb),this.z_(Qb?2:1)):this.im||this.Epf(Q,ra)};ca.prototype.Xbc=function(Q){return!!cf.DOMElementExtensions.r9c(this.YJ[Q],"a").title};ca.prototype.Ii=function(Q,ra){ra.lK&&this.ZQd(ra.lK);this.rqc(!1);this.n_();ra.sa&&(this.ZQd(ra.sa),this.z_(6),this.fa.Pka())};ca.prototype.rwc=function(Q){this.ZQd(Q);this.n_()};ca.prototype.ojf=function(Q,ra){this.rwc(ra.item)};
ca.prototype.pjf=function(Q,ra){this.rwc(ra.item)};ca.prototype.qjf=function(Q,ra){this.rwc(ra.item)};ca.prototype.HMa=function(Q,ra){this.rwc(ra.item)};ca.prototype.ZQd=function(Q){(Q=this.Y_a(Q))&&Q.jcb()};ca.prototype.l5=function(){this.TVc()};ca.prototype.BFd=function(){var Q=this.$.Aa;if(Q.sa&&(!rf.e(this.$)||Q.count))if(Q=this.Lha(Q.sa),-1===Q)Uc.ULS.sendTraceTag(36766555,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ra=this.VIa(Q);Q<this.Au?
this.dpc(Q):Q>this.Au&&!this.rkd(ra)&&this.scrollIntoView(Q)}};ca.prototype.Ewj=function(){this.Au=0;this.NJ=this.nh.length-1;for(var Q=!1,ra=0;ra<this.nh.length;ra++){var mb=this.XP(ra);if(!mb)break;var Qb=this.rkd(mb.domElement);mb.tabIndex=Qb?0:-1;if(!Q&&Qb)this.Au=ra,Q=!0;else if(Q&&!Qb){this.NJ=ra-1;break}}};ca.prototype.dpc=function(Q){this.$.Aa.count&&(this.nh.length||this.PZc(),this.lNf(this.VIa(Math.max(0,Math.min(Q,this.nh.length-1)))),this.n_())};ca.prototype.scrollIntoView=function(Q){Uc.ULS.shipAssertTag(51446690,
0,Q>=this.Au,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.Aa.count){this.nh.length||this.PZc();var ra=this.VIa(Math.max(0,Math.min(Q,this.nh.length-1))),mb=this.VIa(this.Au);if(!this.rkd(ra)){ra=cf.DOMElementExtensions.getBoundingClientRect(ra);var Qb=cf.DOMElementExtensions.getBoundingClientRect(this.R$a);ra=this.isRtl?Qb.x-ra.x:ra.x+ra.width-(Qb.x+Qb.width);for(Qb=0;mb&&Qb<ra;){var Sc=cf.DOMElementExtensions.getBoundingClientRect(mb);
Qb+=Sc.width;mb=mb.nextSibling}mb?this.lNf(mb):Uc.ULS.sendTraceTag(50345676,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.Au,this.NJ,Q)}this.n_()}};ca.prototype.lNf=function(Q){var ra=cf.DOMElementExtensions.getBoundingClientRect(this.Ik);Q=cf.DOMElementExtensions.getBoundingClientRect(Q);this.isRtl?this.scrollLeft(Math.floor(ra.x+ra.width-(Q.x+Q.width+.5))):this.scrollLeft(Math.ceil(ra.x-
Q.x-.5))};ca.prototype.scrollLeft=function(Q){(0>Q&&this.zFd()||0<Q&&this.yFd())&&Uc.ULS.sendTraceTag(594915792,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var ra=this.Ik.scrollLeft;if(this.isRtl){if(bf.a.zE||bf.a.Pf){this.Ik.scrollLeft=this.Pla=ra-Q;return}if(bf.a.sA||bf.a.IJ){this.Ik.scrollLeft=this.Pla=ra+Q;return}Uc.ULS.sendTraceTag(594915791,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Ik.scrollLeft=this.Pla=ra-Q};ca.prototype.rkd=
function(Q){Q=cf.DOMElementExtensions.getBoundingClientRect(Q);var ra=cf.DOMElementExtensions.getBoundingClientRect(this.R$a);return Q&&ra?Q.x>=ra.x-1&&Q.x+Q.width<=ra.x+ra.width+1:(Uc.ULS.sendTraceTag(50345677,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};ca.prototype.XVg=function(){var Q=this.trc;if(ia.IRf(this.$))this.im?(Dg.a.Ia(this.SG),this.SG=new ia(Q,this.$,this,!0)):(Dg.a.Ia(this.SG),this.SG=null);else if(!this.SG||this.im)Dg.a.Ia(this.SG),
cd.k(this.$.sg)?this.SG=new Ra(Q,this.$,this):this.SG=new ia(Q,this.$,this)};ca.prototype.Kve=function(Q,ra){var mb=this.$.Aa;if(!this.$.isEditMode||!mb.count)Dg.a.Ia(ra),ra=null;else if(!ra)if(mb=this.im?this.VId:this.trc,cd.k(this.$.sg))ra=new Ra(mb,this.$,this);else switch(Q){case 0:ra=new ia(mb,this.$,this);break;case 1:ra=new Kb(mb,this.$,this);break;default:Uc.ULS.sendTraceTag(50954334,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ra};
ca.prototype.sd=function(){this.isVisible=!this.fa.isNamedObjectViewMode;this.TVc();this.PZc();ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(rf.d(this.$)||rf.e(this.$))&&(qf.PageLoadTrackingInfo.instance.qca("sheetTabBar",["sheetTabBar"]),qf.PageLoadTrackingInfo.instance.i6("sheetTabBar",["sheetTabBar"]));this.wZc();this.n_();this.zPa(!0);this.z_(6)};ca.prototype.kk=function(){this.isVisible&&(this.n_(),this.z_(6))};ca.prototype.hg=function(){Object(Jc.a)(ia,
this.SG)===cd.k(this.$.sg)&&this.wZc();for(var Q=Ml(this.nh),ra=Q.next();!ra.done;ra=Q.next())ra.value.K5i(!cd.k(this.$.sg))};ca.prototype.wZc=function(){ee.EwaSettings.ka(448)?(this.SG=this.Kve(0,this.SG),this.cvb=this.Kve(1,this.cvb)):this.XVg()};ca.prototype.zsf=function(Q,ra){this.pWi(ra.item,ra.isUserOperation)};ca.prototype.vBb=function(Q,ra){this.xsf(ra.item)};ca.prototype.onKeyDown=function(Q){switch(Q.keyCode){case 9:var ra=this.domElement.querySelectorAll(cf.DOMElementExtensions.gq),mb=
cf.DOMElementExtensions.Cl(ra);ra=cf.DOMElementExtensions.Iy(ra);cf.DOMElementExtensions.Kca(Q,mb,ra);break;case 39:case 37:cf.DOMElementExtensions.qOf(Q,this.domElement.querySelectorAll(cf.DOMElementExtensions.gq),39===Q.keyCode?!this.isRtl:this.isRtl)}Uc.ULS.sendTraceTag(579655310,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",Q.keyCode)};ca.prototype.onScroll=function(){this.Ik.scrollLeft!==this.Pla&&this.Yoj()};ca.prototype.p5=function(Q){if(Q.ctrlKey||Q.z9)return!1;this.Ik.scrollLeft+=Math.floor(30*
Q.AAa);if(this.Qy&&this.wE){var ra=this.LQe("OnMouseWheel");ra&&this.VMd(0<Q.AAa,ra.x+ra.width/2)}return!0};ca.prototype.LQe=function(Q){var ra=cf.DOMElementExtensions.getBoundingClientRect(this.TL);ra||(Uc.ULS.sendTraceTag(592740949,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",Q),this.xP());return ra};ca.prototype.RE=function(Q,ra){if(this.nsa)this.$Xe("PartialInteractivity",ra.zO?3:0);else{this.xP(!1);this.AHd(ra.zO);Q=Ml(this.Oke);for(var mb=Q.next();!mb.done;mb=
Q.next())(mb=mb.value)&&mb.AW(ra.zO);Q=Ml(this.nh);for(mb=Q.next();!mb.done;mb=Q.next())(mb=mb.value)&&mb.AW(ra.zO)}};ca.prototype.rAb=function(Q,ra){Q=0;ra.kce&&(Q=2|(ra.Abj?1:0));this.$Xe("ComponentRangePicker",Q)};ca.prototype.$Xe=function(Q,ra){this.nsa.Lxg(Q,ra);this.xP(!1);this.AHd(this.navigationButtonsDisabled);Q=Ml(this.znj);for(ra=Q.next();!ra.done;ra=Q.next())(ra=ra.value)&&ra.AW(this.navigationButtonsDisabled);Q=Ml(this.Oke);for(ra=Q.next();!ra.done;ra=Q.next())(ra=ra.value)&&ra.AW(this.operationButtonsDisabled)};
ca.lWi=function(Q,ra,mb,Qb){Q<mb?(ra>mb&&mb--,ra>Qb&&Qb--):Q>Qb?(ra<mb&&mb++,ra<Qb&&Qb++):ra<mb&&mb++;return{onh:mb,N9h:Qb}};Jl.Object.defineProperties(ca.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},he:{configurable:!0,enumerable:!0,get:function(){return Of.a.SId}},wE:{configurable:!0,enumerable:!0,get:function(){return this.AFc}},TId:{configurable:!0,enumerable:!0,get:function(){return this.nh.length}},
lrc:{configurable:!0,enumerable:!0,get:function(){return this.r9d}},yva:{configurable:!0,enumerable:!0,get:function(){return this.B1d}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.nsa&&this.nsa.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.nsa&&this.nsa.operationButtonsDisabled}},zqd:{configurable:!0,enumerable:!0,get:function(){return this.im?this.$.zI?[rb.a.h4b,rb.a.AFe,rb.a.CFe,rb.a.g4b,rb.a.Tsa,
rb.a.Tsa]:[rb.a.g4b,rb.a.CFe,rb.a.AFe,rb.a.h4b,rb.a.Tsa,rb.a.Tsa]:this.$.zI?[rb.a.h4b,rb.a.zFe,rb.a.BFe,rb.a.g4b,rb.a.Tsa,rb.a.Tsa]:[rb.a.g4b,rb.a.BFe,rb.a.zFe,rb.a.h4b,rb.a.Tsa,rb.a.Tsa]}},Bqd:{configurable:!0,enumerable:!0,get:function(){return this.$.zI?[null,h.a.lse,h.a.jse]:[null,h.a.jse,h.a.lse]}},Wxf:{configurable:!0,enumerable:!0,get:function(){return this.$.zI?[null,h.a.mse,h.a.kse]:[null,h.a.kse,h.a.mse]}},Vxb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(bf.a.zE)return 0;
if(bf.a.Pf)return-1*(this.Ik.scrollWidth-this.Ik.clientWidth);if(bf.a.Iu)return this.Ik.scrollWidth-this.Ik.clientWidth;Uc.ULS.sendTraceTag(594915794,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},rFb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(bf.a.zE)return this.Ik.scrollWidth-this.Ik.clientWidth;if(bf.a.Pf||bf.a.Iu)return 0;Uc.ULS.sendTraceTag(594915793,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Ik.scrollWidth-this.Ik.clientWidth}},
Oke:{configurable:!0,enumerable:!0,get:function(){return this.nsa?[this.SG,this.cvb]:[this.SG,this.cvb,this.HPa]}},znj:{configurable:!0,enumerable:!0,get:function(){var Q;return(Q=this.nh).concat.call(Q,this.HPa)}},ybj:{configurable:!0,enumerable:!0,get:function(){return this.q9d}}});Object(Le.a)(ca,"SheetTabBarControl",ch.a,[622,7,135]);var Ef=Kf.a;Cm(Ha,Ef);Ha.prototype.create=function(){var Q=this,ra=this.$.Mb;if(!Ch.a(this.$.Ba,1)){var mb=document.getElementById(ra+Se.a.T_c);mb&&(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&qf.PageLoadTrackingInfo.instance.Qya(Se.a.Gbj),mf.a.Ejd()?eg.TaskExtensions.Da(ng.GetServiceTaskFactory.Xa(this.$.ea,388,387,this.vb,"Microsoft.Office.Excel.WebUI.Client.SvgIconProvider.ISvgIconProvider"),function(Qb){Q.Jb(Q.$.ea.Ea(32,void 0)||new ca(Q.$,mb,Qb.result))},this.$.ma,3):this.Jb(this.$.ea.Ea(32,void 0)||new ca(this.$,mb)))}};Ha.la=function(Q){Q.ea.La(33,new Ha(Q))};Object(Le.a)(Ha,"SheetTabBarFactory",Kf.a,[]);var sh=b(51),Jg=b(181);Gb.prototype.NMa=function(){Jg.a.instance.wCd(Object(gd.a)(this,
this.NMa,"onSessionExpiredDetected"));Uc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.LOh()};Gb.prototype.jsf=function(){Jg.a.instance.vCd(Object(gd.a)(this,this.jsf,"onSessionExpiringDetected"));this.g9d||this.RKc||(Uc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.g9d=!0,this.Ahj())};Gb.prototype.LOh=function(){this.RKc||(ce.AFrameworkApplication.dF(sh.a.OMf),this.RKc=!0,this.zhj())};Object(Le.a)(Gb,"ASessionExpirationManager",null,
[]);var gh=b(243),ah=b(6),Wh=b(80),zh=b(244);Cm(nb,Gb);nb.prototype.Dfe=function(Q){this.Qa.addHandler("SessionExpired",Q)};nb.prototype.AVb=function(Q){this.Qa.addHandler("TokenRefreshed",Q)};nb.prototype.lCd=function(Q){this.Qa.removeHandler("TokenRefreshed",Q)};nb.prototype.X9b=function(){return Jg.a.instance.mQ(ce.AFrameworkApplication.qk)};nb.prototype.dispose=function(){Dg.a.Ia(this.Qa);this.$=null};nb.prototype.Ahj=function(){this.$.isEditMode&&this.x9b(!1)};nb.prototype.zhj=function(){this.jjb=
!0;this.x9b(!0);this.Qa.raiseEvent("SessionExpired")};nb.prototype.x9b=function(Q){var ra=this;Uc.ULS.sendTraceTag(19981001,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",Q,this.$.fa.P$);var mb=this.$.Db.vp;Q&&mb&&mb.isVisible&&1299163859===mb.error.MessageId&&this.$.Db.vp.su();var Qb=this.Ad(Q);bh.a(this.$).Nr(new gh.a(ah.a.xx,5,function(){var Sc=Zg.a(ra.$),Ad=Sc.ld.activityState;Ad[Wh.a.HX]=ra.$.emb(ra.$.isEditMode);Ad[Wh.a.AI]=
Wh.a.W5a;Ad[zh.a.kp]=ah.a.accessTokenExpiringWarning;Sc.ld.it([Qb])}))};nb.prototype.Ad=function(Q){return Q?Yh.a.fwe():this.BXg()};nb.prototype.BXg=function(){var Q=Yh.a.Ad(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");Q.Description=this.accessTokenExpiringMessage;return Q};Jl.Object.defineProperties(nb.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var Q=(new Date(this.qk)).format(this.$.Ba.ShortTimeFormat);return String.format(Tc.a.instance.Eb(77),Q)}},
tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.jjb}},U$a:{configurable:!0,enumerable:!0,get:function(){return!1}},Kaa:{configurable:!0,enumerable:!0,get:function(){return!1}},uAd:{configurable:!0,enumerable:!0,get:function(){return!1}},D4:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Le.a)(nb,"EwaAccessTokenExpirationManager",Gb,[522,523,7]);var Te=b(194),Th=b(676);Object(Le.a)(sb,"RefreshAccessTokenContext",null,[]);var V=b(174),Pa=b(117),Ib=b(134),wc=
b(33),nd=b(115);Object(Le.a)(ib,"Error",null,[]);Object(Le.a)(Oa,"NamedResult",null,[]);Cm(xa,Oa);Object(Le.a)(xa,"ErrorInfo",Oa,[]);Jl.Object.defineProperties(na.prototype,{tokens:{configurable:!0,enumerable:!0,get:function(){return this.BTb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.dS}}});Object(Le.a)(na,"TokenRefreshArgs",null,[542]);ma.prototype.Dfe=function(Q){this.Qa.addHandler("SessionExpired",Q)};ma.prototype.AVb=function(Q){this.Qa.addHandler("TokenRefreshed",Q)};
ma.prototype.lCd=function(Q){this.Qa.removeHandler("TokenRefreshed",Q)};ma.prototype.X9b=function(){return Jg.a.instance.mQ(ce.AFrameworkApplication.qk)};ma.prototype.dispose=function(){Jg.a.instance.wCd(Object(gd.a)(this,this.rYe,"handleTokenExpired"));Jg.a.instance.vCd(Object(gd.a)(this,this.VXe,"handleOnTokenExpiring"));var Q=this.$.fa;Q&&(Q.xk(Object(gd.a)(this,this.ed,"onSessionIdChanged")),Q.mnc(Object(gd.a)(this,this.axa,"onOpenWorkbookFailed")));Dg.a.Ia(this.Qa);this.documentVisibilityObserver=
this.$=null};ma.prototype.eZf=function(){return this.X9b()?0:(ce.AFrameworkApplication.qk-(new Date).getTime())/6E4};ma.prototype.H3f=function(Q,ra){if(0<ra&&!this.X9b()){var mb=ce.AFrameworkApplication.ha.qd("AccessTokenExpirationPromptSeconds",ce.AFrameworkApplication.DX),Qb=(ra-Q.getTime())/6E4;Uc.ULS.shipAssertTag(591687890,0,0<=Qb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",
ra,Q.getTime(),Qb);Qb<this.$hi?(Uc.ULS.sendTraceTag(591687889,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.hRf,Qb),ce.AFrameworkApplication.DX=this.hRf):ce.AFrameworkApplication.DX!==mb&&(Uc.ULS.sendTraceTag(591687888,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",mb,Qb),ce.AFrameworkApplication.DX=mb)}};
ma.prototype.TRg=function(Q){return!this.context||this.context.RDb||this.context.YZc!==Q?(Q=new sb(Te.a.create().toString(),Q),this.context&&!this.context.Iuc&&Uc.ULS.sendTraceTag(594596952,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",Q.correlationID,this.context.correlationID,this.context.RDb),this.XR=Q,!0):!1};ma.prototype.VXe=function(){if(!this.I5b||this.I5b&&this.$.fa.pc)this.sYe(!1);
else if(this.Tnd){this.Tnd=!1;var Q=Zg.a(this.$);Uc.ULS.sendTraceTag(572019857,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",Q.pi?Q.pi.activityName:"None",this.eZf())}};ma.prototype.ed=function(Q,ra){this.context&&(Q=this.$.fa,ra.TG&&this.context.RDb&&!this.context.Iuc?(this.context.Iuc=!0,ra={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ra.IsUserActive=
Q.Ff.Tq,ra.RefreshAccessTokenCorrelationID=this.context.correlationID,ra=We.a.Oc(ra),Uc.ULS.sendTraceTag(594596951,0,50,ra)):this.I5b&&this.dib&&!Q.pc&&!this.context.YZc&&(ra={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Yw&&(this.Yw.C(),ra.Aborted=!0,ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(ra.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Jab=!1)),ra.TimeUntilTokenExpirationInMin=
this.eZf(),ra.RefreshAccessTokenCorrelationID=this.context.correlationID,ra=We.a.Oc(ra),Uc.ULS.sendTraceTag(572019856,0,50,ra)))};ma.prototype.axa=function(){if(this.context&&this.context.RDb&&!this.context.Iuc){var Q={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Q.CreatedForExpired=this.context.YZc;Q.RefreshAccessTokenCorrelationID=this.context.correlationID;Q.OpenWorkbookErrors=Yh.a.fd(this.$.fa.XE);Q.ExecutionContextErrors=Yh.a.fd(Zg.a(this.$).ld.errors);Q.accesstokenTTL=
ce.AFrameworkApplication.qk;Q=We.a.Oc(Q);Uc.ULS.sendTraceTag(594596950,0,15,Q)}};ma.prototype.rYe=function(){this.Jab=!1;this.sYe(!0)};ma.prototype.DYi=function(Q){Q&&this.qG&&!this.Kaa&&this.$.fa.Ff.Tq&&!this.D4&&(this.qG=!1)};ma.prototype.sYe=function(Q){var ra=this;this.DYi(Q);if(!(this.dib||this.Jab&&!Q||this.qG)&&this.U$a){this.dib=!0;var mb=this.context?this.context.creationTime:null,Qb=this.TRg(Q);this.Tnd=!0;var Sc=this.$.fa,Ad={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",
newContextCreated:Qb};Ad.IsUserActive=Sc.Ff.Tq;Ad.IsSessionActive=Sc.pc;Ad.ContainsChangesWorkbookOperations=this.$.userOperationManager.KFa();Ad.isSessionExpired=Q;Ad.stopRefreshRetriesUntilTokenExpired=this.Jab;Ad.FailedToRefreshExpiredToken=this.qG;Ad.numOfFailuresWhileUserIsActive=nd.a.f5;Ad.numOfFailuresWhileUserIsInActive=nd.a.g5;Ad.numOfFailuresWhileOffline=nd.a.Dwa;Ad.RefreshAccessTokenCorrelationID=this.context.correlationID;Qb&&mb&&(Ad.TimeInMinFromPreviosContextCreation=Math.round(Pa.b(Bh.a.Ta,
mb)/60));mb=We.a.Oc(Ad);Uc.ULS.sendTraceTag(40416199,0,50,mb);this.sAd.start();this.O1d=Sc.Ff.Tq;this.Yw=new Th.a;this.gai(Q);var ye=this.oOd.pPi(!Q,this.Yw?this.Yw.token:null);ye.continueWith(function(){ra.dLg();var Ze=ra.oOd.HJi(ye);ra.sAd.stop();var sd=ra.X9b();if(!Ze||ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&sd){var pe=ye.result.errors;Ze&&sd&&ra.yog(pe);ra.vOh(pe,Q)}else ra.Jab=!1,ra.wOh(ye.result.tokens,Q);ra.dib=!1},this.I5b?8:0)}};ma.prototype.yog=
function(Q){var ra=[Object.assign(new ib,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];Q.add(Object.assign(new xa,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ra}))};ma.prototype.gai=function(Q){Q&&(this.$.fa.Ff.Tq?this.KVf():(this.$.fa.Ff.pqa(Object(gd.a)(this,this.Qud,"onUserActivityThrottledDetected")),this.XDb=!0))};ma.prototype.KVf=function(){var Q=this;this.mmc=V.AsyncMethodContext.kx(function(){Q.oPi()},1E3*this.GCf,ed.a.ZOi,this.mmc)};ma.prototype.Qud=
function(){this.XDb&&(this.$.fa.Ff.kya(Object(gd.a)(this,this.Qud,"onUserActivityThrottledDetected")),this.XDb=!1);this.KVf()};ma.prototype.dLg=function(){this.mmc&&this.mmc.cancel();this.XDb&&(this.$.fa.Ff.kya(Object(gd.a)(this,this.Qud,"onUserActivityThrottledDetected")),this.XDb=!1);this.Yw=null};ma.prototype.oPi=function(){Uc.ULS.sendTraceTag(589137505,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.GCf);this.Yw.C()};ma.prototype.vOh=
function(Q,ra){this.Jab=!0;ra&&(this.qG||(this.jjb=this.qG=!0),this.oOd.Jcc(Q)&&(this.n2d=!0));var mb=!ra||this.U$a&&!nd.a.Lrc?40380379:39982555;ra=this.Rue(ra);ra.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ra.FailedToRefreshExpiredToken=this.qG;ra.LastErrorIsPermanent=this.D4;if(0<Q.count){var Qb=Q.oa(0);ra.errorName=Qb.Name;0<Qb.Errors.length&&(ra.ErrorId=Qb.Errors[0].Id,Qb=Qb.Errors[0].Details,ra.ErrorDetails=this.Z4g(Qb.toString())?"PiiScrubbed":Qb)}ra=We.a.Oc(ra);Uc.ULS.sendTraceTag(mb,
0,15,ra);this.Qa.raiseEvent("TokenRefreshed",new na(null,Q))};ma.prototype.Z4g=function(Q){return Ud.a.contains(Q,"makes the internet safe for businesses",!0)};ma.prototype.Rue=function(Q){var ra={},mb=this.$.fa;ra.Name="";ra.IsUserActive=mb.Ff.Tq;ra.IsSessionActive=mb.pc;ra.GotDeploymentOrTimedOutError=mb.P$;ra.TimeInSecFromLastStatefulSuccessfulRequest=mb.P6;ra.TimeFromLastUserActivityInMs=mb.Ff.lbb;ra.calledFromSessionExpiredFlow=Q;ra.RefreshTokenDurationInMS=this.sAd.Gc;ra.numOfFailuresWhileUserIsActive=
nd.a.f5;ra.numOfFailuresWhileUserIsInActive=nd.a.g5;ra.numOfFailuresWhileOffline=nd.a.Dwa;ra.RefreshAccessTokenCorrelationID=this.context.correlationID;ra.accessTokenTTL=ce.AFrameworkApplication.qk;ra.ContainsChangesWorkbookOperations=this.$.userOperationManager.KFa();ra.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.mj.toString():"Unknown";ra.TimeFromFirstOpenInHr=Math.floor(Pa.b(Bh.a.Ta,qi.toUtc(mb.evf))/3600);return ra};ma.prototype.wOh=function(Q,ra){this.qG=
!1;this.bzj();this.H3f(new Date,ce.AFrameworkApplication.qk);var mb=this.$.fa,Qb=!ra&&mb.Ff.Tq,Sc=!this.$.isEditMode&&mb.B8a;ra=this.Rue(ra);ra.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ra.shouldTriggerSilentReloadAfterExpiring=Qb;ra.WopiTokenTaskItemPriority=ce.AFrameworkApplication.DSd;ra.isDirtyViewSession=Sc;ra=We.a.Oc(ra);Uc.ULS.sendTraceTag(39982556,0,15,ra);this.Qa.raiseEvent("TokenRefreshed",new na(Q,null));Sc?mb.Ff.Tq&&(Uc.ULS.sendTraceTag(594596949,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
mb.P6c()):mb.Ff.Tq?Qb&&(Q=Zg.a(this.$).ld.activityState,Q[nd.a.Cbb]=!0,Q[Ib.a.GX]=!0,Q[wc.a.qr]=this.$.isEditMode,bh.a(this.$).Nr(new gh.a(ah.a.Xla,2,null))):mb.pc&&Gh.m(this.$.ra.xa,!0,!1,!1,null,null,null,null,null)};ma.prototype.bzj=function(){void 0!==this.$.fa.workbookContext.WorkbookUri&&null!==this.$.fa.workbookContext.WorkbookUri?(this.$.fa.workbookContext.WorkbookUri=ld.a.HS(this.$.fa.workbookContext.WorkbookUri,ce.AFrameworkApplication.yO,ce.AFrameworkApplication.accessToken),this.$.fa.workbookContext.WorkbookUri=
ld.a.HS(this.$.fa.workbookContext.WorkbookUri,ce.AFrameworkApplication.EX,ce.AFrameworkApplication.qk.toString()),this.$.fa.Ejc()):Uc.ULS.sendTraceTag(594596948,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.Ba.AccessToken=ce.AFrameworkApplication.accessToken;this.$.Ba.AccessTokenValidTo=ce.AFrameworkApplication.qk;void 0!==this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion=
ld.a.HS(this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion,ce.AFrameworkApplication.yO,ce.AFrameworkApplication.accessToken),this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion=ld.a.HS(this.$.Ba.DocumentHostInfo.QuerySignatureWithoutVersion,ce.AFrameworkApplication.EX,ce.AFrameworkApplication.qk.toString()));void 0!==this.$.Ba.EmbedConfiguratorUrl&&null!==this.$.Ba.EmbedConfiguratorUrl&&(this.$.Ba.EmbedConfiguratorUrl=ld.a.HS(this.$.Ba.EmbedConfiguratorUrl,ce.AFrameworkApplication.yO,ce.AFrameworkApplication.accessToken),
this.$.Ba.EmbedConfiguratorUrl=ld.a.HS(this.$.Ba.EmbedConfiguratorUrl,ce.AFrameworkApplication.EX,ce.AFrameworkApplication.qk.toString()));this.context.RDb=!0};Jl.Object.defineProperties(ma.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.jjb}},Kaa:{configurable:!0,enumerable:!0,get:function(){return this.O1d}},D4:{configurable:!0,enumerable:!0,get:function(){return this.n2d}},context:{configurable:!0,enumerable:!0,get:function(){return this.XR}},U$a:{configurable:!0,
enumerable:!0,get:function(){return this.D4?!1:this.$.fa.Ff.Tq?1>nd.a.f5:6>nd.a.g5}},uAd:{configurable:!0,enumerable:!0,get:function(){return this.dib}}});Object(Le.a)(ma,"EwaAccessTokenExpirationRefreshManager",null,[522,523,7]);Sa.DUb="ActivityDuration";Sa.error="Error";Sa.P9g="Errors";Sa.failed="Failed";Sa.bnh="FirstActivity";Sa.initialized="Initialized";Sa.z9h="LastActivity";Sa.e_i="RetryOverride";Sa.cYi="RequestGroups";Sa.requests="Requests";Sa.KIf="Responses";Sa.Wpc="SessionDuration";Sa.status=
"Status";Sa.success="Success";Sa.tokens="Tokens";Object(Le.a)(Sa,"SessionExpirationStrings",null,[]);oa.prototype.o6f=function(){var Q={};Uc.ULS.sendTraceTag(41964821,217,50,Uc.ULS.Oc((Q.Aggregate=this.WW,Q.Current=this.Ao,Q)))};oa.prototype.VVh=function(){this.WW[Sa.cYi]=0;this.WW[Sa.requests]=0;this.WW[Sa.KIf]=0;this.WW[Sa.status]=Sa.initialized;this.WW[Sa.bnh]=new Date;this.WW[Sa.Wpc]=0;this.WW[Sa.DUb]=0;this.WW[Sa.Wpc]=0;this.Ao[Sa.Wpc]=0;this.WW[Sa.DUb]=0;this.Ao[Sa.DUb]=0};oa.prototype.Aed=
function(Q,ra){var mb=Q[ra];mb=mb?mb:0;mb++;Q[ra]=mb;this.sHd(Q)};oa.prototype.sHd=function(Q){var ra=new Date;Q[Sa.DUb]=+ra-+this.eQb;this.eQb=ra;Q[Sa.Wpc]=+this.eQb-+this.jjg;Q[Sa.z9h]=this.eQb};oa.prototype.B$a=function(Q,ra){this.Ao[Q]=ra;this.sHd(this.Ao)};oa.prototype.KNf=function(Q,ra){this.Ao[Q]=ra;this.sHd(this.Ao)};oa.prototype.incrementCounter=function(Q){this.Aed(this.Ao,Q);this.Aed(this.WW,Q);this.Aed(this.xhg,Q)};oa.prototype.flush=function(){this.J1d||(this.WW[Sa.status]=this.Ao[Sa.status],
this.o6f(this.sTb),this.re.Cla(this.sTb,6E4*this.qcf))};oa.prototype.stop=function(){Uc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.J1d=!0;this.re.xp(this.sTb)};Object(Le.a)(oa,"SessionLogger",null,[544]);var Bd=b(1057);ha.prototype.fui=function(Q){if(Q.MessageId!==sa.a.Idd)ac.a(39408099,306,15,"Unexpected message.");else{var ra=new Og.a,mb=new Og.a;this.Kj.incrementCounter(Sa.KIf);var Qb=Q.Values[Yb.a.RMf];if(!Qb||0>=Qb.length)ac.a(40122317,306,
15,"Found no tokens in the dictionary"),Qb=Q.Values;ac.a(40122318,306,100,"The Tokens array contains {0} tokens",Qb.length);this.Kj.B$a("Correlation",Q.CorrelationId);for(var Sc=null,Ad=0;Ad<Qb.length;Ad++){this.Kj.KNf(Sa.tokens,Qb.length);var ye=Qb[Ad],Ze=ye;if(Ze&&Ze.Name){this.Kj.incrementCounter(Ze.Name);var sd=ye;sd&&sd.Value?(ac.a(39408128,306,100,"Received token with name: {0}",sd.Name),ra.add(sd),this.BTb.add(sd),this.Kj.B$a(Sa.status,Sa.success)):(ac.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Ze.Name,JSON.stringify(ye),this.sfa),mb.add(ye),this.dS.add(ye),Sc=ye,this.Kj.B$a(Sa.error,JSON.stringify(ye)),this.Kj.B$a(Sa.status,Sa.failed))}}0<mb.count&&Sc?(Qb=Object.assign(new Bg.a,{extendedProperties:new Map}),Qb.extendedProperties.set("Errors",this.xJh(Sc)),lf.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Qb)):lf.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ac.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
ra.count,mb.count,Q.CorrelationId,this.sfa);0<mb.count&&!this.Jcc(mb)?(Q=this.p8.GGh(mb),Q!==this.p8.oEd&&(this.Kj.KNf(Sa.e_i,Q),this.re.Cla(this.Oi,Q))):(this.Kj.flush(),this.Oi&&(ac.a(39408131,306,100,"Deleting task {0} from task manager",this.Oi.name),this.re.xp(this.Oi)),this.Ul&&!this.Ul.task.isCompleted&&this.Ul.setResult(new na(ra,mb)))}};ha.prototype.requestTokensOnce=function(){this.THf()};ha.prototype.THf=function(){this.Dpa>=this.p8.Ngi?(ac.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.sfa),this.Xue(this.Ul,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(lf.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.P3i())};ha.prototype.P3i=function(){var Q={};Q[Yb.a.RMf]=this.p8.tokens;var ra=Te.a.create().toString();ac.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.p8.tokens),this.Dpa+1,ra,this.sfa);this.B6d.execute(function(mb){mb.Yj(sa.a.Lhe,
Q,ra)});this.Dpa++;this.Kj.incrementCounter(Sa.requests)};ha.prototype.Xue=function(Q,ra,mb){for(var Qb=new Og.a,Sc=0;Sc<this.p8.tokens.length;Sc++){var Ad=Object.assign(new xa,{Name:this.p8.tokens[Sc],Errors:[Object.assign(new ib,{Id:ra,Details:mb})]});Qb.add(Ad);this.dS.add(Ad)}this.re.xp(this.Oi);this.Kj.B$a(Sa.P9g,JSON.stringify(this.dS));this.Kj.B$a(Sa.status,Sa.failed);Q&&!Q.task.isCompleted&&Q.setResult(new na(new Og.a,this.dS))};ha.prototype.pPi=function(Q,ra){var mb=this;ra=void 0===ra?null:
ra;this.cae.start();this.WPb=Q;this.sfa=Te.a.create().toString();ac.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.sfa,this.WPb);this.Dpa=0;this.dS.clear();this.BTb.clear();var Qb=new Ge.a;this.Ul=Qb;ra&&ra.R(function(){var Sc=!!Qb&&!Qb.task.isCompleted;ac.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",mb.sfa,mb.WPb,Sc);Sc&&mb.Xue(Qb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});
this.Oi=new xc.a(this.p8.priority,2,this.p8.oEd,Object(gd.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,sa.a.Lhe,!0);this.cjg&&this.THf();this.re.sh(this.Oi);return this.Ul.task};ha.prototype.HJi=function(Q){this.cae.stop();var ra=this.HPh(Q.result.errors);Uc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!ra,this.sfa,this.WPb,
this.Dpa,this.dS.count,0<Q.result.errors.count?Q.result.errors.oa(0).Name:"",0<Q.result.errors.count&&0<Q.result.errors.oa(0).Errors.length?Q.result.errors.oa(0).Errors[0].Id:"",0<Q.result.errors.count&&0<Q.result.errors.oa(0).Errors.length?Q.result.errors.oa(0).Errors[0].Details:"");return ra?!1:this.GJi(Q.result.tokens)};ha.prototype.Jcc=function(Q){return this.p8.Jcc(Q)};ha.prototype.GJi=function(Q){for(var ra=0;ra<Q.count;ra++){var mb=Q.oa(ra);if(mb.Name===Yb.a.accessToken){var Qb=(new Date).getTime();
if(mb.Expiry>ce.AFrameworkApplication.qk){var Sc={};Uc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(Sc.AccessTokenTtl=mb.Expiry,Sc.NowGetTime=Qb,Sc.BootTime=ce.AFrameworkApplication.oga,Sc),"PreviousAccessTokenTtl",ce.AFrameworkApplication.qk);ce.AFrameworkApplication.accessToken=mb.Value;ce.AFrameworkApplication.qk=Math.floor(mb.Expiry);ce.AFrameworkApplication.BSd=Qb;ce.AFrameworkApplication.GVa=Math.floor(mb.Expiry)}else Sc={},Uc.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
(Sc.AccessTokenTtl=mb.Expiry,Sc.NowGetTime=Qb,Sc.BootTime=ce.AFrameworkApplication.oga,Sc),"PreviousAccessTokenTtl",ce.AFrameworkApplication.qk)}}return!0};ha.prototype.HPh=function(Q){for(var ra=!1,mb=0;mb<Q.count;mb++){ra=!0;var Qb=Q.oa(mb);Uc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Qb.Name,JSON.stringify(Qb.Errors),this.sfa)}return ra};ha.prototype.xJh=function(Q){var ra=new Og.a;Q=Ml(Q.Errors);for(var mb=Q.next();!mb.done;mb=Q.next()){mb=mb.value;
var Qb={};Qb.Id=mb.Id;Qb.Details=mb.Details;ra.add(Qb)}return JSON.stringify(ra)};Object(Le.a)(ha,"TokenRefreshManager",null,[521]);ba.prototype.Jcc=function(Q){Q=JSON.stringify(Q);if(this.mNc&&0<this.mNc.length)for(var ra=Ml(this.mNc),mb=ra.next();!mb.done;mb=ra.next())if(mb=mb.value,0<mb.length&&0<=Q.indexOf(mb))return!0;return!1};ba.prototype.GGh=function(Q){try{if(Q)for(var ra=Ml(Q),mb=ra.next();!mb.done;mb=ra.next()){var Qb=mb.value;if(Qb.Errors)for(var Sc=Ml(Qb.Errors),Ad=Sc.next();!Ad.done;Ad=
Sc.next()){var ye=Ad.value;if(ye.Id in this.O7d)return Number.parseInvariant(this.O7d[ye.Id].toString());if(this.CFc)try{if(500<=Number.parseInvariant(ye.Id))return this.R7d}catch(Ze){Uc.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",Ze.toString(),ye.Id)}}}}catch(Ze){Uc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ze.toString())}return this.oEd};ba.prototype.r9i=function(){var Q={};try{if(!ce.AFrameworkApplication.m9b()||
0>=ce.AFrameworkApplication.m9b().length||""===ce.AFrameworkApplication.m9b()[0])return Q;for(var ra=Ml(ce.AFrameworkApplication.m9b()),mb=ra.next();!mb.done;mb=ra.next()){var Qb=mb.value;0<Qb.length&&(Q[Qb]=ce.AFrameworkApplication.DCj)}}catch(Sc){Uc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Sc.toString())}return Q};Object(Le.a)(ba,"TokenRefreshPolicy",null,[520]);var yd=Kf.a;Cm(R,yd);R.prototype.create=function(){ce.AFrameworkApplication.uQ("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
ce.AFrameworkApplication.ha.ta("RefreshAccessTokenSilently")?this.Jb(this.OTg()):this.Jb(this.$.ea.Ea(38,void 0)||this.$.ea.La(38,new nb(this.$)))};R.prototype.OTg=function(){var Q=this.$.ea.Ea(38,void 0);if(Q)return Q;Q=new ha(ce.AFrameworkApplication.$j,ce.AFrameworkApplication.$Y(),new ba);return this.$.ea.La(38,new ma(this.$,Q))};R.la=function(Q){Q.ea.La(39,new R(Q))};Object(Le.a)(R,"AccessTokenExpirationManagerFactory",Kf.a,[]);var re=uf.a;Cm(ja,re);ja.prototype.Hug=function(Q){this.addHandler("TAF",
Q)};ja.prototype.KVi=function(Q){this.removeHandler("TAF",Q)};ja.prototype.qLi=function(){this.raiseEvent("TAF")};Object(Le.a)(ja,"GridHighlightBehaviorEventManager",uf.a,[226,7]);var xe=Kf.a;Cm(X,xe);X.prototype.create=function(){this.Jb(this.$.ea.Ea(376,void 0)||new ja(this.$))};X.la=function(Q){Q.ea.La(377,new X(Q))};Object(Le.a)(X,"GridHighlightBehaviorEventManagerFactory",Kf.a,[]);var Re=b(122),Tf=Sys.EventArgs;Cm(ea,Tf);Object(Le.a)(ea,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);
var ag=uf.a;Cm(P,ag);P.prototype.etg=function(Q){this.addHandler("mrek",Q)};P.prototype.UV=function(Q,ra,mb){for(var Qb=Ml(this.gridView.uo),Sc=Qb.next();!Sc.done;Sc=Qb.next())Rc.a.instance.qa(Kc.a.Jh,Sc.value.domElement,Q);Rc.a.instance.qa(Kc.a.de,document.documentElement,ra);this.gridView.zc.y3b(!0);mb&&Rc.a.instance.qa(Kc.a.$y,this.gridView.Pi,ra)};P.prototype.PPd=function(Q,ra,mb){for(var Qb=Ml(this.gridView.uo),Sc=Qb.next();!Sc.done;Sc=Qb.next())Rc.a.instance.Ca(Kc.a.Jh,Sc.value.domElement,Q);
Rc.a.instance.Ca(Kc.a.de,document.documentElement,ra);this.gridView.zc.y3b(!1);mb&&Rc.a.instance.Ca(Kc.a.$y,this.gridView.Pi,ra)};P.prototype.dQi=function(Q,ra){for(var mb=Ml(this.gridView.uo),Qb=mb.next();!Qb.done;Qb=mb.next())yg.a.instance.qa(Kc.a.Og,Qb.value.domElement,Q);yg.a.instance.qa(Kc.a.Ge,document.documentElement,ra)};P.prototype.Euj=function(Q,ra){for(var mb=Ml(this.gridView.uo),Qb=mb.next();!Qb.done;Qb=mb.next())yg.a.instance.Ca(Kc.a.Og,Qb.value.domElement,Q);yg.a.instance.Ca(Kc.a.Ge,
document.documentElement,ra)};P.prototype.Tue=function(Q,ra,mb,Qb){var Sc=document.createElement("div");Sc.className=ra;ra=Ml(mb);for(mb=ra.next();!mb.done;mb=ra.next())Sys.UI.DomElement.addCssClass(Sc,mb.value);Q.appendChild(Sc);Rc.a.instance.qa(Kc.a.pointerDown,Sc,Qb);return Sc};P.prototype.gUe=function(Q){Q=Q.Wb.parentNode;if(!Q)return Uc.ULS.shipAssertTag(590751830,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;Q=parseInt(Q.getAttribute(Se.a.Kub));
return isNaN(Q)?(Uc.ULS.shipAssertTag(590751829,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Sb.sJ(3,1,Q)};P.prototype.WGb=function(Q,ra,mb){Q=(void 0===mb?!0:mb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.h3h(Q);ra=Ml(ra);for(mb=ra.next();!mb.done;mb=ra.next())cf.DOMElementExtensions.setVisible(mb.value,Q)};P.prototype.M7c=function(){return this.gridView.Zi?Re.a(this.gridView.$):this.gridView.Hc};
P.prototype.YBf=function(){var Q=this.M7c();Q&&this.coloredReferencesManager?this.coloredReferencesManager.DW(Q,null):(Uc.ULS.sendTraceTag(590751828,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Sb.ll(this.Kef),this.gridView.Sb.qm(null,this.Kef))};P.prototype.zAf=function(Q,ra){this.raiseEvent("mrek",new ea(Q,ra))};Jl.Object.defineProperties(P.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,
get:function(){var Q=this.gridView.$.ea.Ea(281,void 0);Q||Uc.ULS.sendTraceTag(590751831,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return Q}}});Object(Le.a)(P,"BehaviorHelperMethods",uf.a,[]);var Qg=Kg.a;Cm(L,Qg);L.prototype.xWa=function(){};Object(Le.a)(L,"HighlightFlyweightBehavior",Kg.a,[]);var Rg=b(462),Hh=b(121),Fg=b(10),
Xg=b(78),cg=ch.a;Cm(Y,cg);Y.prototype.bfe=function(Q){this.addHandler("GrDrag",Q)};Y.prototype.wFf=function(Q){this.removeHandler("GrDrag",Q)};Y.prototype.afe=function(Q){this.addHandler("GrContxt",Q)};Y.prototype.vFf=function(Q){this.removeHandler("GrContxt",Q)};Y.prototype.cfe=function(Q){this.addHandler("GrPointerUp",Q)};Y.prototype.xFf=function(Q){this.removeHandler("GrPointerUp",Q)};Y.prototype.dispose=function(){Gf.a.rla(this.domElement);cg.prototype.dispose.call(this)};Y.prototype.c3f=function(Q){this.domElement.parentNode.removeChild(this.domElement);
Q.appendChild(this.domElement)};Y.prototype.hNf=function(){Sys.UI.DomElement.removeCssClass(this.domElement,Xg.a.w4b);Sys.UI.DomElement.removeCssClass(this.jJa,Xg.a.v4b);Sys.UI.DomElement.addCssClass(this.jJa,Xg.a.NHe)};Y.prototype.t1f=function(){Sys.UI.DomElement.removeCssClass(this.jJa,Xg.a.NHe);Sys.UI.DomElement.addCssClass(this.jJa,Xg.a.v4b);Sys.UI.DomElement.addCssClass(this.domElement,Xg.a.w4b)};Y.prototype.onPointerDown=function(Q){Q=Nf.a(this.$)?Nf.a(this.$).Qe(Q):Q;this.nLb=!1;if(3===(zg.a.Yb=
Q.Cb)){var ra=Q.Ga.rawEvent,mb=ra.srcElement||ra.target;cf.DOMElementExtensions.jf(this.domElement,mb)&&cf.DOMElementExtensions.jf(ra.currentTarget,mb)&&(this.nLb=!0,this.e1b=Q.clientPoint)}return!1};Y.prototype.Hh=function(Q){Q=Nf.a(this.$)?Nf.a(this.$).Qe(Q):Q;this.raiseEvent("GrPointerUp",Q);return this.nLb=!1};Y.prototype.vk=function(Q){Q=Nf.a(this.$)?Nf.a(this.$).Qe(Q):Q;3===Q.Cb&&this.nLb&&this.VPh(Q.clientPoint)&&(this.raiseEvent("GrDrag"),this.nLb=!1);return!1};Y.prototype.Yc=function(Q){Nf.a(this.$)&&
Nf.a(this.$).Qe(Q);return!0};Y.prototype.VPh=function(Q){return!!this.e1b&&(3<Math.abs(Q.x-this.e1b.x)||3<Math.abs(Q.y-this.e1b.y))};Y.Wrb=function(Q){var ra=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1),mb=bf.a.tf;return ra&&!mb?(Q=Nf.a(Q.$)?Nf.a(Q.$).zoom:Fg.a.mV,Math.round(9/Math.max(Q,1))):9};Y.Qod=0;Object(Le.a)(Y,"TouchGrippie",ch.a,[]);Cm(fa,L);fa.prototype.dispose=function(){Dg.a.rc([this.SN,this.vL]);this.SN.wFf(Object(gd.a)(this,this.Jtf,"onTopGrippieDrag"));
this.SN.vFf(Object(gd.a)(this,this.nic,"onGrippieContextMenu"));this.SN.xFf(Object(gd.a)(this,this.oic,"onGrippiePointerUp"));this.vL.wFf(Object(gd.a)(this,this.ikf,"onBottomGrippieDrag"));this.vL.vFf(Object(gd.a)(this,this.nic,"onGrippieContextMenu"));this.vL.xFf(Object(gd.a)(this,this.oic,"onGrippiePointerUp"));for(var Q=Ml(this.gridView.uo),ra=Q.next();!ra.done;ra=Q.next())ra=ra.value,yg.a.instance.Ca(Kc.a.Hf,ra.domElement,Object(gd.a)(this,this.Tnf,"onGridViewTouchStart")),yg.a.instance.Ca(Kc.a.Ge,
ra.domElement,Object(gd.a)(this,this.Snf,"onGridViewTouchEnd"));this.gridView.view.Tr(Object(gd.a)(this,this.jw,"onVisibleAreaChanged"));this.gridView.Hc.mm(Object(gd.a)(this,this.vBe,"editStarted"));this.gridView.Sb.HEb(Object(gd.a)(this,this.exa,"onSelectionHighlightChanged"));this.gridView.qEb(Object(gd.a)(this,this.Wjf,"onBeforeActiveItemCleanUp"));this.gridView.$.AH(Object(gd.a)(this,this.Olc,"reDrawGrippies"));this.gridView.Ps(Object(gd.a)(this,this.Olc,"reDrawGrippies"));this.ga.q_(Object(gd.a)(this,
this.Ih,"onSelectionEnded"));this.ga.oca(Object(gd.a)(this,this.sq,"onSelectionStarted"));this.gridView.aF(Object(gd.a)(this,this.Uo,"onCurrentSelectionModeChanged"));this.ga.Ymc(Object(gd.a)(this,this.Jnf,"onGridContextMenu"));zg.a.FFf(Object(gd.a)(this,this.QAb,"onLastInputMethodChanged"));this.saa&&Uc.ULS.sendTraceTag(590751752,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(Q=this.gridView.$.ea.Ea(376,void 0))&&Q.KVi(Object(gd.a)(this,this.Ktf,"onTouchAutoFillModeSet"));
L.prototype.dispose.call(this)};fa.prototype.TPa=function(){if(!this.Y$.range||!this.Y$.range.equals(this.a$a))return!1;var Q=!this.gridView.MKa();return this.gridView.isEditing&&Q&&(this.a$a.isRow||this.a$a.Yh)?!1:this.saa?!0:3===zg.a.Yb};fa.prototype.Y3=function(){this.llb&&(this.SN.set_visible(!1),this.vL.set_visible(!1),this.llb=!1)};fa.prototype.uma=function(){if(this.TPa()){this.Uxj();var Q=cf.DOMElementExtensions.getBoundingClientRect(this.KXa);Q||Uc.ULS.shipAssertTag(576296321,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.fa.isNamedObjectViewMode,this.Mid,this.LWb,this.gridView.Pi,this.gridView.$a.lj);var ra=cf.DOMElementExtensions.getBoundingClientRect(this.u3i),mb=new Sys.UI.Bounds(ra.x-Q.x,ra.y-Q.y,ra.width,ra.height),Qb=this.a$a,Sc=Qb.topLeft,Ad=Qb.bottomRight,ye=Qb.isRow||Qb.Yh;if(Qb.Yh){var Ze=this.rmh();Qb=mb.x-2*Y.Wrb(this.gridView);var sd=Ze;var pe=mb.x+ra.width}else Qb.isRow?(Qb=pe=this.qmh(),sd=mb.y-2*Y.Wrb(this.gridView),Ze=mb.y+ra.height):(sd=mb.y,Ze=mb.y+ra.height,this.gridView.rtl?(Qb=
mb.x+ra.width,pe=mb.x):(Qb=mb.x,pe=mb.x+ra.width));ra=Y.Qod+(ye?0:Y.Wrb(this.gridView));this.SN.style.left=hd.HelperMethods.Ub(Qb-ra);this.SN.style.top=hd.HelperMethods.Ub(sd-ra);this.vL.style.left=hd.HelperMethods.Ub(pe-ra);this.vL.style.top=hd.HelperMethods.Ub(Ze-ra);this.SN.set_visible(this.j5e(sd,Qb,Sc,ye,Q));this.vL.set_visible(this.j5e(Ze,pe,Ad,ye,Q));this.llb=!0}};fa.prototype.j5e=function(Q,ra,mb,Qb,Sc){var Ad=cf.DOMElementExtensions.getBoundingClientRect(this.gridView.Yf(this.paneType).domElement);
Sc=new Sys.UI.Bounds(Ad.x-Sc.x-3,Ad.y-Sc.y-3,Ad.width+6,Ad.height+6);return(this.gridView.$a.fk(mb)===this.paneType||Qb)&&Od.a.vA(Sc,new Sys.UI.Point(ra,Q))};fa.prototype.Uxj=function(){if(this.Mid!==this.LWb){this.KXa=null;var Q=this.R5c();this.SN.c3f(Q);this.vL.c3f(Q)}};fa.prototype.rmh=function(){return(this.gridView.view.visibleArea.height+this.gridView.$a.height+Y.Qod-Y.Wrb(this.gridView))/2};fa.prototype.qmh=function(){return(this.gridView.view.visibleArea.width+this.gridView.$a.width+Y.Qod-
Y.Wrb(this.gridView))/2};fa.prototype.jw=function(){this.llb&&this.Bkd?this.uma():this.Y3()};fa.prototype.Snf=function(Q){3===Q.Cb&&(this.Bkd=!0,this.uma());return!1};fa.prototype.Tnf=function(Q){if(3===Q.Cb){if(!Q.Wb||this.e1h(Q))return!1;this.Bkd=!1;this.Y3()}return!1};fa.prototype.Orf=function(){this.uma()};fa.prototype.e1h=function(Q){return cf.DOMElementExtensions.FFb(Q.Wb,rb.a.Er)&&(this.e2h(Q)||this.f2h(Q))};fa.prototype.f2h=function(Q){if(this.gridView.rtl)Q=Q.clientPoint.x;else{var ra=cf.DOMElementExtensions.getBoundingClientRect(Q.Wb);
Q=Q.clientPoint.x-(ra.x+ra.width-Hh.a.Lp)}return 0<Q&&Q<=Hh.a.Lp};fa.prototype.e2h=function(Q){var ra=cf.DOMElementExtensions.getBoundingClientRect(Q.Wb);Q=Q.clientPoint.y-(ra.y+ra.height-Hh.a.Lp);return 0<Q&&Q<=Hh.a.Lp};fa.prototype.Ih=function(){this.saa&&this.UPd();this.uma();this.Dkd=!1};fa.prototype.sq=function(){this.Y3();this.Dkd=!0};fa.prototype.exa=function(Q,ra){ra.b4===this.b4&&(ra.visible?this.Dkd||this.uma():this.Y3())};fa.prototype.Jtf=function(){this.Unf(this.SN.domElement,!1)};fa.prototype.ikf=
function(){this.Unf(this.vL.domElement,!0)};fa.prototype.nic=function(Q,ra){this.ga.Sxa(ra)};fa.prototype.Unf=function(Q,ra){this.saa&&Uc.ULS.sendTraceTag(590751751,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.sUc(Q,ra,this.saa);this.Y3()};fa.prototype.oic=function(Q,ra){this.ga.Sxa(Rg.b(ra))};fa.prototype.QAb=function(){3===zg.a.Yb?this.uma():this.Y3();this.saa&&1===zg.a.Yb&&this.UPd()};fa.prototype.Ktf=function(){this.U5i()};fa.prototype.U5i=function(){this.saa||
(Uc.ULS.sendTraceTag(590751750,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.saa=!0,this.SN.hNf(),this.vL.hNf(),this.gridView.ga.sourceRange=this.gridView.ga.ya.Xd,this.uma())};fa.prototype.UPd=function(){this.saa&&(Uc.ULS.sendTraceTag(590751749,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.saa=!1,this.SN.t1f(),this.vL.t1f())};fa.prototype.R5c=function(){if(!this.KXa){this.LWb=!1;if(this.Mid){var Q=this.gridView.$.ea.Ea(22,void 0);if(Q)return this.LWb=!0,this.KXa=
Q.yx}this.KXa=this.gridView.Pi}return this.KXa};fa.prototype.vBe=function(){this.Y3()};fa.prototype.Uo=function(){this.ga.Sa.nc&&this.Y3()};fa.prototype.Wjf=function(){this.Y3()};fa.prototype.Jnf=function(Q,ra){this.UPd();3===ra.Cb?this.uma():this.Y3()};fa.prototype.Olc=function(){this.llb&&(this.Y3(),this.uma())};Jl.Object.defineProperties(fa.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.jy}}});Object(Le.a)(fa,"SelectionTouchGrippiesBehaviorBase",L,[]);Cm(T,fa);T.prototype.TPa=
function(){var Q=this.gridView.wi||this.gridView.isEditing;return!this.gridView.ga.ya.Eh&&!Q&&fa.prototype.TPa.call(this)};Jl.Object.defineProperties(T.prototype,{b4:{configurable:!0,enumerable:!0,get:function(){return 19}},a$a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.ya.activeRange}}});Object(Le.a)(T,"DiscontinuousSelectionTouchGrippiesBehavior",fa,[]);var Mh=b(306);Cm(N,L);Object(Le.a)(N,"SelectionBorderBehavior",L,[]);S.phh="ewr-selection-draghandle";S.xhh="ewr-selection-draghandle-top-ie";
S.whh="ewr-selection-draghandle-top";S.rhh="ewr-selection-draghandle-bottom-ie";S.qhh="ewr-selection-draghandle-bottom";S.thh="ewr-selection-draghandle-left-ie";S.shh="ewr-selection-draghandle-left";S.vhh="ewr-selection-draghandle-right-ie";S.uhh="ewr-selection-draghandle-right";S.yhh="ewr-selection-dragtooltip";S.zhh="ewr-selection-dragtooltip-updated";S.Khh="ewr_selection_rearrangeleft";S.Lhh="ewr_selection_rearrangeright";S.Mhh="ewr_selection_rearrangetop";S.Jhh="ewr_selection_rearrangebottom";
S.selecting="selecting";S.Nhh="ewr-selection-resizemarqueehandle";S.Qhh="ewr-selection-resizemarqueehandle-topleft";S.Rhh="ewr-selection-resizemarqueehandle-topright";S.Ohh="ewr-selection-resizemarqueehandle-bottomleft";S.Phh="ewr-selection-resizemarqueehandle-bottomright";S.fhh="ewr-marquee-thick";S.jhh="ewr-resizemarqueehandle-thick";Object(Le.a)(S,"CssClassNames",null,[]);Cm(W,N);W.prototype.dispose=function(){var Q=this;this.eC.forEach(function(ra){Rc.a.instance.Ca(Kc.a.pointerDown,ra,Object(gd.a)(Q,
Q.onPointerDown,"onPointerDown"))});Array.clear(this.eC);this.fla=this.sourceRange=this.kd=null;Uc.ULS.sendTraceTag(590751819,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.fqa,!this.$);this.$&&(this.$.nl(Object(gd.a)(this,this.sd,"onWorkbookOpened")),1===this.fqa&&(Uc.ULS.sendTraceTag(590751818,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.CL(this.gce,this.hce,!1)));N.prototype.dispose.call(this)};
W.prototype.Hh=function(Q){Q=Nf.a(this.$).Qe(Q);return this.yqf(Q)};W.prototype.yqf=function(Q){if(5!==this.uu)return!1;(Q=this.U6a(Q))||this.T4b(!1);jg.b(this.$,!1);return Q};W.prototype.onPointerDown=function(Q){Q=Nf.a(this.$).Qe(Q);if(2===Q.Cb&&!Q.qo&&!this.xQa){var ra=this.oad(Q);if(!ra)return Uc.ULS.shipAssertTag(590751817,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.kd=ra.clone();this.sourceRange=this.kd.clone();this.fla=this.kd;if(ra=this.fDh(Q))this.uu=
5,this.XRd=ra.top-this.sourceRange.top,this.wdd=ra.left-this.sourceRange.left,df.g(this.$).Vi.YA(W.B1c),this.oqf(Q),this.xQa=!0,jg.b(this.$,!0)}return!1};W.prototype.vk=function(Q){Q=Nf.a(this.$).Qe(Q);if(this.E0h&&this.wqf(Q))return!0;if(Q=this.ga.Pr(Q.clientPoint,Q.Wb,5,void 0,void 0,!0)){Q=this.Amb(Q);if(this.kd.equals(Q))return!0;this.kd=Q;if(!this.a7())return Uc.ULS.shipAssertTag(590751816,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.T4b(!0),!1}return!0};
W.prototype.UV=function(Q,ra){Uc.ULS.shipAssertTag(590751815,0,!this.fqa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.fqa+=1;this.gce=Q;this.hce=ra;this.qp.UV(Q,ra,this.POd())};W.prototype.Amb=function(Q){if(!Q||!this.kd)return Uc.ULS.shipAssertTag(590751814,0,!!Q,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Uc.ULS.shipAssertTag(590751813,0,!!this.kd,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),
null;var ra=this.kd.clone();1!==this.r2&&(ra.left=Math.max(Q.left-this.wdd,1),ra.right=ra.left+this.sourceRange.width-1);2!==this.r2&&(ra.top=Math.max(Q.top-this.XRd,1),ra.bottom=ra.top+this.sourceRange.height-1);return this.WVb(ra)};W.prototype.CL=function(Q,ra,mb,Qb){mb=void 0===mb?!0:mb;Qb=void 0===Qb?!0:Qb;Uc.ULS.shipAssertTag(590751812,0,1===this.fqa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.fqa;df.g(this.$).Vi.YA(Se.a.kua);this.qp.PPd(Q,ra,this.POd());
mb&&this.Upe(Qb);this.r2=0;this.xQa=!1};W.prototype.WVb=function(Q){var ra=df.g(this.$),mb=Q;if(ra.$a.U3){if(!ra.Cc(Q.topLeft)){ra=ra.$m("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ra.kJ,this.fla.top!==Q.top?1:2);try{ra.Pk=this.fla.top<Q.top||this.fla.left<Q.left,ra.Ou(Q.topLeft),mb=ra.$$cu().range}finally{ra&&ra.dispose()}}mb.right=mb.left+Q.width-1;mb.bottom=mb.top+Q.height-1}return this.fla=mb};W.prototype.bHd=function(Q){this.eC.forEach(function(ra){cf.DOMElementExtensions.setVisible(ra,
Q)})};W.prototype.sd=function(Q,ra){ra.LJ||this.bHd(this.$.isEditMode)};W.prototype.fDh=function(Q){var ra=Q.Wb;Q=Q.clientPoint;if(!ra||!Q)return Uc.ULS.shipAssertTag(590751811,0,!!ra,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Uc.ULS.shipAssertTag(590751810,0,!!Q,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;Q.y+=ra===this.eC[W.Z2b]?2:ra===this.eC[W.UAe]?-2:0;Q.x+=ra===this.eC[W.WAe]?2:ra===this.eC[W.Y2b]?-2:0;return this.ga.Pr(Q,ra,5,void 0,
void 0,!0)};Jl.Object.defineProperties(W.prototype,{Sb:{configurable:!0,enumerable:!0,get:function(){return df.g(this.$).Sb}},uu:{configurable:!0,enumerable:!0,get:function(){return this.ga.selectionType},set:function(Q){this.ga.selectionType=Q}}});W.B1c="move";W.Z2b=0;W.UAe=1;W.WAe=2;W.Y2b=3;Object(Le.a)(W,"DragSelectionClickBehaviorBase",N,[]);Cm(H,W);H.prototype.xWa=function(Q){this.qp.WGb(Q,this.eC);this.Ix.rya()};H.prototype.oqf=function(Q){Uc.ULS.sendTraceTag(590751826,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");
this.gridView.PJa=!0;this.qb.HD(!1);this.uu=5;this.Ix.YAe(Q.Wb);this.qb.textBox.removeSelection();this.qb.xVb(Object(gd.a)(this,this.QXe,"handleKeyDownDuringDrag"));this.UV(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"));this.r2=this.sourceRange.isRow?1:this.sourceRange.Yh?2:0};H.prototype.U6a=function(){var Q=this.Mca();this.uu=-1;this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"));return Q};H.prototype.Upe=function(){this.gridView.PJa=
!1;this.Ix.ZAe(this.eC[0]);this.qb.textBox.setCaretPositionToEnd();this.qb.gnc(Object(gd.a)(this,this.QXe,"handleKeyDownDuringDrag"));this.qp.YBf()};H.prototype.QXe=function(){this.T4b(!0)};H.prototype.T4b=function(Q){Uc.ULS.sendTraceTag(590751825,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");Q&&this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"))};H.prototype.oad=function(Q){this.qb=
this.qp.M7c();this.wK=this.qp.gUe(Q);return this.qb&&this.wK&&this.wK.range?this.wK.range:(Uc.ULS.shipAssertTag(590751824,0,!!this.qb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Uc.ULS.shipAssertTag(590751823,0,!!this.wK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Uc.ULS.shipAssertTag(590751822,0,!!this.wK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};H.prototype.Mca=function(){return this.wK?
this.coloredReferencesManager.rgf(this.qb,this.wK,this.kd):(Uc.ULS.shipAssertTag(590751821,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};H.prototype.a7=function(){return this.Mca()};H.prototype.POd=function(){return!0};H.prototype.wqf=function(){return!1};Object(Le.a)(H,"DragMarqueeClickBehavior",W,[]);var Nh=b(874),zd=b(815),li=b(127);Object(Le.a)(C,"MacroRecorderTableRowColumnRearrangedPayload",
null,[115]);Cm(B,W);B.prototype.dispose=function(){this.ga&&(this.ga.oca(Object(gd.a)(this,this.sq,"onSelectionStarted")),this.ga.q_(Object(gd.a)(this,this.Ih,"onSelectionEnded")),this.ga.WFf(Object(gd.a)(this,this.dsf,"onSelectionAbort")),this.ga.pK(Object(gd.a)(this,this.nd,"onSelectionChanged")));if(this.yo)for(var Q=1;4>=Q;Q++)cf.DOMElementExtensions.rg(this.yo[Q.toString()]);this.yo=this.tu=null;this.kZ&&this.rvc();this.Zv&&this.lZ&&this.rvc(1);W.prototype.dispose.call(this)};B.prototype.oqf=
function(Q){this.Zv&&(this.Jba=Q,this.Tca=null,this.nQ=this.isRow=this.Yh=this.oQ=!1,nf.KeyInputManager.instance.qa(Kc.a.Rb,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyDown,"onKeyDown")));this.XG=!0;this.tableRange=this.VGg(this.tableManager.fo(this.sourceRange.topLeft));df.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zv?(this.Tca=this.tableRange,this.aJ=1,this.tu=(this.nQ=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?
[11]:[12],this.uu=6,this.UV(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange")),this.WGa=this.$2b,this.NPa=this.urc,this.ima(Q.clientPoint,Q.Wb,this.nQ?11:12,!0,!0),this.tRa(!0)):(this.tu=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.uu=6,this.UV(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange")),this.ima(Q.clientPoint,
Q.Wb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zv?(this.isRow=this.sourceRange.isRow,this.Yh=this.sourceRange.Yh,this.isRow||this.Yh?(this.aJ=3,this.r2=this.isRow?1:2,this.uu=6,this.tu=this.isRow?[11]:[12],this.UV(Object(gd.a)(this,this.kBb,"onPointerMoveDragInsert"),Object(gd.a)(this,this.lBb,"onPointerUpDragInsert")),this.WGa=this.$2b,this.NPa=this.urc,this.ima(Q.clientPoint,Q.Wb,this.isRow?11:12,!0,!0),this.tRa(!0)):(this.aJ=2,this.r2=0,this.UV(Object(gd.a)(this,this.vk,"onPointerMove"),
Object(gd.a)(this,this.Hh,"onPointerUp")),this.WGa=this.$Ae,this.NPa=this.gRf,this.ima(Q.clientPoint,Q.Wb,this.A7b(),!1,!0),this.a7(!0))):(this.UV(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp")),nf.KeyInputManager.instance.qa(Kc.a.Rb,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyDown,"onKeyDown")),this.r2=this.sourceRange.isRow?1:this.sourceRange.Yh?2:0,this.ima(Q.clientPoint,Q.Wb,this.A7b(),!1),this.a7()))};B.prototype.onKeyDown=function(Q){if(this.Zv){if(this.vbc(Q)||
Q.Ga.keyCode===Vf.a.KRa)return this.fid||(nf.KeyInputManager.instance.qa(Kc.a.fe,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyUp,"onKeyUp")),this.fid=!0),!this.kZ&&this.vbc(Q)&&(df.g(this.$).Vi.YA(B.Qte),this.kZ=!0),this.lZ||Q.Ga.keyCode!==Vf.a.KRa||(this.lZ=!0,2===this.aJ?(this.pra(!1),this.r2=0,this.tu=this.nQ?[11]:[12],this.oQ=this.nQ,this.DAd(),this.tRa()):3===this.aJ?(this.Xmb(!1),this.r2=this.isRow?1:2,this.SDb(),this.a7()):1===this.aJ&&(this.xVc(!1),this.SDb(),this.a7())),
!0}else if(!this.kZ&&(Q.Ga.keyCode===Vf.a.iAa||bf.a.isMac&&Q.Ga.keyCode===Vf.a.rcb))return nf.KeyInputManager.instance.qa(Kc.a.fe,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyUp,"onKeyUp")),df.g(this.$).Vi.YA(B.Qte),this.kZ=!0;return!1};B.prototype.onKeyUp=function(Q){if(this.Zv){if(this.vbc(Q)||Q.Ga.keyCode===Vf.a.KRa)return this.vbc(Q)?(this.Ald=0,this.XG&&df.g(this.$).Vi.YA(W.B1c)):Q.Ga.keyCode===Vf.a.KRa&&(this.Ald=1,2===this.aJ?(this.Xmb(!1),this.r2=0,this.SDb(!0),this.a7(!0)):
3===this.aJ?(this.pra(!1),this.r2=this.isRow?1:2,this.tu=this.isRow?[11]:[12],this.DAd(!0),this.tRa(!0)):1===this.aJ&&(this.pra(!1),this.tu=this.nQ?[11]:[12],this.zDf(!0),this.tRa(!0))),this.rvc(this.Ald),!0}else if(Q.Ga.keyCode===Vf.a.iAa||bf.a.isMac&&Q.Ga.keyCode===Vf.a.rcb)return this.rvc(),this.XG&&df.g(this.$).Vi.YA(W.B1c),!0;return!1};B.prototype.U6a=function(){this.XG=!1;this.Zv&&(this.aJ=0);this.Sb.ll(this.mia());if(!this.$.qt([this.kd],!1))return this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),
Object(gd.a)(this,this.Hh,"onPointerUp")),this.uu=-1,!0;if(this.ga.ya.Xd.equals(this.kd)||this.Lac(this.kd)||this.Lac(this.sourceRange))this.uu=-1;else{this.Mca();this.ga.sourceRange=this.sourceRange.clone();var Q=this.ga.sourceRange,ra=this.ga.ya.Xd;if(this.Zv){var mb={};this.$.Re(-694765314,2,30,(mb.DragDropForceIsCopy=this.kZ,mb.DragDropSourceRange=Q,mb.DragDropDestinationRange=ra,mb.DragDropIsShiftDown=this.lZ,mb))}else mb={},this.$.Re(-694765314,2,30,(mb.DragDropForceIsCopy=this.kZ,mb.DragDropSourceRange=
Q,mb.DragDropDestinationRange=ra,mb))}!this.Zv&&this.tableRange||this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"));return!0};B.prototype.Upe=function(Q){Q&&(nf.KeyInputManager.instance.Ca(Kc.a.Rb,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyDown,"onKeyDown")),this.XG=!1);for(Q=1;4>=Q;Q++){var ra=this.yo[Q.toString()];ra&&ra.parentNode.removeChild(ra);this.yo[Q.toString()]=null}this.tu=null};B.prototype.V6a=function(Q){Q=Nf.a(this.$).Qe(Q);
5===this.uu?this.yqf(Q):(this.XG=!1,this.Sb.ll(this.tu),!this.$.qt([this.kd],!1)||this.bOi()||this.C6e()||(this.ga.sourceRange=this.sourceRange.clone(),this.Zv?this.yJi():this.BIe(),this.x4()?this.kd.top>this.sourceRange.top&&(Q=this.kd.height,this.kd.top-=Q,this.kd.bottom-=Q):this.kd.left>this.sourceRange.left&&(Q=this.kd.width,this.kd.left-=Q,this.kd.right-=Q),this.Mca()));this.CL(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange"));this.tableRange=
null;this.uu=-1;this.Zv&&(this.Tca=null,this.aJ=0);return!0};B.prototype.lBb=function(){this.XG=!1;this.aJ=0;this.Sb.ll(this.tu);if(!this.$.qt([this.kd],!1))return this.CL(Object(gd.a)(this,this.kBb,"onPointerMoveDragInsert"),Object(gd.a)(this,this.lBb,"onPointerUpDragInsert")),this.uu=-1,!0;if(!(this.ga.ya.Xd.equals(this.kd)||this.Lac(this.kd)||this.Lac(this.sourceRange)||this.C6e())){this.Mca();this.ga.sourceRange=this.sourceRange.clone();var Q=this.ga.sourceRange,ra=this.ga.ya.Xd,mb={};this.$.Re(-694765314,
2,30,(mb.DragDropForceIsCopy=this.kZ,mb.DragDropForceIsInsert=!0,mb.DragInsertIsVertical=this.oQ,mb.DragDropSourceRange=Q,mb.DragDropDestinationRange=ra,mb.DragDropIsShiftDown=this.lZ,mb));this.kZ||(this.kd.top>this.sourceRange.top&&(this.isRow||this.kd.left===this.sourceRange.left&&this.oQ)?(Q=this.kd.height,this.kd.top-=Q,this.kd.bottom-=Q):this.kd.left>this.sourceRange.left&&(this.Yh||this.kd.top===this.sourceRange.top&&!this.oQ)&&(Q=this.kd.width,this.kd.left-=Q,this.kd.right-=Q),this.Mca())}this.CL(Object(gd.a)(this,
this.kBb,"onPointerMoveDragInsert"),Object(gd.a)(this,this.lBb,"onPointerUpDragInsert"));this.Tca=this.tableRange=null;this.uu=-1;this.oQ=!1;return!0};B.prototype.wqf=function(Q){var ra=this.ga.Pr(Q.clientPoint,Q.Wb,5,void 0,void 0,!0);this.Jba=Q;return this.TYe(ra)?(this.kd=this.ITc(ra),this.qXe(!0),!0):this.CPh(ra)?(this.kd=this.Amb(ra),this.rXe(!0),!0):!1};B.prototype.S6a=function(Q){var ra=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ra&&(Q=Nf.a(this.$).Qe(Q));
var mb=Q.clientPoint;ra||(Q=Nf.a(this.$).Qe(Q));this.Zv&&(this.Jba=Q);if(Q=this.ga.Pr(mb,Q.Wb,5,void 0,void 0,!0)){if(this.tableRange.contains(Q.topLeft)){ra=df.g(this.$);var Qb=ra.Mg(Q),Sc=ra.Yf(this.paneType);mb=zd.a.eu(Sc.view.Tg,this.domElement.parentNode,mb,ra.rtl);Sc=!1;var Ad=2;this.x4()&&mb.y-Qb.topLeft.y>Qb.height/2?(Sc=!0,Ad=1):!this.x4()&&mb.x-Qb.topLeft.x>Qb.width/2&&(Sc=!0);if(Sc){ra=ra.$m("DragSelectionClickBehavior.OnPointerMoveRearrange",ra.kJ,Ad);try{ra.Ou(Q),ra.$$mn(),Q=ra.$$cu().range}finally{ra&&
ra.dispose()}}this.kd=this.ITc(Q);this.ga.sourceRange=this.kd;this.Sb.qm(this.kd,this.tu);this.Sb.Wr(this.tu);this.Sb.ll(this.mia());if(6!==this.uu){for(Q=1;4>=Q;Q++)ra=this.yo[Q.toString()],ra.parentNode.removeChild(ra),this.Sb.sJ(this.x4()?11:12,Q).hn.appendChild(ra);this.uu=6}}else if(this.kd=this.Amb(Q),this.Zv)this.rXe(!1);else if(this.Sb.qm(this.kd,this.mia()),this.Sb.Wr(this.mia()),this.Sb.ll(this.tu),5!==this.uu){for(Q=1;4>=Q;Q++)ra=this.yo[Q.toString()],ra.parentNode.removeChild(ra),this.Sb.sJ(this.A7b(),
Q).hn.appendChild(ra);this.uu=5}this.pW()}return!0};B.prototype.kBb=function(Q){var ra=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");ra&&(Q=Nf.a(this.$).Qe(Q));var mb=Q.clientPoint;ra||(Q=Nf.a(this.$).Qe(Q));this.Jba=Q;if(ra=this.ga.Pr(mb,Q.Wb,5,void 0,void 0,!0)){if(this.TYe(ra))return this.kd=this.Amb(ra),this.qXe(!1),!0;var Qb=df.g(this.$),Sc=Qb.Mg(ra),Ad=Qb.Yf(this.paneType);mb=zd.a.eu(Ad.view.Tg,this.domElement.parentNode,mb,Qb.rtl);Ad=!1;var ye=2;this.oQ=
!1;if(this.isRow||this.Yh){this.isRow&&mb.y-Sc.topLeft.y>Sc.height/2?(Ad=!0,ye=1):this.Yh&&mb.x-Sc.topLeft.x>Sc.width/2&&(Ad=!0);if(Ad){Q=Qb.$m("DragSelectionClickBehavior.OnPointerMoveDragInsert",Qb.kJ,ye);try{Q.Ou(ra),Q.$$mn(),ra=Q.$$cu().range}finally{Q&&Q.dispose()}}this.kd=this.Amb(ra)}else{mb.x-Sc.topLeft.x===Sc.width?(this.oQ=!1,Ad=!0):mb.y-Sc.topLeft.y>Sc.height/2&&(this.oQ=Ad=!0,ye=1);this.Tca&&(this.oQ=this.nQ);if(Ad){Qb=Qb.$m("DragSelectionClickBehavior.OnPointerMoveDragInsert",Qb.kJ,ye);
try{Qb.Ou(ra),Qb.$$mn(),ra=Qb.$$cu().range}finally{Qb&&Qb.dispose()}}this.Sb.ll(this.tu);this.tu=this.oQ?[11]:[12];for(Qb=1;4>=Qb;Qb++)(Sc=this.yo[Qb.toString()])&&Sc.parentNode.removeChild(Sc),this.yo[Qb.toString()]=null;this.ima(Q.clientPoint,Q.Wb,this.oQ?11:12,!0);this.kd=this.ITc(ra)}this.ga.sourceRange=this.kd;this.Sb.qm(this.kd,this.tu);this.Sb.Wr(this.tu);this.Sb.ll(this.mia());if(6!==this.uu){for(Q=1;4>=Q;Q++)ra=this.yo[Q.toString()],ra.parentNode.removeChild(ra),this.Sb.sJ(this.isRow||this.oQ?
11:12,Q).hn.appendChild(ra);this.uu=6}this.pW()}return!0};B.prototype.TYe=function(Q){return!!this.Tca&&1!==this.aJ&&!!Q&&this.Tca.contains(Q.topLeft)};B.prototype.CPh=function(Q){return!!this.Tca&&1===this.aJ&&!!Q&&!this.Tca.contains(Q.topLeft)};B.prototype.qXe=function(Q){this.tableRange=this.Tca;this.aJ=1;var ra=!this.lZ;Q?(this.pra(!1),this.tu=this.nQ?[11]:[12],this.zDf(ra),this.tRa(ra)):(this.Xmb(!1),this.SDb(ra),this.a7(ra))};B.prototype.rXe=function(Q){this.tableRange=null;this.aJ=2;var ra=
!this.lZ;Q?(this.pra(!1),this.tu=this.nQ?[11]:[12],this.oQ=this.nQ,this.DAd(ra),this.tRa(ra)):(this.xVc(!1),this.SDb(ra),this.a7(ra))};B.prototype.oad=function(){return this.ga.ya.Xd};B.prototype.Mca=function(){this.ga.updateSelection(this.kd,this.kd.topLeft,0);return!0};B.prototype.a7=function(Q){Q=void 0===Q?!1:Q;this.Sb.qm(this.kd,this.mia());this.Sb.Wr(this.mia());this.pW(Q);return!0};B.prototype.tRa=function(Q){Q=void 0===Q?!1:Q;this.Sb.qm(this.kd,this.tu);this.Sb.Wr(this.tu);this.pW(Q)};B.prototype.Ih=
function(){Sys.UI.DomElement.removeCssClass(this.domElement,S.selecting)};B.prototype.sq=function(){Sys.UI.DomElement.addCssClass(this.domElement,S.selecting)};B.prototype.nd=function(){if(this.$.isEditMode){var Q=this.$dj();this.bHd(Q)}};B.prototype.dsf=function(){this.Zv?this.XG&&5<=this.uu&&(this.tableRange?this.lZ?this.pra(!0):this.xVc(!0):this.lZ?this.isRow||this.Yh?this.pra(!0):this.Xmb(!0):this.isRow||this.Yh?this.Xmb(!0):this.pra(!0)):this.XG&&5<=this.uu&&(this.tableRange?(this.Sb.ll(this.tu),
this.CL(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange"))):(this.Sb.ll(this.mia()),this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"))))};B.prototype.T4b=function(){Uc.ULS.sendTraceTag(590751820,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};B.prototype.POd=function(){return!1};B.prototype.$dj=function(){if(!df.g(this.$).ga.ya.Eh)return!1;var Q=
df.g(this.$).getRangeInformation(this.ga.ya.Xd);Q=Ml(Q);for(var ra=Q.next();!ra.done;ra=Q.next())if(Object(Jc.a)(Yc.PivotTableRange,ra.value))return!1;return!0};B.prototype.VGg=function(Q){if(Q&&Q.contains(this.sourceRange)&&!Q.equals(this.sourceRange)){if(Q.xua&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Q.top){var ra=new Pf.Range(this.sourceRange.top,this.sourceRange.left,Q.bottom,this.sourceRange.right,!1,!1);if(!ra.equals(Q))return this.sourceRange=ra,this.ga.updateSelection(this.sourceRange,
this.sourceRange.topLeft,0),Q}this.Zv?this.nQ=Q.left===this.sourceRange.left&&Q.right===this.sourceRange.right:this.isRow=Q.left===this.sourceRange.left&&Q.right===this.sourceRange.right;if(Q.top===this.sourceRange.top&&Q.bottom===this.sourceRange.bottom||this.x4())return Q}return null};B.prototype.ITc=function(Q){var ra=Q.clone();this.x4()?ra.left=Math.max(Q.left-this.wdd,1):ra.top=Math.max(Q.top-this.XRd,1);ra.right=ra.left+this.sourceRange.width-1;ra.bottom=ra.top+this.sourceRange.height-1;return this.WVb(ra)};
B.prototype.C6e=function(){var Q=this.kd.topLeft.oe(this.sourceRange);return Q||this.Zv&&!this.tableRange?Q:this.x4()?this.kd.top===this.sourceRange.bottom+1:this.kd.left===this.sourceRange.right+1};B.prototype.bOi=function(){if(this.x4()&&this.kd.left!==this.tableRange.left||!this.x4()&&this.kd.top!==this.tableRange.top){var Q=Yh.a.Ad(1,1,0,865,0,2065438552,"RearrangeInvalidDest");bh.a(this.$).Yt([Q]);return!0}return!1};B.prototype.yJi=function(){var Q=this,ra=this.$.Zb.Ic("UserAction","RearrangeRowColumnClientSide"),
mb={},Qb=(mb.CopyPasteTargetType=1,mb.OperationId=Te.a.create().toString(),mb.Stopwatch=ra,mb.DragDropIsShiftKeyDown=this.lZ,mb.EncounteredDeploymentErrors=!1,mb),Sc=this.kZ?2:1,Ad=this.$.ea.Ea(254,void 0);(new Promise(function(ye,Ze){Q.BIe(function(sd){sd.Errors&&0<sd.Errors.length?Ze(new Nh.a(22,sd.Errors)):ye(!0)},function(sd){sd=li.a.Eg(sd.data);Ze(new Nh.a(22,sd))})})).then(function(){Uc.ULS.sendTraceTag(537518865,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);Ad&&Ad.udi(Qb,Sc,Q.sourceRange,Q.kd);return Promise.resolve(!0)},function(ye){Uc.ULS.sendTraceTag(537518864,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',ye?copyPasteInfra.getStringifiedError(ye):"null",1);return Ad?Ad.Axi(ye,Qb,Sc,Q.sourceRange,Q.kd):Promise.reject(ye)})};B.prototype.BIe=function(Q,ra){function mb(){return new C(ye,Ad)}function Qb(Ze,sd,pe){var Ve=Sc.$.ra.xa;Ze=Q?vg.b(Ze,Q):Ze;sd=ra?vg.a(sd,ra):sd;var Li=Ve.Ra(41,null);Li.sourceRange=ye;
Li.destinationRange=Ad;return Gh.i(Ve,"RearrangeRowColumn",Li,Ze,sd,pe,null,0)}var Sc=this;Q=void 0===Q?null:Q;ra=void 0===ra?null:ra;var Ad={};this.x4()?(Ad.FirstRow=this.kd.top-1,Ad.FirstColumn=0,Ad.DeltaColumn=0,Ad.DeltaRow=this.kd.bottom-this.kd.top+1):(Ad.FirstRow=0,Ad.FirstColumn=this.kd.left-1,Ad.DeltaColumn=this.kd.right-this.kd.left+1,Ad.DeltaRow=0);Ad.LastRow=Fg.a.Ty;Ad.LastColumn=Fg.a.dw;Ad.SheetName=this.$.Aa.sa?this.$.Aa.sa.name:this.$.Ab.getItemByName(this.$.Ab.sa.name).sheetName;var ye=
gg.v(this.sourceRange,this.$);ee.EwaSettings.wc()?this.$.userOperationManager.oc(new Ng.a(514,0,Qb,64,mb),null):this.$.userOperationManager.oc(new $d.a(514,0,Qb,void 0,mb),null)};B.prototype.Lac=function(Q){Q=df.g(this.$).getRangeInformation(Q);for(var ra=0,mb=Q.length;ra<mb;++ra)if(Object(Jc.a)(Yc.PivotTableRange,Q[ra]))return Q=Yh.a.Ad(1,0,0,860,0,2105176604,"InsDelCellsPivotTable"),bh.a(this.$).Yt([Q]),!0;return!1};B.prototype.ima=function(Q,ra,mb,Qb,Sc){Sc=void 0===Sc?!1:Sc;var Ad=cf.DOMElementExtensions.getBoundingClientRect(ra),
ye=ra===this.eC[W.Z2b]||ra===this.eC[W.UAe];if(this.Zv){var Ze=ra===this.eC[W.WAe]||ra===this.eC[W.Y2b];this.isRow&&Ze||this.Yh&&ye?Ze="100px":(ye=this.isRow||ye,Ze=(ye?Sc?B.Iqj:B.Nqj:Sc?B.Hqj:B.Kqj)+"px");ra=ye?ra===this.eC[W.Z2b]?"top":"bottom":ra===this.eC[W.Y2b]?"right":"left";Q=100*(ye?Q.x-Ad.x:Q.y-Ad.y)/(ye?Ad.width:Ad.height);for(Ad=1;4>=Ad;Ad++){Qb=document.createElement("div");var sd=document.createElement("div"),pe=document.createElement("div");Qb.appendChild(sd);Qb.appendChild(pe);Sc&&
(sd=document.createElement("div"),Qb.appendChild(sd),cf.DOMElementExtensions.Bqc(Qb,B.sjh),pe.style.fontWeight="bold");Qb.className=S.zhh;this.yo[Ad.toString()]=Qb;this.Sb.sJ(mb,Ad).hn.appendChild(Qb);Qb=this.yo[Ad.toString()];Qb.style[ra]=Ze;Qb.style[ye?"left":"top"]=Q+"%"}}else for(Sc=(ye?-B.Mqj:-B.Jqj)+"px",Ze=ye?ra===this.eC[W.Z2b]?"top":"bottom":ra===this.eC[W.Y2b]||Qb?"right":"left",ra=100*(ye?Qb?0:Q.x-Ad.x:Q.y-Ad.y)/(ye?Ad.width:Ad.height),Q=1;4>=Q;Q++)Ad=document.createElement("div"),Ad.className=
S.yhh,this.yo[Q.toString()]=Ad,this.Sb.sJ(mb,Q).hn.appendChild(Ad),Ad=this.yo[Q.toString()],Ad.style[Ze]=Sc,Ad.style[ye?"left":"top"]=ra+"%"};B.prototype.pW=function(Q){Q=void 0===Q?!1:Q;var ra=this.kd.toString();if(this.Zv)for(var mb=1;4>=mb;mb++)this.yo[mb.toString()].childNodes[0].innerText=ra,this.yo[mb.toString()].childNodes[1].innerText=this.WGa,Q&&(this.yo[mb.toString()].childNodes[2].innerText=this.NPa);else for(Q=1;4>=Q;Q++)this.yo[Q.toString()].innerText=ra};B.prototype.rvc=function(Q){Q=
void 0===Q?0:Q;Q?1===Q&&(this.lZ=!1):this.kZ=!1;this.Zv&&(this.kZ||this.lZ)||(nf.KeyInputManager.instance.Ca(Kc.a.fe,this.domElement.ownerDocument.body,Object(gd.a)(this,this.onKeyUp,"onKeyUp")),this.fid=!1)};B.prototype.pra=function(Q){this.Sb.ll(this.mia());this.CL(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"),void 0,Q)};B.prototype.Xmb=function(Q){this.Sb.ll(this.tu);this.CL(Object(gd.a)(this,this.kBb,"onPointerMoveDragInsert"),Object(gd.a)(this,this.lBb,"onPointerUpDragInsert"),
void 0,Q)};B.prototype.xVc=function(Q){this.Sb.ll(this.tu);this.CL(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange"),void 0,Q)};B.prototype.SDb=function(Q){Q=void 0===Q?!1:Q;this.uu=5;this.UV(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"));this.WGa=this.$Ae;this.NPa=this.gRf;this.ima(this.Jba.clientPoint,this.Jba.Wb,this.A7b(),!1,Q)};B.prototype.DAd=function(Q){Q=void 0===Q?!1:Q;this.uu=6;this.UV(Object(gd.a)(this,
this.kBb,"onPointerMoveDragInsert"),Object(gd.a)(this,this.lBb,"onPointerUpDragInsert"));this.WGa=this.$2b;this.NPa=this.urc;this.ima(this.Jba.clientPoint,this.Jba.Wb,this.isRow||this.nQ?11:12,!0,Q)};B.prototype.zDf=function(Q){Q=void 0===Q?!1:Q;this.uu=6;this.UV(Object(gd.a)(this,this.S6a,"onPointerMoveRearrange"),Object(gd.a)(this,this.V6a,"onPointerUpRearrange"));this.WGa=this.$2b;this.NPa=this.urc;this.ima(this.Jba.clientPoint,this.Jba.Wb,this.x4()?11:12,!0,Q)};B.prototype.vbc=function(Q){return Q.Ga.keyCode===
Vf.a.iAa||bf.a.isMac&&Q.Ga.keyCode===Vf.a.rcb};B.prototype.x4=function(){return!this.Zv&&this.isRow||this.Zv&&this.nQ};B.prototype.A7b=function(){return this.Zv?37:6};B.prototype.mia=function(){return this.Zv?B.q5g:B.u5g};B.Jqj=50;B.Mqj=25;B.Kqj=-85;B.Nqj=-40;B.Hqj=-120;B.Iqj=-50;B.sjh=41;B.Qte="copy";B.u5g=[6];B.q5g=[37];Object(Le.a)(B,"DragSelectionClickBehavior",W,[]);Cm(J,N);J.prototype.dispose=function(){Rc.a.instance.Ca(Kc.a.pointerDown,this.s$,Object(gd.a)(this,this.onPointerDown,"onPointerDown"));
Df.a.instance.Ca(Kc.a.Dj,this.s$,Object(gd.a)(this,this.oba,"onDblClick"));this.gridView.$&&(this.gridView.ga.oca(Object(gd.a)(this,this.sq,"onSelectionStarted")),this.gridView.ga.q_(Object(gd.a)(this,this.Ih,"onSelectionEnded")),this.gridView.$.nl(Object(gd.a)(this,this.sd,"onWorkbookOpened")),this.gridView.$.Db.unc(Object(gd.a)(this,this.w5,"onWacDialogOpened")),this.gridView.$.Db.tnc(Object(gd.a)(this,this.v5,"onWacDialogClosed")),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5341195_HideFillHandlerWhileEditingOrPicking")&&
(this.gridView.eFf(Object(gd.a)(this,this.rAb,"onComponentRangePickerActiveStateChanged")),this.gridView.zc.mm(Object(gd.a)(this,this.Lnf,"onGridEditStarted")),this.gridView.zc.Qs(Object(gd.a)(this,this.Knf,"onGridEditEnded"))));N.prototype.dispose.call(this)};J.prototype.Ih=function(){Sys.UI.DomElement.removeCssClass(this.domElement,S.selecting);pf.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};J.prototype.sq=function(){Sys.UI.DomElement.addCssClass(this.domElement,S.selecting)};
J.prototype.onPointerDown=function(Q){2!==Q.Cb||Q.qo||(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.ya.Xd,pf.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};J.prototype.oba=function(){this.gridView.$.Re(1983983164,2,30,null);return!0};J.prototype.sd=function(){cf.DOMElementExtensions.setVisible(this.s$,this.gridView.$.isEditMode)};J.prototype.w5=function(){cf.DOMElementExtensions.setVisible(this.s$,!1)};J.prototype.v5=function(){cf.DOMElementExtensions.setVisible(this.s$,
!0)};J.prototype.Lnf=function(){cf.DOMElementExtensions.setVisible(this.s$,!1)};J.prototype.Knf=function(){cf.DOMElementExtensions.setVisible(this.s$,!0)};J.prototype.rAb=function(Q,ra){cf.DOMElementExtensions.setVisible(this.s$,!ra.kce)};Object(Le.a)(J,"FillHandleClickBehavior",N,[]);Cm(z,L);z.prototype.Nyi=function(Q){var ra=hd.HelperMethods.Fm(Q),mb=this.jua.aSd(Q.clientPoint);if(!mb)return!1;var Qb=mb.Sg,Sc=this.jua.Ha.a1a(Qb.hashCode).cia(mb.cI);if(!Sc)return!1;Q=Qb.sj.domElement;mb=hd.HelperMethods.Sde(hd.HelperMethods.JIa(Qb.domElement,
Q),mb.cI);Qb=0;Sc=this.jua.Cc(Sc.getRange());for(var Ad=0,ye=z.Hoe.length;Ad<ye;++Ad){var Ze=z.Hoe[Ad];if(128!==Ze&&64!==Ze||!this.jua.$.isEditMode){var sd=Sc.EIa(Ze);if(sd&&sd.T2a&&"none"!==sd.T2a.style.display){sd=sd.T2a;var pe=hd.HelperMethods.JIa(sd,Q);sd=new Sys.UI.Bounds(pe.x,pe.y,sd.offsetWidth,sd.offsetHeight);if(Od.a.vA(sd,mb)){Qb=Ze;break}}}}return Qb?(Sc.invoke(Qb,ra),!0):!1};Jl.Object.defineProperties(z.prototype,{jua:{configurable:!0,enumerable:!0,get:function(){return this.ldg}}});z.Hoe=
[1,2,32,256,128,64];Object(Le.a)(z,"IPadSelectionClickThroughBehavior",L,[]);x.prototype.dispose=function(){this.gridView.ga.oca(Object(gd.a)(this,this.sq,"onSelectionStarted"));this.gridView.ga.q_(Object(gd.a)(this,this.Ih,"onSelectionEnded"));this.gridView.ga.WFf(Object(gd.a)(this,this.Ih,"onSelectionEnded"))};x.prototype.rya=function(){this.y2a=0;this.acc=!1;this.E4=Number.NaN};x.prototype.S_e=function(Q){this.Nvc(Q.Wb,1);return!0};x.prototype.T_e=function(Q){this.Nvc(Q.Wb,-1);return!0};x.prototype.YAe=
function(Q){this.acc=!0;this.Nvc(Q,1)};x.prototype.ZAe=function(Q){this.acc=!1;this.Nvc(Q,-1)};x.prototype.Nvc=function(Q,ra){if(Q)if(Q.parentNode)if(this.Whd)isNaN(this.E4)||(this.Zvc(this.E4,!1),this.E4=Number.NaN);else if(Q=parseInt(Q.parentNode.getAttribute(Se.a.Kub)),isNaN(Q))Uc.ULS.shipAssertTag(590751776,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.E4)&&Q!==this.E4){if(this.acc)return;this.Zvc(this.E4,!1)}if(isNaN(this.E4)||
Q!==this.E4)this.E4=Q,this.y2a=0;!this.y2a&&0<ra&&this.Zvc(Q,!0);this.y2a=Math.max(this.y2a+ra,0);!this.y2a&&0>ra&&(this.Zvc(Q,!1),this.E4=Number.NaN)}else Uc.ULS.shipAssertTag(590751777,0,!!Q.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else Uc.ULS.shipAssertTag(590751778,0,!!Q,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};x.prototype.Zvc=function(Q,ra){for(var mb=1;4>=mb;mb++){var Qb=this.gridView.Sb.sJ(3,mb,Q).hn;cf.DOMElementExtensions.toggleCssClass(Qb,
S.fhh,ra);for(Qb=Qb.firstChild;Qb;Qb=Qb.nextSibling)Ud.a.contains(Qb.className,"resizemarqueehandle",!0)&&cf.DOMElementExtensions.toggleCssClass(Qb,S.jhh,ra)}};x.prototype.Ih=function(){this.Whd=!1};x.prototype.sq=function(){this.Whd=!0};Object(Le.a)(x,"MarqueeHoveringManager",null,[]);var fg=b(945),Si=b(1230);Cm(y,L);y.prototype.dispose=function(){Rc.a.instance.Ca(Kc.a.AV,this.AJ,Object(gd.a)(this,this.sqf,"onPointerEnter"));Rc.a.instance.Ca(Kc.a.$y,this.AJ,Object(gd.a)(this,this.bxa,"onPointerLeave"));
Rc.a.instance.Ca(Kc.a.pointerDown,this.AJ,Object(gd.a)(this,this.onPointerDown,"onPointerDown"));Sd.a.instance.Ca(Kc.a.click,this.AJ,Object(gd.a)(this,this.XAb,"onMouseClick"));Sd.a.instance.Ca(Kc.a.Dj,this.AJ,Object(gd.a)(this,this.onDoubleClick,"onDoubleClick"));cf.DOMElementExtensions.rg(this.PG);this.PG=null;cf.DOMElementExtensions.rg(this.AJ);this.Gu=this.AJ=null;L.prototype.dispose.call(this)};y.prototype.xWa=function(Q){this.Gu=Object(Ye.a)(Si.a,Q.metadata)};y.prototype.sqf=function(){if(!this.Gu)return Uc.ULS.shipAssertTag(590751774,
0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Gu.QAf(this.PG,!1);this.Gu.OCe(this.PG,!1);if(3===this.Gu.model.state)return!0;this.Gu.O_e(!0);return!0};y.prototype.bxa=function(){if(!this.Gu)return!1;this.Gu.lLi();this.Gu.GDd(this.PG,!1);if(3===this.Gu.model.state)return!0;this.Gu.O_e(!1);return!0};y.prototype.onPointerDown=function(Q){return this.Gu?2!==Q.Cb||Q.qo?!1:!0:!1};y.prototype.XAb=function(){if(!this.Gu)return!1;this.Gu.GDd(this.PG,!0);
this.Gu.QAf(this.PG,!0);this.Gu.OCe(this.PG,!0);this.Gu.eGb(!0);return!0};y.prototype.onDoubleClick=function(Q){if(Q.Ga)return Q.Ga.stopPropagation(),!0;Uc.ULS.sendTraceTag(590751773,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};Object(Le.a)(y,"RangeCatchUpActivityHighlightBehavior",L,[]);Cm(A,fa);A.prototype.TPa=function(){return(this.gridView.inRangePicker||this.gridView.wi)&&fa.prototype.TPa.call(this)};Jl.Object.defineProperties(A.prototype,
{b4:{configurable:!0,enumerable:!0,get:function(){return 16}},a$a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.rangePicker.O7c(!1)}}});Object(Le.a)(A,"RangePickerTouchGrippiesBehavior",fa,[]);Cm(v,L);Object(Le.a)(v,"RearrangeHighlightBehavior",L,[]);var uj;(function(Q){Q[Q.topLeft=0]="topLeft";Q[Q.topRight=1]="topRight";Q[Q.bottomLeft=2]="bottomLeft";Q[Q.bottomRight=3]="bottomRight";Q[Q.error=4]="error"})(uj||(uj={}));Object(Le.b)("Corner",uj);Cm(w,L);w.prototype.dispose=
function(){var Q=this;this.tK.forEach(function(ra){Rc.a.instance.Ca(Kc.a.pointerDown,ra,Object(gd.a)(Q,Q.onPointerDown,"onPointerDown"))});Array.clear(this.tK);L.prototype.dispose.call(this)};w.prototype.xWa=function(Q){this.Y$=Q;this.xge(Q);this.qp.WGb(Q,this.tK,this.JJd());this.Ix.rya()};w.prototype.onPointerDown=function(Q){Q=Nf.a(this.$).Qe(Q);if(this.LRf(Q)&&!this.xQa){this.Ncf();this.qb=this.qp.M7c();this.wK=this.qp.gUe(Q);if(!this.qb||!this.wK||!this.wK.range)return Uc.ULS.shipAssertTag(590751771,
0,!!this.qb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Uc.ULS.shipAssertTag(590751770,0,!!this.wK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Uc.ULS.shipAssertTag(590751769,0,!!this.wK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.kd=this.wK.range.clone();this.sourceRange=this.kd.clone();this.D2=this.tQe(Q);if(4===this.D2)return Uc.ULS.shipAssertTag(590751768,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;var ra=this.dSe(Q,!0);if(!ra)return Uc.ULS.shipAssertTag(590751767,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.zve(ra))return Uc.ULS.shipAssertTag(590751766,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.PJa=!0;this.qb.HD(!1);this.Ix.YAe(Q.Wb);this.qp.zAf(!0,this.Y$.t9);this.qb.textBox.removeSelection();this.qb.xVb(Object(gd.a)(this,this.RXe,"handleKeyDownDuringResize"));
this.vDf();this.xQa=!0;jg.b(this.$,!0)}return!0};w.prototype.vk=function(Q){Q=Nf.a(this.$).Qe(Q);Q=this.dSe(Q,!1);if(!Q)return!0;Q=this.zve(Q);if(!Q)return Uc.ULS.shipAssertTag(590751765,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.w5b(!0),!1;if(this.kd.equals(Q))return!0;this.kd=Q;Q=this.a7();Q||(Uc.ULS.shipAssertTag(590751764,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.w5b(!0));return Q};w.prototype.Hh=function(Q){var ra=this;
Q=Nf.a(this.$).Qe(Q);Q=this.Mca();Uc.ULS.shipAssertTag(590751763,0,Q,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");bf.a.sA&&(this.ga.U$b(!0),window.setTimeout(function(){ra.ga.U$b(!1)},100));this.w5b(!Q);return Q};w.prototype.dSe=function(Q,ra){var mb=Q.Wb;Q=Q.clientPoint;if(!mb||!Q)return Uc.ULS.shipAssertTag(590751762,0,!!mb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Uc.ULS.shipAssertTag(590751761,0,!!Q,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),
null;ra&&(Q=this.tgf(Q));ra=this.ga.Pr(Q,mb,0,!0,!1,!0);ra||(Q=this.tgf(Q),ra=this.ga.Pr(Q,mb,0,!0,!1,!0));return ra};w.prototype.tgf=function(Q){Q.y+=this.D2&&1!==this.D2?-2:2;Q.x+=this.D2&&2!==this.D2?-2:2;return Q};w.prototype.zve=function(Q){if(!Q||!this.sourceRange)return Uc.ULS.shipAssertTag(590751760,0,!!Q,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Uc.ULS.shipAssertTag(590751759,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(this.D2){if(1===
this.D2)return new Pf.Range(Q.top,this.sourceRange.left,this.sourceRange.bottom,Q.right,!0,!1);if(2===this.D2)return new Pf.Range(this.sourceRange.top,Q.left,Q.bottom,this.sourceRange.right,!0,!1);if(3===this.D2)return new Pf.Range(this.sourceRange.top,this.sourceRange.left,Q.bottom,Q.right,!0,!1)}else return new Pf.Range(Q.top,Q.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);Uc.ULS.shipAssertTag(590751758,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",
uj[this.D2]);return null};w.prototype.Mca=function(){return this.coloredReferencesManager.rgf(this.qb,this.wK,this.kd)};w.prototype.a7=function(){return this.Mca()};w.prototype.RXe=function(){this.w5b(!0)};w.prototype.w5b=function(Q){Q&&Uc.ULS.sendTraceTag(590751757,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.Ix.ZAe(this.tK[0]);this.qp.zAf(!1,this.Y$.t9);this.qb.textBox.setCaretPositionToEnd();this.qb.gnc(Object(gd.a)(this,
this.RXe,"handleKeyDownDuringResize"));this.m1f();this.xQa=this.gridView.PJa=!1;jg.b(this.$,!1);this.qp.YBf()};Object(Le.a)(w,"ResizeMarqueeBehaviorBase",L,[]);Cm(u,w);u.prototype.tIf=function(){return[S.Qhh,S.Rhh,S.Ohh,S.Phh]};u.prototype.nge=function(){return[S.Nhh]};u.prototype.tQe=function(Q){Q=Q.Wb;if(Q===this.tK[0])return 0;if(Q===this.tK[1])return 1;if(Q===this.tK[2])return 2;if(Q===this.tK[3])return 3;Uc.ULS.shipAssertTag(590751756,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4};u.prototype.vDf=function(){this.qp.UV(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"),!0)};u.prototype.m1f=function(){this.qp.PPd(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"),!0)};u.prototype.LRf=function(Q){return 2===(zg.a.Yb=Q.Cb)&&!Q.qo};u.prototype.JJd=function(){return!0};u.prototype.Ncf=function(){Uc.ULS.sendTraceTag(590751755,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};
u.prototype.xge=function(Q){for(var ra=Ml(this.tK),mb=ra.next();!mb.done;mb=ra.next())mb.value.style.backgroundColor=Q.hn.style.borderColor};Object(Le.a)(u,"ResizeMarqueeMouseBehavior",w,[]);Cm(k,w);k.prototype.dispose=function(){zg.a.FFf(Object(gd.a)(this,this.QAb,"onLastInputMethodChanged"));w.prototype.dispose.call(this)};k.prototype.tIf=function(){return[Xg.a.Zgh,Xg.a.Ygh]};k.prototype.nge=function(){var Q=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CanvasHitTest",!1),ra=bf.a.tf;
Q=!Q||ra;return[Q?Xg.a.MHe:Xg.a.LHe,Xg.a.w4b,Q?Xg.a.Xgh:Xg.a.v4b]};k.prototype.tQe=function(Q){Q=Q.Wb;if(Q===this.tK[0])return 0;if(Q===this.tK[1])return 3;Uc.ULS.shipAssertTag(590751754,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};k.prototype.vDf=function(){bf.a.Iu?this.qp.UV(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"),!1):this.qp.dQi(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,
"onPointerUp"))};k.prototype.m1f=function(){bf.a.Iu?this.qp.PPd(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"),!1):this.qp.Euj(Object(gd.a)(this,this.vk,"onPointerMove"),Object(gd.a)(this,this.Hh,"onPointerUp"))};k.prototype.LRf=function(Q){return 3===(zg.a.Yb=Q.Cb)};k.prototype.JJd=function(){return 3===zg.a.Yb};k.prototype.Ncf=function(){Uc.ULS.sendTraceTag(590751753,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};
k.prototype.xge=function(){};k.prototype.QAb=function(){var Q=3===zg.a.Yb;this.Jld&&!Q?this.qp.WGb(this.Y$,this.tK,!1):!this.Jld&&Q&&this.qp.WGb(this.Y$,this.tK,!0);this.Jld=Q};k.prototype.Vxi=function(Q,ra){ra.Kub===this.Y$.t9&&this.qp.WGb(this.Y$,this.tK,!ra.start&&this.JJd())};Object(Le.a)(k,"ResizeMarqueeTouchBehavior",w,[]);Cm(t,L);t.gob=function(Q,ra){var mb=document.createElement("div");mb.className=ra;Q.appendChild(mb)};Object(Le.a)(t,"SelectionCutCopyBehavior",L,[]);Cm(r,L);Object(Le.a)(r,
"SelectionPasteBehavior",L,[]);Cm(m,L);m.vob=function(Q,ra){var mb=document.createElement("div");mb.className=ra;Q.appendChild(mb)};Object(Le.a)(m,"SelectionRangePickerBehavior",L,[]);Cm(c,fa);c.prototype.TPa=function(){var Q=this.gridView.wi||this.gridView.isEditing;return this.gridView.ga.ya.Eh&&!Q&&fa.prototype.TPa.call(this)};Jl.Object.defineProperties(c.prototype,{b4:{configurable:!0,enumerable:!0,get:function(){return 0}},a$a:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.ya.Xd}}});
Object(Le.a)(c,"SelectionTouchGrippiesBehavior",fa,[]);var $i=qc.a;Cm(d,$i);d.prototype.dispose=function(){this.gridView.Sb.XTi(Object(gd.a)(this,this.Dlb,"attachBehavior"));this.Ix&&(this.Ix.dispose(),this.Ix=null);$i.prototype.dispose.call(this)};d.prototype.Dlb=function(Q,ra){Q=ra.b4;var mb=this.gridView;ra=ra.ARh;var Qb=ra.hn,Sc=ra.g9;bf.a.hh&&Array.add(Sc,new z(Qb,mb));switch(Q){case 24:Array.add(ra.g9,new y(Qb,ra));break;case 0:Array.add(ra.g9,new J(Qb,mb));bf.a.Sq||Array.add(Sc,new B(Qb,this.gridView.$,
ra.paneType,this.tableManager,this.qp));Array.add(Sc,new c(ra,Qb,mb,ra.paneType));break;case 3:Array.add(Sc,new N(Qb));bf.a.Sq||(Array.add(Sc,new H(Qb,this.gridView.$,ra.paneType,this.Ix,this.qp,ra)),Array.add(Sc,new u(Qb,this.gridView,this.Ix,this.qp,ra)),Array.add(Sc,new k(Qb,this.gridView,this.Ix,this.qp,ra)));break;case 4:case 5:Array.add(Sc,new t(Qb));break;case 30:Array.add(Sc,new r(Qb));break;case 16:Array.add(Sc,new m(Qb));Array.add(Sc,new A(ra,Qb,mb,ra.paneType));break;case 11:case 12:Array.add(Sc,
new v(Qb,11===Q));break;case 17:Array.add(Sc,new N(Qb));break;case 19:Array.add(Sc,new N(Qb)),Array.add(Sc,new T(ra,Qb,mb,ra.paneType))}ra.zXb=!0};Object(Le.a)(d,"GridHighlightsBehaviorManager",qc.a,[]);var ai=Kf.a;Cm(a,ai);a.prototype.create=function(){var Q=this;eg.TaskExtensions.Da(ng.GetServiceTaskFactory.create(this.$.ea,134,this.ma,this.vb,"Microsoft.Office.Excel.WebUI.Client.ITableManager"),function(ra){Q.Jb(Q.$.ea.Ea(64,void 0)||new d(Q.$,ra.result))},this.ma,3)};a.la=function(Q){Q.ea.La(149,
new a(Q))};Object(Le.a)(a,"GridHighlightsBehaviorManagerFactory",Kf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");Yd.main();Type.registerNamespace("Common.App.AltTextDialog");
Type.registerNamespace("Common.App.NewAndOpen.Core");Ob.a.instance.oj(new kb);Qf.a.Xi('.ewr-selection-draghandle{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:27px;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
Qf.a.Xi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
Qf.a.Xi(".ewa-svg-icon{height:100%;width:100%}");Qf.a.Xi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
de.a.Ja(Ue.la);lg.a.Ti.La(141,new Ke);de.a.Ja(Zc.la);(function(){de.a.Ja(function(Q){Hd.la(Q);ee.EwaSettings.YG()?ae.la(Q):Mc.la(Q);Xb.la(Q);Fd.la(Q)})})();de.a.Ja(dc.la);de.a.Ja(Qa.la);(function(){de.a.Ja(function(Q){Q.ea.La(134,new Hb(Q));Q.ea.La(330,new Wa(Q))})})();de.a.Ja(Ab.la);(function(){de.a.Ja(function(Q){Ha.la(Q);ec.la(Q)})})();Type.registerNamespace("Common.App.SessionExpiration");de.a.Ja(R.la);de.a.Ja(a.la);de.a.Ja(X.la)}}]);

//# sourceMappingURL=EwaDS.acc.js.map