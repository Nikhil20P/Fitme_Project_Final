(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[41],{1386:function(D,F,b){function a(){this.pb=null}function d(C,H){this.X4d=this.Y4d=!1;this.xX=this.Eib=this.Dib=null;this.hVa=new k.a;this.Ug=C;this.LDa=H.appSettings[d.lCj]||""}function c(){}b.r(F);D=b(0);var m=b(675),r=b(37),t=b(15),k=b(139);Object(D.a)(c,"ShellRenderData",null,[]);var u=b(5),w=b(1194),v=b(370),A=b(41),y=b(217),x=b(75),z=b(880),J=b(29);d.prototype.jYi=function(){this.xX=document.getElementById(d.DXf);var C=
{};C[d.pPh]=u.AFrameworkApplication.hj;C["Content-Type"]="application/json; charset=utf-8";t.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");var H=x.a.Mk(this.LDa+d.Nbj,d.Xmi,u.AFrameworkApplication.za.Za.Xk.toString());this.m2.Wl(H,1,"",C,!0,2,Object(r.a)(this,this.CBb,"onSuccessCallback"),Object(r.a)(this,this.EAb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")};d.prototype.bdi=function(C){try{var H={};H.FlightName=C.FlightName;H.SessionID=
C.SessionID;t.ULS.sendTraceTag(594883776,215,50,A.c(H))}catch(W){t.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}};d.prototype.CBb=function(C){if((C=C.data.pe)&&C.length)try{var H=A.a(C);u.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled?(this.Dib=H.NavBarDataJson,t.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.")):this.Tsj(H)&&(this.Dib=H.NavBarDataJson);if(this.Dib){var W=A.d(H.NavBarDataJson);this.Eib=W.xu;W.returnValue?(this.bdi(this.Eib),
this.hVa.setResult(this.Eib)):(H={},t.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",(H.ShellData=z.a.Ibb(this.Dib),H)),this.hVa.Xt())}else t.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.hVa.Xt()}catch(S){this.N_(),t.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.hVa.Xt()}else this.N_(),t.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};d.prototype.EAb=function(){this.xX&&this.N_();this.hVa.Xt();
t.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};d.prototype.Tsj=function(C){if(!C.JsUrl||!C.JsUrl.length)return this.N_(),t.ULS.sendTraceTag(6387854,215,10,"Empty or null JS URL."),!1;var H=y.a.create(C.JsUrl);H.NX(Object(r.a)(this,this.Kmi,"o365ShellJs_LoadFinished"));v.a.j3(H);if(!C.CssUrl||!C.CssUrl.length)return this.N_(),t.ULS.sendTraceTag(6387855,215,10,"Empty or null CSS URL."),!1;C=new w.a(C.CssUrl);C.NX(Object(r.a)(this,this.Jmi,"o365ShellCss_LoadFinished"));v.a.j3(C);
return!0};d.prototype.Jmi=function(C,H){H.succeeded?(this.X4d=!0,this.wGf()):(t.ULS.sendTraceTag(7608092,215,10,"CSS failed to load"),this.N_())};d.prototype.Kmi=function(C,H){H.succeeded?(this.Y4d=!0,this.wGf()):(t.ULS.sendTraceTag(7608093,215,10,"JS failed to load"),this.N_())};d.prototype.wGf=function(){if(this.X4d&&this.Y4d)if(this.xX){Sys.UI.DomElement.removeCssClass(this.xX,d.Dbf);var C=document.createElement("div");C.id=d.fRf;this.xX.appendChild(C);this.gWi()}else t.ULS.shipAssertTag(7608280,
215,!1)};d.prototype.gWi=function(){var C=window.self.O365Shell;if(C)if(C.SetData)if(this.Dib)if(this.Eib){C.SetData(this.Eib);var H=Object.assign(new c,{launcher:d.fRf,switcher:d.DXf});C.RenderAsync?C.RenderAsync(H,Object(r.a)(this,this.Tzi,"onSwitcherRendered")):(this.N_(),t.ULS.shipAssertTag(6613131,215,!1))}else this.N_();else this.N_(),t.ULS.shipAssertTag(6613130,215,!1);else this.N_(),t.ULS.shipAssertTag(6613129,215,!1);else this.N_(),t.ULS.shipAssertTag(6613128,215,!1)};d.prototype.Tzi=function(){if(this.xX){var C=
this.xX.getElementsByTagName("a");C&&0<C.length&&C[0]&&"none"!==this.xX.style.display&&C[0].focus();u.AFrameworkApplication.Hb.processAction(J.a.Hif,2);t.ULS.sendTraceTag(6612807,215,50,"O365 switcher tiles added to the DOM.")}else t.ULS.sendTraceTag(41551900,215,15,"Switcher DOM element is null. Cannot append shell container.")};d.prototype.N_=function(){this.xX&&!Sys.UI.DomElement.containsCssClass(this.xX,d.g$)&&(Sys.UI.DomElement.removeCssClass(this.xX,d.Dbf),Sys.UI.DomElement.addCssClass(this.xX,
d.g$),t.ULS.sendTraceTag(7129104,215,10,"Failed to display O365 Shell Switcher."))};d.Jrb=function(){return new d(new m.a(function(){return u.AFrameworkApplication.Md}),u.AFrameworkApplication.ha,u.AFrameworkApplication.za.Za.Xk)};Jl.Object.defineProperties(d.prototype,{Mbj:{configurable:!0,enumerable:!0,get:function(){return this.hVa.task}},m2:{configurable:!0,enumerable:!0,get:function(){return this.Ug.value}}});Jl.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){return d.Pa||
(d.Pa=d.Jrb())}}});d.pPh="X-qs";d.Xmi="at";d.Nbj="O365ShellServiceProxy.ashx";d.Pa=null;d.DXf="sw_bar";d.Dbf="SwitcherLoading";d.g$="SwitcherError";d.fRf="ShellContainer";d.lCj="ShellWebServiceBase";Object(D.a)(d,"O365ShellActor",null,[230]);var B=b(274);a.prototype.$h=function(C){this.pb=C;this.pb.register(d,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").Ac().Lc(function(){return new d(new m.a(function(){return u.AFrameworkApplication.Md}),u.AFrameworkApplication.ha,
u.AFrameworkApplication.za.Za.Xk)})};a.prototype.init=function(){u.AFrameworkApplication.ha.Xv(Object(r.a)(this,this.HA,"onFullAppSettingsReady"))};a.prototype.HA=function(){u.AFrameworkApplication.useO365ShellService&&(!u.AFrameworkApplication.ha.ta("AppSwitcherMitigationIsEnabled")||u.AFrameworkApplication.za.Za.isReactSharedHeaderUxEnabled)&&this.pb.resolve("Common.App.O365Shell.O365ShellActor").jYi()};a.prototype.dispose=function(){};a.main=function(){B.a.instance.oj(new a)};Jl.Object.defineProperties(a.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.O365Shell"}}});Object(D.a)(a,"PackageManager",null,[8,9]);Type.registerNamespace("Common.App.O365Shell");a.main()}}]);

//# sourceMappingURL=EwaDS.shell.js.map